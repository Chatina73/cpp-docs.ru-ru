---
title: Поддержка Юникода и многобайтовой кодировки
ms.date: 01/09/2017
helpviewer_keywords:
- MFC [C++], character set support
- MBCS [C++], strings and MFC support
- strings [C++], MBCS support in MFC
- character sets [C++], multibyte
- Unicode [C++], MFC strings
- Unicode [C++], string objects
- strings [C++], Unicode
- strings [C++], character set support
ms.openlocfilehash: e1b93a3540cba553afd8f133c18496bddbd561b8
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81317438"
---
# <a name="unicode-and-multibyte-character-set-mbcs-support"></a>Поддержка Юникода и многобайтовой кодировки

Некоторые языки, например, японский и китайский, имеют большие наборы символов. Для поддержки программирования для этих рынков библиотека класса Microsoft Foundation (MFC) позволяет использовать два различных подхода к обработке больших наборов символов:

- [Unicode](#mfc-support-for-unicode-strings) `wchar_t` , основанные широкосимволы и строки, кодированные как UTF-16.

- [Наборы мультибайт символов (MBCS)](#mfc-support-for-mbcs-strings), **символ** ы на основе одного или двойного байт символов и строк, закодированных в лоза конкретных символов.

Microsoft рекомендовала библиотеки MFC Unicode для всех новых разработок, а библиотеки MBCS были унижены в Visual Studio 2013 и Visual Studio 2015. Это больше не требуется. Предупреждения об амортизации MBCS были удалены в Visual Studio 2017.

## <a name="mfc-support-for-unicode-strings"></a>Поддержка MFC для unicode строк

Вся библиотека класса MFC условно включена для символов и строк Unicode, хранящихся в широких символах как UTF-16. В частности, класс [CString](../atl-mfc-shared/reference/cstringt-class.md) включен в Unicode.

Эти файлы библиотеки, отладчика и DLL используются для поддержки Unicode в MFC:

|||||
|-|-|-|-|
|UAFXCW. Lib|UAFXCW. Pdb|UAFXCWD. Lib|UAFXCWD. Pdb|
|MFC*версия*U.LIB|*MFC версия*U.PDB|MFC*версия*U.DLL|*Версия*МФЦ UD. Lib|
|*Версия*МФЦ UD. Pdb|*Версия*МФЦ UD. Dll|MFCS*версия*U.LIB|*MFCS версия*U.PDB|
|*MFCS версия*UD. Lib|*MFCS версия*UD. Pdb|MFCM*версия*U.LIB|MFCM*версия*U.PDB|
|MFCM*версия*U.DLL|MFCM*версия*UD. Lib|MFCM*версия*UD. Pdb|MFCM*версия*UD. Dll|

*(версия* представляет номер версии файла; например, версия '140' означает 14.0.)

`CString`основано на типе данных TCHAR. Если символ _UNICODE определен для сборки вашей программы, `wchar_t`TCHAR определяется как тип, 16-битный тип кодирования символов. В противном случае, TCHAR определяется как **символ**, нормальный 8-битный символ кодирования. Таким образом, под `CString` Unicode, a состоит из 16-битных символов. Без Unicode он состоит из символов символа **типа char**.

Для завершения программирования Unicode приложения необходимо также:

- Используйте _T макрос условно кодировать буквальные строки, чтобы быть портативными для Unicode.

- Когда вы проходите строки, обратите внимание на ли функциональные аргументы требуют длины в символах или длины в байтах. Разница важна, если вы используете строки Unicode.

- Используйте портативные версии функций обработки строкc-времени выполнения C.

- Используйте следующие типы данных для символов и указателей символов:

  - Используйте TCHAR, где вы будете использовать **символ**.

  - Используйте LPTSTR, где вы будете использовать **символ**<strong>\*</strong>.

  - Используйте LPCTSTR, где вы бы использовать **const char**<strong>\*</strong>. `CString`обеспечивает оператора LPCTSTR для `CString` преобразования между и LPCTSTR.

`CString`также поставляет конструкторов, операторов по назначениям, а также Unicode, операторов по доставке.

Ссылка на [библиотеку Run-Time](../c-runtime-library/c-run-time-library-reference.md) определяет портативные версии всех функций обработки строк. Для получения дополнительной информации [см.](../c-runtime-library/internationalization.md)

## <a name="mfc-support-for-mbcs-strings"></a>Поддержка MFC для mbCS струнных

Библиотека классов также включена для наборов мультибайт символов, но только для двухбайных наборов символов (DBCS).

В наборе мультибайт символов символ может быть шириной в один или два байта. Если это два байта в ширину, его первый байт представляет собой специальный "ведущий байт", который выбирается из определенного диапазона, в зависимости от того, какая страница кода используется. В совокупности свинец и «байты» указывают уникальное кодирование символов.

Если символ _MBCS определен для сборки вашей программы, `CString` введите TCHAR, на котором основана, карты для **обозначения**. Это до вас, чтобы определить, `CString` какие байты в свинца байтов и которые след байтов. C время времени библиотека поставляет функции, чтобы помочь вам определить это.

В соответствии с DBCS данная строка может содержать все однобайные символы ANSI, все символы с двойным байтом или комбинацию этих двух символов. Эти возможности требуют особого ухода при разборе строк. Это `CString` включает в себя объекты.

> [!NOTE]
> Сериализация строк Unicode в MFC может читать строки Unicode и MBCS независимо от того, какую версию приложения вы работаете. Файлы данных являются портативными между версиями программы Unicode и MBCS.

`CString`функции участника используют специальные версии «общего текста» функций C run-time, которые они вызывают, или они используют функции, осведомленные об Unicode. Поэтому, например, `CString` если функция `strcmp`обычно вызывается, она вызывает `_tcscmp` соответствующую функцию общего текста. В зависимости от того, как `_tcscmp` определяются _MBCS и _UNICODE символы, карты:

|||
|-|-|
|_MBCS определено|`_mbscmp`|
|_UNICODE определено|`wcscmp`|
|Ни один символ не определен|`strcmp`|

> [!NOTE]
> Символы _MBCS и _UNICODE являются взаимоисключающими.

Отображение функций общего текста для всех процедур обработки строк времен выполнения обсуждается в [ссылке C Run-Time Library.](../c-runtime-library/c-run-time-library-reference.md) Для списка [см.](../c-runtime-library/internationalization.md)

Аналогичным `CString` образом методы реализуются с помощью общих картографов типов данных. Для включения как MBCS и Unicode, MFC `wchar_t`использует TCHAR для **char** или , LPTSTR для **char** <strong>\*</strong> `wchar_t*`или , и LPCTSTR для **const char** <strong>\*</strong> или `const wchar_t*`. Они обеспечивают правильное отображение для MBCS или Unicode.

## <a name="see-also"></a>См. также раздел

[Струны (ATL/MFC)](../atl-mfc-shared/strings-atl-mfc.md)<br/>
[Манипуляция строками](../c-runtime-library/string-manipulation-crt.md)
