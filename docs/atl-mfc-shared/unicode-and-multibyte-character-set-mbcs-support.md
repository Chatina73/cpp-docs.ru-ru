---
title: Поддержка Юникода и многобайтовой кодировки
ms.date: 1/09/2017
helpviewer_keywords:
- MFC [C++], character set support
- MBCS [C++], strings and MFC support
- strings [C++], MBCS support in MFC
- character sets [C++], multibyte
- Unicode [C++], MFC strings
- Unicode [C++], string objects
- strings [C++], Unicode
- strings [C++], character set support
ms.openlocfilehash: 8a7f79f9a75c2be4ee855d89b47b6b8e59a67d15
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50596655"
---
# <a name="unicode-and-multibyte-character-set-mbcs-support"></a>Поддержка Юникода и многобайтовой кодировки

Некоторые языки, например, японский и китайский имеют объемные кодировки. Для поддержки программирования для этих рынков, Microsoft Foundation Class Library (MFC) включает два различных подхода к обработке объемные кодировки:

- [Юникод](#mfc-support-for-unicode-strings), `wchar_t` на основе расширенных символов и строк в кодировке UTF-16.

- [Наборов многобайтовых символов (MBCS)](#mfc-support-for-mbcs-strings), **char** на основе одного или двухбайтовые символы и строки, закодированы в набор символов, зависящих от языкового стандарта.

Корпорация Microsoft рекомендовала библиотеки MFC Юникода для разработки новых приложений и библиотек MBCS являлись нерекомендуемыми в Visual Studio 2013 и Visual Studio 2015. Этот режим больше не используется. Предупреждения об устаревании MBCS в Visual Studio 2017 будут удалены.

## <a name="mfc-support-for-unicode-strings"></a>Поддержка MFC для строк в Юникоде

Условно всей библиотеки классов MFC включена для символов Юникода и строк, хранимых в расширенных символов в кодировке UTF-16. В частности, класс [CString](../atl-mfc-shared/reference/cstringt-class.md) поддержкой Юникода.

Эти библиотеки, отладчик и DLL-файлы используются для поддержки Юникод в MFC:

|||||
|-|-|-|-|
|UAFXCW. LIB|UAFXCW. PDB-ФАЙЛ|UAFXCWD. LIB|UAFXCWD. PDB-ФАЙЛ|
|MFC*версии*U.LIB|MFC*версии*U.PDB|MFC*версии*U.DLL|MFC*версии*доменов обновления. LIB|
|MFC*версии*доменов обновления. PDB-ФАЙЛ|MFC*версии*доменов обновления. БИБЛИОТЕКИ DLL|MFCS*версии*U.LIB|MFCS*версии*U.PDB|
|MFCS*версии*доменов обновления. LIB|MFCS*версии*доменов обновления. PDB-ФАЙЛ|MFCM*версии*U.LIB|MFCM*версии*U.PDB|
|MFCM*версии*U.DLL|MFCM*версии*доменов обновления. LIB|MFCM*версии*доменов обновления. PDB-ФАЙЛ|MFCM*версии*доменов обновления. БИБЛИОТЕКИ DLL|

(*версии* представляет номер версии файла; например, "140" означает, что версии 14.0.)

`CString` основан на типе данных TCHAR. Если для построения программы определен символ _UNICODE, TCHAR определен как тип `wchar_t`, 16-разрядный символ, тип кодировки. В противном случае TCHAR определяется как **char**, обычный 8-битовой кодировкой символов. Таким образом, в Юникод `CString` состоит из 16-разрядных символов. Без Юникода, он состоит из символов типа **char**.

Для завершения Юникод программирование приложения, необходимо также:

- Используйте макрос _T в условно литерала строки кода можно перенести в Юникоде.

- При передаче строки, обратите внимание на аргументы функции, требуется ли длина в символах или длина в байтах. Различие очень важно, если вы используете строки в Юникоде.

- Используйте портативных версиях функции обработки строк C времени выполнения.

- Используйте следующие типы данных для символов и указателей символов:

   - Использовать TCHAR, вы можете использовать **char**.

   - Использовать LPTSTR, вы можете использовать **char**<strong>\*</strong>.

   - Использования LPCTSTR, вы можете использовать **const char**<strong>\*</strong>. `CString` предоставляет оператор LPCTSTR для преобразования между `CString` и LPCTSTR.

`CString` также предоставляет Юникод конструкторы, операторы присваивания и операторы сравнения.

[Справочник по библиотеке времени выполнения](../c-runtime-library/c-run-time-library-reference.md) определяет портативных версиях всех функций обработки строк. Дополнительные сведения см. в разделе категории [интернационализации](../c-runtime-library/internationalization.md).

## <a name="mfc-support-for-mbcs-strings"></a>Поддержка MFC для MBCS строк

Библиотека классов также предусмотрена поддержка многобайтовых кодировок, но только для двухбайтовых символов задает (DBCS).

В многобайтовую кодировку может содержать один или два байта. Если это два байта, его первый байт является специальной «старший байт» то есть выбранный из определенного диапазона, в зависимости от того, какой код страницы уже используется. Взятые вместе, ведущий и «младшие байты» укажите уникальный кодировка.

Если символ _MBCS определено для построения программы, введите TCHAR, на котором `CString` основана, сопоставляется **char**. Разработчик, чтобы определить, какие байты в `CString` , старшие байты, а какие — младший байт. Библиотеки времени выполнения C предоставляет функции, которые помогут определить это.

В разделе DBCS данной строки может содержать все однобайтовых символов ANSI, все двухбайтовые символы или сочетание двух. Эти возможности требуют особой осторожности при анализе строки. Сюда входят `CString` объектов.

> [!NOTE]
> Сериализация строки Юникода в MFC может считывать строки Юникода и MBCS независимо от того, какая версия приложения, которое вы используете. Файлы данных могут переноситься между Юникод и многобайтовая Кодировка версиях программы.

`CString` функции-члены используются специальные «универсальный text» версии функций времени выполнения C, которые они вызывают, или они используют Юникод функции. Таким образом, например если `CString` обычно вызывается функция `strcmp`, он вызывает соответствующую функцию универсальные текстовые `_tcscmp` вместо этого. В зависимости от того, как определяются _UNICODE и _MBCS символы `_tcscmp` сопоставляет следующим образом:

|||
|-|-|
|_MBCS определено|`_mbscmp`|
|_UNICODE определено|`wcscmp`|
|Символ, не определен|`strcmp`|

> [!NOTE]
> _UNICODE и _MBCS символы являются взаимоисключающими.

Сопоставления универсальных текстовых функций для все подпрограммы обработки строк во время выполнения, рассматриваются в [Справочник по библиотеке времени выполнения C](../c-runtime-library/c-run-time-library-reference.md). Список, см. в разделе [интернационализации](../c-runtime-library/internationalization.md).

Аналогичным образом `CString` методы реализуются с помощью сопоставления типов универсальных данных. Чтобы включить многобайтовой Кодировки и Юникода, MFC использует TCHAR для **char** или `wchar_t`, LPTSTR для **char** <strong>\*</strong> или `wchar_t*`и LPCTSTR для **const char** <strong>\*</strong> или `const wchar_t*`. Позволяют проверить правильного сопоставления для MBCS или Юникод.

## <a name="see-also"></a>См. также

[Строки (ATL/MFC)](../atl-mfc-shared/strings-atl-mfc.md)<br/>
[Операции со строками](../c-runtime-library/string-manipulation-crt.md)
