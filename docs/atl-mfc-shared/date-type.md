---
title: Тип даты
ms.date: 11/04/2016
f1_keywords:
- DATE
helpviewer_keywords:
- Date data type, implementing
- Date data type
- DATE type
- Date data type, about Date data type
- MFC, date and time
- hour values representation
ms.assetid: 695853ed-b614-4575-b793-b8c287372038
ms.openlocfilehash: 5a6c1e1cca5b2cb978d6af4208377db1a2926357
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91502176"
---
# <a name="date-type"></a>Тип даты

Тип даты реализуется с помощью 8-байтового числа с плавающей запятой. Дни представлены целым числом приращений, начиная с 30 декабря 1899, полночь как нулевое время. Значение часа выражается абсолютным значением дробной части числа. В следующей таблице показано несколько дат с числовым эквивалентом типа даты.

|Дата и время|Представление|
|-------------------|--------------------|
|30 декабря 1899, полночь|0,00|
|1 января 1900 г., полночь|2,00|
|4 января 1900 г., полночь|5.00|
|4 января 1900 г., 6 часов утра|5.25|
|4 января 1900 г., 12:00|5.50|
|4 января 1900 г., 09:00|5.875|

Тип даты и времени, а также `COleDateTime` класс, представляет даты и время в виде классической числовой строки. `COleDateTime`Класс содержит несколько методов для управления ЗНАЧЕНИЯМИ дат, включая преобразование в другие распространенные форматы даты и из них.

При работе с этими форматами даты и времени в службе автоматизации следует отметить следующие моменты:

- Даты указываются в местном времени; синхронизация должна выполняться вручную при работе с датами в различных часовых поясах.

- В типах дат не учитывается летнее время.

- Временная шкала даты преобразуется для значений даты меньше 0 (до 30 декабря 1899). Это связано с тем, что целая часть значения Date считается подписанной, а дробная часть считается неподписанной. Иными словами, часть значения даты может быть положительной или отрицательной, а дробная часть значения даты всегда добавляется к общей логической дате. В следующей таблице приведено несколько примеров.

|Дата и время|Представление|
|-------------------|--------------------|
|27 декабря 1899 г., полночь|-3.00|
|28 декабря 1899 г., 12:00|-2.50|
|28 декабря 1899 г., полночь|-2.00|
|29 декабря 1899, полночь|-1.00|
|30 декабря 1899 г., 18:00|-0.75|
|30 декабря 1899 г., 12:00|-0.50|
|30 декабря 1899 г., 6 часов утра|-0.25|
|30 декабря 1899, полночь|0,00|
|30 декабря 1899 г., 6 часов утра|0,25|
|30 декабря 1899 г., 12:00|0,50|
|30 декабря 1899 г., 18:00|0,75|
|31 декабря 1899, полночь|1.00|
|1 января 1900 г., полночь|2,00|
|1 января 1900 г., 12:00|2,50|
|2 января 1900 г., полночь|3.00|

> [!CAUTION]
> Обратите внимание, что, поскольку 6:00 AM всегда представляется в дробном значении 0,25, независимо от того, является ли целое число, представляющее день, положительным (после 30 декабря 1899) или отрицательным (до 30 декабря 1899 года), простое сравнение с плавающей запятой будет ошибочно отсортировать любую дату, представляющую 6:00, в день раньше *, чем 12/30/1899* .

Дополнительные сведения о проблемах, связанных с датой и `COleDateTime` типами, можно найти в разделе [класс COleDateTime](../atl-mfc-shared/reference/coledatetime-class.md) и [Дата и время: Поддержка автоматизации](./date-and-time.md).

## <a name="see-also"></a>См. также раздел

[Дата и время](../atl-mfc-shared/date-and-time.md)<br/>
[Класс COleDateTime](../atl-mfc-shared/reference/coledatetime-class.md)
