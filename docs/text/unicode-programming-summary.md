---
title: Общие сведения о программировании Юникода
ms.date: 11/04/2016
helpviewer_keywords:
- Unicode [C++], programming with
- Unicode [C++], MFC and C run-time functions
ms.assetid: a4c9770f-6c9c-447c-996b-980920288bed
ms.openlocfilehash: df9335fa2fc66ebba73b5c92ecd8007ca435f499
ms.sourcegitcommit: ff3cbe4235b6c316edcc7677f79f70c3e784ad76
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/19/2018
ms.locfileid: "53627271"
---
# <a name="unicode-programming-summary"></a>Общие сведения о программировании Юникода

Чтобы воспользоваться преимуществами поддержки времени выполнения MFC и C для Юникода, вам потребуется:

- Определение `_UNICODE`.

   Определите символ `_UNICODE` перед созданием программы.

- Укажите точку входа.

   На **Дополнительно** странице **компоновщика** папку в проекте [страницы свойств](../ide/property-pages-visual-cpp.md) диалоговом окне set **точки входа** символ `wWinMainCRTStartup`.

- Используйте переносимые функции времени выполнения и типы.

   Используйте соответствующие функции времени выполнения C для обработки строк Юникода. Можно использовать `wcs` семейство функций, но вы, возможно, предпочтете полностью portable (международно включено) `_TCHAR` макросы. Эти макросы начинаются с `_tcs`; они однозначно заменяют одно, для `str` семейству функций. Эти функции описаны подробно [интернационализации](../c-runtime-library/internationalization.md) раздел *Справочник по библиотеке времени выполнения*. Дополнительные сведения см. в разделе [универсальные текстовые сопоставления в файле tchar.h](../text/generic-text-mappings-in-tchar-h.md).

   Используйте `_TCHAR` и типов, связанных переносимых данных, описанных в [поддержка Юникода](../text/support-for-unicode.md).

- Правильно обрабатывать строковые литералы.

   Visual C++ компилятор интерпретирует код в виде строковых литералов:

    ```cpp
    L"this is a literal string"
    ```

   для обозначения строку символов Юникода. Можно использовать тот же префикс для строковых литералов. Используйте `_T` макрос для кодирования строк-литералов в общем случае, поэтому они компилируются как строки Юникода в Юникод или как строки ANSI (включая MBCS) без Юникода. Например вместо следующего кода:

    ```cpp
    pWnd->SetWindowText( "Hello" );
    ```

   Использование:

    ```cpp
    pWnd->SetWindowText( _T("Hello") );
    ```

   С помощью `_UNICODE` определены, `_T` преобразует строковые литералы с префиксом L формы; в противном случае `_T` преобразует строку без префикса L.

    > [!TIP]
    >  `_T` Макрос идентична `_TEXT` макрос.

- Будьте внимательны передаче длинных строк в функции.

   Некоторые функции определяется количество знаков в строке; другим пользователям требуется число байтов. Например если `_UNICODE` определен, следующий вызов `CArchive` объект не будет работать (`str` — `CString`):

    ```cpp
    archive.Write( str, str.GetLength( ) );    // invalid
    ```

   В приложении Юникод длина дает число символов, но не нужное количество байтов, так как каждый символ занимает 2 байта. Вместо этого необходимо использовать:

    ```cpp
    archive.Write( str, str.GetLength( ) * sizeof( _TCHAR ) );    // valid
    ```

   который указывает количество байтов для записи.

   Тем не менее функции-члены MFC, ориентированных на символ, а не ориентированный на байты, работают без дополнительного кодирования:

    ```cpp
    pDC->TextOut( str, str.GetLength( ) );
    ```

   `CDC::TextOut` принимает определенное число символов, не является числом байтов.

- Используйте [fopen_s, _wfopen_s](../c-runtime-library/reference/fopen-s-wfopen-s.md) для открытия файлов в кодировке Юникод.

Таким образом, MFC и библиотеки времени выполнения обеспечивают поддержку для программирования Юникода:

- За исключением функций-членов класса базы данных все функции MFC поддерживают Юникод, включая `CString`. `CString` также предоставляет функции преобразования Юникода/ANSI.

- Библиотеки времени выполнения предоставляет версии Юникода для всех функций обработки строк. (Библиотеки времени выполнения также предоставляет переносимые версии, подходящие для Юникода или для многобайтовой Кодировки. Это `_tcs` макросы.)

- Tchar.h предоставляет типы переносимых данных и `_T` макрос для преобразования строковых литералов и знаков. Дополнительные сведения см. в разделе [универсальные текстовые сопоставления в файле tchar.h](../text/generic-text-mappings-in-tchar-h.md).

- Библиотеки времени выполнения предоставляет версию расширенных символов `main`. Используйте `wmain` сделать приложение поддерживают Юникод.

## <a name="see-also"></a>См. также

[Поддержка Юникода](../text/support-for-unicode.md)
