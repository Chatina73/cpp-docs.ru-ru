---
title: Поддержка многобайтовых кодировок
ms.date: 11/04/2016
helpviewer_keywords:
- MBCS [C++], about MBCS
- character sets [C++], multibyte
- multibyte characters [C++]
- MBCS [C++]
ms.assetid: b498733c-a1e1-45e3-8f26-d6da3cb5f2dd
ms.openlocfilehash: 0b43168ec4331e99dea7e939b097674cc880804e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375766"
---
# <a name="support-for-multibyte-character-sets-mbcss"></a>Поддержка многобайтовых кодировок

Многобайтовые кодировки (MBCS) — это более старый подход к поддержке кодировок, подобных японской и китайской, которые не могут быть представлены одним байтом. Для разработки новых приложений следует использовать Юникод для всех текстовых строк, за исключением, возможно, системных строк, которые не видны пользователям. MBCS — это устаревшая технология, которая не рекомендуется для разработки новых приложений.

Наиболее распространенная реализация многобайтовой кодировки — двухбайтовая кодировка (DBCS). Visual C++ в целом и MFC в частности полностью поддерживают DBCS.

Примеры см. в файлах исходного кода MFC.

Для платформ, использующих объемные кодировки, наилучшая альтернатива Юникоду — это MBCS. MFC поддерживает MBCS с помощью интернациализируемых типов данных и функций времени выполнения C. То же следует сделать и в вашем коде.

В MBCS символы кодируются одним или двумя байтами. В двухбайтовых символах первый или старший байт указывает, что он и следующий байт должны интерпретироваться как один символ. Первый байт относится к диапазону кодов, зарезервированных для использования в качестве старших байтов. То, какие диапазоны байтов могут быть старшими байтами, зависит от используемой кодовой страницы. Например, японская кодовая страница 932 использует в качестве старших байтов диапазон 0x81–0x9F, но корейская кодовая страница 949 использует другой диапазон.

Учитывайте следующие аспекты при программировании с использованием MBCS.

Символы MBCS в среде mbCS могут отображаться в строках, таких как имена файлов и каталогов.

### <a name="editing-operations"></a>Операции редактирования

Операции редактирования в приложениях с MBCS должны работать с символами, а не байтами. Карет не должен разделять персонажа, **ключ Правой Стрелки** должен двигаться вправо одним персонажем и так далее. **Удалить** следует удалить символ; **Отменить** должны восстановить его.

### <a name="string-handling"></a>Обработка строк

В приложении, использующем MBCS, обработка строк вызывает особые проблемы. Символы из одного и двух байтов могут быть перемешаны в одной строке. Поэтому необходимо всегда проверять старшие байты.

### <a name="run-time-library-support"></a>Поддержка библиотеки времени выполнения

Библиотеки времени выполнения языка C и MFC поддерживают однобайтовые и многобайтовые кодировки, а также Юникод. Строки с одним байтом `str` обрабатываются с семейством функций времени выполнения, строки MBCS обрабатываются с соответствующими `_mbs` функциями, а строки Unicode обрабатываются с соответствующими `wcs` функциями. В реализациях функций-членов классов MFC используются переносимые функции времени выполнения, которые в некоторых обстоятельствах сопоставляются с обычным семейством функций `str`, функциями MBSC или функциями Юникода, как описано в разделе "Переносимость MBSC и Юникода".

### <a name="mbcsunicode-portability"></a>Переносимость MBSC и Юникода

Используя файл заголовка tchar.h, можно создавать приложения с одним байтом, MBCS и Unicode из одних и тех же источников. Tchar.h определяет макросы, приложенные `str` `_mbs`с `wcs` *_tcs,* на какую карту, или функции, по мере необходимости. Чтобы построить MBCS, `_MBCS`определите символ. Чтобы построить Unicode, `_UNICODE`определите символ. По умолчанию `_UNICODE` определяется для приложений MFC. Для получения дополнительной информации [см.](../text/generic-text-mappings-in-tchar-h.md)

> [!NOTE]
> Поведение не определено, `_UNICODE` если `_MBCS`вы определяете оба и .

Файлы заголовков Mbctype.h и Mbstring.h определяют функции и макросы MBCS, которые могут понадобиться в некоторых случаях. Например, `_ismbblead` сообщает, является ли указанный байт в строке старшим.

Для международной переносимости кодируйте свою программу с помощью [наборов символов Unicode](../text/support-for-unicode.md) или multibyte (MBCSs).

## <a name="what-do-you-want-to-do"></a>Выбор действия

- [Реализация многобайтовой кодировки в приложениях](../text/international-enabling.md)

- [Одновременное использование Юникода и многобайтовых кодировок в программе](../text/internationalization-strategies.md)

- [Использование MBSC для создания многоязыковых программ](../text/mbcs-programming-tips.md)

- [См. сводную информация о программировании с использованием MBCS](../text/mbcs-programming-tips.md)

- [Сведения о переносимости обычного текста в байтовый формат](../text/generic-text-mappings-in-tchar-h.md)

## <a name="see-also"></a>См. также раздел

[Текст и струны](../text/text-and-strings-in-visual-cpp.md)<br/>
[Поддержка многобайтовой кодировки MBCS в Visual C++](../text/mbcs-support-in-visual-cpp.md)
