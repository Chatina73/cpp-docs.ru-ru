---
title: Универсальные текстовые сопоставления в файле tchar.h
ms.date: 11/04/2016
helpviewer_keywords:
- mapping generic-text
- generic-text mappings [C++]
- character sets [C++], generic-text mappings
- Unicode [C++], generic-text mappings
- MBCS [C++], generic-text mappings
- TCHAR.H data types, mapping
- mappings [C++], TCHAR.H
ms.assetid: 01e1bb74-5a01-4093-8720-68b6c1fdda80
ms.openlocfilehash: 779702aa33e2aa24bf5a380bd8435745cc0aadbd
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62410711"
---
# <a name="generic-text-mappings-in-tcharh"></a>Универсальные текстовые сопоставления в файле tchar.h

Чтобы упростить преобразование кода для международного использования, библиотека времени выполнения Microsoft предоставляет характерные для Майкрософт универсальные текстовые сопоставления для многих типов данных, подпрограмм и других объектов. Вы можете использовать эти сопоставления, которые определены в файле tchar.h, для написания общего кода, который можно скомпилировать в однобайтовой, многобайтовой кодировке или наборы символов Юникода, в зависимости от константы манифеста, определяются с помощью `#define` инструкции. Универсальные текстовые сопоставления представляют собой расширения Microsoft, несовместимые со стандартами ANSI.

С помощью tchar.h, можно построить однобайтовые, многобайтовые кодировку (MBCS) и приложений Юникода тот же источник. В файле Tchar.h определяются макросы (с префиксом `_tcs`), с помощью правильных определений препроцессора, сопоставляются `str`, `_mbs`, или `wcs` соответствующие функции. Для использования mbsc определите символ `_MBCS`. Для использования Юникода определите символ `_UNICODE`. Чтобы построить приложение однобайтовые, определить ни (по умолчанию). По умолчанию `_UNICODE` определяется для приложений MFC.

`_TCHAR` Тип данных определяется в файле tchar.h условно. Если символ `_UNICODE` определен для построения, `_TCHAR` определяется как **wchar_t**; в противном случае для однобайтовой и многобайтовой Кодировки сборок, он определяется как **char**. (**wchar_t**, базовый тип данных расширенных символов Юникода, являющийся аналогом 16-разрядное автоматический 8-разрядное **char**.) Для приложения на разных языках, используйте `_tcs` семейству функций, которые работают в `_TCHAR` единицы, не в байтах. Например `_tcsncpy` копий `n` `_TCHARs`, а не `n` байт.

Так как некоторые один байт символов значение (SBCS) функции обработки строк (со знаком) `char*` параметры, приведет к Предупреждение компилятора Несоответствие типа при `_MBCS` определен. Чтобы устранить это предупреждение тремя способами:

1. Использование преобразователей подставляемых типобезопасных функций, содержащихся в файле tchar.h. Это поведение установлено по умолчанию.

1. Использование макроса в файле tchar.h, определив `_MB_MAP_DIRECT` в командной строке. После этого необходимо сопоставить типы вручную. Это — самый быстрый способ, но не является строго типизированным.

1. Использование преобразователей типобезопасный статически скомпонованной библиотекой функций, содержащихся в файле tchar.h. Для этого необходимо определить константу `_NO_INLINING` в командной строке. Это самый медленный и в то же время самый типобезопасный способ.

### <a name="preprocessor-directives-for-generic-text-mappings"></a>Директивы препроцессора для универсальных текстовых сопоставлений

|Определите #|Скомпилированная версия|Пример|
|---------------|----------------------|-------------|
|`_UNICODE`|Юникод (расширенные символы)|`_tcsrev` сопоставляется с `_wcsrev`|
|`_MBCS`|Многобайтовые символы|`_tcsrev` сопоставляется с `_mbsrev`|
|Нет (значение по умолчанию не имеет ни `_UNICODE` , ни `_MBCS` определенные)|Однобайтовая кодировка (ASCII)|`_tcsrev` сопоставляется с `strrev`|

Например, универсальная текстовая функция `_tcsrev`, который определен в файле tchar.h, сопоставляется `_mbsrev` Если были определены `_MBCS` в программе или `_wcsrev` Если были определены `_UNICODE`. В противном случае `_tcsrev` сопоставляется с `strrev`. Для удобства программирования в tchar.h предусмотрены другие сопоставления типов данных, но `_TCHAR` является наиболее эффективным.

### <a name="generic-text-data-type-mappings"></a>Сопоставления типов данных универсального текста

|Универсальные текстовые<br /> Имя типа данных|_UNICODE &AMP;<br /> _MBCS не определены|_MBCS<br /> Определено|_UNICODE<br /> Определено|
|--------------------------------------|----------------------------------------|------------------------|---------------------------|
|`_TCHAR`|**char**|**char**|**wchar_t**|
|`_TINT`|**int**|**unsigned int**|`wint_t`|
|`_TSCHAR`|**char со знаком**|**char со знаком**|**wchar_t**|
|`_TUCHAR`|**unsigned char**|**unsigned char**|**wchar_t**|
|`_TXCHAR`|**char**|**unsigned char**|**wchar_t**|
|`_T` или `_TEXT`|Не действует (удаляется препроцессором)|Не действует (удаляется препроцессором)|`L` (преобразует следующий символ или строку в аналог в Юникоде)|

Список универсальных текстовых сопоставлений подпрограмм, переменных и других объектов, см. в разделе [универсальные текстовые сопоставления](../c-runtime-library/generic-text-mappings.md) справочника по библиотеке времени выполнения.

> [!NOTE]
>  Не используйте `str` семейство функций со строками Юникода, которые, скорее всего, содержат встроенные пустые байты. Аналогичным образом, не используйте `wcs` семейства функций с многобайтовой Кодировки (SBCS) строк.

В следующих примерах кода показано использование функций `_TCHAR` и `_tcsrev` для сопоставления моделям многобайтовой кодировки, Юникод и однобайтовой кодировки.

```cpp
_TCHAR *RetVal, *szString;
RetVal = _tcsrev(szString);
```

Если `_MBCS` был определен, препроцессор сопоставляет этот фрагмент этот код:

```cpp
char *RetVal, *szString;
RetVal = _mbsrev(szString);
```

Если `_UNICODE` был определен, препроцессор сопоставляет этот фрагмент этот код:

```cpp
wchar_t *RetVal, *szString;
RetVal = _wcsrev(szString);
```

Если ни один из `_MBCS` , ни `_UNICODE` были определены, препроцессор сопоставляет этот фрагмент коду ASCII однобайтовые, следующим образом:

```cpp
char *RetVal, *szString;
RetVal = strrev(szString);
```

Таким образом вы можете написать, обслуживать и компилировать файл единый исходный код для запуска с подпрограммами, использующими любую из трех описанных выше кодировок.

## <a name="see-also"></a>См. также

[Текст и строки](../text/text-and-strings-in-visual-cpp.md)<br/>
[Использование типов данных TCHAR.H с кодом _MBCS](../text/using-tchar-h-data-types-with-mbcs-code.md)
