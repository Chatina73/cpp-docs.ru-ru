---
title: Настраивает совместимую с FIPS безопасную удаленную разработку для Linux
description: Сведения о настройке FIPS-совместимого криптографического подключения между Visual Studio и компьютером Linux для удаленной разработки.
ms.date: 01/17/2020
ms.openlocfilehash: 9a0e87f4ddf69bf489b52d4f83934d3279f2d085
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "76520465"
---
# <a name="set-up-fips-compliant-secure-remote-linux-development"></a>Настраивает совместимую с FIPS безопасную удаленную разработку для Linux

::: moniker range="<=vs-2017"

Поддержка Linux реализована в Visual Studio версии 2017 и выше. Возможность совместимой с FIPS безопасной удаленной разработки для Linux доступна в Visual Studio 2019 версии 16.5 и более поздних версиях.

::: moniker-end

::: moniker range="vs-2019"

Federal Information Processing Standard (FIPS) Publication 140-2 (Федеральный стандарт по обработке информации) — это стандарт безопасности правительства США для криптографических модулей. Реализации стандарта утверждаются институтом NIST. В Windows представлена [проверенная поддержка FIPS-совместимых криптографических модулей](/windows/security/threat-protection/fips-140-validation). В Visual Studio 2019 версии 16.5 и более поздних можно использовать безопасное FIPS-совместимое криптографическое подключение к системе Linux для удаленной разработки.

В этой статье приводятся инструкции по настройке безопасного FIPS-совместимого подключения между Visual Studio и удаленной системой Linux. Они применимы при создании проектов Linux CMake или MSBuild в Visual Studio. Эта статья представляет собой версию инструкций по настройке FIPS-совместимого подключения, которые приведены в документе о [подключении к удаленному компьютеру Linux](connect-to-your-remote-linux-computer.md).

## <a name="prepare-a-fips-compliant-connection"></a>Подготовка FIPS-совместимого подключения

Для использования FIPS-совместимого криптографически безопасного SSH-подключения между Visual Studio и удаленной системой Linux требуется выполнить ряд подготовительных процедур. Для обеспечения совместимости с FIPS-140-2 Visual Studio поддерживает только ключи RSA.

В примерах в этой статье используется Ubuntu 18.04 LTS с сервером OpenSSH версии 7.6. Для всех дистрибутивов с относительно недавней версией OpenSSH следует придерживаться одинаковых инструкций.

### <a name="to-set-up-the-ssh-server-on-the-remote-system"></a>Настройка сервера SSH в удаленной системе

1. В системе Linux установите и запустите сервер OpenSSH.

   ```bash
   sudo apt install openssh-server
   sudo service ssh start
   ```

1. Чтобы сервер SSH автоматически запускался при загрузке системы, выполните команду systemctl.

   ```bash
   sudo systemctl enable ssh
   ```

1. Откройте */etc/ssh/sshd_config* с правами root. Измените (или добавьте, если они не существуют) следующие строки:

   ```config
   Ciphers aes256-cbc,aes192-cbc,aes128-cbc,3des-cbc
   HostKeyAlgorithms ssh-rsa
   KexAlgorithms diffie-hellman-group-exchange-sha256,diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1
   MACs hmac-sha2-256,hmac-sha1
   ```

   > [!NOTE]
   > ssh-rsa — это единственный FIPS-совместимый алгоритм ключа узла, поддерживаемый VS. Алгоритмы aes\*-ctr также совместимы с FIPS, но их реализация в Visual Studio не утверждена. Алгоритмы обмена ключами ecdh-\* совместимы с FIPS, но не поддерживаются в Visual Studio.

   Вы также можете использовать другие параметры. Можно настроить SSH для использования дополнительных шифров, алгоритмов ключей узлов и т. д. Также доступны и другие важные параметры безопасности, которые стоит рассмотреть, — `PermitRootLogin`, `PasswordAuthentication` и `PermitEmptyPasswords`. Дополнительные сведения см. на справочной странице по sshd_config или в статье о [конфигурации сервера SSH](https://www.ssh.com/ssh/sshd_config).

1. После сохранения и закрытия sshd_config перезапустите сервер SSH, чтобы применить новую конфигурацию.

   ```bash
   sudo service ssh restart
   ```

Далее вы создадите пару ключей RSA на компьютере Windows. Затем вы скопируете открытый ключ в удаленную систему Linux для использования SSH.

### <a name="to-create-and-use-an-rsa-key-file"></a>Создание и использование файла ключа RSA

1. На компьютере Windows создайте пару открытого и закрытого ключей RSA с помощью следующей команды:

   ```cmd
   ssh-keygen -t rsa -b 4096
   ```

   У вас будет пара, состоящая из открытого и закрытого ключей. По умолчанию ключи сохраняются в *%USERPROFILE%\\.ssh\\id_rsa* и *%USERPROFILE%\\.ssh\\id_rsa.pub*. (В PowerShell вместо макроса cmd `%USERPROFILE%` нужно использовать `$env:USERPROFILE`.) В случае изменения имени ключа используйте новое имя в последующих шагах.  В целях повышения безопасности рекомендуется использовать парольную фразу.

1. Скопируйте открытый ключ из Windows на компьютер Linux.

   ```cmd
   scp %USERPROFILE%\.ssh\id_rsa.pub user@hostname:
   ```

1. В системе Linux добавьте этот ключ в список авторизованных ключей и убедитесь, что для файла установлены правильные разрешения.

   ```bash
   cat ~/id_rsa.pub >> ~/.ssh/authorized_keys
   chmod 600 ~/.ssh/authorized_keys
   ```

1. Теперь можно проверить, работает ли новый ключ в SSH. Выполните с его помощью вход из Windows.

    ```cmd
    ssh -i %USERPROFILE%\.ssh\id_rsa user@hostname
    ```

Вы успешно настроили SSH, создали и развернули ключи шифрования и проверили подключение. Теперь вы можете настроить подключение в Visual Studio.

## <a name="connect-to-the-remote-system-in-visual-studio"></a>Подключение к удаленной системе в Visual Studio

1. Чтобы в Visual Studio открыть диалоговое окно **Параметры**, в строке меню выберите **Сервис > Параметры**. Затем выберите **Кроссплатформенный > Диспетчер подключений**, чтобы открыть диалоговое окно диспетчера подключений.

   Если подключение в Visual Studio не было настроено ранее, это диалоговое окно откроется при первом создании проекта.

1. В диалоговом окне диспетчера подключений нажмите кнопку **Добавить**, чтобы добавить новое подключение.

   ![Диспетчер подключений](media/settings_connectionmanager.png)

   Откроется окно **Подключение к удаленной системе**.

   ![Подключение к удаленной системе](media/connect.png)

1. В диалоговом окне **Подключение к удаленной системе** введите сведения о подключении удаленного компьютера.

   | Ввод | Описание
   | ----- | ---
   | **Имя узла**           | Имя или IP-адрес целевого устройства
   | **Порт**                | Порт, в котором работает служба SSH, обычно 22
   | **Имя пользователя**           | Пользователь для проверки подлинности
   | **Тип проверки подлинности** | Выбор закрытого ключа для FIPS-совместимого подключения
   | **Файл закрытого ключа**    | Закрытый ключ, созданный для подключения по SSH
   | **Парольная фраза**          | Парольная фраза, используемая с закрытым ключом, выбранным выше

   Измените тип проверки подлинности, выбрав значение **Закрытый ключ**. В поле **Файл закрытого ключа** введите путь к закрытому ключу. Или нажмите кнопку **Обзор**, чтобы перейти к файлу закрытого ключа. Затем в поле **Парольная фраза** введите парольную фразу, используемую для шифрования файла закрытого ключа.

1. Нажмите кнопку **Подключить**, чтобы попытаться подключиться к удаленному компьютеру.

   Если соединение будет установлено успешно, Visual Studio настроит IntelliSense для использования удаленных заголовков. Подробнее см. раздел об [использовании IntelliSense для заголовков в удаленных системах](configure-a-linux-project.md#remote_intellisense).

   Если подключение установить не удастся, будут выделены красным цветом поля, информацию в которых нужно изменить.

   ![Ошибки диспетчера подключений](media/settings_connectionmanagererror.png)

   Дополнительные сведения об устранении неполадок с подключением см. в статье [Подключение к удаленному компьютеру Linux](connect-to-your-remote-linux-computer.md).

## <a name="command-line-utility-for-the-connection-manager"></a>Служебная программа командной строки для диспетчера подключений  

**Visual Studio 2019 версии 16.5 или более поздней**: ConnectionManager.exe — это программа командной строки для управления подключениями удаленной разработки вне Visual Studio. Ее удобно использовать для выполнения таких задач, как подготовка нового компьютера разработчика. Кроме того, с ее помощью можно настроить Visual Studio для непрерывной интеграции. Примеры и полные справочные сведения по командам ConnectionManager см. в статье [Справка по ConnectionManager](connectionmanager-reference.md).  

## <a name="optional-enable-or-disable-fips-mode"></a>Необязательные: Включение и отключение режима FIPS

Режим FIPS можно включить в Windows глобально.

1. Для включения режима FIPS нажмите **Windows+R**, чтобы открыть диалоговое окно "Выполнить", а затем запустите gpedit.msc.

1. Разверните узел **Политика локального компьютера > Конфигурация компьютера > Параметры Windows > Параметры безопасности > Локальные политики** и выберите **Параметры безопасности**.

1. В разделе **Политика** выберите **Системные средства шифрования: использовать FIPS-совместимые алгоритмы для шифрования, хэширования и подписывания**, а затем нажмите клавишу **ВВОД**, чтобы открыть соответствующее диалоговое окно.

1. На вкладке **Параметр локальной безопасности** выберите **Включен** или **Отключен**, а затем нажмите кнопку **ОК**, чтобы сохранить изменения.

> [!WARNING]
> Включение режима FIPS может привести к нарушению работы некоторых приложений. Дополнительные сведения см. в публикации блога о том, [почему больше не рекомендуется использовать режим FIPS](https://techcommunity.microsoft.com/t5/microsoft-security-baselines/why-we-8217-re-not-recommending-8220-fips-mode-8221-anymore/ba-p/701037).

## <a name="additional-resources"></a>Дополнительные ресурсы

[Документация Майкрософт по проверке FIPS 140](/windows/security/threat-protection/fips-140-validation)

[FIPS 140-2: Security Requirements for Cryptographic Modules](https://csrc.nist.gov/publications/detail/fips/140/2/final) (FIPS 140-2: требования безопасности для криптографических модулей) (автор: институт NIST)

[Cryptographic Algorithm Validation Program: Validation Notes](https://csrc.nist.gov/projects/cryptographic-algorithm-validation-program/Validation-Notes) (Программа проверки алгоритма шифрования: примечания к проверке) (автор: институт NIST)

Публикация блога Майкрософт о том, [почему больше не рекомендуется использовать режим FIPS](https://techcommunity.microsoft.com/t5/microsoft-security-baselines/why-we-8217-re-not-recommending-8220-fips-mode-8221-anymore/ba-p/701037)

[Конфигурация сервера SSH](https://www.ssh.com/ssh/sshd_config)

## <a name="see-also"></a>См. также

[Настройка проекта Linux](configure-a-linux-project.md)\
[Настройка проекта Linux CMake](cmake-linux-project.md)\
[Подключение к удаленному компьютеру Linux](connect-to-your-remote-linux-computer.md)\
[Развертывание, запуск и отладка проекта Linux](deploy-run-and-debug-your-linux-project.md)\
[Настройка сеансов отладки CMake](../build/configure-cmake-debugging-sessions.md)

::: moniker-end
