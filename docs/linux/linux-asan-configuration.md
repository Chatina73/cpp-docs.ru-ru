---
title: Настройка проектов Linux для использования санитайзера адресов
description: Описываются способы настройки C++ Linux проектов в Visual Studio для использования Sanitizer адрес.
ms.date: 06/07/2019
ms.openlocfilehash: 2415e8971614de35f046b699ce99c3822faf9372
ms.sourcegitcommit: 8adabe177d557c74566c13145196c11cef5d10d4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/10/2019
ms.locfileid: "66824173"
---
# <a name="configure-linux-projects-to-use-address-sanitizer"></a>Настройка проектов Linux для использования санитайзера адресов

В Visual Studio 2019 версии 16.1 AddressSanitizer (ASan) интегрирована в проектах Linux. Вы можете включить ASan для проектов CMake и Linux на основе MSBuild проектов. Он работает в удаленных системах Linux и в подсистеме Windows для Linux (WSL).

## <a name="about-asan"></a>О ASan

ASan является средства обнаружения ошибок среды выполнения памяти для C /C++ , перехватывает следующие ошибки:

- Использовать после свободного (несвязанные указатель ссылки)
- Переполнение буфера кучи
- Переполнение буфера стека
- Использовать после возврата
- Использовать после области
- Ошибки инициализации заказа

Когда ASan обнаруживает ошибку, он немедленно останавливает выполнение. При запуске приложения с поддержкой ASan в отладчике появится сообщение, описывающее тип ошибки, адрес памяти и расположение в исходном файле, где произошла ошибка:

   ![Сообщение об ошибке ASan](media/asan-error.png)

Можно также просмотреть все выходные данные ASan (включая где повреждение памяти выделено/освобожден) в панели отладки окна вывода.

## <a name="enable-asan-for-msbuild-based-linux-projects"></a>Включить ASan для Linux на основе MSBuild проектов

Чтобы включить ASan для Linux на основе MSBuild проектов, щелкните правой кнопкой мыши проект в **обозревателе решений** и выберите **свойства**. Затем перейдите к **свойства конфигурации** > **C /C++**  > **Sanitizers**. ASan включается с помощью компилятора и компоновщика флагов и требуется проект, чтобы быть перекомпилированы для работы.

![Включить ASan для проекта MSBuild](media/msbuild-asan-prop-page.png)

Вы можете передать необязательные флаги ASan среды выполнения, перейдя по адресу **свойства конфигурации** > **Отладка** > **флаги среды выполнения AddressSanitizer**. Щелкните стрелку вниз, чтобы добавить или удалить флаги.

![Настройка среды выполнения флаги ASan](media/msbuild-asan-runtime-flags.png)

## <a name="enable-asan-for-visual-studio-cmake-projects"></a>Включить ASan для проектов Visual Studio CMake

Чтобы включить ASan для CMake, щелкните правой кнопкой мыши файл CMakeLists.txt в **обозревателе решений** и выберите **параметры CMake для проекта**.

Убедитесь, что у вас есть конфигурация Linux (например, **Linux-Debug**) в левой части диалогового окна:

![Конфигурации отладки Linux](media/linux-debug-configuration.png)

Параметры ASan находятся под **Общие**. Введите флаги ASan среды выполнения в формате «флаг = значение», разделенных точкой с запятой.

![Конфигурации отладки Linux](media/cmake-settings-asan-options.png)

## <a name="install-the-asan-debug-symbols"></a>Установка отладочных символов ASan

Чтобы включить диагностику ASan, необходимо установить на удаленном компьютере Linux или установке WSL ее отладочных символов (libasan dbg). Версия libasan dbg, которые можно загрузить, зависит от версии GCC, установленным на компьютере Linux:

|**Версия ASan**|**Новую версию GCC**|
| --- | --- |
|libasan0|gcc 4.8|
|libasan2|gcc-5|
|libasan3|gcc 6|
|libasan4|gcc-7|
|libasan5|gcc-8|

Можно определить, какая версия GCC, у вас есть с помощью следующей команды.

```bash
gcc --version
```

Чтобы просмотреть версию libasan dbg, вам потребуется, запуск программы и взгляну на **Отладка** области **вывода** окна. Версия ASan, который загружается соответствует версии libasan dbg, необходимые на компьютер Linux. Можно использовать **Ctrl + F** для поиска «libasan» в окне. Если у вас есть libasan4, к примеру, вы увидите строку, аналогичную следующей:

```Output
Loaded '/usr/lib/x86_64-linux-gnu/libasan.so.4'. Symbols loaded.
```

Биты ASan отладки можно установить на дистрибутивов Linux, которые использовать apt, выполнив следующую команду. Эта команда устанавливает версии 4:

```bash
sudo apt-get install libasan4-dbg
```

Если ASan включена, Visual Studio отобразится в верхней части **Отладка** области **вывода** окно, чтобы установить ASan отладочные символы.
