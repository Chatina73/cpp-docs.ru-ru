---
title: Создание приложения Android Native Activity
ms.date: 10/17/2019
ms.assetid: 884014b1-5208-45ec-b0da-ad0070d2c24d
ms.openlocfilehash: f588c56acfd5c559e6b0bf1b8635e8b36c69548a
ms.sourcegitcommit: a673f6a54cc97e3d4cd032b10aa8dce7f0539d39
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/28/2020
ms.locfileid: "79469941"
---
# <a name="create-an-android-native-activity-app"></a>Создание приложения Android Native Activity

После установки кроссплатформенной рабочей нагрузки **Разработка мобильных приложений на языке C++** Visual Studio можно использовать для создания полнофункциональных приложений Android Native Activity. Пакет Android Native Development Kit (NDK) — это набор средств, с помощью которых можно реализовывать большинство возможностей приложения Android, используя чистый код C или C++. Для обеспечения взаимодействия кода C или C++ с Android используется определенный код Java JNI, выступающий в роли связующего. В Android NDK появилась возможность создавать приложения Native Activity с помощью API Android уровня 9. Код Native Activity популярен для создания игровых приложений и приложений с интенсивным использованием графики на основе Unreal Engine или OpenGL. В этом пошаговом руководстве показано создание простого приложения Native Activity, в котором используется OpenGL. В дополнительных разделах последовательно рассматриваются такие этапы жизненного цикла разработки, как редактирование, сборка, отладка и развертывание кода Native Activity.

## <a name="requirements"></a>Требования

Прежде чем создавать приложение Android Native Activity, необходимо убедиться, что вы выполнили все системные требования и установили рабочую нагрузку **Разработка мобильных приложений на языке C++** в Visual Studio. Дополнительные сведения см. в статье [Установка Visual C++ для разработки кроссплатформенных мобильных приложений на языке C++](../cross-platform/install-visual-cpp-for-cross-platform-mobile-development.md). Убедитесь, что необходимые сторонние инструменты и пакеты SDK включены в установку, а также что установлен эмулятор Android.

## <a name="create-a-new-native-activity-project"></a>Создание проекта Native Activity

В этом руководстве вы сначала создадите новый проект Android Native Activity, а затем создадите и запустите приложение по умолчанию в эмуляторе Android.

::: moniker range="vs-2017"

1. В Visual Studio выберите **файл** > **Новый** > **проект**.

1. В диалоговом окне **Новый проект** в разделе **шаблоны**выберите  **C++ Visual** > **Перекрестная платформа**, а затем выберите шаблон приложение для работы **с машинным кодом (Android)** .

1. Присвойте приложению имя, например *MyAndroidApp*, а затем нажмите **OK**.

   ![Создание проекта Native Activity](../cross-platform/media/cppmdd-newproject.png "Создание проекта Native Activity")

   Visual Studio создаст новое решение и откроет обозреватель решений.

   ![Проект Native Activity в обозревателе решений](../cross-platform/media/cppmdd-rc-na-solutionexp.png "Проект Native Activity в Solution Explorer")

::: moniker-end

::: moniker range=">=vs-2019"

1. В Visual Studio выберите **файл** > **Новый** > **проект**.

1. В диалоговом окне **Создание нового проекта** выберите шаблон **Приложение Native-Activity (Android)** , а затем нажмите **Далее**.

1. В диалоговом окне **Настроить новый проект** введите имя, например *MyAndroidApp* в разделе **Имя проекта**, а затем выберите **Создать**.

   Visual Studio создаст новое решение и откроет обозреватель решений.

::: moniker-end

В новое решение приложения Android Native Activity входят два проекта.

- `MyAndroidApp.NativeActivity` содержит ссылки и связующий код для запуска приложения как приложения Native Activity на Android. Реализация точек входа из связующего кода находится в файле *main.cpp*. Предкомпилированные заголовки находятся в файле *pch.h*. Этот проект приложения Native Activity компилируется в общую библиотеку (файл *SO*), которая передается в проект упаковки.

- `MyAndroidApp.Packaging` создает файл с расширением *.apk* для развертывания на устройстве или в эмуляторе Android. Он содержит ресурсы и файл *AndroidManifest.xml*, в котором задаются свойства манифеста. В него также входит файл *build.xml*, управляющий процессом сборки Ant. По умолчанию он задан как начальный проект, который можно развернуть и запустить непосредственно из Visual Studio.

## <a name="build-and-run-the-default-android-native-activity-app"></a>Создание и запуск приложения Android Native Activity по умолчанию

Разработайте и запустите приложение, созданное шаблоном, чтобы проверить установку и настройку. Для первоначального теста запустите приложение в одном из профилей устройств, установленных эмулятором Android. Если вы предпочитаете тестировать приложение на другой платформе, загрузите целевой эмулятор или подключите устройство к компьютеру.

## <a name="to-build-and-run-the-default-native-activity-app"></a>Сборка и запуск приложения Native Activity по умолчанию

1. Выберите пункт **x86** из раскрывающегося списка **Платформы решения** , если он еще не выбран.

     ![Выбор x86 из раскрывающегося списка решений платформ](../cross-platform/media/cppmdd-rc-na-solution-x86.png "Выбор раскрывающегося списка решений платформ x86")

     Если список **Платформы решения** не отображается, щелкните пункт **Платформы решения** из раскрывающегося списка **Добавить или удалить кнопки** и выберите свою платформу.

1. В строке меню последовательно выберите **Сборка** > **Собрать решение**.

     В окне "Выходные данные" отобразятся выходные данные процесса сборки для двух проектов в решении.

1. Выберите один из профилей эмулятора Android в качестве цели развертывания.

     Если вы установили другие эмуляторы или подключили устройство Android, то можете выбрать их в раскрывающемся списке платформы развертывания.

1. Нажмите **F5**, чтобы начать отладку, или **Shift**+**F5** для запуска без отладки.

   Вот как выглядит приложение по умолчанию в эмуляторе Android.

   ![Эмулятор, выполняющий ваше приложение](../cross-platform/media/cppmdd-emulator-running-app.png "Эмулятор, запускающий ваше приложение")

   Visual Studio запускает эмулятор, который за несколько секунд загружает и развертывает код. После запуска приложения можно задать точки останова и использовать отладчик для проверки кода, языковых стандартов и контрольных значений.

1. Для остановки отладки нажмите **SHIFT**+**F5**.

   Эмулятор является отдельным процессом, который продолжает выполняться. Вы можете изменять, компилировать и развертывать код несколько раз в одном эмуляторе.
