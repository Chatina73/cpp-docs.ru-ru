---
description: 'Дополнительные сведения о: Ошибка компилятора C2397'
title: Ошибка компилятора C2397
ms.date: 11/04/2016
f1_keywords:
- C2397
ms.assetid: b418cf5a-d50d-4a6c-98a7-994ae35046d1
ms.openlocfilehash: 8e5f000b8d0881fd6a57bb4895afbdef0e7c598a
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97145383"
---
# <a name="compiler-error-c2397"></a>Ошибка компилятора C2397

для преобразования из "type_1" в "type_2" требуется понижающие преобразования

При использовании однородной инициализации обнаружено неявное понижающие преобразование.

Язык C позволяет неявным сужающим преобразованиям в назначениях и инициализации, а C++ — в масти, даже несмотря на то, что непредвиденное ограничение является причиной многих ошибок в коде. Чтобы сделать код более безопасным, стандарт C++ требует диагностического сообщения при возникновении суженного преобразования в списке инициализации. В Visual C++ диагностика является ошибкой компилятора C2397 при использовании синтаксиса унифицированной инициализации, поддерживаемого начиная с Visual Studio 2015. Компилятор создает [Предупреждение компилятора (уровень 1) C4838](../../error-messages/compiler-warnings/compiler-warning-level-1-c4838.md) при использовании синтаксиса List или агрегатной инициализации, поддерживаемого Visual Studio 2013.

Сужение преобразования может быть допустимо, если известно, что допустимый диапазон преобразованных значений может помещаться в целевом объекте. В этом случае вы узнаете больше, чем делает компилятор. Если вы сделаете сужение преобразования намеренно, сделайте свои намерения явными с помощью статического приведения. В противном случае это сообщение об ошибке почти всегда указывает на наличие ошибки в коде. Его можно исправить, убедившись, что объекты, которые вы инициализируют, имеют типы, которые достаточно велики для работы с входными данными.

Следующий пример приводит к возникновению ошибки C2397 и демонстрирует один из способов его исправления:

```
// C2397.cpp -- C++ narrowing conversion diagnostics
// Compile by using: cl /EHsc C2397.cpp
#include <vector>

struct S1 {
    int m1;
    double m2, m3;
};

void function_C2397(double d1) {
    char c1 { 127 };          // OK
    char c2 { 513 };          // error C2397

    std::vector<S1> vS1;
    vS1.push_back({ d1, 2, 3 }); // error C2397

    // Possible fix if you know d1 always fits in an int
    vS1.push_back({ static_cast<int>(d1), 2, 3 });
}
```
