---
title: Компилятор C4866 предупреждение (уровень 4)
ms.date: 09/31/2018
f1_keywords:
- C4866
helpviewer_keywords:
- C4866
ms.openlocfilehash: 90f03b8f207fc8049b5b8939ada698493010e5ec
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50441032"
---
# <a name="compiler-warning-level-4-c4866"></a>Компилятор C4866 предупреждение (уровень 4)

> "_файл_(*line_number*)" компилятор не может принудительно применить порядок вычисления слева направо для вызова _имя_оператора_

## <a name="remarks"></a>Примечания

Начиная с версии C ++ 17, операнды операторов __-> \*__,  **\[]**, **>>**, и **\< \<** должны учитываться в порядке слева направо. Существует два случая, в которых компилятор не может гарантировать этот порядок:

- Если одно из выражений операндов — это объект, передаваемые по значению или содержит объекта, передаваемого по значению, или

- При компиляции с помощью [/CLR](../../build/reference/clr-common-language-runtime-compilation.md), и один из операндов является полем объекта или элемента массива.

Компилятор выдает предупреждение **C4866** когда он не может гарантировать оценки слева направо. Это предупреждение создается только в том случае, если [/std: c ++ 17](../../build/reference/std-specify-language-standard-version.md) или более поздней версии указывается, как требование порядке слева направо из этих операторов был введен в C ++ 17.

Это предупреждение отключено по умолчанию. можно использовать [/Wall](../../build/reference/compiler-option-warning-level.md) или __/w__*N*__4866__ Чтобы включить его в командной строке в качестве уровня *N* предупреждение, или Используйте директиву #pragma [предупреждение](../../preprocessor/warning.md) в файле исходного кода. Дополнительные сведения см. в разделе [выключенные по умолчанию предупреждения компилятора](../../preprocessor/compiler-warnings-that-are-off-by-default.md).

Это предупреждение впервые появился в Visual Studio 2017 версии 15.9 в результате изменений работы компилятора стандарта C ++ 17. Код, скомпилированный без предупреждений в версии компилятора, прежде чем Visual C++ 2017 версии 15.9 теперь можно создавать **C4866**. Сведения о том, как отключить предупреждения, появившиеся в версии определенного компилятора или более поздней версии, см. в разделе [предупреждения компилятора по версиям компилятора](compiler-warnings-by-compiler-version.md).

Чтобы устранить это предупреждение, сначала рассмотрите возможность оценки слева направо элементов оператор необходимости, например когда вычисление элементов может произвести зависящую от порядка побочные эффекты. Во многих случаях порядок, в котором вычисляются элементов имеет значительное влияние.

Если порядок вычисления должен быть слева направо, учитывать ли вы можете передавать элементы по **const** ссылку. Это изменение устраняет предупреждение в следующем образце кода.

## <a name="example"></a>Пример

Этот пример создает C4866 и показывает способ ее устранения:

```cpp
// C4866.cpp
// compile with: /w14866 /std:c++17

class HasCopyConstructor
{
public:
    int x;

    HasCopyConstructor(int x) : x(x) {}
    HasCopyConstructor(const HasCopyConstructor& h) : x(h.x) { }
};

int operator->*(HasCopyConstructor a, HasCopyConstructor b) { return a.x + b.x; }

// This version of operator->* does not trigger the warning:
// int operator->*(const HasCopyConstructor& a, const HasCopyConstructor& b) { return a.x + b.x; }

int main()
{
    HasCopyConstructor a{ 1 };
    HasCopyConstructor b{ 2 };

    a->*b;        // C4866 for call to operator->*
};
```
