---
title: Ошибка средств компоновщика LNK1104
description: Описание ошибки компоновщика Microsoft C и C++ (КОМПИЛЯТОРОМ MSVC) LNK1104, ее причин и возможных решений.
ms.date: 12/13/2019
f1_keywords:
- LNK1104
helpviewer_keywords:
- LNK1104
ms.assetid: 9ca6f929-0efc-4055-8354-3cf5b4e636dc
ms.openlocfilehash: 2eea6885537037db496a2f42e0fff0ffa69127e3
ms.sourcegitcommit: 12eb6a824dd7187a065d44fceca4c410f58e121e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/06/2020
ms.locfileid: "94334212"
---
# <a name="linker-tools-error-lnk1104"></a>Ошибка средств компоновщика LNK1104

> не удается открыть файл " *ИмяФайла* "

Эта ошибка возникает, когда компоновщику не удается открыть файл для чтения или записи. Ниже перечислены две наиболее распространенные причины этой проблемы.

- Программа уже запущена или загружена в отладчике, и

- пути к библиотеке неверны или не заключены в двойные кавычки.

Существует множество других возможных причин этой ошибки. Чтобы сократить их, сначала проверьте *Тип файла.* Затем используйте следующие разделы для выявления и исправления конкретной проблемы.

## <a name="cant-open-your-app-or-its-pdb-file"></a>Не удается открыть приложение или его PDB-файл

### <a name="your-app-is-running-or-its-loaded-in-the-debugger"></a>Приложение выполняется или загружается в отладчике

Если *filename* — имя исполняемого файла или связанный с ним PDB-файл, см. раздел Если приложение уже запущено. Затем проверьте, загружен ли он в отладчик. Чтобы устранить эту проблему, перед повторным созданием программы закройте программу и выгрузите ее из отладчика. Если приложение открыто в другой программе, например в редакторе ресурсов, закройте его. Если программа не отвечает, может потребоваться завершить процесс с помощью диспетчера задач. Также может потребоваться закрыть и перезапустить Visual Studio.

### <a name="your-app-is-locked-by-an-antivirus-scan"></a>Приложение заблокировано антивирусным сканированием

Антивирусные программы часто временно блокируют доступ к вновь созданным файлам, особенно исполняемым файлам EXE и DLL. Чтобы устранить эту проблему, попробуйте исключить каталоги сборки проекта из антивирусного сканера.

## <a name="cant-open-a-microsoft-library-file"></a>Не удается открыть файл библиотеки Майкрософт

### <a name="windows-libraries-such-as-kernel32lib"></a>Библиотеки Windows, например kernel32. lib

Если файл, который не удается открыть, является одним из стандартных файлов библиотеки, предоставляемых корпорацией Майкрософт, например *kernel32. lib* , может возникнуть ошибка конфигурации проекта или ошибка установки. Убедитесь, что Windows SDK установлен. Если для проекта требуются другие библиотеки Майкрософт, такие как MFC, убедитесь, что компоненты MFC также установлены установщиком Visual Studio. Вы можете снова запустить установщик, чтобы добавить дополнительные компоненты в любое время. Дополнительные сведения см. в разделе [изменение Visual Studio](/visualstudio/install/modify-visual-studio). Используйте вкладку **отдельные компоненты** в установщике, чтобы выбрать конкретные библиотеки и пакеты SDK.

### <a name="versioned-vcruntime-libraries"></a>Библиотеки vcruntime с отслеживанием версий

Если сообщение об ошибке имеет версию библиотеки Microsoft, например *msvcr120. lib* , набор инструментов платформы для этой версии компилятора может быть не установлен. Чтобы устранить эту проблему, воспользуйтесь двумя способами: Обновите проект, чтобы использовать текущий набор инструментов платформы, или установите старый набор инструментов и выполните сборку проекта без изменений. Дополнительные сведения см. в статьях [Обновление проектов из более ранних версий Visual C++](../../porting/upgrading-projects-from-earlier-versions-of-visual-cpp.md) и [Использование собственного многоплатформенного нацеливания в Visual Studio для построения старых проектов](../../porting/use-native-multi-targeting.md).

### <a name="retail-debug-or-platform-specific-libraries"></a>Библиотеки для розничной торговли, отладки или конкретной платформы

Эта ошибка может возникнуть при первой сборке для новой целевой платформы или конфигурации, например в розничной торговле или ARM64. В интегрированной среде разработки проверьте, установлены ли **набор инструментов платформы** и **Windows SDK версии** , указанной на [странице свойств Общие](../../build/reference/general-property-page-project.md) . Также убедитесь, что необходимые библиотеки доступны в **каталогах библиотек** , указанных на [странице свойств каталоги VC + +](../../build/reference/vcpp-directories-property-page.md). Проверьте свойства каждой конфигурации, например Debug, Retail, x86 или ARM64. Если одна сборка работает, но другая нет, Сравните параметры обоих параметров. Установите все отсутствующие необходимые инструменты и библиотеки.

### <a name="the-vccorliblib-library"></a>Библиотека vccorlib. lib

Нет устранением рисков Spectre библиотек для приложений или компонентов универсальной платформы Windows (UWP). Если сообщение об ошибке содержит *vccorlib. lib* , возможно, вы включили [/QSPECTRE](../../build/reference/qspectre.md) в проекте UWP. Отключите параметр компилятора **/Qspectre** , чтобы устранить эту проблему. В Visual Studio измените свойство **устранения рисков устранением рисков Spectre** . Он находится на странице Создание **кода C/C++**  >  **Code Generation** диалогового окна **страницы свойств** проекта.

### <a name="libraries-in-projects-from-online-or-other-sources"></a>Библиотеки в проектах из сетевых или других источников

При построении проекта, скопированного с другого компьютера, расположения установки библиотеки могут отличаться. Для сборок из командной строки убедитесь, что для сборки правильно заданы пути к переменной среды LIB и библиотеке. В Visual Studio можно просматривать и изменять текущие пути к библиотекам, заданные на страницах свойств проекта. На странице **каталоги VC + +** выберите раскрывающийся список для свойства **каталоги библиотек** , а затем нажмите кнопку **изменить**. В разделе **вычисленное значение** диалогового окна **каталоги библиотек** перечислены текущие пути поиска файлов библиотек. Обновите эти пути, чтобы они указывали на локальные библиотеки.

### <a name="updated-windows-sdk-libraries"></a>Обновленные библиотеки Windows SDK

Эта ошибка может возникать, если путь Visual Studio к Windows SDK устарел. Это может произойти, если установить более новую Windows SDK независимо от установщика Visual Studio. Чтобы исправить это в интегрированной среде разработки, обновите пути, указанные на [странице свойств каталогов VC + +](../../build/reference/vcpp-directories-property-page.md). Задайте версию в пути в соответствии с новым пакетом SDK. При использовании Командная строка разработчика обновите пакетный файл, который инициализирует переменные среды с помощью новых путей пакета SDK. Эту проблему можно избежать с помощью установщика Visual Studio для установки обновленных пакетов SDK.

## <a name="cant-open-a-third-party-library-file"></a>Не удается открыть сторонний файл библиотеки

Существует несколько распространенных причин этой проблемы.

- Путь к файлу библиотеки может быть неверным или не заключен в двойные кавычки. Или, возможно, вы не указали его для компоновщика.

- Возможно, вы установили 32-разрядную версию библиотеки, но при этом собираетесь на 64 бит или наоборот.

- Библиотека может зависеть от других библиотек, которые не установлены.

Чтобы исправить ошибку пути для сборок из командной строки, убедитесь, что задана переменная среды LIB. Убедитесь, что он содержит пути для всех используемых библиотек и для каждой создаваемой конфигурации. В интегрированной среде разработки пути к библиотекам задаются в свойстве Directories каталогов библиотеки **VC + +**  >  **Library Directories** . Убедитесь, что в каждой создаваемой конфигурации указаны все каталоги, содержащие нужные библиотеки.

Может потребоваться предоставить каталог библиотеки, переопределяющий каталог стандартной библиотеки. В командной строке используйте параметр [/libpath](../../build/reference/libpath-additional-libpath.md) . В интегрированной среде разработки используйте свойство **Дополнительные каталоги библиотек** в **свойствах конфигурации > компоновщик > общую** страницу свойств проекта.

Убедитесь, что установлены все версии библиотеки, необходимые для создаваемых конфигураций. Используйте служебную программу управления пакетами [vcpkg](../../build/vcpkg.md) , чтобы автоматизировать установку и настройку для многих распространенных библиотек. По возможности лучше создавать собственные копии сторонних библиотек. Затем вы убедитесь, что все локальные зависимости библиотек созданы для тех же конфигураций, что и ваш проект.

## <a name="cant-open-a-file-built-by-your-project"></a>Не удается открыть файл, созданный проектом

Эта ошибка может возникать, если *файл filename* еще не существует, когда компоновщик пытается получить к нему доступ. Это может произойти, когда один проект зависит от другого в решении, но проекты создаются в неправильном порядке. Чтобы устранить эту проблему, убедитесь, что ссылки проекта заданы в проекте, который использует этот файл. После этого отсутствующий файл будет создан до того, как он потребуется. Дополнительные сведения см. в статьях [Добавление ссылок в проекты Visual Studio C++](../../build/adding-references-in-visual-cpp-projects.md) и [Управление ссылками в проекте](/visualstudio/ide/managing-references-in-a-project).

## <a name="cant-open-file-cprogramobj"></a>Не удается открыть файл "C: \\ Program. obj"

Если вы видите имя файла *C: \\ Program. obj* в сообщении об ошибке, заключите пути библиотеки в двойные кавычки. Эта ошибка возникает, когда в компоновщик передается путь к распакованному пути, начинающийся с *C: \\ Program Files* . Неупакованные пути могут также вызвать аналогичные ошибки. Как правило, они показывают непредвиденный OBJ-файл в корне диска.

Чтобы устранить эту проблему для сборок из командной строки, проверьте параметры параметра [/libpath](../../build/reference/libpath-additional-libpath.md) . Также проверьте пути, указанные в переменной среды LIB, и пути, указанные в командной строке. Обязательно используйте двойные кавычки для всех путей, содержащих пробелы.

Чтобы устранить эту проблему в интегрированной среде разработки, при необходимости добавьте двойные кавычки для следующих свойств проекта:

- Свойство **каталоги библиотеки** на странице свойств [конфигурации > свойства каталоги VC + +](../../build/reference/vcpp-directories-property-page.md)

- Свойство **Дополнительные каталоги библиотек** на странице свойств **конфигурации > компоновщик > общие**

- Свойство **Дополнительные зависимости** на странице свойств **конфигурации > компоновщик > входные** свойства.

## <a name="other-common-issues"></a>Другие распространенные проблемы

### <a name="path-or-filename-issues"></a>Проблемы с путями или именами файлов

Эта ошибка может возникать, если имя файла библиотеки или путь, указанный для компоновщика, неверны. Или, если путь содержит недопустимую спецификацию диска. Проверьте командную строку или любую директиву [#pragma Comment (lib, "library_name")](../../preprocessor/comment-c-cpp.md) на предмет проблем. Проверьте правильность написания и расширение файла и убедитесь, что файл существует в указанном расположении.

### <a name="parallel-build-synchronization"></a>Параллельная синхронизация сборок

Если вы используете параллельный вариант сборки, Visual Studio мог заблокировать файл в другом потоке. Чтобы устранить эту проблему, убедитесь, что один и тот же объект кода или библиотека не встроены в несколько проектов. Используйте зависимости сборки или ссылки проекта, чтобы выбрать в проекте созданные двоичные файлы.

### <a name="additional-dependencies-specified-in-the-ide"></a>Дополнительные зависимости, указанные в интегрированной среде разработки

При указании отдельных библиотек в свойстве **Дополнительные зависимости** используйте пробелы для разделения имен библиотек. Не используйте запятые или точки с запятой. При использовании пункта меню **Правка** для открытия диалогового окна **Дополнительные зависимости** используйте символы новой строки для разделения имен, а не запятых, точек с запятой или пробелов. Также используйте символы новой строки при указании путей к библиотекам в **папках библиотек** и **дополнительных каталогах библиотек** .

### <a name="paths-that-are-too-long"></a>Слишком длинные пути

Эта ошибка может появиться, когда *путь к файлу расширяется* до 260 символов. При необходимости измените структуру каталогов или Сократите имена папок и файлов, чтобы сократить пути.

### <a name="files-that-are-too-large"></a>Слишком большие файлы

Эта ошибка может возникать из-за слишком большого размера файла. Библиотеки или объектные файлы, размер которых превышает гигабайт, может вызвать проблемы для 32-разрядного компоновщика. Возможным исправлением этой проблемы является использование 64-разрядного набора инструментов. Дополнительные сведения о том, как использовать 64-разрядный набор средств в командной строке, см. в разделе [как включить 64-разрядный Visual C++ набор инструментов в командной строке](../../build/how-to-enable-a-64-bit-visual-cpp-toolset-on-the-command-line.md). Сведения о том, как использовать 64-разрядный набор инструментов в интегрированной среде разработки, см. в разделе [Использование MSBuild с 64-разрядным компилятором и инструментами](../../build/walkthrough-using-msbuild-to-create-a-visual-cpp-project.md#using-msbuild-to-build-your-project). Также см. статью Stack Overflow Post: [как сделать так, чтобы Visual Studio использовала собственную цепочки инструментов AMD64](https://stackoverflow.com/questions/19820718/how-to-make-visual-studio-use-the-native-amd64-toolchain/23793055).

### <a name="incorrect-file-permissions"></a>Неправильные разрешения для файла

Эта ошибка может возникать, если у вас недостаточно разрешений для доступа к файлу *filename*. Это может произойти, если для доступа к файлам библиотеки в защищенных системных каталогах используется обычная учетная запись пользователя. Или, если вы используете файлы, скопированные с других пользователей, у которых все еще есть исходный набор разрешений. Чтобы устранить эту проблему, переместите файл в каталог проекта с возможностью записи. Если перемещенный файл имеет недоступные разрешения, выполните команду takeown.exe в окне командной строки администратора, чтобы стать владельцем файла.

### <a name="insufficient-disk-space"></a>Недостаточно места на диске

Эта ошибка может возникать, если на диске недостаточно места. Компоновщик использует временные файлы в нескольких ситуациях. Даже если на диске достаточно места, большие ссылки могут выпустить или фрагментировать свободное место на диске. Рассмотрите возможность использования параметра [/OPT (оптимизация)](../../build/reference/opt-optimizations.md) . выполнение транзитного исключения COMDAT считывает все объектные файлы несколько раз.

### <a name="problems-in-the-tmp-environment-variable"></a>Проблемы в переменной среды TMP

Если *имя файла* LNK *nnn* , то это имя файла, созданного компоновщиком для временного файла. Каталог, указанный в переменной среды TMP, может не существовать. Кроме того, для переменной среды TMP может быть задано несколько каталогов. Для переменной среды TMP должен быть указан только один путь к каталогу.

## <a name="help-my-issue-isnt-listed-here"></a>Справка, моей проблемы нет в списке!

Если ни одна из перечисленных здесь проблем не применима, для получения справки можно использовать средства обратной связи в Visual Studio. В интегрированной среде разработки перейдите в строку меню и выберите **справка > отправить отзыв > сообщить о проблеме**. Или отправьте предложение, используя **справку > отправить отзыв > отправить предложение**. Вы также можете использовать [документация Майкрософт Q&](/answers/topics/c%2B%2B.html) сайт для вопросов и веб-сайт [сообщества разработчиков](https://aka.ms/vsfeedback/browsecpp) Visual Studio C++. Используйте эти сайты для поиска ответов на вопросы и запроса справки. Дополнительные сведения см. в разделе [как сообщить о проблеме с набором инструментов Visual C++ или документацией](../../overview/how-to-report-a-problem-with-the-visual-cpp-toolset.md).

Если вы обнаружили новый способ устранения этой проблемы, которую следует добавить в эту статью, сообщите нам о ней. Вы можете отправить нам отзыв, нажав кнопку ниже для **этой страницы**. Используйте его для создания новой проблемы в [репозитории GitHub документации по C++](https://github.com/MicrosoftDocs/cpp-docs/issues). Спасибо!
