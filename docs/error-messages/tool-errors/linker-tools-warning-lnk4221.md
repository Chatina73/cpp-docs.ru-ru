---
title: Предупреждение средств компоновщика LNK4221
ms.date: 08/19/2019
f1_keywords:
- LNK4221
helpviewer_keywords:
- LNK4221
ms.assetid: 8e2eb2de-9532-4b85-908a-8c9ff5c4cccb
ms.openlocfilehash: f18224150232384adbf8ee7cc31af7bb7678eae5
ms.sourcegitcommit: 9c2b3df9b837879cd17932ae9f61cdd142078260
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "92919206"
---
# <a name="linker-tools-warning-lnk4221"></a>Предупреждение средств компоновщика LNK4221

Этот объектный файл не определяет ни один ранее неопределенный открытый символ, поэтому он не будет использоваться ни одной операцией компоновки, использующей эту библиотеку

Рассмотрим следующие два фрагмента кода.

```cpp
// a.cpp
#include <atlbase.h>
```

```cpp
// b.cpp
#include <atlbase.h>
int function()
{
   return 0;
}
```

Чтобы скомпилировать файлы и создать два объектных файла, запустите **cl/c a. cpp b. cpp** из командной строки. При связывании объектных файлов с помощью команды **Link/libs/out: Test. lib a. obj b. obj** вы получите предупреждение LNK4221. При связывании объектов с помощью команды **Link/libs/out: Test. lib б. obj a. obj** вы получите предупреждение.

Во втором сценарии не выдается предупреждение, так как компоновщик работает по принципу ЛИФО. В первом сценарии b. obj обрабатывается перед obj-файле, а obj-объект не содержит новых символов для добавления. Указав компоновщику сначала обработать obj-объект, можно избежать предупреждения.

::: moniker range=">=msvc-160"

Распространенной причиной этой ошибки является то, что два исходных файла указывают параметр [/Yc (создать предкомпилированный заголовочный файл)](../../build/reference/yc-create-precompiled-header-file.md) с тем же именем файла заголовка, которое указано в поле **предкомпилированный заголовок** . Распространенная причина этой проблемы связана с *PCH. h* , поскольку по умолчанию *PCH. cpp* включает *PCH. h* и не добавляет новые символы. Если другой исходный файл содержит *PCH. h* с параметром **/Yc** , а связанный OBJ-файл обрабатывается перед PCH. obj, компоновщик создаст LNK4221.

::: moniker-end

::: moniker range="<=msvc-150"

Распространенной причиной этой ошибки является то, что два исходных файла указывают параметр [/Yc (создать предкомпилированный заголовочный файл)](../../build/reference/yc-create-precompiled-header-file.md) с тем же именем файла заголовка, которое указано в поле **предкомпилированный заголовок** . Распространенной причиной этой проблемы является файл *stdafx. h* , поскольку по умолчанию файл *stdafx. cpp* включает файл *stdafx. h* и не добавляет новые символы. Если в другом исходном файле содержится файл *stdafx. h* с параметром **/Yc** , а связанный OBJ-файл обрабатывается перед файлом stdafx. obj, компоновщик создаст LNK4221.

::: moniker-end

Один из способов устранения этой проблемы состоит в том, чтобы убедиться в том, что для каждого предкомпилированного заголовка существует только один исходный файл, включающий в себя параметр **/Yc** . Все остальные исходные файлы должны использовать предварительно скомпилированные заголовки. Дополнительные сведения об изменении этого параметра см. в разделе [/Yu (использование файла предкомпилированного заголовка)](../../build/reference/yu-use-precompiled-header-file.md).
