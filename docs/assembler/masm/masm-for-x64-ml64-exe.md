---
title: MASM для x64 (ml64.exe)
ms.date: 08/30/2018
helpviewer_keywords:
- ml64
- ml64.exe
- masm for x64
ms.assetid: 89059103-f372-4968-80ea-0c7f90bb9c91
ms.openlocfilehash: 0404bff54a08988a72fcb0a0c075a4446bf90f48
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50596226"
---
# <a name="masm-for-x64-ml64exe"></a>MASM для x64 (ml64.exe)

Visual Studio включает 32-разрядных и 64-разрядных размещаемых версий Microsoft Assembler (MASM) для целевого x64 кода. С именем ml64.exe, это сборщик данных, который принимает x64 языка ассемблера. Средства командной строки MASM устанавливаются при выборе рабочей нагрузки C++ во время установки Visual Studio. MASM средства не доступны для загрузки. Инструкции по загрузке и установке Visual Studio, см. в разделе [установка Visual Studio](/visualstudio/install/install-visual-studio). Если вы не хотите устанавливать завершения Visual Studio IDE, но требуется только средства командной строки, загрузите [Build Tools для Visual Studio 2017](https://go.microsoft.com/fwlink/p/?linkid=875721).

Использование MASM для создания кода для x64 предназначен в командной строке, необходимо использовать командную строку разработчика для x64 целевых объектов, включая задает необходимый путь и другие переменные среды. Сведения о том, как запустить командную строку разработчика, см. в разделе [кода C/C++ на сборки в командной строке](../../build/building-on-the-command-line.md).

Сведения о параметрах командной строки ml64.exe, см. в разделе [ML и ML64 справочнике по командной строке](../../assembler/masm/ml-and-ml64-command-line-reference.md).

Встроенный ассемблер или использование ключевого слова ASM для x64 или целевых объектов ARM не поддерживается. Перенос вашей x86 кода, использует встроенный ассемблер для x64 или ARM, можно преобразовать код C++, используйте встроенные функции компилятора или создания исходных файлов на языке ассемблера. Компилятор Visual C++ поддерживает встроенные функции, чтобы можно было использовать функции специальные инструкции, для примера, privileged, бит проверки и тестирования, блокируемые и т. д., в как можно ближе к межплатформенным способом максимально. Сведения о доступных встроенных функций, см. в разделе [встроенные объекты компилятора](../../intrinsics/compiler-intrinsics.md).

## <a name="add-an-assembler-language-file-to-a-visual-c-project"></a>Добавление файла языка ассемблера в проект Visual C++

В системе проектов Visual Studio поддерживает файлы языка ассемблера, построенные с помощью MASM в проектах C++. Вы можете создать x64 исходный код на языке ассемблера, файлы и создавать их в объектных файлов с помощью MASM, который полностью поддерживает x64. Затем можно будет привязать эти объектные файлы в код C++, созданных для x64 целевых объектов. Это один из способов решения отсутствие x x64 встроенный ассемблер.

### <a name="to-add-an-assembler-language-file-to-an-existing-visual-c-project"></a>Добавление файла языка ассемблера в существующий проект Visual C++

1. Выберите проект в **обозревателе решений**. В строке меню выберите **проекта**, **настройки сборки**.

1. В **файлы настройки сборки для Visual C++** диалоговом окне установите флажок рядом с полем **masm(.targets,.props)**. Выберите **ОК** чтобы сохранить выбранное значение и закрыть диалоговое окно.

1. В строке меню выберите **проекта**, **Добавление нового элемента**.

1. В **Добавление нового элемента** выберите **файл C++ (.cpp)** в центральной области. В **имя** редактирование элемента управления, введите новое имя файла с **.asm** расширения вместо .cpp. Выберите **добавить** для добавления файла в проект и закрыть диалоговое окно.

Создайте ваш код на языке ассемблера в ASM-файл, который вы добавили. При построении решения ассемблер MASM вызывается сборка ASM-файл в объектный файл, затем был связан в проект. Для упрощения доступа символ функции ассемблер как необходимо объявлять `extern "C"` в исходный код C++ вместо использования C++ имя соглашения о дополнении на вашем языке ассемблер исходных файлов.

## <a name="ml64-specific-directives"></a>Директивы ML64

Можно использовать следующие директивы ml64 в исходном коде языка ассемблера, предназначенного x64:

- [.ALLOCSTACK](../../assembler/masm/dot-allocstack.md)

- [.ENDPROLOG](../../assembler/masm/dot-endprolog.md)

- [.PUSHFRAME](../../assembler/masm/dot-pushframe.md)

- [.PUSHREG](../../assembler/masm/dot-pushreg.md)

- [.SAVEREG](../../assembler/masm/dot-savereg.md)

- [.SAVEXMM128](../../assembler/masm/dot-savexmm128.md)

- [.SETFRAME](../../assembler/masm/dot-setframe.md)

Кроме того [PROC](../../assembler/masm/proc.md) директива был обновлен для использования с ml64.exe.

## <a name="32-bit-address-mode-address-size-override"></a>32-разрядный адрес режим (переопределение размер адрес)

MASM выдает переопределение размер 0x67 адрес, если операнд памяти включает 32-разрядные регистры. Например следующие примеры вызывает переопределение размер адрес может быть выпущен:

```asm
mov rax, QWORD PTR [ecx]
mov eax, DWORD PTR [ecx*2+r10d]
mov eax, DWORD PTR [ecx*2+r10d+0100h]
prefetch [eax]
movnti rax, QWORD PTR [r8d]
```

MASM предполагается, что если 32-разрядное смещение расценивается как операнде памяти, 64-разрядную адресацию предназначен. В настоящее время не поддерживается для 32-разрядную адресацию с такой операндами.

Наконец смешение размеры регистра в операнде памяти, как показано в следующем коде возникает ошибка.

```asm
mov eax, DWORD PTR [rcx*2+r10d]
mov eax, DWORD PTR [ecx*2+r10+0100h]
```

## <a name="see-also"></a>См. также

[Справочные материалы по ассемблеру Microsoft Macro Assembler](../../assembler/masm/microsoft-macro-assembler-reference.md)<br/>