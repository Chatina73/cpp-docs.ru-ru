---
title: Статические библиотеки (C++/CX)
ms.date: 02/03/2017
ms.assetid: 7faf53c8-fa21-42cc-8246-d32533ef9dfa
ms.openlocfilehash: 42c247650f778dcc9dbfa13d27cbb0244c0ebbc2
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80077982"
---
# <a name="static-libraries-ccx"></a>Статические библиотеки (C++/CX)

Статическая библиотека, используемая в приложении универсальная платформа Windows (UWP), может содержать стандартный C++ код ISO, включая типы STL, а также вызовы API-интерфейсов Win32, которые не исключены из платформы Среда выполнения Windows приложений. Статическая библиотека использует компоненты среда выполнения Windows и может создавать среда выполнения Windows компоненты с определенными ограничениями.

## <a name="creating-static-libraries"></a>Создание статических библиотек

Инструкции по созданию нового проекта зависят от установленной версии Visual Studio. Убедитесь, что в левом верхнем углу установлен правильный выбор версии.

::: moniker range="vs-2019"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2019"></a>Создание статической библиотеки UWP в Visual Studio 2019

1. В строке меню последовательно выберите **файл** > **создать** > **проект** , чтобы открыть диалоговое окно **Создание нового проекта** .

1. В верхней части диалогового окна задайте параметру **Language** значение **C++** , задайте для параметра **платформа** значение **Windows**и задайте для параметра **тип проекта** значение **UWP**.

1. В отфильтрованном списке типов проектов выберите **статическая библиотека (Universal Windows- C++/CX)** , а затем нажмите кнопку **Далее**. На следующей странице присвойте проекту имя и при необходимости укажите расположение проекта.

1. Нажмите кнопку **Создать**, чтобы создать проект.

::: moniker-end

::: moniker range="<=vs-2017"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2017-or-visual-studio-2015"></a>Создание статической библиотеки UWP в Visual Studio 2017 или Visual Studio 2015

1. В строке меню выберите **Файл**  > **Создать**  > **Проект**. В **разделе C++ Visual** > **Windows Universal** выберите **статическую библиотеку (универсальное Windows)** .

1. В области **Обозреватель решений**откройте контекстное меню для проекта и выберите пункт **Свойства**. В диалоговом окне **Свойства** на странице **Свойства конфигурации** > **CC++ /** задайте для параметра **использовать расширение среда выполнения Windows** значение **Да (/ZW)** .

::: moniker-end

При компиляции новой статической библиотеки при вызове API Win32, который исключен для приложений UWP, компилятор вызовет ошибку C3861, "идентификатор не найден". Чтобы найти альтернативный метод, который поддерживается для среда выполнения Windows, см. раздел [альтернативы интерфейсам API Windows в приложениях UWP](/uwp/win32-and-com/alternatives-to-windows-apis-uwp).

При добавлении проекта C++ статической библиотеки в решение приложения UWP может потребоваться обновить параметры свойств проекта библиотеки, чтобы для свойства поддержки UWP было задано значение **Да**. Без этого параметра код выполняет сборку и ссылки, но при попытке проверить приложение для Microsoft Store возникает ошибка. Статическая библиотека должна компилироваться с теми же параметрами компилятора, что и проект, в котором она используется.

При использовании статической библиотеки, которая создает открытые классы `ref` , открытые классы интерфейсов или открытые классы значений, компоновщик выдает следующее предупреждение:

> **предупреждение LNK4264:** архивирование объектного файла, скомпилированного с помощью/ZW, в статическую библиотеку; Обратите внимание, что при создании среда выполнения Windows типов не рекомендуется связываться со статической библиотекой, содержащей метаданные среда выполнения Windows.

Предупреждение можно спокойно проигнорировать только в том случае, если статическая библиотека не создается среда выполнения Windows компонентов, которые используются за пределами самой библиотеки. Если библиотека не использует компонент, который она определяет, то компоновщик может оптимизировать реализацию, даже если открытые метаданные содержат сведения о типе. Это означает, что открытые компоненты в статической библиотеке будут скомпилированы, но не активируются во время выполнения. По этой причине любой компонент среда выполнения Windows, предназначенный для использования другими компонентами или приложениями, должен быть реализован в библиотеке динамической компоновки (DLL).

## <a name="see-also"></a>См. также:

[Работа с потоками и маршалинг](../cppcx/threading-and-marshaling-c-cx.md)
