---
title: Статические библиотеки (C++/CX)
ms.date: 02/03/2017
ms.assetid: 7faf53c8-fa21-42cc-8246-d32533ef9dfa
ms.openlocfilehash: 756f8d2c1af2c6be414ad39b4a96fa6cc7ccfb02
ms.sourcegitcommit: 9c2b3df9b837879cd17932ae9f61cdd142078260
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2020
ms.locfileid: "92924720"
---
# <a name="static-libraries-ccx"></a>Статические библиотеки (C++/CX)

Статическая библиотека, используемая в приложении универсальная платформа Windows (UWP), может содержать стандартный код C++, включая типы STL, а также вызовы API-интерфейсов Win32, которые не исключены из платформы среда выполнения Windows приложений. Статическая библиотека использует компоненты среда выполнения Windows и может создавать среда выполнения Windows компоненты с определенными ограничениями.

## <a name="creating-static-libraries"></a>Создание статических библиотек

Инструкции по созданию нового проекта зависят от установленной версии Visual Studio. Чтобы ознакомиться с документацией по предпочтительной версии Visual Studio, используйте селектор **Версия** . Он находится в верхней части оглавления на этой странице.

::: moniker range="msvc-160"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2019"></a>Создание статической библиотеки UWP в Visual Studio 2019

1. В строке меню выберите **Файл**  > **Создать**  > **Проект** , чтобы открыть диалоговое окно **Создание проекта** .

1. В верхней части диалогового окна задайте для параметра  **язык** значение **C++** , задайте для параметра **платформа** значение **Windows** , а для параметра **тип проекта** — **UWP** .

1. В отфильтрованном списке типов проектов выберите **статическая библиотека (Universal Windows-C++/CX)** , а затем нажмите кнопку **Далее** . На следующей странице присвойте проекту имя и при необходимости укажите расположение проекта.

1. Нажмите кнопку **Создать** , чтобы создать проект.

::: moniker-end

::: moniker range="<=msvc-150"

### <a name="to-create-a-uwp-static-library-in-visual-studio-2017-or-visual-studio-2015"></a>Создание статической библиотеки UWP в Visual Studio 2017 или Visual Studio 2015

1. В строке меню выберите **Файл** > **Создать** > **Проект** . В разделе **Visual C++**  >  **универсальная библиотека Windows** выберите **статическую библиотеку (универсальное Windows)** .

1. В области **Обозреватель решений** откройте контекстное меню для проекта и выберите пункт **Свойства** . В диалоговом окне **Свойства** на странице **Свойства конфигурации**  >  **C/C++** задайте для параметра **использовать расширение среда выполнения Windows** значение **Да (/ZW)** .

::: moniker-end

При компиляции новой статической библиотеки при вызове API Win32, который исключен для приложений UWP, компилятор вызовет ошибку C3861, "идентификатор не найден". Чтобы найти альтернативный метод, который поддерживается для среда выполнения Windows, см. раздел [альтернативы интерфейсам API Windows в приложениях UWP](/uwp/win32-and-com/alternatives-to-windows-apis-uwp).

При добавлении проекта статической библиотеки C++ в решение приложения UWP может потребоваться обновить параметры свойств проекта библиотеки, чтобы для свойства поддержки UWP было задано значение **Да** . Без этого параметра код выполняет сборку и ссылки, но при попытке проверить приложение для Microsoft Store возникает ошибка. Статическая библиотека должна компилироваться с теми же параметрами компилятора, что и проект, в котором она используется.

При использовании статической библиотеки, которая создает открытые классы `ref` , открытые классы интерфейсов или открытые классы значений, компоновщик выдает следующее предупреждение:

> **предупреждение LNK4264:** архивирование объектного файла, скомпилированного с помощью/ZW, в статическую библиотеку; Обратите внимание, что при создании среда выполнения Windows типов не рекомендуется связываться со статической библиотекой, содержащей метаданные среда выполнения Windows.

Предупреждение можно спокойно проигнорировать только в том случае, если статическая библиотека не создается среда выполнения Windows компонентов, которые используются за пределами самой библиотеки. Если библиотека не использует компонент, который она определяет, то компоновщик может оптимизировать реализацию, даже если открытые метаданные содержат сведения о типе. Это означает, что открытые компоненты в статической библиотеке будут скомпилированы, но не активируются во время выполнения. По этой причине любой компонент среда выполнения Windows, предназначенный для использования другими компонентами или приложениями, должен быть реализован в библиотеке динамической компоновки (DLL).

## <a name="see-also"></a>См. также статью

[Работа с потоками и маршалирование](../cppcx/threading-and-marshaling-c-cx.md)
