---
title: Краткое руководство. Анализ кода для C/C++
description: Выполнить статический анализ кода СЗ в Visual Studio для обнаружения общих проблем и дефектов кодирования.
ms.date: 04/08/2020
ms.topic: conceptual
helpviewer_keywords:
- C/C++ code analysis
- code analysis, C/C++
ms.openlocfilehash: 43866564915ac84d227ccbf347280efe59e33351
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370575"
---
# <a name="quickstart-code-analysis-for-cc"></a>Краткое руководство. Анализ кода для C/C++

Качество приложения можно улучшить путем регулярного выполнения анализа кода C или C++. Анализ кода может помочь вам найти общие проблемы и нарушения хорошей практики программирования. И, он находит дефекты, которые трудно обнаружить с помощью тестирования. Его предупреждения отличаются от ошибок компилятора и предупреждений: он ищет определенные шаблоны кода, которые, как известно, вызывают проблемы. То есть, код, который действителен, но все еще может создавать проблемы, как для вас, так и для других людей, которые используют ваш код.

## <a name="configure-rule-sets-for-a-project"></a>Настройка наборов правил для проекта

1. В **Solution Explorer**откройте меню ярлыка для названия проекта, а затем выберите **Свойства.**

1. Дополнительно, в списках **конфигурации** и **платформы,** выберите конфигурацию сборки и целевую платформу.

1. Для выполнения анализа кода при каждом построении проекта с использованием выбранной конфигурации выберите **флажок Enable Code Analysis on Build** Check box. Вы также можете запустить анализ кода вручную, открыв меню **Анализ,** а затем выбрав **анализ кода Run на** *ProjectName* или **выполнить анализ кода в файле.**

1. Выберите [набор правил,](using-rule-sets-to-specify-the-cpp-rules-to-run.md) который вы хотите использовать, или создайте [пользовательский набор правил.](using-rule-sets-to-specify-the-cpp-rules-to-run.md#to-create-a-rule-set-in-a-text-editor) При использовании LLVM/clang-cl [см. Использование Clang-Tidy в Visual Studio](../code-quality/clang-tidy.md) для настройки вариантов анализа Clang-Tidy.

### <a name="standard-cc-rule-sets"></a>Стандартные наборы правил C/C

Visual Studio включает в себя эти стандартные наборы правил для родного кода:

| Набор правил | Описание |
|--|--|
| **Проверка основных правил арифметики** | Эти правила обеспечивают проверку, связанную с [арифметическими операциями, из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#es-expressions-and-statements). |
| **Правила проверки ядра C** | Эти правила обеспечивают [соблюдение профиля Bounds основных руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#probounds-bounds-safety-profile). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают соблюдение проверок, связанных с [классами из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c-classes-and-class-hierarchies). |
| **Правила проверки основных цен на валюту** | Эти правила обеспечивают соблюдение проверок, связанных с [параллелизмом, из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#cpcon-concurrency). |
| **Правила проверки основных правил C** | Эти правила обеспечивают соблюдение [конст-проверок из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#con-constants-and-immutability). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают соблюдение проверок, связанных с [декларациями из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#i-interfaces). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают соблюдение [контрольных проверок, связанных с перечислением, из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-enum). |
| **СЗ Ядра Проверка Экспериментальные правила** | Эти правила собирают некоторые экспериментальные проверки. В конце концов, мы ожидаем, что эти проверки будут перемещены в другие правила или удалены полностью. |
| **Правила проверки ядра C** | Эти правила обеспечивают соблюдение проверок, связанных с [функциями, соблюдаемыми в Основных руководящих принципах СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#f-functions). |
| **C ' Core Проверка GSL Правила** | Эти правила обеспечивают соблюдение проверок, связанных с [Библиотекой поддержки Руководящих принципов, из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-gsl). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают [соблюдение профиля продолжительности жизни основных руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#prolifetime-lifetime-safety-profile). |
| **Правила указателя на основной контроль владельца** | Эти правила обеспечивают соблюдение проверок управления ресурсами, связанных с [владельцем&lt;T&gt; из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#r-resource-management). |
| **Правила проверки основных указателей** | Эти правила обеспечивают соблюдение проверок управления ресурсами, связанных [с необработанными указателями из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#r-resource-management). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают соблюдение подмножества проверок из [Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#c-core-guidelines). Используйте этот набор правил, чтобы включить все правила проверки ядра, за исключением правил Enum и Experimental. |
| **Правила проверки основных указателей** | Эти правила обеспечивают соблюдение проверок управления ресурсами, [связанных с типами, с семантикой общих указателей из Основных Руководящих принципов СЗ.](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#r-resource-management) |
| **СЗ Ядра Проверка STL Правила** | Эти правила обеспечивают соблюдение проверок, связанных со [Стандартной библиотекой шаблонов (STL) из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#S-stdlib). |
| **Правила проверки ядра C** | Эти правила обеспечивают проверку, связанную с использованием [выражений и заявлений из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#es-expressions-and-statements). |
| **Правила проверки ядра СЗ** | Эти правила обеспечивают соблюдение [профиля типа Основных руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#prosafety-type-safety-profile). |
| **СЗ Ядра Проверить Уникальные правила указателя** | Эти правила обеспечивают соблюдение проверок управления ресурсами, связанных с типами, с [уникальной семантикой указателей из Основных Руководящих принципов СЗ](https://github.com/isocpp/CppCoreGuidelines/blob/master/CppCoreGuidelines.md#r-resource-management). |
| **Правила проверки параллелизма** | Эти правила обеспечивают соблюдение набора проверок параллелизма Win32 в СЗ. |
| **Правила параллелизма** | Добавлены правила параллелизма из Основных Руководящих принципов СЗ в **Правила проверки параллелизма.** |
| **Минимальные правила коренных народов Майкрософт** | Эти правила сосредоточены на наиболее важных проблемах в вашем родном коде, включая потенциальные дыры в безопасности и сбои приложений. Мы рекомендуем включить это правило, установленное в любой набор пользовательских правил, который вы создаете для ваших родных проектов. |
| **Рекомендуемые Майкрософт правила для машинного кода** | Эти правила сосредоточены на наиболее важных и распространенных проблемах в вашем родном коде. Эти проблемы включают потенциальные дыры в безопасности и сбои приложений. Мы рекомендуем включить это правило, установленное в любой набор пользовательских правил, который вы создаете для ваших родных проектов. Этот набор правил предназначен для работы с Visual Studio Professional издание и выше. Он включает в себя все правила в **Microsoft Родные минимальные правила**. |

Visual Studio включает в себя эти стандартные наборы правил для управляемого кода:

| Набор правил | Описание |
|--|--|
| **Правила базовой корректности Майкрософт** | Эти правила сосредоточены на логических ошибках и распространенных ошибках, допущенных при использовании рамочных AIS. Включите это правило, чтобы расширить список предупреждений, сообщенных минимальными рекомендуемыми правилами. |
| **Руководящие правила разработки базового дизайна Майкрософт** | Эти правила направлены на обеспечение соблюдения передового опыта, чтобы сделать код легко понять и использовать. Включите этот набор правил, если проект включает в себя библиотечный код или если вы хотите обеспечить соблюдение рекомендаций для легко подсобного кода. |
| **Microsoft Расширенные правила правильности** | Эти правила расширяют основные правила правильности, чтобы максимизировать заявленные ошибки логики и использования фреймворка. Особое внимание уделяется конкретным сценариям, таким как COM interop и мобильные приложения. Рассмотрите возможность включения этого набора правил, если один из этих сценариев применим к вашему проекту или чтобы найти дополнительные проблемы в проекте. |
| **Руководящие правила расширенного проектирования корпорации Майкрософт** | Эти правила расширяют основные правила разработки, чтобы максимизировать заявленные проблемы удобства использования и обслуживания. Особое внимание уделяется руководящим принципам именования. Рассмотрите возможность включения этого набора правил, если проект включает в себя библиотечный код или если вы хотите обеспечить соблюдение самых высоких стандартов для написания обслуживаемого кода. |
| **Правила глобализации Майкрософт** | Эти правила ориентированы на проблемы, которые мешают правильно отображать данные в приложении при использовании на разных языках, языках и культурах. Включите этот набор правил, если ваше приложение локализовано и/или глобализовано. |
| **Майкрософт Управляемые минимальные правила** | Эти правила сосредоточены на наиболее важных проблемах в коде, для которых анализ кода является наиболее точным.  Эти правила являются небольшими по количеству, и они предназначены только для запуска в ограниченных изданиях Visual Studio.  Используйте MinimumRecommendedRules.ruleset с другими изданиями Visual Studio. |
| **Рекомендуемые правила управления корпорацией Майкрософт** | Эти правила сосредоточены на наиболее важных проблемах в коде. Эти проблемы включают потенциальные дыры в безопасности, сбои приложений и другие важные ошибки логики и проектирования. Мы рекомендуем включить это правило, установленное в любой набор пользовательских правил, который вы создаете для ваших проектов. |
| **Минимальные правила Microsoft Смешанные (СЗ /CLR)** | Эти правила сосредоточены на наиболее важных проблемах в проектах СЗ, которые поддерживают общее время выполнения языка. Эти проблемы включают потенциальные дыры в безопасности, сбои приложений и другие важные ошибки логики и проектирования. Рекомендуем включить это правило в любой набор пользовательских правил, который вы создаете для ваших проектов, поддерживающих общее время выполнения языка. |
| **Рекомендуемые правила Microsoft Mixed (C) /CLR** | Эти правила сосредоточены на наиболее распространенных и критических проблемах в проектах СЗ, которые поддерживают общее время выполнения языка. Эти проблемы включают потенциальные дыры в безопасности, сбои приложений и другие важные ошибки логики и проектирования. Этот набор правил предназначен для использования в visual Studio Professional издание и выше. |
| **Правила безопасности Майкрософт** | Этот набор правил содержит все правила безопасности Майкрософт. Включите этот набор правил, чтобы максимизировать количество потенциальных проблем безопасности, которые сообщаются. |

Включить каждое правило:

| Набор правил | Описание |
|--|--|
| **Microsoft Все правила** | Этот набор правил содержит все правила. Запуск этого набора правил может привести к большому количеству сообщений о предупреждениях. Используйте этот набор правил, чтобы получить полную картину всех проблем в коде. Это может помочь вам решить, какой из наиболее целенаправленных наборов правил наиболее подходит для выполнения ваших проектов. |

## <a name="run-code-analysis"></a>Запуск анализа кода

На странице **анализа кода** в диалоге Project Properties можно настроить анализ кода для выполнения каждого проекта. Кроме того, можно запустить анализ кода вручную.

Чтобы запустить анализ кода для решения, выполните следующие действия.

- В меню **сборки** выберите **анализ кода на solution**.

Чтобы запустить анализ кода для проекта, выполните следующие действия.

1. В Solution Explorer выберите название проекта.

1. В меню **сборки** выберите **анализ кода по** названию *проекта.*

Для запуска анализа кода в файле:

1. В Исправления выберите имя файла.

1. В меню **Сборка** выберите **Анализ кода на файле** или нажмите **ctrl-Shift-Alt-F7**.

   Будет выполнена компиляция проекта или решения и запуск анализа кода. Результаты отображаются в окне списка ошибок.

## <a name="analyze-and-resolve-code-analysis-warnings"></a>Анализ и устранение предупреждений функции анализа кода

В окне списка ошибок перечислены найденные предупреждения анализа кода. Результаты отображаются в таблице. Если имеется дополнительная информация о конкретном предупреждении, первый столбец содержит элемент расширения. Выберите его, чтобы расширить дисплей для получения дополнительной информации о проблеме. По возможности функция анализа кода выводит на экран номера строк и логику анализа, вызвавшие предупреждение.

Для получения подробной информации о предупреждении, включая возможные решения проблемы, выберите идентификатор предупреждения в колонке Кода для отображения соответствующей статьи справки в Интернете.

Дважды щелкните предупреждение о перемещении курсора к строке кода, вызвавшей предупреждение в редакторе кода Visual Studio. Или нажмите Enter на выбранное предупреждение.

Поняв, в чем заключается проблема, можно разрешить ее в коде. Затем перезапустите анализ кода, чтобы убедиться, что предупреждение больше не отображается в списке ошибок.

## <a name="create-work-items-for-code-analysis-warnings"></a>Создание рабочих элементов для предупреждений об анализе кода

Для регистрации ошибок в журнале из среды Visual Studio можно использовать функцию отслеживания рабочих элементов. Чтобы использовать эту функцию, необходимо подключиться к экземпляру Azure DevOps Server (ранее Team Foundation Server).

### <a name="to-create-a-work-item-for-one-or-more-cc-code-warnings"></a>Создание рабочего элемента для одного или нескольких предупреждений кода C/C++

1. В списке ошибок расширьте и выберите предупреждения

1. В меню ярлыка для предупреждений выберите **Элемент работы,** а затем выберите тип элемента работы.

1. Visual Studio создает один рабочий элемент для выбранных предупреждений и отображает рабочий элемент в окне документа интегрированной среды разработки.

1. Добавить любую дополнительную информацию, а затем выбрать **Сохранить рабочий пункт**.

## <a name="search-and-filter-code-analysis-results"></a>Результаты анализа кода поиска и фильтрации

Можно выполнять поиск в длинных списках предупреждений, а также фильтровать предупреждения в решениях, состоящих из нескольких проектов.

- **Для фильтрации предупреждений по заголовку или идентификатору предупреждения**введите ключевое слово в поле списка ошибок поиска.

- **Для фильтрации предупреждений по степени серьезности:** по умолчанию сообщения анализа кода присваиваются серьезности **Предупреждения.** Можно присвоить серьезность одного или нескольких сообщений **как ошибка** в наборе пользовательских правил. В столбце **Severity** **списка ошибок**выберите стрелку выпадения, а затем значок фильтра. Выберите **Предупреждение** или **Ошибку** для отображения только сообщений, которые назначены соответствующей серьезности. Выберите **все** для отображения всех сообщений.

## <a name="see-also"></a>См. также раздел

- [Анализ кода для C/C](../code-quality/code-analysis-for-c-cpp-overview.md)
