---
title: Время обработки исключений. Общие сведения
description: Время и порядок выполнения обработки исключений в Microsoft C++.
ms.date: 08/24/2020
helpviewer_keywords:
- sequence [C++]
- sequence, of handlers
- exception handling [C++], timing
- setjmpex.h
- termination handlers [C++], timing
- setjmp.h
- handlers [C++], order of exception
- structured exception handling [C++], timing
ms.assetid: 5d1da546-73fd-4673-aa1a-7ac0f776c420
ms.openlocfilehash: 2ce501d8d74b6f0f7ca92e193c39f8ce58a66053
ms.sourcegitcommit: efc8c32205c9d610f40597556273a64306dec15d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2020
ms.locfileid: "88898364"
---
# <a name="timing-of-exception-handling-a-summary"></a>Время обработки исключений. Общие сведения

Обработчик завершения выполняется независимо от того, как **`__try`** завершается блок инструкции. Причины включают в себя выход из **`__try`** блока, `longjmp` инструкцию, которая передает управление из блока и очищает стек из-за обработки исключений.

> [!NOTE]
> Компилятор Microsoft C++ поддерживает две формы `setjmp` `longjmp` операторов и. Быстрая версия обходит обработку завершения, однако является более эффективной. Чтобы использовать эту версию, включите файл \<setjmp.h> . Другая версия поддерживает обработку завершения, как описано в предыдущем абзаце. Чтобы использовать эту версию, включите файл \<setjmpex.h> . Увеличение производительности быстрой версии зависит от конфигурации оборудования.

Операционная система выполняет все обработчики завершения в нужном порядке, прежде чем сможет быть выполнен какой-либо другой код, включая тело обработчика исключений.

Если причина прерывания — исключение, система должна сначала выполнить фильтровую часть одного или нескольких обработчиков исключений, а потом определять объект завершения. Используется следующий порядок событий:

1. Выдается исключение.

1. Система просматривает иерархию активных обработчиков исключений и выполняет фильтр обработчика с наивысшим приоритетом. Это обработчик исключений, который недавно был установлен и наиболее глубоко вложен в блоки и вызовы функций.

1. Если этот фильтр передает управление (Возвращает значение 0), процесс продолжится до тех пор, пока не будет найден фильтр, который не передает управление.

1. Если этот фильтр возвращает значение-1, выполнение продолжается там, где было вызвано исключение, и не происходит завершения.

1. Если фильтр возвращает 1, возникают следующие события:

   - Система очищает стек: удаляет все кадры стека между местом возникновения исключения и кадром стека, который содержит обработчик исключений.

   - По мере освобождения стека выполняется каждый обработчик завершения в стеке.

   - Выполняется сам обработчик исключений.

   - Контроль переходит к строке кода после окончания этого обработчика исключений.

## <a name="see-also"></a>См. также

[Написание обработчика завершения](../cpp/writing-a-termination-handler.md)<br/>
[Structured Exception Handling (C/C++)](../cpp/structured-exception-handling-c-cpp.md)
