---
title: __unhook
ms.date: 11/04/2016
f1_keywords:
- __unhook
- __unhook_cpp
helpviewer_keywords:
- event handlers [C++], dissociating events
- __unhook keyword [C++]
ms.assetid: 953a14f3-5199-459d-81e5-fcf015a19878
ms.openlocfilehash: 221ffc30a9b8a40c44f8009dfa511b72aa160e01
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81337555"
---
# <a name="__unhook"></a>__unhook

Отменяет связь метода обработчика с событием.

## <a name="syntax"></a>Синтаксис

```cpp
long  __unhook(
   &SourceClass::EventMethod,
   source,
   &ReceiverClass::HandlerMethod
   [, receiver = this]
);
long  __unhook(
   interface,
   source
);
long  __unhook(
   source
);
```

#### <a name="parameters"></a>Параметры

**&***SourceClass* `::` *EventMethod* A указатель на метод события, от которого вы отцепите метод обработчика событий:

- Родные события: *SourceClass* является классом исходного события, а *EventMethod* — событием.

- События COM: *SourceClass* — это интерфейс источника событий, а *EventMethod* — один из его методов.

- Управляемые события: *SourceClass* — это класс исходного кода события, а *EventMethod* — событие.

*interface*<br/>
Имя интерфейса, отцепиваемое от *приемника,* только для приемников событий COM, в котором *layout_dependent* параметр [атрибута event_receiver](../windows/attributes/event-receiver.md) **истинен.**

*Источник*<br/>
Указатель на экземпляр источника события. В зависимости `type` от `event_receiver`кода, указанного в, *источник* может быть одним из следующих:

- Собственный указатель на объект источника события.

- Указатель на основе ателье `IUnknown`(источник COM).

- Указатель на управляемый объект (для управляемых событий).

**&***Указатель ReceiverClass* `::` `HandlerMethod` A на метод обработчика событий, который должен быть отцеплен от события. Обработчик указан как метод класса или ссылка на то же самое; если вы не указываете имя класса, **__unhook** предполагает, что класс будет тем, в котором он называется.

- Родные события C: *ReceiverClass* является классом приемника событий и `HandlerMethod` является обработчиком.

- События COM: *ReceiverClass* является интерфейсом приемника событий и `HandlerMethod` является одним из его обработчиков.

- Управляемые события: *ReceiverClass* является `HandlerMethod` классом приемника событий и является обработчиком.

*приемник*(необязательно) Указатель на экземпляр класса приемника событий. Если вы не указали приемник, по умолчанию является класс приемника или структура, в которой **__unhook** вызывается.

## <a name="usage"></a>Использование

Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.

## <a name="remarks"></a>Remarks

Используйте внутреннюю функцию **__unhook** в приемнике событий, чтобы отделить или «отцепить» метод обработчика от метода события.

Есть три формы **__unhook**. В большинстве случаев можно использовать первую форму (четыре аргумента). Вторую (двухаргументную) форму **__unhook** можно использовать только для приемника события COM; это отцепляет весь интерфейс события. Третья форма (один аргумент) используется для отсоединения всех делегатов от указанного источника.

Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создадут исключение).

Если вы **позвоните __unhook** на обработчик события и события, которые еще не подключены, это не будет иметь никакого эффекта.

Во время компиляции компилятор проверяет, что событие существует, и выполняет проверку типа параметра с указанным обработчиком.

За исключением событий COM, **__hook** и **__unhook** могут быть вызваны за пределами приемника события.

Альтернативой использованию **__unhook** является использование оператора -Я.

Для получения информации о кодировании управляемых событий в новом синтаксисе [см.](../extensions/event-cpp-component-extensions.md)

> [!NOTE]
> Класс-шаблон или структура не могут содержать события.

## <a name="example"></a>Пример

Для примеров [Event Handling in COM](../cpp/event-handling-in-com.md) см. [Event Handling in Native C++](../cpp/event-handling-in-native-cpp.md)

## <a name="see-also"></a>См. также раздел

[Keywords](../cpp/keywords-cpp.md)<br/>
[event_source](../windows/attributes/event-source.md)<br/>
[event_receiver](../windows/attributes/event-receiver.md)<br/>
[__event](../cpp/event.md)<br/>
[__hook](../cpp/hook.md)<br/>
[__raise](../cpp/raise.md)
