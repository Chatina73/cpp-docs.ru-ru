---
title: __unhook
ms.date: 11/04/2016
f1_keywords:
- __unhook
- __unhook_cpp
helpviewer_keywords:
- event handlers [C++], dissociating events
- __unhook keyword [C++]
ms.assetid: 953a14f3-5199-459d-81e5-fcf015a19878
ms.openlocfilehash: 2a259b80b941e37e0c3040ad55894c114fe4bc82
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80160532"
---
# <a name="__unhook"></a>__unhook

Отменяет связь метода обработчика с событием.

## <a name="syntax"></a>Синтаксис

```cpp
long  __unhook(
   &SourceClass::EventMethod,
   source,
   &ReceiverClass::HandlerMethod
   [, receiver = this]
);
long  __unhook(
   interface,
   source
);
long  __unhook(
   source
);
```

#### <a name="parameters"></a>Параметры

**&** *SourceClass* `::` *евентмесод* указатель на метод события, из которого вы отсоедините метод обработчика событий:

- Собственные C++ события: *SourceClass* является классом источника событий, а *евентмесод* — событием.

- COM-события: *SourceClass* — это интерфейс источника событий, а *евентмесод* — один из его методов.

- Управляемые события: *SourceClass* является классом источника событий, а *евентмесод* — событием.

*interface*<br/>
Имя интерфейса, которое отсоединяется от *получателя*, только для приемников событий COM, в которых параметр *layout_dependent* атрибута [event_receiver](../windows/attributes/event-receiver.md) имеет **значение true**.

*источник*<br/>
Указатель на экземпляр источника события. В зависимости от `type` кода, указанного в `event_receiver`, *источником* может быть одно из следующих:

- Собственный указатель на объект источника события.

- Указатель на основе `IUnknown`(источник COM).

- Указатель на управляемый объект (для управляемых событий).

**&** *рецеиверкласс* `::` `HandlerMethod` указатель на метод обработчика событий, который следует отсоединить от события. Обработчик указывается как метод класса или ссылки на один и тот же объект. Если не указать имя класса, **__unhook** предполагает, что класс будет называться.

- Собственные C++ события: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

- События COM: *рецеиверкласс* — это интерфейс приемника событий, а `HandlerMethod` является одним из его обработчиков.

- Управляемые события: *рецеиверкласс* — это класс приемника событий, а `HandlerMethod` — обработчик.

*получатель*(необязательно) указатель на экземпляр класса приемника событий. Если получатель не указан, по умолчанию используется класс получателя или структура, в которой вызывается **__unhook** .

## <a name="usage"></a>Использование

Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.

## <a name="remarks"></a>Remarks

Используйте встроенную функцию **__unhook** в приемнике событий, чтобы отменить связь или отсоединить метод обработчика от метода события.

Существует три формы **__unhook**. В большинстве случаев можно использовать первую форму (четыре аргумента). Можно использовать второй формат (два аргумента) **__unhook** только для приемника событий COM. Это отсоединяет весь интерфейс событий. Третья форма (один аргумент) используется для отсоединения всех делегатов от указанного источника.

Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создадут исключение).

При вызове **__unhook** для события и обработчика событий, которые еще не были подключены, они не будут действовать.

Во время компиляции компилятор проверяет, что событие существует, и выполняет проверку типа параметра с указанным обработчиком.

За исключением событий COM, **__hook** и **__unhook** могут вызываться за пределами приемника событий.

Альтернативой использованию **__unhook** является использование оператора-=.

Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [event](../extensions/event-cpp-component-extensions.md).

> [!NOTE]
>  Класс-шаблон или структура не могут содержать события.

## <a name="example"></a>Пример

Примеры см. в разделе [Обработка событий в собственном C++ ](../cpp/event-handling-in-native-cpp.md) и [обработчике событий в com](../cpp/event-handling-in-com.md) .

## <a name="see-also"></a>См. также раздел

[Ключевые слова](../cpp/keywords-cpp.md)<br/>
[event_source](../windows/attributes/event-source.md)<br/>
[event_receiver](../windows/attributes/event-receiver.md)<br/>
[__event](../cpp/event.md)<br/>
[__hook](../cpp/hook.md)<br/>
[__raise](../cpp/raise.md)
