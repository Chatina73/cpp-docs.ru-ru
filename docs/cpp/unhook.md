---
title: __unhook
ms.date: 11/04/2016
f1_keywords:
- __unhook
- __unhook_cpp
helpviewer_keywords:
- event handlers [C++], dissociating events
- __unhook keyword [C++]
ms.assetid: 953a14f3-5199-459d-81e5-fcf015a19878
ms.openlocfilehash: e8f42c35024995c026ae10fc7f0ab3db77d1e5dc
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58769528"
---
# <a name="unhook"></a>__unhook

Отменяет связь метода обработчика с событием.

## <a name="syntax"></a>Синтаксис

```cpp
long  __unhook(
   &SourceClass::EventMethod,
   source,
   &ReceiverClass::HandlerMethod
   [, receiver = this]
);
long  __unhook(
   interface,
   source
);
long  __unhook(
   source
);
```

#### <a name="parameters"></a>Параметры

**&** *SourceClass* `::` *EventMethod* указатель на метод события, с помощью которого отсоединяется метод обработчика событий:

- События неуправляемого C++: *SourceClass* является исходным классом и *EventMethod* — это событие.

- События COM: *SourceClass* является исходного интерфейса событий и *EventMethod* — один из его методов.

- Управляемые события: *SourceClass* является исходным классом и *EventMethod* — это событие.

*interface*<br/>
Имя интерфейса, отсоединяемого с помощью *получателя*, только для приемников событий COM, в котором *layout_dependent* параметр [event_receiver](../windows/attributes/event-receiver.md) атрибут является **true**.

*source*<br/>
Указатель на экземпляр источника события. В зависимости от кода `type` указано в `event_receiver`, *источника* может принимать одно из следующих:

- Собственный указатель на объект источника события.

- `IUnknown`-На основе указателя (источник COM).

- Указатель на управляемый объект (для управляемых событий).

**&** *ReceiverClass* `::` `HandlerMethod` указатель на метод обработчика событий необходимо отсоединить от события. Обработчик определяется как метод класса или ссылку на тот же; Если вы не укажете имя класса **__unhook** предполагается, что класс, который требуется, в котором он вызывается.

- События неуправляемого C++: *ReceiverClass* является классом приемника событий и `HandlerMethod` является обработчиком.

- События COM: *ReceiverClass* является интерфейсом приемника событий и `HandlerMethod` является одним из его обработчиков.

- Управляемые события: *ReceiverClass* является классом приемника событий и `HandlerMethod` является обработчиком.

*получатель*(необязательно) указатель на экземпляр класса приемника событий. Если получатель не указан, по умолчанию используется класс приемника или структура, в которой **__unhook** вызывается.

## <a name="usage"></a>Использование

Можно использовать в любой области видимости функции, включая функцию main, вне класса приемника событий.

## <a name="remarks"></a>Примечания

Встроенная функция **__unhook** в приемнике событий можно отменить привязку или «отсоединить» метод обработчика от метода события.

Существует три формы **__unhook**. В большинстве случаев можно использовать первую форму (четыре аргумента). Можно использовать второй формы (с двумя аргументами) **__unhook** только для приемника событий COM; это отсоединяется от весь интерфейс событий. Третья форма (один аргумент) используется для отсоединения всех делегатов от указанного источника.

Ненулевое возвращаемое значение указывает на наличие ошибки (управляемые события создадут исключение).

При вызове метода **__unhook** на событие и обработчик событий, который уже не подключен, он не будет действовать.

Во время компиляции компилятор проверяет, что событие существует, и выполняет проверку типа параметра с указанным обработчиком.

За исключением событий COM **__hook** и **__unhook** можно вызвать вне приемника событий.

Альтернативой использованию **__unhook** можно использовать оператор-=.

Дополнительные сведения о кодировании управляемых событий в новом синтаксисе см. в разделе [событий](../extensions/event-cpp-component-extensions.md).

> [!NOTE]
>  Класс-шаблон или структура не могут содержать события.

## <a name="example"></a>Пример

См. в разделе [обработка событий в неуправляемом коде C++](../cpp/event-handling-in-native-cpp.md) и [обработка событий в COM](../cpp/event-handling-in-com.md) примеры.

## <a name="see-also"></a>См. также

[Ключевые слова](../cpp/keywords-cpp.md)<br/>
[event_source](../windows/attributes/event-source.md)<br/>
[event_receiver](../windows/attributes/event-receiver.md)<br/>
[__event](../cpp/event.md)<br/>
[__hook](../cpp/hook.md)<br/>
[__raise](../cpp/raise.md)