---
title: Оператор switch (C++)
ms.date: 11/04/2016
f1_keywords:
- default_cpp
- switch_cpp
- case_cpp
helpviewer_keywords:
- switch keyword [C++]
- case keyword [C++], in switch statements
- default keyword [C++]
ms.assetid: 6c3f3ed3-5593-463c-8f4b-b33742b455c6
ms.openlocfilehash: 67918b7df747d3bee923da500729e60b4fe04336
ms.sourcegitcommit: 1819bd2ff79fba7ec172504b9a34455c70c73f10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2018
ms.locfileid: "51328855"
---
# <a name="switch-statement-c"></a>Оператор switch (C++)

Позволяет выбирать между несколькими разделами кода в зависимости от значения целочисленного выражения.

## <a name="syntax"></a>Синтаксис

```
   switch ( init; expression )
   case constant-expression : statement
   [default  : statement]
```

## <a name="remarks"></a>Примечания

*Выражение* должен быть целочисленного типа или типа класса, для которого имеется однозначное преобразование в целочисленный тип. Выполняется восходящее приведение, как описано в разделе [стандартные преобразования](standard-conversions.md).

**Переключения** тела оператора состоит из ряда **случай** метки и необязательного **по умолчанию** метки. Никакие два константных выражения в **случай** операторы могут оценивать то же значение. **По умолчанию** метки может использоваться только один раз. Операторы с меткой не являются синтаксическим требованием, но **переключения** оператор не имеет смысла без них.   Оператор по умолчанию не всегда стоит в конце; он может отображаться в любой части оператора switch. Метка case или default может отображаться только внутри оператора switch.

*Константное_выражение* в каждом **случай** метка преобразуется в тип *выражение* и сравнивается с *выражение* для проверки на равенство. Управление передается оператору, **случай** *константное_выражение* совпадает со значением *выражение*. Поведение, полученное в результате, показано в следующей таблице.

### <a name="switch-statement-behavior"></a>Поведение оператора switch

|Условие|Действие|
|---------------|------------|
|Преобразованное значение соответствует значению выражения управления с повышенным уровнем.|Управление передается оператору, следующему за этой меткой.|
|Ни одна из констант не соответствуют константам в **случай** метки; **по умолчанию** имеется метка.|Управление передается **по умолчанию** метки.|
|Ни одна из констант не соответствуют константам в **случай** меток; **по умолчанию** отсутствует метка.|Управление передается инструкции после **переключения** инструкции.|

Если соответствующее выражение найдено, элемент управления не препятствуют последующие **случай** или **по умолчанию** метки. [Break](../cpp/break-statement-cpp.md) оператор используется для остановки выполнения и передать управление в оператор после **переключения** инструкции. Без **break** инструкции, каждый оператор из сопоставленной **случай** метки в конец **переключения**, в том числе **по умолчанию**, — выполнен. Пример:

```cpp
// switch_statement1.cpp
#include <stdio.h>

int main() {
   char *buffer = "Any character stream";
   int capa, lettera, nota;
   char c;
   capa = lettera = nota = 0;

   while ( c = *buffer++ )   // Walks buffer until NULL
   {
      switch ( c )
      {
         case 'A':
            capa++;
            break;
         case 'a':
            lettera++;
            break;
         default:
            nota++;
      }
   }
   printf_s( "\nUppercase a: %d\nLowercase a: %d\nTotal: %d\n",
      capa, lettera, (capa + lettera + nota) );
}
```

В предыдущем примере `capa` увеличивается инкрементно, если `c` — `A` в верхнем регистре. **Break** инструкции после `capa++` прекращает выполнение **переключения** тело оператора и элемент управления передает **хотя** цикла. Без **break** инструкцию, выполнение будет «проваливания» к следующему оператору с меткой, таким образом, чтобы `lettera` и `nota` также должны быть инкрементированы. Аналогичные цели обслуживается **break** инструкции для `case 'a'`. Если `c` — в нижнем регистре `a`, `lettera` увеличивается и **break** оператор завершает **переключения** тела оператора. Если `c` не `a` или `A`, **по умолчанию** выполняется инструкция.

**Visual Studio 2017 и более поздних версий:** (состав [/std: c ++ 17](../build/reference/std-specify-language-standard-version.md)) `[[fallthrough]]` атрибут указан в стандарте C ++ 17. Он может использоваться в **переключения** инструкции как подсказку для компилятора (или код более удобочитаемым) предназначена, поведение. Компилятор Visual C++ в настоящее время не предупреждать о fallthrough поведение, поэтому этот атрибут не влияет на поведение компилятора. Обратите внимание, что атрибут применяется к пустого оператора с меткой инструкции; Другими словами, точка с запятой не требуется.

```cpp
int main()
{
    int n = 5;
    switch (n)
    {

    case 1:
        a();
        break;
    case 2:
        b();
        d();
        [[fallthrough]]; // I meant to do this!
    case 3:
        c();
        break;
    default:
        d();
        break;
    }

    return 0;
}
```

**Visual Studio 2017 версии 15.3 и более поздние версии** (состав [/std: c ++ 17](../build/reference/std-specify-language-standard-version.md)): оператор switch может представить и инициализировать переменную, область действия которого ограничивается в блок оператора switch:

```cpp
    switch (Gadget gadget(args); auto s = gadget.get_status())
    {
    case status::good:
        gadget.zip();
        break;
    case status::bad:
        throw BadGadget();
    };
```

Внутренний блок **переключения** оператор может содержать определения с инициализациями при условии, что они доступны, то есть не пропускает все возможные пути выполнения. Имена, добавленные с помощью этих объявлений, имеют локальную область видимости. Пример:

```cpp
// switch_statement2.cpp
// C2360 expected
#include <iostream>
using namespace std;
int main(int argc, char *argv[])
{
    switch( tolower( *argv[1] ) )
    {
        // Error. Unreachable declaration.
        char szChEntered[] = "Character entered was: ";

    case 'a' :
        {
        // Declaration of szChEntered OK. Local scope.
        char szChEntered[] = "Character entered was: ";
        cout << szChEntered << "a\n";
        }
        break;

    case 'b' :
        // Value of szChEntered undefined.
        cout << szChEntered << "b\n";
        break;

    default:
        // Value of szChEntered undefined.
        cout << szChEntered << "neither a nor b\n";
        break;
    }
}
```

Объект **переключения** инструкции могут быть вложенными. В таких случаях **случай** или **по умолчанию** метки связать с ближайшим **переключения** инструкцию, которая содержит их.

**Блок, относящийся только к системам Microsoft**

Microsoft C не ограничивает количество значений case в **переключения** инструкции. Это число ограничивается только объемом доступной памяти. ANSI C требует по крайней мере 257 меток case разрешен в **переключения** инструкции.

В Microsoft C расширения Microsoft по умолчанию включены. Используйте [/Za](../build/reference/za-ze-disable-language-extensions.md) параметр компилятора для отключения этих расширений.

**Завершение блока, относящегося только к системам Майкрософт**

## <a name="see-also"></a>См. также

[Операторы выбора](../cpp/selection-statements-cpp.md)<br/>
[Ключевые слова](../cpp/keywords-cpp.md)