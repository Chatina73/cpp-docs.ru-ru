---
title: Пошаговое руководство. Компиляция машинной программы C++ в командной строке
ms.custom: conceptual
ms.date: 09/24/2018
helpviewer_keywords:
- native code [C++]
- Visual C++, native code
- compiling programs [C++]
- command-line applications [C++], native
ms.assetid: b200cfd1-0440-498f-90ee-7ecf92492dc0
ms.openlocfilehash: d7b5bc88966f7edbb7179c36398b1dd95afb971f
ms.sourcegitcommit: 8105b7003b89b73b4359644ff4281e1595352dda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2019
ms.locfileid: "57814349"
---
# <a name="walkthrough-compiling-a-native-c-program-on-the-command-line"></a>Пошаговое руководство. Компиляция машинной программы C++ в командной строке

Visual C++ содержит командной строки компилятора C++, можно использовать для создания все, от простых консольных приложений для приложений универсальной платформы Windows, классических приложений, драйверов устройств и компонентов .NET.

В этом пошаговом руководстве, можно создавать базовые «Hello, World»-в стиле программы на языке C++ с помощью текстового редактора, а затем скомпилировать его в командной строке. Если вы хотите воспользоваться Visual Studio IDE, а не с помощью командной строки, см. в разделе [Пошаговое руководство: Работа с проектами и решениями (C++)](../ide/walkthrough-working-with-projects-and-solutions-cpp.md) или [с помощью интегрированной среды разработки Visual Studio для разработки C++ Desktop](../ide/using-the-visual-studio-ide-for-cpp-desktop-development.md).

В этом пошаговом руководстве вместо примера программы, приведенного далее, можно использовать собственную программу на Visual C++. Кроме того, можно использовать образец кода на языке Visual C++ из другого раздела справки.

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого пошагового руководства, необходимо установить Visual Studio и необязательный **разработка классических приложений C++** рабочей нагрузки или средства командной строки сборки для Visual Studio.

Visual Studio — это мощная интегрированная среда разработки (IDE), поддерживающий это полнофункциональный редактор, диспетчеры ресурсов, отладчики и компиляторы для множества языков и платформ. Сведения о том, как загрузить и установить Visual Studio, включая бесплатный выпуск Visual Studio Community и для поддержки разработки C/C++, см. в разделе [Установка поддержки C++ в Visual Studio](vscpp-step-0-installation.md).

Build Tools для Visual Studio устанавливает только компиляторы командной строки, средства и библиотеки, необходимые для сборки программ C и C++. Это идеальное средство для построения лабораторий или аудитории проверяет и устанавливает относительно быстро. Чтобы установить только средства командной строки, загрузите [Build Tools для Visual Studio 2017](https://go.microsoft.com/fwlink/p/?linkid=875721).

Перед созданием программы C или C++ в командной строке, необходимо убедиться, что они установлены, и что они будут доступны из командной строки. Visual C++ имеет сложные требования к среде командной строки для средства, заголовки и библиотеки, используемые в нем. **Нельзя использовать в простой командной строке Visual C++** без выполнения некоторой подготовки. К счастью Visual C++ устанавливает клавиш запускать командную строку разработчика с среда, настроенная для сборок командной строки. К сожалению отличаются имена ярлыки командной строки разработчика и где они находятся, в практически в каждой версии Visual C++ и в разных версиях Windows. В первую очередь Пошаговое руководство находит подходящий для использования.

> [!NOTE]
> Ярлык командной строки разработчика автоматически задает правильные пути для компилятора и инструментов, а также для любых обязательных заголовков и библиотек. Необходимо задать эти значения среде самостоятельно при использовании обычного **командной** окна. Дополнительные сведения см. в разделе [задать пути и переменных среды в построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md). Мы рекомендуем использовать ярлык командной строки разработчика вместо создания собственного.

### <a name="open-a-developer-command-prompt"></a>Откройте командную строку разработчика

1. Если вы установили Visual Studio 2017 в Windows 10, откройте меню "Пуск" и выберите **все приложения**. Прокрутите список вниз и откройте **Visual Studio 2017** папку (не приложение Visual Studio 2017). Выберите **Командная строка разработчика для VS 2017** чтобы открыть окно командной строки.

   Если вы установили Microsoft Visual C++ Build Tools 2015 в Windows 10, откройте **запустить** меню и выберите **все приложения**. Прокрутите список вниз и откройте **Visual C++ Build Tools** папки. Выберите **Командная строка Native Tools Visual C++ 2015 x86** чтобы открыть окно командной строки.

   Если вы используете другую версию Visual Studio или управлением другой версии Windows, искать в меню «Пуск» или с начальной страницы для папки средств Visual Studio, содержащий ярлык командной строки разработчика. Можно также использовать функцию поиска Windows для поиска «Командная строка разработчика» и выберите ту, которая соответствует установленной версии Visual Studio. Используйте сочетание, чтобы открыть окно командной строки.

1. Затем проверьте правильность настройки командной строки разработчика Visual C++. В окне командной строки введите `cl` и убедитесь, что выходные данные выглядят примерно следующим образом:

   ```Output
   C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise>cl
   Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
   Copyright (C) Microsoft Corporation.  All rights reserved.

   usage: cl [ option... ] filename... [ /link linkoption... ]
   ```

   Возможно, различия в текущем каталоге или номера версий, в зависимости от версии Visual C++ и никаких установленных обновлений. Если приведенные выше выходные данные аналогичен результату, вы будете готовы создавать программы на C или C++ в командной строке.

   > [!NOTE]
   > Если отобразится сообщение об ошибке, например ««cl» не распознается как внутренняя или внешняя команда, исполняемая программа или пакетный файл,» ошибка C1034 или LNK1104 при запуске **cl** команды, а затем либо вы не используете командную строку разработчика или что-то проблемы с вашей установкой Visual C++. Необходимо устранить эту проблему, перед тем как продолжить.

   Если разработчик не может найти ярлык командной строки, или если вы получаете сообщение об ошибке при вводе `cl`, а затем установки Visual C++ может вызвать проблемы. Попробуйте переустановить компонент Visual C++ в Visual Studio, или переустановите Microsoft Visual C++ Build Tools. Не переходите к следующему разделу пока это работает. Дополнительные сведения об установке и устранение неполадок Visual C++ см. в разделе [установка Visual Studio](/visualstudio/install/install-visual-studio).

   > [!NOTE]
   > В зависимости от версии Windows на компьютере и конфигурации системы безопасности, возможно, щелкните правой кнопкой мыши, чтобы открыть контекстное меню для ярлык командной строки разработчика, а затем выберите **Запуск от имени администратора** для успешно Постройте и запустите программу, созданные с помощью описанной в этом пошаговом руководстве.

### <a name="create-a-visual-c-source-file-and-compile-it-on-the-command-line"></a>Создать исходный файл Visual C++ и скомпилировать его в командной строке

1. В окне командной строки разработчика введите `md c:\hello` для создания каталога, а затем введите `cd c:\hello` для изменения в этот каталог. Этот каталог является создаются где в файле исходного кода и скомпилированная программа.

1. Введите `notepad hello.cpp` в окне командной строки.

   Выберите **Да** когда Блокнот предложит создать файл. Откроется пустое окно блокнота, можно ввести код в файл с именем hello.cpp.

1. В Блокноте введите следующие строки кода:

   ```cpp
   #include <iostream>
   using namespace std;
   void main()
   {
       cout << "Hello, world, from Visual C++!" << endl;
   }
   ```

   Этот код является простой программы, будет написать одну строку текста на экране и завершает работу. Для сведения числа ошибок к минимуму скопируйте этот код и вставьте его в Блокнот.

1. Сохраните файл. В Блокноте, в меню **Файл** выберите **Сохранить**.

   Поздравляем, вы создали исходный файл Visual C++, hello.cpp, готовым для компиляции.

1. Переключитесь в окно командной строки разработчика. Введите `dir` в командной строке, чтобы вывести список содержимого каталога c:\hello. Вы должны увидеть hello.cpp файл источника в каталоге, который имеет следующий вид:

   ```Output
   c:\hello>dir
    Volume in drive C has no label.
    Volume Serial Number is CC62-6545

    Directory of c:\hello

   05/24/2016  05:36 PM    <DIR>          .
   05/24/2016  05:36 PM    <DIR>          ..
   05/24/2016  05:37 PM               115 hello.cpp
                  1 File(s)            115 bytes
                  2 Dir(s)  571,343,446,016 bytes free

   ```

   Даты и другие сведения будут отличаться на вашем компьютере. Если вы не видите файла исходного кода, hello.cpp, убедитесь, что вы открыли созданный каталог c:\hello и в блокноте, убедитесь, что вы сохранили файл источника, в этом каталоге. Также убедитесь, что исходный код сохранен с расширением имени файла .cpp, не с расширением txt.

1. В командной строке разработчика, введите `cl /EHsc hello.cpp` для компиляции программы.

   Компилятор cl.exe создаст OBJ-файл, содержащий скомпилированный код, а затем запустит компоновщик для создания исполняемой программы с именем hello.exe. Это имя отображается в строках информации, выводимой компилятором. Выходные данные компилятора должны выглядеть следующим образом:

   ```Output
   c:\hello>cl /EHsc hello.cpp
   Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
   Copyright (C) Microsoft Corporation.  All rights reserved.

   hello.cpp
   Microsoft (R) Incremental Linker Version 14.10.25017.0
   Copyright (C) Microsoft Corporation.  All rights reserved.

   /out:hello.exe
   hello.obj
   ```

   > [!NOTE]
   > Если отобразится сообщение об ошибке, например ««cl» не распознается как внутренняя или внешняя команда, исполняемая программа или пакетный файл,» ошибка C1034 или LNK1104, командной строке разработчика не настроено правильно. Сведения о том, как устранить эту проблему, вернитесь к **откройте командную строку разработчика** раздел.

   > [!NOTE]
   > Если вы получаете компилятора или компоновщика ошибки или предупреждения, просмотрите исходный код, чтобы исправить ошибки, а затем сохраните его и снова запустите компилятор. Сведения о конкретных ошибках используйте поле поиска на этой странице MSDN искомый номер ошибки.

1. Чтобы запустить программу hello.exe, в командной строке введите `hello`.

   Программа выводит следующий текст и закрывается:

   ```Output
   Hello, world, from Visual C++!
   ```

   Поздравляем, вы компиляции и запуска программы на языке C++ с помощью средства командной строки.

## <a name="next-steps"></a>Следующие шаги

В этом примере «Hello, World» примерно так же просто, как можно получить программы на языке C++. Реальные программы имеют файлы заголовков и другие исходные файлы, компоновку в библиотеках и выполните полезную работу.

Шаги в этом пошаговом руководстве можно использовать для сборки кода C++ вместо того чтобы вводить следующий образец кода. Также можно создавать много C++ примеры программ, обнаруженные в другом месте. Вы можете поместить исходный код и создайте свое приложение в любой другой каталог для записи. По умолчанию в интегрированной среде разработки Visual Studio создает проекты в папке "документы" во вложенной папке проектов Visual Studio папки с именем для вашей версии Visual Studio.

Для компиляции программы, содержащей дополнительные исходные файлы кода, введите их все в командной строке, например:

`cl /EHsc file1.cpp file2.cpp file3.cpp`

Параметр командной строки `/EHsc` указывает компилятору на необходимость обработки исключений C++. Дополнительные сведения см. в статье [/EH (модель обработки исключений)](reference/eh-exception-handling-model.md).

При указании дополнительных исходных файлов, компилятор использует первого входного файла для создания имени программы. В этом случае он выводит программу под названием file1.exe. Чтобы изменить имя на program1.exe, добавьте [/out](reference/out-output-file-name.md) параметр компоновщика:

`cl /EHsc file1.cpp file2.cpp file3.cpp /link /out:program1.exe`

Для автоматического перехвата дополнительные ошибки программирования, мы рекомендуем компиляции с помощью [/W3](reference/compiler-option-warning-level.md) или [/W4](reference/compiler-option-warning-level.md) порога предупреждений:

`cl /W4 /EHsc file1.cpp file2.cpp file3.cpp /link /out:program1.exe`

Компилятор, cl.exe, предоставляет больше возможностей можно применить можно создавать, оптимизировать, отладка и анализ кода. Краткий список, введите `cl /?` в командной строке разработчика. Также можно скомпилировать и компоновка выполняются отдельно и применить параметры компоновщика в более сложных сценариях сборки. Дополнительные сведения о компилятора и параметры компоновщика, а также использования, см. в разделе [ссылка на построение C/C++](reference/c-cpp-building-reference.md).

NMAKE и файлы makefile или файлы проекта MSBuild можно использовать для настройки и создания более сложных проектов в командной строке. Дополнительные сведения об использовании этих средств см. в разделе [справочнике NMAKE](reference/nmake-reference.md) и [MSBuild](msbuild-visual-cpp.md).

В языках C и C++ похожи, но не совпадают. Компилятор MSVC использует простое правило, чтобы определить, какой язык следует использовать при компиляции кода. По умолчанию компилятор MSVC обрабатывает все файлы, которые заканчиваются расширением .c как исходный код C и всех файлов, которые заканчиваются на .cpp как исходные. Чтобы заставить компилятор считать все файлы C++ не зависимые от расширения имени файла, используйте [/TC](reference/tc-tp-tc-tp-specify-source-file-type.md) параметр компилятора.

Компилятор MSVC включает CRT C Runtime Library (), совместимых со стандартом ISO C99, но не строго соответствует. В большинстве случаев переносимого кода будет Скомпилируйте и запустите должным образом. Visual C++ не поддерживает некоторые изменения CRT в ISO C11. Некоторые функции библиотеки и имена функций POSIX устарели компилятором MSVC. Функции поддерживаются, но предпочтительные имена были изменены. Дополнительные сведения см. в разделе [функции безопасности в CRT](../c-runtime-library/security-features-in-the-crt.md) и [Предупреждение компилятора (уровень 3) C4996](../error-messages/compiler-warnings/compiler-warning-level-3-c4996.md).

## <a name="see-also"></a>См. также

[Справочник по языку C++](../cpp/cpp-language-reference.md)<br/>
[Проекты и системы сборки](projects-and-build-systems-cpp.md)<br/>
[Параметры компилятора MSVC](reference/compiler-options.md)
