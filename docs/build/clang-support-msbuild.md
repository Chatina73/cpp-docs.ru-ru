---
title: Поддержка Clang/LLVM в Visual Studio Visual Studio
ms.date: 08/30/2019
ms.description: Configure a Visual Studio MSBuild project to use the Clang/LLVM toolchain.
helpviewer_keywords:
- Clang support for C++ MSBuild projects
ms.openlocfilehash: 5bd90141cdc7646dce206e6b02a605b73d78de95
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078808"
---
# <a name="clangllvm-support-in-visual-studio-projects"></a>Поддержка Clang и LLVM в проектах Visual Studio

::: moniker range="<=vs-2017"

Поддержка Clang для проектов CMak и MSBuild доступна в Visual Studio 2019.

::: moniker-end

::: moniker range="vs-2019"

Visual Studio 2019 версии 16,2 можно использовать с Clang для изменения, сборки и отладки C++ проектов Visual Studio (MSBuild), предназначенных для Windows или Linux.

## <a name="install"></a>Установка

Для лучшей поддержки интегрированной среды разработки в Visual Studio рекомендуется использовать новейшие средства компилятора Clang для Windows. Если они еще не установлены, их можно установить, открыв Visual Studio Installer и выбрав  **C++ средства Clang для Windows** в разделе **Разработка настольных C++ приложений с** дополнительными компонентами. Если вы предпочитаете использовать существующую установку Clang на компьютере, выберите  **C++ Clang-CL для v142 Build Tools.** Необязательный компонент. В настоящее C++ время для стандартной библиотеки Майкрософт требуется по крайней мере Clang 8.0.0; Объединенная версия Clang будет автоматически обновлена, чтобы поддерживать актуальность обновлений в реализации стандартной библиотеки Майкрософт.

![Установка компонента Clang](media/clang-install-vs2019.png)

## <a name="configure-a-windows-project-to-use-clang-tools"></a>Настройка проекта Windows для использования средств Clang

Чтобы настроить проект Visual Studio для использования Clang, щелкните правой кнопкой мыши узел проекта в **Обозреватель решений** и выберите пункт **свойства**. Как правило, сначала следует выбрать **все конфигурации** в верхней части диалогового окна. Затем в разделе **общие** > **набор инструментов платформы**выберите **LLVM (Clang-CL)** и нажмите **кнопку ОК**.

![Установка компонента Clang](media/clang-msbuild-prop-page.png)

Если вы используете средства Clang, Объединенные с Visual Studio, никаких дополнительных действий не требуется. Для проектов Windows Visual Studio по умолчанию вызывает Clang в режиме [Clang-CL](https://llvm.org/devmtg/2014-04/PDFs/Talks/clang-cl.pdf) и ссылается на реализацию Microsoft стандартной библиотеки. По умолчанию **Кланг-кл. exe** находится в `C:\Program Files (x86)\Microsoft Visual Studio\2019\Common7\IDE\CommonExtensions\Microsoft\Llvm\bin`.

При использовании пользовательской установки Clang можно либо изменить **свойства** > **проекта** > **каталоги VC + +**  > **Свойства конфигурации** > **исполняемые каталоги** , добавив пользовательский корневой каталог установки Clang в качестве первого каталога, или изменить значение свойства `LLVMInstallDir`. Дополнительные сведения см. [в разделе Установка пользовательского расположения LLVM](#custom_llvm_location) .

## <a name="configure-a-linux-project-to-use-clang-tools"></a>Настройка проекта Linux для использования средств Clang

Для проектов Linux в Visual Studio используется интерфейсная часть, совместимая с Clang GCC. Свойства проекта и почти все флаги компилятора идентичны

Чтобы настроить проект Visual Studio Linux для использования Clang, выполните следующие действия.

1. Щелкните правой кнопкой мыши узел проекта в **Обозреватель решений** и выберите пункт **свойства**.
1. Как правило, сначала следует выбрать **все конфигурации** в верхней части диалогового окна.
1. В разделе **общие** > **набор инструментов платформы**выберите **WSL_Clang_1_0** , если вы используете подсистему Windows для Linux, или **Remote_Clang_1_0** , если вы используете удаленный компьютер или виртуальную машину.
1. Нажмите кнопку **ОК**.

![Установка компонента Clang](media/clang-msbuild-prop-page.png)

В Linux в Visual Studio по умолчанию используется первое Clang расположение, которое встречается в свойстве среды PATH. Если вы используете пользовательскую установку Clang, необходимо изменить значение свойства `LLVMInstallDir` или заменить путь в **свойствах** **проекта** >  > **каталоги VC + +**  > **Свойства конфигурации** > **каталоги исполняемых файлов**. Дополнительные сведения см. [в разделе Установка пользовательского расположения LLVM](#custom_llvm_location) .

## <a name="set-a-custom-llvm-location"></a><a name="custom_llvm_location"></a>Задание пользовательского расположения LLVM

Можно задать пользовательский путь для LLVM для одного или нескольких проектов, создав файл *Directory. Build. props* и добавив его в корневую папку любого проекта. Его можно добавить в корневую папку решения, чтобы применить его ко всем проектам в решении. Файл должен выглядеть следующим образом (но подставить фактический путь):

```xml
<Project>
  <PropertyGroup>
    <LLVMInstallDir>c:\MyLLVMRootDir</LLVMInstallDir>
  </PropertyGroup>
</Project>
```

## <a name="set-additional-properties-edit-build-and-debug"></a>Настройка дополнительных свойств, изменение, сборка и отладка

После настройки конфигурации Clang щелкните правой кнопкой мыши узел проекта и выберите **Перезагрузить проект**. Теперь можно выполнять сборку и отладку проекта с помощью средств Clang. Visual Studio обнаруживает, что используется компилятор Clang и обеспечивает IntelliSense, выделение, навигацию и другие функции редактирования. Ошибки и предупреждения отображаются в **окно вывода**. Страницы свойств проекта для конфигурации Clang очень похожи на параметры для КОМПИЛЯТОРОМ MSVC, хотя некоторые зависящие от компилятора функции, такие как Edit и Continue, недоступны для конфигураций Clang. Чтобы задать параметр компилятора Clang или компоновщика, который недоступен на страницах свойств, можно добавить его вручную на страницах свойств в разделе **Свойства конфигурации** > **C/C++ (или компоновщик)**  > **командной строки** > **дополнительных параметров**.

При отладке можно использовать точки останова, память и визуализацию данных, а также большинство других функций отладки.  

![Отладка Clang](media/clang-debug-msbuild.png)

::: moniker-end
