---
title: Поддержка Clang и LLVM в проектах Visual Studio
ms.date: 08/30/2019
ms.description: Configure a Visual Studio MSBuild project to use the Clang/LLVM toolchain.
helpviewer_keywords:
- Clang support for C++ MSBuild projects
ms.openlocfilehash: 8d7d7fec979d3e7b8f665e56094ee1c309e3b686
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81323122"
---
# <a name="clangllvm-support-in-visual-studio-projects"></a>Поддержка Clang и LLVM в проектах Visual Studio

::: moniker range="<=vs-2017"

В Visual Studio 2019 доступна поддержка Clang для проектов CMake и MSBuild.

::: moniker-end

::: moniker range="vs-2019"

Visual Studio 2019 версии 16.2 с Clang можно использовать для изменения, сборки и отладки проектов Visual Studio на C++ (MSBuild), предназначенных для Windows или Linux.

## <a name="install"></a>Установка

Для лучшей поддержки интегрированной среды разработки в Visual Studio рекомендуется использовать новейшие средства компилятора Clang для Windows. Если они еще не установлены, их можно установить, открыв Visual Studio Installer и выбрав **Средства C++ Clang для Windows** в разделе дополнительных компонентов **Разработка классических приложений на C++** . Если вы предпочитаете использовать существующую установку Clang на компьютере, выберите необязательный компонент **Средства сборки C++ Clang-cl для версии 142** . Стандартная библиотека Microsoft C++ в настоящее время требует наличия по крайней мере версии Clang 8.0.0. Входящая в состав пакета версия Clang будет обновляться автоматически для поддержки обновлений в реализации стандартной библиотеки Майкрософт.

![Установка компонентов Clang](media/clang-install-vs2019.png)

## <a name="configure-a-windows-project-to-use-clang-tools"></a>Настройка проекта Windows для использования средств Clang

Чтобы настроить использование Clang в проекте Visual Studio, в **обозревателе решений** щелкните узел проекта правой кнопкой мыши и выберите пункт **Свойства**. Как правило, сначала следует выбрать элемент **Все конфигурации** в верхней части диалогового окна. Затем в разделе **Общие** > **Набор инструментов платформы** выберите **LLVM (clang-cl)** и нажмите кнопку **ОК**.

![Установка компонентов Clang](media/clang-msbuild-prop-page.png)

Если вы используете средства Clang, входящие в состав Visual Studio, никаких дополнительных действий не требуется. Для проектов Windows среда Visual Studio по умолчанию вызывает Clang в режиме [clang-cl](https://llvm.org/devmtg/2014-04/PDFs/Talks/clang-cl.pdf) и связывается с реализацией стандартной библиотеки Майкрософт. По умолчанию **clang-cl.exe** находится в `C:\Program Files (x86)\Microsoft Visual Studio\2019\Common7\IDE\CommonExtensions\Microsoft\Llvm\bin`.

Если используется настраиваемая установка Clang, можно изменить свойство **Проект** > **Свойства** > **Каталоги VC++**  > **Свойства конфигурации** > **Каталоги исполняемых файлов**, добавив корневой каталог настраиваемой установки Clang в качестве первого каталога, или изменить значение свойства `LLVMInstallDir`. Дополнительные сведения см. в разделе [Задание настраиваемого расположения LLVM](#custom_llvm_location).

## <a name="configure-a-linux-project-to-use-clang-tools"></a>Настройка проекта Linux для использования средств Clang

Для проектов Linux среда Visual Studio использует интерфейс, совместимый с Clang GCC. Свойства проекта и почти все флаги компилятора идентичны.

Чтобы настроить использование Clang в проекте Visual Studio для Linux, выполните указанные ниже действия.

1. Щелкните правой кнопкой мыши узел проекта в **обозревателе решений** и выберите пункт **Свойства**.
1. Как правило, сначала следует выбрать элемент **Все конфигурации** в верхней части диалогового окна.
1. В разделе **Общие** > **Набор инструментов платформы** выберите **WSL_Clang_1_0**, если используется подсистема Windows для Linux, или **Remote_Clang_1_0**, если используется удаленный компьютер или виртуальная машина.
1. Нажмите кнопку **ОК**.

![Установка компонентов Clang](media/clang-msbuild-prop-page.png)

В Linux среда Visual Studio по умолчанию использует первое расположение Clang, которое встречается в свойстве среды PATH. Если используется настраиваемая установка Clang, можно изменить значение свойства `LLVMInstallDir` или подставить путь в свойстве **Проект** > **Свойства** > **Каталоги VC++**  > **Свойства конфигурации** > **Каталоги исполняемых файлов**. Дополнительные сведения см. в разделе [Задание настраиваемого расположения LLVM](#custom_llvm_location).

## <a name="set-a-custom-llvm-location"></a><a name="custom_llvm_location"></a> Задание настраиваемого расположения LLVM

Чтобы задать настраиваемый путь к LLVM для одного или нескольких проектов, можно создать файл *Directory.build.props* и добавить его в корневую папку любого проекта. Его можно добавить в корневую папку решения, чтобы применить его ко всем проектам в решении. Файл должен выглядеть следующим образом (с подстановкой фактического пути):

```xml
<Project>
  <PropertyGroup>
    <LLVMInstallDir>c:\MyLLVMRootDir</LLVMInstallDir>
  </PropertyGroup>
</Project>
```

## <a name="set-additional-properties-edit-build-and-debug"></a>Настройка дополнительных свойств, изменение, сборка и отладка

После настройки конфигурации Clang снова щелкните правой кнопкой мыши узел проекта и выберите пункт **Перезагрузить проект**. Теперь можно выполнять сборку и отладку проекта с помощью средств Clang. Visual Studio обнаруживает, что используется компилятор Clang, и предоставляет IntelliSense, выделение, навигацию и другие функции редактирования. Ошибки и предупреждения отображаются в **окне вывода**. Страницы свойств проекта для конфигурации Clang очень похожи на аналогичные страницы для MSVC, хотя некоторые зависящие от компилятора функции, такие как "Изменить и продолжить", недоступны для конфигураций Clang. Чтобы задать параметр компилятора или компоновщика Clang, который недоступен на страницах свойств, можно добавить его вручную на страницах свойств в разделе **Свойства конфигурации** > **C/C++ (или компоновщик)**  > **Командная строка** > **Дополнительные параметры**.

При отладке можно использовать точки останова, память и визуализацию данных, а также большинство других функций отладки.  

![Отладка Clang](media/clang-debug-msbuild.png)

::: moniker-end
