---
title: Импортирование и экспортирование
ms.date: 05/06/2019
helpviewer_keywords:
- DLLs [C++], importing
- exporting DLLs [C++]
- importing DLLs [C++]
- DLLs [C++], exporting from
- __declspec(dllimport) keyword [C++]
ms.assetid: 7c44c2aa-2117-4cec-9615-a65bfd3f8f7b
ms.openlocfilehash: 03931f7f128ab0666890bb8e76677db67dda8fc7
ms.sourcegitcommit: da32511dd5baebe27451c0458a95f345144bd439
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2019
ms.locfileid: "65220638"
---
# <a name="importing-and-exporting"></a>Импортирование и экспортирование

Импортировать открытые символы в приложение или экспортировать функции из библиотеки DLL можно двумя способами:

- с помощью файла определения модуля (DEF) при сборке библиотеки DLL;

- с помощью ключевого слова **__declspec(dllimport)** или **__declspec(dllexport)** в определении функции в основном приложении.

## <a name="using-a-def-file"></a>Использование файла DEF

Файл определения модуля (DEF) — это текстовый файл, содержащий один или несколько операторов модуля, описывающих различные атрибуты библиотеки DLL. Если вы не используете ключевое слово **__declspec(dllimport)** или **__declspec(dllexport)** для экспорта функций библиотеки DLL, то для библиотеки DLL требуется DEF-файл.

DEF-файлы можно использовать для [импорта в приложение](importing-using-def-files.md) или [экспорта из библиотеки DLL](exporting-from-a-dll-using-def-files.md).

## <a name="using-__declspec"></a>Использование ключевого слова __declspec

Чтобы код компилировался правильно, использовать ключевое слово **__declspec(dllimport)** необязательно, но оно позволяет компилятору создавать более качественный код. Происходит это потому, что компилятор может определить, существует ли функция в библиотеке DLL или нет, и создать код без косвенного обращения, которое обычно присутствует в вызове функции, происходящем через границу библиотеки DLL. Однако для импорта переменных, используемых в библиотеке DLL, необходимо использовать **__declspec(dllimport)** .

При наличии надлежащего раздела EXPORTS в файле DEF ключевое слово **__declspec(dllexport)** не требуется. Ключевое слово **__declspec(dllexport)** было добавлено для упрощения экспорта функций из EXE- или DLL-файла без использования файла DEF.

Формат переносимых исполняемых файлов Win32 предназначен для сведения к минимуму числа страниц для фиксации импорта. Для этого все адреса импорта для любой программы помещаются в одном месте, которое называется таблицей адресов импорта. Это позволяет загрузчику при обращении к импортируемым функциям изменять только одну или две страницы.

## <a name="what-do-you-want-to-do"></a>Выберите действие

- [Импорт в приложение](importing-into-an-application-using-declspec-dllimport.md)

- [Экспорт из библиотеки DLL](exporting-from-a-dll.md)

## <a name="see-also"></a>См. также

[Создание библиотек DLL C/C++ в Visual Studio](dlls-in-visual-cpp.md)
