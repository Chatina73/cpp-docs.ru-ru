---
description: 'Подробнее о следующем: Импортирование и экспортирование'
title: Импортирование и экспортирование
ms.date: 05/06/2019
helpviewer_keywords:
- DLLs [C++], importing
- exporting DLLs [C++]
- importing DLLs [C++]
- DLLs [C++], exporting from
- __declspec(dllimport) keyword [C++]
ms.assetid: 7c44c2aa-2117-4cec-9615-a65bfd3f8f7b
ms.openlocfilehash: e2045b41450881056fb109f059e9c3202d93cab3
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97162525"
---
# <a name="importing-and-exporting"></a>Импортирование и экспортирование

Импортировать открытые символы в приложение или экспортировать функции из библиотеки DLL можно двумя способами:

- с помощью файла определения модуля (DEF) при сборке библиотеки DLL;

- с помощью ключевых слов **`__declspec(dllimport)`** или **`__declspec(dllexport)`** в определении функции в основном приложении.

## <a name="using-a-def-file"></a>Использование файла DEF

Файл определения модуля (DEF) — это текстовый файл, содержащий один или несколько операторов модуля, описывающих различные атрибуты библиотеки DLL. Если вы не используете ключевое слово **`__declspec(dllimport)`** или **`__declspec(dllexport)`** для экспорта функций библиотеки DLL, то для библиотеки DLL требуется DEF-файл.

DEF-файлы можно использовать для [импорта в приложение](importing-using-def-files.md) или [экспорта из библиотеки DLL](exporting-from-a-dll-using-def-files.md).

## <a name="using-__declspec"></a>Использование ключевого слова __declspec

Чтобы код компилировался правильно, использовать ключевое слово **`__declspec(dllimport)`** необязательно, но оно позволяет компилятору создавать более качественный код. Происходит это потому, что компилятор может определить, существует ли функция в библиотеке DLL или нет, и создать код без косвенного обращения, которое обычно присутствует в вызове функции, происходящем через границу библиотеки DLL. Однако для импорта переменных, используемых в библиотеке DLL, необходимо применять **`__declspec(dllimport)`** .

При наличии надлежащего раздела EXPORTS в файле DEF ключевое слово **`__declspec(dllexport)`** не требуется. Ключевое слово **`__declspec(dllexport)`** было добавлено для упрощения экспорта функций из EXE- или DLL-файла без использования файла DEF.

Формат переносимых исполняемых файлов Win32 предназначен для сведения к минимуму числа страниц для фиксации импорта. Для этого все адреса импорта для любой программы помещаются в одном месте, которое называется таблицей адресов импорта. Это позволяет загрузчику при обращении к импортируемым функциям изменять только одну или две страницы.

## <a name="what-do-you-want-to-do"></a>Выберите действие

- [Импорт в приложение](importing-into-an-application-using-declspec-dllimport.md)

- [Экспорт из библиотеки DLL](exporting-from-a-dll.md)

## <a name="see-also"></a>См. также

[Создание библиотек DLL C/C++ в Visual Studio](dlls-in-visual-cpp.md)
