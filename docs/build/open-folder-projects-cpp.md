---
title: Поддержка открытых папок для систем сборки C++ в Visual Studio
ms.date: 03/21/2019
helpviewer_keywords:
- Open Folder Projects in Visual Studio
ms.assetid: abd1985e-3717-4338-9e80-869db5435175
ms.openlocfilehash: 8856a5b1782c75c5a59dfdc93a8203627059ea12
ms.sourcegitcommit: fde637f823494532314790602c2819f889706ff6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/13/2019
ms.locfileid: "67042719"
---
# <a name="open-folder-projects-for-c"></a>Проекты "Открыть папку" для C++

В Visual Studio 2017 и более поздних версиях появилась функция "Открыть папку", позволяющая открыть папку исходных файлов и немедленно приступить к написанию кода с поддержкой IntelliSense, просмотра, рефакторинга, отладки и т. п. Никакие файлы SLN или VCXPROJ не загружаются. При необходимости вы можете указать настраиваемые задачи и параметры запуска, используя простые файлы JSON. Общие сведения о проекте "Открыть папку" см. в статье [Разработка кода в Visual Studio без использования проектов и решений](/visualstudio/ide/develop-code-in-visual-studio-without-projects-or-solutions).

Система CMake интегрирована в Интегрированной среде разработки Visual Studio как компонент C++ рабочей нагрузке. Дополнительные сведения см. в статье [Проекты CMake в Visual C++](cmake-projects-in-visual-studio.md). Для других систем сборки можно использовать функцию "Открыть папку". Функция "Открыть папку" эффективно отделяет редактор кода, отладчик и анализаторы от системы сборки и набора инструментов компилятора. Вы можете использовать редактор кода C++ с его широкими возможностями IntelliSense, анализаторами кода и отладчиком Visual Studio практически с любой системой сборки, включая CMake, Ninja, QMake (для проектов Qt), gyp, SCons, Gradle, Buck, make и многими другими. Он работает даже с одним файлом или свободной коллекцией файлов без системы сборки.

Чтобы использовать функцию "Открыть папку", в главном меню выберите **Файл | Открыть | Папка** или нажмите клавиши **CTRL+SHIFT+ALT+O**. Обозреватель решений сразу отображает все файлы в папке. Щелкните любой из них, чтобы приступить к изменению. В фоновом режиме Visual Studio индексирует файлы для поддержки функций навигации, рефакторинга и IntelliSense. Когда вы изменяете, создаете и удаляете файлы, Visual Studio автоматически отслеживает эти изменения и постоянно обновляет индекс IntelliSense. 

## <a name="qmake-projects-that-target-the-qt-framework"></a>Проекты QMake, ориентированные на платформу Qt

Вы можете использовать CMake для сборки проектов Qt, или можно использовать [расширение Visual Studio Qt](https://download.qt.io/development_releases/vsaddin/) для Visual Studio 2015 или Visual Studio 2017.

## <a name="gyp-cons-scons-buck-etc"></a>gyp, Cons, SCons, Buck и т. д.

Вы можете использовать любую систему сборки в Visual Studio и по-прежнему пользоваться преимуществами интегрированной среды разработки C++ и отладчика. При открытии корневой папки проекта редактор кода C++ использует эвристику, чтобы индексировать исходные файлы для поддержки IntelliSense и просмотра. Вы можете дать указания относительно структуры своего кода, отредактировав файл CppProperties.json. Аналогичным образом можно настроить и вызвать программу сборки, изменив файл launch.vs.json.

## <a name="configuring-open-folder-projects"></a>Настройка проектов "Открыть папку"

Проект "Открыть папку" можно настроить с помощью трех файлов JSON:

| | |
|-|-|
|CppProperties.json|Указывает сведения о настраиваемой конфигурации для просмотра. При необходимости вы можете создать этот файл в корневой папке проекта. (Не используется в проектах CMake.)|
|tasks.vs.json|Определяет настраиваемые команды сборки и параметры компилятора. Доступ к файлу можно получить в **обозревателе решений**, воспользовавшись пунктом контекстного меню **Настройка задач**.|
|launch.vs.json|Задает аргументы командной строки для отладчика. Доступ к файлу можно получить в **обозревателе решений**, воспользовавшись пунктом контекстного меню **Параметры отладки и запуска**.|

### <a name="configure-intellisense-and-browsing-hints-with-cpppropertiesjson"></a>Настройка IntelliSense и указаний по просмотру с помощью CppProperties.json

Поведение IntelliSense и просмотра частично зависит от активной конфигурации сборки, которая определяет пути #include, параметры компилятора и другие параметры. По умолчанию Visual Studio предоставляет конфигурации отладки и выпуска. Проекты CMake используют файл CMakeSettings.json и файлы CMakeLists.txt для этой цели. Для других проектов "Открыть папку" может потребоваться создать настраиваемую конфигурацию, чтобы функции IntelliSense и просмотра полностью понимали ваш код. Чтобы определить новую конфигурацию, создайте файл CppProperties.json в корневой папке. Пример:

```json
{
  "configurations": [
    {
      "name": "Windows x64",
      "includePath": [ "include" ],
      "defines": [ "_DEBUG" ],
      "compilerSwitches": "/std:c++17",
      "intelliSenseMode": "windows-msvc-x64",
      "forcedInclude": [ "pch.h" ],
      "undefines": []
    }
  ]
}
```
Дополнительные сведения см. в разделе [Справочник по схеме CppProperties](cppproperties-schema-reference.md).

### <a name="define-build-tasks-with-tasksvsjson"></a>Определение задач сборки в файле tasks.vs.json

Вы можете автоматизировать скрипты сборки и любые внешние операции с файлами, размещенными в текущей рабочей области, запуская их как задачи в интегрированной среде разработки. Чтобы настроить новую задачу, щелкните правой кнопкой мыши нужный файл или папку и выберите **Настройка задач**.

![Настройка задач "Открыть папку"](media/open-folder-config-tasks.png)

Это создает (или открывает) **tasks.vs.json** файл в папке .vs, который Visual Studio создает в корневой папке проекта. Можно определить в этом файле любую произвольную задачу, а затем вызывать ее из контекстного меню **обозревателя решений**. Ниже представлен пример файла tasks.vs.json, который определяет одну задачу. `taskName` определяет имя, отображаемое в контекстном меню. `appliesTo` определяет, для каких файлов можно выполнить эту команду. Свойство `command` ссылается на переменную среды COMSPEC, которая определяет путь для консоли (cmd.exe в Windows). Вы также можете ссылаться на переменные среды, объявленные в CppProperties.json или CMakeSettings.json. Свойство `args` определяет вызываемую командную строку. Макрос `${file}` передает выбранный файл в **обозреватель решений**. Приведенный ниже пример отображает имя для выбранного в этот момент CPP-файла.

```json
{
  "version": "0.2.1",
  "tasks": [
    {
      "taskName": "Echo filename",
      "appliesTo": "*.cpp",
      "type": "command",
      "command": "${env.COMSPEC}",
      "args": ["echo ${file}"]
    }
  ]
}
```

Сохранив tasks.vs.json, можно щелкнуть любой CPP-файл в папке, выбрать пункт **Echo filename** (Вывести имя файла) в контекстном меню и просмотреть имя файла в окне вывода.

Дополнительные сведения см. в разделе [Справочник по схеме Tasks.vs.json](tasks-vs-json-schema-reference-cpp.md).

### <a name="configure-debugging-parameters-with-launchvsjson"></a>Настройка параметров отладки с помощью launch.vs.json

Чтобы настроить аргументы командной строки для своей программы, щелкните правой кнопкой мыши исполняемый файл в **обозревателе решений** и выберите **Параметры отладки и запуска**. Это будет открыть существующий **launch.vs.json** файл, или если она не существует, он создаст новый файл уже содержит сведения о программе, вы выбрали.

Чтобы указать дополнительные аргументы, просто добавьте их в массив JSON `args`, как показано в следующем примере.

```json
{
  "version": "0.2.1",
  "defaults": {},
  "configurations": [
    {
      "type": "default",
      "project": "CPP\\7zip\\Bundles\\Alone\\O\\7za.exe",
      "name": "7za.exe list content of helloworld.zip",
      "args": [ "l", "d:\\sources\\helloworld.zip" ]
    }
  ]
}
```

Когда вы сохраняете этот файл, новая конфигурация отображается в раскрывающемся списке "Цель отладки". Вы можете выбрать ее, чтобы запустить отладчик. Можно создать любое количество конфигураций отладки для любого количества исполняемых файлов. Нажатие клавиши **F5** запускает отладчик, который будет останавливаться на всех заданных точках останова. Все обычные окна отладчика и их функции теперь доступны.
