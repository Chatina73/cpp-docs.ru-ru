---
title: Использование набора инструментов MSVC из командной строки — Visual Studio
description: Используйте цепочку инструментов компилятора Microsoft C++ (MSVC) из командной строки вне интегрированной среды разработки Visual Studio.
ms.custom: conceptual
ms.date: 05/16/2019
helpviewer_keywords:
- command-line builds [C++]
- compiling source code [C++], command line
- builds [C++], command-line
- command line [C++], building from
- command line [C++], compilers
ms.assetid: 7ca9daed-a003-4162-842d-908f79058365
ms.openlocfilehash: 97626455ace0d3ad47b9011594e82c144d7ea27d
ms.sourcegitcommit: a10c9390413978d36b8096b684d5ed4cf1553bc8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/17/2019
ms.locfileid: "65837116"
---
# <a name="use-the-msvc-toolset-from-the-command-line"></a>Использование набора инструментов MSVC из командной строки

Вы можете выполнять сборку приложений на языках C и C++ из командной строки с помощью средств, включенных в Visual Studio. Вы также можете загрузить набор инструментов компилятора в виде отдельного пакета со страницы [загрузок Visual Studio](https://visualstudio.microsoft.com/downloads/). Это часть пакета **Средства сборки для Visual Studio**; вы можете скачать только инструменты, необходимые для разработки на C++.

## <a name="how-to-use-the-command-line-tools"></a>Практическое руководство. Использование программ командной строки

Когда вы выбираете одну из рабочих нагрузок C++ в Visual Studio Installer, он устанавливает *набор инструментов платформы* Visual Studio. Набор инструментов платформы содержит все средства C и C++ для определенной версии Visual Studio, включая компиляторы, компоновщики, ассемблеры и другие средства сборки, а также соответствующие библиотеки C /C++. Все эти средства можно использовать в командной строке, и они также используются внутри интегрированной среды разработки Visual Studio. Существуют отдельные компиляторы для x86 и x64 и средства для сборки кода для целевых платформ x86, x 64, ARM и ARM64. Каждый набор средств для конкретного узла и целевой архитектуры сборки хранится в собственном каталоге.

Устанавливаемые наборы инструментов компилятора зависят от процессора компьютера и параметров, выбранных во время установки. Как минимум будут установлены 32-разрядные средства для x86, которые собирают 32-разрядный машинный код x86, и средства кросс-компиляции, собирающие 64-разрядный машинный код x64. Если у вас 64-разрядная версия Windows, будут установлены 64-разрядные средства для x64, которые собирают 64-разрядный машинный код, и средства кросс-компиляции, собирающие 32-разрядный машинный код. Если вы решили установить необязательные средства универсальной платформы Windows для C++, также устанавливаются 32-разрядные и 64-разрядные собственные средств, которые собирают код ARM. Другие рабочие нагрузки могут устанавливать дополнительные средства.

## <a name="environment-variables-and-developer-command-prompts"></a>Переменные среды и командные строки разработчика

Для правильной работы инструментам требуется несколько переменных среды. Они используются для добавления к пути и задания файла включения, файла библиотеки и расположений пакетов SDK. Чтобы упростить процесс задания этих переменных среды, программа установки создает настраиваемые *командные файлы*, или пакетные файлы, во время установки. Вы можете выполнить один из этих командных файлов в окне командной строки, чтобы задать конкретный узел и целевую архитектуру сборки, версию Windows SDK, целевую платформу и набор инструментов платформы. Для удобства установщик также создает ярлыки в меню "Пуск", которые запускают окна командной строки разработчика с помощью этих командных файлов, поэтому все необходимые переменные среды заданы и готовы для использования.

Необходимые переменные среды зависят от установки и выбранной архитектуры сборки и могут изменяться при обновлении продукта. Поэтому настоятельно рекомендуется использовать ярлыки установленных командных строк или командные файлы вместо настройки переменных среды в Windows самостоятельно. Дополнительные сведения см. в статье [Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md).

## <a name="developer_command_prompt_shortcuts"></a>Ярлыки командной строки разработчика

Ярлыки командной строки устанавливаются в папке конкретной версии Visual Studio в меню "Пуск". Ниже приведен список основных ярлыков командной строки и архитектуры сборки, которые они поддерживают:

- **Командная строка разработчика** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.
- **Командная строка Native Tools x86** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.
- **Командная строка Native Tools x64** — указывает среде использовать 64-разрядные собственные инструменты x64 для сборки 64-разрядного машинного кода x64.
- **Командная строка Cross Tools x86_x64** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 64-разрядного машинного кода x64.
- **Командная строка Cross Tools x64_x86** — указывает среде использовать 64-разрядные собственные инструменты x64 для сборки 32-разрядного машинного кода x86.

Фактические имена ярлыков и папок в меню "Пуск" зависят от установленной версии Visual Studio и псевдонима установки, если вы его задали. Например, если у вас установлена Visual Studio 2019 и вы задали псевдонимом установки *Предварительная версия*, ярлык командной строки разработчика будет называться **Командная строка разработчика для VS 2019** и находиться в папке с именем **Visual Studio 2019**.

## <a name="developer_command_prompt"></a> Открытие окна "Командная строка разработчика"

1. На рабочем столе откройте меню **Пуск** Windows, прокрутите вниз, чтобы найти и открыть папку вашей версии Visual Studio, например **Visual Studio 2019**. В некоторых более старых версиях Visual Studio ярлыки находятся во вложенной папке **Инструменты Visual Studio**.

1. В папке выберите ярлык **Командная строка разработчика** для вашей версии Visual Studio. Этот ярлык запускает окно командной строки разработчика, которое использует архитектуру сборки по умолчанию: 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86. Если вы предпочитаете архитектуру сборки не по умолчанию, выберите одну из собственных командных строк или командную строку инструментов кросс-компиляции, чтобы указать узел и целевую архитектуру.

Еще более быстрый способ открыть окно командной строки разработчика — ввести запрос *командная строка разработчика* в поле поиска на рабочем столе и выбрать нужный результат.

## <a name="developer_command_file_locations"></a> Расположение командных файлов разработчика

Если вы предпочитаете установить среду архитектуры сборки в существующем окне командной строки, можно использовать один из командных файлов (пакетных файлов), созданных установщиком, чтобы задать нужную среду. Рекомендуется делать это только в новом окне командной строки, а не менять среды позднее в том же окне командной строки. Расположение этих файлов зависит от установленной версии Visual Studio, расположения и имен, выбранных во время установки. Visual Studio 2019 на 64-разрядном компьютере обычно устанавливается в папку\Program Files (x86)\Microsoft Visual Studio\2019\*выпуск*, где *выпуск* может быть Community, Professional, Enterprise, BuildTools или другим указанным именем. Аналогичное расположение существует для Visual Studio 2017. Visual Studio 2015 обычно устанавливается в папке \Program Files (x86)\Microsoft Visual Studio 14.0.

Основной командный файл командной строки разработчика VsDevCmd.bat находится в подкаталоге "Common7\Tools" в каталоге установки. Если параметры не указаны, он указывает среде, узлу и целевой архитектуре сборки использовать 32-разрядные собственные инструменты x86 для создания 32-разрядного кода x86.

Дополнительные командные файлы доступны для настройки определенной архитектуры сборки в зависимости от архитектуры процессора и рабочих нагрузок Visual Studio и установленных вариантов. В Visual Studio 2017 и Visual Studio 2019 они находятся в подкаталоге VC\Auxiliary\Build в каталоге установки Visual Studio. В Visual Studio 2015 они находятся в подкаталогах VC, VC\bin или VC\bin\\*архитектуры* в каталоге установки, где *архитектуры* является одним из собственных компиляторов или кросс-компиляторов. Эти командные файлы устанавливают параметры по умолчанию и вызывают VsDevCmd.bat, чтобы настроить указанную среду архитектуры сборки. Обычная установка может включать следующие командные файлы:

|Командный файл|Узел и целевые архитектуры|
|---|---|
|**vcvars32.bat**| Использует 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.|
|**vcvars64.bat**| Использует 64-разрядные собственные инструменты x64 для сборки 64-разрядного кода x64.|
|**vcvarsx86_amd64.bat**| Использует 32-разрядные собственные инструменты кросс-компиляции x86 для сборки 64-разрядного кода x64.|
|**vcvarsamd64_x86.bat**| Использует 64-разрядные собственные инструменты кросс-компиляции x64 для сборки 32-разрядного кода x86.|
|**vcvarsx86_arm.bat**| Использует 32-разрядные собственные инструменты кросс-компиляции x86 для сборки кода ARM.|
|**vcvarsamd64_arm.bat**| Использует 64-разрядные собственные инструменты кросс-компиляции x64 для сборки кода ARM.|
|**vcvarsall.bat**| Использует параметры для указания узла и целевых архитектур, а также вариантов пакета SDK и платформы. Список поддерживаемых вариантов можно вызвать параметром **/help**.|

> [!CAUTION]
> Файл vcvarsall.bat и другие командные файлы Visual Studio могут различаться на разных компьютерах. Не заменяйте отсутствующий или поврежденный файл vcvarsall.bat файлом с другого компьютера. Перезапустите Visual Studio Installer, чтобы заменить отсутствующий файл.
>
> Файл vcvarsall.bat также может иметь отличия в разных версиях. Если текущая версия Visual Studio установлена на компьютере, на котором также имеется более ранняя версия Visual Studio, не запускайте файл vcvarsall.bat или другой командный файл других версий в том же окне командной строки.

## <a name="use-the-developer-tools-in-an-existing-command-window"></a>Использование средств разработчика в существующем окне командной строки

Самый простой способ указать конкретную архитектуру сборки в существующем окне команд — использовать файл vcvarsall.bat. Вы можете использовать файл vcvarsall.bat, чтобы установить переменные среды для настройки командной строки для собственной 32- или 64-разрядной компиляции или для кросс-компиляции для процессоров x86, x64 и ARM; чтобы указать в качестве целевой платформы Microsoft Store, универсальную платформу Windows или платформы рабочего стола Windows; чтобы указать, какой пакет Windows SDK использовать; и чтобы указать версию набора инструментов платформы. Если аргументы не предоставлены, файл vcvarsall.bat настраивает переменные среды для использования текущего собственного 32-разрядного компилятора для целевых платформ рабочего стола Windows x86. Однако его можно использовать для настройки собственных инструментов или инструментов кросс-компиляции. Если указать конфигурацию компилятора, которая не установлена или недоступна в архитектуре компьютера сборки, появится сообщение об ошибке.

### <a name="vcvarsall-syntax"></a>Синтаксис vcvarsall

> **vcvarsall.bat** [*architecture*] [*platform_type*] [*winsdk_version*] [ **-vcvars_ver=**_vcversion_]

*architecture*<br/>
Этот необязательный аргумент указывает узел и целевую архитектуру для использования. Если параметр *architecture* не указан, используется среда сборки по умолчанию. Поддерживаются следующие аргументы:

|*architecture*|Компилятор|Архитектура главного компьютера|Архитектура выходных данных сборки (целевая)|
|----------------------------|--------------|----------------------------------|-------------------------------|
|**x86**|собственный 32-разрядный x86|x86, x64|x86|
|**x86\_amd64** или **x86\_x64**|x64 для x86 (кросс-компилятор)|x86, x64|X64|
|**x86_arm**|ARM для x86 (кросс-компилятор)|x86, x64|ARM|
|**x86_arm64**|ARM64 для x86 (кросс-компилятор)|x86, x64|ARM64|
|**amd64** или **x64**|Собственный 64-разрядный x64|X64|X64|
|**amd64\_x86** или **x64\_x86**|x86 для x64 (кросс-компилятор)|X64|x86|
|**amd64\_arm** или **x64\_arm**|ARM для x64 (кросс-компилятор)|X64|ARM|
|**amd64\_arm64** или **x64\_arm64**|ARM64 для x64 (кросс-компилятор)|X64|ARM64|

*platform_type*<br/>
Этот необязательный аргумент позволяет указать **store** или **uwp** в качестве типа платформы. По умолчанию среда настроена на сборку классических или консольных приложений.

*winsdk_version*<br/>
При необходимости указывает версию Windows SDK для использования. По умолчанию используется последняя установленная версия Windows SDK. Чтобы указать версию Windows SDK, можно использовать полный номер пакета Windows 10 SDK, например **10.0.10240.0**, или указать **8.1**, чтобы использовать Windows 8.1 SDK.

*vcversion*<br/>
При необходимости указывает набор инструментов компилятора Visual Studio для использования. По умолчанию среда должна использовать текущий набор инструментов компилятора Visual Studio. Используйте **-vcvars_ver=14.0**, чтобы указать набор инструментов компилятора Visual Studio 2015 или **-vcvars_ver=15.0**, чтобы указать набор инструментов компилятора Visual Studio 2017.

<a name="vcvarsall"></a>
#### <a name="to-set-up-the-build-environment-in-an-existing-command-prompt-window"></a>Настройка среды сборки в существующем окне командной строки

1. В командной строке выполните команду CD, чтобы перейти на каталог установки Visual Studio. Затем снова используйте CD, чтобы перейти в подкаталог, который содержит зависящие от конфигурации командные файлы. Для Visual Studio 2017 и Visual Studio 2019 это подкаталог VC\Auxiliary\Build. Для Visual Studio 2015 используйте подкаталог VC.

1. Введите команду для вашей среды разработки. Например, для сборки кода ARM для универсальной платформы Windows на 64-разрядной платформе с последней версией Windows SDK и набором инструментов компилятора Visual Studio 2019 используйте эту командную строку:

   `vcvarsall.bat amd64_arm uwp`

## <a name="create-your-own-command-prompt-shortcut"></a>Создание собственных ярлыков командной строки

Если вы откроете диалоговое окно свойств для одного из существующих ярлыков командной строки разработчика, вы увидите использованный целевой объект команды. Например, целевой объект для ярлыка **командной строки Native Tools x64 для VS 2019** выглядит примерно следующим образом:

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"`

Пакетные файлы конкретной архитектуры задают параметр *architecture* и вызывают vcvarsall.bat. Вы можете передать те же дополнительные параметры в эти пакетные файлы, как вы бы передали их в файл vcvarsall.bat, или можно просто вызвать vcvarsall.bat напрямую. Чтобы задать параметры для ярлыка своей командной строки, добавьте их в конец команды в двойных кавычках. Например, чтобы настроить ярлык для сборки кода ARM для универсальной платформы Windows на 64-разрядной платформе с помощью последней версии пакета Windows SDK и набора инструментов компилятора более ранней версии по сравнению с текущей, необходимо указать номер версии. Используйте подобный целевой объект команды в ярлыке:

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat amd64_arm uwp -vcvars_ver=15.0"`

Необходимо изменить путь, чтобы отразить каталог установки Visual Studio. Файл vcvarsall.bat содержит дополнительную информацию об определенных номерах версии.

## <a name="command-line-tools"></a>Программы командной строки

Для сборки проекта C/C++ из командной строки Visual Studio предоставляет следующие программы командной строки:

[CL](reference/compiling-a-c-cpp-program.md)<br/>
Используйте компилятор (cl.exe) для компиляции и компоновки файлов исходного кода в приложения, библиотеки и DLL.

[Ссылка](reference/linking.md)<br/>
Используйте компоновщик (link.exe) для компоновки скомпилированных объектных файлов и библиотек в приложения и DLL.

[MSBuild](msbuild-visual-cpp.md)<br/>
Используйте MSBuild (msbuild.exe) и файл проекта (VCXPROJ) для настройки сборки и косвенного вызова набора инструментов. Это аналогично выполнению команд **Собрать проект** или **Собрать решение** в интегрированной среде разработки Visual Studio. Запуск MSBuild из командной строки является усложненным сценарием и обычно не рекомендуется.

[DEVENV](/visualstudio/ide/reference/devenv-command-line-switches)<br/>
Используйте DEVENV (devenv.exe) вместе с параметром командной строки, например **/Build** или **/Clean**, для выполнения определенных команд сборки без отображения интегрированной среды разработки Visual Studio. В целом это удобнее, чем использовать MSBuild напрямую, так как вы можете позволить Visual Studio обрабатывать сложные аспекты MSBuild.

[NMAKE](reference/nmake-reference.md)<br/>
Используйте NMAKE (nmake.exe) в Windows для создания проектов C++ на основе традиционного файла makefile.

При сборке в командной строке команда F1 для получения мгновенной справки недоступна. Вместо этого используйте поисковую систему для получения сведений о предупреждениях, ошибках и сообщениях или используйте автономные файлы справки. Чтобы использовать функцию поиска в [docs.microsoft.com](https://docs.microsoft.com/cpp/), введите строку поиска в поле поиска в верхней части страницы.

## <a name="in-this-section"></a>В этом разделе

В этом разделе документа приводятся статьи, в которых показано, как выполнять сборку приложений из командной строки, описывается, как настроить среду сборки из командной строки для использования 64-разрядного набора программ и платформ x86, x64 и ARM, а также демонстрируется использование программ сборки из командной строки MSBuild и NMAKE.

[Пошаговое руководство: Компиляция собственной программы на языке C++ из командной строки](walkthrough-compiling-a-native-cpp-program-on-the-command-line.md)<br/>
Содержит пример создания и компиляции простой программы на языке C++ из командной строки.

[Пошаговое руководство: Компиляция программы на языке C из командной строки](walkthrough-compile-a-c-program-on-the-command-line.md)<br/>
Описывается компиляция программы, написанной на языке программирования C.

[Пошаговое руководство: Компиляция программы на языке C++/CLI из командной строки](walkthrough-compiling-a-cpp-cli-program-on-the-command-line.md)<br/>
Описывается создание и компиляция программы C++/CLI, в которой используется платформа .NET Framework.

[Пошаговое руководство: Компиляция программы на языке C++/CX из командной строки](walkthrough-compiling-a-cpp-cx-program-on-the-command-line.md)<br/>
Описывается создание и компиляция программы C++/CX, в которой используется среда выполнения Windows.

[Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md)<br/>
Описывается открытие окна командной строки с заданными переменными среды, необходимыми для выполнения сборки из командной строки для платформ x86, x64 и ARM с помощью 32-разрядного или 64-разрядного набора инструментов.

[Справочник по программе NMAKE](reference/nmake-reference.md)<br/>
Содержит ссылки на статьи, в которых описывается служебная программа обслуживания программ Майкрософт (NMAKE.EXE).

[MSBuild в командной строке — C++](msbuild-visual-cpp.md)<br/>
Содержит ссылки на статьи, в которых рассматривается использование программы msbuild.exe из командной строки.

## <a name="related-sections"></a>Связанные разделы

[/MD, /MT, /LD (использование библиотеки времени выполнения)](reference/md-mt-ld-use-run-time-library.md)<br/>
Описывается использование этих параметров компилятора для работы с библиотекой времени выполнения отладки или выпуска.

[Параметры компилятора C/C++](reference/compiler-options.md)<br/>
Содержит ссылки на статьи, посвященные параметрам компилятора C и C++, а также программе CL.exe.

[Параметры компоновщика MSVC](reference/linker-options.md)<br/>
Содержит ссылки на статьи, посвященные параметрам компоновщика и программе LINK.exe.

[Дополнительные инструменты сборки MSVC](reference/c-cpp-build-tools.md)<br/>
Содержит ссылки на средства сборки C/C++, включенные в состав Visual Studio.

## <a name="see-also"></a>См. также

[Проекты и системы сборки](projects-and-build-systems-cpp.md)