---
title: Использование Microsoft C++ набор инструментов из командной строки
description: Используйте цепочку инструментов компилятора Microsoft C++ (MSVC) из командной строки вне интегрированной среды разработки Visual Studio.
ms.custom: conceptual
ms.date: 06/06/2019
helpviewer_keywords:
- command-line builds [C++]
- compiling source code [C++], command line
- builds [C++], command-line
- command line [C++], building from
- command line [C++], compilers
ms.assetid: 7ca9daed-a003-4162-842d-908f79058365
ms.openlocfilehash: b5e9bf266d79ee86cae84535641a52c7c52be391
ms.sourcegitcommit: 8adabe177d557c74566c13145196c11cef5d10d4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/10/2019
ms.locfileid: "66821135"
---
# <a name="use-the-microsoft-c-toolset-from-the-command-line"></a>Использование Microsoft C++ набор инструментов из командной строки

Вы можете выполнять сборку приложений на языках C и C++ из командной строки с помощью средств, включенных в Visual Studio. Microsoft C++ набор инструментов компилятора (MSVC) также загрузки как изолированный пакет из [загрузки Visual Studio](https://visualstudio.microsoft.com/downloads/) страницы. Это одно их **Build Tools для Visual Studio** пакета. Вы можете скачать только инструменты, необходимые для C++ разработки.

## <a name="how-to-use-the-command-line-tools"></a>Практическое руководство. Использование программ командной строки

Когда вы выбираете одну из рабочих нагрузок C++ в Visual Studio Installer, он устанавливает *набор инструментов платформы* Visual Studio. Набор инструментов платформы имеет C и C++ средства для определенной версии Visual Studio. Эти средства включают C /C++ компиляторы, компоновщики, сборки и другие средства сборки и соответствующие библиотеки. Все эти средства можно использовать в командной строке. Они также используются внутренне в интегрированной среде разработки Visual Studio. Существуют отдельные компиляторы размещенных x86 и размещенных x64 и средства для создания кода для x86, x 64, ARM и ARM64 целевых объектов. Каждый набор средств для конкретного узла и целевой архитектуры сборки хранится в собственном каталоге.

Для правильной работы инструментам требуется несколько переменных среды. Эти переменные используются для добавления средств к пути, а также задать включают файл, файл библиотеки и расположения SDK. Чтобы упростить процесс задания этих переменных среды, программа установки создает настраиваемые *командные файлы*, или пакетные файлы, во время установки. Можно запустить один из этих файлов команд для задания определенного узла и целевой архитектуры сборки, версия пакета SDK для Windows и набор инструментов платформы. Для удобства установщик создает ярлыки в меню «Пуск». Сочетания клавиш запуск windows командную строку разработчика с помощью эти командные файлы для определенных сочетаний сервер узла и целевой. Следующие сочетания клавиш убедитесь, что все необходимые переменные среды, задайте и готова к использованию.

Необходимые переменные среды относятся к установке и для построения архитектуры, который выбран. Они также могут изменяться при обновлении продукта. Вот почему мы рекомендуем использовать файл клавиш или команда установленных командной строки, вместо настраивать переменные среды самостоятельно. Дополнительные сведения см. в разделе [набор переменных пути и среды для построения из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md).

Наборы инструментов, командные файлы и ярлыки программ зависят от процессора компьютера и параметров, выбранных во время установки. Размещенные в x86 инструменты и межплатформенные инструменты, которые занимаются x86 и x64 кода всегда устанавливаются. Если у вас есть 64-разрядной Windows, размещенные в x64 инструменты и межплатформенные инструменты, которые занимаются x86 и x64 кода также устанавливаются. Если выбран необязательный C++ средства универсальной платформы Windows, а затем x86 и x64 средства, которые создают код ARM и ARM64 также устанавливаются. Другие рабочие нагрузки могут устанавливать дополнительные средства.

## <a name="developer_command_prompt_shortcuts"></a>Ярлыки командной строки разработчика

Ярлыки командной строки устанавливаются в папке конкретной версии Visual Studio в меню "Пуск". Ниже приведен список основных ярлыков командной строки и архитектуры сборки, которые они поддерживают:

- **Командная строка разработчика** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.
- **Командная строка Native Tools x86** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.
- **Командная строка Native Tools x64** — указывает среде использовать 64-разрядные собственные инструменты x64 для сборки 64-разрядного машинного кода x64.
- **Командная строка Cross Tools x86_x64** — указывает среде использовать 32-разрядные собственные инструменты x86 для сборки 64-разрядного машинного кода x64.
- **Командная строка Cross Tools x64_x86** — указывает среде использовать 64-разрядные собственные инструменты x64 для сборки 32-разрядного машинного кода x86.

::: moniker range=">= vs-2019"

Имена папки и в контекстном меню Пуск зависят от установленной версии Visual Studio. Если вы задали, они также зависят от установки **псевдоним**. Например, предположим, вы установили Visual Studio 2019 г., и Вы дали псевдоним объекта *последнюю*. Ярлык командной строки разработчика называется **Командная строка разработчика для VS 2019 (последняя)** , в папку с именем **Visual Studio 2019**.

::: moniker-end
::: moniker range="= vs-2017"

Имена папки и в контекстном меню Пуск зависят от установленной версии Visual Studio. Если вы задали, они также зависят от установки **псевдоним**. К примеру, предположим, что вы установили Visual Studio 2017, и присваивает ей понятное имя объекта *последнюю*. Ярлык командной строки разработчика называется **Командная строка разработчика для Visual STUDIO 2017 (последняя)** , в папку с именем **Visual Studio 2017**.

::: moniker-end
::: moniker range="< vs-2017"

Имена папки и в контекстном меню Пуск зависят от установленной версии Visual Studio. Например предположим, что вы установили Visual Studio 2015. Ярлык командной строки разработчика называется **Командная строка разработчика для VS 2015**.

::: moniker-end

## <a name="developer_command_prompt"></a> Открытие окна "Командная строка разработчика"

1. На рабочем столе откройте меню **Пуск** Windows, прокрутите вниз, чтобы найти и открыть папку вашей версии Visual Studio, например **Visual Studio 2019**.

1. В папке выберите ярлык **Командная строка разработчика** для вашей версии Visual Studio. Этот ярлык запускает окно командной строки разработчика, которое использует архитектуру сборки по умолчанию: 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86. Если вы предпочитаете архитектуру сборки не по умолчанию, выберите одну из собственных командных строк или командную строку инструментов кросс-компиляции, чтобы указать узел и целевую архитектуру.

Еще более быстрый способ открыть командную строку разработчика, введите *Командная строка разработчика* в поле поиска на рабочем столе. Затем выберите нужный результат.

## <a name="developer_command_file_locations"></a> Расположение командных файлов разработчика

Если вы хотите настроить среду сборки в существующее окно командной строки, можно использовать один из файлов команд, созданный установщиком. Мы рекомендуем настроить среду в новом окне командной строки. Мы не рекомендуем более поздних версий коммутатора, в том же окне.

::: moniker range=">= vs-2019"

Расположение файла команды зависит от версии Visual Studio, вы установили и значений, выбранных во время установки. Для Visual Studio 2019 г., каталог установки на 64-разрядной системе находится в \\Program Files (x86)\\Microsoft Visual Studio\\2019\\*edition*. *Выпуск* может быть Community, Professional, Enterprise, BuildTools или другой псевдоним, предоставленный вами.

::: moniker-end
::: moniker range="= vs-2017"

Расположение файла команды зависит от версии Visual Studio, вы установили и значений, выбранных во время установки. Для Visual Studio 2017, типичные для установки на 64-разрядной системе используется в \\Program Files (x86)\\Microsoft Visual Studio\\2017\\*edition*. *Выпуск* может быть Community, Professional, Enterprise, BuildTools или другой псевдоним, предоставленный вами.

::: moniker-end
::: moniker range="< vs-2017"

Расположение файла команды зависит от того, данная версия Visual Studio и в каталоге установки. Для Visual Studio 2015, типичные для установки используется каталог в \\Program Files (x86)\\Microsoft Visual Studio 14.0.

::: moniker-end

Основным разработчиком командной командный файл VsDevCmd.bat, находится в Common7\\подкаталоге Tools. Если параметры не указаны, он задает среду для использования средства x86-машинный код для создания 32-разрядный x86 кода.

::: moniker range=">= vs-2017"

Дополнительные командные файлы доступны для настройки архитектуры конкретной сборки. Доступных командных файлов зависят от рабочих нагрузок Visual Studio и параметры, которые вы установили. В Visual Studio 2017 и Visual Studio 2019 г., их можно найти в Виртуальном\\вспомогательный\\вложенная папка построения.

::: moniker-end
::: moniker range="< vs-2017"

Дополнительные командные файлы доступны для настройки архитектуры конкретной сборки. Доступных командных файлов зависят от рабочих нагрузок Visual Studio и параметры, которые вы установили. В Visual Studio 2015, они находятся в Виртуальном VC\\bin или VC\\bin\\*архитектура* подкаталоги, где *архитектура* является одним из собственных или Параметры кросс компилятор.

::: moniker-end

Эти командные файлы устанавливают параметры по умолчанию и вызывают VsDevCmd.bat, чтобы настроить указанную среду архитектуры сборки. Обычная установка может включать следующие командные файлы:

|Командный файл|Узел и целевые архитектуры|
|---|---|
|**vcvars32.bat**| Использует 32-разрядные собственные инструменты x86 для сборки 32-разрядного машинного кода x86.|
|**vcvars64.bat**| Использует 64-разрядные собственные инструменты x64 для сборки 64-разрядного кода x64.|
|**vcvarsx86_amd64.bat**| Использует 32-разрядные собственные инструменты кросс-компиляции x86 для сборки 64-разрядного кода x64.|
|**vcvarsamd64_x86.bat**| Использует 64-разрядные собственные инструменты кросс-компиляции x64 для сборки 32-разрядного кода x86.|
|**vcvarsx86_arm.bat**| Использует 32-разрядные собственные инструменты кросс-компиляции x86 для сборки кода ARM.|
|**vcvarsamd64_arm.bat**| Использует 64-разрядные собственные инструменты кросс-компиляции x64 для сборки кода ARM.|
|**vcvarsall.bat**| Используйте параметры, чтобы указать сервер узла и целевой архитектуры, пакет SDK для Windows и платформ. Список поддерживаемых вариантов можно вызвать параметром **/help**.|

> [!CAUTION]
> Файл vcvarsall.bat и другие командные файлы Visual Studio могут различаться на разных компьютерах. Не заменяйте отсутствующий или поврежденный файл vcvarsall.bat файлом с другого компьютера. Перезапустите Visual Studio Installer, чтобы заменить отсутствующий файл.
>
> Файл vcvarsall.bat также может иметь отличия в разных версиях. Если текущая версия Visual Studio установлена на компьютере, на котором также имеется более ранняя версия Visual Studio, не запускайте файл vcvarsall.bat или другой командный файл других версий в том же окне командной строки.

## <a name="use-the-developer-tools-in-an-existing-command-window"></a>Использование средств разработчика в существующем окне командной строки

Самый простой способ указать конкретную архитектуру сборки в существующем окне команд — использовать файл vcvarsall.bat. Использование файла vcvarsall.bat для установки переменных среды для настройки командной строки для собственной компиляции на 32-разрядная или 64-разрядной. Аргументы позволяют задавать перекрестной компиляции для x86, x 64, ARM, ARM64 процессора или. Можно ориентироваться на платформах Microsoft Store, универсальной платформы Windows или рабочего стола Windows. Можно даже указать, какой пакет SDK Windows для использования и выберите версию набора инструментов платформы.

При использовании без аргументов, файл vcvarsall.bat настраивает переменные среды для использования текущим компилятором x86-машинный код для Windows Desktop 32-разрядных сред. Вы можете добавить аргументы для настройки среды для использования любого собственного или кросс-компилятора средства. файл Vcvarsall.bat отображает сообщение об ошибке, если указать конфигурацию, которая не установлена или недоступна на компьютере.

### <a name="vcvarsall-syntax"></a>Синтаксис vcvarsall

> **vcvarsall.bat** [*architecture*] [*platform_type*] [*winsdk_version*] [ **-vcvars_ver=** _vcversion_]

*architecture*<br/>
Этот необязательный аргумент указывает узел и целевую архитектуру для использования. Если *архитектура* не указан, используется среда построения по умолчанию. Поддерживаются следующие аргументы:

|*architecture*|Компилятор|Архитектура главного компьютера|Архитектура выходных данных сборки (целевая)|
|----------------------------|--------------|----------------------------------|-------------------------------|
|**x86**|собственный 32-разрядный x86|x86, x64|x86|
|**x86\_amd64** или **x86\_x64**|x64 для x86 (кросс-компилятор)|x86, x64|X64|
|**x86_arm**|ARM для x86 (кросс-компилятор)|x86, x64|ARM|
|**x86_arm64**|ARM64 для x86 (кросс-компилятор)|x86, x64|ARM64|
|**amd64** или **x64**|Собственный 64-разрядный x64|X64|X64|
|**amd64\_x86** или **x64\_x86**|x86 для x64 (кросс-компилятор)|X64|x86|
|**amd64\_arm** или **x64\_arm**|ARM для x64 (кросс-компилятор)|X64|ARM|
|**amd64\_arm64** или **x64\_arm64**|ARM64 для x64 (кросс-компилятор)|X64|ARM64|

*platform_type*<br/>
Этот необязательный аргумент позволяет указать **store** или **uwp** в качестве типа платформы. По умолчанию среда настроена на сборку классических или консольных приложений.

*winsdk_version*<br/>
При необходимости указывает версию Windows SDK для использования. По умолчанию используется последняя установленная версия Windows SDK. Чтобы указать версию Windows SDK, можно использовать полный номер пакета Windows 10 SDK, например **10.0.10240.0**, или указать **8.1**, чтобы использовать Windows 8.1 SDK.

*vcversion*<br/>
При необходимости указывает набор инструментов компилятора Visual Studio для использования. По умолчанию среда должна использовать текущий набор инструментов компилятора Visual Studio.

::: moniker range=">= vs-2019"

Используйте **-vcvars_ver = 14.2 x .yyyyy** для указания определенной версии набора инструментов компилятора Visual Studio 2019.

Используйте **-vcvars_ver = 14.16** чтобы указать последнюю версию набора инструментов компилятора Visual Studio 2017.

::: moniker-end
::: moniker range="= vs-2017"

Используйте **-vcvars_ver = 14.16** чтобы указать последнюю версию набора инструментов компилятора Visual Studio 2017.

Используйте **-vcvars_ver = 14,1 x .yyyyy** для указания определенной версии набора инструментов компилятора Visual Studio 2017.

::: moniker-end

Используйте **-vcvars_ver = 14.0** указать набор инструментов компилятора Visual Studio 2015.

<a name="vcvarsall"></a>
#### <a name="to-set-up-the-build-environment-in-an-existing-command-prompt-window"></a>Настройка среды сборки в существующем окне командной строки

1. В командной строке выполните команду CD, чтобы перейти на каталог установки Visual Studio. Затем снова используйте CD, чтобы перейти в подкаталог, который содержит зависящие от конфигурации командные файлы. 2019 г. Visual Studio и Visual Studio 2017, воспользуйтесь *VC\\вспомогательный\\построения* подкаталог. Для Visual Studio 2015 используйте *VC* подкаталог.

1. Введите команду для вашей среды разработки. Например для построения кода ARM для универсальной платформы Windows на 64-разрядной платформе, с помощью последнего пакета SDK для Windows и Visual Studio компилятор набора инструментов, используйте эту командную строку:

   `vcvarsall.bat amd64_arm uwp`

## <a name="create-your-own-command-prompt-shortcut"></a>Создание собственных ярлыков командной строки

::: moniker range=">= vs-2019"

Откройте диалоговое окно свойств см. в разделе целевой объект команды использовать ярлык командной строки разработчика. Например, целевой объект для ярлыка **командной строки Native Tools x64 для VS 2019** выглядит примерно следующим образом:

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvars64.bat"`

::: moniker-end
::: moniker range="= vs-2017"

Откройте диалоговое окно свойств см. в разделе целевой объект команды использовать ярлык командной строки разработчика. Например, целевой объект для **x64 Командная строка Native Tools для Visual STUDIO 2017** ярлык — примерно такой результат:

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvars64.bat"`

::: moniker-end
::: moniker range="< vs-2017"

Откройте диалоговое окно свойств см. в разделе целевой объект команды использовать ярлык командной строки разработчика. Например, целевой объект для **VS2015 x64 Командная строка Native Tools** ярлык — примерно такой результат:

`%comspec% /k ""C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat"" amd64`

::: moniker-end

Пакетные файлы конкретной архитектуры задают параметр *architecture* и вызывают vcvarsall.bat. Те же параметры можно передать эти пакетные файлы, которые будут передаваться в файл vcvarsall.bat или можно просто вызвать vcvarsall.bat непосредственно. Чтобы задать параметры для ярлыка своей командной строки, добавьте их в конец команды в двойных кавычках. Например здесь является ярлыком для сборки кода ARM для универсальной платформы Windows на 64-разрядной платформе, используя последнюю версию пакета Windows SDK. Чтобы использовать более ранние набор инструментов компилятора, укажите номер версии. Используйте подобный целевой объект команды в ярлыке:

::: moniker range=">= vs-2019"

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Auxiliary\Build\vcvarsall.bat amd64_arm uwp -vcvars_ver=14.16"`

::: moniker-end
::: moniker range="= vs-2017"

`%comspec% /k "C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\VC\Auxiliary\Build\vcvarsall.bat amd64_arm uwp -vcvars_ver=14.0"`

::: moniker-end
::: moniker range="< vs-2017"

`%comspec% /k ""C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\vcvarsall.bat"" amd64 -vcvars_ver=12.0`

::: moniker-end

Измените путь в соответствии с каталога установки Visual Studio. Файл vcvarsall.bat содержит дополнительную информацию об определенных номерах версии.

## <a name="command-line-tools"></a>Средства командной строки

Для построения C /C++ проекта в командной строке Visual Studio предоставляет эти средства командной строки:

[CL](reference/compiling-a-c-cpp-program.md)<br/>
Используйте компилятор (cl.exe) для компиляции и компоновки файлов исходного кода в приложения, библиотеки и DLL.

[Ссылка](reference/linking.md)<br/>
Используйте компоновщик (link.exe) для компоновки скомпилированных объектных файлов и библиотек в приложения и DLL.

[MSBuild](msbuild-visual-cpp.md)<br/>
Используйте MSBuild (msbuild.exe) и файл проекта (VCXPROJ) для настройки сборки и косвенного вызова набора инструментов. Это аналогично выполнению **построения** проекта или **построить решение** команду в Интегрированной среде разработки Visual Studio. Запустите MSBuild из командной строки — это расширенный сценарий и обычно не рекомендуется.

[DEVENV](/visualstudio/ide/reference/devenv-command-line-switches)<br/>
Используйте DEVENV (devenv.exe) вместе с помощью параметра командной строки, такие как **/Build** или **/Clean** для выполнения определенных команд сборки без отображения Интегрированной среды разработки Visual Studio. В общем случае DEVENV является предпочтительным по сравнению с использованием MSBuild напрямую, так как вы можете разрешить Visual Studio обрабатывать сложности, связанные с MSBuild.

[NMAKE](reference/nmake-reference.md)<br/>
Используйте NMAKE (nmake.exe) в Windows для создания проектов C++ на основе традиционного файла makefile.

При построении в командной строке команда F1 недоступна для мгновенного получения справки. Вместо этого используйте поисковую систему для получения сведений о предупреждениях, ошибках и сообщениях или используйте автономные файлы справки. Использование поиска в [docs.microsoft.com](https://docs.microsoft.com/cpp/), используйте поле поиска в верхней части страницы.

## <a name="in-this-section"></a>В этом разделе

В этих статьях показано, как создавать приложения в командной строке, а также описаны способы настройки среды командной строки. Некоторые показывают, как использовать 64-разрядного набора программ и версией x86, x 64, ARM, ARM64 платформах и. Они также описывают использование средств сборки из командной строки MSBuild и NMAKE.

[Пошаговое руководство: Компиляция собственной программы на языке C++ из командной строки](walkthrough-compiling-a-native-cpp-program-on-the-command-line.md)<br/>
Предоставляет пример, в котором показано, как создание и компиляция C++ программу в командной строке.

[Пошаговое руководство: Компиляция программы на языке C из командной строки](walkthrough-compile-a-c-program-on-the-command-line.md)<br/>
Описывается компиляция программы, написанной на языке программирования C.

[Пошаговое руководство: Компиляция программы на языке C++/CLI из командной строки](walkthrough-compiling-a-cpp-cli-program-on-the-command-line.md)<br/>
Описывается создание и компиляция программы C++/CLI, в которой используется платформа .NET Framework.

[Пошаговое руководство: Компиляция программы на языке C++/CX из командной строки](walkthrough-compiling-a-cpp-cx-program-on-the-command-line.md)<br/>
Описывается создание и компиляция программы C++/CX, в которой используется среда выполнения Windows.

[Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md)<br/>
Как задать переменные среды для использования 32-разрядная или 64-разрядных набора инструментов для ориентации x86, x64, ARM, ARM64 платформах и.

[Справочник по программе NMAKE](reference/nmake-reference.md)<br/>
Содержит ссылки на статьи, в которых описывается служебная программа обслуживания программ Майкрософт (NMAKE.EXE).

[MSBuild в командной строке — C++](msbuild-visual-cpp.md)<br/>
Содержит ссылки на статьи, в которых рассматривается использование программы msbuild.exe из командной строки.

## <a name="related-sections"></a>Связанные разделы

[/MD, /MT, /LD (использование библиотеки времени выполнения)](reference/md-mt-ld-use-run-time-library.md)<br/>
Описывается использование этих параметров компилятора для работы с библиотекой времени выполнения отладки или выпуска.

[Параметры компилятора C/C++](reference/compiler-options.md)<br/>
Содержит ссылки на статьи, посвященные параметрам компилятора C и C++, а также программе CL.exe.

[Параметры компоновщика MSVC](reference/linker-options.md)<br/>
Содержит ссылки на статьи, посвященные параметрам компоновщика и программе LINK.exe.

[Дополнительные инструменты сборки MSVC](reference/c-cpp-build-tools.md)<br/>
Содержит ссылки на средства сборки C/C++, включенные в состав Visual Studio.

## <a name="see-also"></a>См. также

[Проекты и системы сборки](projects-and-build-systems-cpp.md)
