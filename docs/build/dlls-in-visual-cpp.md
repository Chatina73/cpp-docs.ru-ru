---
title: DLL в Visual C++
ms.date: 11/04/2016
helpviewer_keywords:
- executable files [C++]
- dynamic linking [C++]
- linking [C++], dynamic vs. static
- DLLs [C++]
- DLLs [C++], about DLLs
ms.assetid: 5216bca4-51e2-466b-b221-0e3e776056f0
ms.openlocfilehash: be653be42b1905f1edbcf8d50f7aef2b343c2691
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50667198"
---
# <a name="dlls-in-visual-c"></a>DLL в Visual C++

В Windows библиотеки динамической компоновки (DLL) представляет собой исполняемый файл, который выступает в качестве общей библиотеки функций и ресурсов. Динамическое связывание — это функция операционной системы, которая позволяет исполняемому файлу вызывать функции или использовать ресурсы, хранящиеся в отдельном файле. Эти функции и ресурсы можно компилировать и развертывать отдельно от использующих их исполняемых файлов. Библиотеки DLL не отдельный исполняемый файл; она выполняется в контексте приложения, который ее вызывает. Операционная система может загрузить библиотеку DLL в памяти приложения при загрузке приложения (*неявное связывание*), или по запросу во время выполнения (*явное связывание*). Библиотеки DLL также упрощают совместное использование функций и ресурсов различными исполняемыми файлами. Несколько приложений могут осуществлять одновременный доступ к содержимому одной копии библиотеки DLL в памяти.

## <a name="differences-between-dynamic-linking-and-static-linking"></a>Различия между динамическое связывание и статическое связывание

Статическое связывание копирует всего объектного кода в статическую библиотеку в исполняемые файлы, которые применяется, если они создаются. Динамическая компоновка включает только те сведения, необходимые во время выполнения для поиска и загрузки библиотеки DLL, которая содержит элемент данных или функции Windows. При создании библиотеки DLL, вы также создать библиотеку импорта, который содержит эту информацию. При создании исполняемого файла, который вызывает библиотеку DLL, компоновщик использует экспортированные символы в библиотеке импорта для хранения подобной информации для загрузчик Windows. Когда загрузчик загружает библиотеку DLL, сопоставляется с областью памяти приложения. При наличии специальной функции в DLL, `DllMain`, вызывается для выполнения любой инициализации, необходимой библиотеке DLL.

<a name="differences-between-applications-and-dlls"></a>

## <a name="differences-between-applications-and-dlls"></a>Различия между приложениями и библиотеками DLL

Несмотря на то, что библиотеки DLL и приложения, оба исполняемого модуля, они отличаются несколькими способами. Для конечного пользователя самым очевидным отличием является библиотеки DLL не являются приложения, которые могут быть выполнены непосредственно. С точки зрения системы есть два фундаментальных различий между приложениями и библиотеками DLL:

- Приложение может иметь несколько экземпляров в системе одновременно, тогда как библиотеки DLL может иметь только один экземпляр.

- Приложение можно загрузить в качестве процесса, например стека, потоков выполнения, глобальная память, дескрипторы файлов и очередь сообщений может быть владельцем, но нельзя библиотеки DLL.

<a name="advantages-of-using-dlls"></a>

## <a name="advantages-of-using-dlls"></a>Преимущества использования библиотек DLL

Динамическая компоновка вместо статического связывания для кода и ресурсов предоставляет ряд преимуществ. При использовании библиотек DLL можно сохранить область памяти и уменьшить объем переключений. Если несколько приложений могут использовать одну копию библиотеки DLL, можно сэкономить место на диске и пропускную способность для скачивания. Библиотеки DLL можно развертывать и обновлять по отдельности, что позволяет предоставлять послепродажную поддержку и обновления программного обеспечения без необходимости перестроения и отправки всего кода. Библиотеки DLL — удобный способ для предоставления ресурсов под определенный языковой стандарт, которые могут поддерживать многоязычные программы и упрощают создание международных версий приложений. Явное связывание можно разрешить приложению обнаружить и загрузить библиотеки DLL во время выполнения, такие как расширения, которые предоставляют новые возможности.

Динамическая компоновка имеет следующие преимущества:

- Динамическая компоновка сохраняет памяти и уменьшение объема выгрузки. Несколько процессов могут использовать библиотеку DLL одновременно, совместное использование одной копии только для чтения части библиотеки DLL в памяти. Напротив каждое приложение, созданное с помощью статически скомпонованной библиотекой имеет полную копию используемого кода из библиотеки Windows необходимо загрузить в память.

- Динамическая компоновка экономит место на диске и пропускной способности. Многие приложения могут совместно использовать одну копию библиотеки DLL на диске. Напротив для каждого приложения, созданного с помощью библиотеки статическая компоновка имеет программного кода библиотеки в исполняемый образ, который использует больше места на диске и занимает большую пропускную способность для передачи.

- Обслуживание, исправления безопасности и обновления могут быть удобнее. Когда приложения используют общие функции в библиотеке DLL, затем до тех пор, пока функция аргументы и возвращаемые значения не изменяются, можно реализовать исправления ошибок и развертывание обновлений для библиотеки DLL. При обновлении библиотеки DLL, приложения, использующие их не обязательно должны быть перекомпилированы или повторно связать, и они позволяют создавать новые библиотеки DLL, как можно скорее она развернута. Напротив исправления, внесенные в коде статически связанных объектов необходимо выполнить повторную компоновку и повторное развертывание каждого приложения, который его использует.

- Библиотеки DLL можно использовать для обеспечения поддержки рынке. Например можно изменить видеодрайвер DLL и поддерживают отображение, которые не были доступны, если приложение был отправлен. Можно использовать явное связывание для загрузки расширения приложений в виде библиотек DLL и добавление новых функциональных возможностей в приложение без перестройки или ее повторного развертывания.

- Динамическая компоновка упрощает для поддержки приложений, написанных на разных языках программирования. Программы, написанные на разных языках программирования можно вызвать одну и ту же функцию DLL при соблюдении программы соглашение о вызовах функции. Программы и функции DLL должны быть совместимы с одним из следующих способов: порядок, в котором функция ожидает аргументов помещается в стек, ли функция или приложение отвечает за очистку стека и того, являются ли все аргументы переданных в регистрах.

- Динамическая компоновка предоставляет механизм для расширения классов библиотеки MFC. Можно создавать производные классы от существующих классов MFC и поместите их в библиотеки DLL расширения MFC для использования в приложениях MFC.

- Динамическая компоновка упрощает создание международных версий приложения. Поместив в библиотеке DLL ресурсов для конкретного языкового стандарта, упрощается создание международных версий приложения. Вместо доставку локализованных версиях приложения, строки и изображения для каждого языка, можно поместить в отдельную Библиотеку ресурсов, и затем приложение могло загружать соответствующие ресурсы для данного языкового стандарта, во время выполнения.

Недостаткам для использования библиотек DLL, что приложение не не самодостаточны; Это зависит от существования отдельный модуль DLL, необходимо развернуть или Убедитесь сами в процессе установки.

## <a name="more-information-on-how-to-create-and-use-dlls"></a>Дополнительные сведения о том, как создать и использовать библиотеки DLL

Следующие разделы предоставляют подробные сведения о программировании библиотек DLL в Visual C++.

[Пошаговое руководство. Создание и использование библиотеки DLL (C++)](../build/walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)<br/>
Описывает создание и использование библиотек DLL при помощи Visual Studio.

[Типы библиотек DLL](../build/kinds-of-dlls.md)<br/>
Предоставляет сведения о различных типах библиотек DLL, которые доступны для сборки.

[Вопросы и ответы по библиотекам DLL](../build/dll-frequently-asked-questions.md)<br/>
Ответы на часто задаваемые вопросы о библиотеках DLL.

[Связывание исполняемого файла с библиотекой DLL](../build/linking-an-executable-to-a-dll.md)<br/>
Описание явного и неявного соединения с библиотекой DLL.

[Инициализация библиотеки DLL](../build/run-time-library-behavior.md#initializing-a-dll)<br/>
Процесс инициализации кода, необходимый для выполнения загрузки библиотеки DLL.

[Библиотеки DLL и поведение библиотеки времени выполнения Visual C++](../build/run-time-library-behavior.md)<br/>
Выполнение библиотекой времени выполнения функции запускаемой последовательности DLL.

[Функции LoadLibrary и AfxLoadLibrary](../build/loadlibrary-and-afxloadlibrary.md)<br/>
Обсуждается использование **LoadLibrary** и `AfxLoadLibrary` для явного связывания с библиотекой DLL во время выполнения.

[Функция GetProcAddress](../build/getprocaddress.md)<br/>
Обсуждается использование **GetProcAddress** получить адрес экспортированной функции в библиотеке DLL.

[Функции FreeLibrary и AfxFreeLibrary](../build/freelibrary-and-afxfreelibrary.md)<br/>
Обсуждается использование **FreeLibrary** и `AfxFreeLibrary` когда модуль DLL больше не нужны.

[Порядок поиска библиотеки динамической компоновки](/windows/desktop/Dlls/dynamic-link-library-search-order)<br/>
Описание пути поиска, который операционная система Windows использует для поиска библиотеки DLL в системе.

[Состояния модулей обычной DLL-библиотеки MFC, динамически связанной с MFC](../build/module-states-of-a-regular-dll-dynamically-linked-to-mfc.md)<br/>
Описывает состояние модулей регулярной, библиотеки DLL MFC, динамически компонуемые с MFC.

[Библиотеки DLL расширений MFC](../build/extension-dlls-overview.md)<br/>
Наличие библиотек DLL, которые обычно реализуют классы многократного использования в существующих библиотеках классов Microsoft Foundation Class.

[Создание библиотек DLL, содержащих только ресурсы](../build/creating-a-resource-only-dll.md)<br/>
Библиотека DLL, содержащая только ресурсы, например значки, растровые изображения, строки и диалоговые окна.

[Локализованные ресурсы в приложениях MFC: вспомогательные библиотеки DLL](../build/localized-resources-in-mfc-applications-satellite-dlls.md)<br/>
Расширенная поддержка библиотек спутниковой связи DLL и содержит возможность, которая позволяет создавать приложения, локализированные на различные языки.

[Импортирование и экспортирование](../build/importing-and-exporting.md)<br/>
Импортирование открытых символов в приложение или экспортирование функций из библиотеки DLL

[Технология Active и библиотеки DLL](../build/active-technology-and-dlls.md)<br/>
Размещение серверов объектов внутри библиотеки DLL.

[Автоматизация в библиотеке DLL](../build/automation-in-a-dll.md)<br/>
Параметр автоматизации в решениях мастера библиотек DLL MFC.

[Соглашения об именовании библиотек DLL MFC](../mfc/mfc-library-versions.md#mfc-static-library-naming-conventions)<br/>
Способ встраивания библиотек DLL в MFC, опираясь на четко структурированное соглашение об именовании.

[Вызов функций библиотек DLL из приложений Visual Basic](../build/calling-dll-functions-from-visual-basic-applications.md)<br/>
Способ вызова функций DLL из приложений Visual Basic.

## <a name="related-sections"></a>Связанные разделы

[Использование MFC как часть библиотеки DLL](../mfc/tn011-using-mfc-as-part-of-a-dll.md)<br/>
Описывает постоянные библиотеки DLL MFC, которые позволяют использовать библиотеку MFC как часть библиотеки динамической компоновки Windows.

[Версия библиотеки DLL MFC](../mfc/tn033-dll-version-of-mfc.md)<br/>
Описывает, как можно использовать MFCxx.dll и MFCxxD.dll (где x — номер версии MFC) общие библиотеки динамической компоновки с MFC-приложения и библиотеки DLL расширений MFC.
