---
title: Создание C/C++ DLL в Visual Studio
ms.date: 07/18/2019
helpviewer_keywords:
- executable files [C++]
- dynamic linking [C++]
- linking [C++], dynamic vs. static
- DLLs [C++]
- DLLs [C++], about DLLs
ms.assetid: 5216bca4-51e2-466b-b221-0e3e776056f0
ms.openlocfilehash: 9f5b34fda8a429f8e55631e1e0125ed6f79d5bae
ms.sourcegitcommit: 0867d648e0955ebad7260b5fbebfd6cd4d58f3c7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/19/2019
ms.locfileid: "68341067"
---
# <a name="create-cc-dlls-in-visual-studio"></a>Создание C/C++ DLL в Visual Studio

В Windows библиотека динамической компоновки (DLL) — это разновидность исполняемого файла, который выступает в качестве общей библиотеки функций и ресурсов. Динамическая компоновка — это возможность операционной системы, которая позволяет исполняемому файлу вызывать функции или использовать ресурсы, хранящиеся в отдельном файле. Эти функции и ресурсы можно компилировать и развертывать отдельно от использующих их исполняемых файлов. Библиотека DLL не является изолированным исполняемым файлом; он выполняется в контексте приложения, которое его вызывает. Операционная система может загрузить библиотеку DLL в пространство памяти приложения при загрузке приложения (неявное связывание) или по запросу во время выполнения (*явная компоновка*). Библиотеки DLL также упрощают совместное использование функций и ресурсов различными исполняемыми файлами. Несколько приложений могут осуществлять одновременный доступ к содержимому одной копии библиотеки DLL в памяти.

## <a name="differences-between-dynamic-linking-and-static-linking"></a>Различия между динамической компоновкой и статической компоновкой

Статическая компоновка копирует весь объектный код в статическую библиотеку в исполняемые объекты, использующие его при построении. Динамическая компоновка включает только сведения, необходимые Windows во время выполнения для нахождение и загрузки библиотеки DLL, содержащей элемент данных или функцию. При создании библиотеки DLL также создается библиотека импорта, содержащая эти сведения. При создании исполняемого файла, вызывающего библиотеку DLL, компоновщик использует экспортированные символы в библиотеке импорта для хранения этих сведений для загрузчика Windows. Когда загрузчик загружает библиотеку DLL, Библиотека DLL сопоставляется с областью памяти приложения. При наличии специальной функции в DLL, `DllMain`вызывается для выполнения любой инициализации, требуемой для библиотеки DLL.

<a name="differences-between-applications-and-dlls"></a>

## <a name="differences-between-applications-and-dlls"></a>Различия между приложениями и библиотеками DLL

Несмотря на то что библиотеки DLL и приложения являются исполняемыми модулями, они отличаются несколькими способами. Самым очевидным различием является то, что библиотеки DLL не являются приложениями, которые можно выполнить напрямую. С точки зрения системы существует два фундаментальных различия между приложениями и библиотеками DLL:

- Приложение может одновременно работать в системе сразу с несколькими экземплярами, в то время как библиотека DLL может иметь только один экземпляр.

- Приложение может быть загружено как процесс, который может владеть такими объектами, как стек, потоки выполнения, глобальная память, дескрипторы файлов и очередь сообщений, но библиотека DLL не может.

<a name="advantages-of-using-dlls"></a>

## <a name="advantages-of-using-dlls"></a>Преимущества использования библиотек DLL

Динамическая компоновка с кодом и ресурсами обеспечивает ряд преимуществ по сравнению со статической компоновкой.

- Динамическая компоновка экономит память и сокращает подкачку. Многие процессы могут использовать библиотеку DLL одновременно, совместно используя одну копию частей библиотеки DLL, предназначенных только для чтения, в памяти. В отличие от этого, каждое приложение, созданное с помощью статической библиотеки, имеет полную копию кода библиотеки, которую Windows должна загрузить в память.

- Динамическая компоновка экономит место на диске и пропускную способность. Многие приложения могут совместно использовать одну копию библиотеки DLL на диске. В отличие от этого, каждое приложение, созданное с помощью статической библиотеки ссылок, имеет код библиотеки, связанный с исполняемым образом, который использует больше места на диске и требует больше пропускной способности для передачи.

- Обслуживание, исправления безопасности и обновления могут быть проще. Если приложения используют общие функции в библиотеке DLL, то при условии, что аргументы функции и возвращаемые значения не изменяются, можно реализовать исправления ошибок и развернуть обновления в библиотеке DLL. При обновлении библиотек DLL не нужно перекомпилировать или повторно связывать приложения, использующие их, и использовать новую библиотеку DLL сразу после развертывания. В отличие от этого, исправления, вносимые в статически связываемый объектный код, нуждаются в повторной компоновке и повторном развертывании всех приложений, использующих его.

- Вы можете использовать библиотеки DLL для предоставления поддержки по окончании рынка. Например, библиотеку DLL видеодрайверов можно изменить для поддержки дисплея, недоступного при отгрузке приложения.

- Вы можете использовать явную связь для обнаружения и загрузки библиотек DLL во время выполнения, например расширения приложений, которые добавляют в приложение новые функциональные возможности без перестроения или повторного развертывания.

- Динамическая компоновка упрощает поддержку приложений, написанных на разных языках программирования. Программы, написанные на разных языках программирования, могут вызывать одну и ту же функцию DLL, если программы следуют соглашению о вызовах функции. Программы и функции DLL должны быть совместимы следующими способами: порядок, в котором функция ожидает передачи своих аргументов в стек, независимо от того, отвечает ли функция или приложение за очистку стека, а также укажите, являются ли аргументы передано в регистрах.

- Динамическая компоновка предоставляет механизм для расширения классов библиотеки MFC. Можно наследовать классы из существующих классов MFC и поместить их в библиотеку DLL расширения MFC для использования приложениями MFC.

- Динамическая компоновка упрощает создание международных версий приложения. Библиотеки DLL — это удобный способ предоставления ресурсов, зависящих от языкового стандарта, что значительно упрощает создание международных версий приложения. Вместо доставки нескольких локализованных версий приложения можно разместить строки и изображения для каждого языка в отдельной библиотеке ресурсов DLL, а затем приложение может загрузить соответствующие ресурсы для этого языкового стандарта во время выполнения.

Потенциальные недостатки использования библиотек DLL заключается в том, что приложение не является автономным; Это зависит от существования отдельного модуля DLL, который необходимо развернуть или проверить в ходе установки.

## <a name="more-information-on-how-to-create-and-use-dlls"></a>Дополнительные сведения о создании и использовании библиотек DLL

В следующих разделах содержатся подробные сведения о создании C/C++ DLL в Visual Studio.

[Пошаговое руководство: Создание и использование библиотеки DLL (C++)](walkthrough-creating-and-using-a-dynamic-link-library-cpp.md)<br/>
Описывает создание и использование библиотек DLL при помощи Visual Studio.

[Типы библиотек DLL](kinds-of-dlls.md)<br/>
Предоставляет сведения о различных типах библиотек DLL, которые доступны для сборки.

[Часто задаваемые вопросы о библиотеке DLL](dll-frequently-asked-questions.md)<br/>
Ответы на часто задаваемые вопросы о библиотеках DLL.

[Связывание исполняемого файла с библиотекой DLL](linking-an-executable-to-a-dll.md)<br/>
Описание явного и неявного соединения с библиотекой DLL.

[Инициализация библиотеки DLL](run-time-library-behavior.md#initializing-a-dll)<br/>
Описывает код инициализации DLL, который должен выполняться при загрузке библиотеки DLL.

[Библиотеки DLL и поведение библиотеки времени выполнения Visual C++](run-time-library-behavior.md)<br/>
Выполнение библиотекой времени выполнения функции запускаемой последовательности DLL.

[Функции LoadLibrary и AfxLoadLibrary](loadlibrary-and-afxloadlibrary.md)<br/>
Обсуждается использование **LoadLibrary** и `AfxLoadLibrary` явная ссылка на библиотеку DLL во время выполнения.

[Функция GetProcAddress](getprocaddress.md)<br/>
Обсуждается использование **GetProcAddress** для получения адреса экспортированной функции в библиотеке DLL.

[Функции FreeLibrary и AfxFreeLibrary](freelibrary-and-afxfreelibrary.md)<br/>
Обсуждается использование **FreeLibrary** и `AfxFreeLibrary` случаи, когда модуль DLL больше не нужен.

[Порядок поиска библиотек динамической компоновки](/windows/desktop/Dlls/dynamic-link-library-search-order)<br/>
Описание пути поиска, который операционная система Windows использует для поиска библиотеки DLL в системе.

[Состояния модулей обычной DLL-библиотеки MFC, динамически связанной с MFC](module-states-of-a-regular-dll-dynamically-linked-to-mfc.md)<br/>
Описывает состояния модулей обычной библиотеки DLL MFC, динамически связываемые с MFC.

[Библиотеки DLL расширений MFC](extension-dlls-overview.md)<br/>
Наличие библиотек DLL, которые обычно реализуют классы многократного использования в существующих библиотеках классов Microsoft Foundation Class.

[Создание библиотек DLL, содержащих только ресурсы](creating-a-resource-only-dll.md)<br/>
Библиотека DLL, содержащая только ресурсы, например значки, растровые изображения, строки и диалоговые окна.

[Локализованные ресурсы в приложениях MFC: вспомогательные библиотеки DLL](localized-resources-in-mfc-applications-satellite-dlls.md)<br/>
Расширенная поддержка библиотек спутниковой связи DLL и содержит возможность, которая позволяет создавать приложения, локализированные на различные языки.

[Импортирование и экспортирование](importing-and-exporting.md)<br/>
Импортирование открытых символов в приложение или экспортирование функций из библиотеки DLL

[Технология Active и библиотеки DLL](active-technology-and-dlls.md)<br/>
Размещение серверов объектов внутри библиотеки DLL.

[Автоматизация в библиотеке DLL](automation-in-a-dll.md)<br/>
Параметр автоматизации в решениях мастера библиотек DLL MFC.

[Соглашения об именовании библиотек DLL MFC](../mfc/mfc-library-versions.md#mfc-static-library-naming-conventions)<br/>
Способ встраивания библиотек DLL в MFC, опираясь на четко структурированное соглашение об именовании.

[Вызов функций DLL из Visual Basic приложений](calling-dll-functions-from-visual-basic-applications.md)<br/>
Способ вызова функций DLL из приложений Visual Basic.

## <a name="related-sections"></a>Связанные разделы

[Использование MFC в качестве части библиотеки DLL](../mfc/tn011-using-mfc-as-part-of-a-dll.md)<br/>
Описывает регулярные библиотеки DLL MFC, которые позволяют использовать библиотеку MFC в составе библиотеки динамической компоновки Windows.

[Версия библиотеки DLL MFC](../mfc/tn033-dll-version-of-mfc.md)<br/>
Описывает, как можно использовать Мфккскс. dll и Мфкксксд. dll (где x — номер версии MFC) общих библиотек динамической компоновки с приложениями MFC и библиотеками DLL расширения MFC.
