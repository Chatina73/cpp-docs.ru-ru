---
title: Совместное или повторное использование параметров проекта Visual Studio — C++
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], reusable
ms.openlocfilehash: bcf54be0531c7150c1506eb6f5dda2b5bc95161f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81328691"
---
# <a name="share-or-reuse-visual-studio-project-settings"></a>Совместное или повторное использование параметров проекта Visual Studio

Чтобы создать настраиваемую группу параметров, которую вы сможете использовать совместно с другими или многократно в нескольких проектах, создайте с помощью **диспетчера свойств** *страницу свойств* (PROPS-файл), где будут храниться параметры для всех видов проектов, которые вы хотите использовать совместно или повторно. Подход с использованием страниц свойств сопряжен с меньшим риском ошибок по сравнению с другими способами, позволяющими создавать глобальные параметры.

> [!IMPORTANT]
> **USER-файлы и связанные с ними проблемы**
>
> В последних версиях Visual Studio использовались глобальные страницы свойств с расширением имени файла USER, которые были расположены в папке \<профиль_пользователя>\AppData\Local\Microsoft\MSBuild\v4.0\. Мы больше не рекомендуем использовать эти файлы, поскольку они определяют свойства для конфигураций проектов для каждого пользователя и для каждого компьютера. Такие "глобальные" параметры могут конфликтовать со сборками, особенно при использовании нескольких целевых платформ на компьютере сборки. Например, при наличии одновременно проекта MFC и проекта Windows Phone свойства USER будут недопустимыми для одного из них. Многократно используемые страницы свойств обеспечивают большую гибкость и надежность.
>
> Хотя USER-файлы по-прежнему устанавливаются средой Visual Studio и участвуют в наследовании свойств, по умолчанию они являются пустыми. Рекомендуется удалить ссылку на эти файлы в **диспетчере свойств**, чтобы гарантировать работу проектов независимо от параметров конкретного пользователя или конкретного компьютера. Это важно для обеспечения правильного поведения в среде управления исходным кодом (SCC).

Чтобы открыть **диспетчер свойств**, в зависимости от параметров выберите в строке меню **Вид** > **Диспетчер свойств** или **Вид** > **Другие окна** > **Диспетчер свойств**.

Если имеется общий, часто используемый набор свойств, которые нужно применить к нескольким проектам, то с помощью **диспетчера свойств** их можно записать в многоразовый файл *страницы свойств*, который по соглашению имеет расширение PROPS. Эту страницу можно применять к новым проектам, чтобы исключить необходимость в задании свойств с нуля.

![Контекстное меню диспетчера свойств](media/sharingnew.png "SharingNew")

Внутри каждого узла конфигурации отображаются узлы для каждой страницы свойств, которая применяется к этой конфигурации. Система добавляет страницы свойств, которые задают значения в зависимости от параметров, выбранных в мастере приложений при создании проекта. Щелкните правой кнопкой мыши любой узел и выберите пункт "Свойства", чтобы просмотреть свойства, применяемые к этому узлу. Все страницы свойств автоматически импортируются в "главную" страницу свойств проекта (ms.cpp.props) и оцениваются в порядке их следования в диспетчере свойств. Вы можете переместить их, чтобы изменить порядок оценки. Страницы свойств, которые оцениваются позже, переопределяют значения ранее оцененных страниц. Дополнительные сведения о порядке вычисления в VCXPROJ-файле, файлах с расширением PROPS и TARGETS, переменных среды и командной строке см. в разделе [Наследование свойств проекта](project-property-inheritance.md).

Если щелкнуть команду **Добавить новую страницу свойств проекта**, а затем выбрать, например, страницу свойств MyProps.props, отображается диалоговое окно страницы свойств. Обратите внимание, что оно относится к странице свойств MyProps; все вносимые изменения записываются на эту страницу, а не в файл проекта (с расширением VCXPROJ).

Свойства на странице свойств переопределяются, если то же свойство задано непосредственно в VCXPROJ-файле.

Страницу свойств можно импортировать любое количество раз. Несколько проектов в решении могут наследовать параметры от одной страницы свойств, и проект может иметь несколько страниц. Страница свойств сама может наследовать параметры от другой страницы свойств.

Также можно создать одну страницу свойства для нескольких конфигураций. Для этого создайте страницу свойств для каждой конфигурации, откройте контекстное меню для одной из них, выберите **Добавить существующую страницу свойств** и добавьте другие страницы. Однако при использовании одной общей страницы свойств следует иметь в виду, что, устанавливая свойство, вы задаете его для всех конфигураций, к которым применяется соответствующая страница, и интегрированная среда разработки не указывает, какие проекты или другие страницы свойств наследуют от данной страницы свойств.

В больших решениях, которые будут содержать много проектов, имеет смысл создать страницу свойств на уровне решения. При добавлении проекта к решению используйте **диспетчер свойств** для добавления этой страницы свойств в проект. При необходимости можно добавить новую страницу свойств на уровне проекта для задания значений, относящихся к данному проекту.

> [!IMPORTANT]
> По умолчанию PROPS-файл не участвует в системе управления версиями, поскольку он не создается как элемент проекта. Если требуется включить этот файл в систему управления версиями, можно вручную добавить его как элемент решения.

#### <a name="to-create-a-property-sheet"></a>Создание страницы свойств

1. В строке меню выберите **Вид** > **Диспетчер свойств** или **Вид** > **Другие окна** > **Диспетчер свойств**. Открывается диалоговое окно **Диспетчер свойств**.

2. Чтобы определить область страницы свойств, выберите элемент, к которому она применяется. Это может быть определенная конфигурация или другая страница свойств. Откройте контекстное меню этого элемента и выберите команду **Добавить новую страницу свойств проекта**. Укажите имя и расположение.

3. В **диспетчере свойств** откройте новую страницу свойств, а затем задайте свойства, которые следует включить.
