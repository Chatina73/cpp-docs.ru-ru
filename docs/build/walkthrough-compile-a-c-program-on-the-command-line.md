---
title: Пошаговое руководство. Компиляция программы на языке C в командной строке
ms.custom: conceptual
ms.date: 04/25/2019
helpviewer_keywords:
- command-line applications [C++], C programs
- Visual C, compiling
- compiling programs [C++]
- C program compiling [C++]
ms.assetid: 7e74cc2d-54b1-49de-b7ad-d3ae6b39ab8d
ms.openlocfilehash: 1b4e7f0f188ce7b3003f12cb7acafaf15a03d86a
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078243"
---
# <a name="walkthrough-compile-a-c-program-on-the-command-line"></a>Пошаговое руководство. Компиляция программы на языке C в командной строке

Visual C++ Basic включает компилятор на языке C, который можно использовать для создания всего от простых консольных программ до полноценных классических приложений Windows, мобильных приложений и многого другого.

В этом пошаговом руководстве показано, как создать простую программу в стиле C в текстовом редакторе, а затем скомпилировать ее в командной строке. Если вы предпочитаете работать в C++ командной строке, см. раздел [Пошаговое руководство. Компиляция C++ собственной программы в командной строке](walkthrough-compiling-a-native-cpp-program-on-the-command-line.md). Если вы хотите опробовать интегрированную среду разработки Visual Studio вместо использования командной строки, см. раздел [Пошаговое руководство. Работа с проектамиC++и решениями ()](../ide/walkthrough-working-with-projects-and-solutions-cpp.md) или [Использование интегрированной среды разработки Visual Studio для C++ разработки классических приложений](../ide/using-the-visual-studio-ide-for-cpp-desktop-development.md).

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого пошагового руководства необходимо установить Visual Studio и дополнительные визуальные C++ компоненты или средства сборки для Visual Studio.

Visual Studio — это мощная интегрированная среда разработки, которая поддерживает полнофункциональный редактор, диспетчеры ресурсов, отладчики и компиляторы для многих языков и платформ. Сведения об этих функциях и скачивании и установке Visual Studio, включая бесплатный выпуск Visual Studio Community, см. в [статье Установка Visual Studio](/visualstudio/install/install-visual-studio).

Версия Visual Studio Tools для Visual Studio устанавливает только набор средств командной строки, компиляторы, средства и библиотеки, необходимые для сборки C и C++ программ. Это идеальный вариант для создания лабораторий и учебных занятий, а установка выполняется относительно быстро. Чтобы установить только набор средств командной строки, скачайте средства сборки для Visual Studio с веб-страницы [загрузки Visual Studio](https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019) и запустите установщик. В установщике Visual Studio выберите рабочую нагрузку  **C++ средства сборки** и нажмите кнопку **установить**.

Прежде чем можно будет выполнить сборку C C++ или программы в командной строке, необходимо убедиться, что средства установлены и к ним можно получить доступ из командной строки. Визуальный C++ элемент имеет сложные требования к среде командной строки для поиска используемых инструментов, заголовков и библиотек. **C++ Визуальный элемент нельзя использовать в простом окне командной строки** без какой-либо подготовки. Вам потребуется окно *командной строки разработчика* , которое является обычным окном командной строки, в котором заданы все необходимые переменные среды. К счастью, C++ визуальные элементы устанавливают ярлыки для запуска командных запросов разработчика, для которых настроена среда для сборок из командной строки. К сожалению, имена ярлыков командной строки разработчика и места их расположения отличаются практически во всех версиях визуальных C++ элементов и в различных версий Windows. Первое пошаговое руководство — найти правильный ярлык.

> [!NOTE]
> Ярлык командной строки разработчика автоматически задает правильные пути для компилятора и средств, а также для всех необходимых заголовков и библиотек. Некоторые из этих значений отличаются для каждой конфигурации сборки. Эти значения среды необходимо задать самостоятельно, если вы не используете одно из сочетаний клавиш. Дополнительные сведения см. в статье [Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md). Так как среда сборки является сложной, мы настоятельно рекомендуем использовать ярлык командной строки разработчика вместо создания собственного.

Эти инструкции варьируются в зависимости от используемой версии Visual Studio. Прежде чем продолжить, убедитесь, что селектор версий в левом верхнем углу этой страницы установлен правильно.

::: moniker range="vs-2019"

## <a name="open-a-developer-command-prompt-in-visual-studio-2019"></a>Открытие командной строки разработчика в Visual Studio 2019

Если вы установили Visual Studio 2019 в Windows 10, откройте меню "Пуск" и прокрутите вниз и откройте папку **Visual studio 2019** (не приложение visual Studio 2019). Выберите **Командная строка разработчика для VS 2019** , чтобы открыть окно командной строки.

Если вы используете другую версию Windows, откройте меню "Пуск" или начальную страницу для папки средств Visual Studio, содержащей ярлык для командной строки разработчика. Можно также использовать функцию поиска Windows для поиска "Командная строка разработчика" и выбрать ту, которая соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно командной строки.

::: moniker-end

::: moniker range="vs-2017"

## <a name="open-a-developer-command-prompt-in-visual-studio-2017"></a>Открытие командной строки разработчика в Visual Studio 2017

Если вы установили Visual Studio 2017 в Windows 10, откройте меню "Пуск" и прокрутите вниз и откройте папку **Visual studio 2017** (не приложение visual Studio 2017). Выберите **Командная строка разработчика для VS 2017** , чтобы открыть окно командной строки.

Если вы используете другую версию Windows, откройте меню "Пуск" или начальную страницу для папки средств Visual Studio, содержащей ярлык для командной строки разработчика. Можно также использовать функцию поиска Windows для поиска "Командная строка разработчика" и выбрать ту, которая соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно командной строки.

::: moniker-end

::: moniker range="vs-2015"

## <a name="open-a-developer-command-prompt-in-visual-studio-2015"></a>Открытие командной строки разработчика в Visual Studio 2015

Если вы установили Microsoft Visual C++ Build tools 2015 в Windows 10, откройте меню " **Пуск** " и прокрутите вниз и откройте папку " **средства Visual C++ Build** ". Выберите **Visual C++ 2015 Командная строка Native Tools x86** , чтобы открыть окно командной строки.

Если вы используете другую версию Windows, откройте меню "Пуск" или начальную страницу для папки средств Visual Studio, содержащей ярлык для командной строки разработчика. Можно также использовать функцию поиска Windows для поиска "Командная строка разработчика" и выбрать ту, которая соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно командной строки.

::: moniker-end

Затем убедитесь, что Командная C++ строка Visual Developer настроена правильно. В окне командной строки введите `cl` и убедитесь, что выходные данные выглядят примерно так:

```Output
C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise>cl
Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ]
```

В зависимости от версии Visual C++ и установленных обновлений могут возникать различия в текущем каталоге или номерах версий. Если приведенный выше результат похож на отображаемый, то можно приступать к сборке C или C++ программ в командной строке.

> [!NOTE]
> Если при выполнении команды **CL** выдается сообщение об ошибке "CL" не распознается как внутренняя или внешняя команда, возможно, используется программа или пакетный файл, ошибка C1034 или ошибка LNK1104, то либо вы не используете командную строку разработчика, либо что-то не так с установкой Visual C++. Для продолжения работы необходимо устранить эту проблему.

Если вы не можете найти ярлык командной строки разработчика или при вводе `cl`появляется сообщение об ошибке, то, возможно, возникла проблема с установкой визуального C++ элемента. Если вы используете Visual Studio 2017 или более поздней версии, попробуйте переустановить **разработку классических C++ приложений с** рабочей нагрузкой в Visual Studio Installer. Дополнительные сведения см. [в C++ разделе Поддержка установки в Visual Studio](vscpp-step-0-installation.md). Или переустановите средства сборки со страницы [загрузки Visual Studio](https://visualstudio.microsoft.com/downloads/) . Не перейдем к следующему разделу, пока он не будет работать. Дополнительные сведения об установке и устранении неполадок Visual Studio см. в [статье Установка Visual Studio](/visualstudio/install/install-visual-studio).

> [!NOTE]
> В зависимости от версии Windows на компьютере и конфигурации безопасности системы может потребоваться щелкнуть правой кнопкой мыши, чтобы открыть контекстное меню для ярлыка командной строки разработчика, а затем выбрать **Запуск от имени администратора** , чтобы успешно выполнить сборку и запустить программу, созданную в ходе этого пошагового руководства.

## <a name="create-a-c-source-file-and-compile-it-on-the-command-line"></a>Создание исходного файла на языке C и его компиляция в командной строке

1. В окне командной строки разработчика введите `cd c:\`, чтобы изменить текущий рабочий каталог на корень диска C:. Затем введите `md c:\simple`, чтобы создать каталог, а затем введите `cd c:\simple`, чтобы перейти к этому каталогу. Этот каталог будет содержать исходный файл и скомпилированную программу.

1. Введите `notepad simple.c` в командной строке разработчика. В появившемся диалоговом окне оповещения в Блокноте нажмите кнопку **Да** , чтобы создать простой файл с расширением c в рабочем каталоге.

1. В Блокноте введите следующие строки кода:

    ```C
    #include <stdio.h>

    int main()
    {
        printf("Hello, World! This is a native C program compiled on the command line.\n");
        return 0;
    }
    ```

1. В строке меню блокнота выберите **файл** > **сохранить** , чтобы сохранить Simple. c в рабочем каталоге.

1. Вернитесь в окно командной строки разработчика. Введите `dir` в командной строке, чтобы получить список содержимого каталога к:\симпле. Вы увидите исходный файл simple. c в листинге каталога, который выглядит примерно так:

    ```Output
    C:\simple>dir
     Volume in drive C has no label.
     Volume Serial Number is CC62-6545

     Directory of C:\simple

    10/02/2017  03:46 PM    <DIR>          .
    10/02/2017  03:46 PM    <DIR>          ..
    10/02/2017  03:36 PM               143 simple.c
                   1 File(s)            143 bytes
                   2 Dir(s)  514,900,566,016 bytes free

    ```

   Даты и другие сведения будут отличаться на вашем компьютере. Если вы не видите файл исходного кода Simple. c, убедитесь, что вы изменили созданный вами каталог к:\симпле и в блокноте сохраните исходный файл в этом каталоге. Также убедитесь, что исходный код сохранен с расширением имени файла c, а не с расширением txt.

1. Чтобы скомпилировать программу, введите `cl simple.c` в командной строке разработчика.

   В строках выходных данных, отображаемых компилятором, можно увидеть имя исполняемой программы Simple. exe.

    ```Output
    c:\simple>cl simple.c
    Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
    Copyright (C) Microsoft Corporation.  All rights reserved.

    simple.c
    Microsoft (R) Incremental Linker Version 14.10.25017.0
    Copyright (C) Microsoft Corporation.  All rights reserved.

    /out:simple.exe
    simple.obj
    ```

   > [!NOTE]
   > Если появляется сообщение об ошибке "CL" не распознается как внутренняя или внешняя команда, исполняемая программа или пакетный файл, ошибка C1034 или ошибка LNK1104, Командная строка разработчика настроена неправильно. Чтобы получить сведения о том, как устранить эту проблему, вернитесь к разделу **Открытие командной строки разработчика** .

   > [!NOTE]
   > Если вы получаете другое сообщение об ошибке компилятора или компоновщика, просмотрите исходный код, чтобы исправить ошибки, а затем сохраните его и снова запустите компилятор. Для получения сведений о конкретных ошибках используйте поле поиска в верхней части этой страницы, чтобы найти номер ошибки.

1. Чтобы запустить программу, введите `simple` в командной строке.

   Программа выводит следующий текст и затем закрывается:

    ```Output
    Hello, World! This is a native C program compiled on the command line.
    ```

   Поздравляем, вы выполнили компиляцию и запуск программы C с помощью командной строки.

## <a name="next-steps"></a>Следующие шаги

Этот пример «Hello, World» практически прост, как и программа на C. Реальные программы имеют файлы заголовков и другие исходные файлы, связываются в библиотеках и выполняют полезную работу.

Вы можете использовать шаги, описанные в этом пошаговом руководстве, для создания собственного кода на языке C вместо того, чтобы вводить приведенный пример кода. Можно также создать множество примеров кода на языке C, которые можно найти в других местах. Чтобы скомпилировать программу с дополнительными файлами исходного кода, введите их в командной строке, например:

`cl file1.c file2.c file3.c`

Компилятор выводит программу с именем file1. exe. Чтобы изменить имя на PROGRAM1. exe, добавьте параметр компоновщика [/out](reference/out-output-file-name.md) :

`cl file1.c file2.c file3.c /link /out:program1.exe`

Чтобы автоматически перехватывать другие ошибки программирования, рекомендуется выполнить компиляцию с помощью параметра уровня предупреждений [/W3](reference/compiler-option-warning-level.md) или [/W4](reference/compiler-option-warning-level.md) :

`cl /W4 file1.c file2.c file3.c /link /out:program1.exe`

Компилятор CL. exe содержит множество дополнительных параметров, которые можно применять для создания, оптимизации, отладки и анализа кода. Для быстрого списка введите `cl /?` в командной строке разработчика. Можно также выполнять компиляцию и компоновку отдельно и применять параметры компоновщика в более сложных сценариях сборки. Дополнительные сведения о параметрах компилятора и компоновщика и использовании см. в разделе [Справочник по языкуC++ C/здание](reference/c-cpp-building-reference.md).

Для настройки и создания более сложных проектов в командной строке можно использовать NMAKE и файлы Makefile, а также файл MSBuild и проект. Дополнительные сведения об использовании этих средств см. в разделе [Справочник по NMAKE](reference/nmake-reference.md) и [MSBuild](msbuild-visual-cpp.md).

C и C++ языки похожи, но не совпадают. Microsoft C/C++ COMPILER (компилятором MSVC) использует простое правило для определения языка, используемого при компиляции кода. По умолчанию компилятор КОМПИЛЯТОРОМ MSVC обрабатывает все файлы, которые заканчиваются на c как исходный код C, и все файлы, заканчивающиеся на CPP, C++ как исходный код. Чтобы заставить компилятор обрабатывать все файлы как C, не зависящие от расширения имени файла, используйте параметр компилятора [/TC](reference/tc-tp-tc-tp-specify-source-file-type.md) .

КОМПИЛЯТОРОМ MSVC совместим с ISO C99 Standard, но не является строго соответствующим. В большинстве случаев переносимый код на языке C будет компилироваться и выполняться должным образом. Визуальный C++ элемент не поддерживает большинство изменений в ISO C11. Некоторые библиотечные функции и имена функций POSIX не рекомендуются функцией КОМПИЛЯТОРОМ MSVC. Функции поддерживаются, но предпочтительные имена изменились. Дополнительные сведения см. [в разделе функции безопасности в CRT](../c-runtime-library/security-features-in-the-crt.md) и [Предупреждение компилятора (уровень 3) C4996](../error-messages/compiler-warnings/compiler-warning-level-3-c4996.md).

## <a name="see-also"></a>См. также:

[Пошаговое руководство. Создание стандартной программы C++ (C++)](../windows/walkthrough-creating-a-standard-cpp-program-cpp.md)<br/>
[Справочник по языку C#](../c-language/c-language-reference.md)<br/>
[Проекты и системы сборки](projects-and-build-systems-cpp.md)<br/>
[Совместимость](../c-runtime-library/compatibility.md)
