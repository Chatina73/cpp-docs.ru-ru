---
title: Пошаговое руководство. Компиляция программы на языке C из командной строки
ms.custom: conceptual
ms.date: 04/25/2019
helpviewer_keywords:
- command-line applications [C++], C programs
- Visual C, compiling
- compiling programs [C++]
- C program compiling [C++]
ms.assetid: 7e74cc2d-54b1-49de-b7ad-d3ae6b39ab8d
ms.openlocfilehash: d807fa75b32b515c2222fec9ea9d070266303e33
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81335265"
---
# <a name="walkthrough-compile-a-c-program-on-the-command-line"></a>Пошаговое руководство. Компиляция программы на языке C из командной строки

Визуальный C' включает в себя компилятор C, который можно использовать для создания всего, от базовых консольных программ до полных приложений Windows Desktop, мобильных приложений и многое другое.

В этом пошаговом слове показано, как создать основную программу C в стиле «Hello, World» с помощью текстового редактора, а затем скомпилировать ее в командной строке. Если вы предпочитаете работать в СЗ на командной строке, смотрите [«Прогулка: Составление программы коренных сена» на командной линии.](walkthrough-compiling-a-native-cpp-program-on-the-command-line.md) Если вы хотите попробовать Visual Studio IDE вместо того, чтобы использовать командную строку, [Using the Visual Studio IDE for C++ Desktop Development](../ide/using-the-visual-studio-ide-for-cpp-desktop-development.md)см. [Walkthrough: Working with Projects and Solutions (C++)](../ide/walkthrough-working-with-projects-and-solutions-cpp.md)

## <a name="prerequisites"></a>Предварительные требования

Для завершения этого пошагового, вы должны иметь либо Visual Studio и дополнительные компоненты Visual C, или build Tools для визуальной студии.

Visual Studio — это мощная интегрированная среда разработки, которая поддерживает полнофункциональный редактор, менеджеров ресурсов, отладчиков и компиляторов для многих языков и платформ. Для получения информации об этих функциях и о том, как скачать и установить Visual Studio, в том числе бесплатно Visual Studio Community Edition, [см.](/visualstudio/install/install-visual-studio)

В версии Visual Studio Build Tools для Визуальной студии устанавливается только набор инструментов командной строки, компиляторы, инструменты и библиотеки, необходимые для создания программ С и СЗ. Он идеально подходит для создания лабораторий или классных упражнений и устанавливает сявок относительно быстро. Чтобы установить только набор инструментов командной строки, загрузите Build Tools for Visual Studio со [страницы загрузок Visual Studio](https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019) и запустите установщик. В установке Visual Studio выберите рабочую нагрузку **инструментов сборки сау** и **установите.**

Прежде чем построить программу C или C's на командной строке, необходимо убедиться, что инструменты установлены, и что вы можете получить к ним доступ с командной строки. Визуальный КЗ имеет сложные требования к среде командной строки, чтобы найти инструменты, заголовки и библиотеки, которые она использует. **Вы не можете использовать Visual C ' в простом командном быстром окне** без некоторой подготовки. Вам нужно окно *оперативного запроса команды разработчика,* которое является обычным окном оперативного запроса команды, которое имеет все необходимые переменные среды. К счастью, Visual C's устанавливает ярлыки для запуска запросов команд разработчика, которые настроены на среду для сборки командной строки. К сожалению, имена командных запросов разработчика и места их расположения отличаются практически в каждой версии Visual C и в разных версиях Windows. Ваша первая задача пошаговая прогон заключается в том, чтобы найти правильный ярлык для использования.

> [!NOTE]
> Быстрый ярлык команды разработчика автоматически устанавливает правильные пути для компилятора и инструментов, а также для любых необходимых заголовков и библиотек. Некоторые из этих значений различны для каждой конфигурации сборки. Вы должны установить эти значения среды самостоятельно, если вы не используете один из ярлыков. Дополнительные сведения см. в статье [Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md). Поскольку среда сборки является сложной, мы настоятельно рекомендуем вам использовать быстрый ярлык команды разработчика вместо создания собственного.

Эти инструкции варьируются в зависимости от того, какую версию Visual Studio вы используете. Чтобы просмотреть документацию для предпочтительной версии Visual Studio, используйте элемент управления селектора **версии.** Он находится в верхней части таблицы содержимого на этой странице.

::: moniker range="vs-2019"

## <a name="open-a-developer-command-prompt-in-visual-studio-2019"></a>Откройте запрос команды разработчика в Visual Studio 2019

Если вы установили Visual Studio 2019 на Windows 10, откройте меню «Пуск», а затем прокрутите вниз и откройте папку **Visual Studio 2019** (не приложение Visual Studio 2019). Выберите **командный запрос разработчика для VS 2019,** чтобы открыть окно оперативного запроса команды.

Если вы используете другую версию Windows, посмотрите в меню «Пуск» или на странице «Старт» для папки инструментов Visual Studio, содержащей быстрый ярлык команды разработчика. Вы также можете использовать функцию поиска Windows для поиска "запрос команды разработчика" и выбрать тот, который соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно запроса команды.

::: moniker-end

::: moniker range="vs-2017"

## <a name="open-a-developer-command-prompt-in-visual-studio-2017"></a>Откройте запрос команды разработчика в Visual Studio 2017

Если вы установили Visual Studio 2017 на Windows 10, откройте меню «Пуск», а затем прокрутите вниз и откройте папку **Visual Studio 2017** (не приложение Visual Studio 2017). Выберите **командный запрос разработчика для VS 2017,** чтобы открыть окно оперативного запроса команды.

Если вы работаете с другой версией Windows, посмотрите в меню «Пуск» или на странице «Старт» для папки инструментов Visual Studio, содержащей быстрый ярлык команды разработчика. Вы также можете использовать функцию поиска Windows для поиска "запрос команды разработчика" и выбрать тот, который соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно запроса команды.

::: moniker-end

::: moniker range="vs-2015"

## <a name="open-a-developer-command-prompt-in-visual-studio-2015"></a>Откройте запрос команды разработчика в Visual Studio 2015

Если вы установили на Windows 10 инструменты сборки Microsoft Visual C'S Build Tools 2015, откройте меню **«Пуск»,** а затем прокрутите вниз и откройте папку **Visual C' Build Tools.** Выберите **команду Visual C'2015 x86 Native Tools Command Prompt,** чтобы открыть окно оперативного управления.

Если вы работаете с другой версией Windows, посмотрите в меню «Пуск» или на странице «Старт» для папки инструментов Visual Studio, содержащей быстрый ярлык команды разработчика. Вы также можете использовать функцию поиска Windows для поиска "запрос команды разработчика" и выбрать тот, который соответствует установленной версии Visual Studio. Используйте ярлык, чтобы открыть окно запроса команды.

::: moniker-end

Затем убедитесь, что запрос команды разработчика Visual C'' настроен правильно. В окне запроса `cl` команды введите и убедитесь, что выход выглядит примерно так:

```Output
C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise>cl
Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ]
```

В текущем каталоге или номерах версий могут быть различия в зависимости от версии Visual C и любых установленных обновлений. Если вышеуказанный выход аналогичен тому, что вы видите, то вы готовы построить программы C или C's в командной строке.

> [!NOTE]
> Если вы получаете ошибку, такую как "'cl' не признается как внутренняя или внешняя команда, оперативная программа или пакетный файл", ошибка C1034, или ошибка LNK1104 при запуске команды **cl,** то либо вы не используете запрос команды разработчика, либо что-то не так с установкой Visual C . Вы должны исправить эту проблему, прежде чем вы сможете продолжить.

Если вы не можете найти быстрое сокращение команды разработчика, или `cl`если вы получаете сообщение об ошибке при вводе, то ваша установка Visual C'' может возникнуть проблема. Если вы используете Visual Studio 2017 или позже, попробуйте переустановить **разработку рабочего стола с** рабочей нагрузкой на установщик Visual Studio. Для получения подробной информации [см.](vscpp-step-0-installation.md) Или переустановите инструменты сборки со [страницы загрузок Visual Studio.](https://visualstudio.microsoft.com/downloads/) Не перейдите к следующему разделу, пока это не сработает. Для получения дополнительной информации об установке и устранении неполадок Visual Studio, [см.](/visualstudio/install/install-visual-studio)

> [!NOTE]
> В зависимости от версии Windows на компьютере и конфигурации безопасности системы, возможно, вам придется нажать правой кнопкой, чтобы открыть меню быстрого поиска команды разработчика, а затем выбрать **Run в качестве администратора,** чтобы успешно построить и запустить программу, которую вы создаете, следуя этому пошаговому шагу.

## <a name="create-a-c-source-file-and-compile-it-on-the-command-line"></a>Создайте исходный файл C и компилирует его на командной строке

1. В окне запроса `cd c:\` команды разработчика введите, чтобы изменить текущий рабочий каталог на корень вашего C: drive. Затем введите, `md c:\simple` чтобы создать каталог, а затем введите, `cd c:\simple` чтобы изменить этот каталог. В этом каталоге будет содержаться исходный файл и компилированная программа.

1. Введите `notepad simple.c` запрос команды разработчика. В диалоге оповещения Notepad, который всплывает, выберите **Да** для создания нового файла simple.c в рабочем каталоге.

1. В Notepad введите следующие строки кода:

    ```C
    #include <stdio.h>

    int main()
    {
        printf("Hello, World! This is a native C program compiled on the command line.\n");
        return 0;
    }
    ```

1. В панели меню Notepad выберите **File** > **Save,** чтобы сохранить simple.c в рабочем каталоге.

1. Переключиться обратно в окно запроса команды разработчика. Введите `dir` в команде запрос, чтобы перечислить содержимое c: простой каталог. Вы должны увидеть исходный файл simple.c в списке каталогов, который выглядит примерно так:

    ```Output
    C:\simple>dir
     Volume in drive C has no label.
     Volume Serial Number is CC62-6545

     Directory of C:\simple

    10/02/2017  03:46 PM    <DIR>          .
    10/02/2017  03:46 PM    <DIR>          ..
    10/02/2017  03:36 PM               143 simple.c
                   1 File(s)            143 bytes
                   2 Dir(s)  514,900,566,016 bytes free

    ```

   Даты и другие детали будут отличаться на вашем компьютере. Если вы не видите файл исходного кода, simple.c, убедитесь, что вы изменили на c:'простой каталог, который вы создали, и в блокнот, убедитесь, что вы сохранили исходный файл в этом каталоге. Также убедитесь, что вы сохранили исходный код с расширением имени файла .c, а не расширением .txt.

1. Чтобы компилировать программу, введите `cl simple.c` запрос команды разработчика.

   Вы можете увидеть исполняемое имя программы, simple.exe, в строках вывода информации, которую отображает компилятор:

    ```Output
    c:\simple>cl simple.c
    Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
    Copyright (C) Microsoft Corporation.  All rights reserved.

    simple.c
    Microsoft (R) Incremental Linker Version 14.10.25017.0
    Copyright (C) Microsoft Corporation.  All rights reserved.

    /out:simple.exe
    simple.obj
    ```

   > [!NOTE]
   > Если вы получаете ошибку, такую как "'cl' не признается как внутренняя или внешняя команда, оперативная программа или пакетный файл", ошибка C1034 или ошибка LNK1104, ваш запрос команды разработчика настроен неправильно. Для получения информации о том, как устранить эту проблему, вернитесь в раздел **запроса команды Open.**

   > [!NOTE]
   > Если вы получаете другой компилятор или ошибку или предупреждение, просмотрите исходный код, чтобы исправить любые ошибки, а затем сохраните его и запустите компилятор снова. Для получения информации о конкретных ошибках используйте поле поиска в верхней части этой страницы, чтобы найти номер ошибки.

1. Чтобы запустить программу, введите `simple` в команде запрос.

   Программа выводит следующий текст и затем закрывается:

    ```Output
    Hello, World! This is a native C program compiled on the command line.
    ```

   Поздравляем, вы составили и запустить программу C с помощью командной строки.

## <a name="next-steps"></a>Дальнейшие действия

Этот пример "Здравствуйте, мир" примерно так же просто, как программа C может получить. Программы реального мира имеют заголовок файлов и больше исходных файлов, ссылки в библиотеках, и делать полезную работу.

Вы можете использовать шаги в этом пошаговом шаге, чтобы создать свой собственный C-код вместо ввода показанного кода образца. Вы также можете создать много программ c-кода, которые вы найдете в другом месте. Чтобы собрать программу с дополнительными файлами исходного кода, введите их все на командной строке, например:

`cl file1.c file2.c file3.c`

Компилятор выводит программу под названием file1.exe. Чтобы изменить имя на programme1.exe, добавьте опцию [/out](reference/out-output-file-name.md) linker:

`cl file1.c file2.c file3.c /link /out:program1.exe`

И чтобы поймать больше ошибок программирования автоматически, мы рекомендуем вам компилировать с помощью [либо /W3](reference/compiler-option-warning-level.md) или [/W4](reference/compiler-option-warning-level.md) предупреждение уровня вариант:

`cl /W4 file1.c file2.c file3.c /link /out:program1.exe`

Компилятор, cl.exe, имеет гораздо больше возможностей, которые можно применить для создания, оптимизации, отладки и анализа кода. Для получения быстрого `cl /?` списка введите запрос команды разработчика. Вы также можете компилировать и связывать отдельно и применять параметры связующим звена в более сложных сценариях сборки. Для получения более подробной информации о компиляторе и вариантах ссылки и использовании, [см.](reference/c-cpp-building-reference.md)

Вы можете использовать NMAKE и makefiles, или MSBuild и файлы проекта для настройки и создания более сложных проектов на командной строке. Для получения дополнительной информации об использовании этих инструментов, [см. Справка NMAKE](reference/nmake-reference.md) и [MSBuild](msbuild-visual-cpp.md).

Языки С и СЗ схожи, но не одинаковы. Компилятор Microsoft C/C е (MSVC) использует простое правило для определения того, какой язык использовать при компилировании кода. По умолчанию компилятор MSVC обрабатывает все файлы, которые заканчиваются в .c как исходный код C, и все файлы, которые заканчиваются в .cpp как исходный код C. Чтобы заставить компилятор рассматривать все файлы как C, не зависящие от расширения имени файла, используйте опцию компилятора [/Tc.](reference/tc-tp-tc-tp-specify-source-file-type.md)

MSVC совместим со стандартом ISO C99, но не строго соответствует требованиям. В большинстве случаев портативный C-код будет компилироваться и работать, как ожидалось. Визуальный КЗ не поддерживает большинство изменений в ISO C11. Некоторые функции библиотеки и названия функций POSIX унижаются MSVC. Функции поддерживаются, но предпочтительные имена изменились. Для получения дополнительной информации [см. Функции безопасности в CRT](../c-runtime-library/security-features-in-the-crt.md) и [Компилятор Предупреждение (уровень 3) C4996](../error-messages/compiler-warnings/compiler-warning-level-3-c4996.md).

## <a name="see-also"></a>См. также раздел

[Пошаговое руководство. Создание стандартной программы C++ (C++)](../windows/walkthrough-creating-a-standard-cpp-program-cpp.md)<br/>
[C Языковая ссылка](../c-language/c-language-reference.md)<br/>
[Проекты и системы сборки](projects-and-build-systems-cpp.md)<br/>
[Совместимость](../c-runtime-library/compatibility.md)
