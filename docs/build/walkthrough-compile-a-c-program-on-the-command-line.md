---
title: Пошаговое руководство. Компиляция программы на языке C из командной строки
description: Пошаговое руководство по созданию простой программы в стиле Hello World на языке C.
ms.custom: conceptual
ms.date: 9/10/2020
helpviewer_keywords:
- command-line applications [C++], C programs
- Visual C, compiling
- compiling programs [C++]
- C program compiling [C++]
ms.assetid: 7e74cc2d-54b1-49de-b7ad-d3ae6b39ab8d
ms.openlocfilehash: 57276f61ca8ff848db0313935bc1841de50f9874
ms.sourcegitcommit: b492516cc65120250b9ea23f96f7f63f37f99fae
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/14/2020
ms.locfileid: "90075612"
---
# <a name="walkthrough-compile-a-c-program-on-the-command-line"></a>Пошаговое руководство. Компиляция программы на языке C из командной строки

В состав Visual C++ включен компилятор языка C, позволяющий создавать как простые консольные программы, так и классические приложения Windows, мобильные приложения и многое другое.

В этом пошаговом руководстве показано, как создать простейшую программу на языке C в стиле "Hello, World" в текстовом редакторе с последующей компиляцией из командной строки. Если вы предпочитаете работать с C++ в командной строке, см. статью [Пошаговое руководство. Компиляция собственной программы на языке C++ из командной строки](walkthrough-compiling-a-native-cpp-program-on-the-command-line.md). Если вы хотите попробовать интегрированную среду разработки Visual Studio вместо командной строки, см. статью [Пошаговое руководство. Работа с проектами и решениями (C++)](../ide/walkthrough-working-with-projects-and-solutions-cpp.md) или [Использование интегрированной среды разработки Visual Studio для разработки приложений для настольных систем на языке C++](../ide/using-the-visual-studio-ide-for-cpp-desktop-development.md).

## <a name="prerequisites"></a>Предварительные требования

Для выполнения этого пошагового руководства необходимо установить Visual Studio и дополнительные компоненты Visual C++ или Build Tools для Visual Studio.

Visual Studio — это эффективная интегрированная среда разработки, которая поддерживает полнофункциональный редактор, диспетчеры ресурсов, отладчики и компиляторы для многих языков и платформ. Сведения об этих компонентах, а также о скачивании и установке Visual Studio, включая бесплатный выпуск Visual Studio Community, см. в [этой статье](/visualstudio/install/install-visual-studio).

При использовании версии Build Tools для Visual Studio устанавливаются только программы командной строки, библиотеки и компиляторы, необходимые для сборки программ на C и C++. Это идеальный вариант для создания заданий и упражнений, а установка выполняется относительно быстро. Чтобы установить только набор программ командной строки, скачайте Build Tools для Visual Studio на странице [скачивания Visual Studio](https://visualstudio.microsoft.com/downloads/#build-tools-for-visual-studio-2019), а затем запустите установщик. В установщике Visual Studio выберите рабочую нагрузку **Средства сборки C++** и щелкните **Установить**.

Прежде чем можно будет выполнить сборку программы C или C++ в командной строке, необходимо убедиться в том, что эти средства установлены и к ним можно получить доступ из командной строки. Visual C++ имеет сложные требования к среде командной строки для поиска используемых средств, заголовков и библиотек. **Visual C++ нельзя использовать в простом окне командной строки** без предварительной подготовки. Вам понадобится окно *командной строки разработчика*, являющееся обычным окном командной строки, в котором заданы все необходимые переменные среды. К счастью, Visual C++ устанавливает ярлыки для запуска командной строки разработчика, для которой настроена среда для сборок из командной строки. К сожалению, имена ярлыков командной строки разработчика и места их расположения отличаются практически во всех версиях Visual C++ и в различных версиях Windows. Первая задача пошагового руководства — найти нужный ярлык.

> [!NOTE]
> Ярлык командной строки разработчика автоматически задает правильные пути для компилятора и средств, а также для всех необходимых заголовков и библиотек. Некоторые из этих значений различаются для каждой конфигурации сборки. Если вы не используете ни один из ярлыков, эти значения среды необходимо задать самостоятельно. Дополнительные сведения см. в статье [Установка переменных пути и среды при построении из командной строки](setting-the-path-and-environment-variables-for-command-line-builds.md). Так как настраивать среду разработки сложно, настоятельно рекомендуется использовать ярлык командной строки разработчика вместо создания собственного.

Инструкции отличаются в зависимости от используемой версии Visual Studio. Чтобы ознакомиться с документацией по предпочтительной версии Visual Studio, используйте селектор **Версия**. Он находится в верхней части оглавления на этой странице.

::: moniker range="vs-2019"

## <a name="open-a-developer-command-prompt-in-visual-studio-2019"></a>Открытие командной строки разработчика в Visual Studio 2019

Если вы установили Visual Studio 2019 в Windows 10, откройте меню "Пуск", прокрутите содержимое вниз и откройте папку **Visual Studio 2019** (а не приложение Visual Studio 2019). Выберите элемент **Командная строка разработчика для VS 2019**, чтобы открыть окно командной строки.

Если вы используете другую версию Windows, найдите в меню "Пуск" или на начальной странице папку средств Visual Studio, содержащую ярлык командной строки разработчика. Можно также ввести "командная строка разработчика" в строке поиска в Windows и выбрать командную строку, которая соответствует установленной версии Visual Studio. Откройте окно командной строки с помощью ярлыка.

::: moniker-end

::: moniker range="vs-2017"

## <a name="open-a-developer-command-prompt-in-visual-studio-2017"></a>Открытие командной строки разработчика в Visual Studio 2017

Если вы установили Visual Studio 2017 в Windows 10, откройте меню "Пуск", прокрутите содержимое вниз и откройте папку **Visual Studio 2017** (а не приложение Visual Studio 2017). Выберите элемент **Командная строка разработчика для VS 2017**, чтобы открыть окно командной строки.

Если вы используете другую версию Windows, найдите в меню "Пуск" или на начальной странице папку средств Visual Studio, содержащую ярлык командной строки разработчика. Можно также ввести "командная строка разработчика" в строке поиска в Windows и выбрать командную строку, которая соответствует установленной версии Visual Studio. Откройте окно командной строки с помощью ярлыка.

::: moniker-end

::: moniker range="vs-2015"

## <a name="open-a-developer-command-prompt-in-visual-studio-2015"></a>Открытие командной строки разработчика в Visual Studio 2015

Если вы установили Microsoft Visual C++ Build Tools 2015 в Windows 10, откройте меню **Пуск**, прокрутите содержимое вниз и откройте папку **Visual C++ Build Tools**. Выберите элемент **Командная строка Native Tools x86 Visual C++ 2015**, чтобы открыть окно командной строки.

Если вы используете другую версию Windows, найдите в меню "Пуск" или на начальной странице папку средств Visual Studio, содержащую ярлык командной строки разработчика. Можно также ввести "командная строка разработчика" в строке поиска в Windows и выбрать командную строку, которая соответствует установленной версии Visual Studio. Откройте окно командной строки с помощью ярлыка.

::: moniker-end

Затем убедитесь в том, что командная строка разработчика Visual C++ настроена правильно. В окне командной строки введите `cl` и убедитесь в том, что выходные данные выглядят примерно так:

```Output
C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise>cl
Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
Copyright (C) Microsoft Corporation.  All rights reserved.

usage: cl [ option... ] filename... [ /link linkoption... ]
```

В зависимости от установленной версии Visual C++ и обновлений текущий каталог или номера версий могут отличаться. Если приведенный выше результат похож на отображаемый, можно приступать к сборке программ C или C++ в командной строке.

> [!NOTE]
> Если при выполнении команды **cl** появляется сообщение о том, что "cl не распознается как внутренняя или внешняя команда, исполняемая программа или пакетный файл", или возникают ошибки C1034 или LNK1104, дело в том, что вы не используете командную строку разработчика или что-то не так с установкой Visual C++. Для продолжения нужно будет исправить ошибку.

Если вы не можете найти ярлык командной строки разработчика или при вводе `cl` появляется сообщение об ошибке, возможно, возникла проблема с установкой Visual C++. При использовании Visual Studio 2017 или более поздней версии попробуйте переустановить рабочую нагрузку **Разработка классических приложений на C++** с помощью установщика Visual Studio. Подробные сведения см. в статье [Справка по установке средства С++ в Visual Studio](vscpp-step-0-installation.md). Можно также переустановить Build Tools со страницы [Загрузки Visual Studio](https://visualstudio.microsoft.com/downloads/). Не переходите к следующему разделу, пока все не заработает. Дополнительные сведения об установке Visual Studio и устранении неполадок см. в статье [Установка Visual Studio](/visualstudio/install/install-visual-studio).

> [!NOTE]
> В зависимости от версии Windows, установленной на компьютере, и конфигурации системы безопасности может потребоваться правой кнопкой мыши открыть контекстное меню для ярлыка командной строки разработчика и выбрать пункт **Запуск от имени администратора**, чтобы успешно выполнить сборку и запуск программы, созданной в этом пошаговом руководстве.

## <a name="create-a-c-source-file-and-compile-it-on-the-command-line"></a>Создание файла исходного кода на языке C и его компиляция из командной строки

1. В окне командной строки разработчика введите команду `cd c:\`, чтобы изменить текущий рабочий каталог на корень диска C:. Затем введите `md c:\simple`, чтобы создать каталог, и введите `cd c:\simple`, чтобы перейти к этому каталогу. В этом каталоге будут находиться исходный файл и скомпилированная программа.

1. В командной строке разработчика введите команду `notepad simple.c`. В появившемся диалоговом окне блокнота с оповещением выберите **Да**, чтобы создать файл simple.c в рабочем каталоге.

1. В окне блокнота введите следующие строки кода:

    ```C
    #include <stdio.h>

    int main()
    {
        printf("Hello, World! This is a native C program compiled on the command line.\n");
        return 0;
    }
    ```

1. В строке меню блокнота выберите команду **Файл** > **Сохранить**, чтобы сохранить файл simple.c в рабочем каталоге.

1. Вернитесь к окну командной строки разработчика. Введите `dir` в командной строке, чтобы получить список содержимого каталога c:\simple. Вы увидите исходный файл simple.c в списке каталогов, который выглядит примерно так:

    ```Output
    C:\simple>dir
     Volume in drive C has no label.
     Volume Serial Number is CC62-6545

     Directory of C:\simple

    10/02/2017  03:46 PM    <DIR>          .
    10/02/2017  03:46 PM    <DIR>          ..
    10/02/2017  03:36 PM               143 simple.c
                   1 File(s)            143 bytes
                   2 Dir(s)  514,900,566,016 bytes free

    ```

   Даты и некоторые другие данные будут отличаться на вашем компьютере. Если вы не видите файл исходного кода simple.c, убедитесь в том, что вы открыли созданный каталог c:\simple и сохранили файл исходного кода в нем в Блокноте. Кроме того, убедитесь в том, что исходный код был сохранен с расширением имени файла .c, а не .txt.

1. Чтобы скомпилировать программу, в командной строке разработчика введите `cl simple.c`.

   Имя исполняемой программы (simple.exe) отображается в информации, выводимой компилятором.

    ```Output
    c:\simple>cl simple.c
    Microsoft (R) C/C++ Optimizing Compiler Version 19.10.25017 for x86
    Copyright (C) Microsoft Corporation.  All rights reserved.

    simple.c
    Microsoft (R) Incremental Linker Version 14.10.25017.0
    Copyright (C) Microsoft Corporation.  All rights reserved.

    /out:simple.exe
    simple.obj
    ```

   > [!NOTE]
   > Если вы получаете сообщение об ошибке, например "cl не распознается как внутренняя или внешняя команда, исполняемая программа или пакетный файл", ошибке C1034 или LNK1104, командная строка разработчика настроена неправильно. Чтобы получить сведения о том, как устранить эту проблему, вернитесь к разделу **Открыть командную строку разработчика**.

   > [!NOTE]
   > Если вы получаете другое сообщение об ошибке или предупреждение компилятора или компоновщика, проверьте исходный код, исправьте ошибки, сохраните его и снова запустите компилятор. Для получения сведений о конкретных ошибках введите номер ошибки в поле поиска вверху этой страницы.

1. Чтобы запустить программу, в командной строке введите `simple`.

   Программа выводит следующий текст и затем закрывается:

    ```Output
    Hello, World! This is a native C program compiled on the command line.
    ```

   Поздравляем! Вы скомпилировали и запустили программу на C с помощью командной строки.

## <a name="next-steps"></a>Следующие шаги

Этот пример "Hello, World" является самой простой программой C. Реальные программы выполняют полезные действия и имеют файлы заголовков, дополнительные исходные файлы и ссылки на библиотеки.

Вы можете использовать шаги, описанные в этом пошаговом руководстве для C, для создания собственного кода, чтобы не вводить приведенный пример. Вы также можете выполнить сборку различных примеров кода на C, которые можно найти в других местах. Чтобы скомпилировать программу с дополнительными файлами исходного кода, введите их все в командной строке, например:

`cl file1.c file2.c file3.c`

Компилятор выдает программу с именем file1.exe. Чтобы изменить имя на program1.exe, добавьте параметр компоновщика [/out](reference/out-output-file-name.md):

`cl file1.c file2.c file3.c /link /out:program1.exe`

Чтобы автоматически перехватывать другие ошибки программирования, рекомендуется выполнить компиляцию с помощью порога предупреждений [/W3](reference/compiler-option-warning-level.md) или [/W4](reference/compiler-option-warning-level.md):

`cl /W4 file1.c file2.c file3.c /link /out:program1.exe`

Компилятор cl.exe имеет множество других параметров, которые можно применять для создания, оптимизации, отладки и анализа кода. Чтобы просмотреть краткий список, введите `cl /?` в командной строке разработчика. Можно также выполнять компиляцию и компоновку отдельно и применять параметры компоновщика в более сложных сценариях сборки. Дополнительные сведения о параметрах и использовании компилятора и компоновщика см. в [справочнике по сборке для C/C++](reference/c-cpp-building-reference.md).

Для настройки и создания более сложных проектов в командной строке можно использовать NMAKE и файлы makefile либо MSBuild и файлы проекта. Дополнительные сведения об использовании этих средств см. в разделах [Справочник по NMAKE](reference/nmake-reference.md) и [MSBuild](msbuild-visual-cpp.md).

Языки C и C++ похожи, но имеют различия. Компилятор Microsoft C/C++ (MSVC) использует простое правило для определения языка, используемого при компиляции кода. По умолчанию компилятор MSVC рассматривает все файлы с расширением .c как исходные файлы на языке С, а файлы с расширением .cpp как исходные файлы на языке С++. Если указан параметр компилятора [/Tc](reference/tc-tp-tc-tp-specify-source-file-type.md), компилятор будет рассматривать все файлы как исходные файлы на языке С вне зависимости от расширения.

Компилятор MSVC совместим со стандартом ISO C99, но строго соответствует ему. В большинстве случаев переносимый код на языке C будет компилироваться и выполняться должным образом. Visual C++ обеспечивает поддержку изменений в ISO C11/C17. Чтобы выполнить компиляцию с поддержкой C11/C17, используйте флаг компилятора `/std:c11` или `/std:c17`. Некоторые функции библиотеки и имена функций POSIX являются нерекомендуемыми в компиляторе MSVC. Функции поддерживаются, но предпочтительные имена изменились. Дополнительные сведения см. в статьях [Функции безопасности в CRT](../c-runtime-library/security-features-in-the-crt.md) и [Предупреждение компилятора (уровень 3) C4996](../error-messages/compiler-warnings/compiler-warning-level-3-c4996.md).

## <a name="see-also"></a>См. также

[Пошаговое руководство: Создание стандартной программы C++ (C++)](../windows/walkthrough-creating-a-standard-cpp-program-cpp.md)<br/>
[Справочник по языку C](../c-language/c-language-reference.md)<br/>
[Проекты и системы сборки](projects-and-build-systems-cpp.md)<br/>
[Совместимость](../c-runtime-library/compatibility.md)
