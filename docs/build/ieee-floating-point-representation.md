---
title: IEEE-представление с плавающей точкой
ms.date: 05/06/2019
helpviewer_keywords:
- float keyword
- real*8 value
- floating-point numbers, IEEE representation
- double data type, floating-point representation
- IEEE floating point representation
- real*10 value
- long double
- real*4 value
ms.assetid: 537833e8-fe05-49fc-8169-55fd0314b195
ms.openlocfilehash: bb8523256c05479b303dec66ca79caa28e7cda03
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80169816"
---
# <a name="ieee-floating-point-representation"></a>IEEE-представление с плавающей точкой

Microsoft C++ (MSVC) поддерживает стандартные числовые форматы IEEE. В стандарте IEEE-754 описываются форматы с плавающей запятой, которые используются для аппаратного представления действительных чисел. Существует как минимум пять международных числовых форматов с плавающей запятой, которые могут быть представлены в оборудовании, предназначенном для компилятора MSVC, однако компилятор использует только два из них. В MSVC используются форматы с *одиночной* (4 байта) и *двойной* (8 байтов) точностью. Формат одиночной точности объявляется с помощью ключевого слова **float**. Формат двойной точности объявляется с помощью ключевого слова **double**. В стандарте IEEE определяются еще форматы *половинной* (2 байта) и *четырехкратной* (16 байтов) точности, а также формат *расширенной двойной* (10 байтов) точности, который реализуется компиляторами C и C++ как тип данных **long double**. В компиляторе MSVC тип данных **long double** рассматривается как отдельный тип, однако в качестве типа хранения с ним сопоставляется тип **double**. Тем не менее вычисления с использованием других форматов, в том числе расширенной двойной точности (10 байтов), могут поддерживаться некоторым оборудованием на собственном уровне или на уровне языка ассемблера.

Значения хранятся в следующем виде:

|Значение|Хранение|
|-----------|---------------|
|одиночная точность|разряд знака, 8 разрядов показателя степени, 23 разряда значащей части|
|двойная точность|разряд знака, 11 разрядов показателя степени, 52 разряда значащей части|
|расширенная двойная точность|разряд знака, 15 разрядов показателя степени, 64 разряда значащей части|

В форматах с одиночной и двойной точностью дробная часть, которая называется *значащей частью* (или *мантиссой*), начинается с 1, которая не сохраняется в памяти. Таким образом, значащая часть фактически содержит 24 или 53 разряда, хотя в памяти хранится соответственно 23 или 52 разряда. В формате расширенной двойной точности этот разряд сохраняется в памяти.

Величина показателя степени смещена наполовину относительно возможного значения. Это значит, что для получения фактического показателя степени необходимо вычесть это смещение из хранящегося в памяти значения. Если хранящийся в памяти показатель степени меньше смещения, значит фактический показатель будет отрицательным.

Смещение показателя степени определяется следующим образом:

|Показатель степени|Величина смещения|
|--------------|---------------|
|8 разрядов (одиночная точность)|127|
|11 разрядов (двойная точность)|1023|
|15 разрядов (расширенная двойная точность)|16383|

Эти показатели определяют степени двух, а не десяти. Таким образом, для 8-разрядного формата фактические показатели степени в диапазоне от –127 до 127 хранятся в памяти соответственно в виде значений в диапазоне от 0 до 254. Значение 2<sup>127</sup> примерно равно 10<sup>38</sup> и определяет фактический предел для чисел с одиночной точностью.

Значащая часть хранится в виде двоичной части в форме 1.XXX... Эта часть имеет значение больше 1 и меньше 2. Обратите внимание, что действительные числа всегда хранятся в *нормализованной форме*. Это значит, что значащая часть смещена влево таким образом, что ее старший разряд всегда равен 1. Поскольку этот разряд всегда равен 1, для форматов одиночной и двойной точности его значение принимается по умолчанию и не хранится в памяти. Двоичная (не десятичная) точка располагается непосредственно справа от начальной 1.

Ниже показаны форматы, соответствующие различным размерам:

|Формат|байт 1|байт 2|байт 3|байт 4|...|байт n|
|------------|------------|------------|------------|------------|---------|------------|
|одиночная точность| `SXXXXXXX`|`XMMMMMMM`|`MMMMMMMM`|`MMMMMMMM`|||
|двойная точность|`SXXXXXXX`|`XXXXMMMM`|`MMMMMMMM`|`MMMMMMMM`|...|`MMMMMMMM`|
|расширенная двойная точность|`SXXXXXXX`|`XXXXXXXX`|`1MMMMMMM`|`MMMMMMMM`|...|`MMMMMMMM`|

`S` представляет разряд знака, `X` — это разряды смещенного показателя степени, а `M` — это значащие разряды. Обратите внимание, что для форматов одиночной и двойной точности значение самого левого разряда принимается по умолчанию (и не сохраняется в памяти), однако в формате расширенной двойной точности его значение представлено в виде 1 в байте 3.

Чтобы правильно определить смещение двоичной точки, необходимо сначала выделить показатель степени, а затем сместить двоичную точку вправо или влево на соответствующее количество разрядов.

## <a name="special-values"></a>Специальные значения

Форматы с плавающей запятой предусматривают некоторые значения, которые обрабатываются особым образом.

### <a name="zero"></a>Нуль

Нуль не может быть представлен в нормализованной форме, используемой для форматов одиночной и двойной точности. Таким образом, для определения значения 0 используется специальный шаблон, состоящий из нулей. При необходимости с помощью разряда знака можно представить значение –0, однако оно всегда будет сопоставляться как равное 0.

### <a name="infinities"></a>Бесконечность

Значения +∞ и −∞ представляются в виде показателя степени из единиц и значащей части из нолей. С помощью разряда знака можно определить знак бесконечности.

### <a name="subnormals"></a>Субнормальные числа

Можно представить числа, которые находятся ближе к нулю, чем наименьшее представимое нормализованное число. Такие числа называются *субнормальными* или *денормализованными*. Если показатель степени представлен одними нулевыми значениями, а значащая часть отлична от нуля, старший бит значащей части принимается равным нулю, а не единице. Точность субнормальных чисел снижается по мере увеличения количества начальных нулей в значащей части.

### <a name="nan---not-a-number"></a>NaN (не число)

В формате IEEE с плавающей запятой могут быть представлены значения, не являющиеся действительными числами, например 0 / 0. Значения такого вида называются *NaN* (не число). Значение NaN представляется состоящим из единиц показателем степени и отличной от нуля значащей частью. Существует два вида значений NaN: *несигнальные* (QNaN) и *сигнальные* (SNaN). Для несигнальных значений NaN старший разряд значащей части равен единице, и они обычно распространяются посредством выражений. Они представляют неопределенные значения, например результат деления на бесконечность или умножения бесконечности на нуль. Для сигнальных значений NaN старший разряд значащей части равен нулю. Они используются для недопустимых операций, указывая на аппаратное исключение, связанное с обработкой чисел с плавающей запятой.

## <a name="examples"></a>Примеры

Ниже приводятся примеры чисел в формате одиночной точности:

- Для значения 2 разряд знака содержит нуль, хранимое в памяти значение показателя экспоненты равно 128 (или 1000 0000 в двоичном формате), то есть 127 плюс 1. Хранимая в памяти двоичная значащая часть равна (1.) 000 0000 0000 0000 0000 0000: здесь по умолчанию принимаются начальная 1 и двоичная точка, то есть фактически значащая часть равна единице.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |2|1 * 2<sup>1</sup>|0100 0000 0000 0000 0000 0000 0000 0000|0x40000000|

- Значение –2. То же, что и + 2, однако в этом случае задан разряд знака. Таким образом задаются отрицательные числа во всех форматах IEEE с плавающей запятой.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |-2|–1 * 2<sup>1</sup>|1100 0000 0000 0000 0000 0000 0000 0000|0xC0000000|

- Значение 4. Та же значащая часть, показатель степени увеличивается на единицу (смещенное значение 129 или 100 0000 1 в двоичном формате).

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |4|1 * 2<sup>2</sup>|0100 0000 1000 0000 0000 0000 0000 0000|0x40800000|

- Значение 6. Тот же показатель степени; значащая часть увеличивается наполовину, то есть (1.) 100 0000 ... 0000 0000: поскольку это двоичная часть, равно 1 1/2, так как значения дробных разрядов равны 1/2, 1/4, 1/8 и т. д.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |6|1.5 * 2<sup>2</sup>|0100 0000 1100 0000 0000 0000 0000 0000|0x40C00000|

- Значение 1. Та же значащая часть, что и для остальных степеней двух; смещенный показатель степени на единицу меньше, чем у двух при 127, то есть 011 1111 1 в двоичном формате.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |1|1 * 2<sup>0</sup>|0011 1111 1000 0000 0000 0000 0000 0000|0x3F800000|

- Значение 0,75. Смещенный показатель степени 126, 011 1111 0 в двоичном формате и значащая часть (1.) 100 0000 ... 0000 0000, то есть 1 1/2.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |0.75|1.5 * 2<sup>-1</sup>|0011 1111 0100 0000 0000 0000 0000 0000|0x3F400000|

- Значение 2,5. Так же, как и два, однако в значащей части задан разряд, который представляет 1/4.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |2.5|1.25 * 2<sup>1</sup>|0100 0000 0010 0000 0000 0000 0000 0000|0x40200000|

- 1/10 — это повторяющаяся часть в двоичном формате. Значащая часть немногим меньше 1.6, а смещенный показатель степени указывает, что 1.6 необходимо разделить на 16 (011 1101 1 в двоичном формате, то есть 123 в десятичном формате). Фактический показатель степени 123 – 127 = –4. Это значит, что выполняется умножение на 2<sup>–4</sup> = 1/16. Обратите внимание, что хранимая в памяти значащая часть округляется до последнего разряда, чтобы представить выходящие за пределы числа с максимально возможной точностью. (Причина заключается в том, что величины 1/10 и 1/100 нельзя точно представить в двоичном формате, так же как 1/3 — в десятичном.)

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |0.1|1.6 * 2<sup>-4</sup>|0011 1101 1100 1100 1100 1100 1100 1101|0x3DCCCCCD|

- Нуль является особым случаем, в котором используется формула минимального положительного числа, которое может быть представлено, содержащего одни нули.

   |Значение|Формула|Двоичное представление|Шестнадцатеричный|
   |-|-|-|-|
   |0|1 * 2<sup>-128</sup>|0000 0000 0000 0000 0000 0000 0000 0000|0x00000000|

## <a name="see-also"></a>См. также

[Почему может уменьшиться точность чисел с плавающей запятой](why-floating-point-numbers-may-lose-precision.md)
