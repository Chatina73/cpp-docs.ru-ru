---
description: 'Подробнее о следующем: Использование библиотек и компонентов'
title: Использование библиотек и компонентов в проектах C++
ms.date: 12/18/2020
f1_keywords:
- VC.Project.References
helpviewer_keywords:
- Add References Dialog Box (C++)
- .NET Framework (C++), Add References Dialog Box
ms.assetid: 12b8f571-0f21-40b3-9404-5318a57e9cb5
ms.openlocfilehash: c8e7cb41fad6a974ac677228d884a31e4fa92ce1
ms.sourcegitcommit: 2b2c3fa9244e31db35ea33554dea0efcab490f3c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/18/2020
ms.locfileid: "97682457"
---
# <a name="consuming-libraries-and-components"></a>Использование библиотек и компонентов

В проектах C++ часто требуется вызывать функции или обращаться к данным в двоичных файлах, таких как статические библиотеки (LIB-файлы), библиотеки DLL, компоненты среды выполнения Windows, компоненты COM или сборки .NET. В этих случаях необходимо настроить проект таким образом, чтобы он мог находить нужные двоичные файлы во время сборки. Конкретный способ сделать это зависит от типа вашего проекта, типа двоичного файла, а также от того, был ли этот двоичный файл собран в том же решении, что и ваш проект.

## <a name="consuming-libraries-downloaded-via-vcpkg"></a>Использование скачанных библиотек с помощью vcpkg

Если вы хотите использовать скачанную библиотеку с помощью диспетчера пакетов **vcpkg**, то приведенные ниже инструкции можно пропустить. См. раздел [vcpkg: диспетчер пакетов C++ для Windows, Linux и macOS](vcpkg.md) для получения дополнительных сведений.

## <a name="consuming-static-libraries"></a>Использование статических библиотек

Если проект статической библиотеки был создан в том же решении:

1. #<a name="include-the-header-files-for-the-static-library-using-quotation-marks-in-a-typical-solution-the-path-starts-with-library-project-name-intellisense-will-help-you-find-it"></a>включите файл или файлы заголовка в статическую библиотеку с использованием кавычек. В типовом решении путь начинается с `../<library project name>`. При поиске вы можете использовать предложения технологии IntelliSense.
2. Добавьте ссылку на проект статической библиотеки. Щелкните правой кнопкой мыши элемент **Ссылки** в узле проекта приложения в **обозревателе решений** и выберите **Добавить ссылку**.

Если статическая библиотека не входит в состав решения:

1. Щелкните правой кнопкой мыши узел проекта приложения в **обозревателе решений** и выберите **Свойства**.
2. На странице свойств **Каталоги VC++** добавьте в раздел **Пути библиотек** путь к каталогу, который содержит LIB-файл. Затем добавьте в раздел **Включаемые каталоги** путь к файлам заголовков библиотеки.  
3. На странице свойств **Компоновщик > Ввод** добавьте имя LIB-файла в раздел **Дополнительные зависимости**.

## <a name="dynamic-link-libraries"></a>Библиотеки динамической компоновки

Если библиотека DLL была собрана в рамках того же решения, что и приложение, выполните те же действия, что и для статической библиотеки.

Если библиотека DLL не входит в состав решения приложения, вам потребуются DLL-файл, заголовки с прототипами для экспортируемых функций и классов, а также LIB-файл, содержащий необходимую для компоновки информацию.

1. Скопируйте DLL-файл в папку выходных данных проекта или другую папку, которая задана в качестве стандартной для поиска библиотек DLL в Windows. См. раздел [Порядок поиска библиотеки динамической компоновки](/windows/win32/dlls/dynamic-link-library-search-order).
2. Выполните шаги с 1 по 3 для статических библиотек, чтобы задать пути к заголовкам и LIB-файлу.

## <a name="com-objects"></a>COM-объекты

Если в собственном приложении C++ требуется использовать COM-объект и этот объект *зарегистрирован*, вам достаточно вызвать функцию CoCreateInstance и передать в нее CLSID объекта. Система выполнит поиск объекта в реестре Windows и загрузит его. В проекте C++/CLI COM-объект можно использовать таким же образом. Кроме того, вы можете добавить ссылку на COM-объект в список **Добавление ссылок > COM** и использовать его посредством [вызываемой оболочки времени выполнения](/dotnet/framework/interop/runtime-callable-wrapper).

## <a name="net-assemblies-and-windows-runtime-components"></a>Сборки .NET с компонентами среды выполнения Windows

В проектах универсальной платформы Windows (UWP) или C++/CLI для использования сборок .NET или компонентов среды выполнения Windows можно добавить *ссылку* на сборку или компонент. В узле **Ссылки** проекта универсальной платформы Windows (UWP) или C++/CLI представлены ссылки на часто используемые компоненты. Щелкните правой кнопкой мыши узел **Ссылки** в **Обозревателе решений**, чтобы открыть **диспетчер ссылок** и просмотреть доступные в системе компоненты. Нажмите кнопку **Обзор**, чтобы перейти к папке, в которой находится нужный вам пользовательский компонент. Поскольку сборки .NET и компоненты среды выполнения Windows содержат встроенные сведения о типах, для просмотра их методов и классов можно щелкнуть правой кнопкой мыши и выбрать команду **Просмотреть в обозревателе объектов**.

## <a name="reference-properties"></a>Свойства ссылки

Каждый тип ссылки имеет свойства. Свойства можно просмотреть, выбрав ссылку в обозревателе решений и нажав клавиши **Alt + ВВОД**. Также можно щелкнуть ссылку правой кнопкой мыши и выбрать пункт **Свойства**. Одни свойства доступны только для чтения, другие можно изменять. Тем не менее обычно эти свойства не требуется изменять вручную.

### <a name="activex-reference-properties"></a>Свойства ссылки ActiveX

Свойства ссылки ActiveX доступны только для компонентов COM. Данные свойства отображаются только тогда, когда в панели **Ссылки** выбран компонент COM. Эти свойства нельзя изменить.

- **Управление полным путем**

   Отображает путь к каталогу элемента управления, на который указывает ссылка.

- **GUID элемента управления**

   Отображает GUID для элемента управления ActiveX.

- **Версия элемента управления**

   Отображает версию элемента управления ActiveX, на который указывает ссылка.

- **Имя библиотеки типов**

   Отображает имя библиотеки типов, на которую указывает ссылка.

- **Средство программы-оболочки**

   Отображает средство, которое используется для создания сборки взаимодействия из указанной библиотеки COM или элемента управления ActiveX.

### <a name="assembly-reference-properties-ccli"></a>Свойства ссылки на сборку (C++/CLI)

Свойства ссылки на сборку доступны только для ссылок на сборки .NET Framework в проектах C++/CLI. Данные свойства отображаются только тогда, когда в панели **Ссылки** выбрана сборка .NET Framework. Эти свойства нельзя изменить.

- **Относительный путь**

   Отображает относительный путь от каталога проекта к сборке, на которую указывает ссылка.

### <a name="build-properties"></a>Свойства сборки

Следующие свойства доступны для различных типов ссылок. Они позволяют задавать способ построения со ссылками.

- **Копировать локальные**

   Указывает, следует ли автоматически копировать сборку, на которую указывает ссылка, в целевое расположение во время сборки.

- **Копировать локальные вспомогательные сборки (C++/CLI)**

   Указывает, следует ли автоматически копировать вспомогательные сборки ссылочной сборки в целевое расположение во время сборки. Используется, только если для параметра **Копировать локальные** задано значение **`true`** .

- **Выходные данные ссылочной сборки**

   Указывает, что эта сборка используется в процессе сборки. **`true`** означает, что эта сборка используется в командной строке компилятора во время выполнения сборки.

### <a name="project-to-project-reference-properties"></a>Свойства ссылок проектов на проекты

Следующие свойства определяют *ссылку проекта на проект* из проекта, выбранного в панели **Ссылки**, на другой проект в том же решении. Дополнительные сведения см. в статье [Управление ссылками в проекте](/visualstudio/ide/managing-references-in-a-project).

- **Компоновать зависимости библиотек**

   Если это свойство имеет значение **True**, система проектов установит в зависимом проекте связь с LIB-файлами, создаваемыми независимым проектом. Обычно устанавливается значение **True**.

- **Идентификатор проекта**

   Уникальный идентификатор независимого проекта. Значение свойства — это GUID внутренней системы, который невозможно изменить.

- **Использовать входные данные зависимостей библиотек**

   Если это свойство имеет значение **False**, система проектов не установит в зависимом проекте связь с OBJ-файлами для библиотеки, созданной независимым проектом. Таким образом, это значение отключает инкрементную компоновку. Обычно указывается значение **False**, так как при наличии множества независимых проектов сборка приложения может занять длительное время.

### <a name="read-only-reference-properties-com--net"></a>Свойства ссылки только для чтения (COM и .NET)

Следующие свойства существуют в ссылках на компоненты COM и сборки .NET, и их нельзя изменить.

- **Имя сборки**

   Отображает имя сборки для сборки, на которую указывает ссылка.

- **Язык и региональные параметры**

   Отображает язык и региональные параметры выбранной ссылки.

- **Описание**

   Отображает описание выбранной ссылки.

- **Полный путь**

   Отображает путь к каталогу сборки, на которую указывает ссылка.

- **Удостоверение**

   Для сборок .NET Framework отображает полный путь. Для компонентов COM отображает GUID.

- **Label**

   Отображает метку ссылки.

- **Name**

   Отображает имя ссылки.

- **Токен открытого ключа**

   Отображает токен открытого ключа для идентификации сборки, на которую указывает ссылка.

- **Строгое имя**

   **`true`** , если сборка, на которую указывает ссылка, имеет строгое имя. Сборка со строгим именем имеет уникальную версию.

- **Version**

   Отображает версию сборки, на которую указывает ссылка.

## <a name="see-also"></a>См. также

[Справочник по страницам свойств проекта C++](reference/property-pages-visual-cpp.md)<br>
[Настройка компилятора C++ и свойства сборки в Visual Studio](working-with-project-properties.md)
