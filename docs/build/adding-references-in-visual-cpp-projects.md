---
title: Использование библиотек и компонентов в C++ проектах
ms.date: 12/10/2018
f1_keywords:
- VC.Project.References
helpviewer_keywords:
- Add References Dialog Box (C++)
- .NET Framework (C++), Add References Dialog Box
ms.assetid: 12b8f571-0f21-40b3-9404-5318a57e9cb5
ms.openlocfilehash: a8cd13e27859d09bcaaca1f5f6f1c2750b908fe6
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078784"
---
# <a name="consuming-libraries-and-components"></a>Использование библиотек и компонентов

Часто C++ проект должен вызывать функции или обращаться к данным в двоичном файле, например в статической библиотеке (lib-файлах), DLL, среда выполнения Windows компоненте, COM-компоненте или сборке .NET. В таких случаях необходимо настроить проект таким образом, чтобы он мог найти этот двоичный файл во время сборки. Конкретные действия зависят от типа проекта, типа двоичного файла и того, создается ли двоичный файл в том же решении, что и проект.

## <a name="consuming-libraries-downloaded-via-vcpkg"></a>Использование библиотек, скачанных через vcpkg

Чтобы использовать библиотеку, скачанную с помощью диспетчера пакетов **vcpkg** , можно проигнорировать приведенные ниже инструкции. Дополнительные сведения см. [в C++ разделе vcpkg: Диспетчер пакетов для Windows, Linux и MacOS](vcpkg.md#integrate-with-visual-studio-windows) .

## <a name="consuming-static-libraries"></a>Использование статических библиотек

Если проект статической библиотеки строится в том же решении:

1. #<a name="include-the-header-files-for-the-static-library-using-quotation-marks-in-a-typical-solution-the-path-will-start-with-library-project-name-intellisense-will-help-you-find-it"></a>Включите файлы заголовков для статической библиотеки в кавычки. В типичном решении путь начинается с `../<library project name>`. IntelliSense поможет вам найти ее.
2. Добавьте ссылку на проект статической библиотеки. Щелкните правой кнопкой мыши **ссылки** в узле проект приложения в **Обозреватель решений** и выберите команду **Добавить ссылку**.

Если статическая библиотека не является частью решения:

1. Щелкните правой кнопкой мыши узел проекта приложения в **Обозреватель решений** а затем выберите пункт **свойства**.
2. На странице свойств **каталоги VC + +** добавьте путь к каталогу, в котором находится LIB-файл, в папке **пути к библиотеке** и добавьте путь к файлам заголовков библиотеки в **каталогах include**.  
3. На странице свойств **компоновщик > входные данные** добавьте имя LIB-файла в **Дополнительные зависимости**.

## <a name="dynamic-link-libraries"></a>Библиотеки динамической компоновки

Если библиотека DLL строится как часть того же решения, что и приложение, выполните те же действия, что и для статической библиотеки.

Если библиотека DLL не является частью решения приложения, требуется файл DLL, заголовки с прототипами для экспортированных функций и классов, а также LIB-файл, предоставляющий необходимые сведения о компоновке.

1. Скопируйте библиотеку DLL в выходную папку проекта или в другую папку в стандартном пути поиска Windows для DLL. См. раздел [Порядок поиска библиотек динамической компоновки](/windows/win32/dlls/dynamic-link-library-search-order).
2. Выполните шаги 1-3 для статических библиотек, чтобы указать пути к заголовкам и LIB файла.

## <a name="com-objects"></a>COM-объекты

Если в собственном C++ приложении требуется использовать COM-объект и этот объект *зарегистрирован*, то все, что нужно сделать, — это вызвать CoCreateInstance и передать идентификатор CLSID объекта. Система обнаружит ее в реестре Windows и загрузит ее. Проект C++/CLI может использовать COM-объект таким же образом или путем добавления ссылки на него из списка **Добавление ссылок > com** и его использования через [вызываемую оболочку времени выполнения](/dotnet/framework/interop/runtime-callable-wrapper).

## <a name="net-assemblies-and-windows-runtime-components"></a>Сборки .NET и компоненты среда выполнения Windows

В проектах UWP C++или/CLI используются сборки .net или среда выполнения Windows компоненты путем добавления *ссылки* на сборку или компонент. В узле **ссылки** в проекте UWP или C++/CLI отображаются ссылки на часто используемые компоненты. Щелкните правой кнопкой мыши узел **References** в **Обозреватель решений** , чтобы открыть **Диспетчер ссылок** и просмотреть дополнительные компоненты, известные системе. Нажмите кнопку **Обзор** , чтобы перейти к любой папке, в которой находится пользовательский компонент. Поскольку сборки .NET и компоненты среда выполнения Windows содержат встроенные сведения о типах, их методы и классы можно просмотреть, щелкнув правой кнопкой мыши и выбрав пункт **Просмотр в обозревателе объектов**.

## <a name="reference-properties"></a>Свойства ссылки

Каждый тип ссылки имеет свойства. Свойства можно просмотреть, выбрав ссылку в обозревателе решений и нажав клавиши **Alt + ВВОД**. Также можно щелкнуть ссылку правой кнопкой мыши и выбрать пункт **Свойства**. Некоторые свойства доступны только для чтения, а другие можно изменять. Тем не менее обычно эти свойства не требуется изменять вручную.

### <a name="activex-reference-properties"></a>Свойства ссылки ActiveX

Свойства ссылки ActiveX доступны только для компонентов COM. Эти свойства отображаются, только когда выбран компонент COM на панели **Ссылки** . Свойства невозможно изменить.

- **Управление полным путем**

   Отображает путь к каталогу элемента управления, на который указывает ссылка.

- **GUID элемента управления**

   Отображает GUID для элемента управления ActiveX.

- **Версия элемента управления**

   Отображает версию элемента управления ActiveX, на который указывает ссылка.

- **Имя библиотеки типов**

   Отображает имя библиотеки типов, на которую указывает ссылка.

- **Средство программы-оболочки**

   Отображает средство, которое используется для создания промежуточной сборки из библиотеки COM, на которую указывает ссылка, или элемента управления ActiveX.

### <a name="assembly-reference-properties-ccli"></a>Свойства ссылки на сборкуC++(/CLI)

Свойства ссылки на сборку доступны только для ссылок на .NET Framework сборки в C++проектах/CLI. Эти свойства отображаются, только если на панели " **ссылки** " выбрана .NET Framework сборка. Свойства невозможно изменить.

- **Относительный путь**

   Отображает относительный путь от каталога проекта к сборке, на которую указывает ссылка.

### <a name="build-properties"></a>Свойства сборки

Следующие свойства доступны для различных типов ссылок. Они позволяют задавать способ построения со ссылками.

- **Копировать локальные**

   Указывает, следует ли автоматически копировать сборку, на которую указывает ссылка, в целевое расположение во время сборки.

- **Копировать локальные вспомогательные сборки (C++/CLI)**

   Указывает, следует ли автоматически копировать вспомогательные сборки ссылочной сборки в целевое расположение во время сборки. Используется, только если для параметра **Копировать локальные** задано значение **true**.

- **Выходные данные ссылочной сборки**

   Указывает, что эта сборка используется в процессе сборки. Если **true**, сборка используется в командной строке компилятора в процессе сборки.

### <a name="project-to-project-reference-properties"></a>Свойства ссылок проектов на проекты

Следующие свойства определяют *ссылку проекта на проект* из проекта, выбранного на панели **ссылки** , в другой проект в том же решении. Дополнительные сведения см. в статье [Управление ссылками в проекте](/visualstudio/ide/managing-references-in-a-project).

- **Компоновать зависимости библиотек**

   Если свойство имеет значение **True**, система проектов установит в зависимом проекте связь с LIB-файлами, создаваемыми независимым проектом. Обычно устанавливается **True**.

- **Идентификатор проекта**

   Уникальный идентификатор независимого проекта. Значение свойства — это GUID внутренней системы, который невозможно изменить.

- **Использовать входные данные зависимостей библиотек**

   Если свойство имеет значение **False**, система проектов не установит в зависимом проекте связь с LIB-файлами для библиотеки, созданной независимым проектом. В результате это значение отключает инкрементную компоновку. Обычно указывается **False** , так как сборка приложения может занять длительное время, если существует много независимых проектов.

### <a name="read-only-reference-properties-com--net"></a>Свойства ссылки только для чтения (COM & .NET)

Следующие свойства доступны для ссылок на COM-компоненты и сборки .NET, и их нельзя изменить.

- **Имя сборки**

   Отображает имя сборки для сборки, на которую указывает ссылка.

- **Язык и региональные параметры**

   Отображает язык и региональные параметры выбранной ссылки.

- **Описание**

   Отображает описание выбранной ссылки.

- **Полный путь**

   Отображает путь к каталогу сборки, на которую указывает ссылка.

- **Удостоверение**

   Для сборок .NET Framework отображает полный путь. Для компонентов COM отображает GUID.

- **Метка**

   Отображает метку ссылки.

- **Название**

   Отображает имя ссылки.

- **Токен открытого ключа**

   Отображает токен открытого ключа, который используется для идентификации сборки, на которую указывает ссылка.

- **Строгое имя**

   `true` , если сборка, на которую указывает ссылка, имеет строгое имя. Сборка строгого имени имеет уникальную версию.

- **Версия**

   Отображает версию сборки, на которую указывает ссылка.

## <a name="see-also"></a>См. также:

[C++Справочник по страницам свойств проекта](reference/property-pages-visual-cpp.md)<br>
[Настройка компилятора C++ и свойства сборки в Visual Studio](working-with-project-properties.md)