---
title: Использование библиотек и компонентов в проектах C++
ms.date: 12/10/2018
f1_keywords:
- VC.Project.References
helpviewer_keywords:
- Add References Dialog Box (C++)
- .NET Framework (C++), Add References Dialog Box
ms.assetid: 12b8f571-0f21-40b3-9404-5318a57e9cb5
ms.openlocfilehash: dff057977e6b6ff0c36d3a888bc4d5c3aa778576
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2019
ms.locfileid: "59038771"
---
# <a name="consuming-libraries-and-components"></a>Использование библиотек и компонентов

Часто, проект C++ необходимо вызывать функции или получить доступ к данным в двоичном файле, такие как статическая библиотека (LIB-файлы), библиотеки DLL, компонент среды выполнения Windows, COM-компонент или сборки .NET. В этих случаях необходимо настроить проект, чтобы он мог найти этот двоичный файл во время сборки. Конкретные действия зависят от типа проекта, типа двоичного файла, и ли двоичный файл создается в том же решении, что и проект. 

## <a name="consuming-libraries-downloaded-via-vcpkg"></a>Использование библиотек загружен с помощью vcpkg

Чтобы использовать библиотеку, загруженный с помощью **vcpkg** диспетчера пакетов, можно пропустить приведенные ниже инструкции. См. раздел [vcpkg: Диспетчер пакетов C++ для Windows, Linux и MacOS](vcpkg.md#integrate-with-visual-studio-windows) Дополнительные сведения.

## <a name="consuming-static-libraries"></a>Использование статических библиотек

Если в одном решении строится проект статической библиотеки:

1. #<a name="include-the-header-files-for-the-static-library-using-quotation-marks-in-a-typical-solution-the-path-will-start-with-library-project-name-intellisense-will-help-you-find-it"></a>включать файлы заголовка для статической библиотеки, использования кавычек. В стандартном решении путь начинается с `../<library project name>`. Технология IntelliSense поможет вам найти его.
2. Добавьте ссылку на проект статической библиотеки. Щелкните правой кнопкой мыши **ссылки** в узле проекта приложения в **обозревателе решений** и выберите **добавить ссылку**. 

Если статическая библиотека не является частью решения:

1. Щелкните правой кнопкой мыши узел проекта приложения в **обозревателе решений** и выберите **свойства**. 
2. В **каталоги VC ++** свойства страницы, добавьте путь к каталогу, где LIB-файл находится в **путей к библиотеке** и добавьте путь для файлов заголовка библиотеки в **каталоги включаемых файлов** .  
3. В **компоновщика > ввода** свойства страницы, добавьте имя LIB-файл для **Дополнительные зависимости**.

## <a name="dynamic-link-libraries"></a>Библиотеки DLL

Если библиотека DLL собирается в рамках того же решения, что и приложение, выполните те же действия, что и для статической библиотеки.

Если библиотека DLL не является частью решения приложения, необходимо в файл DLL, заголовков с прототипами для экспортированных функций и классов и LIB-файл, который предоставляет информацию о необходимости связи.

1. Скопируйте библиотеку DLL для библиотек DLL в выходную папку проекта или в другую папку, в стандартный путь поиска Windows. См. в разделе [порядок поиска библиотеки динамической компоновки](/windows/desktop/dlls/dynamic-link-library-search-order).
2. Выполните шаги 1 – 3 для статических библиотек для предоставления путей для заголовков и LIB-файл.

## <a name="com-objects"></a>COM-объекты

Если собственное приложение C++ нужно использовать COM-объекта, и этот объект будет *зарегистрирован*, то все, что необходимо сделать это вызове CoCreateInstance и передать идентификатор CLSID объекта. Система будет найти в реестре Windows и загрузить ее. C + +/ CLI проекта могут использовать COM-объектом, таким же образом или путем добавления ссылки на него из **Add References > COM** списка и использовании ее через его [вызываемой оболочки времени выполнения](/dotnet/framework/interop/runtime-callable-wrapper). 

## <a name="net-assemblies-and-windows-runtime-components"></a>Сборки .NET и компоненты среды выполнения Windows

В UWP или C + +/ CLI проекты, использовать сборки .NET или компонентов среды выполнения Windows, добавив *ссылку* к сборке или компоненте. В разделе **ссылки** узел в UWP или C + +/ CLI проекта, вы увидите ссылки на часто используемые компоненты. Щелкните правой кнопкой мыши **ссылки** узел в **обозревателе решений** откроется **диспетчер ссылок** и просматривать дополнительные компоненты, которые известны в системе. Нажмите кнопку **Обзор** кнопки для перехода к любой папке, где находится пользовательский компонент. Сборки .NET и компоненты среды выполнения Windows содержат сведения о встроенных типах, вы можете просматривать свои методы и классы, щелкнув правой кнопкой мыши и выбрав **просмотреть в обозревателе объектов**. 

## <a name="reference-properties"></a>Свойства ссылки

Каждый тип ссылки имеет свойства. Свойства можно просмотреть, выбрав ссылку в обозревателе решений и нажав клавиши **Alt + ВВОД**. Также можно щелкнуть ссылку правой кнопкой мыши и выбрать пункт **Свойства**. Некоторые свойства доступны только для чтения, а другие можно изменять. Тем не менее обычно эти свойства не требуется изменять вручную.

### <a name="activex-reference-properties"></a>Свойства ссылки ActiveX

Свойства ссылки ActiveX доступны только для компонентов COM. Эти свойства отображаются, только когда выбран компонент COM на панели **Ссылки** . Свойства невозможно изменить.

- **Управление полным путем**

   Отображает путь к каталогу элемента управления, на который указывает ссылка.

- **GUID элемента управления**

   Отображает GUID для элемента управления ActiveX.

- **Версия элемента управления**

   Отображает версию элемента управления ActiveX, на который указывает ссылка.

- **Имя библиотеки типов**

   Отображает имя библиотеки типов, на которую указывает ссылка.

- **Средство программы-оболочки**

   Отображает средство, которое используется для создания промежуточной сборки из библиотеки COM, на которую указывает ссылка, или элемента управления ActiveX.

### <a name="assembly-reference-properties-ccli"></a>Свойства ссылки на сборку (C + +/ CLI)

Свойства ссылки на сборку доступны только для ссылки на сборки .NET Framework в C + +/ CLI проектов. Эти свойства отображаются только в том случае, когда сборки .NET Framework выбран в **ссылки** области. Свойства невозможно изменить.

- **Относительный путь**

   Отображает относительный путь от каталога проекта к сборке, на которую указывает ссылка.

### <a name="build-properties"></a>Свойства сборки

Следующие свойства доступны для различных типов ссылок. Они позволяют задавать способ построения со ссылками.

- **Копировать локальные**

   Указывает, следует ли автоматически копировать сборку, на которую указывает ссылка, в целевое расположение во время сборки.

- **Копировать локальные вспомогательные сборки (C + +/ CLI)**

   Указывает, следует ли автоматически копировать вспомогательные сборки ссылочной сборки в целевое расположение во время сборки. Используется, только если для параметра **Копировать локальные** задано значение **true**.

- **Выходные данные ссылочной сборки**

   Указывает, что эта сборка используется в процессе сборки. Если **true**, сборка используется в командной строке компилятора в процессе сборки.

### <a name="project-to-project-reference-properties"></a>Свойства ссылок проектов на проекты

Следующие свойства определяют *ссылки проекта на проект* из проекта, который выбран в **ссылки** панели на другой проект в том же решении. Дополнительные сведения см. в статье [Управление ссылками в проекте](/visualstudio/ide/managing-references-in-a-project).

- **Компоновать зависимости библиотек**

   Если свойство имеет значение **True**, система проектов установит в зависимом проекте связь с LIB-файлами, создаваемыми независимым проектом. Обычно устанавливается **True**.

- **Идентификатор проекта**

   Уникальный идентификатор независимого проекта. Значение свойства — это GUID внутренней системы, который невозможно изменить.

- **Использовать входные данные зависимостей библиотек**

   Если свойство имеет значение **False**, система проектов не установит в зависимом проекте связь с LIB-файлами для библиотеки, созданной независимым проектом. В результате это значение отключает инкрементную компоновку. Обычно указывается **False** , так как сборка приложения может занять длительное время, если существует много независимых проектов.

### <a name="read-only-reference-properties-com--net"></a>Свойства ссылки только для чтения (COM и .NET)

Следующие свойства доступны для ссылок на COM-компоненты и сборки .NET, и их нельзя изменить.

- **Имя сборки**

   Отображает имя сборки для сборки, на которую указывает ссылка.

- **culture**

   Отображает язык и региональные параметры выбранной ссылки.

- **Описание**

   Отображает описание выбранной ссылки.

- **Полный путь**

   Отображает путь к каталогу сборки, на которую указывает ссылка.

- **идентификации**

   Для сборок .NET Framework отображает полный путь. Для компонентов COM отображает GUID.

- **Метка**

   Отображает метку ссылки.

- **name**

   Отображает имя ссылки.

- **Токен открытого ключа**

   Отображает токен открытого ключа, который используется для идентификации сборки, на которую указывает ссылка.

- **Строгое имя**

   `true` , если сборка, на которую указывает ссылка, имеет строгое имя. Сборка строгого имени имеет уникальную версию.

- **Версия**

   Отображает версию сборки, на которую указывает ссылка.

## <a name="see-also"></a>См. также

[Справочник по страницам свойств проекта C++](reference/property-pages-visual-cpp.md)<br>
[Значение компилятора C++ и свойства в Visual Studio сборки](working-with-project-properties.md)