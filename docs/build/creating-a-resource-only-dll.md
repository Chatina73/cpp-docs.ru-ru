---
title: Создание библиотек DLL, содержащих только ресурсы
description: Создание библиотеки DLL только для ресурсов в Visual Studio.
ms.date: 01/27/2020
helpviewer_keywords:
- resource-only DLLs [C++], creating
- DLLs [C++], creating
ms.assetid: e6b1d4da-7275-467f-a58c-a0a8a5835199
no-loc:
- noentry
ms.openlocfilehash: ef79de77e35cbef6acd4af1cec82a4edc1b7d105
ms.sourcegitcommit: b8c22e6d555cf833510753cba7a368d57e5886db
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "76821347"
---
# <a name="creating-a-resource-only-dll"></a>Создание библиотек DLL, содержащих только ресурсы

Библиотека DLL только для ресурсов — это библиотека DLL, которая не содержит никаких ресурсов, в том числе значков, растровых изображений, строк и диалоговых окон. Использование библиотеки DLL только для ресурсов — хороший способ совместного использования одного набора ресурсов несколькими программами. Это также хороший способ предоставления приложения с ресурсами, локализованными для нескольких языков. Дополнительные сведения см. [в разделе локализованные ресурсы в приложениях MFC: вспомогательные библиотеки DLL](localized-resources-in-mfc-applications-satellite-dlls.md).

## <a name="create-a-resource-only-dll"></a>Создание библиотеки DLL только для ресурсов

Чтобы создать библиотеку DLL только для ресурсов, создайте новый проект Windows DLL (не MFC) и добавьте в него ресурсы:

::: moniker range="vs-2015"

1. Выберите **проект Win32** в диалоговом окне **Новый проект** . Введите имена проекта и решения и нажмите кнопку **ОК**.

1. В **мастере приложений Win32**выберите **Параметры приложения**. Выберите **Тип приложения** **DLL**. В поле **Дополнительные параметры**выберите **Пустой проект**. Нажмите кнопку **Готово** , чтобы создать проект.

1. Создайте новый скрипт ресурсов, содержащий ресурсы для библиотеки DLL (например, строку или меню). Сохраните файл `.rc`.

1. В меню **проект** выберите команду **Добавить существующий элемент**, а затем вставьте новый файл `.rc` в проект.

1. Укажите параметр компоновщика [/NOENTRY](reference/noentry-no-entry-point.md) . `/NOENTRY` не позволяет компоновщику связывать ссылку на `_main` с библиотекой DLL; Этот параметр необходим для создания библиотеки DLL только для ресурсов.

1. Построение библиотеки DLL.

::: moniker-end
::: moniker range=">=vs-2017"

1. В диалоговом окне **Новый проект** выберите **Мастер рабочего стола Windows** и нажмите кнопку **Далее**. На странице **Настройка нового проекта** введите имена проекта и решения и нажмите кнопку **создать**.

1. В диалоговом окне **проект Windows Desktop** выберите **Тип приложения** **Библиотека динамической компоновки**. В поле **Дополнительные параметры**выберите **Пустой проект**. Нажмите кнопку **ОК** , чтобы создать проект.

1. Создайте новый скрипт ресурсов, содержащий ресурсы для библиотеки DLL (например, строку или меню). Сохраните файл `.rc`.

1. В меню **проект** выберите команду **Добавить существующий элемент**, а затем вставьте новый файл `.rc` в проект.

1. Укажите параметр компоновщика [/NOENTRY](reference/noentry-no-entry-point.md) . `/NOENTRY` не позволяет компоновщику связывать ссылку на `_main` с библиотекой DLL; Этот параметр необходим для создания библиотеки DLL только для ресурсов.

1. Построение библиотеки DLL.

::: moniker-end

## <a name="use-a-resource-only-dll"></a>Использовать библиотеку DLL только для ресурсов

Приложение, использующее библиотеку DLL только для ресурсов, должно вызывать [LoadLibraryEx](loadlibrary-and-afxloadlibrary.md) или связанную функцию для явной связи с библиотекой DLL. Чтобы получить доступ к ресурсам, вызовите универсальные функции `FindResource` и `LoadResource`, которые работают с ресурсами любого типа. Или вызовите одну из следующих функций для конкретного ресурса:

- `FormatMessage`

- `LoadAccelerators`

- `LoadBitmap`

- `LoadCursor`

- `LoadIcon`

- `LoadMenu`

- `LoadString`

Приложение должно вызвать `FreeLibrary` по завершении использования ресурсов.

## <a name="see-also"></a>См. также:

[Работа с файлами ресурсов](../windows/working-with-resource-files.md)\
[Создание библиотек DLL C/C++ в Visual Studio](dlls-in-visual-cpp.md)
