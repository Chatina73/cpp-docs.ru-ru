---
title: Создание библиотек DLL, содержащих только ресурсы
description: Создание библиотек DLL, содержащих только ресурсы, в Visual Studio.
ms.date: 01/27/2020
helpviewer_keywords:
- resource-only DLLs [C++], creating
- DLLs [C++], creating
ms.assetid: e6b1d4da-7275-467f-a58c-a0a8a5835199
no-loc:
- noentry
ms.openlocfilehash: ef79de77e35cbef6acd4af1cec82a4edc1b7d105
ms.sourcegitcommit: b8c22e6d555cf833510753cba7a368d57e5886db
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "76821347"
---
# <a name="creating-a-resource-only-dll"></a>Создание библиотек DLL, содержащих только ресурсы

В библиотеке DLL, содержащей только ресурсы, нет ничего, кроме ресурсов, таких как значки, растровые изображения, строки и диалоговые окна. Библиотеки DLL, содержащие только ресурсы, удобно использовать, когда необходимо предоставить нескольким программам общий доступ к одному и тому же набору ресурсов. С их помощью можно также легко предоставлять приложение с ресурсами, локализованными для нескольких языков. Дополнительные сведения см. в разделе [Локализованные ресурсы в приложениях MFC: вспомогательные библиотеки DLL](localized-resources-in-mfc-applications-satellite-dlls.md).

## <a name="create-a-resource-only-dll"></a>Создание библиотеки DLL, содержащей только ресурсы

Чтобы создать библиотеку DLL, содержащую только ресурсы, создайте новый проект Windows DLL (не MFC) и добавьте в него свои ресурсы.

::: moniker range="vs-2015"

1. Выберите **Проект Win32** в диалоговом окне **Создание проекта**. Введите имена проекта и решения, а затем нажмите кнопку **ОК**.

1. В **мастере приложений Win32** выберите **Параметры приложения**. В качестве **типа приложения** выберите **DLL**. В поле **Дополнительные параметры**выберите **Пустой проект**. Нажмите кнопку **Готово**, чтобы создать проект.

1. Создайте новый скрипт ресурсов, содержащий ресурсы для этой библиотеки DLL (такие как строка или меню). Сохраните файл `.rc`.

1. В меню **Проект** выберите **Добавить существующий элемент**, а затем вставьте в проект новый файл `.rc`.

1. Укажите параметр компоновщика [/NOENTRY](reference/noentry-no-entry-point.md). Параметр `/NOENTRY` запрещает компоновщику привязывать ссылку на `_main` к библиотеке DLL, поэтому его необходимо указывать при создании библиотеки DLL, содержащей только ресурсы.

1. Построение библиотеки DLL.

::: moniker-end
::: moniker range=">=vs-2017"

1. В диалоговом окне **Создание проекта** выберите **Мастер классических приложений Windows** и нажмите кнопку **Далее**. На странице **Настройка нового проекта** введите имена проекта и решения, а затем нажмите кнопку **Создать**.

1. В диалоговом окне **Проект классического приложения Windows** в разделе **Тип приложения** выберите **Библиотека динамической компоновки**. В поле **Дополнительные параметры**выберите **Пустой проект**. Нажмите кнопку **ОК**, чтобы создать проект.

1. Создайте новый скрипт ресурсов, содержащий ресурсы для этой библиотеки DLL (такие как строка или меню). Сохраните файл `.rc`.

1. В меню **Проект** выберите **Добавить существующий элемент**, а затем вставьте в проект новый файл `.rc`.

1. Укажите параметр компоновщика [/NOENTRY](reference/noentry-no-entry-point.md). Параметр `/NOENTRY` запрещает компоновщику привязывать ссылку на `_main` к библиотеке DLL, поэтому его необходимо указывать при создании библиотеки DLL, содержащей только ресурсы.

1. Построение библиотеки DLL.

::: moniker-end

## <a name="use-a-resource-only-dll"></a>Использование библиотеки DLL, содержащей только ресурсы

Приложение, которое использует библиотеку DLL, содержащую только ресурсы, должно вызывать [LoadLibraryEx](loadlibrary-and-afxloadlibrary.md) или связанную функцию, чтобы явно привязать эту библиотеку DLL. Для доступа к ресурсам следует вызывать универсальные функции `FindResource` и `LoadResource`, которые работают с ресурсами любого типа. Для доступа к конкретному ресурсу можно также использовать вызов одной из следующих функций:

- `FormatMessage`

- `LoadAccelerators`

- `LoadBitmap`

- `LoadCursor`

- `LoadIcon`

- `LoadMenu`

- `LoadString`

Завершив использование ресурсов, приложение должно вызывать `FreeLibrary`.

## <a name="see-also"></a>См. также

[Работа с файлами ресурсов](../windows/working-with-resource-files.md)\
[Создание библиотек DLL C/C++ в Visual Studio](dlls-in-visual-cpp.md)
