---
title: Наследование свойств в проектах Visual Studio — C++
description: Как работает наследование имущества в проектах нативной (MSBuild) Visual Studio C.
ms.date: 02/21/2020
helpviewer_keywords:
- C++ projects, property inheritance
ms.openlocfilehash: 4740c479c6cc7c877fd72b7828a8e4811826de6c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81328477"
---
# <a name="property-inheritance-in-visual-studio-projects"></a>Наследование свойств в проектах Visual Studio

Нативная система проекта Visual Studio основана на MSBuild. MSBuild определяет форматы файлов и правила для создания проектов любого рода. Он управляет большей частью сложности построения для нескольких конфигураций и платформ. Вы найдете полезным понять, как это работает. Это особенно важно, если вы хотите определить пользовательские конфигурации. Или создать многоразовые наборы свойств, которые можно разделить и импортировать в нескольких проектах.

## <a name="the-vcxproj-file-props-files-and-targets-files"></a>Файл VCXPROJ, файлы PROPS и TARGETS

Свойства проекта хранятся либо непосредственно*`.vcxproj`* в файле *`.targets`* *`.props`* проекта () или в других или файлах, которые импортирует файл проекта и которые поставляют значения по умолчанию. Для Visual Studio 2015, эти *`\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V140`* файлы расположены в . Для Visual Studio 2017, эти *`\Program Files (x86)\Microsoft Visual Studio\2017\<edition>\Common7\IDE\VC\VCTargets`* файлы расположены в , где *`<edition>`* установлено издание Visual Studio. В Visual Studio 2019, эти *`\Program Files (x86)\Microsoft Visual Studio\2019\<edition>\MSBuild\Microsoft\VC\v160`* файлы находятся в . Свойства также хранятся *`.props`* в любых пользовательских файлах, которые можно добавить в свой собственный проект. Мы настоятельно рекомендуем ВАМ НЕ отсеивать эти файлы вручную. Вместо этого используйте страницы свойств в IDE, чтобы изменить все свойства, особенно те, которые участвуют в наследовании, если у вас нет глубокого понимания MSBuild.

Как указано выше, одному свойству для некоторой конфигурации можно назначить разные значения в разных файлах. При сборке проекта модуль MSBuild оценивает файл проекта и все импортированные файлы в строго определенном порядке (как описано ниже). По мере оценки каждого файла все значения свойств, определенные в этом файле, переопределяют существующие значения. Любые значения, которые не указаны, наследуются из файлов, которые были оценены ранее. При установке свойства со страницами свойств также важно обратить внимание на то, где вы его устанавливаете. Если вы установите свойство "X" в файле, *`.props`* но свойство настроено на "Y" в файле проекта, то проект будет строиться с свойством, установленным на "Y". Если одно и то же свойство настроено на *`.cpp`* элемент проекта, например файл, то движок MSBuild будет использовать значение «Я».

Ниже представлено базовое дерево наследования.

1. Настройки по умолчанию из набора инструментов MSBuild CPP (. «Файлы программы»MSBuild,Microsoft.Cpp'v4.0»Microsoft.Cpp.Default.props, который импортируется *`.vcxproj`* файлом.)

1. Страницы свойств.

1. *`.vcxproj`* Файл. (может переопределять параметры по умолчанию и параметры страницы свойств).

1. Метаданные элементов.

> [!TIP]
> На странице свойств жирным шрифтом **определяется** в текущем контексте. Свойство в обычном шрифте наследуется.

## <a name="view-an-expanded-project-file-with-all-imported-values"></a>Просмотр развернутого файла проекта со всеми импортированными значениями

Иногда полезно просмотреть развернутый файл, чтобы определить, как наследуется значение данного свойства. Для просмотра развернутой версии введите следующую команду в командной строке Visual Studio (замените заполнители на конкретные имена файлов).

> **msbuild /pp:**_temp_**.txt** _myapp_**.vcxproj**

Расширенные файлы проекта могут быть большими и трудными для понимания, если вы не знакомы с MSBuild. Ниже представлена основная структура файла проекта.

1. Основные свойства проекта, которые не подвергаются воздействию в IDE.

1. Импорт *`Microsoft.cpp.default.props`*, который определяет некоторые основные, набор инструментов независимых свойств.

1. Глобальные свойства конфигурации (предоставляемые как свойства по умолчанию **PlatformToolset** и **Project** на странице **Конфигурация &gt; Общие**). Эти свойства определяют, в *`Microsoft.cpp.props`* какой набор инструментов и внутренние листы свойств импортируются на следующем этапе.

1. Импорт *`Microsoft.cpp.props`*, который устанавливает большую часть проекта по умолчанию.

1. Импорт всех листов свойств, включая *`.user`* файлы. Эти страницы свойств могут переопределить все значения, кроме свойств по умолчанию **PlatformToolset** и **Project**.

1. Остальные свойства конфигурации проекта. Эти значения могут переопределять значения, заданные на страницах свойств.

1. Элементы (файлы) вместе с связанными с ними метаданными. Эти элементы всегда являются последним словом в правилах оценки MSBuild, даже если они встречаются раньше других свойств и импорта.

Для получения дополнительной информации [см.](/visualstudio/msbuild/msbuild-properties)

## <a name="build-configurations"></a>Конфигурации сборки

Конфигурация — это просто произвольная группа свойств, которым назначено имя. Visual Studio предоставляет конфигурации Debug и Release. Каждый устанавливает различные свойства, соответствующие для сборки или выпуска отладки. Вы можете использовать **диспетчер конфигурации** для определения пользовательских конфигураций. Они удобный способ группировать свойства для определенного вкуса сборки.

Чтобы получить лучшее представление о конфигурациях сборки, откройте **менеджер по недвижимости.** Вы можете открыть его, выбрав **Просмотр > менеджер омицы или** просмотр > другим и > **менеджером по недвижимости Windows,** в зависимости от настроек. **Менеджер свойств** имеет узлы для каждой конфигурации и пары платформ ы в проекте. Под каждым из этих узлов находятся*`.props`* узлы для листов свойств (файлов), которые устанавливают некоторые специфические свойства для этой конфигурации.

![Диспетчер свойств](media/property-manager.png "диспетчер свойств")

Например, можно перейти к общему стеку на страницах свойств. Измените свойство набора символов на "Не установите" вместо "Использовать Unicode", а затем нажмите **OK.** Менеджер по управлению недвижимостью теперь не отображает лист свойства **поддержки Unicode.** Он удален для текущей конфигурации, но он все еще существует для других конфигураций.

Дополнительные сведения о диспетчере и страницах свойств см. в статье [Совместное или повторное использование параметров проекта Visual Studio C++](create-reusable-property-configurations.md).

> [!TIP]
> Файл *`.user`* является устаревшей функцией. Мы рекомендуем удалить его, чтобы сохранить свойства правильно сгруппированы в соответствии с конфигурацией и платформой.
