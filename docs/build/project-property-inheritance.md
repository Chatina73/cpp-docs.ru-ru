---
title: Наследование свойств в проекты Visual Studio - C++
ms.date: 12/10/2018
helpviewer_keywords:
- Visual C++ projects, property inheritance
ms.openlocfilehash: edd6d3bf82f7a13cf6687abeba3758dcceca5e84
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62295451"
---
# <a name="property-inheritance-in-visual-studio-projects"></a>Наследование свойств в проектах Visual Studio

Система проектов Visual Studio основана на MSBuild, который определяет форматы файлов и правила для создания проектов любого типа. Платформа MSBuild в значительной степени упрощает сборку для нескольких платформ и конфигураций, но вам нужно немного разобраться в ее работе. Это особенно важно в том случае, если вы хотите определить настраиваемые конфигурации или создать многоразовые наборы свойств, которые можно совместно использовать и импортировать в несколько проектов.

## <a name="the-vcxproj-file-props-files-and-targets-files"></a>VCXPROJ-файл, файлы с расширением PROPS и TARGETS-файлы

Свойства проекта хранятся непосредственно в файле проекта (*.vcxproj) или в других файлах .targets и .props, импортирует файл проекта и указать значения по умолчанию. Для Visual Studio 2015 эти файлы расположены в **\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V140**. Для Visual Studio 2017 эти файлы расположены в **\\Program Files (x86)\\Microsoft Visual Studio\\2017\\_выпуск_\\Common7\\IDE\\VC\\VCTargets**, где _выпуск_ — это установленный выпуск Visual Studio. Свойства также хранятся в любых пользовательских файлах PROPS, которые вы можете добавить в свой проект. Если у вас нет четкого представления о работе MSBuild, настоятельно рекомендуется не изменять эти файлы вручную и использовать для изменения свойств, особенно участвующих в наследовании, страницы свойств в интегрированной среде разработки.

Как показано выше, то же свойство, для такой же конфигурации можно назначить другое значение в этих разных файлах. При сборке проекта модуль MSBuild оценивает файл проекта и все импортированные файлы в строго определенном порядке (как описано ниже). По мере оценки каждого файла все значения свойств, определенные в этом файле, переопределяют существующие значения. Все неуказанные значения наследуются от файлов, оцененных ранее. Таким образом, при установке свойства с помощью страниц свойств важно следить за тем, где именно вы это делаете. Если задать свойство X в файле PROPS, при том что для того же свойства задано значение Y в файле проекта, проект будет создан со свойством, имеющим значение Y. Если то же свойство имеет значение Z для элемента проекта, например CPP-файла, то модуль MSBuild использует значение Z. 

Ниже представлено базовое дерево наследования.

1. Параметры по умолчанию из набора инструментов CPP системы MSBuild (..\Program Files\MSBuild\Microsoft.Cpp\v4.0\Microsoft.Cpp.Default.props, импортируемый VCXPROJ-файлом).

2. Страницы свойств.

3. VCXPROJ-файл (может переопределять параметры по умолчанию и параметры страницы свойств).

4. Метаданные элементов.

> [!TIP]
> Свойство, выделенное полужирным шрифтом (`bold`) на странице свойств, определяется в текущем контексте. Свойство в обычном шрифте наследуется.

## <a name="view-an-expanded-project-file-with-all-imported-values"></a>Просмотр файла развернутого проекта со всеми значениями импортированные

Иногда полезно просмотреть развернутый файл, чтобы определить, как наследуется значение данного свойства. Для просмотра развернутой версии введите следующую команду в командной строке Visual Studio (замените заполнители на конкретные имена файлов).

**msbuild /pp:** *temp* **.txt** *myapp* **.vcxproj**

Развернутые файлы проекта могут быть большими и трудными для понимания, если пользователь не знаком с MSBuild. Ниже представлена основная структура файла проекта.

1. Основные свойства проекта, которые не представлены в интегрированной среде разработки.

2. Импорт файла Microsoft.cpp.default.props, который определяет некоторые базовые, независимые от набора инструментов свойства.

3. Глобальные свойства конфигурации (предоставляемые как свойства по умолчанию **PlatformToolset** и **Project** на странице **Конфигурация &gt; Общие**). Эти свойства определяют, какие страницы свойств наборов инструментов и встроенные страницы свойств будут импортироваться из файла Microsoft.cpp.props на следующем шаге.

4. Импорт файла Microsoft.cpp.props, который задает большинство значений проекта по умолчанию.

5. Импорт всех страниц свойств, включая USER-файлы. Эти страницы свойств могут переопределить все значения, кроме свойств по умолчанию **PlatformToolset** и **Project**.

6. Остальная часть свойств конфигурации проекта. Эти значения могут переопределять значения, заданные на страницах свойств.

7. Элементы (файлы) вместе с связанными с ними метаданными. Эти элементы всегда используются последними в правилах вычисления MSBuild, даже если появляются до других свойств и импортов.

Дополнительные сведения см. в разделе [Свойства MSBuild](/visualstudio/msbuild/msbuild-properties).

## <a name="build-configurations"></a>Конфигурации сборки

Конфигурация — это просто произвольная группа свойств, которым назначено имя. Visual Studio предоставляет конфигурации отладки и выпуска, каждая из которых задает различные свойства соответственно для сборки отладки или выпуска. Вы можете использовать **Configuration Manager** для определения настраиваемых конфигураций — так удобно группировать свойства для определенной конфигурации сборки. 

Чтобы получить лучшее представление о конфигурациях сборки, откройте **диспетчер свойств** , выбрав **представление &#124; диспетчер свойств** или **представление &#124; Other Windows &#124; диспетчер свойств**  зависимости от выбранных параметров. **Диспетчер свойств** имеет узлы для каждой пары конфигурации и платформы в проекте. В каждом из этих узлов находятся узлы для страниц свойств (файлы PROPS), позволяющие задать некоторые свойства для этой конфигурации.

![Диспетчер свойств](media/property-manager.png "Диспетчер свойств")

Если отображаются в области "Общие" на страницах свойств и задать свойство набора символов для «Не установлено» вместо «Используйте Unicode» и нажмите кнопку **ОК**, диспетчер свойств будет отображаться не **поддержка Юникода** свойств Текущая конфигурация, но он по-прежнему будут существует для других конфигураций.

Дополнительные сведения о диспетчере свойств и страницы свойств, см. в разделе [общий ресурс или resuse параметры проекта Visual Studio C++](create-reusable-property-configurations.md).

> [!TIP]
> Файл USER — это устаревший компонент, и мы рекомендуем удалить его, чтобы обеспечить правильную группировку свойств по конфигурации и платформе.



