---
title: Внутренние компоненты MSBuild для C++ проектов в Visual Studio
ms.date: 12/08/2018
helpviewer_keywords:
- MSBuild overview
ms.assetid: dd258f6f-ab51-48d9-b274-f7ba911d05ca
ms.openlocfilehash: 6c8e891f6bf6ed6b3bb3d1c84dbc13b64ab7b868
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62320895"
---
# <a name="msbuild-internals-for-c-projects"></a>Внутренние компоненты MSBuild для проектов C++

При задании свойств проекта в интегрированной среде разработки и сохраните проект, Visual Studio записывает параметры проекта в файл проекта. Файл проекта содержит параметры, уникальные для данного проекта, но не содержит все параметры, необходимые для построения проекта. Файл проекта содержит `Import` элементы, включающие в себя набор дополнительных *файлы поддержки.* Файлы поддержки содержат оставшиеся свойства, целевые объекты и параметры, необходимые для построения проекта.

Большинство целевых объектов и свойств в файлах поддержки существуют исключительно для реализации системы построения. В следующем разделе описываются некоторые полезные целевые объекты и свойства, которые можно указать в командной строке MSBuild. Чтобы найти дополнительные целевые объекты и свойства, просмотрите файлы в каталогах файлов поддержки.

## <a name="support-file-directories"></a>Каталоги файлов поддержки

По умолчанию основные файлы поддержки Visual Studio, находятся в следующих каталогах. Каталоги по Microsoft Visual Studio используются Visual Studio 2017 и более поздних версий, хотя папок в MSBuild, используемые Visual Studio 2015 и более ранних версий.

|Каталог|Описание|
|---------------|-----------------|
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*год*\\*edition*\Common7\IDE\VC\VCTargets\ <br /><br />*диск*: \Program Files *(x86)* \v4.0 \MSBuild\Microsoft.Cpp (x86)\\*версии*\ |Содержит основные файлы целевых (с расширением TARGETS) и файлы свойств (с расширением PROPS), используемые целевыми объектами. По умолчанию макрос $(VCTargetsPath) ссылается на этот каталог.|
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*год*\\*edition*\Common7\IDE\VC\VCTargets\ Платформы\\*платформы*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\ |Содержит файлы цель и свойство платформы, которые переопределяют целевые объекты и свойства в родительском каталоге. Этот каталог также содержит библиотеку DLL, которая определяет задачи, которые используются целевыми объектами в этом каталоге.<br /><br /> *Платформы* заполнитель представляет ARM, Win32 или x64 подкаталог.|
|*диск*: \Program Files *(x86)* \Microsoft Visual Studio\\*год*\\*edition*\Common7\IDE\VC\VCTargets\ Платформы\\*платформы*\PlatformToolsets\\*набора инструментов*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\\*версии*\Platforms\\*платформы*\ PlatformToolsets\\*набора инструментов*\ <br /><br />*диск*: \Program Files *(x86)* \MSBuild\Microsoft.Cpp\v4.0\Platforms\\*платформы*\PlatformToolsets\\*набора инструментов*\ |Содержит каталоги, которые обеспечивают построение приложений C++ с использованием заданных *набор инструментов*.<br /><br /> *Год* и *edition* заполнители используются Visual Studio 2017 и более поздней версии. *Версии* заполнителем является V110 для Visual Studio 2012, V120 для Visual Studio 2013 или V140 для Visual Studio 2015. *Платформы* заполнитель представляет ARM, Win32 или x64 подкаталог. *Набор инструментов* заполнитель представляет подкаталог набора средств, например, v140 для создания приложений Windows с помощью набора инструментов Visual Studio 2015, v120_xp для сборки для Windows XP с помощью набора инструментов Visual Studio 2013, то есть v110_wp80 для Создавайте приложения Windows Phone 8.0 с помощью набора инструментов Visual Studio 2012.<br /><br />Путь, содержащий каталоги, которые обеспечивают построение приложений Visual Studio 2008 или Visual Studio 2010 не включает *версии*и *платформы* заполнителя Представляет Itanium, Win32 или x64 подкаталог. *Набор инструментов* заполнитель представляет подкаталог набора средств v90 или v100.|

## <a name="support-files"></a>Файлы поддержки

Каталоги файлов поддержки содержат файлы с такими расширениями:

|Расширение|Описание|
|---------------|-----------------|
|.targets|Содержит `Target` элементы XML, которые задают задачи, выполняемые целевым объектом. Может также содержать `PropertyGroup`, `ItemGroup`, `ItemDefinitionGroup`, и определяемых пользователем `Item` элементов, используемых для назначения параметров задачи файлы и параметры командной строки.<br /><br /> Дополнительные сведения см. в разделе [элемент Target (MSBuild)](/visualstudio/msbuild/target-element-msbuild).|
|.props|Содержит `Property Group` и определяемых пользователем `Property` XML-элементов, укажите файл и параметры, которые используются во время построения.<br /><br /> Может также содержать `ItemDefinitionGroup` и определяемых пользователем `Item` XML-элементы, задающие Дополнительные параметры. Элементы, определенные в группу определений элемента напоминают свойства, но нельзя получить доступ из командной строки. Файлы проекта Visual Studio часто используют элементы вместо свойств для представления параметров.<br /><br /> Дополнительные сведения см. в разделе [элемент ItemGroup (MSBuild)](/visualstudio/msbuild/itemgroup-element-msbuild), 
[Элемент ItemDefinitionGroup (MSBuild)](/visualstudio/msbuild/itemdefinitiongroup-element-msbuild), и [элемент Item (MSBuild)](/visualstudio/msbuild/item-element-msbuild).|
|XML|Содержит XML-элементы, объявления и инициализации элементов пользовательского интерфейса интегрированной среды Разработки, например вкладки свойств и страницы свойств и поле и список текстовых полей.<br /><br /> XML-файлы непосредственно поддерживают интегрированную среду Разработки, не MSBuild. Тем не менее присваиваются значения свойств интегрированной среды Разработки для создания свойств и элементов.<br /><br /> Большинство XML-файлы хранятся в подкаталоге языковому стандарту. Например, файлы для региона английский (США) находятся в $(VCTargetsPath) \1033\\.|

## <a name="user-targets-and-properties"></a>Пользовательские целевые объекты и свойства

Для наиболее эффективного использования MSBuild в командной строке, полезно знать, какие свойства и целевые объекты являются полезным и нужным. Большинство свойств и целевых объектов упрощают реализацию системы построения Visual Studio и поэтому не соответствуют потребностям конкретного пользователя. В этом разделе описаны некоторые оправданной свойства, ориентированные на пользователей и целевых объектов.

### <a name="platformtoolset-property"></a>Свойство PlatformToolset

`PlatformToolset` Свойство определяет, какой набор инструментов MSVC используется в сборке. По умолчанию используется текущий набор инструментов. Если это свойство имеет значение, значение свойства сцепляется со строковыми литералами для формирования пути к каталогу, содержащему файлы свойств и целевых объектов, которые необходимы для построения проекта для конкретной платформы. Необходимо установить набор инструментов платформы для построения с помощью этой версии набора инструментов платформы.

Например, задать `PlatformToolset` свойства `v140` использовать инструменты Visual Studio 2015 и библиотеки для построения приложения:

`msbuild myProject.vcxproj /p:PlatformToolset=v140`

### <a name="preferredtoolarchitecture-property"></a>Свойство PreferredToolArchitecture

 `PreferredToolArchitecture` Свойство определяет 32-разрядной или 64-разрядных компилятора и средств, используются ли в сборке. Это свойство не влияет на вывод архитектура платформы или конфигурации. По умолчанию MSBuild использует x86 версии компилятора и инструментов, если это свойство не задано.

Например, задать `PreferredToolArchitecture` свойства `x64` использовать 64-разрядный компилятор и средства для построения приложения:

`msbuild myProject.vcxproj /p:PreferredToolArchitecture=x64`

### <a name="useenv-property"></a>Useenv-свойство

По умолчанию параметры платформы для текущего проекта переопределение переменных среды PATH, INCLUDE, LIB, LIBPATH, КОНФИГУРАЦИИ и ПЛАТФОРМЫ. Задайте `UseEnv` свойства **true** гарантировать, что переменные среды не переопределен.

`msbuild myProject.vcxproj /p:UseEnv=true`

### <a name="targets"></a>Целевые объекты

Существуют сотни целевых объектов в файлах поддержки Visual Studio. Однако большинство являются целевых объектов, ориентированных на системы, пользователь может их игнорировать. Большинство целевых объектов системы имеют префикс в виде символа подчеркивания (_) или иметь имя, которое начинается с «PrepareFor», «Вычисления», «До», «После», «Pre» или «Post».

В следующей таблице перечислены несколько полезных целевых объектов, ориентированных на пользователя.

|целевого объекта|Описание|
|------------|-----------------|
|BscMake|Выполняет программу Microsoft Обзор программы управления информацией bscmake.exe.|
|Построить|Выполняет построение проекта.<br /><br /> Это является целевым объектом по умолчанию для проекта.|
|ClCompile|Запускает средство компилятор MSVC cl.exe.|
|Очистить|Удаляет временные и промежуточные файлы сборки.|
|LIB|Выполняет программу Microsoft 32-разрядной библиотеки диспетчера lib.exe.|
|Ссылка|Запускает средство компоновщик MSVC link.exe.|
|ManifestResourceCompile|Извлекает список ресурсов из манифеста и затем запускает средство компилятор ресурсов Microsoft Windows rc.exe.|
|MIDL|Запускает средство компилятора Microsoft интерфейс определения языка MIDL midl.exe.|
|Перестроить|Выполняет очистку, а затем выполняет построение проекта.|
|ResourceCompile|Запускает средство компилятор ресурсов Microsoft Windows rc.exe.|
|Программа XdcMake|Выполняет программу XML-документации xdcmake.exe.|
|XSD|Запускает средство определения схемы XML xsd.exe. *См. примечание ниже.*|

> [!NOTE]
> В Visual Studio 2017, поддержка проект C++ **xsd** файлов является устаревшим. Вы можете продолжать использовать **Microsoft.VisualC.CppCodeProvider** , добавив **CppCodeProvider.dll** вручную в глобальном кэше СБОРОК.

## <a name="see-also"></a>См. также

[Справочник по задачам MSBuild](/visualstudio/msbuild/msbuild-task-reference)<br/>
[Задача BscMake](/visualstudio/msbuild/bscmake-task)<br/>
[Задача CL](/visualstudio/msbuild/cl-task)<br/>
[Задача CPPClean](/visualstudio/msbuild/cppclean-task)<br/>
[Задача LIB](/visualstudio/msbuild/lib-task)<br/>
[Связывание задачи](/visualstudio/msbuild/link-task)<br/>
[Задача MIDL](/visualstudio/msbuild/midl-task)<br/>
[Задача MT](/visualstudio/msbuild/mt-task)<br/>
[Задача RC](/visualstudio/msbuild/rc-task)<br/>
[Задача SetEnv](/visualstudio/msbuild/setenv-task)<br/>
[Задача VCMessage](/visualstudio/msbuild/vcmessage-task)<br/>
[Задача XDCMake](/visualstudio/msbuild/xdcmake-task)<br/>
