---
title: Выбор формата входных файлов netmodule
ms.date: 11/04/2016
ms.assetid: 4653d1bd-300f-4083-86f5-d1a06f44e61c
ms.openlocfilehash: b4d4b80e4b9195d184b9d97cea67bbaaa3d7d843
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81320564"
---
# <a name="choosing-the-format-of-netmodule-input-files"></a>Выбор формата входных файлов netmodule

Файл MSIL .obj (компилированный с [/clr)](clr-common-language-runtime-compilation.md)также может быть использован в качестве файла .netmodule.  файлы .obj содержат метаданные и нативные символы.  .netmodules содержат только метаданные.

Вы можете передать файл MSIL .obj любому другому компилятору Visual Studio через опцию компилятора /addmodule (но имейте в виду, что файл .obj становится частью полученной сборки и должен быть отправлен вместе со сборкой).  Например, visual C и Visual Basic имеют опцию компилятора /addmodule.

> [!NOTE]
> В большинстве случаев вам нужно будет передать связующее файл .obj из компиляции, создавейтой модуля .net.  Передача файла модуля .dll или .netmodule MSIL ссылке может привести к LNK1107.

Файлы .obj вместе с связанными файлами .h, на которые вы ссылаетесь через #include в источнике, позволяют приложениям C's потреблять исходные типы в модуле, в то время как в файле .netmodule только управляемые типы могут быть использованы приложением C'.  Если вы попытаетесь передать файл .obj #using, информация о типах native будет недоступна; #include файл .obj .obj .h вместо.

Другие компиляторы Visual Studio могут использовать управляемые типы только из модуля.

Используйте следующее, чтобы определить, нужно ли использовать файл .netmodule или файл .obj в качестве модуля ввода в ссылку MSVC:

- Если вы строите с помощью компилятора Visual Studio, кроме визуального СЗ, производное .netmodule и используйте .netmodule в качестве ввода в связующее звено.

- Если вы используете компилятор MSVC для создания модулей и если модуль (ы) будет использоваться для создания чего-то иного, кроме библиотеки, используйте файлы .obj, производимые компилятором, в качестве ввода модуля в связующее; не используйте файл .netmodule в качестве ввода.

- Если ваши модули будут использоваться для создания родной (не управляемой) библиотеки, используйте файлы .obj в качестве ввода модуля в связующее звено и создавайте файл библиотеки .lib.

- Если ваши модули будут использоваться для создания управляемой библиотеки, и если все входные модуля в связующее звено будут поддающимся проверке (производится с /clr:safe), используйте файлы .obj в качестве ввода модуля в связующее лицо и создавайте файл библиотеки .dll (сборка) или .netmodule (module).

- Если ваши модули будут использоваться для создания управляемой библиотеки, и если один или несколько модулей ввода в связующее будет производиться только / clr, используйте .obj файлы в качестве модуля ввода в связующее лицо и генерировать .dll (сборка).  Если вы хотите выявить управляемые типы из библиотеки и если вы также хотите, чтобы приложения C's потребляли исходные типы в библиотеке, библиотека будет состоять из файлов .obj для модулей компонентов библиотек (вы также хотите отправить файлы .h для каждого модуля, чтобы они могли быть сопосены с #include из исходного кода).

## <a name="see-also"></a>См. также раздел

[NETMODULE-файлы в качестве входных файлов компоновщика](netmodule-files-as-linker-input.md)
