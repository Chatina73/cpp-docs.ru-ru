---
description: 'Дополнительные сведения о: выбор формата входных файлов NETMODULE'
title: Выбор формата входных файлов netmodule
ms.date: 11/04/2016
ms.assetid: 4653d1bd-300f-4083-86f5-d1a06f44e61c
ms.openlocfilehash: ed7e448879e983ace7d96cdc7585bf0303378114
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97179210"
---
# <a name="choosing-the-format-of-netmodule-input-files"></a>Выбор формата входных файлов netmodule

OBJ-файл MSIL (скомпилированный с [/CLR](clr-common-language-runtime-compilation.md)) также можно использовать в качестве NETMODULE-файла.  OBJ-файлы содержат метаданные и собственные символы.  . netmodule содержит только метаданные.

Файл MSIL. obj можно передать в любой другой компилятор Visual Studio с помощью параметра компилятора/addmodule (но имейте в виду, что OBJ-файл станет частью результирующей сборки и должен быть отправлен вместе со сборкой).  Например, в Visual C# и Visual Basic есть параметр компилятора/addmodule.

> [!NOTE]
> В большинстве случаев необходимо передать в компоновщик OBJ-файл из компиляции, создавшей модуль .NET.  Передача файла DLL или NETMODULE-модуля MSIL в Компоновщик может привести к LNK1107.

OBJ-файлы, а также связанные с ними h-файлы, которые ссылаются через #include в источнике, позволяют приложениям C++ использовать собственные типы в модуле, в то время как в файле. netmodule, приложение C++ может использовать только управляемые типы.  При попытке передать obj-файл в #using сведения о собственных типах будут недоступны. Вместо этого #include h-файл OBJ-файла.

Другие компиляторы Visual Studio могут использовать только управляемые типы из модуля.

Используйте следующую команду, чтобы определить, нужно ли использовать NETMODULE-или OBJ-файл в качестве входных данных модуля для компоновщика КОМПИЛЯТОРОМ MSVC:

- При построении с помощью компилятора Visual Studio, отличного от Visual C++, следует создать NETMODULE-файла и использовать NETMODULE в качестве входных данных для компоновщика.

- Если вы используете компилятор КОМПИЛЯТОРОМ MSVC для создания модулей и если эти модули будут использоваться для создания чего-либо, отличного от библиотеки, используйте OBJ-файлы, созданные компилятором в качестве входных данных модуля для компоновщика. не используйте файл netmodule в качестве входных данных.

- Если модули будут использоваться для создания собственной (не управляемой) библиотеки, используйте OBJ-файлы в качестве входных данных модуля для компоновщика и создайте LIB-файл библиотеки.

- Если модули будут использоваться для создания управляемой библиотеки и все входные данные модуля для компоновщика будут проверены (создается с помощью/clr: Сейф), используйте OBJ-файлы в качестве входных данных модуля для компоновщика и создайте файл библиотеки DLL (Assembly) или. netmodule (модуль).

- Если модули будут использоваться для построения управляемой библиотеки, и если один или несколько модулей, входящих в компоновщик, будут создаваться с помощью только/CLR, используйте OBJ-файлы в качестве входных данных модуля для компоновщика и создайте DLL (сборку).  Если вы хотите предоставить управляемые типы из библиотеки и вы хотите, чтобы приложения C++ использовали собственные типы в библиотеке, то библиотека будет состоять из OBJ-файлов для модулей компонентов библиотеки (Кроме того, вы захотите поставлять файлы h для каждого модуля, чтобы на них можно было ссылаться #include из исходного кода).

## <a name="see-also"></a>См. также раздел

[Файлы NETMODULE в качестве входных файлов компоновщика](netmodule-files-as-linker-input.md)
