---
title: Выбор формата входных файлов netmodule
ms.date: 11/04/2016
ms.assetid: 4653d1bd-300f-4083-86f5-d1a06f44e61c
ms.openlocfilehash: d48bfe84210143db333d1e6b081acf1aa66980cf
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62294581"
---
# <a name="choosing-the-format-of-netmodule-input-files"></a>Выбор формата входных файлов netmodule

OBJ-файле MSIL (скомпилированные с использованием [/CLR](clr-common-language-runtime-compilation.md)) также может использоваться как NETMODULE-файл.  OBJ-файлы содержат метаданные и собственных символов.  netmodules-файлы содержат только метаданные.

Вы можете передать OBJ-файле MSIL в другом компиляторе Visual Studio с помощью параметра компилятора/addmodule (но имейте в виду, что OBJ-файл становится частью итоговой сборки и должен поставляться со сборкой).  Например Visual C# и Visual Basic имеют / addmodule-параметр компилятора.

> [!NOTE]
>  В большинстве случаев необходимо будет передать в компоновщик OBJ-файл из компиляции, создавшей модуль .net.  Передача DLL или .netmodule файл модуля MSIL в компоновщик может привести к LNK1107.

OBJ-файлы, вместе с соответствующими файлами связанные .h, которые ссылаются с помощью #include в источнике, разрешают приложениям C++ использовать собственные типы в модуле, тогда как в NETMODULE-файл, можно использовать только управляемые типы приложение C++.  Если вы попытаетесь передать OBJ-файл для #using, сведения о собственных типов не будут доступны; #include .h файл OBJ-файле.

Другие компиляторы Visual Studio можно использовать только управляемые типы из модуля.

Используйте следующие параметры для определения, нужно ли использовать .netmodule или OBJ-файл в качестве входных данных компоновщика MSVC модуля.

- Если вы создаете с помощью компилятора Visual Studio, отличных от Visual C++, создайте NETMODULE и используйте его в качестве входных данных компоновщика.

- Если вы используете компилятор MSVC для создания модулей и если модули будут использоваться для построения, отличные от библиотеки, используйте OBJ-файлы, созданные компилятором, в качестве входных данных компоновщика; модуль не используйте NETMODULE-файл в качестве входных данных.

- Если модули будут использоваться для построения библиотеки машинный код (неуправляемой), использовать OBJ-файлы в качестве входных данных компоновщика модуль и создайте файл библиотеки LIB.

- Модули, которые будут использоваться для создания управляемой библиотеки, если все входные данные модуля в компоновщик будут проверяемыми (созданный с помощью/CLR: safe), использовать OBJ-файлы в качестве входных данных компоновщика модуля и создания DLL (сборку) или файл библиотеки (модуль) NETMODULE.

- Если модули, которые будут использоваться для создания управляемой библиотеки, и если один или несколько модулей входных данных компоновщика, которые будут созданы с помощью/CLR точно так же, использовать OBJ-файлы в качестве входных данных компоновщика модуль и создайте DLL (сборка).  Если вы хотите предоставить управляемых типов из библиотеки, и если вы хотите приложений C++, чтобы использовать собственные типы в библиотеке, библиотека будет состоять из OBJ-файлов для модулей компонентов библиотек (также требуется поставлять h-файлы для каждого модуля Чтобы их можно было ссылаться с помощью #include из исходного кода).

## <a name="see-also"></a>См. также

[NETMODULE-файлы в качестве входных файлов компоновщика](netmodule-files-as-linker-input.md)
