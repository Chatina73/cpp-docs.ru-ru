---
description: 'Дополнительные сведения о: использование библиотеки импорта и файла экспорта'
title: Использование библиотеки импорта и файла экспорта
ms.date: 11/04/2016
helpviewer_keywords:
- circular exports
- import libraries, using
- export files
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
ms.openlocfilehash: f42a98ebe19cb32fb77964f26c37928776b5b30c
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97247024"
---
# <a name="using-an-import-library-and-export-file"></a>Использование библиотеки импорта и файла экспорта

Если программа (исполняемый файл или библиотека DLL) экспортируется в другую программу, из которой она импортируется, или если более двух программ экспортируются в и импортируются друг с другом, команды для связывания этих программ должны иметь циклические экспорты.

В ситуации без циклического экспорта при связывании программы, использующей экспорты из другой программы, необходимо указать библиотеку импорта для программы экспорта. Библиотека импорта для программы экспорта создается при компоновке этой программы экспорта. Поэтому перед импортом программы необходимо связать программу экспорта. Например, если TWO.dll импортирует из ONE.dll, необходимо сначала связать ONE.dll и получить библиотеку импорта ONE. lib. Затем укажите один. lib при компоновке TWO.dll. Когда компоновщик создает TWO.dll, он также создает свою библиотеку импорта — TWO. lib. Используйте два. lib при связывании программ, которые импортируются из TWO.dll.

Однако в случае циклического экспорта невозможно связать все взаимозависимые программы с помощью библиотек импорта из других программ. В приведенном выше примере, если TWO.dll также экспортируется в ONE.dll, Библиотека импорта для TWO.dll не будет существовать, если ONE.dll связан. При наличии циклических экспортов необходимо использовать LIB для создания библиотеки импорта и файла экспорта для одной из программ.

Чтобы начать, выберите одну из программ для запуска программы LIB. В команде LIB перечислите все объекты и библиотеки для программы и укажите/ДЕФ. Если программа использует DEF-файл или спецификации/EXPORT, укажите также их.

После создания библиотеки импорта (lib) и файла экспорта (. exp) для программы используйте библиотеку импорта при связывании других программ или программ. LINK создает библиотеку импорта для каждой сборки, которую она создает. Например, при запуске программы LIB для объектов и экспортов для ONE.dll необходимо создать один lib и ONE. exp. Теперь можно использовать один lib при компоновке TWO.dll; на этом шаге также создается библиотека импорта TWO. lib.

Наконец, свяжите программу, с которой вы начали. В команде LINK Укажите объекты и библиотеки для программы, EXP – файл, созданный библиотекой LIB для программы, а также библиотеку импорта или библиотеки для экспортируемых программой объектов. Чтобы продолжить этот пример, команда LINK для ONE.dll содержит один EXP и два. lib, а также объекты и библиотеки, которые переходят в ONE.dll. Не указывайте DEF файл или спецификации/EXPORT в команде LINK; они не нужны, так как определения экспорта содержатся в EXP-файле. При компоновке с помощью EXP-файла LINK не создает библиотеку импорта, так как предполагается, что она была создана при создании EXP-файла.

## <a name="see-also"></a>См. также раздел

[Работа с библиотеками импорта и файлами экспорта](working-with-import-libraries-and-export-files.md)
