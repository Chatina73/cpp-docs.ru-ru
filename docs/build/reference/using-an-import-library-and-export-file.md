---
title: Использование библиотеки импорта и файла экспорта
ms.date: 11/04/2016
helpviewer_keywords:
- circular exports
- import libraries, using
- export files
ms.assetid: 2634256a-8aa5-4495-8c9e-6cde10e4ed76
ms.openlocfilehash: 75a93d97478050718b3f6c32fa83d7320a38954b
ms.sourcegitcommit: bff17488ac5538b8eaac57156a4d6f06b37d6b7f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2019
ms.locfileid: "57412982"
---
# <a name="using-an-import-library-and-export-file"></a>Использование библиотеки импорта и файла экспорта

Если программа (исполняемый файл или библиотеку DLL) экспортирует в другую программу, она также импортирует или если более чем двух программ экспортировать и импортировать друг от друга, команды, чтобы связать эти программы должны учитывать циклические экспорты.

При компоновке программы, использующего экспорты из другой программы, в ситуации циклические экспорты, необходимо указать библиотеку импорта экспортирующей программы. Библиотека импорта для экспорта программы создается при компоновке этой программы. Таким образом необходимо связать экспортирующей программы перед программой импорта. Например, если TWO.dll импортирует из ONE.dll, сначала необходимо скомпоновать ONE.dll, получив библиотеку импорта ONE.lib. Далее нужно указать ONE.lib компоновки TWO.dll. Когда компоновщик создает TWO.dll, он также создает его библиотеки импорта, TWO.lib. Используйте TWO.lib при компоновке программы, Импорт из TWO.dll.

Тем не менее в случае циклического экспорта не невозможно связать все взаимозависимые программы с помощью библиотеки импорта из других программ. В примере, рассмотренном ранее, если TWO.dll также экспортирует ONE.dll, библиотека импорта для TWO.dll еще не будет существовать при компоновке ONE.dll. Если существуют циклические экспорты, необходимо использовать LIB для создания библиотеки импорта и экспорта файла для одной из программ.

Чтобы начать, выберите одну из программ, для которой необходимо выполнить LIB. В команде LIB список всех объектов и библиотек для программы и укажите параметр/DEF. Если программа использует DEF-файл или спецификации/export, также укажите их.

После создания библиотеки импорта (LIB) и файла экспорта (.exp) по программе использования импорта библиотеки при компоновке программы или программ. LINK создает библиотеку импорта для каждой программы экспорта его построения. Например при запуске программы LIB на объекты и экспорты для ONE.dll создать ONE.lib и ONE.exp. Теперь вы можете использовать ONE.lib компоновки TWO.dll; Этот шаг также создает библиотеку импорта TWO.lib.

Свяжите программы, который начинается с. В команде LINK укажите объектов и библиотек для программы, EXP-файл, созданный LIB для программы и библиотека импорта или библиотек для экспортов, используемых программой. Чтобы продолжить в примере, команда ССЫЛКУ для ONE.dll содержит ONE.exp и TWO.lib, а также объекты и библиотеки, используемые в библиотеке ONE.dll. Не нужно указывать DEF-файл или спецификации/Export в команде LINK; Это не требуется, так как определения экспортов находятся в EXP-файл. При связывании с помощью EXP-файл, ссылка не создает библиотеку импорта, так как он предполагает, что было создано при создании файла EXP.

## <a name="see-also"></a>См. также

[Работа с библиотеками импорта и файлами экспорта](../../build/reference/working-with-import-libraries-and-export-files.md)
