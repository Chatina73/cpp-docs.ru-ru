---
description: 'Дополнительные сведения: обработчики уведомлений'
title: Обработчики уведомления
ms.date: 11/04/2016
helpviewer_keywords:
- delayed loading of DLLs, notification hooks
ms.assetid: e9c291ed-2f2d-4319-a171-09800625256f
ms.openlocfilehash: 716d2b31faa71c77ec436662ce00368d15afc4b1
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97209754"
---
# <a name="notification-hooks"></a>Обработчики уведомления

Обработчики уведомлений вызываются непосредственно перед выполнением следующих действий в вспомогательной подпрограммы:

- Сохраненный обработчик для библиотеки проверяется на наличие уже загруженного.

- Для попытки загрузки библиотеки DLL вызывается **LoadLibrary** .

- Вызывается **GetProcAddress** , чтобы попытаться получить адрес процедуры.

- Вернитесь к преобразовательу отложенных импортов нагрузки.

Обработчик уведомлений включен:

- Путем предоставления нового определения **__pfnDliNotifyHook2** указателя, которое инициализируется для указания на вашу собственную функцию, которая получает уведомления.

   \-или-

- Установив указатель **__pfnDliNotifyHook2** к функции-обработчику перед вызовами DLL, которые программа загружает с задержкой.

Если уведомление — **длистартпроцессинг**, функция-обработчик может вернуть:

- NULL

   Вспомогательный модуль по умолчанию обрабатывает загрузку библиотеки DLL. Его можно вызывать только в информационных целях.

- указатель функции

   Обойти обработку отложенной загрузки по умолчанию. Это позволяет указать собственный обработчик нагрузки.

Если уведомление — **длинотепрелоадлибрари**, функция-обработчик может вернуть:

- 0, если требуется только информационное уведомление.

- ХМОДУЛЕ для загруженной библиотеки DLL, если она загрузила саму библиотеку DLL.

Если уведомление — **длинотепрежетпрокаддресс**, функция-обработчик может вернуть:

- 0, если требуется только информационное уведомление.

- Адрес импортированной функции, если функция-обработчик получает сам адрес.

Если уведомление **длинотиндпроцессинг**, возвращаемое значение функции-обработчика игнорируется.

Если этот указатель инициализирован (не равен нулю), вспомогательная функция отложенной загрузки будет вызывать функцию в определенных точках уведомления во время выполнения. Указатель функции имеет следующее определение:

```C
// The "notify hook" gets called for every call to the
// delay load helper.  This allows a user to hook every call and
// skip the delay load helper entirely.
//
// dliNotify == {
//  dliStartProcessing |
//  dliNotePreLoadLibrary  |
//  dliNotePreGetProc |
//  dliNoteEndProcessing}
//  on this call.
//
ExternC
PfnDliHook   __pfnDliNotifyHook2;

// This is the failure hook, dliNotify = {dliFailLoadLib|dliFailGetProc}
ExternC
PfnDliHook   __pfnDliFailureHook2;
```

Уведомления передают структуру **делайлоадинфо** функции-обработчику вместе со значением уведомления. Эти данные идентичны тем, которые используются вспомогательной подсистемой с отложенной загрузкой. Значением уведомления будет одно из значений, определенных в [определениях структуры и констант](structure-and-constant-definitions.md).

## <a name="see-also"></a>См. также раздел

[Обработка ошибок и уведомление](error-handling-and-notification.md)
