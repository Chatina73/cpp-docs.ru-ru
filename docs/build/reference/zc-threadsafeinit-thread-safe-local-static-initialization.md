---
title: '/ Zc: threadsafeinit (потокобезопасной локальной статичной инициализации)'
ms.date: 03/14/2018
f1_keywords:
- threadSafeInit
- /Zc:threadSafeInit
helpviewer_keywords:
- -Zc compiler options (C++)
- threadSafeInit
- Thread-safe Local Static Initialization
- /Zc compiler options (C++)
- Zc compiler options (C++)
ms.assetid: a0fc4b34-2cf0-45a7-a642-b8afc4ca19f2
ms.openlocfilehash: 92a1bfa5ec3bab2814397d51e35e617b7666c706
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62315707"
---
# <a name="zcthreadsafeinit-thread-safe-local-static-initialization"></a>/ Zc: threadsafeinit (потокобезопасной локальной статичной инициализации)

**/Zc: threadsafeinit** компилятора указывает компилятору для инициализации статических локальных (область видимости функции) переменных в потокобезопасным способом, устраняя потребность выполнять синхронизацию вручную. Только инициализации является поточно ориентированной. Использование и их изменения статических локальных переменных несколькими потоками необходимо по-прежнему нужно синхронизировать вручную. Этот параметр доступен, начиная с Visual Studio 2015. По умолчанию Visual Studio включает этот параметр.

## <a name="syntax"></a>Синтаксис

> **/Zc:threadSafeInit**[**-**]

## <a name="remarks"></a>Примечания

В C ++ 11 standard область действия переменных с статической или длительности хранилища потока должен быть ноль инициализирован прежде, чем любая другая инициализация выполняется. Инициализация происходит, когда элемент управления сначала проходит через объявление переменной. Если возникает исключение во время инициализации, переменная считается не инициализирована и инициализация — это попытка обращения к следующему элементу управления время проходит через объявление. Если элемент управления входит объявление параллельно с инициализации, в блоках параллельного выполнения во время завершения инициализации. Поведение не определено, если элемент управления повторно входит в объявление рекурсивно во время инициализации. По умолчанию Visual Studio, начиная с Visual Studio 2015 реализует это стандартное поведение. Это поведение можно задать явным образом задав **/Zc: threadsafeinit** параметр компилятора.

**/Zc: threadsafeinit** включен параметр компилятора по умолчанию. [/ Permissive-](permissive-standards-conformance.md) параметр не влияет на **/Zc: threadsafeinit**.

Потокобезопасная Инициализация статических локальных переменных зависит от кода, реализованные в библиотеке времени выполнения универсальной C (UCRT). Во избежание полагаться на UCRT, или для сохранения поведения не Потокобезопасная инициализация версий Visual Studio до Visual Studio 2015, использовать **/Zc: threadsafeinit** параметр. Если вы знаете, что безопасность потоков, не требуется, используйте этот параметр для создания кода немного меньше, более быстрых вокруг объявления статической локальной переменной.

Статические локальные переменные поточно ориентированные внутренне использовать локальное хранилище потока (TLS) чтобы обеспечить эффективное выполнение, когда статический уже инициализирован. Реализация этой функции зависит от функции поддержки операционной системы Windows в Windows Vista и более поздних операционных системах. Windows XP, Windows Server 2003 и более ранних версий ОС нет эта поддержка, поэтому они не получают преимущество эффективность. Эти операционные системы также иметь более низкий предел на число разделов TLS, которые могут быть загружены. Превышение TLS разделе ограничение может привести к сбою. Если это проблема в коде, особенно в коде, который должен выполняться в старых операционных системах, использовать **/Zc: threadsafeinit** код инициализации поточно ориентированными.

Дополнительные сведения о вопросах соответствия в Visual C++ см. в статье [Nonstandard Behavior](../../cpp/nonstandard-behavior.md).

### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [свойств компилятора и собранной задать C++ в Visual Studio](../working-with-project-properties.md).

1. Из **конфигураций** раскрывающийся список меню, выберите **все конфигурации**.

1. Выберите **свойства конфигурации** > **C/C++** > **командной строки** страницу свойств.

1. Изменить **Дополнительные параметры** свойство **/Zc: threadsafeinit** или **/Zc: threadsafeinit** и выберите **ОК**.

## <a name="see-also"></a>См. также

[Параметры компилятора MSVC](compiler-options.md)<br/>
[Синтаксис командной строки компилятора MSVC](compiler-command-line-syntax.md)<br/>
[/Zc (соответствие)](zc-conformance.md)<br/>
