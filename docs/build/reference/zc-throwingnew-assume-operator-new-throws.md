---
title: /Zc:throwingNew (предположим, что оператор новый создает исключение)
ms.date: 03/01/2018
f1_keywords:
- throwingNew
- /Zc:throwingNew
helpviewer_keywords:
- -Zc compiler options (C++)
- throwingNew
- Assume operator new Throws
- /Zc compiler options (C++)
- Zc compiler options (C++)
ms.assetid: 20ff0101-9677-4d83-8c7b-8ec9ca49f04f
ms.openlocfilehash: c8c7b4e7246cc3bb1b3a73cde4f6830eb7178dd2
ms.sourcegitcommit: 8105b7003b89b73b4359644ff4281e1595352dda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2019
ms.locfileid: "57813517"
---
# <a name="zcthrowingnew-assume-operator-new-throws"></a>/Zc:throwingNew (предположим, что оператор новый создает исключение)

Когда **/Zc:throwingNew** параметр указан, компилятор оптимизирует вызовы `operator new` пропуска проверок для возвращаемого значения является пустым указателем. Этот параметр предписывает компилятору считать, что все связанные реализации `operator new` и пользовательских механизмов выделения памяти соответствует стандарту C++ и исключение в случае сбоя выделения. По умолчанию в Visual Studio, компилятор создает pessimistically проверками "null" (**/Zc:throwingNew-**) для этих вызовов, так как пользователи могут связывать с реализацией не создающие исключения `operator new` или написать пользовательский распределитель подпрограммы которые возвращают указатели null.

## <a name="syntax"></a>Синтаксис

> **/Zc:throwingNew**[**-**]

## <a name="remarks"></a>Примечания

С момента ISO C ++ 98, стандарте указал, что по умолчанию [оператор new](../../standard-library/new-operators.md#op_new) вызывает `std::bad_alloc` при сбое выделения памяти. Версии Visual C++ до Visual Studio 6.0 возвращается указатель null на сообщение об ошибке выделения. Начиная с Visual Studio 2002 `operator new` соответствует стандарту и создает исключение в случае сбоя. Для поддержки кода, использующего старого стиля выделения, Visual Studio предоставляет реализацию могут быть связаны `operator new` в nothrownew.obj, возвращается указатель null в случае сбоя. По умолчанию компилятор также создает защитных проверками "null" для предотвращения этих распределителей старого стиля вызывает немедленное сбой в случае сбоя. **/Zc:throwingNew** указывает компилятору убрать этих проверок значений null, предполагается, что все связанные памяти Распределители соответствуют стандарту. Это относится к явной не создающие исключения `operator new` перегрузки, которые объявлены с помощью дополнительный параметр типа `std::nothrow_t` и иметь явный `noexcept` спецификации.

По существу, чтобы создать объект в свободном хранилище, компилятор создает код для выделения памяти и затем вызвать его конструктор для инициализации памяти. Так как компилятор MSVC обычно не может определить, если этот код будет скомпонован для несоответствующих, запрещающий распределителя, по умолчанию она также создает проверку значения null перед вызовом конструктора. Это предотвращает указатель null разыменования в вызове конструктора, в случае сбоя выделения, не создающие исключения. В большинстве случаев эти проверки не нужны, так как значение по умолчанию `operator new` Распределители throw вместо возвращения пустые указатели. Проверки также сожалению побочными эффектами. Они значительно разрастается размер кода, атаке прогноза ветвь, и они препятствовать другие виды оптимизации компилятора полезно, например devirtualization или const распространения из инициализированного объекта. Проверки существует только в коде поддержки, ссылающуюся на *nothrownew.obj* или пользовательских несоответствующих `operator new` реализаций. Если вы не используете, не соответствующих `operator new`, мы рекомендуем использовать **/Zc:throwingNew** для оптимизации кода.

**/Zc:throwingNew** параметр отключен по умолчанию и не зависит от [/ permissive-](permissive-standards-conformance.md) параметр.

Если компиляция выполняется с помощью создания кода во время компоновки (LTCG), не нужно указывать **/Zc:throwingNew**. Когда код компилируется с использованием LTCG, компилятор может определить, если значение по умолчанию, удовлетворяющие `operator new` реализация используется. Если Да, компилятор автоматически оставляет out проверок значений null. Компоновщик ищет **/ThrowingNew** флаг, чтобы определить, если реализация `operator new` предписаниям. Этот флаг компоновщика можно указать, включив эту директиву в источнике для реализации нового пользовательского оператора:

```cpp
#pragma comment(linker, "/ThrowingNew")
```

Дополнительные сведения о вопросах соответствия в Visual C++ см. в статье [Nonstandard Behavior](../../cpp/nonstandard-behavior.md).

## <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [свойств компилятора и собранной задать C++ в Visual Studio](../working-with-project-properties.md).

1. Из **конфигурации** раскрывающийся список меню, выберите **все конфигурации**.

1. Выберите **свойства конфигурации** > **C/C++** > **командной строки** страницу свойств.

1. Изменить **Дополнительные параметры** свойство **/Zc:throwingNew** или **/Zc:throwingNew-** и выберите **ОК**.

## <a name="see-also"></a>См. также

[Параметры компилятора MSVC](compiler-options.md)<br/>
[Синтаксис командной строки компилятора MSVC](compiler-command-line-syntax.md)<br/>
[/Zc (соответствие)](zc-conformance.md)<br/>
[noexcept (C++)](../../cpp/noexcept-cpp.md)<br/>
[Спецификации исключений (throw) (C++)](../../cpp/exception-specifications-throw-cpp.md)<br/>
[Terminate (exception)](../../standard-library/exception-functions.md#terminate)<br/>
