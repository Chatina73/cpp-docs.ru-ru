---
title: Справочник по компоновщику MSVC
ms.date: 12/10/2018
ms.assetid: bb736587-d13b-4f3c-8982-3cc2c015c59c
ms.openlocfilehash: 2503e212e7325fc97f9057861cb85d5cf0571094
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81336498"
---
# <a name="linking"></a>Компоновка

В проекте СЗЗ этап *соединения* выполняется после того, как компилятор компилятор компилировал исходный код в файлы объектов (q.obj). Связующее соединение (link.exe) объединяет файлы объекта в единый исполняемый файл.

Варианты Linker можно установить внутри или за пределами Visual Studio. В Visual Studio вы получаете доступ к опциям ссылки, нажав на узла проекта в **Solution Explorer** и выбрав **свойства** для отображения страниц свойств. Выберите **Linker** в левом стеле, чтобы расширить узла и увидеть все варианты.

## <a name="linker-command-line-syntax"></a>Синтаксис командной строки Linker

При запуске LINK за пределами Visual Studio можно указать ввод одним или несколько способов:

- В командной строке

- Использование командных файлов

- В переменных среды

Link сначала обрабатывает параметры, указанные в переменной среды LINK, а затем параметры в порядке, указанном в командной строке и в командных файлах. Если опцион повторяется с различными аргументами, последний обработанный имеет приоритет.

Параметры применяются ко всей сборке; никакие параметры не могут быть применены к определенным файлам ввода.

Запуск LINK. EXE, используйте следующий командный синтаксис:

```
LINK arguments
```

Варианты `arguments` включают и имена файлов и могут быть указаны в любом порядке. Параметры обрабатываются сначала, затем файлы. Используйте одно или несколько пробелов или вкладок для разделения аргументов.

> [!NOTE]
> Запустить этот инструмент можно только с запроса команды Visual Studio. В системной командной строке или проводнике это невозможно.

## <a name="command-line"></a>Командная строка

На командной строке опция состоит из разосклителя опции, либо тире (-) или передний слэш (/), за которым следует название опции. Имена вариантов не могут быть сокращены. Некоторые варианты принимают аргумент, указанный после толстой кишки (:). Никакие пробелы или вкладки не допускаются в пределах спецификации опции, за исключением указанной строки в варианте /COMMENT. Укажите числовые аргументы в десятичной или C-языковой нотации. Имена вариантов и аргументы по ключевому слову или названию файла не являются чувствительными к делу, но идентификаторы в качестве аргументов чувствительны к делу.

Чтобы передать файл связующее, укажите имя файла на командной строке после команды LINK. Можно указать абсолютный или относительный путь с именем файла, а также использовать подстановочные знаки в имени файла. Если вы опустите расширение точки (.) и имя файла, LINK предполагает .obj для поиска файла. LINK не использует расширения файлов или их отсутствие для предположений о содержании файлов; он определяет тип файла, изучая его, и обрабатывает его соответствующим образом.

link.exe возвращает нулевую для успеха (без ошибок).  В противном случае ссылка возвращает номер ошибки, которая остановила ссылку.  Например, если связующее соединение генерирует LNK1104, ссылка возвращает 1104.  Соответственно, наименьшее число ошибок, возвращенное по ошибке связующим звеном, составляет 1000.  Значение возврата 128 представляет собой проблему конфигурации либо с операционной системой, либо с файлом .config; погрузчик не загружал ни link.exe, ни c2.dll.

## <a name="link-command-files"></a>Командные файлы LINK

Аргументы командной строки можно передать LINK в виде командного файла. Чтобы указать командный файл связующим, используйте следующий синтаксис:

> <em>Командный файл</em> **LINK \@ **

*Командный файл* — это название текстового файла. Между табличкой ()**\@** и именем файла не допускается пространство или вкладка. Расширение по умолчанию не существует; вы должны указать полное имя файла, включая любое расширение. Wildcards не могут быть использованы. Можно указать абсолютный или относительный путь с именем файла. LINK не использует переменную среды для поиска файла.

В командном файле аргументы могут быть разделены пробелами или вкладками (как на командной строке) и новыми символами.

Можно указать все или часть командной строки в командном файле. Вы можете использовать несколько командных файлов в команде LINK. LINK принимает ввод командного файла, как если бы он был указан в этом местоположении на командной строке. Файлы командования не могут быть вложены. LINK повторяет содержимое командных файлов, если не указан параметр [/NOLOGO.](nologo-suppress-startup-banner-linker.md)

## <a name="example"></a>Пример

Следующая команда для создания DLL передает имена файлов объектов и библиотек в отдельных командных файлах и использует третий файл команд для спецификации опции /EXPORTS:

```cmd
link /dll @objlist.txt @liblist.txt @exports.txt
```

## <a name="link-environment-variables"></a>Переменные среды инструмента LINK

Средство LINK использует следующие переменные среды:

- LINK \_и\_LINK , если определено. Инструмент LINK подготавчивает параметры и аргументы, определенные в переменной среды LINK, и привязывает параметры и аргументы, определенные в переменной среды \_LINK,\_ к аргументам командной строки перед обработкой.

- LIB, если определено. Инструменты LINK используют путь LIB при поиске объекта, библиотеки или другого файла, указанного в командной строке или опции [/BASE.](base-base-address.md) Средство также использует путь LIB для поиска PDB-файла, указанного в объекте. Переменная LIB может содержать один или несколько путей, разделенных точкой с запятой. Один путь должен указывать на подкаталог \lib папки установки Visual C++.

- PATH, если средству необходимо запускать программу CVTRES и не удается найти файл в том же каталоге, где находится LINK. (LINK требует, чтобы CVTRES связала файл .res.) PATH должен указать на субдиректорию установки Visual C'.

- TMP для указания каталога при связывании OMF или RES-файлов.

## <a name="see-also"></a>См. также раздел

[C / C - Строительство Справочник](c-cpp-building-reference.md)
[MSVC Linker Параметры](linker-options.md)
[Модуль-Определение (.def) Файлы](module-definition-dot-def-files.md)
[Linker Поддержка для задержки загруженных DLLs](linker-support-for-delay-loaded-dlls.md)
