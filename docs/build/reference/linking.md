---
title: Справочник по компоновщику MSVC
ms.date: 12/10/2018
ms.assetid: bb736587-d13b-4f3c-8982-3cc2c015c59c
ms.openlocfilehash: d46874b5eaff889834df284ba90e6c6f196d8d66
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80079512"
---
# <a name="linking"></a>Компоновка

В C++ проекте шаг *компоновки* выполняется после того, как компилятор закомпилирует исходный код в объектные файлы (*. obj). Компоновщик (Link. exe) объединяет объектные файлы в один исполняемый файл.

Параметры компоновщика можно задать внутри или за пределами Visual Studio. В Visual Studio доступ к параметрам компоновщика можно получить, щелкнув правой кнопкой мыши узел проекта в **Обозреватель решений** и выбрав **свойства** для отображения страниц свойств. Выберите **Компоновщик** в левой области, чтобы развернуть узел и просмотреть все параметры.

## <a name="linker-command-line-syntax"></a>Синтаксис командной строки компоновщика

При запуске ссылки вне Visual Studio можно указать входные данные одним или несколькими способами:

- В командной строке

- Использование командных файлов

- В переменных среды

LINK First обрабатывает параметры, указанные в переменной среды LINK, а затем параметры в том порядке, в котором они указаны в командной строке и в командных файлах. Если параметр повторяется с другими аргументами, последний обрабатывается в приоритете.

Параметры применяются ко всей сборке. никакие параметры не могут применяться к конкретным входным файлам.

Для запуска ссылки. EXE, используйте следующий синтаксис команды:

```
LINK arguments
```

`arguments` включают параметры и имена файлов и могут быть указаны в любом порядке. Сначала обрабатываются параметры, а затем — файлы. Используйте один или несколько пробелов или символов табуляции для разделения аргументов.

> [!NOTE]
>  Это средство можно запустить только из командной строки Visual Studio. В системной командной строке или проводнике это невозможно.

## <a name="command-line"></a>Командная строка

В командной строке параметр состоит из спецификатора Option: тире (-) или косой черты (/), за которым следует имя параметра. Имена параметров не могут быть сокращены. Некоторые параметры принимают аргумент, указанный после двоеточия (:). В спецификации параметра не допускается использование пробелов и символов табуляции, за исключением строк в кавычках в параметре/COMMENT. Укажите числовые аргументы в десятичной или C-языковой нотации. Имена параметров и их ключевые слова или имена аргументов не учитывают регистр, но идентификаторы в качестве аргументов чувствительны к регистру.

Чтобы передать файл компоновщику, укажите имя файла в командной строке после команды LINK. Можно указать абсолютный или относительный путь с именем файла, а в имени файла можно использовать подстановочные знаки. Если опустить расширение с точкой (.) и именем файла, LINK предполагает, что файл будет иметь значение. obj. LINK не использует расширения имен файлов или не имеет их, чтобы сделать предположения о содержимом файлов; Он определяет тип файла, изучая его и соответствующим образом обрабатывает его.

Link. exe возвращает ноль в случае успеха (без ошибок).  В противном случае компоновщик возвращает номер ошибки, который остановил связь.  Например, если компоновщик создает LNK1104, компоновщик возвращает 1104.  Соответственно, самый низкий номер ошибки, возвращенный компоновщиком, — 1000.  Возвращаемое значение 128 представляет проблему конфигурации с операционной системой или файлом конфигурации; загрузчик не загрузил Link. exe или C2. dll.

## <a name="link-command-files"></a>Командные файлы LINK

Аргументы командной строки можно передать в виде командного файла в виде ссылки. Чтобы указать командный файл для компоновщика, используйте следующий синтаксис:

> **Ссылка \@** <em>коммандфиле</em>

*Коммандфиле* — это имя текстового файла. Между знаком @ ( **\@** ) и именем файла не допускаются пробелы или знаки табуляции. Расширение по умолчанию отсутствует. необходимо указать полное имя файла, включая любое расширение. Подстановочные знаки использовать нельзя. Можно указать абсолютный или относительный путь с именем файла. LINK не использует переменную среды для поиска файла.

В командном файле аргументы можно разделять пробелами или знаками табуляции (как в командной строке), а также символами новой строки.

В командном файле можно указать всю командную строку или ее часть. В команде LINK можно использовать более одного командного файла. LINK принимает ввод командного файла, как если бы он был указан в этом расположении в командной строке. Командные файлы не могут быть вложенными. LINK отображает содержимое командных файлов, если не указан параметр [/nologo](nologo-suppress-startup-banner-linker.md) .

## <a name="example"></a>Пример

Следующая команда для сборки библиотеки DLL передает имена объектных файлов и библиотек в отдельные командные файлы и использует третий командный файл для определения параметра/EXPORTS:

```cmd
link /dll @objlist.txt @liblist.txt @exports.txt
```

## <a name="link-environment-variables"></a>Переменные среды инструмента LINK

Средство LINK использует следующие переменные среды:

- LINK и \_LINK\_, если они определены. Инструмент LINK добавляет параметры и аргументы, определенные в переменной среды LINK, и добавляет параметры и аргументы, определенные в \_LINK\_ переменной среды, в аргументы командной строки перед обработкой.

- LIB, если определено. Инструмент LINK использует путь LIB при поиске объекта, библиотеки или другого файла, указанного в командной строке или с помощью параметра [/base](base-base-address.md) . Средство также использует путь LIB для поиска PDB-файла, указанного в объекте. Переменная LIB может содержать один или несколько путей, разделенных точкой с запятой. Один путь должен указывать на подкаталог \lib папки установки Visual C++.

- PATH, если средству необходимо запускать программу CVTRES и не удается найти файл в том же каталоге, где находится LINK. (Для связи с RES-файлом ссылка требует CVTRES.) ПУТЬ должен указывать на подкаталог \bin для визуальной C++ установки.

- TMP для указания каталога при связывании OMF или RES-файлов.

## <a name="see-also"></a>См. также:

[C/C++ строится ссылка](c-cpp-building-reference.md)
[параметры компоновщика компилятором MSVC](linker-options.md)
[файлов определения модуля (DEF)](module-definition-dot-def-files.md)
[поддержки компоновщика для DLL с отложенной загрузкой](linker-support-for-delay-loaded-dlls.md)
