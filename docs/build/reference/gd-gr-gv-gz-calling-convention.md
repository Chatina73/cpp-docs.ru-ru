---
title: /Gd, /Gr, /Gv, /Gz (соглашение о вызовах)
ms.date: 09/05/2018
f1_keywords:
- /Gr
- /Gv
- /Gd
- VC.Project.VCCLCompilerTool.CallingConvention
helpviewer_keywords:
- -Gd compiler option [C++]
- -Gv compiler option [C++]
- /Gv compiler option [C++]
- -Gr compiler option [C++]
- Gd compiler option [C++]
- Gr compiler option [C++]
- /Gz compiler option [C++]
- -Gz compiler option [C++]
- /Gd compiler option [C++]
- Gz compiler option [C++]
- Gv compiler option [C++]
- /Gr compiler option [C++]
ms.assetid: fd3110cb-2d77-49f2-99cf-a03f9ead00a3
ms.openlocfilehash: ab10ac1a4d0c327ff4d0ae54620f3fde752e020b
ms.sourcegitcommit: eff68e4e82be292a5664616b16a526df3e9d1cda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80150817"
---
# <a name="gd-gr-gv-gz-calling-convention"></a>/Gd, /Gr, /Gv, /Gz (соглашение о вызовах)

Эти параметры определяют порядок, в котором аргументы функции передаются в стек, то, удаляет ли вызывающая или вызываемая функция аргументы из стека в конце вызова, а также соглашение о декорировании имен, используемое компилятором для идентификации отдельных функций.

## <a name="syntax"></a>Синтаксис

> **/Gd**<br/>
> **/Gr**<br/>
> **/Gv**<br/>
> **/Gz**

## <a name="remarks"></a>Remarks

**/Gd**, параметр по умолчанию, определяет соглашение о вызовах [__cdecl](../../cpp/cdecl.md) для всех функций, кроме функций-членов C++ и функций с пометкой [__stdcall](../../cpp/stdcall.md), [__fastcall](../../cpp/fastcall.md) или [__vectorcall](../../cpp/vectorcall.md).

**/Gr** определяет соглашение о вызовах `__fastcall` для всех функций, кроме функций-членов C++, функций с именем `main` и функций с пометкой `__cdecl`, `__stdcall` или `__vectorcall`. Все функции `__fastcall` должны иметь прототипы. Это соглашение о вызовах доступно только в компиляторах для 32-разрядных систем и игнорируется компиляторами, предназначенными для других архитектур.

**/Gz** определяет соглашение о вызовах `__stdcall` для всех функций, кроме функций-членов C++, функций с именем `main` и функций с пометкой `__cdecl`, `__fastcall` или `__vectorcall`. Все функции `__stdcall` должны иметь прототипы. Это соглашение о вызовах доступно только в компиляторах для 32-разрядных систем и игнорируется компиляторами, предназначенными для других архитектур.

**/GV** указывает `__vectorcall`ное соглашение о вызовах для всех C++ функций, кроме функций-членов, функций с именами `main`, функций с `vararg`ным списком аргументов переменной или функциями, которые помечены конфликтующими `__cdecl`, `__stdcall`или атрибутом `__fastcall`. Это соглашение о вызовах доступно только в 32- и 64-разрядных архитектурах, поддерживающих /arch:SSE2 и более поздние версии, и игнорируется компиляторами, предназначенными для архитектуры ARM.

Функции, принимающие переменное число аргументов, должны иметь пометку `__cdecl`.

Параметры **/Gd**, **/Gr**, **/Gv** и **/Gz** несовместимы с [/clr:safe](clr-common-language-runtime-compilation.md) и **/clr:pure**. Параметры компилятора **/clr:pure** и **/clr:safe** не рекомендуется использовать в Visual Studio 2015, и они не поддерживаются в Visual Studio 2017 и более поздних версий.

> [!NOTE]
> По умолчанию для 32-разрядных процессоров функции-члены C++ используют [__thiscall](../../cpp/thiscall.md).

Для всех процессоров функция-член, явно помеченная как `__cdecl`, `__fastcall`, `__vectorcall` или `__stdcall`, использует указанное соглашение о вызовах, если оно не игнорируется в данной архитектуре. Функция-член, принимающая переменное число аргументов, всегда использует соглашение о вызовах `__cdecl`.

Эти параметры компилятора не влияют на декорирование имен методов и функций C++. Если методы и функции C++ не объявлены как `extern "C"`, к ним применяется другая схема декорирования имен. Дополнительные сведения см. в статье [Внутренние имена](decorated-names.md).

Дополнительные сведения о соглашениях о вызовах см. в статье [Соглашения о вызовах](../../cpp/calling-conventions.md).

## <a name="__cdecl-specifics"></a>Особенности соглашения __cdecl

В 32-разрядных процессорах все аргументы функции передаются в стеке справа налево. В ARM и 64-разрядных архитектурах некоторые аргументы передаются в регистрах, а остальные — в стеке справа налево. Вызывающая подпрограмма извлекает аргументы из стека.

Для языка C соглашение об именовании `__cdecl` предусматривает использование имени функции с символом подчеркивания перед ним (`_`). Преобразование регистра не выполняется. Если функции C++ не объявлены как `extern "C"`, к ним применяется другая схема декорирования имен. Дополнительные сведения см. в статье [Внутренние имена](decorated-names.md).

## <a name="__fastcall-specifics"></a>Особенности соглашения __fastcall

Некоторые аргументы функции `__fastcall` передаются в регистрах (для 32-разрядных процессоров, ECX и EDX), а остальные — в стеке справа налево. Вызываемая подпрограмма извлекает аргументы из стека до возврата управления. Как правило, параметр **/Gr** уменьшает время выполнения.

> [!NOTE]
> Будьте осторожны при использовании соглашения о вызовах `__fastcall` для функции, написанной на встроенном языке ассемблера. Использование регистров может конфликтовать с использованием компилятора.

Для языка C соглашение об именовании `__fastcall` предусматривает использование имени функции с символом **\@** перед ним и размером аргументов функции в байтах после него. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`@function_name@number`

С соглашением об именовании `__fastcall` следует использовать стандартные файлы включения. В противном случае вы получите неразрешенные внешние ссылки.

## <a name="__stdcall-specifics"></a>Особенности соглашения __stdcall

Аргументы функции `__stdcall` помещаются в стек справа налево. Вызываемая функция извлекает эти аргументы из стека до возврата управления.

Для языка C соглашение об именовании `__stdcall` предусматривает использование имени функции с символом подчеркивания ( **\_** ) перед ним и символом **\@** и размером аргументов функции в байтах после него. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`_functionname@number`

## <a name="__vectorcall-specifics"></a>Особенности соглашения __vectorcall

Целочисленные аргументы функции `__vectorcall` передаются по значению, с использованием до двух (в x86) или четырех (в x64) целочисленных регистров и до шести регистров XMM для значений с плавающей запятой и векторов, а остальные передаются в стеке справа налево. Вызываемая функция очищает стек до возврата управления. Возвращаемые векторные значения и значения с плавающей запятой возвращаются в XMM0.

Для языка C соглашение об именовании `__vectorcall` предусматривает использование имени функции с двумя символами **\@\@** и размером аргументов функции в байтах после него. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`functionname@@number`

### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Подробнее см. в статье [Настройка компилятора C++ и свойства сборки в Visual Studio](../working-with-project-properties.md).

1. Выберите страницу свойств **C/C++**  > **Дополнительно**.

1. Измените свойство **Соглашение о вызовах**.

### <a name="to-set-this-compiler-option-programmatically"></a>Установка данного параметра компилятора программным способом

- См. раздел <xref:Microsoft.VisualStudio.VCProjectEngine.VCCLCompilerTool.CallingConvention%2A>.

## <a name="see-also"></a>См. также раздел

- [Параметры компилятора MSVC](compiler-options.md)
- [Синтаксис командной строки компилятора MSVC](compiler-command-line-syntax.md)
