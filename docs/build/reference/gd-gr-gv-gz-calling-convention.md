---
title: /Gd, /Gr, /Gv, /Gz (соглашение о вызовах)
ms.date: 09/05/2018
f1_keywords:
- /Gr
- /Gv
- /Gd
- VC.Project.VCCLCompilerTool.CallingConvention
helpviewer_keywords:
- -Gd compiler option [C++]
- -Gv compiler option [C++]
- /Gv compiler option [C++]
- -Gr compiler option [C++]
- Gd compiler option [C++]
- Gr compiler option [C++]
- /Gz compiler option [C++]
- -Gz compiler option [C++]
- /Gd compiler option [C++]
- Gz compiler option [C++]
- Gv compiler option [C++]
- /Gr compiler option [C++]
ms.assetid: fd3110cb-2d77-49f2-99cf-a03f9ead00a3
ms.openlocfilehash: 73fce079a98a3f4afaa35f8b8c6630fc8a9b4ca4
ms.sourcegitcommit: 6b749db14b4cf3a2b8d581fda6fdd8cb98bc3207
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/05/2020
ms.locfileid: "82825530"
---
# <a name="gd-gr-gv-gz-calling-convention"></a>/Gd, /Gr, /Gv, /Gz (соглашение о вызовах)

Эти параметры определяют порядок, в котором аргументы функции передаются в стек, то, удаляет ли вызывающая или вызываемая функция аргументы из стека в конце вызова, а также соглашение о декорировании имен, используемое компилятором для идентификации отдельных функций.

## <a name="syntax"></a>Синтаксис

> **/GD**\
> **/GR**\
> **/GV**\
> **/GZ**

## <a name="remarks"></a>Примечания

**/Gd**, параметр по умолчанию, определяет соглашение о вызовах [__cdecl](../../cpp/cdecl.md) для всех функций, кроме функций-членов C++ и функций с пометкой [__stdcall](../../cpp/stdcall.md), [__fastcall](../../cpp/fastcall.md) или [__vectorcall](../../cpp/vectorcall.md).

**/GR** указывает соглашение `__fastcall` о вызовах для всех функций, за исключением функций элементов `main`C++, функций с именами и `__cdecl`функций `__stdcall`, которые `__vectorcall`помечены как, или. Все функции `__fastcall` должны иметь прототипы. Это соглашение о вызовах доступно только в компиляторах для 32-разрядных систем и игнорируется компиляторами, предназначенными для других архитектур.

**/Gz** указывает соглашение `__stdcall` о вызовах для всех функций, кроме функций элементов C++, `main`функций с именами и функций, `__cdecl`которые `__fastcall`помечены `__vectorcall`как, или. Все функции `__stdcall` должны иметь прототипы. Это соглашение о вызовах доступно только в компиляторах для 32-разрядных систем и игнорируется компиляторами, предназначенными для других архитектур.

**/GV** указывает соглашение `__vectorcall` о вызовах для всех функций, кроме функций-членов C++ `main`, функций с именами `vararg` , функций с переменным списком аргументов или функций, помеченных конфликтующим `__stdcall`атрибутом `__fastcall` `__cdecl`, или. Это соглашение о вызовах доступно только в 32- и 64-разрядных архитектурах, поддерживающих /arch:SSE2 и более поздние версии, и игнорируется компиляторами, предназначенными для архитектуры ARM.

Функции, принимающие переменное число аргументов, должны иметь пометку `__cdecl`.

Параметры **/Gd**, **/Gr**, **/Gv** и **/Gz** несовместимы с [/clr:safe](clr-common-language-runtime-compilation.md) и **/clr:pure**. Параметры компилятора **/clr:pure** и **/clr:safe** не рекомендуется использовать в Visual Studio 2015, и они не поддерживаются в Visual Studio 2017 и более поздних версий.

> [!NOTE]
> По умолчанию для 32-разрядных процессоров функции-члены C++ используют [__thiscall](../../cpp/thiscall.md).

Для всех процессоров функция-член, явно помеченная как `__cdecl`, `__fastcall`, `__vectorcall` или `__stdcall`, использует указанное соглашение о вызовах, если оно не игнорируется в данной архитектуре. Функция-член, принимающая переменное число аргументов, всегда использует соглашение о вызовах `__cdecl`.

Эти параметры компилятора не влияют на декорирование имен методов и функций C++. Если методы и функции C++ не объявлены как `extern "C"`, к ним применяется другая схема декорирования имен. Дополнительные сведения см. в статье [Внутренние имена](decorated-names.md).

Дополнительные сведения о соглашениях о вызовах см. в статье [Соглашения о вызовах](../../cpp/calling-conventions.md).

## <a name="__cdecl-specifics"></a>Особенности соглашения __cdecl

В 32-разрядных процессорах все аргументы функции передаются в стеке справа налево. В ARM и 64-разрядных архитектурах некоторые аргументы передаются в регистрах, а остальные — в стеке справа налево. Вызывающая подпрограмма извлекает аргументы из стека.

Для языка C соглашение об именовании `__cdecl` предусматривает использование имени функции с символом подчеркивания перед ним (`_`). Преобразование регистра не выполняется. Если функции C++ не объявлены как `extern "C"`, к ним применяется другая схема декорирования имен. Дополнительные сведения см. в статье [Внутренние имена](decorated-names.md).

## <a name="__fastcall-specifics"></a>Особенности соглашения __fastcall

Некоторые аргументы функции `__fastcall` передаются в регистрах (для 32-разрядных процессоров, ECX и EDX), а остальные — в стеке справа налево. Вызываемая подпрограмма извлекает аргументы из стека до возврата управления. Как правило, параметр **/Gr** уменьшает время выполнения.

> [!NOTE]
> Будьте осторожны при использовании соглашения о вызовах `__fastcall` для функции, написанной на встроенном языке ассемблера. Использование регистров может конфликтовать с использованием компилятора.

Для языка C в `__fastcall` соглашении об именовании используется имя функции, предшествующее символу**\@**(), за которым следует размер аргументов функции в байтах. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`@function_name@number`

С соглашением об именовании `__fastcall` следует использовать стандартные файлы включения. В противном случае вы получите неразрешенные внешние ссылки.

## <a name="__stdcall-specifics"></a>Особенности соглашения __stdcall

Аргументы функции `__stdcall` помещаются в стек справа налево. Вызываемая функция извлекает эти аргументы из стека до возврата управления.

Для языка C в `__stdcall` соглашении об именовании используется имя функции, которому предшествует символ**\_** подчеркивания (), а за ним**\@**— символ () и размер аргументов функции в байтах. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`_functionname@number`

## <a name="__vectorcall-specifics"></a>Особенности соглашения __vectorcall

Целочисленные аргументы `__vectorcall` функции передаются по значению с использованием до двух (в x86) или четырех (в x64) целочисленных регистров и до шести регистров XMM для значений с плавающей запятой и векторов, а остальные передаются в стеке справа налево. Вызываемая функция очищает стек до возврата управления. Возвращаемые векторные значения и значения с плавающей запятой возвращаются в XMM0.

Для языка C в `__vectorcall` соглашении об именовании используется имя функции, за которой следуют**\@** два знака in () и размер аргументов функции в байтах. Преобразование регистра не выполняется. В качестве соглашения об именовании компилятор использует следующий шаблон:

`functionname@@number`

### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Подробнее см. в статье [Настройка компилятора C++ и свойства сборки в Visual Studio](../working-with-project-properties.md).

1. Выберите страницу**дополнительных** свойств **C/C++** > .

1. Измените свойство **Соглашение о вызовах**.

### <a name="to-set-this-compiler-option-programmatically"></a>Установка данного параметра компилятора программным способом

- См. раздел <xref:Microsoft.VisualStudio.VCProjectEngine.VCCLCompilerTool.CallingConvention%2A>.

## <a name="see-also"></a>См. также раздел

- [Параметры компилятора КОМПИЛЯТОРОМ MSVC](compiler-options.md)
- [Синтаксис командной строки компилятора КОМПИЛЯТОРОМ MSVC](compiler-command-line-syntax.md)
