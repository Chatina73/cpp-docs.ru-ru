---
title: Понятие вспомогательной функции
ms.date: 11/04/2016
helpviewer_keywords:
- delayed loading of DLLs, helper function
- __delayLoadHelper2 function
- delayimp.lib
- __delayLoadHelper function
- delayhlp.cpp
- delayimp.h
- helper functions
ms.assetid: 6279c12c-d908-4967-b0b3-cabfc3e91d3d
ms.openlocfilehash: 3ad193d0101507f43145c6af9f8e6200ab6fcdb5
ms.sourcegitcommit: 8105b7003b89b73b4359644ff4281e1595352dda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2019
ms.locfileid: "57817999"
---
# <a name="understanding-the-helper-function"></a>Понятие вспомогательной функции

Вспомогательная функция для отложенной загрузки, поддерживаемой компоновщика является загружает библиотеку DLL во время выполнения. Вспомогательная функция для настройки его поведения, создав собственную функцию и связывания его в программу, а не с помощью предоставленного вспомогательной функции delayimp.lib. также можно изменить. Одна вспомогательная функция обслуживает все отложенные загрузки библиотек DLL.

Можно предоставить собственную версию вспомогательной функции, если вы хотите выполнять определенную обработку на основе имен библиотеки DLL или импорта.

Вспомогательная функция выполняет следующие действия:

- Сопоставление хранимого дескриптора в библиотеку, чтобы увидеть, если он уже загружен

- Вызовы **LoadLibrary** предпринимается попытка загрузки библиотеки DLL

- Вызовы **GetProcAddress** для попытки получения адреса процедуры

- Возвращает Импорт отложенной загрузки преобразователь для вызова точки входа, загрузить сейчас

Вспомогательная функция может выполнить обратный вызов обработчика уведомлений в приложении после каждого из следующих действий:

- При запуске вспомогательной функции

- Непосредственно перед **LoadLibrary** вызывается вспомогательной функции

- Непосредственно перед **GetProcAddress** вызывается вспомогательной функции

- Если вызов **LoadLibrary** вспомогательной функции не удалось

- Если вызов **GetProcAddress** вспомогательной функции не удалось

- После того как вспомогательная функция завершила обработку

Каждый из этих точек перехвата может возвращать значение, которое будет изменения обычной обработки вспомогательная подпрограмма некоторым способом, кроме возврата преобразователь задержки импорта загрузки.

Вспомогательный код по умолчанию можно найти в Delayhlp.cpp и файл Delayimp.h (в vc\include) и компилируется в библиотекой Delayimp.lib (в vc\lib). Необходимо добавить ее в компиляции необходимо прописать собственной вспомогательной функции.

В следующих разделах описываются вспомогательной функции:

- [Изменения во вспомогательной функции отложенной загрузки библиотеки DLL по сравнению с Visual C++ версии 6.0](changes-in-the-dll-delayed-loading-helper-function-since-visual-cpp-6-0.md)

- [Соглашения о вызовах, параметры и тип возвращаемого значения](calling-conventions-parameters-and-return-type.md)

- [Определения структур и констант](structure-and-constant-definitions.md)

- [Вычисление необходимых значений](calculating-necessary-values.md)

- [Выгрузка библиотеки DLL с отложенной загрузкой](explicitly-unloading-a-delay-loaded-dll.md)

## <a name="see-also"></a>См. также

[Поддержка компоновщика для библиотек DLL с отложенной загрузкой](linker-support-for-delay-loaded-dlls.md)
