---
description: 'Дополнительные сведения: основные сведения о вспомогательной функции'
title: Понятие вспомогательной функции
ms.date: 11/04/2016
helpviewer_keywords:
- delayed loading of DLLs, helper function
- __delayLoadHelper2 function
- delayimp.lib
- __delayLoadHelper function
- delayhlp.cpp
- delayimp.h
- helper functions
ms.assetid: 6279c12c-d908-4967-b0b3-cabfc3e91d3d
ms.openlocfilehash: d47e392d78d6cf872af28b992885c57d34bddf0f
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97247102"
---
# <a name="understanding-the-helper-function"></a>Понятие вспомогательной функции

Вспомогательная функция для отложенной загрузки, поддерживаемой компоновщиком, фактически загружает библиотеку DLL во время выполнения. Можно изменить вспомогательную функцию, чтобы настроить ее поведение, записав собственную функцию и связав ее с программой вместо использования предоставленной вспомогательной функции в Делайимп. lib. Одна вспомогательная функция обслуживает все библиотеки DLL с отложенной загрузкой.

Вы можете предоставить собственную версию вспомогательной функции, если требуется выполнить конкретную обработку на основе имен DLL или импортов.

Вспомогательная функция выполняет следующие действия:

- Проверяет сохраненный обработчик на наличие уже загруженного в библиотеку.

- Вызывает **LoadLibrary** для попыток загрузки библиотеки DLL

- Вызывает **GetProcAddress** , чтобы попытаться получить адрес процедуры

- Возвращает преобразователь отложенных операций импорта для вызова загруженной в данный момент точки входа

Вспомогательная функция может обращаться к обработчику уведомлений в программе после каждого из следующих действий:

- При запуске вспомогательной функции

- Непосредственно перед вызовом **LoadLibrary** в вспомогательной функции

- Непосредственно перед вызовом **GetProcAddress** в вспомогательной функции

- Если вызов **LoadLibrary** в вспомогательной функции завершился ошибкой

- Если вызов **GetProcAddress** в вспомогательной функции завершился ошибкой

- После завершения обработки вспомогательной функции

Каждая из этих точек подключения может возвращать значение, которое будет изменяться при обычной обработке вспомогательной процедуры, за исключением возврата к преобразовательу загрузок с отложенным импортом.

Вспомогательный код по умолчанию можно найти в Делайхлп. cpp и Делайимп. h (в вк\инклуде) и компилируется в Делайимп. lib (в вк\либ). Эту библиотеку необходимо включить в компиляции, если не написать собственную вспомогательную функцию.

В следующих разделах описывается вспомогательная функция:

- [Изменения в вспомогательной функции отложенной загрузки библиотеки DLL с момента Visual C++ 6,0](changes-in-the-dll-delayed-loading-helper-function-since-visual-cpp-6-0.md)

- [Соглашения о вызовах, параметры и тип возвращаемого значения](calling-conventions-parameters-and-return-type.md)

- [Определения структур и констант](structure-and-constant-definitions.md)

- [Вычисление необходимых значений](calculating-necessary-values.md)

- [Выгрузка библиотеки DLL Delay-Loaded](explicitly-unloading-a-delay-loaded-dll.md)

## <a name="see-also"></a>См. также раздел

[Поддержка компоновщика для Delay-Loadedных библиотек DLL](linker-support-for-delay-loaded-dlls.md)
