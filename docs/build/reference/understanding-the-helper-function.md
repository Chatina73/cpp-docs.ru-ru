---
description: Дополнительные сведения о вспомогательной функции отложенной загрузки
title: Общие сведения о вспомогательной функции отложенной загрузки
ms.date: 01/19/2021
helpviewer_keywords:
- delayed loading of DLLs, helper function
- __delayLoadHelper2 function
- delayimp.lib
- __delayLoadHelper function
- delayhlp.cpp
- delayimp.h
- helper functions
ms.openlocfilehash: a4b25a51af25458f5add5ed7eb3fd58f759dae7b
ms.sourcegitcommit: 3d9cfde85df33002e3b3d7f3509ff6a8dc4c0a21
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/21/2021
ms.locfileid: "98667257"
---
# <a name="understand-the-delay-load-helper-function"></a>Общие сведения о вспомогательной функции отложенной загрузки

Вспомогательная функция для отложенной загрузки, поддерживаемой компоновщиком, фактически загружает библиотеку DLL во время выполнения. Вспомогательную функцию можно изменить, чтобы настроить ее поведение: вместо использования предоставляемой вспомогательной функции в *`delayimp.lib`* Создайте собственную функцию и свяжите ее с программой. Одна вспомогательная функция обслуживает все библиотеки DLL с отложенной загрузкой.

Вы можете предоставить собственную версию вспомогательной функции, если требуется выполнить конкретную обработку на основе имен DLL или импортов.

Вспомогательная функция принимает следующие действия:

- Проверяет сохраненный обработчик на наличие уже загруженного в библиотеку.

- Вызовы `LoadLibrary` для попытки загрузки библиотеки DLL

- Вызовы `GetProcAddress` для попыток получения адреса процедуры

- Возвращает преобразователь отложенных операций импорта для вызова загруженной в данный момент точки входа

Вспомогательная функция может обращаться к обработчику уведомлений в программе после каждого из следующих действий:

- При запуске вспомогательной функции

- Непосредственно перед `LoadLibrary` вызовом в вспомогательной функции

- Непосредственно перед `GetProcAddress` вызовом в вспомогательной функции

- Если вызов `LoadLibrary` в вспомогательной функции завершается с ошибкой

- Если вызов `GetProcAddress` в вспомогательной функции завершается с ошибкой

- После завершения обработки вспомогательной функции

Каждая из этих точек ловушки может возвращать значение, которое каким-либо образом изменяет нормальную обработку вспомогательной процедуры, за исключением того, что возвращается к преобразовательу отложенной загрузки импорта.

Вспомогательный код по умолчанию можно найти в *`Delayhlp.cpp`* и *`Delayimp.h`* (в *`include`* каталоге VC) и скомпилировать в *`Delayimp.lib`* (в каталоге VC *`lib`* ). Эту библиотеку необходимо включить в компиляции, если не написать собственную вспомогательную функцию.

В следующих статьях описывается вспомогательная функция:

- [Изменения во вспомогательной функции отложенной загрузки библиотеки DLL по сравнению с Visual C++ версии 6.0](changes-in-the-dll-delayed-loading-helper-function-since-visual-cpp-6-0.md)

- [Соглашения о вызовах, параметры и тип возвращаемого значения](calling-conventions-parameters-and-return-type.md)

- [Определения структур и констант](structure-and-constant-definitions.md)

- [Вычисление необходимых значений](calculating-necessary-values.md)

- [Явная выгрузка библиотеки DLL, загруженной с задержкой](explicitly-unloading-a-delay-loaded-dll.md)

## <a name="see-also"></a>См. также раздел

[Поддержка компоновщика для библиотек DLL с отложенной загрузкой](linker-support-for-delay-loaded-dlls.md)
