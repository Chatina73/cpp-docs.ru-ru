---
description: Дополнительные сведения см. в статье ограничения отложенной загрузки библиотек DLL
title: Ограничения библиотек DLL с отложенной загрузкой
ms.date: 01/19/2021
helpviewer_keywords:
- constraints [C++], delayed loading of DLLs
- delayed loading of DLLs, constraints
- DLLs [C++], constraints
ms.openlocfilehash: 0bc29695aa48fea08a0126d4b814329656a5d3bf
ms.sourcegitcommit: 3d9cfde85df33002e3b3d7f3509ff6a8dc4c0a21
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/21/2021
ms.locfileid: "98666983"
---
# <a name="constraints-of-delay-loading-dlls"></a>Ограничения библиотек DLL с отложенной загрузкой

Существует несколько ограничений на отложенную загрузку импортов DLL.

- Импорт данных не поддерживается. Обходной путь заключается в явной обработке импорта данных с помощью `LoadLibrary` (или `GetModuleHandle` после того, как вы узнаете, что вспомогательная служба отложенной загрузки загрузила библиотеку DLL) и `GetProcAddress` .

- Отложенная загрузка *`Kernel32.dll`* не поддерживается. Эта библиотека DLL должна быть загружена для работы вспомогательных подпрограмм с отложенной загрузкой.

- [Привязка](binding-imports.md) перенаправленных точек входа не поддерживается.

- Процесс может иметь другое поведение, если библиотека DLL загружается с задержкой, а не загружается при запуске. Она может быть видна, если в точке входа в библиотеке DLL с отложенной загрузкой возникают инициализации для каждого процесса. В других случаях — статический протокол TLS (локальное хранилище потока), объявленный с помощью [`__declspec(thread)`](../../cpp/thread.md) , который не обрабатывается при загрузке библиотеки DLL с помощью `LoadLibrary` . Тем не менее, как в статических библиотеках DLL, так и в библиотеках DLL, загружаемых с задержкой, доступна для использования динамическая память TLS, реализуемая с помощью функций `TlsAlloc`, `TlsFree`, `TlsGetValue` и `TlsSetValue`.

- Повторно инициализируйте указатели статических глобальных функций на импортированные функции после первого вызова каждой функции. Это необходимо потому, что первое использование указателя функции указывает на преобразователь, а не на загруженную функцию.

- В настоящее время невозможно отложить загрузку отдельных процедур из библиотеки DLL при использовании стандартного механизма импорта.

- Пользовательские соглашения о вызовах (например, использование кодов условий на архитектурах x86) не поддерживаются. Кроме того, регистры с плавающей запятой не сохраняются на какой-либо платформе. Если пользовательские вспомогательные подпрограммы или подпрограммы-обработчики используют типы с плавающей запятой, им нужно сохранить и восстановить полное состояние с плавающей запятой на компьютерах, использующих соглашения о вызове Register с параметрами с плавающей запятой. Будьте внимательны относительно загрузки DLL CRT, особенно при вызове функций CRT, которые принимают параметры с плавающей запятой в стеке обработчика числовых данных (NDP) в функции справки.

## <a name="see-also"></a>См. также раздел

[Поддержка компоновщика для библиотек DLL с отложенной загрузкой](linker-support-for-delay-loaded-dlls.md)\
[`LoadLibrary` функций](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryw)\
[`GetModuleHandle` функций](/windows/win32/api/libloaderapi/nf-libloaderapi-getmodulehandlew)\
[`GetProcAddress` функций](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress)\
[`TlsAlloc` функций](/windows/win32/api/processthreadsapi/nf-processthreadsapi-tlsalloc)\
[`TlsFree` функций](/windows/win32/api/processthreadsapi/nf-processthreadsapi-tlsfree)\
[`TlsGetValue` функций](/windows/win32/api/processthreadsapi/nf-processthreadsapi-tlsgetvalue)\
[Функция `TlsSetValue`](/windows/win32/api/processthreadsapi/nf-processthreadsapi-tlssetvalue)
