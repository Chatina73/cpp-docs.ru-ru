---
title: /fp (Определение поведения с плавающей запятой)
ms.date: 11/04/2016
f1_keywords:
- VC.Project.VCCLCompilerTool.floatingPointModel
- VC.Project.VCCLWCECompilerTool.FloatingPointExceptions
- /fp
- VC.Project.VCCLWCECompilerTool.floatingPointModel
- VC.Project.VCCLCompilerTool.FloatingPointExceptions
helpviewer_keywords:
- -fp compiler option [C++]
- /fp compiler option [C++]
ms.assetid: 10469d6b-e68b-4268-8075-d073f4f5d57e
ms.openlocfilehash: 8b948edba3244eb22089b2ef5b4c8131736e1fb3
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50452576"
---
# <a name="fp-specify-floating-point-behavior"></a>/fp (Определение поведения с плавающей запятой)

Определяет поведение для чисел с плавающей запятой в файле исходного кода.

## <a name="syntax"></a>Синтаксис

> **/ fp:**[**точное** | **за исключением**[**-**] | **быстрый** | **strict**]

### <a name="arguments"></a>Аргументы

#### <a name="precise"></a>Точный

Значение по умолчанию **/FP** — **/fp: точное**.

**/Fp: точное** флаг улучшает целостность тестов с плавающей запятой на равенство и неравенство путем отключения оптимизаций, которые могут повлиять на точность вычислений с плавающей запятой. (Поддержка определенной точности необходима для строгого соответствия стандарту ANSI.) По умолчанию в коде для x86 архитектур, что x87 сопроцессора инструкции, компилятор использует сопроцессора 80-битной регистры для хранения промежуточных результатов вычислений с плавающей запятой. Это увеличивает быстродействие программы и уменьшает ее объем. Однако, так как в вычислениях используются типы данных с плавающей запятой, которые занимают в памяти менее 80 битов, поддержание дополнительных битов точности вычислений (80 битов минус количество битов в более коротких типах с плавающей запятой) во время длительных вычислений может приводить к недостоверным результатам.

С помощью **/fp: точное** на x86 процессоров, компилятор выполняет округление переменных типа `float` до требуемой точности для назначения и приведения типов и при передаче параметров функции. Такое округление гарантирует, что количество значащих разрядов данных не будет превышать разрядность их типа. Программа скомпилирована с **/fp: точное** может быть медленнее и больше единицы компиляции без **/fp: точное**. **/ fp: точное** отключает встроенные функции; Стандартная библиотека времени выполнения, вместо них используются процедуры. Дополнительные сведения см. в разделе [/Oi (создание встроенных функций)](../../build/reference/oi-generate-intrinsic-functions.md).

Следующие поведения с плавающей запятой включен с **/fp: точное**:

- Сокращение — т. е., использование составной операции, при которой вместо нескольких операций выполняется только одно округление в конце вычислений.

- Не допускаются оптимизации выражений, которые недопустимы для специальных значений (NaN, +бесконечность, -бесконечность, +0, -0). Оптимизация x-x = > 0, x * 0 = > 0, x-0 = > x, x + 0 = > x и 0 x = > - x являются недопустимыми по различным причинам. (См. стандарты IEEE 754 и C99).

- Компилятор правильно обрабатывает сравнения с участием значений NaN. Например, x! = x, результатом которого является **true** Если `x` имеет значение NaN, а упорядоченные сравнения, включающие NaN вызова исключения.

- Вычисление выражений производится в соответствии в методом FLT_EVAL_METHOD=2 стандарта C99 со следующим исключением: при программировании для процессоров x86 в связи с тем, что для сопроцессора FPU задана точность 53 бита, это рассматривается как точность long-double.

- Умножение ровно на 1,0 преобразуется в использование другого множителя. x * y\*1.0 преобразуется x\*y. Аналогичным образом x\*1.0\*y преобразуется x\*y.

- Деление ровно на 1,0 преобразуется в использование делимого. x * y/1.0 преобразуется в x\*y. Аналогичным образом, x / 1.0\*y преобразуется x\*y.

С помощью **/fp: точное** при [fenv_access](../../preprocessor/fenv-access.md) включен отключает оптимизацию, например во время компиляции оценки выражений с плавающей запятой. Например, если вы используете [_control87, _controlfp, \__control87_2](../../c-runtime-library/reference/control87-controlfp-control87-2.md) изменить режим округления и компилятор выполняет вычисления с плавающей запятой, режим округления не действует Если `fenv_access`имеет значение ON.

**/ fp: точное** заменяет **/op** параметр компилятора.

#### <a name="fast"></a>Быстрая

**/Fp:fast** параметр создает самый быстрый код в большинстве случаев, ослабляя правила оптимизации операций с плавающей запятой. Это позволяет компилятору оптимизировать код с плавающей запятой для повышения быстродействия за счет точности и правильности. Когда **/fp:fast** указан, компилятор не может правильно округление в операторах присваивания, приведении типов или вызовы функций и может не производить округление промежуточных выражений. Компилятор может изменять порядок операций или выполнять алгебраические преобразования (например, в соответствии с условиями ассоциативности и дистрибутивности) без учета влияния на конечную точность результатов. Компилятор может заменять операции и операнды на значения одинарной точности вместо применения правил повышения типа в C++. Оптимизации сокращения для значений определенных плавающей запятой всегда включены ([fp_contract](../../preprocessor/fp-contract.md) имеет значение ON). Исключения с плавающей запятой и доступ к сопроцессору FPU отключены (**/fp: except-** подразумевается и [fenv_access](../../preprocessor/fenv-access.md) имеет значение OFF).

**/fp:fast** нельзя использовать с **/fp: strict** или **/fp: точное**. Используется последний параметр, указанный в командной строке. Совместное Указание параметров **/fp:fast** и **/fp: except** приводит к ошибке компилятора.

Указание [/Za, /Ze (отключить расширения языка)](../../build/reference/za-ze-disable-language-extensions.md) (совместимости с ANSI) и **/fp:fast** может привести к непредвиденному поведению. Например, операции с плавающей запятой одиночной точности могут не округляться до одинарной точности.

#### <a name="except"></a>except

**/Fp: except** параметр позволяет использовать модель reliable исключения с плавающей запятой. Исключения вызываются незамедлительно после запуска. По умолчанию этот параметр выключен. Добавление знака минус параметру (**/fp: except-**) явно отключает его.

#### <a name="strict"></a>strict

**/Fp: strict** параметр включает строгий модель с плавающей запятой. **/ fp: strict** вызывает [fp_contract](../../preprocessor/fp-contract.md) Чтобы задать значение OFF и [fenv_access](../../preprocessor/fenv-access.md) должен быть включен. **/ fp: за исключением** подразумевается и может быть отключена, явно указав **/fp: except-**. При использовании с **/fp: except-**, **/fp: strict** применяет строгую семантику с плавающей запятой, но без учета исключительных событий.

## <a name="remarks"></a>Примечания

Несколько **/FP** параметры можно указать в одной компиляции.

Для контроля поведения с плавающей запятой функцией, см. в разделе [float_control](../../preprocessor/float-control.md) директивы pragma. Это значение переопределяет **/FP** параметр компилятора. Рекомендуется сохранять и восстанавливать локальное поведение вычислений с плавающей точкой:

```cpp
#pragma float_control(precise, on, push)
// Code that uses /fp:precise mode
#pragma float_control(pop)
```

Большинство оптимизации с плавающей запятой относятся к **/fp: strict**, **/fp: except** (и соответствующими директивами pragma) и `fp_contract` директивы pragma зависят от компьютера. **/ fp: strict** и **/fp: except** не совместимы с **/CLR**.

**/ fp: точное** удовлетворяет большинству требований с плавающей запятой для приложения. Можно использовать **/fp: except** и **/fp: strict**, но возможно некоторое снижение производительности. Если производительность является наиболее важным фактором, рассмотрите возможность использования **/fp:fast**.

**/ fp: strict**, **/fp:fast**, и **/fp: точное** — режимы точности (правильности). Одновременно можно использовать только один из них. Если оба **/fp: strict** и **/fp: точное** указаны, компилятор использует тот, который обрабатывается последним. Оба **/fp: strict** и **/fp:fast** нельзя использовать.

Дополнительные сведения см. в разделе [Microsoft Visual C++ с плавающей запятой оптимизации](floating-point-optimization.md).

### <a name="to-set-this-compiler-option-in-the-visual-studio-development-environment"></a>Установка данного параметра компилятора в среде разработки Visual Studio

1. Откройте диалоговое окно **Страницы свойств** проекта. Дополнительные сведения см. в разделе [Работа со свойствами проекта](../../ide/working-with-project-properties.md).

1. Разверните **свойства конфигурации** > **C/C++** > **создание кода** страницу свойств.

1. Изменить **модель с плавающей запятой** свойство.

### <a name="to-set-this-compiler-option-programmatically"></a>Установка данного параметра компилятора программным способом

- См. раздел <xref:Microsoft.VisualStudio.VCProjectEngine.VCCLCompilerTool.floatingPointModel%2A>.

## <a name="see-also"></a>См. также

- [Параметры компилятора](compiler-options.md)
- [Настройка параметров компилятора](setting-compiler-options.md)
- [Microsoft Visual C++ с плавающей запятой оптимизация](floating-point-optimization.md)