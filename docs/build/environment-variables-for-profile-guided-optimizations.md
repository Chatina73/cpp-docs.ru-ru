---
title: Переменные среды для профильной оптимизации
ms.date: 03/14/2018
helpviewer_keywords:
- profile-guided optimizations, environment variables
ms.assetid: f95a6d1e-49a4-4802-a144-092026b600a3
ms.openlocfilehash: 099e57f1ac69223adafe7bec1af4cc3452915e86
ms.sourcegitcommit: 8105b7003b89b73b4359644ff4281e1595352dda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/14/2019
ms.locfileid: "57827506"
---
# <a name="environment-variables-for-profile-guided-optimizations"></a>Переменные среды для профильной оптимизации

Существует три переменные среды, которые влияют на сценарии тестирования на изображении, созданных с помощью **/LTCG: PGI** для профильной оптимизации:

- **PogoSafeMode** указывает, следует ли использовать быстрый режим или безопасный режим для профилирования приложения.

- **VCPROFILE_ALLOC_SCALE** добавляет дополнительную память для использования профилировщиком.

- **VCPROFILE_PATH** позволяет указать папку для файлов .pgc.

**PogoSafeMode и VCPROFILE_ALLOC_SCALE переменные среды являются устаревшими, начиная с Visual Studio 2015.** Параметры компоновщика [/genprofile или/fastgenprofile](reference/genprofile-fastgenprofile-generate-profiling-instrumented-build.md) и [/useprofile](reference/useprofile.md) определяют аналогичное поведение компоновщика, как эти переменные среды.

## <a name="pogosafemode"></a>PogoSafeMode

Эта переменная среды является устаревшим. Используйте **EXACT** или **NOEXACT** аргументы **/genprofile** или **/fastgenprofile** чтобы контролировать это поведение.

Снимите или установите **PogoSafeMode** переменную среды, чтобы указать, следует ли использовать быстрый режим или безопасный режим для профилирования приложения на x86 систем.

Профильная оптимизация (PGO) есть два возможных режима профилирования на этапе: *быстрый режим* и *безопасный режим*. При профилировании в быстром режиме, она использует **INC** инструкции для увеличения счетчиков данных. **INC** инструкция выполняется быстрее, но не является поточно ориентированной. При профилировании в безопасном режиме, она использует **LOCK INC** инструкции для увеличения счетчиков данных. **LOCK INC** инструкция имеет ту же функциональность, что **INC** имеет и является поточно ориентированной, но работает медленнее, чем **INC** инструкции.

По умолчанию профилирование вероятностного Оптимизатора работает в быстром режиме. **PogoSafeMode** — требуется, только если вы хотите использовать безопасный режим.

Чтобы запустить профилирование вероятностного Оптимизатора в безопасном режиме, необходимо использовать переменную среды **PogoSafeMode** или параметр компоновщика **/PogoSafeMode**, в зависимости от системы. При выполнении профилирования на x x64 компьютера, необходимо использовать параметр компоновщика. При выполнении профилирования на x86 компьютера, вы можете использовать компоновщик переключения или задать **PogoSafeMode** переменной среды любое значение перед началом процесса оптимизации.

### <a name="pogosafemode-syntax"></a>Синтаксис PogoSafeMode

> **Задайте PogoSafeMode**[**=**_значение_]

Задайте **PogoSafeMode** любое значение, чтобы включить безопасный режим. Задайте без значения для очистки предыдущее значение и повторно включить быстрый режим.

## <a name="vcprofileallocscale"></a>VCPROFILE_ALLOC_SCALE

Эта переменная среды является устаревшим. Используйте **MEMMIN** и **MEMMAX** аргументы **/genprofile** или **/fastgenprofile** чтобы контролировать это поведение.

Изменить **VCPROFILE_ALLOC_SCALE** переменную среды, чтобы изменить объем памяти, выделенного для хранения данных профиля. В редких случаях не будет достаточно памяти для сбора данных профиля, при выполнении сценариев тестирования. В таких случаях можно увеличить объем памяти, задав **VCPROFILE_ALLOC_SCALE**. Если появится сообщение об ошибке во время выполнения теста, который указывает на наличие нехватки памяти, назначить большее значение для **VCPROFILE_ALLOC_SCALE**, пока не завершить без ошибок из за памяти.

### <a name="vcprofileallocscale-syntax"></a>VCPROFILE_ALLOC_SCALE синтаксис

> **set VCPROFILE_ALLOC_SCALE**[__=__*scale_value*]

*Scale_value* параметр является коэффициентом объема памяти, необходимой для запуска сценариев тестирования.  Значение по умолчанию — 1. Например эта командная строка задает коэффициент масштабирования 2:

`set VCPROFILE_ALLOC_SCALE=2`

## <a name="vcprofilepath"></a>VCPROFILE_PATH

Используйте **VCPROFILE_PATH** переменную среды для указания каталога, чтобы создать PGC-файлы. По умолчанию PGC-файлы создаются в том же каталоге, что и профилируемый двоичный файл. Тем не менее, если абсолютный путь двоичного файла не существует, а может оказаться так, при запуске сценариев профиля на компьютере, отличном от где была выполнена сборка двоичного файла, можно задать **VCPROFILE_PATH** путь, который существует на целевом компьютере.

### <a name="vcprofilepath-syntax"></a>Синтаксис VCPROFILE_PATH

> **Задайте VCPROFILE_PATH**[**=**_путь_]

Задайте *путь* параметра путь к каталогу, в который нужно добавить PGC-файлы. Например эта командная строка задает папку для C:\profile:

`set VCPROFILE_PATH=c:\profile`

## <a name="see-also"></a>См. также

[Профильная оптимизация](profile-guided-optimizations.md)<br/>
[/ GENPROFILE и/fastgenprofile](reference/genprofile-fastgenprofile-generate-profiling-instrumented-build.md)<br/>
[/USEPROFILE](reference/useprofile.md)<br/>
