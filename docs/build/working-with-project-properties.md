---
title: Настройка свойств компилятора C++ и сборки в Visual Studio
description: Используйте интегрированную среду разработки Visual Studio, чтобы изменить параметры компилятора и компоновщика C++, а также другие параметры сборки.
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], modifying
- properties [C++]
- Visual C++ projects, properties
- projects [C++], properties
ms.assetid: 9b0d6f8b-7d4e-4e61-aa75-7d14944816cd
ms.openlocfilehash: 6c05dd00324113819dd145e46bf10dfeb96a66a3
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80078234"
---
# <a name="set-compiler-and-build-properties"></a>Настройка компилятора и свойств сборки

В интегрированной среде разработки все сведения, необходимые для сборки проекта, представлены в виде *свойств*. Эти сведения включают в себя имя приложения, расширение (например, DLL, EXE, LIB), параметры компилятора, параметры компоновщика, параметры отладчика, настраиваемые этапы сборки и многие другие компоненты. Как правило, для просмотра и изменения этих свойств используются *страницы свойств*. Чтобы перейти к страницам свойств, в главном меню выберите **Проект** >  **_Свойства_ имя_проекта** или щелкните правой кнопкой мыши узел проекта в **обозревателе решений** и выберите пункт **Свойства**.

## <a name="default-properties"></a>Свойства по умолчанию

При создании проекта система задает значения для различных свойств. Значения по умолчанию варьируются в зависимости от типа проекта и параметров, выбранных в мастере приложений. Например, проект ATL имеет свойства, относящиеся к файлам MIDL, но в базовом консольном приложении они отсутствуют. В области "Общие" на страницах свойств отображаются свойства по умолчанию:

![Значения по умолчанию для проекта Visual C&#43;&#43;](media/visual-c---project-defaults.png "Значения по умолчанию для проекта Visual C++")

## <a name="applying-properties-to-build-configurations-and-target-platforms"></a>Применение свойств к конфигурациям сборок и целевым платформам

Некоторые свойства, такие как имя приложения, применяются ко всем вариантам сборки, независимо от целевой платформы и того, предназначена ли эта сборка для отладки или выпуска. Однако большинство свойств зависит от конфигурации. Это вызвано тем, что компилятор должен знать, на какой именно платформе будет запускаться программа и какие именно параметры компилятора нужно использовать для создания правильного кода. Таким образом, при установке свойства важно следить за тем, для какой конфигурации и платформы должно применяться новое значение. Нужно ли применить его только для сборок отладки Win32 либо еще и для сборок отладки ARM и отладки x64? Например, свойство **Оптимизации** по умолчанию имеет значение **Наибольшая скорость (/O2)** в конфигурации выпуска, но отключено в конфигурации отладки.

Страницы свойств разработаны таким образом, чтобы вы всегда могли просмотреть и при необходимости изменить конфигурацию и платформу, к которым относится значение свойства. На следующем рисунке показаны страницы свойств со сведениями о конфигурации и платформе в расположенных сверху списках. Когда свойство **Оптимизация** задано здесь, оно применяется только к сборкам отладки Win32, что является активной конфигурацией, как показано красными стрелками.

![Страницы свойств Visual C, &#43; &#43; со сведениями об активной конфигурации](media/visual-c---property-pages-showing-active-configuration.png "Страницы свойств Visual C++ со сведениями об активной конфигурации")

На следующем рисунке показана та же страница свойств проекта, но конфигурация изменена на выпуск. Обратите внимание на другое значение для свойства "Оптимизация". Кроме того, обратите внимание, что активной конфигурацией по-прежнему является отладка. Здесь вы можете задать свойства для любой конфигурации, а не только активной.

![Страницы свойств Visual C, &#43; &#43; со сведениями о конфигурации выпуска](media/visual-c---property-pages-showing-release-config.png "Страницы свойств Visual C++ со сведениями о конфигурации выпуска")

## <a name="target-platforms"></a>Целевые платформы

*Целевая платформа* обозначает тип устройства и/или операционной системы, где будет запускаться исполняемый файл. Вы можете создать проект для нескольких платформ. Доступные целевые платформы для проектов C++ зависят от вида проекта. Среди прочего, к ним относятся Win32, x64, ARM, Android и iOS.     Целевая платформа **X86**, которую вы могли заметить в **Configuration Manager**, идентична **Win32** в собственных проектах C++. Win32 означает 32-разрядную версию Windows, а **x64** — 64-разрядную. Дополнительные сведения об этих двух платформах см. в разделе [Запуск 32-разрядных приложений](/windows/win32/WinProg64/running-32-bit-applications).

Значение целевой платформы **Любой ЦП**, которые вы могли заметить в **Configuration Manager**, не влияет на собственные проекты C++; оно применяется к C+ +/CLI и другим типам проектов .NET. Дополнительные сведения см. в разделе [Параметр /CLRIMAGETYPE (указание типа образа среды CLR)](reference/clrimagetype-specify-type-of-clr-image.md).

Дополнительные сведения настройке свойств отладочной сборки см. в следующих разделах:

- [Параметры проекта для конфигурации отладки C++](/visualstudio/debugger/project-settings-for-a-cpp-debug-configuration)
- [Параметры отладчика и подготовка](/visualstudio/debugger/debugger-settings-and-preparation)
- [Подготовка к отладке: типы проектов Visual C++](/visualstudio/debugger/debugging-preparation-visual-cpp-project-types)
- [Указание файлов символов (PDB) и файлов с исходным кодом в отладчике Visual Studio](/visualstudio/debugger/specify-symbol-dot-pdb-and-source-files-in-the-visual-studio-debugger)

## <a name="c-compiler-and-linker-options"></a>Параметры компилятора и компоновщика C++

Параметры компилятора и компоновщика C++ находятся в узлах **C/C++** и **Компоновщик** на панели слева в разделе **Свойства конфигурации**. Эти данные преобразуются непосредственно в параметры командной строки, которые будут переданы компилятору. Чтобы ознакомиться с документацией по конкретному параметру, выберите параметр в центральной области и нажмите клавишу **F1**. Также можно просмотреть документацию по всем параметрам в разделах [Параметры компилятора MSVC](reference/compiler-options.md) и [Параметры компоновщика MSVC](reference/linker-options.md).

В диалоговом окне **Страницы свойств** отображаются только страницы свойств, относящиеся к текущему проекту. Например, если проект не содержит IDL-файл, страница свойств MIDL не отображается. Дополнительные сведения о параметрах на страницах свойств см. в разделе [Страницы свойств (C++)](reference/property-pages-visual-cpp.md).

## <a name="directory-and-path-values"></a>Значения каталога и пути

MSBuild поддерживает использование констант времени компиляции, называемых "макросами", для определенных строковых значений, включая каталоги и пути. Они представлены на страницах свойств, на которых можно просмотреть и изменить их с помощью [редактора свойств](#property_editor).

На следующем рисунке показаны страницы свойств для проекта Visual Studio C++. В области слева выбрано *правило* **Каталоги VC++** , а в области справа отображаются свойства, связанные с этим правилом. Значения `$(...)` называются *макросами*. *Макрос* является константой времени компиляции, которая может ссылаться на значение, определенное Visual Studio или системой MSBuild, или пользовательское значение. Использование макросов вместо жестко заданных значений, таких как пути к каталогам, упрощает совместное использование параметров свойств на разных компьютерах и в разных версиях Visual Studio, а также позволяет гарантировать, что параметры проекта правильно участвуют в [наследовании свойств](project-property-inheritance.md).

![Страницы свойств проекта](media/project_property_pages_vc.png "Project_Property_Pages_VC")

Для просмотра значений всех доступных макросов можно использовать редактор свойств.

### <a name="predefined-macros"></a>Предустановленные макросы

*глобальные макросы*<br/>
Применяются ко всем элементам в конфигурации проекта. Синтаксис: `$(name)`. Пример глобального макроса — свойство `$(VCInstallDir)`, которое сохраняет корневой каталог установки Visual Studio. Глобальный макрос соответствует элементу `PropertyGroup` в MSBuild.

*макросы элементов*<br/>
Синтаксис: `%(name)`. В случае файла макрос элемента применяется только к этому файлу — для примера можно использовать `%(AdditionalIncludeDirectories)`, чтобы определить каталоги, которые применяются только к конкретному файлу. Этот тип макроса элемента соответствует метаданным `ItemGroup` в MSBuild. При использовании в контексте конфигурации проекта макрос элемента применяется ко всем файлам определенного типа. Например, свойство конфигурации C/C++ **Определения препроцессора** может принимать макрос элемента `%(PreprocessorDefinitions)`, который применяется ко всем CPP-файлам в проекте. Этот тип макроса элемента соответствует метаданным `ItemDefinitionGroup` в MSBuild. Дополнительные сведения см. в разделе [Определения элементов](/visualstudio/msbuild/item-definitions).

### <a name="user-defined-macros"></a>Пользовательские макросы

Вы можете создавать *пользовательские макросы* для использования в качестве переменных в сборках проекта. Например, можно создать пользовательский макрос, предоставляющий значение пользовательскому шагу сборки или пользовательскому средству сборки. Пользовательский макрос — это пара "имя-значение". Для доступа к этому значению в файле проекта можно использовать нотацию **$(** <em>name</em> **)** .

Пользовательский макрос хранится на странице свойств. Если проект еще не содержит страницу свойств, можно создать ее, выполнив одно из действий, описанных в разделе [Совместное или повторное использование параметров проекта Visual Studio](create-reusable-property-configurations.md).

#### <a name="to-create-a-user-defined-macro"></a>Создание пользовательского макроса

1. Откройте окно **Диспетчер свойств**. (В строке меню выберите **Вид** > **Диспетчер свойств** или **Вид** > **Другие окна** > **Диспетчер свойств**.) Откройте контекстное меню для страницы свойств (ее имя оканчивается на ".user"), а затем выберите **Свойства**. Откроется диалоговое окно **Страницы свойств** для данной страницы свойств.

1. В левой области диалогового окна выберите **Пользовательские макросы**. В правой области нажмите кнопку **Добавить макрос**, чтобы открыть диалоговое окно **Добавление пользовательского макроса**.

1. В диалоговом окне задайте имя и значение для макроса. Кроме того, можно установить флажок **Задание данного макроса в качестве переменной среды в среде сборки**.

## <a name=""></a><a name="property_editor">Редактор свойств</a>

Редактор свойств можно использовать для изменения некоторых строковых свойств и выбора макросов в качестве значений. Чтобы открыть редактор свойств, выберите свойство на странице свойств, а затем нажмите кнопку со стрелкой вниз справа. Если раскрывающийся список содержит команду **\<Изменить>** , можно выбрать ее, чтобы открыть редактор свойств для данного свойства.

![Раскрывающийся список редактора свойств](media/property_editor_dropdown.png "Property_Editor_Dropdown")

В редакторе свойств можно нажать кнопку **Макросы**, чтобы просмотреть доступные макросы и их текущие значения. На следующем рисунке показан редактор свойств для свойства **Дополнительные каталоги включаемых файлов** после нажатия кнопки **Макросы**. Если вы добавляете новое значение, когда установлен флажок **Наследовать от родителя или от значений по умолчанию для проекта**, оно добавляется ко всем значениям, которые в данный момент наследуются. Если снять флажок, новое значение заменяет наследуемые значения. В большинстве случаев следует не снимать этот флажок.

![Редактор свойств, Visual C&#43;&#43;](media/propertyeditorvc.png "PropertyEditorVC")

## <a name="add-an-include-directory-to-the-set-of-default-directories"></a>Добавление каталога включения к набору каталогов по умолчанию

При добавлении каталога включения в проект важно не переопределить все каталоги по умолчанию. Правильный способ добавления каталога — добавить новый путь, например "C:\MyNewIncludeDir\", и затем добавить макрос **$(IncludePath)** к значению свойства.

## <a name="quickly-browse-and-search-all-properties"></a>Быстрый просмотр и поиск всех свойств

Страница свойств **Все параметры** (в узле **Свойства конфигурации &#124; C/C++** диалогового окна **Страницы свойств**) позволяет быстро просмотреть и найти свойства, доступные в текущем контексте. Она имеет специальное поле поиска и простой синтаксис, который помогает отфильтровать результаты.

Без префикса:<br/>
поиск только в именах свойств (подстрока без учета регистра).

"/" или "-":<br/>
поиск только в параметрах компилятора (префикс без учета регистра)

v:<br/>
поиск только в значениях (подстрока без учета регистра).

## <a name="set-environment-variables-for-a-build"></a>Задание переменных среды для сборки

Компилятор MSVC (cl.exe) распознает определенные переменные среды, в частности LIB, LIBPATH, PATH и INCLUDE. При сборке с помощью интегрированной среды разработки для задания этих переменных среды используются свойства, заданные на странице свойств [Каталоги VC++](reference/vcpp-directories-property-page.md). Если значения LIB, LIBPATH, и ВКЛЮЧАЕТ уже заданы, например с помощью командной строки разработчика, они заменяются значениями соответствующих свойств MSBuild. Сборка затем добавляет значение свойства каталогов исполняемых файлов "Каталоги VC++" в начало переменной PATH. Для задания пользовательской переменной среды можно создать пользовательский макрос и затем установить флажок **Задание данного макроса в качестве переменной среды в среде сборки**.

## <a name="set-environment-variables-for-a-debugging-session"></a>Задание переменных среды для сеанса отладки

В левой области диалогового окна **Страницы свойств** проекта разверните узел **Свойства конфигурации** и выберите пункт **Отладка**.

В правой области измените параметры проекта **Среда** или **Объединение среды**, а затем нажмите кнопку **ОК**.

## <a name="in-this-section"></a>Содержание раздела

[Совместное или повторное использование параметров проекта Visual Studio](create-reusable-property-configurations.md)<br/>
Создание файла PROPS с настраиваемыми параметрами сборки, которые можно использовать совместно или повторно.

[Наследование свойств проекта](project-property-inheritance.md)<br/>
Описывается порядок вычисления для файлов PROPS, TARGETS, VCXPROJ и переменных среды в процессе сборки.

[Изменение свойств и целевых объектов без изменения файла проекта](modify-project-properties-without-changing-project-file.md)<br/>
Создание временных параметров сборки без изменения файла проекта.

## <a name="see-also"></a>См. также

[Проекты Visual Studio — C++](creating-and-managing-visual-cpp-projects.md)<br/>
[Структура файлов VCXPROJ и PROPS](reference/vcxproj-file-structure.md)<br/>
[XML-файлы страницы свойств](reference/property-page-xml-files.md)<br/>
