---
title: Построение параллельных сборок C/C++
ms.date: 11/04/2016
helpviewer_keywords:
- side-by-side applications [C++]
ms.assetid: 7fa20b16-3737-4f76-a0b5-1dacea19a1e8
ms.openlocfilehash: b904dd3e9c10470151bdb8e01435aaf6359179b8
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2018
ms.locfileid: "51693670"
---
# <a name="building-cc-side-by-side-assemblies"></a>Построение параллельных сборок C/C++

Объект [side-by-side сборки](/windows/desktop/SbsCs/about-side-by-side-assemblies-) — это коллекция ресурсов — группу библиотек DLL, классов окон, серверов COM, библиотек типов или интерфейсов, доступных для приложения для использования во время выполнения. Основное преимущество упаковки библиотек DLL в сборках, — что несколько версий сборки может использоваться приложениями в то же время, и существует возможность обслуживания установленных сборок при выпуске обновлений.

Приложения Visual C++ может использовать одну или несколько библиотек DLL в различных частях приложения. Во время выполнения библиотеки DLL загружаются в основной процесс, и выполняется требуемый код. Приложение зависит от операционной системы, чтобы поиск запрашиваемых, понять, что другие зависимые библиотеки DLL нужно загрузить, а затем загружать их вместе с запрошенной библиотеки DLL. В версиях операционных систем Windows более ранних, чем Windows XP, Windows Server 2003 и Windows Vista, загрузчик операционной системы выполняет поиск зависимые библиотеки DLL в локальной папке приложения или в другой папке, указанной в системном пути. В Windows XP, Windows Server 2003 и Windows Vista, загрузчик операционной системы можно также найти зависимые библиотеки DLL с помощью [манифеста](/windows/desktop/sbscs/manifests) файл и выполните поиск side-by-side сборки, содержащие эти библиотеки DLL.

По умолчанию при построении библиотеки DLL с помощью Visual Studio, он имеет [манифест приложения](/windows/desktop/SbsCs/application-manifests) embedded как ресурс RT_MANIFEST с Идентификатором, равным 2. Так же как и исполняемый файл этот манифест описывает зависимости этой библиотеки DLL, от других сборок. Предполагается, что библиотеки DLL не является частью сборки side-by-side и приложений, которые зависят от этой библиотеки DLL не будет использоваться манифест приложения загрузить ее, но вместо этого основываются на загрузчик операционной системы, чтобы найти эту библиотеку DLL в системном пути.

> [!NOTE]
> Очень важно для библиотеки DLL, который использует манифест приложения для манифеста, внедренного как ресурс с Идентификатором, равным 2. Если библиотека DLL загружается динамически во время выполнения (например, с помощью [LoadLibrary](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) функции), загрузчик операционной системы загружает зависимые сборки, указанные в манифесте библиотеки DLL. Манифест внешние приложения для библиотек DLL не проверяется во время `LoadLibrary` вызова. Если манифест не внедрен, загрузчик может попытаться загрузить неправильных версий сборки или вызвать сбой в поиске зависимых сборок.

Одну или несколько связанных библиотек DLL можно упаковать в сборку side-by-side с соответствующими [манифест сборки](/windows/desktop/SbsCs/assembly-manifests), которая описывает, какие файлы форме сборки, а также зависимость сборки на других side-by-side сборки.

> [!NOTE]
> Если сборка содержит одна библиотека DLL, рекомендуется внедрить манифест в эту библиотеку DLL как ресурс с Идентификатором, равным 1, а также присвоить закрытой сборке имя, совпадающее с именем библиотеки DLL. Например, если имя библиотеки DLL mylibrary.dll, значение атрибута name используется при \<assemblyIdentity > манифеста может также быть mylibrary. В некоторых случаях, когда библиотека имеет расширением, отличным от DLL-файл (например, в проект элементы управления ActiveX в MFC создает библиотек OCX) можно создать внешний манифест. В этом случае имя сборки и его манифест должен отличаться от имени библиотеки DLL (например, MyAssembly, MyAssembly.manifest и mylibrary.ocx). Тем не менее по-прежнему рекомендуется присваивать таким библиотекам расширение DLL и внедрить манифест в качестве ресурса для сокращения затрат последующее обслуживание этой сборки. Дополнительные сведения о том, как операционная система выполняет поиск закрытых сборок, см. в разделе [порядок поиска сборки](/windows/desktop/SbsCs/assembly-searching-sequence).

Это изменение позволит развертывать соответствующие библиотеки DLL, как [закрытая сборка](/windows/desktop/Msi/private-assemblies) в локальной папке приложения или в качестве [общие сборки](/windows/desktop/Msi/shared-assemblies) в кэше сборок WinSxS. Несколько шагов нужно выполнить, чтобы добиться такого поведения нужная среда выполнения новой сборки; они описаны в [рекомендации по созданию Side-by-side сборок](/windows/desktop/SbsCs/guidelines-for-creating-side-by-side-assemblies). После сборки правильности его можно развернуть как либо является совместно используемой или закрытой сборкой вместе с приложением, которое зависит от его. При установке сборки side-by-side как общую, вы можете либо выполните описанные рекомендации в [Установка сборок Win32 для общего использования Side-by-Side в Windows XP](/windows/desktop/Msi/installing-win32-assemblies-for-side-by-side-sharing-on-windows-xp) или использовать [модулислияния](/windows/desktop/msi/merge-modules). При установке сборки side-by-side как закрытая сборка, вы можете просто скопировать соответствующие библиотеки DLL, ресурсы и манифест как часть процесса установки в локальной папке приложения на целевом компьютере, гарантируя, что эта сборка может быть найден загрузчик во время выполнения (см. в разделе [порядок поиска сборки](/windows/desktop/SbsCs/assembly-searching-sequence)). Другим способом является использование [установщика Windows](/windows/desktop/Msi/windows-installer-portal) и следуйте инструкциям, описанным в [Установка сборок Win32 для закрытого использования приложения на Windows XP](/windows/desktop/Msi/installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp).

## <a name="see-also"></a>См. также

[Примеры развертывания](../ide/deployment-examples.md)<br/>
[Создание изолированных приложений на C/C++](../build/building-c-cpp-isolated-applications.md)<br/>
[Создание изолированных приложений и параллельных сборок C/C++](../build/building-c-cpp-isolated-applications-and-side-by-side-assemblies.md)