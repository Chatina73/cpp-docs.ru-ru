---
title: Совместимость на уровне двоичного кода C++ 2015–2019
description: Описывает, как работает двоичная совместимость C++ между скомпилированными файлами в Visual Studio 2015, 2017 и 2019. Один распространяемый C++ пакет Microsoft Visual работает для всех трех версий.
ms.date: 11/18/2019
helpviewer_keywords:
- binary compatibility, Visual C++
ms.assetid: 591580f6-3181-4bbe-8ac3-f4fbaca949e6
ms.openlocfilehash: b729cdcc4a494e60ec58314fe23b02c1816e8412
ms.sourcegitcommit: 217fac22604639ebd62d366a69e6071ad5b724ac
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/19/2019
ms.locfileid: "74188791"
---
# <a name="c-binary-compatibility-between-visual-studio-2015-2017-and-2019"></a>C++Двоичная совместимость между Visual Studio 2015, 2017 и 2019

Наборы инструментов C++ компилятора Microsoft (компилятором MSVC) в Visual Studio 2013 и более ранних версий не гарантируют двоичную совместимость между версиями. Нельзя связывать объекты, статические библиотеки, динамические библиотеки и исполняемые файлы, созданные разными версиями. ABI, форматы объектов и библиотеки времени выполнения несовместимы.

Мы изменили это поведение в Visual Studio 2015, 2017 и 2019. Библиотеки среды выполнения и приложения, компилируемые любой из этих версий компилятора, совместимы с двоичными. Он отражается в основном C++ номере набора инструментов, который равен 14 для всех трех версий. (Версия набора инструментов — V140 для Visual Studio 2015, v141 для 2017 и v142 для 2019). Предположим, у вас есть сторонние библиотеки, созданные Visual Studio 2015. Их все еще можно использовать в приложении, созданном с помощью Visual Studio 2017 или 2019. Нет необходимости выполнять повторную компиляцию с соответствующим набором инструментов. Последняя версия распространяемого пакета Microsoft Visual C++ (распространяемый пакет) работает для всех из них.

Существуют три важных ограничения на двоичную совместимость.

- Можно смешивать двоичные файлы, созданные разными версиями набора инструментов. Однако для связывания приложения необходимо использовать набор инструментов по крайней мере как последний двоичный файл. Вот пример: вы можете связать приложение, скомпилированное с помощью набора инструментов 2017, со статической библиотекой, скомпилированной с помощью 2019, если они связаны с помощью набора инструментов 2019.

- Распространяемое приложение использует аналогичное ограничение двоичной совместимости. При смешении двоичных файлов, созданных различными поддерживаемыми версиями набора инструментов, распространяемая версия должна быть по крайней мере новым набором инструментов, используемых любым компонентом приложения.

- Статические библиотеки или объектные файлы, скомпилированные с помощью параметра компилятора [/GL (оптимизация всей программы)](../build/reference/gl-whole-program-optimization.md) , *не* поддерживают двоичную совместимость в разных версиях. Все объектные файлы и библиотеки, скомпилированные с помощью `/GL`, должны использовать точно такой же набор инструментов для компиляции и последней ссылки.

## <a name="upgrade-the-microsoft-visual-c-redistributable-from-visual-studio-2015-or-2017-to-visual-studio-2019"></a>Обновление распространяемого пакета C++ Microsoft визуального элемента с visual Studio 2015 или 2017 до visual Studio 2019

Мы сохранили основной номер версии C++ распространяемого пакета Microsoft visual Studio 2015, 2017 и 2019. Это означает, что одновременно можно установить только один экземпляр распространяемого компонента. Более новая версия перезаписывает любую старую версию, которая уже установлена. Например, одно приложение может установить распространяемый пакет из Visual Studio 2015. Затем другое приложение устанавливает распространяемый пакет из Visual Studio 2019. Версия 2019 перезаписывает старую версию, но, поскольку они совместимы с двоичными, приложение по-прежнему работает нормально. Убедитесь, что последняя версия распространяемого пакета содержит все новейшие функции, обновления для системы безопасности и исправления ошибок. Поэтому мы всегда рекомендуем выполнить обновление до последней доступной версии.

Аналогичным образом, нельзя установить более старый распространяемый компонент, если уже установлена более новая версия. Установщик сообщает об ошибке при попытке. Если установить распространяемый пакет 2015 или 2017 на компьютере, на котором уже установлена версия 2019, вы увидите следующее сообщение об ошибке:

```Output
0x80070666 - Another version of this product is already installed. Installation of this version cannot continue. To configure or remove the existing version of this product, use Add/Remove Programs on the Control Panel.
```

Эта ошибка возникает при проектировании. Рекомендуется установить последнюю версию. Убедитесь, что установщик может автоматически восстановиться после этой ошибки.

## <a name="see-also"></a>См. также:

[\ C++ журнала изменений визуальных элементов](../porting/visual-cpp-change-history-2003-2015.md)
[Последние поддерживаемые загружаемые C++ файлы для визуализации](https://support.microsoft.com/help/2977003/the-latest-supported-visual-c-downloads)
