---
title: Руководство по переносу и обновлению Visual C++ | Документы Майкрософт
ms.custom: ''
ms.date: 09/18/2018
ms.technology:
- cpp-language
ms.topic: conceptual
dev_langs:
- C++
ms.assetid: f5fbcc3d-aa72-41a6-ad9a-a706af2166fb
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: ed94830a2a048f6706371ed7a88a706d7df04ab7
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50079848"
---
# <a name="visual-c-porting-and-upgrading-guide"></a>Руководство по переносу и обновлению Visual C++

В этом разделе содержится руководство по обновлению кода Visual C++. В нем рассматриваются такие вопросы, как получение кода для компиляции и корректной работы в новом выпуске инструментов, а также эффективное применение нового языка и функций Visual Studio. В этом разделе также содержатся сведения о миграции приложений прежних версий на более современные платформы.

## <a name="reasons-to-upgrade-visual-c-code"></a>Причины обновления кода Visual C++

Возможность обновления кода следует рассматривать по следующим причинам.

- Более быстрый код благодаря улучшенной оптимизации компилятора.

- Более быстрые сборки благодаря повышению производительности компилятора.

- Улучшенное соответствие стандартам. Теперь в Visual C++ реализованы многие возможности из последних стандартов C++.

- Более высокий уровень безопасности. Возможности безопасности, например проверка защиты.

### <a name="porting-your-code"></a>Перенос кода

При обновлении сначала следует рассмотреть код приложения и проекты. Приложение построено с помощью Visual Studio? Если это так, определите задействованные проекты.  Есть ли у вас пользовательские скрипты сборки? Если вместо системы сборки Visual Studio вы применяете пользовательские скрипты сборки, вам придется выполнить больше работы и потратить больше времени при обновлении, так как вы не сможете использовать Visual Studio для обновления файлов проекта и параметров сборки.

Формат системы сборки и файлов проектов в Visual Studio изменился с vcbuild, который применялся в версиях до Visual Studio 2008, на MSBuild, который используется начиная с версии Visual Studio 2010. Если вы осуществляете обновление с более ранней версии, чем 2010, возможно, вам придется выполнить больший объем работы по обновлению. В случае обновления с Visual Studio 2010 или более поздней версии в ваших проектах уже применяется MSBuild, поэтому процедура обновления проекта и сборки для приложения будет более простой.

Если вы не используете систему сборки в Visual Studio, то следует рассмотреть возможность обновления и перехода на MSBuild. В случае перехода на MSBuild, вероятно, вы сможете упростить процедуру обновления в будущем и вам будет проще использовать такие службы, как Visual Studio Online. MSBuild поддерживает все целевые платформы, которые поддерживает Visual Studio.

### <a name="porting-visual-studio-projects"></a>Перенос проектов Visual Studio

Чтобы начать обновление проекта или решения, просто откройте решение в новой версии Visual Studio и следуйте инструкциям на экране.  При обновлении проекта вы получаете отчет об обновлении, который также сохраняется в папке проекта под именем UpgradeLog.htm. В отчете об обновлении указывается, какие проблемы были обнаружены в ходе процесса обновления, а также содержатся сведения о внесенных изменениях или проблемах, которые не удалось устранить автоматически.

1. Свойства проекта

2. Включаемые файлы

3. Код, который больше не компилируется без ошибок из-за улучшений совместимости с компилятором или изменений в стандарте.

4. Код, основанный на возможностях Visual Studio или Windows, которые больше не доступны, или на файлах заголовков, которые не включены в установку Visual Studio по умолчанию или были удалены из продукта.

5. Код, который больше не компилируется из-за изменений в API-интерфейсах, например из-за изменения имен API-интерфейсов, изменения сигнатур функций или устаревания функций.

6. Код, который больше не компилируется из-за изменений в диагностике, например из-за предупреждения, которое становится ошибкой.

7. Ошибки компоновщика из-за библиотек, которые были изменены, особенно в случае, если используется параметр /NODEFAULTLIB.

8. Ошибки среды выполнения или непредвиденные результаты из-за изменения в поведении.

9. Ошибки из-за ошибок, которые появились в инструментах. В случае обнаружения проблемы сообщите о ней разработчикам Visual C++ через обычные каналы технической поддержки или через [Центр обратной связи Visual Studio](http://connect.microsoft.com/VisualStudio/Feedback).

Кроме изменений, которых нельзя избежать из-за ошибок компилятора, в процессе обновления могут появляться и другие, менее критичные изменения, например:

1. Новые предупреждения могут означать, что вы хотите очистить код. В зависимости от конкретных процедур диагностики это может улучшить переносимость, степень соответствия стандартам и уровень безопасности кода.

2. Можно воспользоваться более новыми возможностями компилятора, например параметром компилятора[/guard:cf (Включение защиты потока управления)](../build/reference/guard-enable-control-flow-guard.md), который добавляет проверки несанкционированного выполнения кода.

3. Можно обновить некоторую часть кода, чтобы использовать новые возможности языка, которые упрощают код, повышают производительность программ, либо обновить код, чтобы использовать современные библиотеки и обеспечить соответствие современным стандартам и рекомендациям.

После того как проект обновлен и протестирован, также можно продумать возможность дальнейшего совершенствования кода, спланировать направление развития кода в будущем или даже пересмотреть архитектуру проекта. Будет ли поддерживаться постоянная разработка? Будут ли это важно для выполнения кода на других платформах?  Если да, то на каких именно?  C++ — это стандартный язык, разработанный с учетом обеспечения переносимости и кроссплатформенной разработки. Также следует учитывать, что код для многих приложений Windows строго привязан к платформе Windows. Вы хотите выполнить рефакторинг кода, чтобы отделить те его части, которые более тесно привязаны к платформе Windows?

Что делать с пользовательским интерфейсом? Если вы используете MFC, может потребоваться обновление пользовательского интерфейса. Используете ли вы какие-либо новые функции MFC, которые появились в версии 2008, например пакет компонентов? Если нужно просто обновить внешний вид и поведение приложения, а не перерабатывать его полностью, можно использовать API-интерфейсы ленты в MFC или некоторые новые компоненты MFC.

Если вы желаете добавить в программу пользовательский интерфейс XAML, но не хотите создавать приложение UWP, можно использовать C# с WPF для формирования уровня пользовательского интерфейса и рефакторинга стандартной логики C++ в библиотеки DLL. Создайте уровень взаимодействия C++ или CLI для подключения C# с вашим машинным кодом. Или создайте приложение UWP с помощью [C++/CX](https://msdn.microsoft.com/library/windows/apps/xaml/hh699871.aspx) или [C++/WinRT](https://github.com/microsoft/cppwinrt). В Windows 10 можно воспользоваться [Desktop App Converter](https://msdn.microsoft.com/windows/uwp/porting/desktop-to-uwp-run-desktop-app-converter) для упаковки существующего классического приложения как приложения UWP, не изменяя код.

Возможно, у вас появились новые требования или вам нужно ориентироваться на платформы, отличные от настольных компьютеров Windows, например на Windows Phone или устройства Android. Код пользовательского интерфейса можно перенести в библиотеку кроссплатформенного пользовательского интерфейса. С помощью этих платформ пользовательского интерфейса можно ориентироваться на различные устройства и по-прежнему использовать Visual Studio, а также отладчик Visual Studio в качестве среды разработки.

## <a name="related-topics"></a>Связанные разделы

|Заголовок|Описание:|
|-----------|-----------------|
|[Обновление проектов, созданных в предыдущих версиях Visual C++](upgrading-projects-from-earlier-versions-of-visual-cpp.md)|Описываются способы использования проектов, созданных в предыдущих версиях Visual C++.|
|[Новые возможности компилятора C++ в Visual Studio 2017 RC](../what-s-new-for-visual-cpp-in-visual-studio.md)|Изменения в интегрированной среде разработки и инструментах Visual Studio 2015–2017|
|[Улучшения соответствия C++ в Visual Studio 2017](../cpp-conformance-improvements-2017.md)|Улучшения соответствия стандартам в Visual Studio 2015–2017|
|[Журнал изменений Visual C++ 2003–2015](visual-cpp-change-history-2003-2015.md)|Список изменений в библиотеках Visual C++ и инструментах сборки Visual Studio 2003–2015, которые могут потребовать внесения изменений в код.|
|[Новые возможности Visual C++ 2003–2015](visual-cpp-what-s-new-2003-through-2015.md)|Описание всех новых возможностей для Visual C++ в Visual Studio 2003–2015.|
|[Перенос сторонних библиотек](porting-third-party-libraries.md)|Сведения об использовании средства командной строки **vcpkg** для переноса старых библиотек с открытым исходным кодом на версии, скомпилированные с помощью более новых наборов инструментов Visual C++.|
|[Перенос и обновление: примеры и конкретные случаи](porting-and-upgrading-examples-and-case-studies.md)|Для этого раздела мы перенесли и обновили несколько примеров и приложений, а также рассмотрели достигнутые результаты. Содержимое данного раздела может помочь получить представление о том, что собой представляет процесс переноса и обновления. На протяжении всего процесса мы даем советы и рекомендации по обновлению, а также поясняем, каким образом были устранены конкретные ошибки.|
|[Перенос на универсальную платформу Windows](porting-to-the-universal-windows-platform-cpp.md)|Содержит сведения о переносе кода в Windows 10.|
|[Знакомство с Visual C++ для пользователей UNIX](introduction-to-visual-cpp-for-unix-users.md)|Содержит сведения для пользователей UNIX, которые не знакомы с Visual C++ и хотят научиться работать с этой средой.|
|[Перенос приложений из UNIX в Win32](porting-from-unix-to-win32.md)|Здесь описываются параметры для переноса приложений из UNIX в Windows.|

## <a name="see-also"></a>См. также

[Visual C++](../visual-cpp-in-visual-studio.md)