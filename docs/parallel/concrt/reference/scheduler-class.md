---
title: Класс Scheduler
ms.date: 11/04/2016
f1_keywords:
- Scheduler
- CONCRT/concurrency::Scheduler
- CONCRT/concurrency::Scheduler::Scheduler
- CONCRT/concurrency::Scheduler::Attach
- CONCRT/concurrency::Scheduler::Create
- CONCRT/concurrency::Scheduler::CreateScheduleGroup
- CONCRT/concurrency::Scheduler::GetNumberOfVirtualProcessors
- CONCRT/concurrency::Scheduler::GetPolicy
- CONCRT/concurrency::Scheduler::Id
- CONCRT/concurrency::Scheduler::IsAvailableLocation
- CONCRT/concurrency::Scheduler::Reference
- CONCRT/concurrency::Scheduler::RegisterShutdownEvent
- CONCRT/concurrency::Scheduler::Release
- CONCRT/concurrency::Scheduler::ResetDefaultSchedulerPolicy
- CONCRT/concurrency::Scheduler::ScheduleTask
- CONCRT/concurrency::Scheduler::SetDefaultSchedulerPolicy
helpviewer_keywords:
- Scheduler class
ms.assetid: 34cf7961-048d-4852-8a5c-a32f823e3506
ms.openlocfilehash: 1b2b4de2a0aa844f9450af9d853b11ea6f485274
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50638273"
---
# <a name="scheduler-class"></a>Класс Scheduler

Представляет абстракцию для планировщика среды выполнения с параллелизмом.

## <a name="syntax"></a>Синтаксис

```
class Scheduler;
```

## <a name="members"></a>Участники

### <a name="protected-constructors"></a>Защищенные конструкторы

|Имя|Описание|
|----------|-----------------|
|[Планировщик](#ctor)|Объект `Scheduler` класса можно создавать только с помощью методов фабрики или неявно.|
|[~ Деструктор планировщика](#dtor)|Объект `Scheduler` при исчезают все внешние ссылки на него неявно уничтожения класса.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[Attach](#attach)|Присоединяет планировщик для контекста вызова. После возврата этого метода, вызывающий контекст управляется планировщиком и планировщик становится текущего планировщика.|
|[Создание](#create)|Создает новый планировщик, поведение которого описывается `_Policy` параметра, помещает исходную ссылку на планировщик и возвращает указатель на него.|
|[CreateScheduleGroup](#createschedulegroup)|Перегружен. Создает новую группу расписания в планировщике. Версия, которая принимает параметр `_Placement` вызывает задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.|
|[GetNumberOfVirtualProcessors](#getnumberofvirtualprocessors)|Возвращает текущее число виртуальных процессоров для планировщика.|
|[GetPolicy](#getpolicy)|Возвращает копию объекта, планировщик, созданную с помощью политики.|
|[Идентификатор](#id)|Возвращает уникальный идентификатор для планировщика.|
|[IsAvailableLocation](#isavailablelocation)|Определяет, доступен ли заданное расположение в планировщике.|
|[Ссылки](#reference)|Увеличивает значение счетчика ссылок планировщика.|
|[RegisterShutdownEvent](#registershutdownevent)|Причины, переданный дескриптор события Windows `_Event` параметр сигнал, когда планировщик завершает работу и удаляет себя. В то время, когда событие получает сигнал завершена вся работа, запланированная на планировщик. Таким способом можно зарегистрировать несколько событий завершения работы.|
|[Релиз](#release)|Уменьшает значение счетчика ссылок планировщика.|
|[ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy)|Сбрасывает политики планировщика по умолчанию для среды выполнения по умолчанию. Далее время создания планировщик по умолчанию будет использовать параметры политики по умолчанию среды выполнения.|
|[ScheduleTask](#scheduletask)|Перегружен. Планирует упрощенная задача в планировщике. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.|
|[SetDefaultSchedulerPolicy](#setdefaultschedulerpolicy)|Разрешает определяемые пользователем политики для создания планировщика по умолчанию. Этот метод может вызываться только в том случае, когда планировщик по умолчанию существует внутри процесса. После задания политики по умолчанию, он остается в силе до следующего допустимого вызова либо `SetDefaultSchedulerPolicy` или [ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy) метод.|

## <a name="remarks"></a>Примечания

Среда выполнения с параллелизмом использует контекстов выполнения, которые сопоставляются с контексты выполнения операционной системы, такой как поток, для выполнения работы в очереди в приложении. В любое время уровень одновременности выполнения планировщика равен номеру виртуальный процессор, предоставленные ему диспетчером ресурсов. Виртуальный процессор представляет собой абстракцию для обработки ресурсов и отображается в аппаратном потоке в базовой системе. В определенный момент времени только один контекст планировщика может выполняться на виртуальном процессоре.

Среда выполнения с параллелизмом создаст планировщик по умолчанию на процесс для выполнения параллельной работы. Кроме того можно создавать экземпляры собственного планировщика и управлять им с помощью этого класса.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`Scheduler`

## <a name="requirements"></a>Требования

**Заголовок:** concrt.h

**Пространство имен:** concurrency

##  <a name="attach"></a> Присоединение

Присоединяет планировщик для контекста вызова. После возврата этого метода, вызывающий контекст управляется планировщиком и планировщик становится текущего планировщика.

```
virtual void Attach() = 0;
```

### <a name="remarks"></a>Примечания

Присоединение планировщик неявно помещает ссылку на планировщике.

В некоторый момент в будущем, необходимо вызвать [CurrentScheduler::Detach](currentscheduler-class.md#detach) метод, чтобы разрешить завершение работы планировщика.

Если этот метод вызывается из контекста, который уже присоединен к другому планировщику, существующий планировщик запоминается как предыдущий планировщик и вновь созданного планировщика становится текущего планировщика. При вызове `CurrentScheduler::Detach` метод позднее, предыдущий планировщик восстанавливается в качестве текущего планировщика.

Этот метод вызывает исключение [improper_scheduler_attach](improper-scheduler-attach-class.md) исключение, если этому планировщику не текущего планировщика вызывающего контекста.

##  <a name="create"></a> Создание

Создает новый планировщик, поведение которого описывается `_Policy` параметра, помещает исходную ссылку на планировщик и возвращает указатель на него.

```
static Scheduler* __cdecl Create(const SchedulerPolicy& _Policy);
```

### <a name="parameters"></a>Параметры

*По_литика журнала*<br/>
Политики планировщика, который описывает поведение вновь созданного планировщика.

### <a name="return-value"></a>Возвращаемое значение

Указатель на только что созданный планировщика. Это `Scheduler` объект имеет начальное значение счетчика ссылок на нем.

### <a name="remarks"></a>Примечания

После создания планировщика с `Create` метод, необходимо вызвать `Release` метод в некоторый момент в будущем, чтобы удалить начальное значение счетчика ссылок и разрешить завершение работы планировщика.

Планировщик, созданный с помощью этого метода не присоединен к контексту вызова. Его можно добавить в контекст с помощью [Attach](#attach) метод.

Этот метод можно вызвать ряд исключений, включая [scheduler_resource_allocation_error](scheduler-resource-allocation-error-class.md) и [invalid_scheduler_policy_value](invalid-scheduler-policy-value-class.md).

##  <a name="createschedulegroup"></a> CreateScheduleGroup

Создает новую группу расписания в планировщике. Версия, которая принимает параметр `_Placement` вызывает задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.

```
virtual ScheduleGroup* CreateScheduleGroup() = 0;

virtual ScheduleGroup* CreateScheduleGroup(location& _Placement) = 0;
```

### <a name="parameters"></a>Параметры

*Р_азмещения*<br/>
Ссылка на расположение, где задачи данной группы расписаний будет склонна.

### <a name="return-value"></a>Возвращаемое значение

Указатель на вновь созданное расписание группы. Это `ScheduleGroup` объект имеет начальное значение счетчика ссылок на нем.

### <a name="remarks"></a>Примечания

Необходимо вызвать [выпуска](schedulegroup-class.md#release) метод на группу расписаний, когда вы закончите планирования работы для него. Планировщик будет уничтожена расписание завершения группы при всю работу в очереди.

Обратите внимание, что если явно создан данным планировщиком, необходимо освободить все ссылки на группы, расписания, перед освобождением ссылок в планировщике.

##  <a name="getnumberofvirtualprocessors"></a> GetNumberOfVirtualProcessors

Возвращает текущее число виртуальных процессоров для планировщика.

```
virtual unsigned int GetNumberOfVirtualProcessors() const = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Текущее количество виртуальных процессоров для планировщика.

##  <a name="getpolicy"></a> GetPolicy

Возвращает копию объекта, планировщик, созданную с помощью политики.

```
virtual SchedulerPolicy GetPolicy() const = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Копия, планировщик, созданную с помощью политики.

##  <a name="id"></a> Идентификатор

Возвращает уникальный идентификатор для планировщика.

```
virtual unsigned int Id() const = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Уникальный идентификатор для планировщика.

##  <a name="isavailablelocation"></a> IsAvailableLocation

Определяет, доступен ли заданное расположение в планировщике.

```
virtual bool IsAvailableLocation(const location& _Placement) const = 0;
```

### <a name="parameters"></a>Параметры

*Р_азмещения*<br/>
Ссылка на расположение, чтобы запрашивать сведения о планировщике.

### <a name="return-value"></a>Возвращаемое значение

Указание того, является ли место, заданного параметром `_Placement` аргумент доступен в планировщике.

### <a name="remarks"></a>Примечания

Обратите внимание, что возвращаемое значение является результатом проверки доступности указанного расположения в данный момент. При наличии нескольких планировщиков динамическое управление ресурсами может добавлять или забирать ресурсы у планировщиков в любой момент. Если это произошло, доступность заданного расположения может измениться.

##  <a name="reference"></a> Справочник по

Увеличивает значение счетчика ссылок планировщика.

```
virtual unsigned int Reference() = 0 ;
```

### <a name="return-value"></a>Возвращаемое значение

Счетчик ссылок на новое значение.

### <a name="remarks"></a>Примечания

Это обычно используется для управления временем жизни планировщика для композиции. Когда значение счетчика ссылок планировщика снижается до нуля, планировщик завершит работу и уничтожится после завершения всей работы, указанной в планировщике.

Метод вызовет [improper_scheduler_reference](improper-scheduler-reference-class.md) исключение, если счетчик ссылок до вызова метода `Reference` метод равно нулю, и вызов выполняется из контекста, который не принадлежит планировщика.

##  <a name="registershutdownevent"></a> RegisterShutdownEvent

Причины, переданный дескриптор события Windows `_Event` параметр сигнал, когда планировщик завершает работу и удаляет себя. В то время, когда событие получает сигнал завершена вся работа, запланированная на планировщик. Таким способом можно зарегистрировать несколько событий завершения работы.

```
virtual void RegisterShutdownEvent(HANDLE _Event) = 0;
```

### <a name="parameters"></a>Параметры

*_Event*<br/>
Дескриптор объекта события Windows, который будет передаваться средой выполнения, когда планировщик завершает работу и удаляет себя.

##  <a name="release"></a> выпуск

Уменьшает значение счетчика ссылок планировщика.

```
virtual unsigned int Release() = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Вновь уменьшается на единицу счетчик.

### <a name="remarks"></a>Примечания

Это обычно используется для управления временем жизни планировщика для композиции. Когда значение счетчика ссылок планировщика снижается до нуля, планировщик завершит работу и уничтожится после завершения всей работы, указанной в планировщике.

##  <a name="resetdefaultschedulerpolicy"></a> ResetDefaultSchedulerPolicy

Сбрасывает политики планировщика по умолчанию для среды выполнения по умолчанию. Далее время создания планировщик по умолчанию будет использовать параметры политики по умолчанию среды выполнения.

```
static void __cdecl ResetDefaultSchedulerPolicy();
```

### <a name="remarks"></a>Примечания

Этот метод может вызываться, пока планировщик по умолчанию существует внутри процесса. Он не повлияет на политику существующих планировщик по умолчанию. Тем не менее если планировщик по умолчанию были завершить работу, а новое значение по умолчанию были созданы в более позднее, новый планировщик будет использовать параметры политики по умолчанию среды выполнения.

##  <a name="ctor"></a> Планировщик

Объект `Scheduler` класса можно создавать только с помощью методов фабрики или неявно.

```
Scheduler();
```

### <a name="remarks"></a>Примечания

Планировщик по умолчанию процесса создается неявно при использовании многих функций среды выполнения, которые требуют планировщик должен быть присоединен к контексту вызова. Методы в пределах `CurrentScheduler` класс и возможности PPL и уровни агентов обычно выполняют неявное вложение.

Вы также можете создать планировщик явным образом через `CurrentScheduler::Create` метод или `Scheduler::Create` метод.

##  <a name="dtor"></a> ~ Планировщика

Объект `Scheduler` при исчезают все внешние ссылки на него неявно уничтожения класса.

```
virtual ~Scheduler();
```

##  <a name="scheduletask"></a> ScheduleTask

Планирует упрощенная задача в планировщике. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.

```
virtual void ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data) = 0;

virtual void ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data,
    location& _Placement) = 0;
```

### <a name="parameters"></a>Параметры

*_Proc*<br/>
Указатель на функцию, необходимо выполнить, чтобы выполнять тело упрощенная задача.

*_Data*<br/>
Указатель void к данным, которые будут передаваться в качестве параметра в теле задачи.

*Р_азмещения*<br/>
Ссылка на расположение, где будет склонна выполняться упрощенная задача.

##  <a name="setdefaultschedulerpolicy"></a> SetDefaultSchedulerPolicy

Разрешает определяемые пользователем политики для создания планировщика по умолчанию. Этот метод может вызываться только в том случае, когда планировщик по умолчанию существует внутри процесса. После задания политики по умолчанию, он остается в силе до следующего допустимого вызова либо `SetDefaultSchedulerPolicy` или [ResetDefaultSchedulerPolicy](#resetdefaultschedulerpolicy) метод.

```
static void __cdecl SetDefaultSchedulerPolicy(const SchedulerPolicy& _Policy);
```

### <a name="parameters"></a>Параметры

*По_литика журнала*<br/>
Политика, в качестве политики планировщика по умолчанию.

### <a name="remarks"></a>Примечания

Если `SetDefaultSchedulerPolicy` метод вызывается, когда планировщик по умолчанию уже существует в процессе, среда выполнения сообщит [default_scheduler_exists](default-scheduler-exists-class.md) исключение.

## <a name="see-also"></a>См. также

[Пространство имен concurrency](concurrency-namespace.md)<br/>
[Класс Scheduler](scheduler-class.md)<br/>
[PolicyElementKey](concurrency-namespace-enums.md)<br/>
[Планировщик задач](../../../parallel/concrt/task-scheduler-concurrency-runtime.md)

