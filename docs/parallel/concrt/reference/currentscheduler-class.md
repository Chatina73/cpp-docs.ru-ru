---
title: Класс CurrentScheduler
ms.date: 11/04/2016
f1_keywords:
- CurrentScheduler
- CONCRT/concurrency::CurrentScheduler
- CONCRT/concurrency::CurrentScheduler::Create
- CONCRT/concurrency::CurrentScheduler::CreateScheduleGroup
- CONCRT/concurrency::CurrentScheduler::Detach
- CONCRT/concurrency::CurrentScheduler::Get
- CONCRT/concurrency::CurrentScheduler::GetNumberOfVirtualProcessors
- CONCRT/concurrency::CurrentScheduler::GetPolicy
- CONCRT/concurrency::CurrentScheduler::Id
- CONCRT/concurrency::CurrentScheduler::IsAvailableLocation
- CONCRT/concurrency::CurrentScheduler::RegisterShutdownEvent
- CONCRT/concurrency::CurrentScheduler::ScheduleTask
helpviewer_keywords:
- CurrentScheduler class
ms.assetid: 31c20e0e-4cdf-49b4-8220-d726130aad2b
ms.openlocfilehash: a27ec7c25962b6addd26e61af8f33130d4c653ba
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62296160"
---
# <a name="currentscheduler-class"></a>Класс CurrentScheduler

Представляет абстракцию для текущего планировщика, связанного с вызывающим контекстом.

## <a name="syntax"></a>Синтаксис

```
class CurrentScheduler;
```

## <a name="members"></a>Участники

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Создание](#create)|Создает новый планировщик, поведение которого описывается `_Policy` параметр и присоединяет его к контексту вызова. Вновь созданного планировщика станет текущего планировщика для вызывающего контекста.|
|[CreateScheduleGroup](#createschedulegroup)|Перегружен. Создает новую группу расписания внутри планировщика, связанного с вызывающим контекстом. Версия, которая принимает параметр `_Placement` вызывает задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.|
|[Detach](#detach)|Отсоединяет текущий планировщик от вызывающего контекста и восстанавливает ранее присоединенный планировщик как текущий планировщик, в том случае, если он существует. После возврата этого метода, вызывающий контекст затем управляется планировщика, который ранее был присоединен к контексту при помощи либо `CurrentScheduler::Create` или `Scheduler::Attach` метод.|
|[Get](#get)|Возвращает указатель на планировщик, связанный с вызывающим контекстом, называемый также текущего планировщика.|
|[GetNumberOfVirtualProcessors](#getnumberofvirtualprocessors)|Возвращает текущее число виртуальных процессоров для планировщика, связанного с вызывающим контекстом.|
|[GetPolicy](#getpolicy)|Возвращает копию текущего планировщика был создан с помощью политики.|
|[Идентификатор](#id)|Возвращает уникальный идентификатор для текущего планировщика.|
|[IsAvailableLocation](#isavailablelocation)|Определяет, доступно ли данное расположение в текущем планировщике.|
|[RegisterShutdownEvent](#registershutdownevent)|Причины, переданный дескриптор события Windows `_ShutdownEvent` параметр сигнал, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя. В то время, когда событие получает сигнал завершена вся работа, запланированная на планировщик. Таким способом можно зарегистрировать несколько событий завершения работы.|
|[ScheduleTask](#scheduletask)|Перегружен. Планирует задачу упрощенная внутри планировщика, связанного с вызывающим контекстом. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.|

## <a name="remarks"></a>Примечания

Если отсутствует планировщик (см. в разделе [планировщика](scheduler-class.md)) связанного с вызывающим контекстом, многие методы в `CurrentScheduler` класс приведет к вложения из процесса планировщик по умолчанию. Это также означает, что планировщик по умолчанию процесса создается во время такой вызов.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`CurrentScheduler`

## <a name="requirements"></a>Требования

**Заголовок:** concrt.h

**Пространство имен:** concurrency

##  <a name="create"></a> Создание

Создает новый планировщик, поведение которого описывается `_Policy` параметр и присоединяет его к контексту вызова. Вновь созданного планировщика станет текущего планировщика для вызывающего контекста.

```
static void __cdecl Create(const SchedulerPolicy& _Policy);
```

### <a name="parameters"></a>Параметры

*По_литика журнала*<br/>
Политики планировщика, который описывает поведение вновь созданного планировщика.

### <a name="remarks"></a>Примечания

Вложение планировщик к контексту вызова неявно помещает значение счетчика ссылок в планировщике.

После создания планировщика с `Create` метод, необходимо вызвать [CurrentScheduler::Detach](#detach) метод в некоторый момент в будущем, чтобы разрешить завершение работы планировщика.

Если этот метод вызывается из контекста, который уже присоединен к другому планировщику, существующий планировщик запоминается как предыдущий планировщик и вновь созданного планировщика становится текущего планировщика. При вызове `CurrentScheduler::Detach` метод позднее, предыдущий планировщик восстанавливается в качестве текущего планировщика.

Этот метод можно вызвать ряд исключений, включая [scheduler_resource_allocation_error](scheduler-resource-allocation-error-class.md) и [invalid_scheduler_policy_value](invalid-scheduler-policy-value-class.md).

##  <a name="createschedulegroup"></a> CreateScheduleGroup

Создает новую группу расписания внутри планировщика, связанного с вызывающим контекстом. Версия, которая принимает параметр `_Placement` вызывает задачи в пределах группы вновь созданное расписание стремиться к выполнению в расположении, указанном этим параметром.

```
static ScheduleGroup* __cdecl CreateScheduleGroup();

static ScheduleGroup* __cdecl CreateScheduleGroup(location& _Placement);
```

### <a name="parameters"></a>Параметры

*Р_азмещения*<br/>
Ссылка на расположение, где задачи данной группы расписаний будет стремиться к выполнению в.

### <a name="return-value"></a>Возвращаемое значение

Указатель на вновь созданное расписание группы. Это `ScheduleGroup` объект имеет начальное значение счетчика ссылок на нем.

### <a name="remarks"></a>Примечания

В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.

Необходимо вызвать [выпуска](schedulegroup-class.md#release) метод на группу расписаний, когда вы закончите планирования работы для него. Планировщик будет уничтожена расписание завершения группы при всю работу в очереди.

Обратите внимание, что если явно создан данным планировщиком, необходимо освободить все ссылки на группы, расписания, перед освобождением ссылки в планировщике, путем отсоединения текущего контекста из него.

##  <a name="detach"></a> отсоединение

Отсоединяет текущий планировщик от вызывающего контекста и восстанавливает ранее присоединенный планировщик как текущий планировщик, в том случае, если он существует. После возврата этого метода, вызывающий контекст затем управляется планировщика, который ранее был присоединен к контексту при помощи либо `CurrentScheduler::Create` или `Scheduler::Attach` метод.

```
static void __cdecl Detach();
```

### <a name="remarks"></a>Примечания

`Detach` Метод неявно удаляет счетчик ссылок из планировщика.

Если планировщик присоединен к вызывающему контексту, вызов этого метода приведет к [scheduler_not_attached](scheduler-not-attached-class.md) возникающем исключении.

Вызов этого метода из контекста внутри и управляемый с помощью планировщика или контекста, который был подключен с помощью метода, отличного от [Scheduler::Attach](scheduler-class.md#attach) или [CurrentScheduler::Create](#create) методы, приведет к [improper_scheduler_detach](improper-scheduler-detach-class.md) возникающем исключении.

##  <a name="get"></a> Получить

Возвращает указатель на планировщик, связанный с вызывающим контекстом, называемый также текущего планировщика.

```
static Scheduler* __cdecl Get();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на планировщик, связанный с вызывающим контекстом (текущий планировщик).

### <a name="remarks"></a>Примечания

В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом. Дополнительные ссылки помещается на `Scheduler` объекта, возвращаемого этим методом.

##  <a name="getnumberofvirtualprocessors"></a> GetNumberOfVirtualProcessors

Возвращает текущее число виртуальных процессоров для планировщика, связанного с вызывающим контекстом.

```
static unsigned int __cdecl GetNumberOfVirtualProcessors();
```

### <a name="return-value"></a>Возвращаемое значение

Если планировщик связан с вызывающим контекстом, текущее число виртуальных процессоров для данного планировщика; в противном случае — значение `-1`.

### <a name="remarks"></a>Примечания

Этот метод не приведет к вложению планировщика, если еще не связан с планировщиком контекст вызова.

Возвращаемое значение из этого метода является результатом число виртуальных процессоров для планировщика, связанного с вызывающим контекстом. Это значение может быть устаревшим в момент возврата.

##  <a name="getpolicy"></a> GetPolicy

Возвращает копию текущего планировщика был создан с помощью политики.

```
static SchedulerPolicy __cdecl GetPolicy();
```

### <a name="return-value"></a>Возвращаемое значение

Копия текущего планировщика был создан с помощью политики.

### <a name="remarks"></a>Примечания

В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.

##  <a name="id"></a> Идентификатор

Возвращает уникальный идентификатор для текущего планировщика.

```
static unsigned int __cdecl Id();
```

### <a name="return-value"></a>Возвращаемое значение

Если планировщик связан с вызывающим контекстом, уникальный идентификатор для данного планировщика; в противном случае — значение `-1`.

### <a name="remarks"></a>Примечания

Этот метод не приведет к вложению планировщика, если еще не связан с планировщиком контекст вызова.

##  <a name="isavailablelocation"></a> IsAvailableLocation

Определяет, доступно ли данное расположение в текущем планировщике.

```
static bool __cdecl IsAvailableLocation(const location& _Placement);
```

### <a name="parameters"></a>Параметры

*Р_азмещения*<br/>
Ссылка на расположение, о котором необходимо отправить запрос текущему планировщику.

### <a name="return-value"></a>Возвращаемое значение

Индикация доступности расположения, указанного параметром `_Placement`, в текущем планировщике.

### <a name="remarks"></a>Примечания

Этот метод не приведет к вложению планировщика, если еще не связан с планировщиком контекст вызова.

Обратите внимание, что возвращаемое значение является результатом проверки доступности указанного расположения в данный момент. При наличии нескольких планировщиков динамическое управление ресурсами может добавлять или забирать ресурсы у планировщиков в любой момент. Если это произошло, доступность заданного расположения может измениться.

##  <a name="registershutdownevent"></a> RegisterShutdownEvent

Причины, переданный дескриптор события Windows `_ShutdownEvent` параметр сигнал, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя. В то время, когда событие получает сигнал завершена вся работа, запланированная на планировщик. Таким способом можно зарегистрировать несколько событий завершения работы.

```
static void __cdecl RegisterShutdownEvent(HANDLE _ShutdownEvent);
```

### <a name="parameters"></a>Параметры

*_ShutdownEvent*<br/>
Дескриптор объекта события Windows, который будет передаваться средой выполнения, когда планировщик, связанный с текущим контекстом, завершает работу и удаляет себя.

### <a name="remarks"></a>Примечания

Если планировщик присоединен к вызывающему контексту, вызов этого метода приведет к [scheduler_not_attached](scheduler-not-attached-class.md) возникающем исключении.

##  <a name="scheduletask"></a> ScheduleTask

Планирует задачу упрощенная внутри планировщика, связанного с вызывающим контекстом. Упрощенная задача будет размещена в группе расписаний, определенной средой выполнения. Версия, принимающая параметр `_Placement`, склоняет задачу к выполнению в указанном расположении.

```
static void __cdecl ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data);

static void __cdecl ScheduleTask(
    TaskProc _Proc,
    _Inout_opt_ void* _Data,
    location& _Placement);
```

### <a name="parameters"></a>Параметры

*_Proc*<br/>
Указатель на функцию, необходимо выполнить, чтобы выполнять тело упрощенная задача.

*_Data*<br/>
Указатель void к данным, которые будут передаваться в качестве параметра в теле задачи.

*Р_азмещения*<br/>
Ссылка на расположение, где будет склонна выполняться упрощенная задача.

### <a name="remarks"></a>Примечания

В результате этого метода в процессе будет создан планировщик по умолчанию и/или присоединен к вызывающему контексту, если отсутствует планировщик, в данный момент связанный с вызывающим контекстом.

## <a name="see-also"></a>См. также

[Пространство имен concurrency](concurrency-namespace.md)<br/>
[Класс Scheduler](scheduler-class.md)<br/>
[PolicyElementKey](concurrency-namespace-enums.md)<br/>
[Планировщик задач](../../../parallel/concrt/task-scheduler-concurrency-runtime.md)
