---
title: Реализация многопоточности на языке C++ с помощью классов MFC
ms.date: 08/27/2018
helpviewer_keywords:
- MFC [C++], multithreading
- threading [C++], MFC
- worker threads [C++]
- synchronization classes [C++]
- synchronization [C++], multithreading
- threading [MFC], about threading
- CWinThread class, purpose of
- multithreading [C++], MFC
- threading [MFC]
- user interface threads [C++]
ms.assetid: 979605f8-3988-44b5-ac9c-b8cce7fcce14
ms.openlocfilehash: eaf28404b06e9b0bf6126d8bbc140bf46cff37da
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69512014"
---
# <a name="multithreading-with-c-and-mfc"></a>Реализация многопоточности на языке C++ с помощью классов MFC

Библиотека Microsoft Foundation Class (MFC) обеспечивает поддержку многопоточных приложений. В этом разделе описываются процессы и потоки, а также подход MFC к многопоточности.

Процесс — это исполняемый экземпляр приложения. Например, если дважды щелкнуть значок «Блокнот», запускается процесс, запускающий Блокнот.

Поток — это путь выполнения внутри процесса. При запуске блокнота операционная система создает процесс и начинает выполнять основной поток этого процесса. При завершении этого потока процесс выполняется. Этот основной поток предоставляется операционной системе кодом запуска в виде адреса функции. Обычно это адрес `main` предоставляемой функции или `WinMain` .

При необходимости в приложении можно создавать дополнительные потоки. Это может потребоваться для обработки фоновых или служебных задач, если не нужно, чтобы пользователь ожидал их завершения. Все потоки в приложениях MFC представлены объектами класса [CWinThread](../mfc/reference/cwinthread-class.md) . В большинстве случаев вам даже не нужно явно создавать эти объекты. Вместо этого вызовите вспомогательную функцию платформы [афксбегинсреад](../mfc/reference/application-information-and-management.md#afxbeginthread), которая `CWinThread` создает объект.

MFC различает два типа потоков: потоки пользовательского интерфейса и рабочие потоки. Потоки пользовательского интерфейса обычно используются для управления вводом пользователя и реагирования на события и сообщения, созданные пользователем. Рабочие потоки обычно используются для выполнения задач, таких как пересчет, которые не нуждаются в вводе данных пользователем. API Win32 не различает типы потоков. необходимо только выяснить начальный адрес потока, чтобы он мог начать выполнение потока. MFC обрабатывает потоки пользовательского интерфейса особым образом, предоставляя конвейер сообщений для событий в пользовательском интерфейсе. `CWinApp`— Это пример объекта потока пользовательского интерфейса, поскольку он является производным от `CWinThread` класса и обрабатывает события и сообщения, созданные пользователем.

Особое внимание следует уделить ситуациям, когда более чем одному потоку может потребоваться доступ к одному и тому же объекту. [Многопоточность. Советы по](multithreading-programming-tips.md) программированию описывают методы, которые можно использовать для решения проблем, которые могут возникнуть в таких ситуациях. [Многопоточность. Использование классов](multithreading-how-to-use-the-synchronization-classes.md) синхронизации описывает, как использовать классы, доступные для синхронизации доступа из нескольких потоков к одному объекту.

Написание и Отладка многопоточного программирования по сути по-своему сложнее, так как необходимо обеспечить недоступность объектов в нескольких потоках за один раз. В разделах о многопоточном программировании не рассматриваются основы многопоточного программирования, а только использование MFC в многопоточной программе. Многопоточные примеры MFC, включенные в Visual C++ , иллюстрируют несколько многопоточных функций добавления и API-интерфейсов Win32, не включенных в MFC. Однако они предназначены только для отправной точки.

Дополнительные сведения о том, как операционная система обрабатывает процессы и потоки, см. в разделе [процессы и потоки](/windows/win32/ProcThread/processes-and-threads) в Windows SDK.

Дополнительные сведения о поддержке многопоточности MFC см. в следующих разделах:

- [Многопоточность. Создание потоков, обрабатывающих события от пользовательского интерфейса](multithreading-creating-user-interface-threads.md)

- [Многопоточность. Создание рабочих потоков](multithreading-creating-worker-threads.md)

- [Многопоточность. Принцип использования классов синхронизации](multithreading-how-to-use-the-synchronization-classes.md)

- [Многопоточность. Завершение работы с потоками](multithreading-terminating-threads.md)

- [Многопоточность. Советы по программированию](multithreading-programming-tips.md)

- [Многопоточность. Сценарии использования классов синхронизации](multithreading-when-to-use-the-synchronization-classes.md)

## <a name="see-also"></a>См. также

[Поддержка многопоточности для устаревшего кода (Visual C++)](multithreading-support-for-older-code-visual-cpp.md)
