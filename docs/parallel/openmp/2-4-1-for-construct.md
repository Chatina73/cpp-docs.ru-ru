---
title: 2.4.1 Конструкция for
ms.date: 11/04/2016
ms.assetid: 27d2cbce-786b-4819-91d3-d55b2cc57a5e
ms.openlocfilehash: a6cd1733677a6211055a9b06231fb1686c8e2fde
ms.sourcegitcommit: 1819bd2ff79fba7ec172504b9a34455c70c73f10
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2018
ms.locfileid: "51329504"
---
# <a name="241-for-construct"></a>2.4.1 Конструкция for

**Для** директива идентифицирует итеративный конструкция совместной работы, которая указывает, что итерации связанного цикла будет выполняться в параллельном режиме. Итераций **для** цикла распределяются по потокам, которые уже существуют в группе, выполнения параллельной конструкции, к которому он привязан. Синтаксис **для** конструкция выглядит следующим образом:

```
#pragma omp for [clause[[,] clause] ... ] new-line for-loop
```

Предложение является одним из следующих:

**закрытый (** *списка переменной* **)**

**firstprivate (** *списка переменной* **)**

**lastprivate (** *списка переменной* **)**

**сокращение (** *оператор* **:** *списка переменной* **)**

**Упорядоченные**

**расписание (** *вид* [**,** *chunk_size*] **)**

**nowait**

**Для** директива накладывает ограничения на структуру соответствующего **для** цикла. В частности, соответствующий **для** цикл должен иметь каноническую форму:

**для (** *init-expr* **;** *b логических операций var*; *incr-expr* **)**

*init-expr*<br/>
Один из следующих вариантов:

*var* = *lb*

*var целочисленного типа* = *lb*

*INCR-expr*<br/>
Один из следующих вариантов:

++ *var*

*var* ++

-- *var*

*var* --

*var* += *incr*

*var* -= *incr*

*var* = *var* + *incr*

*var* = *incr* + *var*

*var* = *var* - *incr*

*var*<br/>
Переменная, целое число со знаком. Если эта переменная в противном случае используются совместно, она выполняется неявно закрытый в течение **для**.   Нельзя изменять эту переменную в теле **для** инструкции. Если не указан переменной **lastprivate**, его значение после цикла не определен.

*логических операций*<br/>
Один из следующих вариантов:

\<

\<=

\>

\>=

*lb*, *b*, и *incr*<br>
Цикл целые инвариантного выражения. Синхронизация при вычислении этих выражений не выполняется. Таким образом любые вычисления побочных эффектов привести к непредсказуемым результатам.

Обратите внимание, что каноническая форма позволяет количество итераций цикла вычисляться при входе в цикл. Это вычисление выполняется со значениями в тип *var*, после восходящее приведение целочисленных типов. В частности, если значение *b* - *lb* + *incr* не могут быть представлены в том, что тип, результат не определен. Кроме того, если *логических операций* является < или \<= затем *incr-expr* могут вызвать *var* для повышения на каждой итерации цикла.   Если *логических операций* является > или > = затем *incr-expr* могут вызвать *var* уменьшение на каждой итерации цикла.

**Расписание** предложение указывает, как итераций **для** цикл разделяются между несколькими потоками рабочей группы. Правильность программы не должен зависеть какой поток выполняет определенной итерации. Значение *chunk_size*, если он указан, должно быть выражение цикла инвариантного целое число с положительным. Синхронизация при вычислении этого выражения не выполняется. Таким образом любые вычисления побочных эффектов привести к непредсказуемым результатам. Расписание *вид* может принимать одно из следующих:

В ТАБЛИЦЕ 2-1 **расписание** предложение *вид* значения

|||
|-|-|
|статический|Когда **расписание (статический,** *chunk_size* **)** указан, итераций, разделены на блоки размер, указанный параметром *chunk_size*. Блоки назначаются статически для потоков в команде в циклического перебора порядке номер потока. Если аргумент *chunk_size* задан, пространство итерации делится на фрагменты, размер которых примерно одинакового размера, с помощью одного фрагмента данных, назначенный каждому потоку.|
|dynamic|Когда **расписание (динамические,** *chunk_size* **)** указан, количество итераций можно разделить на ряд блоков данных, каждая из которых содержит *chunk_size* итераций. Каждый блок назначается поток, который ожидает назначения. Поток выполняет кусок итераций, а затем ждет свое назначение Далее, пока не блоки по-прежнему назначаться. Обратите внимание на то, что последний блок для назначения может иметь меньшее число итераций. Если аргумент *chunk_size* задан, он по умолчанию 1.|
|Интерактивная|Когда **расписание (интерактивной,** *chunk_size* **)** указан, итераций назначенных потоков в виде фрагментов с уменьшение размеров. Когда поток завершает его назначенного кусок итераций, динамически назначается другой фрагмент, пока остаются none. Для *chunk_size* 1, объем каждого фрагмента данных составляет приблизительно соответствующее количеству неназначенные итераций, деленное на количество потоков. Эти размеры экспоненциально приблизительно уменьшить значение 1. Для *chunk_size* со значением *k* больше 1, размеры уменьшить приблизительно до экспоненциально *k*, за исключением того, что последний блок может иметь меньше, чем  *k* итераций. Если аргумент *chunk_size* задан, он по умолчанию 1.|
|исполняющая среда|Когда **schedule(runtime)** указано, решение о планировании откладывается до времени выполнения. Расписание *вид* и размер фрагментов можно выбрать во время выполнения, задав переменную среды **OMP_SCHEDULE**. Если эта переменная среды не задано, полученный расписание определяется реализацией. Когда **schedule(runtime)** указано, *chunk_size* не должно быть указано.|

При отсутствии явно определенной **расписание** предложение, по умолчанию **расписание** определяется реализацией.

OpenMP совместимые приложения не должны зависеть от конкретного расписания для правильного выполнения. Программа не следует полагаться на расписание *вид* удовлетворяющие точно описание указанного выше, так как это может быть вариации в реализациях тому же расписанию *вид* через разные компиляторы. Описания можно использовать для выбора расписания, которое подходит для конкретной ситуации.

**Упорядоченные** предложение должен присутствовать, если **упорядоченные** директивы привязки к **для** построения.

Есть неявное барьер в конце **для** создать, если не **nowait** указано предложение.

Ограничения для **для** директива таковы:

- **Для** цикла должно быть структурированный блок, и, кроме того, его выполнение должны завершаться не по **break** инструкции.

- Значения цикла управления выражения **для** цикл, связанный с **для** директива должны быть одинаковыми для всех потоков в группе.

- **Для** переменной итерации цикла должен иметь тип целого числа со знаком.

- Только один **расписание** предложения могут отображаться на **для** директива.

- Только один **упорядоченные** предложения могут отображаться на **для** директива.

- Только один **nowait** предложения могут отображаться на **для** директива.

- Неуказанный if или как часто влияет на любой стороне в пределах *chunk_size*, *lb*, *b*, или *incr* выражения встречаются.

- Значение *chunk_size* выражение должно быть одинаковым для всех потоков в группе.

## <a name="cross-references"></a>Перекрестные ссылки:

- **закрытый**, **firstprivate**, **lastprivate**, и **сокращения** предложений, см. в разделе [разделе 2.7.2](../../parallel/openmp/2-7-2-data-sharing-attribute-clauses.md) на стр. 25.

- **OMP_SCHEDULE** переменной, см. в разделе среды [разделе 4.1 спецификации](../../parallel/openmp/4-1-omp-schedule.md) на стр. 48.

- **упорядоченные** конструкцию, см. в разделе [разделе 2.6.6](../../parallel/openmp/2-6-6-ordered-construct.md) на стр. 22.

- [Приложение D](../../parallel/openmp/d-using-the-schedule-clause.md), стр 93, предоставляет дополнительные сведения об использовании предложения schedule.