---
description: 'Дополнительные сведения: 4. Переменные среды'
title: 4. Переменные среды
ms.date: 01/16/2019
ms.assetid: 4ec7ed81-e9ca-46a1-84f8-8f9ce4587346
ms.openlocfilehash: 47c0d557497a387f89c13c88c414aae9eb9377ef
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97342534"
---
# <a name="4-environment-variables"></a>4. переменные среды

В этой главе описываются переменные среды API OpenMP C и C++ (или аналогичные механизмы, зависящие от платформы), которые управляют выполнением параллельного кода.  Имена переменных среды должны быть прописными буквами. Присвоенные им значения не чувствительны к регистру и могут содержать начальные и конечные пробелы.  Изменения значений после запуска программы игнорируются.

Ниже приведены переменные среды.

- [OMP_SCHEDULE](#41-omp_schedule) задает тип расписания времени выполнения и размер фрагмента.
- [OMP_NUM_THREADS](#42-omp_num_threads) задает количество потоков, используемых во время выполнения.
- [OMP_DYNAMIC](#43-omp_dynamic) включает или отключает динамическую настройку количества потоков.
- [OMP_NESTED](#44-omp_nested) включает или отключает вложенный параллелизм.

В примерах в этой главе показано, как можно задать эти переменные в средах UNIX C Shell (КШ). В Korn shell и в средах DOS действия похожи:

КШ:  
`setenv OMP_SCHEDULE "dynamic"`

КШ:  
`export OMP_SCHEDULE="dynamic"`

LMHOSTS  
`set OMP_SCHEDULE="dynamic"`

## <a name="41-omp_schedule"></a><a name="41-omp_schedule"></a> 4,1 OMP_SCHEDULE

`OMP_SCHEDULE` применяется только к `for` `parallel for` директивам и, имеющим тип расписания `runtime` . Тип расписания и размер блока для всех таких циклов можно задать во время выполнения. Задайте для этой переменной среды любой распознаваемый тип расписания и необязательный *chunk_size*.

Для `for` `parallel for` директивы и, которые имеют тип расписания, отличный от `runtime` , `OMP_SCHEDULE` игнорируется. Значение по умолчанию для этой переменной среды определяется реализацией. Если задано необязательное *chunk_size* , значение должно быть положительным. Если *chunk_size* не задано, предполагается значение 1, за исключением случая, когда задано расписание `static` . Для `static` расписания размер фрагмента по умолчанию устанавливается в интервал итерации цикла, деленный на число потоков, применяемых к циклу.

Пример

```csh
setenv OMP_SCHEDULE "guided,4"
setenv OMP_SCHEDULE "dynamic"
```

### <a name="cross-references"></a>Перекрестные ссылки

- [для](2-directives.md#241-for-construct) директивы
- [параллельная](2-directives.md#251-parallel-for-construct) директива for

## <a name="42-omp_num_threads"></a><a name="42-omp_num_threads"></a> 4,2 OMP_NUM_THREADS

`OMP_NUM_THREADS`Переменная среды задает количество потоков по умолчанию, используемых во время выполнения. `OMP_NUM_THREADS` параметр не учитывается, если этот номер явно изменен путем вызова `omp_set_num_threads` подпрограммы библиотеки. Он также игнорируется, если `num_threads` в директиве есть явное предложение `parallel` .

Значение `OMP_NUM_THREADS` переменной среды должно быть положительным целым числом. Его воздействие зависит от того, включена ли Динамическая коррекция числа потоков. Полный набор правил взаимодействия между `OMP_NUM_THREADS` переменной среды и динамической настройкой потоков см. в [разделе 2,3](2-directives.md#23-parallel-construct).

Число используемых потоков определяется реализацией, если:

- `OMP_NUM_THREADS`переменная среды не указана,
- указанное значение не является положительным целым числом или
- значение больше максимального числа потоков, которое может поддерживать система.

Пример

```csh
setenv OMP_NUM_THREADS 16
```

### <a name="cross-references"></a>Перекрестные ссылки

- предложение [num_threads](2-directives.md#23-parallel-construct)
- Функция [omp_set_num_threads](3-run-time-library-functions.md#311-omp_set_num_threads-function)
- Функция [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="43-omp_dynamic"></a><a name="43-omp_dynamic"></a> 4,3 OMP_DYNAMIC

`OMP_DYNAMIC`Переменная среды включает или отключает динамическую настройку количества потоков, доступных для выполнения параллельных регионов. `OMP_DYNAMIC` параметр не учитывается, если динамическая настройка явно включена или отключена путем вызова `omp_set_dynamic` подпрограммы библиотеки. Его значение должно быть `TRUE` или `FALSE` .

Если параметр `OMP_DYNAMIC` имеет значение `TRUE` , то количество потоков, используемых для выполнения параллельных регионов, может быть скорректировано средой выполнения для оптимального использования системных ресурсов.  Если параметр `OMP_DYNAMIC` имеет значение `FALSE` , динамическая корректировка отключена. Условие по умолчанию определяется реализацией.

Пример

```csh
setenv OMP_DYNAMIC TRUE
```

### <a name="cross-references"></a>Перекрестные ссылки

- [Параллельные регионы](2-directives.md#23-parallel-construct)
- Функция [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="44-omp_nested"></a><a name="44-omp_nested"></a> 4,4 OMP_NESTED

`OMP_NESTED`Переменная среды включает или отключает вложенный параллелизм, если не включен или отключен вложенный параллелизм путем вызова `omp_set_nested` подпрограммы библиотеки. Если параметр `OMP_NESTED` имеет значение `TRUE` , включен вложенный параллелизм. Если параметр `OMP_NESTED` имеет значение `FALSE` , то вложенный параллелизм отключен. Значение по умолчанию — `FALSE`.

Пример

```csh
setenv OMP_NESTED TRUE
```

### <a name="cross-reference"></a>Перекрестная ссылка

- Функция [omp_set_nested](3-run-time-library-functions.md#319-omp_set_nested-function)
