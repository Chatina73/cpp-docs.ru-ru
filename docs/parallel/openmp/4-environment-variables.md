---
title: 4. Переменные среды
ms.date: 01/16/2019
ms.assetid: 4ec7ed81-e9ca-46a1-84f8-8f9ce4587346
ms.openlocfilehash: b41829fd9cf2f90312f669ef991f56dda02947f7
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78882872"
---
# <a name="4-environment-variables"></a>4. переменные среды

В этой главе описываются переменные среды OpenMP C++ C и API (или аналогичные механизмы, зависящие от платформы), которые управляют выполнением параллельного кода.  Имена переменных среды должны быть прописными буквами. Присвоенные им значения не чувствительны к регистру и могут содержать начальные и конечные пробелы.  Изменения значений после запуска программы игнорируются.

Ниже приведены переменные среды.

- [OMP_SCHEDULE](#41-omp_schedule) задает тип расписания времени выполнения и размер фрагмента.
- [OMP_NUM_THREADS](#42-omp_num_threads) задает количество потоков, используемых во время выполнения.
- [OMP_DYNAMIC](#43-omp_dynamic) включает или отключает динамическую настройку количества потоков.
- [OMP_NESTED](#44-omp_nested) включает или отключает вложенный параллелизм.

В примерах в этой главе показано, как можно задать эти переменные в средах UNIX C Shell (КШ). В Korn shell и в средах DOS действия похожи:

КШ:  
`setenv OMP_SCHEDULE "dynamic"`

КШ:  
`export OMP_SCHEDULE="dynamic"`

LMHOSTS  
`set OMP_SCHEDULE="dynamic"`

## <a name="41-omp_schedule"></a>4,1 OMP_SCHEDULE

`OMP_SCHEDULE` применяется только к директивам `for` и `parallel for` с типом расписания `runtime`. Тип расписания и размер блока для всех таких циклов можно задать во время выполнения. Задайте для этой переменной среды любой распознаваемый тип расписания и необязательный *chunk_size*.

Для директив `for` и `parallel for`, имеющих тип расписания, отличный от `runtime`, `OMP_SCHEDULE` игнорируется. Значение по умолчанию для этой переменной среды определяется реализацией. Если задано необязательное *chunk_size* , значение должно быть положительным. Если *chunk_size* не задано, предполагается значение 1, за исключением случаев, когда расписание `static`. Для `static` расписания размер фрагмента данных по умолчанию устанавливается равным интервалу итерации цикла, деленному на число потоков, применяемых к циклу.

Пример

```csh
setenv OMP_SCHEDULE "guided,4"
setenv OMP_SCHEDULE "dynamic"
```

### <a name="cross-references"></a>Перекрестные ссылки

- [для](2-directives.md#241-for-construct) директивы
- [параллельная](2-directives.md#251-parallel-for-construct) директива for

## <a name="42-omp_num_threads"></a>4,2 OMP_NUM_THREADS

Переменная среды `OMP_NUM_THREADS` задает количество потоков по умолчанию, используемых во время выполнения. `OMP_NUM_THREADS` не учитывается, если этот номер явно изменен путем вызова подпрограммы библиотеки `omp_set_num_threads`. Он также игнорируется, если в директиве `parallel` есть явное предложение `num_threads`.

Значение переменной среды `OMP_NUM_THREADS` должно быть положительным целым числом. Его воздействие зависит от того, включена ли Динамическая коррекция числа потоков. Полный набор правил взаимодействия между переменной среды `OMP_NUM_THREADS` и динамической настройкой потоков см. в [разделе 2,3](2-directives.md#23-parallel-construct).

Число используемых потоков определяется реализацией, если:

- не указана переменная среды `OMP_NUM_THREADS`,
- указанное значение не является положительным целым числом или
- значение больше максимального числа потоков, которое может поддерживать система.

Пример

```csh
setenv OMP_NUM_THREADS 16
```

### <a name="cross-references"></a>Перекрестные ссылки

- предложение [num_threads](2-directives.md#23-parallel-construct)
- Функция [omp_set_num_threads](3-run-time-library-functions.md#311-omp_set_num_threads-function)
- Функция [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="43-omp_dynamic"></a>4,3 OMP_DYNAMIC

Переменная среды `OMP_DYNAMIC` включает или отключает динамическую настройку количества потоков, доступных для выполнения параллельных регионов. `OMP_DYNAMIC` не учитывается, если динамическая настройка явно включена или отключена путем вызова подпрограммы библиотеки `omp_set_dynamic`. Его значение должно быть `TRUE` или `FALSE`.

Если `OMP_DYNAMIC` имеет значение `TRUE`, то количество потоков, используемых для выполнения параллельных регионов, может быть скорректировано средой выполнения для оптимального использования системных ресурсов.  Если `OMP_DYNAMIC` имеет значение `FALSE`, динамическая корректировка отключена. Условие по умолчанию определяется реализацией.

Пример

```csh
setenv OMP_DYNAMIC TRUE
```

### <a name="cross-references"></a>Перекрестные ссылки

- [Параллельные регионы](2-directives.md#23-parallel-construct)
- Функция [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="44-omp_nested"></a>4,4 OMP_NESTED

Переменная среды `OMP_NESTED` включает или отключает вложенный параллелизм, если только не включен или отключен вложенный параллелизм путем вызова подпрограммы библиотеки `omp_set_nested`. Если `OMP_NESTED` имеет значение `TRUE`, включен вложенный параллелизм. Если `OMP_NESTED` имеет значение `FALSE`, то вложенный параллелизм отключается. Значение по умолчанию — `FALSE`.

Пример

```csh
setenv OMP_NESTED TRUE
```

### <a name="cross-reference"></a>Перекрестная ссылка

- Функция [omp_set_nested](3-run-time-library-functions.md#319-omp_set_nested-function)
