---
title: 4. Переменные среды
ms.date: 01/16/2019
ms.assetid: 4ec7ed81-e9ca-46a1-84f8-8f9ce4587346
ms.openlocfilehash: 558b835c36253fb67339fba9b46cb0170dd6d1d0
ms.sourcegitcommit: 382e247c0f1b4cb7c2dab837b8b6fdff24bff47a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2019
ms.locfileid: "55087201"
---
# <a name="4-environment-variables"></a>4. Переменные среды

В этой главе описываются переменные среды OpenMP C и C++ API (или аналогичные механизмы платформы), контролировать выполнение параллельного кода.  Имена переменных среды необходимо использовать прописные буквы. Присвоенные им значения зависят от регистра символов и, возможно, начальные и конечные пробелы.  Изменений значений после запуска программы учитываются.

Ниже приведены переменные среды.

- [OMP_SCHEDULE](#41-omp_schedule) задает размер типа и блоков выполнения расписания.
- [OMP_NUM_THREADS](#42-omp_num_threads) задает число потоков, используемых во время выполнения.
- [OMP_DYNAMIC](#43-omp_dynamic) включает или отключает динамическую настройку количество потоков.
- [OMP_NESTED](#44-omp_nested) включает или отключает вложенных параллелизма.

Только в примерах в этой главе показано, как эти переменные могут быть установлены в средах-оболочках (csh) Unix C. В средах DOS и Korn-оболочки похожи действия:

csh:  
`setenv OMP_SCHEDULE "dynamic"`

ksh:  
`export OMP_SCHEDULE="dynamic"`

DOS:  
`set OMP_SCHEDULE="dynamic"`

## <a name="41-ompschedule"></a>4.1 OMP_SCHEDULE

`OMP_SCHEDULE` применяется только к `for` и `parallel for` директивы, которые имеют тип расписания `runtime`. Размер типа и блока расписание для таких циклов можно задать во время выполнения. Задать переменную среды для любого типа распознается расписание и необязательный *chunk_size*.

Для `for` и `parallel for` директивы, которые имеют тип расписания не `runtime`, `OMP_SCHEDULE` учитывается. Значение по умолчанию для этой переменной среды определяется реализацией. Если необязательный *chunk_size* имеет значение, значение должно быть положительным. Если *chunk_size* не задана, предполагается значение 1, кроме случаев, когда расписание `static`. Для `static` расписание, размер блока по умолчанию присваивается пространство итерации цикла, деленное на количество потоков, которые применены к циклу.

Пример

```csh
setenv OMP_SCHEDULE "guided,4"
setenv OMP_SCHEDULE "dynamic"
```

### <a name="cross-references"></a>Перекрестные ссылки

- [для](2-directives.md#241-for-construct) директива
- [Параллельные для](2-directives.md#251-parallel-for-construct) директива

## <a name="42-ompnumthreads"></a>4.2 OMP_NUM_THREADS

`OMP_NUM_THREADS` Переменной среды задает количество потоков, используемых во время выполнения по умолчанию. `OMP_NUM_THREADS` учитывается, если это число изменяется явно, вызвав `omp_set_num_threads` подпрограмма библиотеки. Он также учитывается, если явно `num_threads` предложение на `parallel` директива.

Значение `OMP_NUM_THREADS` переменной среды должно быть положительным целым числом. Ее результат зависит от того, включен ли динамическую настройку количество потоков. Доступен широкий набор правил о взаимодействии между `OMP_NUM_THREADS` среды переменных и динамические коррекции потоков, см. в разделе [разделе 2.3](2-directives.md#23-parallel-construct).

Количество потоков, используемых определяется от реализации, если:

- `OMP_NUM_THREADS` переменная среды не указан,
- положительное целое число, не указано или
- значение больше, чем максимальное количество потоков, которые система может поддерживать.

Пример

```csh
setenv OMP_NUM_THREADS 16
```

### <a name="cross-references"></a>Перекрестные ссылки

- [num_threads](2-directives.md#23-parallel-construct) предложение
- [omp_set_num_threads](3-run-time-library-functions.md#311-omp_set_num_threads-function) функции
- [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function) функции

## <a name="43-ompdynamic"></a>4.3 OMP_DYNAMIC

`OMP_DYNAMIC` Переменной среды, включает или отключает динамическую настройку количество потоков, доступных для выполнения параллельных регионов. `OMP_DYNAMIC` учитывается, если динамическую настройку явным образом включен или отключен, вызвав `omp_set_dynamic` подпрограмма библиотеки. Его значение должно быть `TRUE` или `FALSE`.

Если `OMP_DYNAMIC` присваивается `TRUE`, число потоков, которые используются для выполнения параллельных регионов можно менять в среде, лучше всего использовать системные ресурсы.  Если `OMP_DYNAMIC` присваивается `FALSE`, динамическую настройку отключен. Условие по умолчанию определяется реализацией.

Пример

```csh
setenv OMP_DYNAMIC TRUE
```

### <a name="cross-references"></a>Перекрестные ссылки

- [Параллельных регионов](2-directives.md#23-parallel-construct)
- [omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function) функции

## <a name="44-ompnested"></a>4.4 OMP_NESTED

`OMP_NESTED` Переменной среды, включает или отключает вложенный параллелизм, если не включен или отключен, вызвав вложенный параллелизм `omp_set_nested` подпрограмма библиотеки. Если `OMP_NESTED` присваивается `TRUE`, включен вложенный параллелизм. Если `OMP_NESTED` присваивается `FALSE`вложенного параллелизм отключен. Значение по умолчанию — `FALSE`.

Пример

```csh
setenv OMP_NESTED TRUE
```

### <a name="cross-reference"></a>Перекрестные ссылки

- [omp_set_nested](3-run-time-library-functions.md#319-omp_set_nested-function) функции
