---
title: 4. Переменные среды
ms.date: 01/16/2019
ms.assetid: 4ec7ed81-e9ca-46a1-84f8-8f9ce4587346
ms.openlocfilehash: e93c59654c17ed6dbfb7483ac2dce716ce24b52a
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370266"
---
# <a name="4-environment-variables"></a>4. Переменные окружающей среды

В этой главе описываются переменные среды OpenMP C и API (или аналогичные механизмы, связанные с платформой), которые контролируют выполнение параллельного кода.  Названия переменных среды должны быть верхними. Значения, присвоенные им, являются нечувствительными и могут иметь ведущее и захдненное белое пространство.  Изменения значений после начала программы игнорируются.

Переменные среды следующие:

- [OMP_SCHEDULE](#41-omp_schedule) устанавливает тип расписания выполнения и размер куска.
- [OMP_NUM_THREADS](#42-omp_num_threads) устанавливает количество потоков для использования во время выполнения.
- [OMP_DYNAMIC](#43-omp_dynamic) позволяет или отражает динамическую регулировку количества потоков.
- [OMP_NESTED](#44-omp_nested) позволяет или отстраивал о вложенность параллелизма.

Примеры в этой главе только демонстрируют, как эти переменные могут быть установлены в оболочках Unix C (csh) средах. В оболочках Korn и средах DOS действия схожи:

Csh:  
`setenv OMP_SCHEDULE "dynamic"`

Ksh:  
`export OMP_SCHEDULE="dynamic"`

Dos:  
`set OMP_SCHEDULE="dynamic"`

## <a name="41-omp_schedule"></a><a name="41-omp_schedule"></a>4.1 OMP_SCHEDULE

`OMP_SCHEDULE`применяется только `for` `parallel for` к директивам, `runtime`которые имеют тип расписания. Тип расписания и размер фрагмента для всех таких циклов могут быть установлены во время выполнения. Установите эту переменную среды к любому признанного типу расписания и дополнительному *chunk_size.*

Для `for` `parallel for` и директивы, которые имеют `runtime` `OMP_SCHEDULE` тип расписания, кроме , игнорируется. Значение по умолчанию для этой переменной среды определяется реализацией. Если установлен дополнительный *chunk_size,* значение должно быть положительным. Если *chunk_size* не установлена, предполагается значение 1, за `static`исключением случаев, когда расписание . Для `static` графика размер фрагмента по умолчанию устанавливается на пространство итерации цикла, разделенное на количество потоков, применяемых к циклу.

Пример.

```csh
setenv OMP_SCHEDULE "guided,4"
setenv OMP_SCHEDULE "dynamic"
```

### <a name="cross-references"></a>Перекрестные ссылки

- [для](2-directives.md#241-for-construct) директивы
- [параллель для](2-directives.md#251-parallel-for-construct) директивы

## <a name="42-omp_num_threads"></a><a name="42-omp_num_threads"></a>4.2 OMP_NUM_THREADS

Переменная `OMP_NUM_THREADS` среды устанавливает число потоков по умолчанию для использования во время выполнения. `OMP_NUM_THREADS`игнорируется, если это число явно изменено, позвонив в рутину библиотеки. `omp_set_num_threads` Он также игнорируется, если есть `num_threads` явное `parallel` положение о директиве.

Значение переменной `OMP_NUM_THREADS` среды должно быть положительным. Его эффект зависит от того, включена ли динамическая регулировка количества потоков. Для всеобъемлющего набора правил о `OMP_NUM_THREADS` взаимодействии переменной среды и динамической регулировки потоков см. [section 2.3](2-directives.md#23-parallel-construct)

Количество потоков для использования определяется реализацией, если:

- переменная среды `OMP_NUM_THREADS` не указана,
- указанное значение не является положительным рядом, или
- значение больше, чем максимальное количество потоков, которые система может поддерживать.

Пример.

```csh
setenv OMP_NUM_THREADS 16
```

### <a name="cross-references"></a>Перекрестные ссылки

- [положение num_threads](2-directives.md#23-parallel-construct)
- [функция omp_set_num_threads](3-run-time-library-functions.md#311-omp_set_num_threads-function)
- [функция omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="43-omp_dynamic"></a><a name="43-omp_dynamic"></a>4.3 OMP_DYNAMIC

Переменная `OMP_DYNAMIC` среды позволяет или отменяет динамическую регулировку количества потоков, доступных для выполнения параллельных регионов. `OMP_DYNAMIC`игнорируется, когда динамическая регулировка явно `omp_set_dynamic` включена или отключена при вызове рутины библиотеки. Его значение `TRUE` должно `FALSE`быть или .

Если `OMP_DYNAMIC` `TRUE`установлено, количество потоков, используемых для выполнения параллельных регионов, может быть скорректировано средой времени выполнения с целью оптимального использования системных ресурсов.  Если `OMP_DYNAMIC` настроен `FALSE`на динамическую регулировку, динамическая регулировка отключена. Условие по умолчанию определено.

Пример.

```csh
setenv OMP_DYNAMIC TRUE
```

### <a name="cross-references"></a>Перекрестные ссылки

- [Параллельные регионы](2-directives.md#23-parallel-construct)
- [функция omp_set_dynamic](3-run-time-library-functions.md#317-omp_set_dynamic-function)

## <a name="44-omp_nested"></a><a name="44-omp_nested"></a>4.4 OMP_NESTED

Переменная `OMP_NESTED` среды позволяет или отключает вложенный параллелизм, если `omp_set_nested` вложенный параллелизм не включен или отключен, вызывая рутину библиотеки. Если `OMP_NESTED` настроен `TRUE`на вложенный параллелизм включен. Если `OMP_NESTED` установлен `FALSE`на, вложенный параллелизм отключен. Значение по умолчанию — `FALSE`.

Пример.

```csh
setenv OMP_NESTED TRUE
```

### <a name="cross-reference"></a>Перекрестная ссылка

- [функция omp_set_nested](3-run-time-library-functions.md#319-omp_set_nested-function)
