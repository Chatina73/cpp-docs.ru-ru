---
title: Выбор метода развертывания
ms.date: 03/14/2019
helpviewer_keywords:
- redistributing DLLs
- manifests [C++]
- DLLs [C++], redistributing
- side-by-side assemblies [C++]
- dynamic linking [C++]
- application deployment [C++], methods
- deploying applications [C++], methods
- static linking [C++]
- libraries [C++], application deployment issues
ms.assetid: fd8eb956-f4a0-4ffb-b401-328c73e66986
ms.openlocfilehash: 633b76458fdc24ef9ba551d8209c5c99720df37e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81377397"
---
# <a name="choosing-a-deployment-method"></a>Выбор метода развертывания

Рекомендуется всегда использовать для развертывания установщик Windows, если приложение Visual C++ не является автономным и не обладает возможностью развертывания с помощью команды копирования. Установщик Windows поддерживает установку, восстановление и удаление, а также поддерживает атомарное обновления файлов приложения, зависимостей и записей реестра.

> [!NOTE]
> Хотя развертывание [ClickOnce](/visualstudio/deployment/clickonce-security-and-deployment) для собственных приложений Visual C++ возможно в Visual Studio, оно требует дополнительных действий. Дополнительные сведения см. в разделе [ClickOnce Deployment for Visual C++ Applications](clickonce-deployment-for-visual-cpp-applications.md).

## <a name="visual-c-libraries-are-shared-dlls"></a>Библиотеки Visual C++ — общие библиотеки DLL

Поскольку библиотеки Visual C++ устанавливаются в каталог %windir%\system32\ установщиком Visual Studio, при разработке приложения Visual C++, зависящего от них, оно выполняется без ошибок. Однако для развертывания приложения на компьютерах, где может быть не установлена Visual Studio, рекомендуется обеспечивать установку этих библиотек на такие компьютеры вместе с приложением.

## <a name="redistributing-visual-c-libraries"></a>Распространение библиотек Visual С++

В развертываниях можно распространять любую версию библиотеки Visual C++, которая лицензирована для распространения. Развертывание можно выполнить тремя способами.

- Централизованное развертывание с помощью распространяемых пакетов, что установит библиотеки Visual C++ в качестве общих библиотек DLL в %windir%\system32\\. (Установка в этой папке требует прав администратора.) Перед установкой приложения на целевой компьютер можно создать программу скрипта или настройки, которая запускает пакет с перераспределительной системой. Предлагаются распространяемые пакеты для платформ x86, x64 и ARM (VCRedist_x86.exe, VCRedist_x64.exe и VCRedist_arm.exe). Visual Studio включает эти пакеты в %ProgramFiles(x86)%\Microsoft Visual Studio `version`\VC\Redist\\`locale ID`\\. Вы также можете скачать их в [Центре загрузки Майкрософт](https://www.microsoft.com/download). (Используйте поле поиска в Центре загрузки, чтобы найти "распространяемый пакет Visual C++ *версия и обновление Visual Studio*", соответствующий вашему приложению. Например, если вы использовали обновление Visual Studio 2015 3 для создания приложения, то ищите обновление «Visual C» Redistributable Package 2015 3».) Для получения информации о том, как использовать [Walkthrough: Deploying a Visual C++ Application By Using the Visual C++ Redistributable Package](deploying-visual-cpp-application-by-using-the-vcpp-redistributable-package.md)пакет с перераспределительной, см.

- Централизованное развертывание с помощью модулей слияния, каждый из которых устанавливает определенную библиотеку Visual C++ в качестве общей библиотеки DLL в %windir%\system32\\. (Установка этой папки требует прав администратора.) Модули слияния становятся частью файла установки .msi для вашего приложения. Распространяемые модули слияния Visual C++ включены в Visual Studio, папка \Program Files (x86)\Common Files\Merge Modules\\. Дополнительные сведения см. в разделе [Распространение с использованием модулей слияния](redistributing-components-by-using-merge-modules.md).

- Локальное развертывание, при котором вы копируете определенные библиотеки DLL Visual C++ из установки Visual Studio — обычно в папку \Program Files (x86)\Microsoft Visual Studio `version`\VC\Redist\\`platform`\\`library`\ — и устанавливаете их на целевые компьютеры в ту же папку, где находится исполняемый файл приложения. Этот метод развертывания можно использовать для обеспечения возможности установки пользователями, у которых нет прав администратора, или для приложений, которые могут быть запущены из общей сетевой папки.

Если развертывание использует распространяемые модули слияния и установка выполняется пользователем, который не имеет прав администратора, библиотеки DLL Visual C++ не устанавливаются и приложение не будет работать. Также установщики приложений, собранные с использованием модулей слияния, позволяющих выполнять установку для отдельных пользователей, устанавливают эти библиотеки в место совместного доступа, которое оказывает влияние на всех пользователей системы. Локальное развертывание можно использовать для установки необходимых библиотек DLL Visual C++ в каталог приложения определенного пользователя, не оказывая влияния на других пользователей, и для этого не требуются права администратора. Так как это может создать проблемы при обслуживании, не рекомендуется использовать локальное развертывание распространяемых библиотек DLL Visual C++.

Неверное развертывание библиотек Visual C++ может привести к ошибкам во время выполнения при выполнении приложения, которое зависит от этих библиотек. Когда операционная система загружает приложение, оно использует порядок поиска, описанный в [LoadLibraryEx.](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryexw)

## <a name="dynamic-linking-is-better-than-static-linking"></a>Динамическое связывание лучше, чем статическое связывание

Рекомендуется избегать статического связывания при распространении библиотек Visual C++. Хотя статическое связывание почти никогда не приводит к значительному повышению производительности приложения, оно почти всегда выполняет усложняет обслуживание. Например, рассмотрим приложение, которое статически связано с библиотекой, обновляемой с применением усовершенствований системы безопасности — это приложение не сможет использовать преимущества обновления без повторной компиляции и повторного развертывания. Вместо этого рекомендуется динамически связывать приложения с библиотеками, от которых они зависят, чтобы библиотеки могли обновляться независимо от того, где они развернуты.

## <a name="see-also"></a>См. также раздел

[Развертывание классических приложений](deploying-native-desktop-applications-visual-cpp.md)<br>
[ClickOnce безопасности и развертывания](/visualstudio/deployment/clickonce-security-and-deployment)<br>
[Примеры развертывания](deployment-examples.md)
