---
title: Развертывание универсальной библиотеки CRT
ms.date: 05/11/2018
helpviewer_keywords:
- deploying the CRT [C++]
- application CRT deployment [C++]
ms.openlocfilehash: 1f6e685cca65c4b31ac2e6147341c4b5a3fe8228
ms.sourcegitcommit: 6cf0c67acce633b07ff31b56cebd5de3218fd733
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/24/2019
ms.locfileid: "67344460"
---
# <a name="universal-crt-deployment"></a>Развертывание универсальной библиотеки CRT

Начиная с Visual Studio .NET и заканчивая Visual Studio 2013 каждый основной выпуск инструментов и компилятора C++ содержал новую автономную версию библиотеки среды выполнения C (CRT) корпорации Майкрософт. Эти автономные версии CRT были независимыми друг от друга и в различной степени несовместимыми друг с другом. Например, библиотека CRT, используемая Visual Studio 2012, имела версию 11 и имя msvcr110.dll, а CRT в Visual Studio 2013 имела версию 12 и имя msvcr120.dll. Начиная с Visual Studio 2015, он больше не так. В Visual Studio 2015 и более поздних версиях используется одна универсальная CRT.

Универсальной среды Выполнения — это компонент операционной системы Microsoft Windows, входящей в состав операционной системы в Windows 10. Он доступен для старых операционных систем Windows Vista до Windows 8.1 с помощью центра обновления Windows. Поддерживается локальное развертывание универсальной среды выполнения, с некоторыми ограничениями.

## <a name="central-deployment"></a>Централизованное развертывание

Предпочитаемый способ централизованной установки универсальной CRT — Центр обновления Microsoft Windows. Универсальная CRT является рекомендуемым обновлением для всех поддерживаемых операционных систем Microsoft Windows, поэтому многие компьютеры устанавливают ее по умолчанию в рамках обычного процесса обновления. Первоначальным выпуском универсальной CRT была [KB2999226](https://support.microsoft.com/kb/2999226). Была сделана более позднем обновлении с исправлены различные ошибки в [KB3118401](https://support.microsoft.com/kb/3118401), и были внесены дополнительные обновления дальнейшего исправления ошибок и новые функции. Чтобы получить более актуальные обновления, выполните поиск по запросам "Universal C Runtime" (Универсальная среда выполнения C) или "Universal CRT" (Универсальная CRT) на сайте [support.microsoft.com](https://support.microsoft.com).

Не все компьютеры с Microsoft Windows регулярно получают обновления через Центр обновления Windows, а на некоторых могут устанавливаться не все рекомендуемые обновления. Для поддержки использования приложений, созданных с помощью Visual Studio 2015 и более поздние версии C++ наборы инструментов на этих компьютерах существует универсальной CRT распространяемые файлы для распространения вне сети. Эти распространяемые файлы загружаются из одного из приведенных выше ссылок КБ. Распространяемый пакет универсальной среды Выполнения требует, что компьютер был обновлен для текущего пакета обновления. Например, распространяемый пакет для Windows 7 будет устанавливаться только в Windows 7 с пакетом обновления 1 (SP1), но не в Windows 7 RTM.

Поскольку универсальной среды Выполнения является одной из основных зависимостей C++ библиотек, визуальный элемент C++ распространяемый пакет (VCRedist) устанавливает первоначальной версии универсальной среды Выполнения (версия 10.0.10240) на компьютерах, которые еще не установлен. Эта версия достаточно для удовлетворения C++ библиотеки из зависимостей. Если приложение зависит от последней версии универсальной среды выполнения, необходимо использовать Центр обновления Windows для перевода компьютера актуальное или явным образом установить эту версию. Лучше всего установить универсальной среды выполнения C с помощью центра обновления Windows или MSU, до установки VCRedist, чтобы избежать потенциальных несколько необходимых перезагрузок.

Не все операционные системы, подходят для самой последней универсальная среда выполнения C с помощью центра обновления Windows. В Windows 10 развертывается централизованно версия совпадает с версией операционной системы. Кроме того, чтобы обновить универсальная среда выполнения C необходимо обновить операционную систему. Для Windows Vista до Windows 8.1 последние доступные универсальной среды выполнения C в настоящее время зависит от версии, включенной в Юбилейное обновление Windows 10, с помощью дополнительных исправлений (версии 10.0.14393).

## <a name="local-deployment"></a>Локальное развертывание

Локальное развертывание универсальной CRT поддерживается, хотя и не рекомендуется по соображениям безопасности и производительности. Библиотеки DLL для локального развертывания входят в состав пакета Windows SDK и находятся в подкаталоге Kits\\10\\Redist\\ucrt\\DLLs согласно архитектуре компьютера. Требуемые библиотеки DLL содержат ucrtbase.dll и набор библиотек DLL переадресации APISet с именем api-ms-win-\*.dll. Изменяется набор библиотек DLL, необходимых для каждой операционной системы. Настоятельно рекомендуется включать все библиотеки DLL при развертывании локально.

Для локального развертывания существует два ограничения, которые следует учитывать:

- В Windows 10 универсальная CRT, расположенная в системном каталоге, используется всегда, даже если приложение имеет собственную локальную копию универсальной CRT. Верно, даже в том случае, если локальная копия новее, поскольку универсальной среды Выполнения является основным компонентом операционной системы в Windows 10.

- В версиях Windows до Windows 8, универсальной среды Выполнения не могут быть упакованы локально с помощью подключаемого модуля, если он находится в каталоге, отличном от каталог основного исполняемого файла приложения. В этом случае библиотеки DLL сервера пересылки APISet не могут успешно разрешить ucrtbase.dll. К рекомендуемым альтернативным способам относятся следующие.

  - Статическая компоновка универсальной CRT.
  - Централизованное развертывание универсальной CRT.
  - Помещение файлов универсальной CRT в один каталог с приложением.

## <a name="deployment-on-microsoft-windows-xp"></a>Развертывание в Microsoft Windows XP

Visual Studio 2015 и Visual Studio 2017 по-прежнему поддерживают разработку программного обеспечения для использования в Microsoft Windows XP. Для поддержки этой разработки, версии универсальной среды выполнения работы в Microsoft Windows XP. Для операционной системы Microsoft Windows XP больше не предоставляется ни основная, ни расширенная поддержка, поэтому централизованное развертывание универсальной CRT в Microsoft Windows XP отличается от других операционных систем.

Когда визуальный C++ распространяемый компонент установлен в операционной системе Windows XP, он непосредственно устанавливает универсальной CRT и все его зависимости в системном каталоге. Он не установить или зависят от любого обновления Windows. Распространяемые модули слияния — файлы Microsoft_VC*версия*_CRT_\*.msm — делают то же самое.

Локальное развертывание универсальной CRT в Windows XP осуществляется так же, как и в других поддерживаемых операционных системах.

## <a name="see-also"></a>См. также

- [Развертывание в Visual C++](deployment-in-visual-cpp.md)
