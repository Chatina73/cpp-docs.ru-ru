---
title: Развертывание универсальной библиотеки CRT
ms.date: 05/11/2018
helpviewer_keywords:
- deploying the CRT [C++]
- application CRT deployment [C++]
ms.openlocfilehash: 90f859eb0e9134c997e7eecad118cfb8ec00b782
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2019
ms.locfileid: "58786469"
---
# <a name="universal-crt-deployment"></a>Развертывание универсальной библиотеки CRT

Начиная с Visual Studio .NET и заканчивая Visual Studio 2013 каждый основной выпуск инструментов и компилятора C++ содержал новую автономную версию библиотеки среды выполнения C (CRT) корпорации Майкрософт. Эти автономные версии CRT были независимыми друг от друга и в различной степени несовместимыми друг с другом. Например, библиотека CRT, используемая Visual Studio 2012, имела версию 11 и имя msvcr110.dll, а CRT в Visual Studio 2013 имела версию 12 и имя msvcr120.dll. Начиная с Visual Studio 2015 все изменилось. В Visual Studio 2015 и более поздних версиях используется одна универсальная CRT.

Эта универсальная CRT является компонентом операционной системы Microsoft Windows. Она входит в состав операционной системы Windows 10 и доступна через Центр обновления Windows для старых операционных систем от Windows Vista до Windows 8.1. Кроме того, локальное развертывание универсальной CRT поддерживается с некоторыми ограничениями.

## <a name="central-deployment"></a>Централизованное развертывание

Предпочитаемый способ централизованной установки универсальной CRT — Центр обновления Microsoft Windows. Универсальная CRT является рекомендуемым обновлением для всех поддерживаемых операционных систем Microsoft Windows, поэтому многие компьютеры устанавливают ее по умолчанию в рамках обычного процесса обновления. Первоначальный выпуск универсальной CRT относился к [KB2999226](https://support.microsoft.com/kb/2999226); последующее обновление с различными исправлениями было внесено в [KB3118401](https://support.microsoft.com/kb/3118401), кроме того, были выпущены дополнительные обновления с исправлениями и новыми функциями. Чтобы получить более актуальные обновления, выполните поиск по запросам "Universal C Runtime" (Универсальная среда выполнения C) или "Universal CRT" (Универсальная CRT) на сайте [support.microsoft.com](https://support.microsoft.com).

Не все компьютеры с Microsoft Windows регулярно получают обновления через Центр обновления Windows, а на некоторых могут устанавливаться не все рекомендуемые обновления. Чтобы обеспечить работу приложений, созданных с использованием наборов инструментов C++ в Visual Studio 2015 и более поздних версий, на этих компьютерах, доступны распространяемые пакеты универсальной CRT для автономного распространения. Эти распространяемые пакеты можно скачать по одной из приведенных выше ссылок на базу знаний. Обратите внимание, что распространяемые пакеты универсальной CRT требуют наличия на компьютере актуального пакета обновления. Например, распространяемый пакет для Windows 7 будет устанавливаться только в Windows 7 с пакетом обновления 1 (SP1), но не в Windows 7 RTM.

Так как универсальная CRT является фундаментальной зависимостью библиотек C++, распространяемый пакет Visual C++ (VCRedist) устанавливает базовую версию универсальной CRT на компьютерах, где этот компонент отсутствует, чего достаточно для удовлетворения зависимостей библиотек C++. Если ваше приложение зависит от более поздней версии универсальной CRT, нужно явно установить более позднюю версию. Рекомендуется установить ее до установки VCRedist, в противном случае может потребоваться несколько перезагрузок.

## <a name="local-deployment"></a>Локальное развертывание

Локальное развертывание универсальной CRT поддерживается, хотя и не рекомендуется по соображениям безопасности и производительности.  Библиотеки DLL для локального развертывания входят в состав пакета Windows SDK и находятся в подкаталоге Kits\\10\\Redist\\ucrt\\DLLs согласно архитектуре компьютера. Требуемые библиотеки DLL содержат ucrtbase.dll и набор библиотек DLL переадресации APISet с именем api-ms-win-\*.dll. Для каждой операционной системы требуется разный набор библиотек DLL, поэтому при локальном развертывании настоятельно рекомендуется включать все библиотеки DLL.

Для локального развертывания существует два ограничения, которые следует учитывать:

- В Windows 10 универсальная CRT, расположенная в системном каталоге, используется всегда, даже если приложение имеет собственную локальную копию универсальной CRT. Это справедливо, даже если локальная копия универсальной CRT имеет более новую версию. Это вызвано тем, что универсальная CRT является ключевым компонентом операционной системы Windows 10.

- В операционных системах, выпущенных до Windows 8, универсальную CRT невозможно упаковать локально с помощью подключаемого модуля, который расположен в каталоге, отличном от того, где находится главный исполняемый файл приложения. В этом случае библиотеки DLL сервера пересылки APISet не могут успешно разрешить ucrtbase.dll. К рекомендуемым альтернативным способам относятся следующие.

  - Статическая компоновка универсальной CRT.
  - Централизованное развертывание универсальной CRT.
  - Помещение файлов универсальной CRT в один каталог с приложением.

## <a name="deployment-on-microsoft-windows-xp"></a>Развертывание в Microsoft Windows XP

Visual Studio 2015 и Visual Studio 2017 по-прежнему поддерживают разработку программного обеспечения для использования в Microsoft Windows XP. Для этого версия универсальной CRT работает и в Microsoft Windows XP. Для операционной системы Microsoft Windows XP больше не предоставляется ни основная, ни расширенная поддержка, поэтому централизованное развертывание универсальной CRT в Microsoft Windows XP отличается от других операционных систем.

При установке распространяемого пакета Visual C++ в Windows XP он непосредственно устанавливает универсальную CRT и все ее зависимости в системный каталог, не устанавливая никакие обновления Windows и не создавая зависимости от них. Распространяемые модули слияния — файлы Microsoft_VC*версия*_CRT_\*.msm — делают то же самое.

Локальное развертывание универсальной CRT в Windows XP осуществляется так же, как и в других поддерживаемых операционных системах.

## <a name="see-also"></a>См. также

- [Развертывание в Visual C++](deployment-in-visual-cpp.md)
