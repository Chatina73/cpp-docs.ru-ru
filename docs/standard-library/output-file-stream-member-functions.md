---
title: Функции-члены потока выходного файла
ms.date: 11/04/2016
helpviewer_keywords:
- output streams [C++], member functions
ms.assetid: 38aaf710-8035-4a34-a0c4-123a5327f28a
ms.openlocfilehash: eba627c69437754a9c0a819167443aa00c025fef
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50621771"
---
# <a name="output-file-stream-member-functions"></a>Функции-члены потока выходного файла

Функции-члены потока вывода делятся на три типа: эквивалентные манипуляторам, выполняющие неформатированные операции записи и изменяющие состояние потока другим образом и при этом не имеющие эквивалентных манипуляторов или операторов вставки. Для последовательного форматированного вывода можно использовать только операторы вставки и манипуляторы. Для двоичного дискового вывода с произвольным доступом следует использовать другие функции-члены с операторами вставки или без них.

## <a name="the-open-function-for-output-streams"></a>Функция open для потоков вывода

Чтобы использовать файловый поток вывода ([ofstream](../standard-library/basic-ofstream-class.md)), этот поток необходимо связать с конкретным файлом на диске в конструкторе или `open` функции. Если вы используете `open` функции, можно повторно использовать один и тот же объект потока, используя набор файлов. В любом случае аргументы, описывающие файл, одни и те же.

При открытии файла, связанного с потоком вывода, обычно указывается `open_mode` флаг. Эти флаги, определенные как перечислители в классе `ios`, можно комбинировать с помощью побитового оператора OR (&#124;). Список перечислителей приведен в разделе [ios_base::openmode](../standard-library/ios-base-class.md#openmode).

Три типовые ситуации для потока вывода используют параметры режима:

- Создание файла. Если файл уже существует, старая версия удаляется.

   ```cpp
   ostream ofile("FILENAME");
   // Default is ios::out

   ofstream ofile("FILENAME", ios::out);
   // Equivalent to above
   ```

- Добавление записей к существующему файлу или создание нового, если он не существует.

   ```cpp
   ofstream ofile("FILENAME", ios::app);
   ```

- Открытие двух файлов в одном и том же потоке, по одному за раз.

   ```cpp
   ofstream ofile();
   ofile.open("FILE1", ios::in);
   // Do some output
   ofile.close();    // FILE1 closed
   ofile.open("FILE2", ios::in);
   // Do some more output
   ofile.close();    // FILE2 closed
   // When ofile goes out of scope it is destroyed.
   ```

## <a name="the-put"></a>Put

Функция **put** записывает в поток вывода один символ. Следующие две конструкции по умолчанию одинаковы, но вторая зависит от аргументов формата потока:

```cpp
cout.put('A');

// Exactly one character written
cout <<'A'; // Format arguments 'width' and 'fill' apply
```

## <a name="the-write"></a>Запись

`write` Функция записывает блок памяти в файловый поток вывода. Аргумент length указывает количество записанных байт. Следующий пример создает файловый поток вывода и записывает в него двоичное значение структуры `Date`:

```cpp
// write_function.cpp
// compile with: /EHsc
#include <fstream>
using namespace std;

struct Date
{
   int mo, da, yr;
};

int main( )
{
   Date dt = { 6, 10, 92 };
   ofstream tfile( "date.dat" , ios::binary );
   tfile.write( (char *) &dt, sizeof dt );
}
```

`write` Функция не останавливается при достижении символа null, поэтому записывается полная структура класса. Функция принимает два аргумента: **char** указатель и число символов для записи. Обратите внимание, необходимость преобразования в тип **char** <strong>\*</strong> перед адресом объекта-структуры.

## <a name="the-seekp-and-tellp-functions"></a>Функции seekp и tellp

Файловый поток вывода хранит внутренний указатель на позицию следующей записи данных. Функция-член `seekp` устанавливает этот указатель, предоставляя тем самым вывод произвольного доступа в дисковый файл. Функция-член `tellp` возвращает позицию в файле. Примеры использования эквивалентов входного потока для `seekp` и `tellp` см. в разделе [Функции seekg и tellg](../standard-library/input-stream-member-functions.md).

## <a name="the-close-function-for-output-streams"></a>Функция close для потоков вывода

`close` Функция-член закрывает дисковый файл, связанный с файловым потоком вывода. Для завершения всех операций вывода на диск файл должен быть закрыт. При необходимости `ofstream` деструктор закрывает файл, но можно использовать `close` работать, если вам нужно открыть другой файл для одного объекта stream.

Деструктор потока вывода автоматически закрывает поток файла, только если конструктор или `open` функция-член открыт файл. Если конструктору передается дескриптор для уже открытого файла или используйте `attach` функция-член, необходимо явно закрыть файл.

## <a name="vclrferrorprocessingfunctionsanchor10"></a> Функции обработки ошибок

Используйте эти функции-члены для проверки на ошибки при записи в поток:

|Функция|Возвращаемое значение|
|--------------|------------------|
|[bad](basic-ios-class.md#bad)|Возвращает значение **true** в случае неустранимой ошибки.|
|[fail](basic-ios-class.md#fail)|Возвращает значение **true** при неустранимой ошибке или "ожидаемом" условии, например при ошибке преобразования или если файл не найден. Обработку часто можно возобновить после вызова `clear` с нулевым аргументом.|
|[good](basic-ios-class.md#good)|Возвращает значение **true**, если нет ошибок (неустранимых или других) и флаг конца файла не установлен.|
|[eof](basic-ios-class.md#eof)|Возвращает значение **true** при достижении конца файла.|
|[clear](basic-ios-class.md#clear)|Устанавливает внутреннее состояние ошибки. Если вызывается с аргументами по умолчанию, он очищает все биты ошибок.|
|[rdstate] (basic-ios-class.md #rdstate|Возвращает текущее состояние ошибки.|

Оператор **!** перегружается для выполняют ту же функцию, как `fail` функции. Таким образом выражение:

```cpp
if(!cout)...
```

эквивалентно выражению:

```cpp
if(cout.fail())...
```

Оператор **void\*()** перегружается, чтобы быть противоположностью оператора **!**; таким образом выражение:

```cpp
if(cout)...
```

эквивалентно:

```cpp
if(!cout.fail())...
```

**Void\*()** оператор не эквивалентен `good` , так как он не выполняет проверку для конца файла.

## <a name="see-also"></a>См. также

[Потоки вывода](../standard-library/output-streams.md)<br/>
