---
title: Извлечение функции
ms.date: 11/16/2016
ms.assetid: e31d1249-9705-4511-acbd-9f6fe73bdf2d
ms.openlocfilehash: 41a488b067bce750224f3785e311f91d43dc31ca
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50571032"
---
# <a name="extract-function"></a>Извлечение функции
**Что?** Вы можете преобразовать фрагмент кода в отдельную функцию.

**Когда?** Если в какой-либо функции существует фрагмент кода, который должен вызываться в другой функции.

**Зачем?** Вы можете скопировать и вставить этот код, но это приведет к дублированию.  Лучше выполнить рефакторинг этого фрагмента в отдельную функцию, которую можно свободно вызывать в любой другой функции.

**Как?**

1. Выделите код, который требуется извлечь:

   ![Выделенный код](images/extractfunction_highlight.png)

1. Затем выполните одно из следующих действий:
   * **Клавиатура**
     * Нажмите клавиши **CTRL+R**, а затем — **CTRL+M**.  (Обратите внимание, что сочетание клавиш может отличаться в зависимости от выбранного профиля.)
     * Нажмите клавиши **CTRL + .**, чтобы активировать меню **Быстрые действия и рефакторинг**. Затем выберите в контекстном меню пункт **Извлечь функцию (экспериментальная)**.
   * **Мышь**
     * Выберите **Правка > Рефакторинг > Извлечь функцию (экспериментальная)**.
     * Щелкните код правой кнопкой мыши и выберите меню **Быстрые действия и рефакторинг**. Затем выберите в контекстном меню пункт **Извлечь функцию (экспериментальная)**.
     * Щелкните значок ![лампочки](images/bulb.png), появившийся в левом поле, а затем выберите в контекстном меню пункт **Извлечь функцию (экспериментальная)**.

1. В окне **Извлечь функцию или метод (экспериментальная функция)** введите имя новой функции, укажите, куда нужно поместить код, и нажмите кнопку **ОК**.

   ![Диалоговое окно "Извлечь функцию"](images/extractfunction_dialog.png)

1. Функция создается в указанном расположении, а прототип функции в соответствующем файле заголовка и исходный код изменяются для вызова этой функции.

   ![Результат извлечения функции](images/extractfunction_result.png)
