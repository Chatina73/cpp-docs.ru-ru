---
title: Определение библиотек DLL для распространения
ms.date: 06/08/2018
helpviewer_keywords:
- redistributing DLLs
- DLLs [C++], redistributing
- dependencies [C++], application deployment and
- application deployment [C++], DLL redistribution
- deploying applications [C++], DLL redistribution
ms.assetid: f7a2cb42-fb48-42ab-abd2-b35e2fd5601a
ms.openlocfilehash: ee81fb1560133b2777a33e80d32c0e2e55c01bf4
ms.sourcegitcommit: dedd4c3cb28adec3793329018b9163ffddf890a4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2019
ms.locfileid: "57749091"
---
# <a name="determining-which-dlls-to-redistribute"></a>Определение библиотек DLL для распространения

Если вы разработали приложение, использующее библиотеки DLL из Visual Studio, для его запуска на компьютерах пользователей также должны присутствовать эти библиотеки. Поскольку у большинства пользователей, скорее всего, отсутствует Visual Studio, необходимо передать им эти файлы. В Visual Studio эти библиотеки DLL доступны в составе *распространяемых файлов*, которые можно включить в состав установщика приложения.

Для облегчения включения этих распространяемых библиотек DLL в состав установщика они доступны в виде отдельных *распространяемых пакетов*. Это привязанные к определенной архитектуре исполняемые файлы, использующие центральное развертывание для установки распространяемых файлов на компьютер пользователя. Например, vcredist\_x86.exe устанавливает 32-разрядные библиотеки для компьютеров x86, vcredist\_x64.exe — 32- и 64-разрядные библиотеки для компьютеров x64, а vcredist\_ARM.exe — библиотеки для компьютеров ARM. Рекомендуется использовать центральное развертывание, так как корпорация Майкрософт может использовать службу Центра обновления Windows для обновления этих библиотек независимо друг от друга. Кроме копии в установке Visual Studio, для загрузки доступны текущие распространяемые пакеты. Ссылки на новейшие поддерживаемые распространяемые пакеты для актуальных и более старых наборов инструментов см. в разделе [Последние поддерживаемые скачиваемые файлы для Visual C++](https://support.microsoft.com/help/2977003/the-latest-supported-visual-c-downloads). Отдельные более ранние версии распространяемых пакетов можно найти в [Центре загрузки Майкрософт](http://go.microsoft.com/fwlink/p/?LinkId=158431) по запросу "Распространяемые пакеты Visual C++".

Основной номер версии развертываемого вами распространяемого пакета должен соответствовать версии набора инструментов Visual Studio, используемого для создания приложения, а дополнительный номер версии должен быть аналогичным или выше. Visual Studio 2017 и Visual Studio 2015 имеют совместимые номера версии набора инструментов, то есть распространяемые файлы Visual Studio 2017 могут использовать приложения, разработанные с помощью набора инструментов Visual Studio 2015. Хотя они могут быть совместимыми, мы не поддерживаем использование распространяемых файлов Visual Studio 2015 в приложениях, разработанных с помощью набора инструментов Visual Studio 2017. Поддерживается только использование распространяемого пакета, который имеет такую же версию, что и набор инструментов, или более позднюю.

Другой способ включения распространяемых библиотек DLL в установщик заключается в использовании *модулей слияния*. Эти модули установщика Майкрософт входят в состав установщика приложений и устанавливаются им. Модули слияния для распространяемых библиотек DLL находятся в подкаталоге \\VC\\Redist\MSVC\\*версия*\\MergeModules\\ каталога установки Visual Studio. В более ранних версиях Visual Studio эти файлы находятся в подкаталоге Common Files\\Merge Modules каталога \\Program Files или \\Program Files (x86). Дополнительные сведения об использовании этих файлов см. в разделе [Распространение компонентов с использованием модулей слияния](../ide/redistributing-components-by-using-merge-modules.md).

Отдельные распространяемые библиотеки DLL также включены в состав установки Visual Studio. По умолчанию они устанавливаются в подкаталог \\VC\\Redist\\MSVC\\*версия* каталога установки Visual Studio. Номера *версии* могут представлять различные дополнительные номера версии сборки для одного общего набора распространяемых файлов. Используйте последнюю версию любого файла библиотеки DLL, распространяемого пакета или модуля слияния в этих каталогах. Вы можете использовать эти библиотеки для локального развертывания, установив их в одном каталоге с приложением. Мы не рекомендуем локальное развертывание, так как тогда вам потребуется самостоятельно получать обновления для развернутых приложений. Предпочтительным является центральное развертывание с использованием распространяемых пакетов.

Чтобы определить, какие библиотеки DLL необходимо повторно распространить вместе с приложением, составьте список библиотек DLL, от которых зависит приложение. Обычно они указываются в виде входных данных импорта библиотек для компоновщика. Некоторые библиотеки, такие как vcruntime и универсальная библиотека времени выполнения языка C (UCRT), включаются по умолчанию. Если ваше приложение или одна из его зависимостей используют LoadLibrary для динамической загрузки библиотеки DLL, последняя может отсутствовать во входных данных компоновщика. Составить список динамически загружаемых библиотек DLL можно, например, запустив для своего приложения средство Dependency Walker (depends.exe), как описано в разделе [Основные сведения о зависимостях приложения Visual C++](../ide/understanding-the-dependencies-of-a-visual-cpp-application.md). К сожалению, это средство устарело и может сообщить о том, что не удается найти некоторые библиотеки DLL.

Составив список зависимостей, сравните его со списком из файла Redist.txt, расположенного в каталоге установки Microsoft Visual Studio, или со "списком REDIST" распространяемых библиотек DLL, на который ссылается раздел "Файлы распространяемого кода" условий лицензионного соглашения на использование программного обеспечения корпорации Майкрософт для вашей копии Visual Studio. Для Visual Studio 2017 см. раздел [Распространяемый код для Microsoft Visual Studio 2017 (включает служебные программы, возможности расширяемости и файлы BuildServer)](http://go.microsoft.com/fwlink/p/?linkid=823098). Для Visual Studio 2015 см. раздел [Распространяемый код для Microsoft Visual Studio 2015 и пакета SDK для Microsoft Visual Studio 2015 (включает служебные программы и файлы BuildServer)](http://go.microsoft.com/fwlink/p/?linkid=799794). Для Visual Studio 2013 этот список можно найти в разделе [Распространяемый код для Microsoft Visual Studio 2013 и Microsoft Visual Studio 2013 SDK](http://go.microsoft.com/fwlink/p/?LinkId=313603).

В версиях Visual Studio, предшествующих Visual Studio 2015, библиотека времени выполнения языка C (CRT) была включена в msvc*версия*.dll в качестве распространяемой библиотеки DLL. Начиная с Visual Studio 2015 был проведен рефакторинг функций CRT в vcruntime и UCRT. UCRT теперь является системным компонентом в Windows 10, управляемым Центром обновления Windows. Она доступна во всех операционных системах Windows 10. Для развертывания приложения в более ранних операционных системах может потребоваться распространить и UCRT. Ранние версии UCRT входили в состав распространяемых файлов Visual Studio, которые устанавливаются только в операционных системах, предшествующих Windows 10, и только при отсутствии любой установленной версии UCRT. Сведения об устанавливаемой версии UCRT для систем прежних версий в виде пакета обновления системы Майкрософт см. в разделе [Универсальная среда выполнения C Windows 10](https://www.microsoft.com/download/details.aspx?id=48234) в Центре загрузки Майкрософт.

Невозможно повторно распространить все файлы, включенные в Visual Studio. Разрешается повторно распространить только файлы, указанные в файле Redist.txt или в "списке REDIST" в Интернете. Отладочные версии приложений и различные отладочные библиотеки DLL-файлов Visual C++ невозможно повторно распространить. Дополнительные сведения см. в разделе [Выбор метода развертывания](../ide/choosing-a-deployment-method.md).

В следующей таблице описываются некоторые библиотеки DLL Visual C++, от которых может зависеть ваше приложение.

|Библиотека Visual C++|Описание|Применение|
|--------------------------|-----------------|----------------|
|vcruntime*версия*.dll|Библиотека среды выполнения для машинного кода.|Приложения, использующие обычные службы запуска и завершения работы для языка C и C++.|
|vccorlib*версия*.dll|Библиотека среды выполнения для управляемого кода.|Приложения, использующие службы языка C++ для управляемого кода.|
|msvcp*версия*.dll и msvcp*версия*_*номер_dot*.dll|Стандартная библиотека C++ для машинного кода.|Приложения, использующие [стандартную библиотеку C++](../standard-library/cpp-standard-library-reference.md).|
|concrt*версия*.dll|Библиотека среды выполнения с параллелизмом для машинного кода.|Приложения, использующие [среду выполнения с параллелизмом](../parallel/concrt/concurrency-runtime.md).|
|mfc*версия*.dll|Библиотека Microsoft Foundation Class (MFC).|Приложения, использующие [библиотеку MFC](../mfc/mfc-desktop-applications.md).|
|mfc*версия* *язык*.dll|Ресурсы библиотеки Microsoft Foundation Classes (MFC).|Приложения, использующие определенные языковые ресурсы для MFC.|
|mfc*версия*u.dll|Библиотека MFC с поддержкой Юникода.|Приложения, использующие [библиотеку MFC](../mfc/mfc-desktop-applications.md) и требующие поддержку Юникода.|
|mfcmifc80.dll|Библиотека управляемых интерфейсов MFC.|Приложения, использующие [библиотеку MFC](../mfc/mfc-desktop-applications.md) с [элементами управления Windows Forms](/dotnet/framework/winforms/controls/index).|
|mfcm*версия*.dll|Управляемая библиотека MFC.|Приложения, использующие [библиотеку MFC](../mfc/mfc-desktop-applications.md) с [элементами управления Windows Forms](/dotnet/framework/winforms/controls/index).|
|mfcm*версия*u.dll|Управляемая библиотека MFC с поддержкой Юникода.|Приложения, использующие [библиотеку MFC](../mfc/mfc-desktop-applications.md) с [элементами управления Windows Forms](/dotnet/framework/winforms/controls/index) и требующие поддержку Юникода.|
|vcamp*версия*.dll|Библиотека AMP для машинного кода.|Приложения, использующие код [библиотеки C++ AMP](../parallel/amp/cpp-amp-cpp-accelerated-massive-parallelism.md).|
|vcomp*версия*.dll|Библиотека OpenMP для машинного кода.|Приложения, использующие код [библиотеки C++ AMP](../parallel/openmp/openmp-in-visual-cpp.md).|

> [!NOTE]
> Библиотеку шаблонных классов ATL больше не требуется повторно распространять в качестве отдельного DLL-файла. Ее функции были переданы заголовкам и статической библиотеке.

Дополнительные сведения о повторном распространении этих библиотек DLL с приложением см. в разделе [Распространение файлов Visual C++](../ide/redistributing-visual-cpp-files.md). Примеры приведены в разделе [Примеры развертывания](../ide/deployment-examples.md).

Как правило, повторное распространение системных DLL-файлов не требуются, поскольку они входят в состав операционной системы. Однако возможны исключения, например если приложение выполняется в нескольких версиях операционных систем Microsoft. В этом случае необходимо внимательно ознакомиться с соответствующими условиями лицензирования. Также попробуйте обновить системные библиотеки DLL с помощью центра обновления Windows, пакетов обновления или повторно распространяемых пакетов, предоставляемых Майкрософт.

## <a name="see-also"></a>См. также

[Выбор метода развертывания](../ide/choosing-a-deployment-method.md)

[Развертывание классических приложений](../ide/deploying-native-desktop-applications-visual-cpp.md)
