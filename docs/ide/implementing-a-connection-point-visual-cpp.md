---
title: Реализация точки подключения
ms.date: 11/12/2018
f1_keywords:
- vc.codewiz.impl.cp.overview
helpviewer_keywords:
- connection points [C++], implementing
- implement connection point wizard [C++]
ms.assetid: 5b37e4f9-73c9-4bef-b26d-365bc0662260
ms.openlocfilehash: 7afa61246c5251936967e281f7237dc37e5be045
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/15/2018
ms.locfileid: "51693286"
---
# <a name="implement-a-connection-point"></a>Реализация точки подключения

Чтобы реализовать точку подключения с помощью мастера реализации точки подключения, нужно создать проект как COM-приложение ATL или как приложение MFC с поддержкой ATL. Вы можете использовать [Мастер проектов ATL](../atl/reference/atl-project-wizard.md), чтобы создать приложение ATL, или [добавить объект ATL в свое приложение MFC](../mfc/reference/adding-atl-support-to-your-mfc-project.md), чтобы реализовать поддержку ATL для приложения MFC.

> [!NOTE]
> Сведения о реализации точек подключения для проекта MFC см. в разделе [Точки подключения](../mfc/connection-points.md).

Создав проект для реализации точки подключения, нужно сначала добавить объект ATL. См. раздел [Добавление объектов и элементов управления в проект ATL](../atl/reference/adding-objects-and-controls-to-an-atl-project.md), где перечислены мастеры, добавляющие объекты в проект ATL.

> [!NOTE]
> Мастер не поддерживает диалоговые окна ATL, XML-веб-службы, созданные с помощью сервера ATL, объекты производительности и счетчики производительности.

Обладающий возможностью подключения объект (который называется источником) может предоставлять точку подключения для каждого из своих исходящих интерфейсов. Каждый исходящий интерфейс может быть реализован клиентом для объекта (который называется приемником). Дополнительные сведения см. в разделе [Точки подключения ATL](../atl/atl-connection-points.md).

**Реализация точки подключения**

1. В представлении классов щелкните правой кнопкой мыши имя класса для объекта ATL.

1. Выберите пункт **Добавить** в контекстном меню и нажмите **Добавить точку подключения**, чтобы отобразить [Мастер реализации точек подключения](#implement-connection-point-wizard).

1. Выберите реализуемые интерфейсы точки подключения в соответствующих библиотеках типов и нажмите **Готово**.

1. В представлении классов просмотрите прокси-классы, созданные для каждой точки подключения. Эти классы отображаются в виде CProxy*имя_интерфейса*\<T> и являются производными от [IConnectionPointImpl](../atl/reference/iconnectionpointimpl-class.md).

1. Дважды щелкните класс точки подключения, чтобы отобразить определение класса точки подключения.

   - Когда вы реализуете точку подключения для интерфейса собственного проекта, отображается следующее определение:

     ```cpp
     template< class T >
     class CProxyInterfaceName :
     public IConnectionPointImpl< T, &IID_InterfaceName >
     {
     public:
     };
     ```

   - Когда вы реализуете локальный интерфейс, методы и свойства отображаются в теле класса.

   - Когда вы реализуете точку подключения для другого интерфейса, определение включает в себя методы этого интерфейса с префиксом `Fire_`.

## <a name="in-this-section"></a>Содержание раздела

- [Мастер реализации точек подключения](#implement-connection-point-wizard)

## <a name="implement-connection-point-wizard"></a>Мастер реализации точек подключения

Этот мастер реализует точку подключения для COM-объекта. Обладающий возможностью подключения объект (который называется источником) может предоставлять точку подключения для своих интерфейсов либо для любого исходящего интерфейса. Visual C++ и Windows предоставляют библиотеки типов с исходящими интерфейсами. Каждый исходящий интерфейс может быть реализован клиентом для объекта (который называется приемником).

Дополнительные сведения см. в разделе [Точки подключения ATL](../atl/atl-connection-points.md).

- **Доступные библиотеки типов**

  Отображает доступные библиотеки типов, содержащие определения интерфейсов, для которых можно реализовать точки подключения. Нажмите кнопку с многоточием, чтобы найти файл, содержащий необходимую библиотеку типов.

- **Расположение**

  Отображает расположение библиотеки типов, выбранной в списке **Доступные библиотеки типов**.

- **Интерфейсы**

  Отображает интерфейсы, определения которых находятся в библиотеке типов, выбранной в поле **Доступные библиотеки типов**.

  |Кнопка "Перенести"|Описание:|
  |---------------------|-----------------|
  |**>**|Добавляет в список **Implement connection points** (Реализация точек подключения) имя интерфейса, выбранного в списке **Интерфейсы**.|
  |**>>**|Добавляет в список **Implement connection points** (Реализация точек подключения) все имена интерфейсов, доступные в списке **Интерфейсы**.|
  |**\<**|Удаляет имя интерфейса, выбранного в списке **Implement connection points** (Реализация точек подключения).|
  |**\<\<**|Удаляет все имена интерфейсов, указанные в списке **Implement connection points** (Реализация точек подключения).|

- **Implement connection points** (Реализация точек подключения)

  Отображает имена интерфейсов, для которых реализуются точки подключения при нажатии кнопки **Готово**.
