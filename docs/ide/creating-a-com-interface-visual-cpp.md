---
title: Создание интерфейса COM
ms.date: 05/14/2019
helpviewer_keywords:
- COM interfaces, creating
- methods [C++], adding to COM interfaces
- COM interfaces, editing
- properties [C++], adding to COM interfaces
ms.assetid: 1be84d3c-6886-4d1e-8493-56c4d38a96d4
ms.openlocfilehash: 6ad8d50049d34a711937f3d1f73157ce26f69808
ms.sourcegitcommit: 6284bca6549e7b4f199d4560c30df6c1278bd4a0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/26/2020
ms.locfileid: "96188826"
---
# <a name="create-a-com-interface"></a>Создание интерфейса COM

Visual Studio предоставляет мастеры и шаблоны для создания проектов, использующих определяющие COM интерфейсы и disp-интерфейсы для COM-объектов и классов автоматизации.

Эти мастеры можно использовать для выполнения трех следующих типичных задач.

- [Добавление поддержки ATL в проект MFC](../mfc/reference/adding-atl-support-to-your-mfc-project.md)

  Добавьте поддержку ATL в приложение MFC после создания проекта MFC с помощью [мастера приложений MFC](../mfc/reference/mfc-application-wizard.md) и последующего запуска мастера кода **Добавление поддержки ATL в MFC**. Эта поддержка действует только для простых COM-объектов, добавленных в исполняемый файл MFC или проект библиотеки DLL. Эти объекты ATL могут иметь несколько интерфейсов.

- [Создание элемента ActiveX MFC](../mfc/reference/creating-an-mfc-activex-control.md)

  Откройте [Мастер элементов ActiveX MFC](../mfc/reference/mfc-activex-control-wizard.md) для создания элемента управления ActiveX с disp-интерфейсом и схемы событий, определенных в IDL-файле и классе элементов управления соответственно.

- [Добавление элемента управления ATL](../atl/reference/adding-an-atl-control.md)

  Используйте сочетание [мастера проектов ATL](../atl/reference/atl-project-wizard.md) и [мастера элементов управления ATL](../atl/reference/atl-control-wizard.md), чтобы создать элемент управления ActiveX ATL.

  Вы также можете добавить элемент управления ATL в проект MFC, куда уже добавили поддержку ATL, как описано выше. Кроме того, если вы выбираете пункт **Элемент управления ATL** в диалоговом окне **Добавление класса** и еще не добавили поддержку ATL в проект MFC, Visual Studio отображает диалоговое окно с предложением подтвердить добавление поддержки ATL в ваш проект MFC.

  Этот мастер создает исходный код IDL и схему COM в классах проекта.

После открытия проекта ATL диалоговое окно [Добавление класса](./adding-a-class-visual-cpp.md#add-class-dialog-box) позволяет вам выбрать дополнительные мастеры и шаблоны для добавления COM-интерфейсов в проект. Следующие мастеры позволяют задать один или несколько интерфейсов для объекта.

- [Мастер компонентов ATL COM+ 1.0](../atl/reference/atl-com-plus-1-0-component-wizard.md)
- [Мастер простых объектов ATL](../atl/reference/atl-simple-object-wizard.md)
- [Мастер ASP-компонента ATL](../atl/reference/atl-active-server-page-component-wizard.md)
- [Мастер элементов управления ATL](../atl/reference/atl-control-wizard.md)

Кроме того, можно реализовать новые интерфейсы для своего элемента управления COM. Просто щелкните правой кнопкой мыши класс элемента управления объекта в представлении классов и выберите команду [Реализовать интерфейс](./implementing-an-interface-visual-cpp.md#implement-interface-wizard).

> [!NOTE]
> Visual Studio не предоставляет мастер для добавления интерфейса в проект. Вы можете добавить интерфейс в проект ATL или [добавить поддержку ATL в проект MFC](../mfc/reference/adding-atl-support-to-your-mfc-project.md), добавив простой объект с помощью [мастера простых объектов ATL](../atl/reference/atl-simple-object-wizard.md). Кроме того, можно открыть IDL-файл проекта и создать интерфейс, введя следующее:

```
interface IMyInterface {
};
```

Дополнительные сведения см. в разделах [Реализация интерфейса](../ide/implementing-an-interface-visual-cpp.md) и [Добавление объектов и элементов управления в проект ATL](../atl/reference/adding-objects-and-controls-to-an-atl-project.md).

Visual C++ предоставляет несколько способов просмотра и [редактирования COM-интерфейсов](#edit-a-com-interface), определенных для проектов. В [представлении классов](/visualstudio/ide/viewing-the-structure-of-code) отображаются значки для всех интерфейсов или disp-интерфейсов, определенных в IDL-файле проекта C++.

Для классов COM-объектов на основе ATL представление классов считывает схему COM в классе ATL, чтобы показать связь между классом ATL и любым из реализуемых им интерфейсов.

В представлении классов и его контекстных меню можно работать с интерфейсами следующим образом.

- Добавление объектов ATL в приложение на основе MFC.
- Добавление методов, свойств и событий.
- Переход непосредственно к коду интерфейса элемента с помощью двойного щелчка элемента.

## <a name="in-this-section"></a>Содержание раздела

- [Изменение интерфейса COM](#edit-a-com-interface)

## <a name="edit-a-com-interface"></a>Изменение интерфейса COM

С помощью команд из контекстного меню представления классов можно определить новые методы и свойства для COM-интерфейсов в проектах Visual Studio C++. С панели элементов можно также определить события для элементов управления ActiveX.

Для классов COM-объектов на основе ATL и MFC можно изменить реализацию класса одновременно с редактированием интерфейса.

> [!NOTE]
> Для интерфейсов, определенных за пределами диалогового окна **Добавление класса**, Visual C++ добавляет методы или свойства в IDL-файл, а также добавляет заглушки в классы, реализующие методы, даже если интерфейсы добавляются вручную.

Ниже указаны три мастера, помогающие настроить существующие интерфейсы. Они доступны из представления классов:

|Мастер|Тип проекта|
|------------|------------------|
|[Мастер добавления свойства](./adding-a-property-visual-cpp.md#names-add-property-wizard)|Проекты ATL или проекты MFC, поддерживающие ATL. Щелкните правой кнопкой мыши интерфейс, в который нужно добавить свойство.<br /><br />При необходимости Visual C++ определяет тип проекта и изменяет параметры в мастере добавления свойства:<br /><br />— Для disp-интерфейсов в проектах, созданных с помощью [мастера приложений MFC](../mfc/reference/mfc-application-wizard.md), вызов мастера добавления свойства предоставляет параметры, характерные для MFC.<br />— Для интерфейсов элементов управления ActiveX библиотеки MFC мастер добавления свойства предоставляет список стандартных методов и свойств, которые можно использовать в исходном виде либо настроить для своего элемента управления.<br />— Для всех других интерфейсов мастер добавления свойства предоставляет параметры, подходящие для большинства ситуаций.|
|[Мастер добавления метода](./adding-a-method-visual-cpp.md#add-method-wizard)|Проекты ATL или проекты MFC, поддерживающие ATL. Щелкните правой кнопкой мыши интерфейс, в который нужно добавить метод.<br /><br />При необходимости Visual C++ определяет тип проекта и изменяет параметры в мастере добавления метода:<br /><br />— Для disp-интерфейсов в проектах, созданных с помощью [мастера приложений MFC](../mfc/reference/mfc-application-wizard.md), вызов мастера добавления метода предоставляет параметры, характерные для MFC.<br />— Для интерфейсов элементов управления ActiveX библиотеки MFC мастер добавления метода предоставляет список стандартных методов и свойств, которые можно использовать в исходном виде либо настроить для своего элемента управления.<br />— Для всех других интерфейсов мастер **добавления метода** предоставляет параметры, подходящие для большинства ситуаций.|

Кроме того, можно реализовать новые интерфейсы для своего элемента управления COM. Просто щелкните правой кнопкой мыши класс элемента управления объекта в представлении классов и выберите команду [Реализовать интерфейс](./implementing-an-interface-visual-cpp.md#implement-interface-wizard).
