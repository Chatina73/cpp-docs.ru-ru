---
title: Добавление функциональных возможностей с помощью мастеров кода (C++)
ms.date: 05/14/2019
helpviewer_keywords:
- code wizards [C++]
ms.assetid: 6afb7ef9-7056-423d-b244-91bb4236d1d7
ms.openlocfilehash: 8c88936edcb9110fe7482281f483f11c542b83c1
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "66182654"
---
# <a name="adding-functionality-with-code-wizards-c"></a>Добавление функциональных возможностей с помощью мастеров кода (C++)

После создания проекта вам потребуется изменить или добавить его функциональные возможности. Такие задачи включают в себя создание классов, добавление новых функций-членов и переменных, а также добавление методов и свойств автоматизации. Именно для этого предназначены мастеры кода.

> [!NOTE]
> Перечисленные ниже редко используемые мастеры удалены в Visual Studio 2019. Удаление этих мастеров не влияет на общую поддержку для ATL и MFC. Пример кода для этих технологий находится в архиве в документации Майкрософт и репозитории VCSamples на GitHub.

- Мастер компонентов ATL COM+ 1.0
- Мастер компонентов ATL ASP
- Мастер поставщика ATL OLE DB
- Мастер страницы свойств ATL
- Мастер потребителя ATL OLE DB
- Потребитель ODBC MFC
- Класс MFC из элемента управления ActiveX
- Класс MFC из TypeLib.


> [!NOTE]
>  Теперь вы можете добавить обработчики сообщений, сопоставлять с ними сообщения и переопределять виртуальные функции MFC с помощью [окна свойств](/visualstudio/ide/reference/properties-window).

## <a name="accessing-c-code-wizards"></a>Доступ к мастерам кода C++

Обратиться к мастерам кода C++ можно в трех расположениях:

- Команда **Добавить новый элемент** в меню **Проект** позволяет открыть диалоговое окно `Add New Item`, где можно добавить в проект новые файлы. Команда **Добавить класс** отображает диалоговое окно [Добавление класса](../ide/add-class-dialog-box.md), которое открывает мастер для каждого из типов классов, доступных для добавления в проект. Команда **Добавить ресурс** отображает диалоговое окно [Добавление ресурса](../windows/add-resource-dialog-box.md), где можно создать или выбрать ресурс для добавления в проект.

   При выделении класса или интерфейса в проекте внутри представления классов меню **Проекта** также содержит следующие команды:

   - **Реализовать интерфейс** (только из класса элемента управления)

   - **Добавить функцию**

   - **Добавить переменную**

   - **Добавить точку подключения** (только класс ATL)

   - **Добавить метод** (только из интерфейса)

   - **Добавить свойство** (только из интерфейса)

   - **Добавить событие** (только из класса элемента управления)

- Чтобы добавить новые или существующие файлы, папки, элементы, классы, ресурсы и веб-ссылки в проект, в **обозревателе решений** щелкните любую папку правой кнопкой мыши и выберите пункт **Добавить**.

- Чтобы добавить функции, переменные, классы, свойства, методы, события, интерфейсы, точки подключения или другой код в проект, щелкните правой кнопкой мыши соответствующий узел в [окне представления классов](/visualstudio/ide/viewing-the-structure-of-code) и выберите пункт **Добавить**.

   > [!NOTE]
   > Visual Studio не предоставляет мастер для добавления интерфейса в проект. Вы можете добавить интерфейс в проект ATL или [добавить поддержку ATL в проект MFC](../mfc/reference/adding-atl-support-to-your-mfc-project.md), добавив простой объект с помощью [мастера простых объектов ATL](../atl/reference/atl-simple-object-wizard.md). Кроме того, можно открыть IDL-файл проекта и создать интерфейс, введя следующее:

    ```IDL
    interface IMyInterface {
    };
    ```

   Дополнительные сведения см. в разделах [Реализация интерфейса](../ide/implementing-an-interface-visual-cpp.md) и [Добавление объектов и элементов управления в проект ATL](../atl/reference/adding-objects-and-controls-to-an-atl-project.md).

   |Откуда выполняется обращение к мастеру кода|Описание|
   |-----------------------------|-----------------|
   |Добавить новый элемент|Мастеры кода "Добавление нового элемента" добавляют исходные файлы в проект. При необходимости в расположении, известном подсистеме сборки проекта, создаются дополнительные каталоги для хранения файлов. Мастеры кода, доступные с помощью значка добавления элемента:<br /><br />— Добавление исходных файлов C++ (CPP, H, IDL, RC, SRF, DEF, RGS).<br />— Добавление файлов веб-разработки (HTML, ASP, CSS, XML).<br />— Добавление служебных файлов и файлов ресурсов (BMP, CUR, ICO, RCT, SQL, TXT).<br /><br />Обычно эти мастеры кода не запрашивают никакие сведения, а добавляют файл в дерево разработки. Вы можете переименовать файл в окне свойств.|
   |обозреватель решений|Мастеры кода, доступные в обозревателе решений, зависят от того, где находится фокус курсора при щелчке элемента правой кнопкой мыши. Если параметр **Добавить** не отображается при щелчке элемента правой кнопкой мыши, переместите курсор на один уровень вверх в дереве разработки и повторите попытку. Мастеры кода всегда помещают дополнительный код в соответствующее место в дереве разработки независимо от расположения курсора. Мастеры кода, доступные в обозревателе решений:<br /><br />— Добавление класса (открывает диалоговое окно **Добавление класса** с новыми мастерами кода).<br />— Добавление ресурса (нового, импортируемого или настраиваемого).<br />— Добавление веб-ссылки.|
   |Представление классов|Мастеры кода, доступные в представлении классов, зависят от того, где находится фокус курсора при щелчке элемента правой кнопкой мыши. Если параметр **Добавить** не отображается при щелчке элемента правой кнопкой мыши, переместите курсор на один уровень вверх в дереве классов и повторите попытку. Мастеры кода всегда помещают дополнительный код в соответствующее место в дереве разработки независимо от расположения курсора. Мастеры кода, доступные в представлении классов:<br /><br />- [Добавить функцию-член](../ide/adding-a-member-function-visual-cpp.md)<br />- [Добавить переменную-член](../ide/adding-a-member-variable-visual-cpp.md)<br />- [Добавить класс](../ide/adding-a-class-visual-cpp.md)<br />- [Реализовать интерфейс](../ide/implement-interface-wizard.md) (только из класса элемента управления)<br />- [Добавить точку подключения](../ide/implement-connection-point-wizard.md) (только класс ATL)<br />- [Добавить метод](../ide/add-method-wizard.md) (только из интерфейса)<br />- [Добавить свойство](../ide/names-add-property-wizard.md) (только из интерфейса)<br />- [Добавить событие](../ide/add-event-wizard.md) (только из класса элемента управления)<br /><br />При выборе команды "Добавить класс" открывается диалоговое окно **Добавление класса**, которое предоставляет доступ ко всем мастерам кода "Добавить класс".|

## <a name="see-also"></a>См. также

[Переопределение виртуальной функции](../ide/overriding-a-virtual-function-visual-cpp.md)<br>
[Перемещение по структуре класса](../ide/navigating-the-class-structure-visual-cpp.md)<br>
[Типы проектов C++ в Visual Studio](../build/reference/visual-cpp-project-types.md)<br>
[Типы файлов, создаваемых для проектов Visual Studio C++](../build/reference/file-types-created-for-visual-cpp-projects.md)
