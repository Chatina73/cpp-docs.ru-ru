---
title: Добавление свойства
ms.date: 11/09/2018
f1_keywords:
- vc.codewiz.prop.overview
- vc.codewiz.prop.idlattributes
helpviewer_keywords:
- interfaces, adding properties
- properties [C++], adding to interfaces
- names, add property wizard
- IDL attributes, add property wizard
- stock properties, about stock properties
- stock properties
ms.assetid: 37bd4db7-efd3-4faa-87ad-64902ed16a36
ms.openlocfilehash: 79b05fde362a44453aac45aa8dc269c9689ea8fc
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81751189"
---
# <a name="add-a-property"></a>Добавление свойства

Вы можете использовать [мастер добавления свойства](#names-add-property-wizard) для добавления свойства в интерфейс в проекте.

**Добавление свойства в объект**

1. В [представлении классов](/visualstudio/ide/viewing-the-structure-of-code) щелкните правой кнопкой мыши имя интерфейса, в который нужно добавить свойство.

   > [!NOTE]
   > Вы также можете добавлять свойства в disp-интерфейсы, которые, если только проект не имеет атрибуты, вложены в узел библиотеки.

1. В контекстном меню выберите команду **Добавить**, а затем нажмите **Добавить свойство**.

1. В [мастере добавления свойства](#names-add-property-wizard) укажите сведения для создания свойства.

1. Задайте параметры IDL для этого свойства на странице [Атрибуты IDL](#idl-attributes-add-property-wizard) мастера.

1. Нажмите **Готово**, чтобы добавить свойство.

Методы `Get` и `Put` свойства отображаются в представлении классов в виде двух значков под интерфейсом, в котором оно определено. Можно дважды щелкнуть любой значок, чтобы просмотреть объявление свойства в IDL-файле.

- Для интерфейсов ATL функции `Get` и `Put` добавляются в CPP-файл, а ссылки на эти функции — в H-файл.

- Для disp-интерфейсов MFC, если выбран тип реализации **Переменная-член**, метод и переменная добавляются в класс, который его реализует. Если выбрать **методы Get/Set** в качестве типа реализации, два метода добавляются в класс, который его реализует.

## <a name="in-this-section"></a>В этом разделе

- [Имена, добавление мастера свойств](#names-add-property-wizard)
- [Атрибуты IDL, мастер добавления свойства](#idl-attributes-add-property-wizard)
- [Свойства хранения](#stock-properties)

## <a name="names-add-property-wizard"></a>Мастер добавления свойств, страница "Имена"

Этот мастер используется для добавления свойства в интерфейс.

- **Тип свойства**

  Задает тип добавляемого свойства. Для disp-интерфейсов MFC укажите свой собственный тип или выберите в предопределенном списке. Если вы предоставляете стандартную реализацию свойства, в поле **Тип свойства** задан стандартный тип, который невозможно изменить.

- **Имя свойства**

  Задает имя свойства. Для disp-интерфейсов MFC, связанных с элементами управления ActiveX, можно указать собственное имя или выбрать стандартное имя свойства в предопределенном списке. Если вы указываете собственное имя свойства, тип реализации **Биржевая** недоступен. Описание свойств в списке см. в разделе [Стандартные свойства](#stock-properties).

  |Тип интерфейса|Описание|
  |--------------------|-----------------|
  |Двойной интерфейс ATL, настраиваемый интерфейс и локальный настраиваемый интерфейс|Укажите имя свойства.|
  |Disp-интерфейс MFC, disp-интерфейс элементов управления ActiveX MFC|Укажите имя свойства или выберите стандартное свойство в списке. При выборе свойства в списке соответствующее значение отображается в поле **Тип свойства**. Этот тип можно изменить с учетом значения, выбранного в поле **Тип реализации**.|

- **Тип возврата**

  Только интерфейсы ATL. Задает тип возвращаемого значения для свойства. Для двойных интерфейсов `HRESULT` всегда является типом возвращаемого значения, а это поле недоступно. Для настраиваемых интерфейсов вы можете выбрать тип возвращаемого значения в списке. `HRESULT` по-прежнему рекомендуется, так как предоставляет стандартный способ возврата ошибок.

- **Имя переменной**

  Только для disp-интерфейсов MFC. Доступно только при указании значения **Переменная-член** в поле **Тип реализации**. Задает имя переменной-члена, с которой сопоставлено свойство. По умолчанию имени переменной присвоено значение `m_`*имя_свойства*. Это имя можно изменить.

- **Функция уведомления**

  Только для disp-интерфейсов MFC. Доступно только при указании значения **Переменная-член** в поле **Тип реализации**. Задает имя функции уведомления, вызываемой при изменении свойства. По умолчанию имя функции уведомлений устанавливается на `On` *PropertyName*`Changed`. Это имя можно изменить.

- **Функция Get**

  Для disp-интерфейсов MFC. Доступно только при указании значения **Методы Get и Set** в поле **Тип реализации**. Задает имя функции для возвращения свойства. По умолчанию имени функции `Get` присвоено значение `Get`*имя_свойства*. Это имя можно изменить. Если удалить это имя, в схему диспетчеризации интерфейса вставляется функция [GetNotSupported](../mfc/reference/colecontrol-class.md#getnotsupported). Функция `Get`*PropertyName* указывает, что свойство доступно для чтения.

- **Задать функцию**

  Только для disp-интерфейсов MFC. Доступно только при указании значения **Методы Get и Set** в поле **Тип реализации**. Задает имя функции для задания свойства. По умолчанию имени функции `Set` присвоено значение `Set`*имя_свойства*. Это имя можно изменить. Если удалить это имя, в схему диспетчеризации интерфейса вставляется функция [SetNotSupported](../mfc/reference/colecontrol-class.md#setnotsupported). Функция `Set`*PropertyName* указывает, что свойство доступно для записи.

- **Тип реализации**

  Только для disp-интерфейсов MFC. Указывает, как реализовать добавляемое свойство.

  |Тип реализации|Описание|
  |-------------------------|-----------------|
  |**Биржевая**|Задает стандартную реализацию для свойства, выбранного в поле **Имя свойства**. По умолчанию. Дополнительные сведения см. в разделе [Стандартные свойства](#stock-properties).<br /><br /> При указании значения **Биржевая** элементы **Тип свойства**, **Тип параметра** и **Имя параметра** становятся недоступны.|
  |**Переменная-член**|Указывает, что свойство добавляется в качестве переменной-члена. Настраиваемые свойства и большинство стандартных свойств можно добавить в качестве переменных-членов. Вы не можете указать `Caption` **переменную участника** для свойств и `hWnd` `Text` свойств.<br /><br /> Предоставляет имена по умолчанию в полях **Имя переменной** и **Функция уведомления**. Это имя можно изменить.|
  |**Методы Get и Set**|Указывает, что по умолчаниюсвойство добавляется в качестве функций имя_свойства и имя_свойства. Эти имена отображаются в полях **Функция Get** и **Функция Set**.<br /><br /> Вы можете изменить значение по умолчанию **Тип свойства**, которое передает значение для функции Get. Вы можете указать параметры для функций `Get` и `Set`.|

- **Функция Get**

  Для интерфейсов ATL. Задает свойство как доступное для чтения, то есть создает метод `Get` для извлечения этого свойства из объекта. Выберите **Get**, **Put** или оба.

- **Функция Put**

  Только интерфейсы ATL. Задает свойство как доступное для записи, то есть создает метод `Put` для задания этого свойства в объекте. Выберите **Get**, **Put** или оба. При использовании этого параметра вы сможете выбрать один из двух следующих способов реализации метода:

  |Параметр|Описание|
  |------------|-----------------|
  |**PropPut**|Функция [PropPut](../windows/propput.md) возвращает копию объекта. Это стандартный и наиболее распространенный способ, позволяющий сделать свойство доступным для записи.|
  |**ПроппутРеф**|Функция [PropPutRef](../windows/propputref.md) возвращает ссылку на объект, а не копию самого объекта. Рекомендуется использовать этот вариант для таких объектов, как большие структуры или массивы, с большими затратами на инициализацию.|

- **Атрибуты параметра**

  Только интерфейсы ATL. Устанавливает, является `in`ли параметр, `out`указанный **именем Параметра,** как, так и нет.

  |Параметр|Описание|
  |------------|-----------------|
  |`in`|Указывает, что параметр передается из вызывающей процедуры в вызываемую.|
  |`out`|Указывает, что параметр-указатель возвращается из вызываемой процедуры в вызывающую (от сервера к клиенту).|

- **Тип параметра**

  Задает тип данных для параметра. Выберите тип из списка.

- **Имя параметра**

  Задает имя параметра, добавляемого для свойства, если оно имеет параметры. После нажатия кнопки **Добавить** имя параметра отображается в области **Список параметров**.

- **Список параметров**

  Отображает список атрибутов, добавляемых к свойству. Каждый элемент в списке состоит из имени параметра, типа параметра и атрибутов. Используйте элементы **Добавить** и **Удалить** для изменения списка.

- **Добавление**

  Добавляет параметр, указанный в поле **Имя параметра**, и его **Тип параметра** в **Список параметров**. Выберите **Добавить**, чтобы добавить параметр в список.

- **Удалить**

  Удаляет параметр, выбранный в области **Список параметров**.

- **Свойство по умолчанию**

  Только для disp-интерфейса MFC. Задает это свойство в качестве используемого по умолчанию для данного интерфейса. Интерфейс может иметь только одно свойство по умолчанию. После задания свойства по умолчанию для всех остальных свойств, добавляемых в этот интерфейс, данное поле будет недоступно.

## <a name="idl-attributes-add-property-wizard"></a>Атрибуты IDL, мастер добавления свойства

Используйте эту страницу мастера добавления свойства, чтобы указать все параметры IDL для этого свойства.

- `id`

  Задает числовой идентификатор, который определяет это свойство. Этот параметр недоступен для свойств настраиваемых интерфейсов. См. описание [id](/windows/win32/Midl/id) в *справочнике по MIDL*.

- `helpcontext`

  Задает идентификатор контекста, позволяющий пользователю просматривать в файле справки информацию об этом свойстве. См. описание [helpcontext](/windows/win32/Midl/helpcontext) в *справочнике по MIDL*.

- `helpstring`

  Определяет строку символов, используемую для описания элемента, к которому оно применяется. По умолчанию ему присваивается *Имя&nbsp;свойства*`property`&nbsp;. См. описание [helpstring](/windows/win32/Midl/helpstring) в *справочнике по MIDL*.

### <a name="other-options"></a>Другие варианты

Не все параметры доступны для всех типов свойств.

|Параметр|Описание|
|------------|-----------------|
|`bindable`|Указывает, что свойство поддерживает привязку данных. См. описание [bindable](/windows/win32/Midl/bindable) в *справочнике по MIDL*. Для стандартной реализации свойства этот параметр задан по умолчанию и недоступен для изменения.|
|`defaultbind`|Указывает, что это единственное привязываемое свойство представляет объект наилучшим образом. См. описание [defaultbind](/windows/win32/Midl/defaultbind) в *справочнике по MIDL*.|
|`displaybind`|Указывает, что это свойство должно отображаться пользователю как связываемое. См. описание [displaybind](/windows/win32/Midl/displaybind) в *справочнике по MIDL*.|
|`immediatebind`|Указывает, что база данных будет немедленно оповещаться обо всех изменениях этого свойства для объекта с привязкой к данным. См. описание [immediatebind](/windows/win32/Midl/immediatebind) в *справочнике по MIDL*.|
|`defaultcollelem`|Указывает, что свойство является функцией метода доступа для элемента в коллекции по умолчанию. См. описание [defaultcollelem](/windows/win32/Midl/defaultcollelem) в *справочнике по MIDL*.|
|`nonbrowsable`|Помечает член интерфейса или disp-интерфейса, который не должен отображаться в обозревателе свойств. См. описание [nonbrowsable](/windows/win32/Midl/nonbrowsable) в *справочнике по MIDL*.|
|`requestedit`|Указывает, что свойство поддерживает уведомление `OnRequestEdit`. См. описание [requestedit](/windows/win32/Midl/requestedit) в *справочнике по MIDL*. Для стандартной реализации свойства этот параметр задан по умолчанию и недоступен для изменения.|
|`source`|Указывает, что член свойства является источником событий. См. описание [source](/windows/win32/Midl/source) в *справочнике по MIDL*.|
|`hidden`|Указывает, что свойство существует, но не должно отображаться в пользовательском браузере. См. описание [hidden](/windows/win32/Midl/hidden) в *справочнике по MIDL*.|
|`restricted`|Указывает, что свойство не может вызываться произвольным образом. См. описание [restricted](/windows/win32/Midl/restricted) в *справочнике по MIDL*.|
|`local`|Указывает компилятору MIDL, что свойство не является удаленным. См. описание [local](/windows/win32/Midl/local) в *справочнике по MIDL*.|

## <a name="stock-properties"></a>Свойства хранения

При добавлении свойства в disp-интерфейс MFC с помощью [мастера добавления свойства](#idl-attributes-add-property-wizard), можно выбрать стандартное свойство в списке **Имя свойства** на странице [Имена](../ide/names-add-property-wizard.md) мастера. Список содержит следующие свойства.

|Имя свойства|Описание|
|-------------------|-----------------|
|`Appearance`|Возвращает или задает значение, определяющее внешний вид элемента управления. Свойство `Appearance` элемента управления может включать или исключить трехмерные эффекты отображения. Это свойство является окружающим свойством чтения и записи.|
|`BackColor`|Возвращает или задает для окружающего свойства `BackColor` элемента управления цвет палитры (RGB) или предопределенный системный цвет. По умолчанию его значение соответствует цвету переднего плана для контейнера элемента управления. Это свойство является окружающим свойством чтения и записи.|
|`BorderStyle`|Возвращает или задает стиль границы для элемента управления. Это свойство является свойством чтения и записи.|
|`Caption`|Возвращает или задает свойство `Caption` элемента управления. Это значение является заголовком окна. У свойства `Caption` нет типа реализации **Переменная-член**.|
|`Enabled`|Возвращает или задает свойство `Enabled` элемента управления. Включенный элемент управления может отвечать на события, вызываемые пользователем.|
|`Font`|Возвращает или задает окружающий шрифт элемента управления. Значение NULL, если у элемента управления нет шрифта.|
|`ForeColor`|Возвращает или задает окружающее свойство `ForeColor` элемента управления.|
|`hWnd`|Возвращает или задает свойство `hWnd` элемента управления. У свойства `hWnd` нет типа реализации **Переменная-член**.|
|`ReadyState`|Возвращает или задает свойство `ReadyState` элемента управления. Элемент управления может быть неинициализированным, инициализированным, загружаемым, интерактивным или завершенным. Дополнительные сведения см. в разделе [READYSTATE](/previous-versions/aa768362\(v=vs.85\)) для *пакета SDK Интернета*.|
|`Text`|Возвращает или задает текст, содержащийся в элементе управления. У свойства `Text` нет типа реализации **Переменная-член**.|
