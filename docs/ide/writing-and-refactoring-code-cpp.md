---
title: Изменение и оптимизация C++ кода в Visual Studio
description: Используйте редактор кода C++ в Visual Studio для форматирования, навигации, понимания и рефакторинга кода.
ms.date: 05/31/2019
ms.assetid: 56ffb9e9-514f-41f4-a3cf-fd9ce2daf3b6
ms.openlocfilehash: d4a74608a95df0fdd461f55d26fee97332a66aa8
ms.sourcegitcommit: 65ed563a8a1d4d90f872a2a6edcb086f84ec9f77
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/06/2019
ms.locfileid: "66741630"
---
# <a name="edit-and-refactor-c-code-in-visual-studio"></a>Изменение и оптимизация C++ кода в Visual Studio

Visual Studio предоставляет несколько средств, которые помогут вам создавать, изменять и рефакторинг кода.

##  <a name="intellisense"></a>IntelliSense

IntelliSense — это средство мощные кода завершения, предлагаемое при вводе символов и фрагменты кода для вас. C++IntelliSense в Visual Studio выполняется в режиме реального времени, анализ вашей базы кода и предоставление рекомендаций для обновления. При вводе дополнительные символы, список рекомендуемых результатов сужает круг.

![C&#43; &#43; раскрывающийся список элементов](../ide/media/cpp-statement-completion.png)

Некоторые символы, автоматически опущены, чтобы помочь сузить полученные результаты. Например при доступе к членам объекта класса за пределами класса, вы не сможете см. в разделе закрытые члены по умолчанию или защищенные члены (Если вы не в контексте дочерний класс). Можно настроить фильтрацию с помощью кнопок в нижней.

Выбрав нужный символ из раскрывающегося списка, вы можете автозаполнения его с **вкладке**, **ввод**, или один из других символов фиксации (по умолчанию: {} [ ](). ,:; +-* / % & | ^! =? @#\). Чтобы добавить или удалить символы из этого списка, поиска «IntelliSense» в **быстрого запуска** (Ctrl + Q) и выберите **текстовый редактор > C /C++ > Дополнительно** параметр. **Символы фиксации списка членов** параметр позволяет настроить список с необходимые изменения.

**Режим фильтрации списков членов** параметр определяет, какие виды автозавершения IntelliSense вы см. в разделе. По умолчанию ему присваивается **Fuzzy**. В поиск нечетких соответствий, если у вас есть символ, который называется *MyAwesomeClass*, можно ввести «MAC» и найти класс в ваши предложения автозаполнения. Нечеткое алгоритм задает минимальное пороговое значение, которое должно соответствовать символы отображаются в списке. **Смарт-** фильтрации будут отображаться все символы, содержащий подстроки, соответствующие вы ввели. **Префикс** фильтрации поиск строк, которые начинаются с введенные вами.

Дополнительные сведения о C++ IntelliSense, см. в разделе [Visual C++ IntelliSense](/visualstudio/ide/visual-cpp-intellisense) и [Настройка C++ проект для IntelliSense](/visualstudio/ide/visual-cpp-intellisense-configuration).

## <a name="intellicode"></a>IntelliCode

IntelliCode — IntelliSense с помощью ии. Он помещает наиболее вероятной причиной в верхней части списка завершения. IntelliCode рекомендации основываются на тысячах проектов с открытым кодом на GitHub каждый с более чем 100 звезды. В сочетании с контекст кода, список завершения предназначена для повышения уровня распространенные приемы.

При написании C++, IntelliCode будет полезна при использовании популярных библиотек, таких как C++ стандартной библиотеки. Контекст кода используется для предоставления наиболее полезных рекомендаций сначала. В следующем примере `size` часто используется функция-член `sort` функции, поэтому она будет отображена в верхней части списка результатов.

![C&#43; &#43; IntelliCode](../ide/media/intellicode-cpp.png " C++ IntelliCode")

::: moniker range="vs-2019"

В Visual Studio 2019 г., IntelliCode доступен как дополнительный компонент в  **C++ разработка классических приложений** рабочей нагрузки. Чтобы убедиться в том, что IntelliCode активен для C++, перейдите в меню **средства** > **параметры** > **IntelliCode**  >  **Общие** и задайте  **C++ базовой модели** для **включено**.

::: moniker-end

::: moniker range="vs-2017"

В Visual Studio 2017 IntelliCode доступен как расширение в Visual Studio Marketplace.

::: moniker-end

## <a name="predictive-intellisense-experimental"></a>Прогнозный IntelliSense (экспериментальная функция)

**Прогнозный IntelliSense** является экспериментальной функцией, использует отслеживание контекста, чтобы ограничить количество результатов, отображаемых в раскрывающемся списке IntelliSense. Алгоритм применяется тип, соответствующий так, чтобы отобразить только те результаты, которые соответствует ожидаемому типу. В простейшем случае, если ввести `int x =` и вызвать раскрывающийся список IntelliSense, вы увидите только целые числа или функции, возвращающие целых чисел. Эта функция отключена по умолчанию, так как он находится в разработке. Лучше всего работает с глобальные символы; функции-члены еще не поддерживаются. Можно включить его, введя «Прогнозные» **быстрого запуска** или перейдите в раздел **средства** > **параметры** > **текстовый редактор**  >  **C /C++**  > **экспериментальный** > **включить прогнозный IntelliSense**.

Чтобы переопределить **прогнозный IntelliSense** и Показать длинный список, нажмите клавишу **Ctrl + J**. Если **прогнозный IntelliSense** имеет значение on, вызов **Ctrl + J** удаляет прогнозной фильтр. Нажав клавишу **Ctrl + J** снова удаляет фильтр специальных возможностей из списка членов результатов, где применимо. ([] +) Кнопку в IntelliSense, в раскрывающемся списке делает то же самое **Ctrl + J**. Наведите указатель на кнопку, чтобы увидеть подсказку о какие элементы отображаются.

![C&#43; &#43; прогнозный IntelliSense](../ide/media/predictive-intellisense-cpp.png "прогнозный IntelliSense")

На предыдущем снимке экрана показаны несколько кнопок в раскрывающемся списке. Они позволяют фильтров IntelliSense для различных типов результатов:

- Переменные и константы
- Функции
- Типы
- Макросы
- перечислениям;
- Пространства имен

Кнопка отображается только в том случае, если это уместно в текущий сеанс IntelliSense. Обычно не видна всем кнопкам в то же время.

## <a name="template-intellisense"></a>Шаблон IntelliSense

Когда курсор находится внутри определения шаблона, **строке шаблона** отображается, что позволяет предоставить аргументы шаблона образца для IntelliSense. 

![C&#43; &#43; упрощено создание экземпляров шаблонов IntelliSense Показать существующие](../ide/media/template-intellisense-cpp-1.png "экземпляров существующих шаблонов Показать IntelliSense")

Нажмите кнопку **<T>** значок, чтобы развернуть или свернуть **строке шаблона**. Щелкните значок карандаша или дважды щелкните **строке шаблона** открыть **изменить** окна. 

![C&#43; &#43; шаблона IntelliSense](../ide/media/template-intellisense-cpp-3.png "шаблона IntelliSense")

Изменения, вносимые в окне, применяются непосредственно к исходному коду, таким образом, чтобы можно было увидеть эффекты в режиме реального времени. 

В строке шаблона могут заполнять автоматически кандидатов, экземпляров в коде. Щелкните **добавьте всех существующих экземпляров** для просмотра списка всех конкретных аргументов, которые использовались для создания экземпляра шаблона во всей базы кода.

![C&#43; &#43; список результатов шаблона IntelliSense](../ide/media/template-intellisense-cpp-2.png "список результатов шаблона IntelliSense")

Окно в нижней части редактора показано, где был найден каждый экземпляр, и его аргументы были.

![C&#43; &#43; карты при создании экземпляра шаблона IntelliSense](../ide/media/template-intellisense-cpp-4.png "карты при создании экземпляра шаблона IntelliSense")

**Строке шаблона** сведения рассматривается как конкретного пользователя. Он хранится в папке .vs и не фиксируются в систему управления версиями.

##  <a name="error-squiggles-and-quick-fixes"></a>Подчеркивание ошибок и быстрые исправления

Редактор определяет проблемы с кодом, это увеличит цветной волнистых линий под проблему. Красные волнистые линии указывают код, который не будет компилироваться. Зеленой волнистой линией указывают, которые по-прежнему могут быть потенциально серьезных проблем других типов. Вы можете открыть **список ошибок** окно, чтобы получить дополнительные сведения о проблемах.

Для некоторых типов ошибок, а также общих шаблонов кодирования, редактор будет предлагать **Быстрое исправление** в виде лампочки, которое отображается, если навести указатель мыши наведен на волнистую линию. Щелкните стрелку вниз, чтобы ознакомиться с этими статьями. 

В следующем примере `vector` была объявлена, но не удалось найти определение, поэтому редактор подставляет включить файл заголовка:

![C&#43; &#43; Быстрое исправление](../ide/media/quick-fix-for-header-cpp.png " C++ Быстрое исправление")

Редактор также предоставляет быстрые исправления для определенные возможности переработки. Например если объявить класс в файле заголовка, Visual Studio предложит создать определение для него в отдельном CPP-файла. 

![C&#43; &#43; Быстрое исправление](../ide/media/quick-fix.png " C++ Быстрое исправление")

## <a name="change-tracking"></a>Change tracking

При каждом внесении изменений в файл желтая полоска отображается слева, чтобы указать, что были внесены несохраненные изменения. При сохранении файла, полоска станет зеленой. Зелено-желтый столбцы сохраняются до тех пор, пока документ открыт в редакторе. Они представляют собой изменения, внесенные с момента последнего открытия документа.

![C&#43; &#43; отслеживание изменений](../ide/media/change-tracking-cpp.png "отслеживание изменений")

## <a name="move-code"></a>Перенос кода

Строки кода можно перемещать вверх и вниз, выбрав их, удерживая нажатой клавишу Alt и клавишу **Up/Down** клавиш со стрелками.

##  <a name="insert-snippets"></a>Вставка фрагментов кода

Фрагмент — это предварительно определенная часть исходного кода. Щелкните правой кнопкой мыши одну точку или выбранный текст для вставки фрагмента или размещения выбранного текста внутри фрагмента. На следующем рисунке показана процедура размещения выбранного оператора в цикле for. На последнем изображении желтым цветом выделены редактируемые поля, доступ к которым осуществляется с помощью клавиши TAB. Дополнительные сведения см. в статье [Фрагменты кода](/visualstudio/ide/code-snippets).

![C&#43; &#43; вставить фрагмент кода Drop&#45;вниз](../ide/media/vs2015_cpp_surround_with.png "vs2015_cpp_surround_with")

##  <a name="add-class"></a>Добавить класс

Добавьте новый класс из **проекта** меню или в контекстном меню в **обозревателе решений**:

![Добавьте новый класс в C&#43;&#43;](../ide/media/vs2017-add-class.png "vs2015_cpp_add_class")

Можно также использовать мастер классов для изменения или просмотра существующего класса.

![C&#43; &#43; класса мастера](../ide/media/vs2017-class-wizard.png)

Дополнительные сведения см. в разделе [Добавление функциональных возможностей с помощью мастеров кода (C++)](../ide/adding-functionality-with-code-wizards-cpp.md).

##  <a name="refactoring"></a>Рефакторинг

Рефакторинг доступен в контекстном меню быстрых действий. Или можно щелкнуть [лампочку](/visualstudio/ide/perform-quick-actions-with-light-bulbs) в редакторе.  Некоторые также находятся в меню **Правка > Рефакторинг**.  Эти функции включают перечисленные ниже.

* [Переименование](refactoring/rename.md)
* [Извлечение функции](refactoring/extract-function.md)
* [Реализация чистых виртуальных функций](refactoring/implement-pure-virtuals.md)
* [Создание объявления или определения](refactoring/create-declaration-definition.md)
* [Перемещение определения функции](refactoring/move-definition-location.md)
* [Преобразование в необработанный строковый литерал](refactoring/convert-to-raw-string-literal.md)
* [Изменение сигнатуры](refactoring/change-signature.md)

## <a name="code-style-enforcement-with-clangformat-and-editorconfig"></a>Применение стиля кода с помощью ClangFormat и EditorConfig

Visual Studio 2017 и более поздней версии поставляется со встроенной поддержкой [ClangFormat](https://clang.llvm.org/docs/ClangFormat.html), популярную программу форматирование кода для C++ основании Clang/LLVM. Введите «ClangFormat» в [быстрого запуска](/visualstudio/ide/reference/quick-launch-environment-options-dialog-box) задать его, чтобы использовать один из следующих распространенных форматов:

- LLVM
- Google
- Chromium
- Mozilla
- WebKit
- Visual Studio

Можно также предоставить свой собственный файл .clang-format или _clang-format, чтобы применить пользовательские правила ко всем файлам кода на том же уровне или ниже.

Файлы, легко использовать совместно с помощью системы управления версиями, так можно принудительно задать соглашения о написании кода в группе разработчиков целиком.

![C&#43; &#43; Clang формат](../ide/media/clang-format-cpp.png "Clang формат")

Visual Studio 2017 и более поздние версии также поддерживает [EditorConfig](https://editorconfig.org/), которая работает аналогичным образом. ClangFormat, однако имеет дополнительные параметры стиля, чем EditorConfig, в том числе правил, относящихся к C++. С помощью **EditorConfig**, создании **.editorconfig** файлы и поместить их в разных папках из вашей базы кода для указания стилей кода папках и подпапках. **.Editorconfig** файл заменяет любой другой **.editorconfig** файлы родительских папок и перезаписывает любые параметры форматирования, настроены с помощью **средства**  >  **Параметры**. Можно задать правила для табуляции и пробелов, размер отступа и многое другое. Дополнительные сведения см. в разделе [Создание переносимых, настраиваемых параметров редактора с EditorConfig](/visualstudio/ide/create-portable-custom-editor-options).

## <a name="other-formatting-options"></a>Другие параметры форматирования

**Быстрого запуска** поле поиска предоставляет самый быстрый способ поиска, параметр или инструмент. Он находится в главном меню. Просто начните ввод, и список автоматического завершения отфильтрует результаты.

![Быстрый запуск Visual Studio](../ide/media/vs2015_cpp_quick_launch.png "быстрого запуска")

Чтобы задать параметры форматирования, например отступы, завершение скобок и раскраску, введите "C++ форматирование» в **быстрого запуска** окна.

![Параметры форматирования C++](media/cpp-formatting-options.png)

Другие параметры форматирования будут расположены в **изменить** > **Дополнительно** в главном меню.

![C++Дополнительные параметры редактирования](media/edit-advanced-cpp.png)

Параметры для включения и настройки C++-конкретных функций редактирования, находятся в папке **средства** > **параметры** > **текстовый редактор**  >  **C /C++** . Чтобы получить дополнительную справку после выбора параметра, который вы хотите задать, выделите диалоговое окно и нажмите клавишу **F1**. Для общих параметров форматирования кода введите `Editor C++` в **быстрого запуска**.

![Инструменты Visual Studio > Параметры](../ide/media/tools-options.png "параметры редактора")

Экспериментальные функции, которые могут присутствовать или отсутствовать в будущих версиях Visual Studio, можно найти в диалоговом окне [экспериментальных функций C++ для текстового редактора](/visualstudio/ide/reference/options-text-editor-c-cpp-experimental). В Visual Studio 2017 и более поздние версии, вы можете включить **прогнозный IntelliSense** в этом диалоговом окне.

## <a name="see-also"></a>См. также раздел

[Чтение и понимание C++ кода](read-and-understand-code-cpp.md)</br>
[Перейдите к C++ кода в Visual Studio](navigate-code-cpp.md)</br>
[Совместная работа с динамической общей папки дляC++](live-share-cpp.md)