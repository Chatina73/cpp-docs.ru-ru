---
title: Реализация страниц свойств
ms.date: 11/04/2016
helpviewer_keywords:
- IPropertyPage2 class
- IPropertyPage class
- property pages, implementing
ms.assetid: 62f29440-33a7-40eb-a1ef-3634c95f640c
ms.openlocfilehash: c4ba69d8421a76a94e4a676cb62ee53936d77da3
ms.sourcegitcommit: 00e26915924869cd7eb3c971a7d0604388abd316
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2019
ms.locfileid: "65524588"
---
# <a name="implementing-property-pages"></a>Реализация страниц свойств

::: moniker range="vs-2019"

Мастер страницы свойств в ATL недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="vs-2017"

Страницы свойств — это COM-объекты, которые реализуют интерфейс `IPropertyPage` или `IPropertyPage2`. Библиотека ATL обеспечивает поддержку реализации страниц свойств с помощью [Мастера страниц свойств ATL](../atl/reference/atl-property-page-wizard.md) в диалоговом окне [Диалоговое окно "Добавление класса"](../ide/add-class-dialog-box.md).

Выполните следующие действия, чтобы создать страницу свойств с помощью ATL.

- Создайте или откройте проект сервера библиотеки динамической компоновки (DLL) ATL.

- Откройте [Диалоговое окно "Добавление класса"](../ide/add-class-dialog-box.md) и выберите **Страница свойств ATL**.

- Убедитесь, что на странице свойств есть подразделение потока (поскольку она имеет пользовательский интерфейс).

- Задайте заголовок, описание (строку документа) и файл справки, которые будут связаны с вашей страницей.

- Добавьте элементы управления в сгенерированный ресурс диалога, чтобы он действовал как пользовательский интерфейс вашей страницы свойств.

- Реагируйте на изменения в пользовательском интерфейсе вашей страницы, чтобы выполнить проверку, обновить сайт или обновить объекты, связанные с вашей страницей. В частности, вызовите [IPropertyPageImpl::SetDirty](../atl/reference/ipropertypageimpl-class.md#setdirty), когда пользователь вносит изменения в страницу свойств.

- При необходимости можно переопределить методы `IPropertyPageImpl`, используя приведенные ниже рекомендации.

   |Метод IPropertyPageImpl|Переопределите, если вы хотите...|Примечания|
   |------------------------------|----------------------------------|-----------|
   |[SetObjects](../atl/reference/ipropertypageimpl-class.md#setobjects)|Выполните базовые проверки работоспособности на количество объектов, передаваемых на вашу страницу, и интерфейсов, которые они поддерживают.|Выполните собственный код перед вызовом реализации базового класса. Если устанавливаемые объекты не соответствуют вашим ожиданиям, следует как можно скорее отказаться от вызова.|
   |[Активировать](../atl/reference/ipropertypageimpl-class.md#activate)|Инициализируйте пользовательский интерфейс вашей страницы (например, установите диалоговые элементы управления с текущими значениями свойств из объектов, динамически создайте элементы управления или выполните другие инициализации).|Вызовите реализацию базового класса перед вашим кодом, чтобы у базового класса была возможность создать диалоговое окно и все элементы управления перед их обновлением.|
   |[Применить](../atl/reference/ipropertypageimpl-class.md#apply)|Проверьте параметры свойства и обновите объекты.|Нет необходимости вызывать реализацию базового класса, так как он ничего не делает, кроме отслеживания вызова.|
   |[Деактивировать](../atl/reference/ipropertypageimpl-class.md#deactivate)|Очистите связанные с окном элементы.|Реализация базового класса удаляет диалоговое окно, представляющее страницу свойств. Если вам нужна очистка перед удалением диалогового окна, следует добавить свой код перед вызовом базового класса.|

Пример реализации страницы свойств см. в примере [ Реализация страницы свойств ](../atl/example-implementing-a-property-page.md).

> [!NOTE]
> Если вы хотите разместить элементы управления ActiveX на своей странице свойств, нужно изменить происхождение созданного мастером класса. Замените **CDialogImpl\<CYourClass>** на **CAxDialogImpl\<CYourClass>** в списке базовых классов.

::: moniker-end

## <a name="see-also"></a>См. также

[Страницы свойств](../atl/atl-com-property-pages.md)<br/>
[Примеры кода на Visual C++](../overview/visual-cpp-samples.md)
