---
title: Создание проекта (учебник ATL, часть 1)
ms.custom: get-started-article
ms.date: 09/26/2018
ms.assetid: f6b727d1-390a-4b27-b82f-daadcd9fc059
ms.openlocfilehash: dab9bdab75bb710bf73314aae7283611d9a3b5cc
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50539586"
---
# <a name="creating-the-project-atl-tutorial-part-1"></a>Создание проекта (учебник ATL, часть 1)

В этом учебнике пошаговые проект без атрибутов ATL, который создает объект ActiveX, который отображает многоугольник. Объект включает параметры для разрешения пользователя для изменения числа сторон, входящим в состав многоугольников и код, чтобы обновить экран.

> [!NOTE]
> ATL и MFC не поддерживаются обычно в выпусках Express Visual Studio.

> [!NOTE]
> Этот учебник создает того же исходного кода, что и в примере многоугольника. Если вы хотите избежать ручного ввода исходного кода, его можно скачать из [абстрактный пример многоугольника](https://github.com/Microsoft/VCSamples/tree/master/VC2008Samples/ATL/Controls/Polygon). Затем можно ссылаться на исходный код многоугольника, как работать с учебником, или использовать его на наличие ошибок в проекте.
> Чтобы скомпилировать, откройте файл stdafx.h и замените:
> ```
> #ifndef WINVER
> #define WINVER 0x0400
> #endif
> ```
> на
> ```
> #ifndef WINVER
> #define WINVER 0x0500
> #define _WIN32_WINNT 0x0500
> #endif
> ```
> Компилятор будет по-прежнему жалуются на `regsvr32` не завершается правильно, но вы по-прежнему должен иметь DLL элемента управления, созданные и доступны для использования.

### <a name="to-create-the-initial-atl-project-using-the-atl-project-wizard"></a>Для создания начального проекта ATL, используя мастер проектов ATL

1. В среде разработки Visual Studio, нажмите кнопку **New** на **файл** меню, а затем щелкните **проекта**.

1. Откройте **Visual C++** и выберите **MFC/ATL**. Выберите **проекта ATL**.

1. Тип *многоугольника* как имя проекта.

    Расположение исходного кода обычно по умолчанию будет \Users\\\<имя пользователя > \source\repos и новая папка будет создана автоматически.

1. Нажмите кнопку **ОК** и **проекта ATL** откроется мастер.

1. Нажмите кнопку **параметры приложения** Чтобы просмотреть доступные параметры.

1. Как вы создаете элемент управления, и элемент управления должен быть сервером в процессе, не устанавливайте **тип приложения** как библиотеку DLL.

1. Для других параметров оставьте значения по умолчанию и нажмите кнопку **ОК**.

**Мастер проектов ATL** будет создан проект, создав несколько файлов. Вы можете просматривать эти файлы в **обозревателе решений** , развернув `Polygon` объекта. Ниже перечислены файлы.

|Файл|Описание|
|----------|-----------------|
|Polygon.cpp|Содержит реализацию `DllMain`, `DllCanUnloadNow`, `DllGetClassObject`, `DllRegisterServer`, и `DllUnregisterServer`. Также содержит сопоставление объекта, который является списком объектов ATL в проект. Это поле пустым.|
|Polygon.DEF|Этот файл определения модуля предоставляет сведения о экспортов, необходимых для библиотеки DLL для компоновщика.|
|Polygon.IDL|Интерфейс определения языка файл, который описывает интерфейсы, определенные для объектов.|
|Polygon.RGS|Этот скрипт реестра содержит сведения для регистрации библиотеки DLL программы.|
|Polygon.rc|Файл ресурсов, который изначально содержит сведения о версии и строка, содержащая имя проекта.|
|Resource.h|Файл заголовка для файла ресурсов.|
|Polygonps.DEF|Этот файл определения модуля содержит сведения о экспортов, необходимых кода прокси и заглушки, которые поддерживают вызовы между подразделениями для компоновщика.|
|stdafx.cpp|Файл, который будет `#include` файлами реализации ATL.|
|stdafx.h|Файл, который будет `#include` файлы заголовков ATL.|

1. В **обозревателе решений**, щелкните правой кнопкой мыши `Polygon` проекта.

1. В контекстном меню, щелкните **свойства**.

1. Щелкните **компоновщика**. Изменение **-UserRedirection** равным **Да**.

1. Нажмите кнопку **ОК**.

На следующем шаге будет добавлен элемент управления в проект.

[На шаге 2](../atl/adding-a-control-atl-tutorial-part-2.md)

## <a name="see-also"></a>См. также

[Учебник](../atl/active-template-library-atl-tutorial.md)
