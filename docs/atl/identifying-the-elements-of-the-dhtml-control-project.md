---
description: Дополнительные сведения см. в статье определение элементов проекта элемента управления DHTML.
title: Определение элементов проекта элемента управления DHTML
ms.date: 11/19/2018
helpviewer_keywords:
- HTML controls, ATL support
- DHTML controls, ATL support
ms.assetid: b627547a-3768-4346-9900-4b7a21fb8e27
ms.openlocfilehash: 7f04857378564a86fc875e9874b79f6ae6c6a625
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97148022"
---
# <a name="identifying-the-elements-of-the-dhtml-control-project"></a>Определение элементов проекта элемента управления DHTML

Большинство управляющих кодов DHTML точно так же, как и для любого элемента управления ATL. Чтобы получить общее представление об универсальном коде, ознакомьтесь с [учебником по ATL](../atl/active-template-library-atl-tutorial.md)и прочитайте разделы [Создание проекта ATL](../atl/reference/creating-an-atl-project.md) и [основные принципы работы с COM-объектами ATL](../atl/fundamentals-of-atl-com-objects.md).

Элемент управления DHTML аналогичен любому элементу управления ATL, за исключением следующих:

- В дополнение к обычным интерфейсам, реализуемым элементом управления, он реализует дополнительный интерфейс, который используется для обмена данными между кодом C++ и пользовательским интерфейсом HTML. Пользовательский интерфейс HTML вызывает код C++ с помощью этого интерфейса.

- Он создает ресурс HTML для пользовательского интерфейса элемента управления.

- Он обеспечивает доступ к объектной модели DHTML через переменную `m_spBrowser` -член, которая является интеллектуальным указателем типа [IWebBrowser2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752127\(v=vs.85\)). Этот указатель используется для доступа к любой части объектной модели DHTML.

На следующем рисунке показана связь между библиотекой DLL, элементом управления DHTML, веб-браузером и ресурсом HTML.

![Элементы проекта элемента управления DHTML](../atl/media/vc52en1.gif "Элементы проекта элемента управления DHTML")

> [!NOTE]
> Имена на этом рисунке являются заполнителями. Имена ресурсов HTML и интерфейсов, предоставляемых в элементе управления, основываются на именах, назначенных им в мастере элементов управления ATL.

На этом рисунке элементы:

- **Моя библиотека DLL** Библиотека DLL, созданная с помощью мастера проектов ATL.

- **Элемент управления** DHTML ( `m_spBrowser` ) элемент управления DHTML, созданный с помощью мастера объектов ATL. Этот элемент управления обращается к объекту веб-браузера и его методам через интерфейс объекта веб-браузера `IWebBrowser2` . Сам элемент управления предоставляет следующие два интерфейса, помимо других стандартных интерфейсов, необходимых для элемента управления.

  - `IDHCTL1` Интерфейс, предоставляемый элементом управления для использования только контейнером.

  - `IDHCTLUI1` Интерфейс диспетчеризации для обмена данными между кодом C++ и пользовательским интерфейсом HTML. Веб-браузер использует интерфейс диспетчеризации элемента управления для вывода элемента управления. Можно вызвать различные методы этого интерфейса диспетчеризации из пользовательского интерфейса элемента управления, вызвав `window.external` , за которым следует имя метода этого интерфейса диспетчеризации, который требуется вызвать. Вы бы могли получить доступ `window.external` из ТЕГА скрипта в HTML, составляющем пользовательский интерфейс для этого элемента управления. Дополнительные сведения о вызове внешних методов в файле ресурсов см. в разделе [вызов кода C++ из DHTML](../atl/calling-cpp-code-from-dhtml.md).

- **IDR_CTL1** Идентификатор ресурса HTML-ресурса. Имя файла в данном случае — DHCTL1UI.htm. Элемент управления DHTML использует ресурс HTML, который содержит стандартные теги HTML и команды диспетчеризации внешних окон, которые можно изменить с помощью текстового редактора.

- **Веб-браузер** Веб-браузер отображает пользовательский интерфейс элемента управления на основе HTML-кода в ресурсе HTML. Указатель на интерфейс веб-браузера `IWebBrowser2` доступен в элементе управления DHTML, чтобы разрешить доступ к объектной модели DHTML.

Мастер элементов управления ATL создает элемент управления с кодом по умолчанию как в ресурсе HTML, так и в cpp-файле. Можно скомпилировать и запустить элемент управления, созданный мастером, а затем просмотреть элемент управления в веб-браузере или в тестовом контейнере элемента управления ActiveX. На рисунке ниже показан HTML-элемент управления ATL по умолчанию с тремя кнопками, отображаемыми в тестовом контейнере:

![Элемент управления ATL DHTML](../atl/media/vc52en2.gif "Элемент управления ATL DHTML")

Чтобы приступить к созданию элемента управления DHTML, см. раздел [Создание элемента управления ATL DHTML](../atl/creating-an-atl-dhtml-control.md) . Сведения о том, как получить доступ к тестовому контейнеру, см. в разделе [Тестирование свойств и событий с помощью тестового контейнера](../mfc/testing-properties-and-events-with-test-container.md) .

## <a name="see-also"></a>См. также раздел

[Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)
