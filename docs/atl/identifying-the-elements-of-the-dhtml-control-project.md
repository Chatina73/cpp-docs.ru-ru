---
title: Определение элементов проекта управления DHTML
ms.date: 11/19/2018
helpviewer_keywords:
- HTML controls, ATL support
- DHTML controls, ATL support
ms.assetid: b627547a-3768-4346-9900-4b7a21fb8e27
ms.openlocfilehash: 5fabdc815989c21bdf6b0932b9d6826e28d7012a
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81319505"
---
# <a name="identifying-the-elements-of-the-dhtml-control-project"></a>Определение элементов проекта управления DHTML

Большинство код управления DHTML точно так же, как созданный для любого управления ATL. Для базового понимания общего кода, проработать [учебник ATL](../atl/active-template-library-atl-tutorial.md), и читать разделы [Создание проекта ATL](../atl/reference/creating-an-atl-project.md) и [основы объектов ATL COM](../atl/fundamentals-of-atl-com-objects.md).

Контроль DHTML аналогичен любому управлению ATL, за исключением:

- В дополнение к обычным интерфейсам, реализуемым в области управления, он реализует дополнительный интерфейс, который используется для связи между кодом СЗ и пользовательским интерфейсом HTML (UI). Html UI вызывает в код СЗ с помощью этого интерфейса.

- Он создает HTML-ресурс для элементного управления.

- Это позволяет получить доступ к модели объекта `m_spBrowser`DHTML через переменную члена, которая является интеллектуальным указателем типа [IWebBrowser2.](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752127\(v=vs.85\)) Используйте этот указатель для доступа к любой части модели объекта DHTML.

Следующий график иллюстрирует связь между DLL, управлением DHTML, веб-браузером и html-ресурсом.

![Элементы проекта элемента управления DHTML](../atl/media/vc52en1.gif "Элементы проекта элемента управления DHTML")

> [!NOTE]
> Имена на этом графике являются заполнителями. Имена вашего HTML-ресурса и интерфейсы, выставленные на элементе управления, основаны на именах, которые вы присваивают им в ATL Control Wizard.

На этом рисунке элементы:

- **Мой DLL** DLL создан с помощью ATL Project Wizard.

- **Управление DHTML** (`m_spBrowser`) Управление DHTML, созданное с помощью мастера объектов ATL. Это управление получает доступ к объекту веб-браузера и его `IWebBrowser2`методам через интерфейс объекта веб-браузера. Сам элемент управления предоставляет следующие два интерфейса, в дополнение к другим стандартным интерфейсам, необходимым для управления.

  - `IDHCTL1`Интерфейс, выставленный элементом управления для использования только контейнером.

  - `IDHCTLUI1`Интерфейс диспетчерской отправки для общения между кодом СЗ и пользовательским интерфейсом HTML. Веб-браузер использует диспетчерский интерфейс управления для отображения элемента управления. Вы можете вызвать различные методы этого интерфейса отправки `window.external`из пользовательского интерфейса управления, ссылаясь на имя метода на этом интерфейсе отправки, который вы хотите вызвать. Вы получите доступ `window.external` из тега SCRIPT в HTML, который составляет uI для этого элемента управления. Для получения дополнительной информации о вызове внешних [Calling C++ Code from DHTML](../atl/calling-cpp-code-from-dhtml.md)методов в файле ресурса см.

- **IDR_CTL1** Идентификатор ресурса HTML-ресурса. Его имя файла, в данном случае, DHCTL1UI.htm. В управлении DHTML используется HTML-ресурс, содержащий стандартные HTML-теги и команды на отправления внешних окон, которые можно редактировать с помощью редактора Text.

- **Веб-браузер** Веб-браузер отображает интерфейс управления, основанный на HTML на ресурсе HTML. Указатель на интерфейс веб-браузера `IWebBrowser2` доступен в управлении DHTML, чтобы обеспечить доступ к модели объекта DHTML.

Мастер управления ATL генерирует элемент управления с кодом по умолчанию как в ресурсе HTML, так и в файле .cpp. Можно компилировать и запускать элемент управления по мере сгенерированного мастером, а затем просматривать элемент управления в веб-браузере или контейнере test Control. На рисунке ниже показан контроль ATL DHTML по умолчанию с тремя кнопками, отображаемыми в тестовом контейнере:

![Элемент управления ATL DHTML](../atl/media/vc52en2.gif "Элемент управления ATL DHTML")

Смотрите [Создание управления ATL DHTML,](../atl/creating-an-atl-dhtml-control.md) чтобы начать создание управления DHTML. Спомощью [тестового свойства и события с тест-контейнером](../mfc/testing-properties-and-events-with-test-container.md) можно получить информацию о том, как получить доступ к тестовому контейнеру.

## <a name="see-also"></a>См. также раздел

[Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)
