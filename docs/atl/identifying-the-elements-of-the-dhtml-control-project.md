---
title: Определение элементов для проекта элемента управления DHTML
ms.date: 11/19/2018
helpviewer_keywords:
- HTML controls, ATL support
- DHTML controls, ATL support
ms.assetid: b627547a-3768-4346-9900-4b7a21fb8e27
ms.openlocfilehash: 32b1c00e3ad3ed15fa56f7718789fe1a2e3ecbab
ms.sourcegitcommit: bff17488ac5538b8eaac57156a4d6f06b37d6b7f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2019
ms.locfileid: "57424383"
---
# <a name="identifying-the-elements-of-the-dhtml-control-project"></a>Определение элементов для проекта элемента управления DHTML

Большая часть кода DHTML-элемент управления точно так, создается для любого элемента управления ATL. Для понимания универсального кода, работают через [учебник по ATL](../atl/active-template-library-atl-tutorial.md), и ознакомьтесь с разделами [Создание проекта ATL](../atl/reference/creating-an-atl-project.md) и [основы объекта ATL COM-объекты](../atl/fundamentals-of-atl-com-objects.md).

Элемент управления DHTML похоже на любой элемент управления ATL, за исключением:

- Помимо обычных интерфейсов, который реализует элемент управления он реализует дополнительный интерфейс, который используется для взаимодействия между кодом C++ и HTML пользовательский интерфейс (UI). Пользовательского интерфейса HTML вызывает код C++, с помощью этого интерфейса.

- Он создает ресурс HTML для элемента управления пользовательского интерфейса.

- Она позволяет получать доступ к объектной модели DHTML через переменную-член `m_spBrowser`, который является интеллектуальный указатель типа [IWebBrowser2](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752127\(v=vs.85\)). Используйте этот указатель для доступа к любой части объектной модели DHTML.

Приведенный ниже рисунок иллюстрирует связь между библиотеки DLL, элемент управления DHTML, веб-браузер и HTML-ресурса.

![Элементы проекта элемента управления DHTML](../atl/media/vc52en1.gif "элементы проекта элемента управления DHTML")

> [!NOTE]
>  Имена на этом рисунке представляют собой заполнители. Имена HTML ресурс и интерфейсы, предоставляемые в элементе управления основаны на имена, назначаемые в мастер элементов управления ATL.

На этом графике приведены элементы.

- **Библиотеки DLL** библиотеку DLL, созданную с помощью мастера проектов ATL.

- **Элемент управления DHTML** (`m_spBrowser`) элемент управления DHTML, созданных с помощью мастер объектов ATL. Этот элемент управления обращается к объект веб-браузера и его методы через интерфейс объект веб-браузера, `IWebBrowser2`. Сам элемент управления предоставляет два интерфейса, а также другие стандартные интерфейсы, необходимые для элемента управления.

   - `IDHCTL1` Интерфейс, предоставляемый элементом управления для использования только в качестве контейнера.

   - `IDHCTLUI1` Интерфейс диспетчеризации для взаимодействия между кодом C++ и интерфейса пользователя HTML. Веб-браузер использует интерфейс диспетчеризации для элемента управления для отображения элемента управления. Можно использовать различные методы этого интерфейса диспетчеризации из элемента управления пользовательского интерфейса путем вызова `window.external`, а затем имя метода для этого интерфейса диспетчеризации, которую требуется вызвать. Доступ к `window.external` из тега СКРИПТА в HTML-код, составляющий пользовательского интерфейса для данного элемента управления. Дополнительные сведения о вызове внешние методы в файле ресурсов см. в разделе [вызов кода C++ из DHTML](../atl/calling-cpp-code-from-dhtml.md).

- **IDR_CTL1** идентификатор ресурса для HTML-ресурса. Имя файла, в этом случае является DHCTL1UI.htm. Элемент управления DHTML использует ресурс HTML, содержащий стандартный HTML-теги и внешнем окне диспетчеризации команд, которые можно изменять с помощью текстового редактора.

- **Веб-браузера** веб-браузер отображает пользовательский Интерфейс элемента управления, основанная на HTML в HTML-ресурса. Указатель на веб-браузера `IWebBrowser2` интерфейс доступен в элементе управления DHTML, чтобы разрешить доступ к объектной модели DHTML.

Мастер элементов управления ATL создается элемент управления с кодом по умолчанию в HTML-ресурса и CPP-файл. Можно скомпилировать и запустить элемент управления, создаваемый мастером и просмотрите элемент управления в веб-браузера или тестовый контейнер элементов управления ActiveX. На рисунке ниже показаны управления DHTML в ATL по умолчанию с помощью трех кнопок, отображаемых в тестовом контейнере:

![Элемент управления DHTML в ATL](../atl/media/vc52en2.gif "управления DHTML в ATL")

См. в разделе [Создание элемента управления DHTML в ATL](../atl/creating-an-atl-dhtml-control.md) можно приступить к сборке элемента управления DHTML. См. в разделе [тестирование свойств и событий с использованием тестового контейнера](../mfc/testing-properties-and-events-with-test-container.md) сведения о том, как получить доступ к контейнеру теста.

## <a name="see-also"></a>См. также

[Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)
