---
title: Изменение элемента управления DHTML в ATL
ms.date: 11/04/2016
helpviewer_keywords:
- HTML controls, modifying
- DHTML controls
- DHTML controls, modifying
ms.assetid: c053f35f-8629-4600-9595-721f5956777a
ms.openlocfilehash: 6c8976c013d0114a3115d3b0bc38fa4bc6acb5b7
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62261661"
---
# <a name="modifying-the-atl-dhtml-control"></a>Изменение элемента управления DHTML в ATL

Мастер элементов управления ATL предоставляет начальный код, поэтому можно собрать и запустить элемент управления, поэтому вы увидите, как методы записываются в файлы проекта и как DHTML вызывает код C++ элемента управления, с помощью методов диспетчеризации. Вы можете добавить любой метод диспетчеризации к интерфейсу. Затем можно вызывать методы в HTML-ресурса.

## <a name="to-modify-the-atl-dhtml-control"></a>Чтобы изменить элемент управления DHTML в ATL

1. В **представление классов**, разверните проект элемента управления.

   Обратите внимание, что интерфейс, который заканчивается на «Пользовательского интерфейса» имеет один метод `OnClick`. Интерфейс, который не оканчивается на «Пользовательский Интерфейс» не имеет никаких методов.

1. Добавьте метод с именем `MethodInvoked` на интерфейс, который не оканчивается на «Пользовательского интерфейса.»

   Этот метод будет добавляться на интерфейс, который используется в контейнере элементов управления для взаимодействия с контейнером, не к интерфейсу DHTML, используемый для взаимодействия с элементом управления. Только контейнер может вызвать этот метод.

1. Найдите метод заглушки в CPP-файл и добавьте код для отображения окна сообщения, например:

   [!code-cpp[NVC_ATL_COM#5](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_1.cpp)]

1. Добавьте другой метод с именем `HelloHTML`, только на этот раз добавьте его к интерфейсу, который заканчивается на «Пользовательского интерфейса.» Найти усеченные `HelloHTML` метод в .cpp и добавьте код для отображения окна сообщения, например:

   [!code-cpp[NVC_ATL_COM#6](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_2.cpp)]

1. Добавьте третий метод, `GoToURL`, на интерфейс, который не оканчивается на «Пользовательского интерфейса.» Реализации этого метода, вызвав [IWebBrowser2::Navigate](https://msdn.microsoft.com/library/aa752133.aspx), как показано ниже:

   [!code-cpp[NVC_ATL_COM#7](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_3.cpp)]

   Можно использовать `IWebBrowser2` методы так, как библиотека ATL предоставляет указатель на этот интерфейс для вас в вашей h-файле.

Далее следует измените HTML-ресурса для вызова методов, которые вы создали. Вы добавите три кнопки для вызова этих методов.

## <a name="to-modify-the-html-resource"></a>Для изменения HTML-ресурса

1. В **обозревателе решений**, дважды щелкните htm-файл для отображения HTML-ресурса.

   Проверка HTML, особенно вызовов внешних методов диспетчеризации Windows. HTML-код вызывает проекта `OnClick` метод и параметры указывают текст элемента управления (`theBody`) и цвет для назначения (»`red`«). Текст, следующий за вызовом метода является метка, которая отображается на кнопке.

1. Добавьте еще один `OnClick` метод, только изменение цвета. Пример:

    ```html
    <br>
    <br>
    <BUTTON onclick='window.external.OnClick(theBody, "white");'>Refresh</BUTTON>
    ```

   Этот метод создаст кнопкой с надписью **обновить**, что пользователь может щелкнуть, чтобы вернуться к исходной, белый фон элемента управления.

1. Добавьте вызов в `HelloHTML` созданного метода. Пример:

    ```html
    <br>
    <br>
    <BUTTON onclick='window.external.HelloHTML();'>HelloHTML</BUTTON>
    ```

   Этот метод создаст кнопкой с надписью **HelloHTML**, который пользователь может щелкнуть для отображения `HelloHTML` окно сообщения.

Вы можете создавать и [тестирование измененного элемента управления DHTML](../atl/testing-the-modified-atl-dhtml-control.md).

## <a name="see-also"></a>См. также

[Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)
