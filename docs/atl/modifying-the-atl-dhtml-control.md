---
description: Дополнительные сведения см. в статье изменение элемента управления DHTML ATL.
title: Изменение элемента управления ATL DHTML
ms.date: 11/04/2016
helpviewer_keywords:
- HTML controls, modifying
- DHTML controls
- DHTML controls, modifying
ms.assetid: c053f35f-8629-4600-9595-721f5956777a
ms.openlocfilehash: 7ae9c102addd7a33341a8f16105a3581de10481e
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97159457"
---
# <a name="modifying-the-atl-dhtml-control"></a>Изменение элемента управления ATL DHTML

Мастер элементов управления ATL предоставляет начальный код, позволяющий выполнять сборку и запуск элемента управления, и поэтому вы можете увидеть, как методы записываются в файлы проекта, а также как вызовы DHTML в код C++ элемента управления с помощью методов диспетчеризации. В интерфейс можно добавить любой метод диспетчеризации. Затем можно вызвать методы в ресурсе HTML.

## <a name="to-modify-the-atl-dhtml-control"></a>Изменение элемента управления DHTML в ATL

1. В **представление классов** разверните проект элемента управления.

   Обратите внимание, что интерфейс, заканчивающийся на "UI", имеет один метод `OnClick` . Интерфейс, который не оканчивается на "UI", не имеет методов.

1. Добавьте метод, вызываемый в `MethodInvoked` интерфейс, не заканчивающийся на "UI".

   Этот метод будет добавлен в интерфейс, который используется в контейнере элемента управления для взаимодействия с контейнером, а не с интерфейсом, используемым DHTML для взаимодействия с элементом управления. Этот метод может вызывать только контейнер.

1. Найдите метод создана в cpp-файле и добавьте код для вывода окна сообщения, например:

   [!code-cpp[NVC_ATL_COM#5](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_1.cpp)]

1. Добавьте еще один метод с именем `HelloHTML` , только на этот раз добавьте его в интерфейс, который заканчивается на "UI". Найдите `HelloHTML` метод создана в cpp-файле и добавьте код для вывода окна сообщения, например:

   [!code-cpp[NVC_ATL_COM#6](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_2.cpp)]

1. Добавьте в интерфейс третий метод, `GoToURL` который не заканчивается на "UI". Реализуйте этот метод, вызвав [IWebBrowser2:: Navigate](/previous-versions//aa752133\(v=vs.85\)), как показано ниже.

   [!code-cpp[NVC_ATL_COM#7](../atl/codesnippet/cpp/modifying-the-atl-dhtml-control_3.cpp)]

   Можно использовать методы, `IWebBrowser2` так как ATL предоставляет указатель на этот интерфейс в h-файле.

Затем измените ресурс HTML, чтобы вызвать созданные методы. Вы добавите три кнопки для вызова этих методов.

## <a name="to-modify-the-html-resource"></a>Изменение ресурса HTML

1. В **Обозреватель решений** дважды щелкните htm-файл, чтобы ОТОБРАЗИТЬ ресурс HTML.

   Изучите код HTML, особенно вызовы внешних методов диспетчеризации Windows. HTML вызывает `OnClick` метод проекта, а параметры указывают текст элемента управления ( `theBody` ) и цвет для назначения (" `red` "). Текст, следующий за вызовом метода, — это метка, которая отображается на кнопке.

1. Добавьте еще один `OnClick` метод, измените только цвет. Пример:

    ```html
    <br>
    <br>
    <BUTTON onclick='window.external.OnClick(theBody, "white");'>Refresh</BUTTON>
    ```

   Этот метод создаст кнопку с надписью Refresh ( **Обновление**), которую пользователь может щелкнуть для возврата элемента управления в исходный белый фон.

1. Добавьте вызов в `HelloHTML` созданный метод. Пример:

    ```html
    <br>
    <br>
    <BUTTON onclick='window.external.HelloHTML();'>HelloHTML</BUTTON>
    ```

   Этот метод создаст кнопку с меткой **хеллохтмл**, которую пользователь может щелкнуть для вывода `HelloHTML` окна сообщения.

Теперь можно создать и [проверить измененный элемент управления DHTML](../atl/testing-the-modified-atl-dhtml-control.md).

## <a name="see-also"></a>См. также раздел

[Поддержка элементов управления DHTML](../atl/atl-support-for-dhtml-controls.md)
