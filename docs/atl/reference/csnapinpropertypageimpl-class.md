---
title: Класс Кснапинпропертипажеимпл
ms.date: 11/04/2016
f1_keywords:
- CSnapInPropertyPageImpl
- ATLSNAP/ATL::CSnapInPropertyPageImpl
- ATLSNAP/ATL::CSnapInPropertyPageImpl::CSnapInPropertyPageImpl
- ATLSNAP/ATL::CSnapInPropertyPageImpl::CancelToClose
- ATLSNAP/ATL::CSnapInPropertyPageImpl::Create
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnApply
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnHelp
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnKillActive
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnQueryCancel
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnReset
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnSetActive
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnWizardBack
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnWizardFinish
- ATLSNAP/ATL::CSnapInPropertyPageImpl::OnWizardNext
- ATLSNAP/ATL::CSnapInPropertyPageImpl::QuerySiblings
- ATLSNAP/ATL::CSnapInPropertyPageImpl::SetModified
- ATLSNAP/ATL::CSnapInPropertyPageImpl::m_psp
helpviewer_keywords:
- snap-ins, property pages
- snap-ins
- property pages, ATL
- CSnapInPropertyPageImpl class
ms.assetid: 75bdce5a-985e-4166-bd44-493132e023c4
ms.openlocfilehash: abf4cf5804f6ef7335192feb298f1a4a06f841e4
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69496399"
---
# <a name="csnapinpropertypageimpl-class"></a>Класс Кснапинпропертипажеимпл

Этот класс предоставляет методы для реализации объекта страницы свойств оснастки.

> [!IMPORTANT]
>  Этот класс и его члены не могут использоваться в приложениях, выполняемых в среда выполнения Windows.

## <a name="syntax"></a>Синтаксис

```
CSnapInPropertyPageImpl : public CDialogImplBase
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кснапинпропертипажеимпл:: Кснапинпропертипажеимпл](#csnapinpropertypageimpl)|Конструктор.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кснапинпропертипажеимпл:: Канцелтоклосе](#canceltoclose)|Изменяет состояние кнопок **ОК** и **Отмена** .|
|[Кснапинпропертипажеимпл:: Create](#create)|Инициализирует вновь созданный `CSnapInPropertyPageImpl` объект.|
|[Кснапинпропертипажеимпл:: OnApply](#onapply)|Вызывается платформой, когда пользователь нажимает кнопку " **Применить сейчас** " при использовании страницы свойств типа мастера.|
|[Кснапинпропертипажеимпл:: OnHelp](#onhelp)|Вызывается платформой при нажатии пользователем кнопки " **Справка** " при использовании страницы свойств типа мастера.|
|[CSnapInPropertyPageImpl::OnKillActive](#onkillactive)|Вызывается структурой, когда текущая страница больше не активна.|
|[Кснапинпропертипажеимпл:: OnQueryCancel](#onquerycancel)|Вызывается платформой, когда пользователь нажимает кнопку **"Отмена** " и до отмены.|
|[CSnapInPropertyPageImpl::OnReset](#onreset)|Вызывается платформой, когда пользователь нажимает кнопку " **Сброс** " при использовании страницы свойств типа мастера.|
|[CSnapInPropertyPageImpl::OnSetActive](#onsetactive)|Вызывается структурой при активации текущей страницы.|
|[Кснапинпропертипажеимпл:: Онвизардбакк](#onwizardback)|Вызывается структурой при нажатии пользователем кнопки " **назад** " при использовании страницы свойств типа мастера.|
|[Кснапинпропертипажеимпл:: Онвизардфиниш](#onwizardfinish)|Вызывается платформой, когда пользователь нажимает кнопку **"Готово"** при использовании страницы свойств типа мастера.|
|[Кснапинпропертипажеимпл:: Онвизарднекст](#onwizardnext)|Вызывается платформой, когда пользователь нажимает кнопку " **Далее** " при использовании страницы свойств типа мастера.|
|[Кснапинпропертипажеимпл:: Куерисиблингс](#querysiblings)|Пересылает текущее сообщение всем страницам страницы свойств.|
|[Кснапинпропертипажеимпл:: SetModified](#setmodified)|Вызовите, чтобы активировать или деактивировать кнопку **Применить сейчас** .|

### <a name="public-data-members"></a>Открытые члены данных

|name|Описание|
|----------|-----------------|
|[CSnapInPropertyPageImpl::m_psp](#m_psp)|Структура Windows `PROPSHEETPAGE` , используемая `CSnapInPropertyPageImpl` объектом.|

## <a name="remarks"></a>Примечания

`CSnapInPropertyPageImpl`предоставляет базовую реализацию для объекта страницы свойств оснастки. Основные возможности страницы свойств оснастки реализуются с помощью нескольких различных интерфейсов и типов карт.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`CDialogImplBase`

`CSnapInPropertyPageImpl`

## <a name="requirements"></a>Требования

**Заголовок:** атлснап. h

##  <a name="canceltoclose"></a>Кснапинпропертипажеимпл:: Канцелтоклосе

Вызовите эту функцию после внесения неустранимых изменений в данные на странице модальной страницы свойств.

```
void CancelToClose();
```

### <a name="remarks"></a>Примечания

Эта функция изменит кнопку **ОК** , чтобы **Закрыть** и отключить кнопку **Отмена** . Это изменение предупреждает пользователя о том, что изменение является постоянным, и изменения не могут быть отменены.

Функция-член ничего не делает на немодальной странице свойств, так как немодальная страница свойств по умолчанию не имеет кнопки **отмены.** `CancelToClose`

##  <a name="csnapinpropertypageimpl"></a>Кснапинпропертипажеимпл:: Кснапинпропертипажеимпл

Создает объект `CSnapInPropertyPageImpl`.

```
CSnapInPropertyPageImpl(LPCTSTR lpszTitle = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзтитле*<br/>
окне Заголовок страницы свойств.

### <a name="remarks"></a>Примечания

Чтобы инициализировать базовую структуру, вызовите метод [кснапинпропертипажеимпл:: Create](#create).

##  <a name="create"></a>Кснапинпропертипажеимпл:: Create

Вызовите эту функцию, чтобы инициализировать базовую структуру страницы свойств.

```
HPROPSHEETPAGE Create();
```

### <a name="return-value"></a>Возвращаемое значение

Маркер `PROPSHEETPAGE` структуры, содержащей атрибуты только что созданной страницы свойств.

### <a name="remarks"></a>Примечания

Перед вызовом этой функции необходимо сначала вызвать метод [кснапинпропертипажеимпл:: кснапинпропертипажеимпл](#csnapinpropertypageimpl) .

##  <a name="m_psp"></a>Кснапинпропертипажеимпл:: m_psp

`m_psp`— Это структура, члены которой хранят характеристики `PROPSHEETPAGE`.

```
PROPSHEETPAGE m_psp;
```

### <a name="remarks"></a>Примечания

Используйте эту структуру для инициализации внешнего вида страницы свойств после ее конструирования.

Дополнительные сведения об этой структуре, включая список ее членов, см. в разделе [пропшитпаже](/windows/win32/api/prsht/ns-prsht-propsheetpagea_v3) в Windows SDK.

##  <a name="onapply"></a>Кснапинпропертипажеимпл:: OnApply

Эта функция-член вызывается, когда пользователь нажимает кнопку **ОК** или **Применить сейчас** .

```
BOOL OnApply();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменения принимаются; в противном случае — 0.

### <a name="remarks"></a>Примечания

Прежде `OnApply` чем может вызываться платформой, необходимо вызвать метод `SetModified` и присвоить его параметру значение true. Это активирует кнопку **Применить сейчас** , как только пользователь вносит изменения на странице свойств.

Переопределите эту функцию члена, чтобы указать, какое действие программа принимает, когда пользователь нажмет кнопку " **Применить сейчас** ". При переопределении функция должна возвращать значение TRUE, чтобы принимать изменения, и FALSE, чтобы предотвратить внесение изменений в действие.

Реализация по умолчанию `OnApply` возвращает значение true.

##  <a name="onhelp"></a>Кснапинпропертипажеимпл:: OnHelp

Эта функция-член вызывается, когда пользователь нажимает кнопку " **Справка** " для страницы свойств.

```
void OnHelp();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию-член, чтобы отобразить справку для страницы свойств.

##  <a name="onkillactive"></a>  CSnapInPropertyPageImpl::OnKillActive

Эта функция-член вызывается, когда страница больше не является активной страницей.

```
BOOL OnKillActive();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если данные были успешно обновлены; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию члена для выполнения специальных задач проверки данных.

##  <a name="onquerycancel"></a>Кснапинпропертипажеимпл:: OnQueryCancel

Эта функция-член вызывается, когда пользователь нажимает кнопку « **Отмена** » и перед действием «Отмена».

```
BOOL OnQueryCancel();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, чтобы разрешить операцию отмены; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию члена, чтобы указать действие, которое программа принимает при нажатии пользователем кнопки **"Отмена"** .

Реализация по умолчанию `OnQueryCancel` возвращает значение true.

##  <a name="onreset"></a>Кснапинпропертипажеимпл:: OnReset

Эта функция-член вызывается, когда пользователь нажимает кнопку **Отмена** .

```
void OnReset();
```

### <a name="remarks"></a>Примечания

При вызове этой функции изменения всех страниц свойств, которые были сделаны пользователем, ранее нажимая кнопку " **Применить сейчас** ", отменяются, а страница свойств остается в фокусе.

Переопределите эту функцию члена, чтобы указать, какое действие программа принимает при нажатии пользователем кнопки **"Отмена"** .

##  <a name="onsetactive"></a>Кснапинпропертипажеимпл:: Онсетактиве

Эта функция-член вызывается при выборе пользователем страницы и становится активной страницей.

```
BOOL OnSetActive();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если страница успешно задана в активном состоянии. в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию-член для выполнения задач при активации страницы. Переопределение этой функции-члена должно вызывать версию по умолчанию до завершения любой другой обработки.

Реализация по умолчанию возвращает значение TRUE.

##  <a name="onwizardback"></a>Кснапинпропертипажеимпл:: Онвизардбакк

Эта функция-член вызывается, когда пользователь нажимает кнопку " **назад** " в мастере.

```
BOOL OnWizardBack();
```

### <a name="return-value"></a>Возвращаемое значение

- 0 для автоматического перехода на предыдущую страницу.

- значение-1, чтобы предотвратить изменение страницы.

Чтобы перейти к странице, отличной от следующей, возвращается идентификатор отображаемого диалогового окна.

### <a name="remarks"></a>Примечания

Переопределите эту функцию-член, чтобы указать действие, которое должен выполнить пользователь при нажатии кнопки " **назад** ".

##  <a name="onwizardfinish"></a>Кснапинпропертипажеимпл:: Онвизардфиниш

Эта функция-член вызывается, когда пользователь нажимает кнопку **"Готово"** в мастере.

```
BOOL OnWizardFinish();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если страница свойств уничтожается по завершении работы мастера. в противном случае — ноль.

### <a name="remarks"></a>Примечания

Переопределите эту функцию-член, чтобы указать действие, которое пользователь должен выполнить при нажатии кнопки **"Готово"** .

##  <a name="onwizardnext"></a>Кснапинпропертипажеимпл:: Онвизарднекст

Эта функция-член вызывается, когда пользователь нажимает кнопку " **Далее** " в мастере.

```
BOOL OnWizardNext();
```

### <a name="return-value"></a>Возвращаемое значение

- 0 для автоматического перехода на следующую страницу.

- значение-1, чтобы предотвратить изменение страницы.

Чтобы перейти к странице, отличной от следующей, возвращается идентификатор отображаемого диалогового окна.

### <a name="remarks"></a>Примечания

Переопределите эту функцию-член, чтобы указать действие, которое пользователь должен выполнить при нажатии кнопки " **Далее** ".

##  <a name="querysiblings"></a>Кснапинпропертипажеимпл:: Куерисиблингс

Вызовите эту функцию-член, чтобы перенаправить сообщение на каждую страницу в странице свойств.

```
LRESULT QuerySiblings(WPARAM wParam, LPARAM lParam);
```

### <a name="parameters"></a>Параметры

*wParam*<br/>
окне Указывает дополнительные сведения, зависящие от сообщений.

*lParam*<br/>
окне Указывает дополнительные сведения, зависящие от сообщений.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если сообщение не должно пересылаться на следующую страницу свойств; в противном случае — ноль.

### <a name="remarks"></a>Примечания

Если страница возвращает ненулевое значение, вкладка свойств не отправляет сообщение на последующие страницы.

##  <a name="setmodified"></a>Кснапинпропертипажеимпл:: SetModified

Вызовите эту функцию-член, чтобы включить или отключить кнопку " **Применить сейчас** " в зависимости от того, должны ли параметры на странице свойств применяться к соответствующему внешнему объекту.

```
void SetModified(BOOL bChanged = TRUE);
```

### <a name="parameters"></a>Параметры

*бчанжед*<br/>
окне Значение TRUE указывает, что параметры страницы свойств были изменены с момента последнего применения. Значение FALSE указывает, что параметры страницы свойств применены или должны игнорироваться.

### <a name="remarks"></a>Примечания

Страница свойств отслеживает, какие страницы являются «грязными», то есть страницами свойств, для которых вызван `SetModified( TRUE )`. Кнопка **Применить сейчас** всегда будет включена при вызове `SetModified( TRUE )` одной из страниц. Кнопка **Применить Now** будет отключена при вызове `SetModified( FALSE )` одной из страниц, но только в случае, если ни одна из других страниц не является "грязной".

## <a name="see-also"></a>См. также

[Обзор класса](../../atl/atl-class-overview.md)
