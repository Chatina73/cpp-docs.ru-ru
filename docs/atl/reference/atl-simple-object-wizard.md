---
title: Мастер простых объектов ATL
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.simple.overview
helpviewer_keywords:
- ATL projects, adding objects
- ATL Simple Object Wizard
ms.assetid: f7f85741-9aad-4543-a917-a29b996364da
ms.openlocfilehash: 8bc611442e98e467a174ebd52ea3c540cf72975f
ms.sourcegitcommit: d9c94dcabd94537e304be0261b3263c2071b437b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "91352691"
---
# <a name="atl-simple-object-wizard"></a>Мастер простых объектов ATL

Этот мастер вставляет в проект минимальный COM-объект. Используйте эту страницу мастера, чтобы указать имена, которые определяют класс C++ и файлы для объекта и его функциональность COM.

На странице [Параметры](../../atl/reference/options-atl-simple-object-wizard.md) этого мастера можно указать потоковую модель объекта, ее агрегатную поддержку и возможность использования сдвоенных интерфейсов и автоматизации. Кроме того, можно указать поддержку интерфейса сведений об ошибках, точек соединения, поддержки Internet Explorer и упакованного потокового взаимодействия.

## <a name="remarks"></a>Комментарии

Начиная с Visual Studio 2008, сценарий регистрации, созданный этим мастером, зарегистрирует свои компоненты COM в разделе **HKEY_CURRENT_USER** вместо **HKEY_LOCAL_MACHINE**. Чтобы изменить это, задайте в мастере ATL параметр **Register component for all users** (Регистрация компонентов для всех пользователей).

## <a name="names"></a>Имена

Укажите имена объекта, интерфейса и классов, которые необходимо добавить в проект. Все поля, кроме **Короткое имя**, можно редактировать независимо друг от друга. Если вы меняете текст для **короткого имени**, то это отображается в именах остальных полей на странице. Если в разделе COM вы измените имя **Coclass**, это отразится в полях **Type** и **ProgID**, но имя **Interface** не изменится. Этот принцип именования позволяет вам легко распознавать имена при разработке элементов управления.

> [!NOTE]
> **Coclass** можно изменять только для проектов без атрибутов. Если проект содержит атрибуты, **Coclass** изменить невозможно.

## <a name="c"></a>C++

Предоставляет информацию для класса C++, созданного для объекта.

- **короткое имя;**

   Задает сокращенное имя для объекта. Имя, которым вы определяете имена `Class` и `Coclass`, **CPP-файла** и **H-файла**, **Interface**, **Type** и **ProgID**, если вы не изменили эти поля по отдельности.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. При выборе существующего файла мастер не сохраняет его в выбранном расположении, пока вы не нажмете в мастере кнопку **Готово**.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Class**

   Задает имя создаваемого класса. Это имя основано на имени, указанном в поле **Короткое имя**, с предшествующей "С" — типичным префиксом для имени класса.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Attributed**

   Указывает, использует ли объект атрибуты. Если вы добавляете объект в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть вы можете добавить только помеченные атрибутами объекты в проект, созданный с поддержкой атрибутов.

   Объект с атрибутами можно добавить только в проект ATL с поддержкой атрибутов. Если выбрать этот параметр для проекта ATL без поддержки атрибутов, мастер предложит указать, нужно ли добавить поддержку атрибутов в проект.

   По умолчанию объекты, которые добавляются после установки этого параметра, определяются как атрибуты (флажок установлен). Вы можете снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   Дополнительные сведения см. в разделе [Параметры приложения, мастер проектов ATL](../../atl/reference/application-settings-atl-project-wizard.md) и [основные механизмы атрибутов](../../windows/attributes/cpp-attributes-com-net.md#basic-mechanics-of-attributes) .

## <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях модели COM для объекта.

- **Компонентного класса**

   Задает имя класса компонентов, содержащего список интерфейсов, поддерживаемых объектом.

   > [!NOTE]
   > Если вы создаете проект с помощью атрибутов или указываете на этой странице мастера, что объект использует атрибуты, этот параметр изменить нельзя, так как ATL не включает `coclass` атрибут.

- **Тип**

   Задает описание объекта, которое отобразится в реестре.

- **Интерфейс**

   Задает интерфейс, созданный вами для объекта. Этот интерфейс содержит настраиваемые методы.

- **ProgID:**

   Задает имя, которое можно использовать для контейнеров вместо CLSID объекта.

## <a name="see-also"></a>См. также раздел

[Простой объект ATL](../../atl/reference/adding-an-atl-simple-object.md)
