---
title: Мастер компонентов ATL COM+ 1.0
ms.date: 05/08/2019
helpviewer_keywords:
- ATL projects, adding components
ms.assetid: 11670681-8671-4122-96a4-2e52f8dadce0
ms.openlocfilehash: 24b4698ebc8dd4f61dfd88ad14e64d4f70b2ef35
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65707033"
---
# <a name="atl-com-10-component-wizard"></a>Мастер компонентов ATL COM+ 1.0

::: moniker range="vs-2019"

Этот мастер недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="<=vs-2017"

Этот мастер используется для добавления объекта в проект, который поддерживает службы COM+ 1.0, включая транзакции.

Вы можете указать, поддерживает ли объект сдвоенные интерфейсы и службу автоматизации. Вы также можете указать на поддержку интерфейса информации об ошибках, расширенного управления объектами, транзакций и асинхронной очереди сообщений.

## <a name="remarks"></a>Примечания

Начиная с Visual Studio 2008, сценарий регистрации, созданный этим мастером, зарегистрирует свои компоненты COM в разделе **HKEY_CURRENT_USER** вместо **HKEY_LOCAL_MACHINE**. Чтобы изменить это, задайте в мастере ATL параметр **Register component for all users** (Регистрация компонентов для всех пользователей).

## <a name="names"></a>Имена

Укажите имена объекта, интерфейса и классов, которые необходимо добавить в проект. За исключением элемента **Короткое имя**, остальные поля можно изменить независимо друг от друга. Если вы меняете текст для **короткого имени**, то это отображается в именах остальных полей на странице. Если в разделе COM вы измените имя **Coclass**, это отразится в полях **Type** и **ProgID**, но имя **Interface** не изменится. Этот принцип именования позволяет вам легко распознать имена при разработке элементов управления.

- **Короткое имя**

   Задает сокращенное имя для объекта. Имя, которым вы определяете имена `Class` и `Coclass`, **CPP-файла** и **H-файла**, **Interface**, **Type** и **ProgID**, если вы не изменили эти поля по отдельности.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. При выборе существующего файла мастер не сохраняет его в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Класс**

   Задает имя создаваемого класса. Это имя основано на имени, указанном в поле **Короткое имя**, с предшествующей "С", типичным префиксом для имени класса.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Attributed**

   Указывает, использует ли объект атрибуты. Если вы добавляете объект в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть вы можете добавить только помеченные атрибутами объекты в проект, созданный с поддержкой атрибутов.

   Если выбрать этот параметр для проекта ATL без поддержки атрибутов, мастер предложит указать, нужно ли добавить поддержку атрибутов в проект.

   Объекты, которые добавляются после установки этого параметра, определяются как атрибуты по умолчанию (флажок установлен). Вы можете снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   Дополнительные сведения см. в статьях [Application Settings, ATL Project Wizard](../../atl/reference/application-settings-atl-project-wizard.md) (Параметры приложений, мастер проектов ATL) и [C++ Attributes for COM and .NET](../../windows/basic-mechanics-of-attributes.md) (Атрибуты C++ для COM и .NET).

### <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях модели COM для объекта.

- **Coclass**

   Задает имя класса компонентов, содержащего список интерфейсов, поддерживаемых объектом.

> [!NOTE]
>  Если вы создаете проект, использующий атрибуты, или указываете на странице мастера, что компонент COM+ 1.0 использует атрибуты, то вы не сможете изменить этот параметр, так как ATL не содержит атрибут `coclass`.

- **Type**

   Задает описание объекта, которое отобразится в реестре.

- **Interface**

   Задает интерфейс, созданный вами для объекта. Этот интерфейс содержит настраиваемые методы.

- **ProgID**

   Задает имя, которое можно использовать для контейнеров вместо CLSID объекта.
   
::: moniker-end

## <a name="see-also"></a>См. также

[Adding an ATL COM+ 1.0 Component](../../atl/reference/adding-an-atl-com-plus-1-0-component.md) (Добавление компонента COM+ 1.0 библиотеки ATL)
