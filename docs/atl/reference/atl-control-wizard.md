---
title: Мастер элементов управления ATL
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.control.overview
helpviewer_keywords:
- ATL projects, adding controls
- controls [ATL], adding to projects
- ATL Control Wizard
ms.assetid: 991f8e72-ffbc-4382-a4ce-e255acfba5b6
ms.openlocfilehash: c89fe17272399212e4436481abc2800c3ab6e660
ms.sourcegitcommit: d9c94dcabd94537e304be0261b3263c2071b437b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2020
ms.locfileid: "91353146"
---
# <a name="atl-control-wizard"></a>Мастер элементов управления ATL

Вставляет элемент управления ATL в проект ATL (или проект MFC с поддержкой ATL). Этот мастер можно использовать для вставки одного из трех видов элементов управления:

- Стандартный элемент управления

- Составной элемент управления

- Элемент управления DHTML

Кроме того, можно указать минимальный элемент управления, удалив интерфейсы из списка [интерфейсов](../../atl/reference/interfaces-atl-control-wizard.md) , которые предоставляются в качестве значений по умолчанию для элементов управления, открываемых в большинстве контейнеров. Интерфейсы, которые требуется поддерживать для элемента управления, можно задать на странице **интерфейсы** мастера.

## <a name="remarks"></a>Комментарии

Сценарий регистрации, созданный этим мастером, зарегистрирует свои COM-компоненты в HKEY_CURRENT_USER вместо HKEY_LOCAL_MACHINE. Чтобы изменить это, задайте в мастере ATL параметр **Register component for all users** (Регистрация компонентов для всех пользователей).

## <a name="names"></a>Имена

Укажите имена объекта, интерфейса и классов, которые необходимо добавить в проект. Кроме **коротких имен**, все остальные поля можно изменять независимо друг от друга. Если вы меняете текст для **короткого имени**, то это отображается в именах остальных полей на странице. Если изменить имя **кокласса** в разделе com, это изменение будет отражено в поле **Тип** , но имя **интерфейса** и **ProgID** не изменятся. Этот принцип именования позволяет вам легко распознавать имена при разработке элементов управления.

> [!NOTE]
> **Компонент coclass** может редактироваться только для элементов управления, не имеющих атрибутов. Если проект содержит атрибуты, **Coclass** изменить невозможно.

### <a name="c"></a>C++

Предоставляет информацию для класса C++, созданного для реализации объекта.

- **короткое имя;**

   Задает сокращенное имя для объекта. Предоставляемое имя определяет имена класса и **сокласса** , файл (. CPP и. H) имена, имя интерфейса и имена **типов** , если не изменить эти поля по отдельности.

- **Class**

   Задает имя класса, реализующего объект. Это имя основано на имени, указанном в поле **Короткое имя**, с предшествующей "С" — типичным префиксом для имени класса.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. Если выбрать существующий файл, мастер не сохранит его в выбранном расположении до нажатия кнопки **"Готово"**.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Attributed**

   Указывает, использует ли объект атрибуты. Если вы добавляете объект в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть вы можете добавить только помеченные атрибутами объекты в проект, созданный с поддержкой атрибутов.

   Объект с атрибутами можно добавить только в проект ATL с поддержкой атрибутов. Если выбрать этот параметр для проекта ATL без поддержки атрибутов, мастер предложит указать, нужно ли добавить поддержку атрибутов в проект.

   По умолчанию объекты, которые добавляются после установки этого параметра, определяются как атрибуты (флажок установлен). Вы можете снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   Дополнительные сведения см. в разделе [Параметры приложения, мастер проектов ATL](../../atl/reference/application-settings-atl-project-wizard.md) и [основные механизмы атрибутов](../../windows/attributes/cpp-attributes-com-net.md#basic-mechanics-of-attributes) .

### <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях модели COM для объекта.

- **Компонентного класса**

   Задает имя класса компонентов, содержащего список интерфейсов, поддерживаемых объектом.

   > [!NOTE]
   > Если вы создаете проект с помощью атрибутов или указываете на этой странице мастера, что элемент управления использует атрибуты, этот параметр изменить нельзя, так как ATL не включает атрибут **coclass** .

- **Интерфейс**

   Задает имя интерфейса для объекта. По умолчанию в начале имени интерфейса добавляется префикс "I".

- **Тип**

   Задает описание объекта, которое отобразится в реестре.

- **ProgID:**

   Задает имя, которое можно использовать для контейнеров вместо CLSID объекта. Это поле не заполняется автоматически. Если не заполнить это поле вручную, элемент управления может быть недоступен для других средств. Например, элементы управления ActiveX, созданные без, недоступны `ProgID` в диалоговом окне « **Вставка элемента управления ActiveX** ». Дополнительные сведения о диалоговом окне см. в разделе [Вставка элементов управления ActiveX](../../windows/adding-editing-or-deleting-controls.md#insert-activex-controls).

## <a name="see-also"></a>См. также раздел

[Элемент управления ATL](../../atl/reference/adding-an-atl-control.md)<br/>
[Добавление функциональных возможностей в составной элемент управления](../../atl/adding-functionality-to-the-composite-control.md)<br/>
[Основы COM-объектов ATL](../../atl/fundamentals-of-atl-com-objects.md)
