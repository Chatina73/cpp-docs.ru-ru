---
title: Мастер элементов управления ATL
ms.date: 11/04/2016
f1_keywords:
- vc.codewiz.class.atl.control.overview
helpviewer_keywords:
- ATL projects, adding controls
- controls [ATL], adding to projects
- ATL Control Wizard
ms.assetid: 991f8e72-ffbc-4382-a4ce-e255acfba5b6
ms.openlocfilehash: 58c3ebe4c2a15aa3f0d59191c37a7f2422a63ab5
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57287911"
---
# <a name="atl-control-wizard"></a>Мастер элементов управления ATL

Операции вставки в проект ATL (или в проект MFC с поддержкой ATL) элемента управления ATL. Этот мастер можно использовать для вставки одного из трех типов элементов управления:

- Стандартный элемент управления

- Составной элемент управления

- Элемент управления DHTML

Кроме того, можно указать минимальный элемент управления, удаляя интерфейсы из [интерфейсы](../../atl/reference/interfaces-atl-control-wizard.md) списка, в котором приведены в качестве значения по умолчанию для элементов управления открыть в большинстве контейнеры. Можно задать интерфейсы, которые нужно поддерживать для элемента управления в **интерфейсы** странице мастера.

## <a name="remarks"></a>Примечания

Скрипт регистрации, созданных с помощью этого мастера зарегистрирует его COM-компонентов в разделе HKEY_CURRENT_USER вместо HKEY_LOCAL_MACHINE. Чтобы изменить это поведение, задайте **Регистрация компонентов для всех пользователей** в мастере ATL параметр.

## <a name="names"></a>Имена

Укажите имена для объектов, интерфейс и классы для добавления в проект. За исключением **короткое имя**, все другие поля, которые могут изменяться независимо друг от друга. Если при изменении текста для **короткое имя**, это изменение отражается в имена всех других полей на этой странице. При изменении **Coclass** имя раздела COM, изменение отражается в **тип** », вкладка «но **интерфейс** имя и **ProgID** сделать не изменяется. Эти принципы именования позволяют легко распознать объекты для вас все имена разработки элементов управления.

> [!NOTE]
>  **Компонентный класс** может только элементы управления без атрибутов. Если атрибуты проекта, невозможно изменить **Coclass**.

### <a name="c"></a>C++

Предоставляет сведения для класса C++, созданного для реализации объекта.

- **Короткое имя**

   Задает сокращенное имя для объекта. Указываемое имя определяет класс, и **Coclass** имя файла (. CPP и. H) имен, имя интерфейса и **тип** имена, если не изменить значения этих полей по отдельности.

- **Класс**

   Задает имя класса, реализующего объект. Это имя основано на имени, указанному в **короткое имя**, предшествует «C», типичный префикс для имени класса.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанному в **короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. Если выбрать существующий файл, мастер не он сохраняется в выбранном месте пока вы щелкните **Готово**.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанному в **короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **С атрибутами**

   Указывает, использует ли объект атрибуты. Если объект добавляется в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть только помеченных атрибутами объектов можно добавить в проект с поддержкой атрибутов.

   Объект с атрибутами можно добавить только в проект ATL, использующего атрибуты. Если этот флажок для проекта ATL, не поддерживающего атрибуты, мастер предложит указать, следует ли добавить поддержку атрибутов в проект.

   По умолчанию все объекты, добавленные после этого параметра обозначаются как атрибутированные (флажок). Можно снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   См. в разделе [параметры приложения, мастер проектов ATL](../../atl/reference/application-settings-atl-project-wizard.md) и [основные механизмы атрибуты](../../windows/basic-mechanics-of-attributes.md) Дополнительные сведения.

### <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях COM для объекта.

- **Компонентный класс**

   Задает имя класса компонентов, содержащий список интерфейсов, поддерживаемых этим объектом.

   > [!NOTE]
   > Если вы создаете проект, использующий атрибуты, или если на этой странице мастера указывается, что элемент управления использует атрибуты, не может изменить этот параметр, поскольку ATL не включает **coclass** атрибута.

- **Interface**

   Задает имя интерфейса для объекта. По умолчанию имя интерфейса добавляется префикс «I».

- **Type**

   Задает описание объекта, которое будет отображаться в реестре

- **Идентификатор progID**

   Задает имя, контейнеры можно использовать вместо CLSID объекта. Это поле не заполняется автоматически. Если это поле не заполняется вручную, элемент управления не может быть недоступен для других средств. Например, элементы управления ActiveX, которые создаются без `ProgID` недоступны в **Вставка элемента ActiveX** диалоговое окно. Дополнительные сведения об этом диалоговом окне см. в разделе [Диалоговое окно "Вставка элемента управления ActiveX"](../../windows/insert-activex-control-dialog-box.md).

## <a name="see-also"></a>См. также

[Элемент управления ATL](../../atl/reference/adding-an-atl-control.md)<br/>
[Добавление функциональных возможностей в составной элемент управления](../../atl/adding-functionality-to-the-composite-control.md)<br/>
[Основы COM-объектов ATL](../../atl/fundamentals-of-atl-com-objects.md)
