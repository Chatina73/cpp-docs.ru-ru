---
title: Класс Ксекуритидеск
ms.date: 11/04/2016
f1_keywords:
- CSecurityDesc
- ATLSECURITY/ATL::CSecurityDesc
- ATLSECURITY/ATL::CSecurityDesc::CSecurityDesc
- ATLSECURITY/ATL::CSecurityDesc::FromString
- ATLSECURITY/ATL::CSecurityDesc::GetControl
- ATLSECURITY/ATL::CSecurityDesc::GetDacl
- ATLSECURITY/ATL::CSecurityDesc::GetGroup
- ATLSECURITY/ATL::CSecurityDesc::GetOwner
- ATLSECURITY/ATL::CSecurityDesc::GetPSECURITY_DESCRIPTOR
- ATLSECURITY/ATL::CSecurityDesc::GetSacl
- ATLSECURITY/ATL::CSecurityDesc::IsDaclAutoInherited
- ATLSECURITY/ATL::CSecurityDesc::IsDaclDefaulted
- ATLSECURITY/ATL::CSecurityDesc::IsDaclPresent
- ATLSECURITY/ATL::CSecurityDesc::IsDaclProtected
- ATLSECURITY/ATL::CSecurityDesc::IsGroupDefaulted
- ATLSECURITY/ATL::CSecurityDesc::IsOwnerDefaulted
- ATLSECURITY/ATL::CSecurityDesc::IsSaclAutoInherited
- ATLSECURITY/ATL::CSecurityDesc::IsSaclDefaulted
- ATLSECURITY/ATL::CSecurityDesc::IsSaclPresent
- ATLSECURITY/ATL::CSecurityDesc::IsSaclProtected
- ATLSECURITY/ATL::CSecurityDesc::IsSelfRelative
- ATLSECURITY/ATL::CSecurityDesc::MakeAbsolute
- ATLSECURITY/ATL::CSecurityDesc::MakeSelfRelative
- ATLSECURITY/ATL::CSecurityDesc::SetControl
- ATLSECURITY/ATL::CSecurityDesc::SetDacl
- ATLSECURITY/ATL::CSecurityDesc::SetGroup
- ATLSECURITY/ATL::CSecurityDesc::SetOwner
- ATLSECURITY/ATL::CSecurityDesc::SetSacl
- ATLSECURITY/ATL::CSecurityDesc::ToString
helpviewer_keywords:
- CSecurityDesc class
ms.assetid: 3767a327-378f-4690-ba40-4d9f6a1f5ee4
ms.openlocfilehash: 90f8cfd66fbab88bfa29c39ff27189f02447a7c7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69496493"
---
# <a name="csecuritydesc-class"></a>Класс Ксекуритидеск

Этот класс является оболочкой для `SECURITY_DESCRIPTOR` структуры.

> [!IMPORTANT]
>  Этот класс и его члены не могут использоваться в приложениях, выполняемых в среда выполнения Windows.

## <a name="syntax"></a>Синтаксис

```
class CSecurityDesc
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Ксекуритидеск:: Ксекуритидеск](#csecuritydesc)|Конструктор.|
|[Ксекуритидеск:: ~ Ксекуритидеск](#dtor)|Деструктор|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Ксекуритидеск:: Фромстринг](#fromstring)|Преобразует дескриптор безопасности строкового формата в допустимый функциональный дескриптор безопасности.|
|[CSecurityDesc::GetControl](#getcontrol)|Извлекает управляющие данные из дескриптора безопасности.|
|[CSecurityDesc::GetDacl](#getdacl)|Получает сведения о избирательном списке управления доступом (DACL) из дескриптора безопасности.|
|[CSecurityDesc::GetGroup](#getgroup)|Извлекает сведения о первичной группе из дескриптора безопасности.|
|[CSecurityDesc::GetOwner](#getowner)|Получает информатон владельца из дескриптора безопасности.|
|[Ксекуритидеск:: GetPSECURITY_DESCRIPTOR](#getpsecurity_descriptor)|Возвращает указатель на `SECURITY_DESCRIPTOR` структуру.|
|[CSecurityDesc::GetSacl](#getsacl)|Возвращает из дескриптора безопасности сведения о списке управления доступом к системе (SACL).|
|[Ксекуритидеск:: Исдаклаутоинхеритед](#isdaclautoinherited)|Определяет, настроен ли список DACL для поддержки автоматического распространения.|
|[CSecurityDesc::IsDaclDefaulted](#isdacldefaulted)|Определяет, настроен ли дескриптор безопасности с DACL по умолчанию.|
|[Ксекуритидеск:: Исдаклпресент](#isdaclpresent)|Определяет, содержит ли дескриптор безопасности список DACL.|
|[Ксекуритидеск:: Исдаклпротектед](#isdaclprotected)|Определяет, настроен ли список DACL для предотвращения изменений.|
|[Ксекуритидеск:: Исграупдефаултед](#isgroupdefaulted)|Определяет, был ли задан идентификатор безопасности группы дескриптора безопасности (SID) по умолчанию.|
|[Ксекуритидеск:: Исовнердефаултед](#isownerdefaulted)|Определяет, был ли по умолчанию задан идентификатор безопасности владельца дескриптора безопасности.|
|[Ксекуритидеск:: Иссаклаутоинхеритед](#issaclautoinherited)|Определяет, настроена ли для списка SACL поддержка автоматического распространения.|
|[Ксекуритидеск:: Иссаклдефаултед](#issacldefaulted)|Определяет, настроен ли дескриптор безопасности с SACL по умолчанию.|
|[Ксекуритидеск:: Иссаклпресент](#issaclpresent)|Определяет, содержит ли дескриптор безопасности список SACL.|
|[Ксекуритидеск:: Иссаклпротектед](#issaclprotected)|Определяет, настроен ли список SACL для предотвращения изменений.|
|[CSecurityDesc::IsSelfRelative](#isselfrelative)|Определяет, имеет ли дескриптор безопасности сам относительный формат.|
|[CSecurityDesc::MakeAbsolute](#makeabsolute)|Вызовите этот метод, чтобы преобразовать дескриптор безопасности в абсолютный формат.|
|[CSecurityDesc::MakeSelfRelative](#makeselfrelative)|Вызовите этот метод, чтобы преобразовать дескриптор безопасности в относительный формат.|
|[CSecurityDesc::SetControl](#setcontrol)|Устанавливает управляющие биты дескриптора безопасности.|
|[CSecurityDesc::SetDacl](#setdacl)|Задает сведения в списке DACL. Если список DACL уже существует в дескрипторе безопасности, он заменяется.|
|[CSecurityDesc::SetGroup](#setgroup)|Задает сведения о основной группе дескриптора безопасности абсолютного формата, заменяя уже имеющиеся сведения о основной группе.|
|[CSecurityDesc::SetOwner](#setowner)|Задает сведения о владельце дескриптора безопасности абсолютного формата, заменяя уже имеющиеся сведения о владельце.|
|[CSecurityDesc::SetSacl](#setsacl)|Задает сведения в списке SACL. Если SACL уже имеется в дескрипторе безопасности, он заменяется.|
|[Ксекуритидеск:: ToString](#tostring)|Преобразует дескриптор безопасности в строковый формат.|

### <a name="public-operators"></a>Открытые операторы

|name|Описание|
|----------|-----------------|
|[Ксекуритидеск:: operator const SECURITY_DESCRIPTOR *](#operator_const_security_descriptor__star)|Возвращает указатель на `SECURITY_DESCRIPTOR` структуру.|
|[Ксекуритидеск:: operator =](#operator_eq)|Оператор присвоения.|

## <a name="remarks"></a>Примечания

`SECURITY_DESCRIPTOR` Структура содержит сведения о безопасности, связанные с объектом. Приложения используют эту структуру для задания и запроса состояния безопасности объекта. См. также [атлжетсекуритидескриптор](security-global-functions.md#atlgetsecuritydescriptor).

Приложения не должны изменять `SECURITY_DESCRIPTOR` структуру напрямую, а вместо этого должны использовать предоставленные методы класса.

Общие сведения о модели управления доступом в Windows см. в разделе [Управление доступом](/windows/win32/SecAuthZ/access-control) в Windows SDK.

## <a name="requirements"></a>Требования

**Заголовок:** атлсекурити. h

##  <a name="csecuritydesc"></a>Ксекуритидеск:: Ксекуритидеск

Конструктор.

```
CSecurityDesc() throw();
CSecurityDesc(const CSecurityDesc& rhs) throw(... );
CSecurityDesc(const SECURITY_DESCRIPTOR& rhs) throw(...);
```

### <a name="parameters"></a>Параметры

*rhs*<br/>
Объект или `SECURITY_DESCRIPTOR` структура, которые необходимо назначить новому `CSecurityDesc` объекту. `CSecurityDesc`

### <a name="remarks"></a>Примечания

При необходимости `SECURITY_DESCRIPTOR` объект можно создать с помощью структуры или ранее определенного `CSecurityDesc` объекта. `CSecurityDesc`

##  <a name="dtor"></a>Ксекуритидеск:: ~ Ксекуритидеск

Деструктор

```
virtual ~CSecurityDesc() throw();
```

### <a name="remarks"></a>Примечания

Деструктор освобождает все выделенные ресурсы.

##  <a name="fromstring"></a>Ксекуритидеск:: Фромстринг

Преобразует дескриптор безопасности строкового формата в допустимый функциональный дескриптор безопасности.

```
bool FromString(LPCTSTR pstr) throw(...);
```

### <a name="parameters"></a>Параметры

*пстр*<br/>
Указатель на строку, завершающуюся нулем, которая содержит [дескриптор безопасности строкового формата](/windows/win32/SecAuthZ/security-descriptor-string-format) для преобразования.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true в случае успешного выполнения. Создает исключение при сбое.

### <a name="remarks"></a>Примечания

Строку можно создать с помощью [ксекуритидеск:: ToString](#tostring). Преобразование дескриптора безопасности в строку упрощает хранение и передачу.

Этот метод вызывает [конвертстрингсекуритидескриптортосекуритидескриптор](/windows/win32/api/sddl/nf-sddl-convertstringsecuritydescriptortosecuritydescriptorw).

##  <a name="getcontrol"></a>  CSecurityDesc::GetControl

Извлекает управляющие данные из дескриптора безопасности.

```
bool GetControl(SECURITY_DESCRIPTOR_CONTROL* psdc) const throw();
```

### <a name="parameters"></a>Параметры

*psdc*<br/>
Указатель на `SECURITY_DESCRIPTOR_CONTROL` структуру, которая получает управляющие данные дескриптора безопасности.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод завершается успешно, в противном случае — значение false.

### <a name="remarks"></a>Примечания

Этот метод вызывает [жетсекуритидескрипторконтрол](/windows/win32/api/securitybaseapi/nf-securitybaseapi-getsecuritydescriptorcontrol).

##  <a name="getdacl"></a>  CSecurityDesc::GetDacl

Получает сведения о избирательном списке управления доступом (DACL) из дескриптора безопасности.

```
bool GetDacl(
    CDacl* pDacl,
    bool* pbPresent = NULL,
    bool* pbDefaulted = NULL) const throw(...);
```

### <a name="parameters"></a>Параметры

*пдакл*<br/>
Указатель на `CDacl` структуру, в которой сохраняется копия списка DACL дескриптора безопасности. Если существует собственный список управления доступом, метод задает *пдакл* в качестве адреса списка управления доступом для дескриптора безопасности. Если список управления доступом на уровне пользователей не существует, значение не сохраняется.

*пбпресент*<br/>
Указатель на значение, указывающее на присутствие списка управления доступом на уровне пользователей в указанном дескрипторе безопасности. Если дескриптор безопасности содержит список управления доступом на уровне пользователей, этот параметр имеет значение true. Если дескриптор безопасности не содержит список управления доступом на уровне пользователей, этот параметр имеет значение false.

*пбдефаултед*<br/>
Указатель на флаг, заданный в качестве значения флага SE_DACL_DEFAULTED в `SECURITY_DESCRIPTOR_CONTROL` структуре, если для дескриптора безопасности существует список управления доступом на уровне пользователей. Если этот флаг имеет значение true, то этот список ACL был извлечен механизмом по умолчанию; Если задано значение false, список управления доступом на уровне пользователей явно указан пользователем.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод завершается успешно, в противном случае — значение false.

##  <a name="getgroup"></a>  CSecurityDesc::GetGroup

Извлекает сведения о первичной группе из дескриптора безопасности.

```
bool GetGroup(
    CSid* pSid,
    bool* pbDefaulted = NULL) const throw(...);
```

### <a name="parameters"></a>Параметры

*Пустой pSid*<br/>
Указатель на код [CSid](../../atl/reference/csid-class.md) (идентификатор безопасности), который получает копию группы, хранящейся в кдакл.

*пбдефаултед*<br/>
Указатель на флаг, заданный в качестве значения флага SE_GROUP_DEFAULTED в `SECURITY_DESCRIPTOR_CONTROL` структуре, когда метод возвращает значение.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод завершается успешно, в противном случае — значение false.

##  <a name="getowner"></a>  CSecurityDesc::GetOwner

Получает информатон владельца из дескриптора безопасности.

```
bool GetOwner(
    CSid* pSid,
    bool* pbDefaulted = NULL) const throw(...);
```

### <a name="parameters"></a>Параметры

*Пустой pSid*<br/>
Указатель на код [CSid](../../atl/reference/csid-class.md) (идентификатор безопасности), который получает копию группы, хранящейся в кдакл.

*пбдефаултед*<br/>
Указатель на флаг, заданный в качестве значения флага SE_OWNER_DEFAULTED в `SECURITY_DESCRIPTOR_CONTROL` структуре, когда метод возвращает значение.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод завершается успешно, в противном случае — значение false.

##  <a name="getpsecurity_descriptor"></a>Ксекуритидеск:: GetPSECURITY_DESCRIPTOR

Возвращает указатель на `SECURITY_DESCRIPTOR` структуру.

```
const SECURITY_DESCRIPTOR* GetPSECURITY_DESCRIPTOR() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает указатель на структуру [SECURITY_DESCRIPTOR](/windows/win32/api/winnt/ns-winnt-security_descriptor) .

##  <a name="getsacl"></a>  CSecurityDesc::GetSacl

Возвращает из дескриптора безопасности сведения о списке управления доступом к системе (SACL).

```
bool GetSacl(
    CSacl* pSacl,
    bool* pbPresent = NULL,
    bool* pbDefaulted = NULL) const throw(...);
```

### <a name="parameters"></a>Параметры

*псакл*<br/>
Указатель на `CSacl` структуру, в которой сохраняется копия списка SACL дескриптора безопасности. Если список ACL системы существует, метод задает *псакл* в качестве адреса ACL системного списка дескриптора безопасности. Если системный список управления доступом не существует, значение не сохраняется.

*пбпресент*<br/>
Указатель на флаг, который набор методов указывает на наличие списка ACL системы в указанном дескрипторе безопасности. Если дескриптор безопасности содержит системный список управления доступом, этот параметр имеет значение true. Если дескриптор безопасности не содержит ACL системы, этот параметр имеет значение false.

*пбдефаултед*<br/>
Указатель на флаг, заданный в качестве значения флага SE_SACL_DEFAULTED в структуре `SECURITY_DESCRIPTOR_CONTROL` , если для дескриптора безопасности существует список ACL системы.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод завершается успешно, в противном случае — значение false.

##  <a name="isdaclautoinherited"></a>Ксекуритидеск:: Исдаклаутоинхеритед

Определяет, настроен ли избирательный список управления доступом (DACL) для поддержки автоматического распространения.

```
bool IsDaclAutoInherited() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит DACL, настроенный для поддержки автоматического распространения наследуемых записей управления доступом (ACE) на существующие дочерние объекты. В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Система устанавливает этот бит при выполнении алгоритма автоматического наследования для объекта и его существующих дочерних объектов.

##  <a name="isdacldefaulted"></a>Ксекуритидеск:: Исдаклдефаултед

Определяет, настроен ли дескриптор безопасности с избирательным списком управления доступом (DACL) по умолчанию.

```
bool IsDaclDefaulted() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит DACL по умолчанию, и false в противном случае.

### <a name="remarks"></a>Примечания

Этот флаг может повлиять на то, как система рассматривает список DACL с учетом наследования элемента управления доступом (ACE). Например, если создатель объекта не указывает DACL, объект получает DACL по умолчанию от маркера доступа создателя. Система пропускает этот флаг, если не установлен флаг SE_DACL_PRESENT.

Этот флаг используется для определения того, как окончательный список DACL объекта должен быть вычислен и не хранится физически в элементе управления дескриптора безопасности защищаемого объекта.

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетдакл](#setdacl) .

##  <a name="isdaclpresent"></a>Ксекуритидеск:: Исдаклпресент

Определяет, содержит ли дескриптор безопасности список управления доступом на уровне пользователей (DACL).

```
bool IsDaclPresent() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит список DACL, и false в противном случае.

### <a name="remarks"></a>Примечания

Если этот флаг не установлен или этот флаг установлен и список DACL имеет значение NULL, дескриптор безопасности разрешает полный доступ для всех.

Этот флаг используется для хранения сведений о безопасности, заданных вызывающим объектом, до тех пор, пока дескриптор безопасности не будет связан с защищаемым объектом. После того как дескриптор безопасности связан с защищаемым объектом, флаг SE_DACL_PRESENT всегда задается в элементе управления дескриптора безопасности.

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетдакл](#setdacl) .

##  <a name="isdaclprotected"></a>Ксекуритидеск:: Исдаклпротектед

Определяет, настроен ли избирательный список управления доступом (DACL) для предотвращения изменений.

```
bool IsDaclProtected() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если список DACL настроен для предотвращения изменения дескриптора безопасности наследуемыми записями управления доступом (ACE). В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетдакл](#setdacl) .

Этот метод поддерживает автоматическое распространение наследуемых ACE.

##  <a name="isgroupdefaulted"></a>Ксекуритидеск:: Исграупдефаултед

Определяет, был ли задан идентификатор безопасности группы дескриптора безопасности (SID) по умолчанию.

```
bool IsGroupDefaulted() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если механизм по умолчанию, а не исходный поставщик дескриптора безопасности, предоставил идентификатор безопасности группы дескриптора безопасности. В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетграуп](#setgroup) .

##  <a name="isownerdefaulted"></a>Ксекуритидеск:: Исовнердефаултед

Определяет, задан ли идентификатор безопасности владельца дескриптора безопасности (SID) по умолчанию.

```
bool IsOwnerDefaulted() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если механизм по умолчанию, а не исходный поставщик дескриптора безопасности, предоставил идентификатор безопасности владельца дескриптора безопасности. В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетовнер](#setowner) .

##  <a name="issaclautoinherited"></a>Ксекуритидеск:: Иссаклаутоинхеритед

Определяет, настроен ли системный список управления доступом (SACL) для поддержки автоматического распространения.

```
bool IsSaclAutoInherited() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит список SACL, настроенный для поддержки автоматического распространения наследуемых записей управления доступом (ACE) на существующие дочерние объекты. В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Система устанавливает этот бит при выполнении алгоритма автоматического наследования для объекта и его существующих дочерних объектов.

##  <a name="issacldefaulted"></a>Ксекуритидеск:: Иссаклдефаултед

Определяет, настроен ли дескриптор безопасности с системным списком управления доступом (SACL) по умолчанию.

```
bool IsSaclDefaulted() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит SACL по умолчанию, и false в противном случае.

### <a name="remarks"></a>Примечания

Этот флаг может повлиять на то, как система рассматривает список SACL, по отношению к наследованию элемента управления доступом (ACE). Система пропускает этот флаг, если не установлен флаг SE_SACL_PRESENT.

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетсакл](#setsacl) .

##  <a name="issaclpresent"></a>Ксекуритидеск:: Иссаклпресент

Определяет, содержит ли дескриптор безопасности список системного управления доступом (SACL).

```
bool IsSaclPresent() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности содержит список SACL, и false в противном случае.

### <a name="remarks"></a>Примечания

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетсакл](#setsacl) .

##  <a name="issaclprotected"></a>Ксекуритидеск:: Иссаклпротектед

Определяет, настроен ли системный список управления доступом (SACL) для предотвращения изменений.

```
bool IsSaclProtected() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если список SACL настроен для предотвращения изменения дескриптора безопасности наследуемыми записями управления доступом (ACE). В противном случае возвращает FALSE.

### <a name="remarks"></a>Примечания

Чтобы установить этот флаг, используйте метод [ксекуритидеск:: сетсакл](#setsacl) .

Этот метод поддерживает автоматическое распространение наследуемых ACE.

##  <a name="isselfrelative"></a>  CSecurityDesc::IsSelfRelative

Определяет, имеет ли дескриптор безопасности сам относительный формат.

```
bool IsSelfRelative() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если дескриптор безопасности имеет относительный формат со всеми сведениями о безопасности в непрерывном блоке памяти. Возвращает значение false, если дескриптор безопасности имеет абсолютный формат. Дополнительные сведения см. в разделе [абсолютные и самостоятельные дескрипторы безопасности](/windows/win32/SecAuthZ/absolute-and-self-relative-security-descriptors).

##  <a name="makeabsolute"></a>Ксекуритидеск:: Макеабсолуте

Вызовите этот метод, чтобы преобразовать дескриптор безопасности в абсолютный формат.

```
bool MakeAbsolute() throw(...);
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод выполняется, и false в противном случае.

### <a name="remarks"></a>Примечания

Дескриптор безопасности в абсолютном формате содержит указатели на содержащиеся в нем сведения, а не на саму информацию. Дескриптор безопасности в автономном формате содержит сведения в непрерывном блоке памяти. В самоотносительном дескрипторе `SECURITY_DESCRIPTOR` безопасности структура всегда запускает сведения, но другие компоненты дескриптора безопасности могут следовать структуре в любом порядке. Вместо использования адресов памяти компоненты самоотносительного дескриптора безопасности идентифицируются по смещению от начала дескриптора безопасности. Этот формат полезен, если дескриптор безопасности должен быть сохранен на диске или передан с помощью протокола связи. Дополнительные сведения см. в разделе [абсолютные и самостоятельные дескрипторы безопасности](/windows/win32/SecAuthZ/absolute-and-self-relative-security-descriptors).

##  <a name="makeselfrelative"></a>  CSecurityDesc::MakeSelfRelative

Вызовите этот метод, чтобы преобразовать дескриптор безопасности в относительный формат.

```
bool MakeSelfRelative() throw(...);
```

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если метод выполняется, и false в противном случае.

### <a name="remarks"></a>Примечания

Дескриптор безопасности в абсолютном формате содержит указатели на сведения, содержащиеся в нем, а не на саму информацию. Дескриптор безопасности в автономном формате содержит сведения в непрерывном блоке памяти. В самоотносительном дескрипторе `SECURITY_DESCRIPTOR` безопасности структура всегда запускает сведения, но другие компоненты дескриптора безопасности могут следовать структуре в любом порядке. Вместо использования адресов памяти компоненты дескриптора безопасности идентифицируются по смещению от начала дескриптора безопасности. Этот формат полезен, если дескриптор безопасности должен быть сохранен на диске или передан с помощью протокола связи. Дополнительные сведения см. в разделе [абсолютные и самостоятельные дескрипторы безопасности](/windows/win32/SecAuthZ/absolute-and-self-relative-security-descriptors).

##  <a name="operator_eq"></a>Ксекуритидеск:: operator =

Оператор присвоения.

```
CSecurityDesc& operator= (const SECURITY_DESCRIPTOR& rhs) throw(...);
CSecurityDesc& operator= (const CSecurityDesc& rhs) throw(...);
```

### <a name="parameters"></a>Параметры

*rhs*<br/>
`SECURITY_DESCRIPTOR` Структура или `CSecurityDesc` объект`CSecurityDesc` для назначения объекту.

### <a name="return-value"></a>Возвращаемое значение

Возвращает обновленный `CSecurityDesc` объект.

##  <a name="operator_const_security_descriptor__star"></a>Ксекуритидеск:: operator const SECURITY_DESCRIPTOR *

Приводит значение к указателю на `SECURITY_DESCRIPTOR` структуру.

```
operator const SECURITY_DESCRIPTOR *() const throw();
```

##  <a name="setcontrol"></a>  CSecurityDesc::SetControl

Устанавливает управляющие биты дескриптора безопасности.

```
bool SetControl(
    SECURITY_DESCRIPTOR_CONTROL ControlBitsOfInterest,
    SECURITY_DESCRIPTOR_CONTROL ControlBitsToSet) throw();
```

### <a name="parameters"></a>Параметры

*контролбитсофинтерест*<br/>
Маска SECURITY_DESCRIPTOR_CONTROL, указывающая устанавливаемые биты элемента управления. Список флагов, которые можно задать, см. в разделе [сетсекуритидескрипторконтрол](/windows/win32/api/securitybaseapi/nf-securitybaseapi-setsecuritydescriptorcontrol).

*контролбитстосет*<br/>
Маска SECURITY_DESCRIPTOR_CONTROL, которая указывает новые значения для битов элемента управления, заданных маской *контролбитсофинтерест* . Этот параметр может быть сочетанием флагов, перечисленных для параметра *контролбитсофинтерест* .

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

### <a name="remarks"></a>Примечания

Этот метод вызывает [сетсекуритидескрипторконтрол](/windows/win32/api/securitybaseapi/nf-securitybaseapi-setsecuritydescriptorcontrol).

##  <a name="setdacl"></a>  CSecurityDesc::SetDacl

Задает сведения в избирательном списке управления доступом (DACL). Если список DACL уже существует в дескрипторе безопасности, он заменяется.

```
inline void SetDacl(
    bool bPresent = true,
    bool bDefaulted = false) throw(...);

inline void SetDacl(
    const CDacl& Dacl,
    bool bDefaulted = false) throw(...);
```

### <a name="parameters"></a>Параметры

*Dacl*<br/>
Ссылка на `CDacl` объект, указывающий DACL для дескриптора безопасности. Этот параметр не может иметь значение NULL. Чтобы задать пустой список DACL в дескрипторе безопасности, необходимо использовать первую форму метода с параметром *бпресент* , имеющим значение false.

*бпресент*<br/>
Указывает флаг, указывающий на присутствие списка DACL в дескрипторе безопасности. Если этот параметр имеет значение true, метод устанавливает флаг SE_DACL_PRESENT в `SECURITY_DESCRIPTOR_CONTROL` структуре и использует значения в параметрах *DACL* и *бдефаултед* . Если значение равно false, метод очищает флаг SE_DACL_PRESENT, а *бдефаултед* игнорируется.

*бдефаултед*<br/>
Задает флаг, указывающий источник DACL. Если этот флаг имеет значение true, список DACL был извлечен каким-либо механизмом по умолчанию. Если значение равно false, список DACL был явно задан пользователем. Метод сохраняет это значение в флаге `SECURITY_DESCRIPTOR_CONTROL` SE_DACL_DEFAULTED структуры. Если этот параметр не указан, флаг SE_DACL_DEFAULTED снимается.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

### <a name="remarks"></a>Примечания

Между пустым и несуществующим списком DACL существует важное различие. Если список DACL пуст, он не содержит записей управления доступом, и права доступа не были предоставлены явным образом. В результате доступ к объекту неявно запрещается. С другой стороны, если объект не имеет DACL, для него не назначается защита и предоставляется любой запрос на доступ.

##  <a name="setgroup"></a>  CSecurityDesc::SetGroup

Задает сведения о основной группе дескриптора безопасности абсолютного формата, заменяя уже имеющиеся сведения о основной группе.

```
bool SetGroup(const CSid& Sid, bool bDefaulted = false) throw(...);
```

### <a name="parameters"></a>Параметры

*Трансляцию*<br/>
Ссылка на объект [CSid](../../atl/reference/csid-class.md) для новой основной группы дескриптора безопасности. Этот параметр не может иметь значение NULL. Дескриптор безопасности может быть помечен как не имеющий DACL или SACL, но должен иметь группу и владельца, даже если это идентификатор SID NULL (который является встроенным идентификатором SID со специальным значением).

*бдефаултед*<br/>
Указывает, были ли сведения об основной группе получены из механизма по умолчанию. Если это значение равно true, то используется информация по умолчанию, а метод сохраняет это значение как флаг SE_GROUP_DEFAULTED в `SECURITY_DESCRIPTOR_CONTROL` структуре. Если этот параметр равен нулю, флаг SE_GROUP_DEFAULTED снимается.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

##  <a name="setowner"></a>  CSecurityDesc::SetOwner

Задает сведения о владельце для дескриптора безопасности абсолютного формата. Он заменяет уже имеющиеся сведения о владельце.

```
bool SetOwner(const CSid& Sid, bool bDefaulted = false) throw(...);
```

### <a name="parameters"></a>Параметры

*Трансляцию*<br/>
Объект [CSid](../../atl/reference/csid-class.md) для нового основного владельца дескриптора безопасности. Этот параметр не может иметь значение NULL.

*бдефаултед*<br/>
Указывает, являются ли сведения о владельце производными от механизма по умолчанию. Если это значение равно true, то это сведения по умолчанию. Метод сохраняет это значение в качестве флага SE_OWNER_DEFAULTED в `SECURITY_DESCRIPTOR_CONTROL` структуре. Если этот параметр равен нулю, флаг SE_OWNER_DEFAULTED снимается.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

##  <a name="setsacl"></a>  CSecurityDesc::SetSacl

Задает сведения в системном списке управления доступом (SACL). Если SACL уже имеется в дескрипторе безопасности, он заменяется.

```
bool SetSacl(const CSacl& Sacl, bool bDefaulted = false) throw(...);
```

### <a name="parameters"></a>Параметры

*Системный*<br/>
Указатель на `CSacl` объект, указывающий список SACL для дескриптора безопасности. Этот параметр не может иметь значение NULL и должен быть объектом Ксакл. В отличие от списков DACL, различия между NULL и пустым списком SACL отсутствуют, так как объекты SACL не определяют права доступа, только данные аудита.

*бдефаултед*<br/>
Задает флаг, указывающий источник списка SACL. Если этот флаг имеет значение true, список SACL был извлечен каким-либо механизмом по умолчанию. Если значение равно false, список SACL был явно задан пользователем. Метод сохраняет это значение в флаге `SECURITY_DESCRIPTOR_CONTROL` SE_SACL_DEFAULTED структуры. Если этот параметр не указан, флаг SE_SACL_DEFAULTED снимается.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

##  <a name="tostring"></a>Ксекуритидеск:: ToString

Преобразует дескриптор безопасности в строковый формат.

```
bool ToString(
    CString* pstr, SECURITY_INFORMATION si = OWNER_SECURITY_INFORMATION |
    GROUP_SECURITY_INFORMATION | DACL_SECURITY_INFORMATION |
    SACL_SECURITY_INFORMATION) const throw(...);
```

### <a name="parameters"></a>Параметры

*пстр*<br/>
Указатель на строку, завершающуюся нулем, которая будет принимать [дескриптор безопасности строкового формата](/windows/win32/SecAuthZ/security-descriptor-string-format).

*Си*<br/>
Задает сочетание битовых флагов SECURITY_INFORMATION для указания компонентов дескриптора безопасности, включаемых в выходную строку.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение true, если операция выполнена успешно; в противном случае — значение false.

### <a name="remarks"></a>Примечания

После того как дескриптор безопасности находится в строковом формате, его можно легко сохранить или передать. `CSecurityDesc::FromString` Используйте метод, чтобы преобразовать строку обратно в дескриптор безопасности.

Параметр *Si* может содержать следующие флаги SECURITY_INFORMATION:

|Значение|Значение|
|-----------|-------------|
|OWNER_SECURITY_INFORMATION|Включите владельца.|
|GROUP_SECURITY_INFORMATION|Включите основную группу.|
|DACL_SECURITY_INFORMATION|Включите список DACL.|
|SACL_SECURITY_INFORMATION|Включите список SACL.|

Если список DACL имеет значение NULL, а контрольный бит SE_DACL_PRESENT задан во входном дескрипторе безопасности, метод завершается ошибкой.

Если список DACL имеет значение NULL и бит управления SE_DACL_PRESENT не задан во входном дескрипторе безопасности, результирующая строка дескриптора безопасности не имеет компонента D:. Дополнительные сведения см. в разделе [Формат строки дескриптора безопасности](/windows/win32/SecAuthZ/security-descriptor-string-format) .

Этот метод вызывает [конвертстрингсекуритидескриптортосекуритидескриптор](/windows/win32/api/sddl/nf-sddl-convertstringsecuritydescriptortosecuritydescriptorw).

## <a name="see-also"></a>См. также

[Пример безопасности](../../overview/visual-cpp-samples.md)<br/>
[SECURITY_DESCRIPTOR](/windows/win32/api/winnt/ns-winnt-security_descriptor)<br/>
[Обзор класса](../../atl/atl-class-overview.md)<br/>
[Глобальные функции безопасности](../../atl/reference/security-global-functions.md)
