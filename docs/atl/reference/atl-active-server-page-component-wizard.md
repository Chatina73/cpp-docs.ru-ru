---
title: Мастер ASP-компонента ATL
ms.date: 05/09/2019
helpviewer_keywords:
- ASP components, creating in ATL
ms.assetid: 5a5cb904-dbbf-44ea-ad3d-2ddd14c1d3c5
ms.openlocfilehash: d2f47176fb25b050e4b1f72053e4cbaaf89f569e
ms.sourcegitcommit: 00e26915924869cd7eb3c971a7d0604388abd316
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2019
ms.locfileid: "65524592"
---
# <a name="atl-active-server-page-component-wizard"></a>Мастер ASP-компонента ATL

::: moniker range="vs-2019"

Этот мастер недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="vs-2017"

Этот мастер вставляет в проект компонент Active Server Pages (ASP). Службы Microsoft IIS используют компоненты ASP как часть своей усовершенствованной архитектуры разработки веб-страниц.

Благодаря мастеру вы можете указать модель потоков компонента и его поддержку агрегирования. Вы также можете указать поддержку интерфейса с информацией об ошибках, точках подключения и маршалинге со свободным потоком.

## <a name="remarks"></a>Примечания

Начиная с Visual Studio 2008, сценарий регистрации, созданный этим мастером, регистрирует свои компоненты COM в разделе **HKEY_CURRENT_USER** вместо **HKEY_LOCAL_MACHINE**. Чтобы изменить это, задайте в мастере ATL параметр **Register component for all users** (Регистрация компонентов для всех пользователей).

## <a name="names"></a>Имена

Укажите имена объекта, интерфейса и классов, которые необходимо добавить в проект. Все поля, кроме **Короткое имя**, можно редактировать независимо друг от друга. Если вы меняете текст для **короткого имени**, то это отображается в именах остальных полей на странице.

Если в разделе COM вы измените имя **Coclass**, это отразится в полях **Type** и **ProgID**, но имя **Interface** не изменится. Этот принцип именования позволяет вам легко распознавать имена при разработке элементов управления.

### <a name="c"></a>C++

Предоставляет информацию для класса C++, созданного для объекта.

- **Короткое имя**

   Задает корневое имя для объекта. Имя, которое вы указываете, определяет имена `Class` и **Coclass**, **CPP-файла** и **H-файла**, **Interface**, **Type** и **ProgID**, если вы не изменили эти поля по отдельности.

- **H-файл**

   Задает имя файла заголовка для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении или добавить объявление класса к существующему файлу. При выборе существующего файла мастер не сохраняет его в выбранном расположении, пока вы не нажмете в мастере кнопку **Готово**.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить объявление класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Класс**

   Задает имя создаваемого класса. Это имя основано на имени, указанном в поле **Короткое имя**, с предшествующей "С" — типичным префиксом для имени класса.

- **CPP-файл**

   Задает имя файла реализации для класса нового объекта. По умолчанию это имя основано на имени, указанном в поле **Короткое имя**. Нажмите кнопку с многоточием, чтобы сохранить имя файла в выбранном расположении. Файл не сохраняется в выбранном расположении, пока вы не нажмете кнопку **Готово** в мастере.

   Мастер не перезаписывает файл. Если выбрать имя существующего файла, при нажатии кнопки **Готово** мастер предложит указать, нужно ли добавить реализацию класса к содержимому файла. Чтобы добавить данные в файл, нажмите кнопку **Да**; чтобы вернуться в мастер и указать другое имя файла, нажмите кнопку **Нет**.

- **Attributed**

   Указывает, использует ли объект атрибуты. Если вы добавляете объект в проект ATL с атрибутами, этот параметр будет установлен и недоступен для изменения. То есть вы можете добавить только помеченные атрибутами объекты в проект, созданный с поддержкой атрибутов.

   Если выбрать этот параметр для проекта ATL без поддержки атрибутов, мастер предложит указать, нужно ли добавить поддержку атрибутов в проект.

   По умолчанию объекты проектов без атрибутов, которые добавляются после установки этого параметра, определяются как атрибуты (флажок установлен). Вы можете снять этот флажок, чтобы добавить объект, который не использует атрибуты.

   Дополнительные сведения см. в статьях [Application Settings, ATL Project Wizard](../../atl/reference/application-settings-atl-project-wizard.md) (Параметры приложений, мастер проектов ATL) и [C++ Attributes for COM and .NET](../../windows/basic-mechanics-of-attributes.md) (Атрибуты C++ для COM и .NET).

### <a name="com"></a>COM

Предоставляет сведения о функциональных возможностях модели COM для объекта.

- **Coclass**

   Задает имя класса компонентов, который содержит список интерфейсов, поддерживаемых объектом. Если ваш проект или этот объект используют атрибуты, вы не можете изменить этот параметр, потому что ATL не включает в себя атрибут **coclass**.

- **Type**

   Задает описание объекта, которое отобразится в реестре для coclass.

- **Interface**

   Задает интерфейс, созданный вами для объекта. Этот интерфейс содержит настраиваемые методы.

- **ProgID**

   Задает имя, которое можно использовать для контейнеров вместо CLSID объекта.

::: moniker-end

## <a name="see-also"></a>См. также

[ASP-компонент библиотеки ATL](../../atl/reference/adding-an-atl-active-server-page-component.md)
