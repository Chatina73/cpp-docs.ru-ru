---
title: Класс Иенумонстлимпл
ms.date: 11/04/2016
f1_keywords:
- IEnumOnSTLImpl
- ATLCOM/ATL::IEnumOnSTLImpl
- ATLCOM/ATL::IEnumOnSTLImpl::Clone
- ATLCOM/ATL::IEnumOnSTLImpl::Init
- ATLCOM/ATL::IEnumOnSTLImpl::Next
- ATLCOM/ATL::IEnumOnSTLImpl::Reset
- ATLCOM/ATL::IEnumOnSTLImpl::Skip
- ATLCOM/ATL::IEnumOnSTLImpl::m_iter
- ATLCOM/ATL::IEnumOnSTLImpl::m_pcollection
- ATLCOM/ATL::IEnumOnSTLImpl::m_spUnk
helpviewer_keywords:
- IEnumOnSTLImpl class
ms.assetid: 1789e77b-88b8-447d-a490-806b918912ce
ms.openlocfilehash: 7cf777f3ff0d298f224157735a06bf57a2c10cf5
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69495864"
---
# <a name="ienumonstlimpl-class"></a>Класс Иенумонстлимпл

Этот класс определяет интерфейс перечислителя на основе коллекции C++ стандартной библиотеки.

## <a name="syntax"></a>Синтаксис

```
template <class Base,
    const IID* piid, class T, class Copy, class CollType>
class ATL_NO_VTABLE IEnumOnSTLImpl : public Base
```

#### <a name="parameters"></a>Параметры

*Из*<br/>
Перечислитель COM. Пример см. в разделе [иенумстринг](/windows/win32/api/objidl/nn-objidl-ienumstring) .

*пиид*<br/>
Указатель на идентификатор интерфейса интерфейса перечислителя.

*T*<br/>
Тип элемента, предоставляемого интерфейсом перечислителя.

*Copy*.<br/>
[Класс политики копирования](../../atl/atl-copy-policy-classes.md).

*коллтипе*<br/>
Класс C++ контейнера стандартной библиотеки.

## <a name="members"></a>Участники

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Иенумонстлимпл:: Clone](#clone)|Реализация **clone**.|
|[Иенумонстлимпл:: init](#init)|Инициализирует перечислитель.|
|[IEnumOnSTLImpl::Next](#next)|Реализация **Next**.|
|[Иенумонстлимпл:: Reset](#reset)|Реализация метода **Reset**.|
|[Иенумонстлимпл:: Skip](#skip)|Реализация метода **Skip**.|

### <a name="public-data-members"></a>Открытые члены данных

|name|Описание|
|----------|-----------------|
|[Иенумонстлимпл:: m_iter](#m_iter)|Итератор, представляющий текущую точку перечислителя в коллекции.|
|[Иенумонстлимпл:: m_pcollection](#m_pcollection)|Указатель на контейнер C++ стандартной библиотеки, содержащий элементы для перечисления.|
|[Иенумонстлимпл:: m_spUnk](#m_spunk)|`IUnknown` Указатель объекта, который предоставляет коллекцию.|

## <a name="remarks"></a>Примечания

`IEnumOnSTLImpl`предоставляет реализацию для интерфейса перечислителя COM, где перечисляемые элементы хранятся в контейнере, совместимом с библиотекой C++ Standard. Этот класс аналогичен классу [ккоменумимпл](../../atl/reference/ccomenumimpl-class.md) , который предоставляет реализацию для интерфейса перечислителя, основанного на массиве.

> [!NOTE]
>  Дополнительные сведения о дальнейших различиях между `CComEnumImpl` и `IEnumOnSTLImpl`см. в разделе [ккоменумимпл:: init](../../atl/reference/ccomenumimpl-class.md#init) .

Как правило, *не* требуется создавать собственный класс перечислителя, производный от реализации этого интерфейса. Если вы хотите использовать перечислитель, предоставленный библиотекой ATL, C++ на основе контейнера стандартной библиотеки, чаще всего создается экземпляр [ккоменумонстл](../../atl/reference/ccomenumonstl-class.md)или создается класс коллекции, возвращающий перечислитель, производный от [иколлектиононстлимпл ](../../atl/reference/icollectiononstlimpl-class.md).

Однако, если необходимо предоставить пользовательский перечислитель (например, интерфейс, предоставляющий интерфейсы в дополнение к интерфейсу перечислителя), можно создать производный от этого класса. В этом случае, скорее всего, потребуется переопределить метод [clone](#clone) , чтобы обеспечить собственную реализацию.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`Base`

`IEnumOnSTLImpl`

## <a name="requirements"></a>Требования

**Заголовок:** атлком. h

##  <a name="init"></a>Иенумонстлимпл:: init

Инициализирует перечислитель.

```
HRESULT Init(
    IUnknown* pUnkForRelease,
    CollType& collection);
```

### <a name="parameters"></a>Параметры

*пункфоррелеасе*<br/>
окне `IUnknown` Указатель объекта, который должен храниться в активном состоянии в течение времени существования перечислителя. Если такой объект не существует, передается значение NULL.

*коллекция*<br/>
Ссылка на контейнер C++ стандартной библиотеки, содержащий элементы для перечисления.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

### <a name="remarks"></a>Примечания

Если передать `Init` ссылку на коллекцию, содержащуюся в другом объекте, можно использовать параметр *пункфоррелеасе* , чтобы убедиться, что объект и содержащийся в нем коллекцию доступны в течение всего времени, когда он требуется перечислителю.

Этот метод необходимо вызывать перед передачей указателя на интерфейс перечислителя обратно клиентам.

##  <a name="clone"></a>Иенумонстлимпл:: Clone

Этот метод обеспечивает реализацию метода **clone** , создавая объект типа `CComEnumOnSTL`, инициализируя его с той же коллекцией и итератором, который используется текущим объектом, и возвращая интерфейс для только что созданного объекта.

```
STDMETHOD(Clone)(Base** ppEnum);
```

### <a name="parameters"></a>Параметры

*ппенум*<br/>
заполняет Интерфейс перечислителя для вновь созданного объекта, клонированного из текущего перечислителя.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

##  <a name="m_spunk"></a>Иенумонстлимпл:: m_spUnk

`IUnknown` Указатель объекта, который предоставляет коллекцию.

```
CComPtr<IUnknown> m_spUnk;
```

### <a name="remarks"></a>Примечания

Этот смарт-указатель поддерживает ссылку на объект, передаваемый в [иенумонстлимпл:: init](#init), гарантируя, что он остается в активном состоянии в течение времени существования перечислителя.

##  <a name="m_pcollection"></a>Иенумонстлимпл:: m_pcollection

Этот элемент указывает на коллекцию, которая предоставляет данные, управляющие реализацией интерфейса перечислителя.

```
CollType* m_pcollection;
```

### <a name="remarks"></a>Примечания

Этот элемент инициализируется вызовом [иенумонстлимпл:: init](#init).

##  <a name="m_iter"></a>Иенумонстлимпл:: m_iter

Этот элемент содержит итератор, используемый для отметки текущей позицией в коллекции и перехода к следующим элементам.

```
CollType::iterator m_iter;
```

##  <a name="next"></a>Иенумонстлимпл:: Next

Этот метод предоставляет реализацию **следующего** метода.

```
STDMETHOD(Next)(
    ULONG celt,
    T* rgelt,
    ULONG* pceltFetched);
```

### <a name="parameters"></a>Параметры

*celt*<br/>
окне Количество запрошенных элементов.

*rgelt*<br/>
заполняет Массив, в который заполняются элементы.

*пцелтфетчед*<br/>
заполняет Число элементов, фактически возвращаемых в *rgelt*. Это значение может быть меньше, чем значение *celt* , если в списке остается меньше *celt* элементов.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

##  <a name="reset"></a>Иенумонстлимпл:: Reset

Этот метод обеспечивает реализацию метода **Reset** .

```
STDMETHOD(Reset)(void);
```

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

##  <a name="skip"></a>Иенумонстлимпл:: Skip

Этот метод предоставляет реализацию метода **Skip** .

```
STDMETHOD(Skip)(ULONG celt);
```

### <a name="parameters"></a>Параметры

*celt*<br/>
окне Число пропускаемых элементов.

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

## <a name="see-also"></a>См. также

[Обзор класса](../../atl/atl-class-overview.md)
