---
title: Классы коллекций ATL
ms.date: 11/19/2018
helpviewer_keywords:
- DestructElements function
- collection classes, choosing
- ConstructElements function
- SerializeElements function
- traits classes
- collection classes, about collection classes
- CTraits classes
- collection classes
ms.assetid: 4d619d46-5b4e-41dd-b9fd-e86b1fbc00b5
ms.openlocfilehash: 70ca283468a51b4214273698a532ce2a85d52b44
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2019
ms.locfileid: "58774989"
---
# <a name="atl-collection-classes"></a>Классы коллекций ATL

Библиотека ATL предоставляет множество классов для хранения и доступа к данным. Класс, который вы решили использовать зависит от нескольких факторов, включая:

- Объем данных для сохранения

- Эффективность и производительность доступа к данным

- Возможность доступа к данным по индексу или по ключу

- Порядок данных

- Личных предпочтений

## <a name="small-collection-classes"></a>Классы небольших коллекций

Библиотека ATL предоставляет следующие классы для работы с небольшим количеством объектов. Тем не менее эти классы ограниченны и внутренне предназначен для работы с ATL. Не рекомендуется использовать их в своих программах.

|Класс|Тип хранилища данных|
|-----------|--------------------------|
|[CSimpleArray](../atl/reference/csimplearray-class.md)|Реализует класса массива для работы с небольшим количеством объектов.|
|[CSimpleMap](../atl/reference/csimplemap-class.md)|Реализует класс сопоставления для работы с небольшим количеством объектов.|

## <a name="general-purpose-collection-classes"></a>Классы коллекций общего назначения

Следующие классы реализуют массивов, списков и схем, которые приводятся в классы коллекций общего назначения:

|Класс|Тип хранилища данных|
|-----------|--------------------------|
|[CAtlArray](../atl/reference/catlarray-class.md)|Реализует массив.|
|[CAtlList](../atl/reference/catllist-class.md)|Реализует список.|
|[CAtlMap](../atl/reference/catlmap-class.md)|Реализует структуру сопоставление, при котором данные можно ссылаться по ключу или значению.|
|[CRBMap](../atl/reference/crbmap-class.md)|Реализует структуру сопоставления, с помощью алгоритма красно-черного.|
|[CRBMultiMap](../atl/reference/crbmultimap-class.md)|Реализует структуру multimapping красно-черного.|

Эти классы будут отлавливать много ошибок программирования, при использовании в отладочных сборках, но для производительности, эти проверки не выполняются в окончательных сборках.

## <a name="specialized-collection-classes"></a>Классы специализированные коллекции

Для управления указателей памяти и указатели интерфейса также используются более специализированных классов коллекций:

|Класс|Цель|
|-----------|-------------|
|[CAutoPtrArray](../atl/reference/cautoptrarray-class.md)|Предоставляет методы, используемые при создании массива интеллектуальных указателей.|
|[CAutoPtrList](../atl/reference/cautoptrlist-class.md)|Предоставляет методы, используемые при построении списка интеллектуальные указатели.|
|[CComUnkArray](../atl/reference/ccomunkarray-class.md)|Магазины `IUnknown` указатели и предназначен для использования в качестве параметра [IConnectionPointImpl](../atl/reference/iconnectionpointimpl-class.md) класс шаблона.|
|[CHeapPtrList](../atl/reference/cheapptrlist-class.md)|Предоставляет методы, используемые при построении списка указатели кучи.|
|[CInterfaceArray](../atl/reference/cinterfacearray-class.md)|Предоставляет методы, используемые при создании массива указателей COM-интерфейса.|
|[CInterfaceList](../atl/reference/cinterfacelist-class.md)|Предоставляет методы, используемые при построении списка указателей интерфейса СОМ.|

## <a name="choosing-a-collection-class"></a>Выбор класса коллекции

Каждый из классов доступных коллекций предлагает различные характеристики производительности, как показано в следующей таблице.

- В столбцах 2 и 3 описывают каждый класс упорядочения и доступа характеристики. В таблице термин "упорядочивается" означает, что порядок вставки и удаления элементов определяет их порядок в коллекции. Это не значит, что элементы сортируются по своему содержимому. Термин "индексируется" означает, что элементы в коллекции можно получать с помощью целочисленного индекса, как элементы в обычном массиве.

- Столбцы 4 и 5 описывается производительность каждого класса. В приложениях, требующих большого количества вставок в коллекцию, особое значение может иметь скорость вставки, тогда как в других приложениях наиболее важной может оказаться скорость поиска.

- В столбце 6 указывается допустимость повторяющихся элементов в форме.

- Производительность операции класс заданной коллекции выражается в терминах связь между время, необходимое для завершения операции и количество элементов в коллекции. Операция создания определенного времени, линейно увеличивается по мере увеличением числа элементов описан как алгоритм O(n). В отличие от этого операции, используя определенного периода времени, увеличивающий менее и менее, как увеличением числа элементов описан как алгоритм O (log n). Таким образом с точки зрения производительности, алгоритмы O (log n) более эффективны, чем алгоритмы O(n) более как увеличением числа элементов.

### <a name="collection-shape-features"></a>Функции форм коллекции

|Фигура|Упорядоченного|Индексировать|Вставить<br /><br /> элемент|Искать:<br /><br /> Указанный элемент|Дубликат<br /><br /> элементы|
|-----------|--------------|--------------|---------------------------|--------------------------------------|-----------------------------|
|Список|Да|Нет|FAST (постоянное время)|Медленный O(n)|Да|
|Массив|Да|По целому числу (постоянное время)|Медленный O(n), за исключением случаев, если вставка в конце, в какие вариантов константном времени|Медленный O(n)|Да|
|Карта|Нет|По ключу (постоянное время)|FAST (постоянное время)|FAST (постоянное время)|Нет (ключи) Да (значения)|
|Красно черного карты|Да (ключом)|По ключу O (log n)|Быстрый O (log n)|Быстрый O (log n)|Нет|
|Красно черного Multimap|Да (ключом)|По ключу O(log n) (несколько значений каждого ключа)|Быстрый O (log n)|Быстрый O (log n)|Да (несколько значений каждого ключа)|

## <a name="using-ctraits-objects"></a>Использование объектов CTraits

Поскольку классы коллекций ATL можно использовать для хранения широкий спектр определяемые пользователем типы данных, может быть полезно иметь возможность переопределить важные функции, такие как сравнения. Это достигается с помощью ctraits-классы.

Ctraits-классы, аналогично, но более гибкие, чем функций вспомогательный класс для коллекций MFC; см. в разделе [вспомогательные функции классов коллекции](../mfc/reference/collection-class-helpers.md) Дополнительные сведения.

При создании класса коллекции, у вас есть возможность указать класс CTraits. Этот класс будет содержать код, который будет выполнять операции, такие как сравнения при вызове с помощью других методов, которые составляют класс коллекции. Например если объект-список содержит собственные структуры, определяемые пользователем, можно переопределить тест на равенство сравниваемый только определенные переменные-члены. Таким образом метод Find на объекте списка будет работать более удобным образом.

## <a name="example"></a>Пример

### <a name="code"></a>Код

[!code-cpp[NVC_ATL_Utilities#112](../atl/codesnippet/cpp/atl-collection-classes_1.cpp)]

## <a name="comments"></a>Комментарии

Список ctraits-классы, см. в разделе [классы коллекций](../atl/collection-classes.md).

Следующая диаграмма показывает иерархию классов для ctraits-классы.

![Иерархия характеристик классов коллекции](../atl/media/vctraitscollectionclasseshierarchy.gif "иерархия характеристик классов коллекции")

## <a name="collection-classes-samples"></a>Примеры классов коллекции

В следующих примерах демонстрируются классы коллекций:

- [Пример MMXSwarm](../overview/visual-cpp-samples.md)

- [Образец DynamicConsumer](../overview/visual-cpp-samples.md)

- [Образец UpdatePV](https://github.com/Microsoft/VCSamples/tree/master/VC2010Samples/ATL/OLEDB/Provider/UPDATEPV)

- [Пример бегущей строки](../overview/visual-cpp-samples.md)

## <a name="see-also"></a>См. также

[Основные понятия](../atl/active-template-library-atl-concepts.md)<br/>
[Классы коллекций](../atl/collection-classes.md)
