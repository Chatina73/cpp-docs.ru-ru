---
title: Размещение элемента управления на веб-странице (учебник ATL, часть 7)
ms.custom: get-started-article
ms.date: 09/27/2018
ms.assetid: 50dc4c95-c95b-4006-b88a-9826f7bdb222
ms.openlocfilehash: baf0ca56ae7512ac76f64b29e3060e0749c083c1
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57297454"
---
# <a name="putting-the-control-on-a-web-page-atl-tutorial-part-7"></a>Размещение элемента управления на веб-странице (учебник ATL, часть 7)

Элемент управления успешно завершено. Чтобы просмотреть элемент управления работает в реальной ситуации, поместите его на веб-странице. HTML-файл, содержащий элемент управления был создан при определении этого элемента управления. Откройте файл PolyCtl.htm с **обозревателе решений**, и вы увидите элемент управления на веб-странице.

На этом шаге будет расширяют функции управления и сценарии веб-страницы для реагирования на события. Вы также измените элемент управления, позволит узнать, что элемент управления безопасен для скриптов в Internet Explorer.

## <a name="adding-new-functionality"></a>Добавление новых функциональных возможностей

### <a name="to-add-control-features"></a>Чтобы добавить возможности управления

1. Откройте PolyCtl.cpp и замените следующий код:

    ```cpp
    if (PtInRegion(hRgn, xPos, yPos))
        Fire_ClickIn(xPos, yPos);
    else
        Fire_ClickOut(xPos, yPos);
    ```

    на

    ```cpp
    short temp = m_nSides;
    if (PtInRegion(hRgn, xPos, yPos))
    {
        Fire_ClickIn(xPos, yPos);
        put_Sides(++temp);
    }
    else
    {
        Fire_ClickOut(xPos, yPos);
        put_Sides(--temp);
    }
    ```

Фигуры теперь будет добавлять или удалять сторон в зависимости от того, где нажатия.

## <a name="scripting-the-web-page"></a>Сценарии веб-страницы

Элемент управления не выполняет никаких действий результата, поэтому изменение веб-страницы для реагирования на события, которые вы отправляете.

### <a name="to-script-the-web-page"></a>Сценарий веб-страницы

1. Откройте файл PolyCtl.htm и выберите представление HTML. Добавьте следующие строки в HTML-код. Они должны быть добавлены после `</OBJECT>` до `</BODY>`.

    ```html
    <SCRIPT LANGUAGE="VBScript">
    <!--
        Sub PolyCtl_ClickIn(x, y)
            MsgBox("Clicked (" & x & ", " & y & ") - adding side")
        End Sub
        Sub PolyCtl_ClickOut(x, y)
            MsgBox("Clicked (" & x & ", " & y & ") - removing side")
        End Sub
    -->
    </SCRIPT>
    ```

1. Сохраните htm-файл.

Вы добавили некоторый код VBScript, который получает из элемента управления свойство Sides и увеличивает число сторон на единицу, если щелкнуть внутри элемента управления. Если щелкнуть за пределами элемента управления, уменьшить число сторон на единицу.

## <a name="indicating-that-the-control-is-safe-for-scripting"></a>Указывающее, что элемент управления безопасен для скриптов

Можно просмотреть веб-страницы с элементом управления в Internet Explorer или более удобно, используйте представление веб-браузера, встроенное в Visual C++. Чтобы просмотреть свой элемент управления в представление веб-браузера, щелкните правой кнопкой мыши файл PolyCtl.htm и нажмите кнопку **просмотреть в браузере**.

> [!NOTE]
> Если элемент управления не отображается, знаете, что некоторые браузеры требуют корректировки параметров запускать элементы ActiveX. Обратитесь к документации браузера о том, как включить элементы управления ActiveX.

Исходя из текущие параметры безопасности Internet Explorer, может появиться предупреждение безопасности диалоговое окно с предупреждением, элемент управления не может быть небезопасным для скрипта и потенциально способен нанести ущерб. Например, если имеется элемент управления, который отображает файл, но также был `Delete` метод, который удалял файл, было бы безопасно просто просматривать его на странице. Было бы не небезопасно создавать скрипт, тем не менее, так как кто-то может вызвать `Delete` метод.

> [!IMPORTANT]
> Для этого руководства можно изменить параметры безопасности в Internet Explorer, чтобы запускать элементы ActiveX, которые не помечены как безопасные. На панели управления выберите **свойства Интернета** и нажмите кнопку **безопасности** Чтобы изменить соответствующие параметры. После завершения учебника, изменение настроек безопасности обратно в исходное состояние.

Можно программно уведомить Internet Explorer, ее не нужно отображать диалоговое окно предупреждения безопасности для данного элемента управления. Это можно сделать с помощью `IObjectSafety` интерфейс, а ATL предоставляет реализацию этого интерфейса в классе [IObjectSafetyImpl](../atl/reference/iobjectsafetyimpl-class.md). Чтобы добавить интерфейс в элемент управления, добавьте `IObjectSafetyImpl` в список унаследованных классов и добавьте запись для него в сопоставление COM.

### <a name="to-add-iobjectsafetyimpl-to-the-control"></a>Добавление IObjectSafetyImpl в элемент управления

1. Добавьте следующую строку в конец списка наследуемых классов в PolyCtl.h и добавьте запятую в предыдущей строке:

    [!code-cpp[NVC_ATL_Windowing#62](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_1.h)]

1. Добавьте следующую строку в сопоставление COM в PolyCtl.h:

    [!code-cpp[NVC_ATL_Windowing#63](../atl/codesnippet/cpp/putting-the-control-on-a-web-page-atl-tutorial-part-7_2.h)]

## <a name="building-and-testing-the-control"></a>Построение и тестирование элемента управления

Создание элемента управления. После завершения сборки откройте PolyCtl.htm в представлении браузера еще раз. В данном случае веб-страницы должны отображаться непосредственно без **предупреждения безопасности** диалоговое окно. Щелкните внутри многоугольника; число его сторон увеличится на единицу. Щелкните за пределами полигона, чтобы уменьшить число сторон.

[Вернитесь к шагу 6](../atl/adding-a-property-page-atl-tutorial-part-6.md)

## <a name="next-steps"></a>Следующие шаги

Это заключительный шаг учебника ATL. Ссылки на дополнительные сведения об ATL см. в разделе [начальная страница ATL](../atl/active-template-library-atl-concepts.md).

## <a name="see-also"></a>См. также

[Руководство](../atl/active-template-library-atl-tutorial.md)
