---
title: Двойные интерфейсы и события
ms.date: 11/04/2016
helpviewer_keywords:
- events [C++], dual interfaces
- dual interfaces, events
ms.assetid: bb382f7c-e885-4274-bf07-83f3602615d2
ms.openlocfilehash: 4ce5048c25bd55feb0f1eb20fc04ec6bfeead746
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81319607"
---
# <a name="dual-interfaces-and-events"></a>Двойные интерфейсы и события

Хотя можно создать интерфейс события как двойной, Есть ряд веских причин дизайн не делать этого. Основная причина заключается в том, что источник события будет только `Invoke`огонь событие через vtable или через , а не оба. Если источник события запускает событие как прямой вызов `IDispatch` метода vtable, методы никогда не будут использоваться, и ясно, что интерфейс должен был быть чистым интерфейсом vtable. Если источник события запускает событие как `Invoke`вызов, методы vtable никогда не будут использоваться, и ясно, что интерфейс должен был быть dispinterface. Если вы определяете интерфейсы событий как дуалы, вы будете требовать от клиентов реализации части интерфейса, которая никогда не будет использоваться.

> [!NOTE]
> Этот аргумент не распространяется на двойные интерфейсы, в целом. С точки зрения реализации, дуалы — это быстрый, удобный и хорошо поддерживаемый способ реализации интерфейсов, доступных широкому кругу клиентов.

Есть и другие причины, чтобы избежать двойных интерфейсов событий; ни Visual Basic, ни Internet Explorer не поддерживают их.

## <a name="see-also"></a>См. также раздел

[Двойные интерфейсы и ATL](../atl/dual-interfaces-and-atl.md)
