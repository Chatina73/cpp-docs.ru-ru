---
title: TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC
ms.date: 11/04/2016
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
ms.openlocfilehash: d25520c4ffc805701dfe6b51192f8078e2fa300f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365482"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC

> [!NOTE]
> Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

Приложениям, использующим классы баз данных MFC, потребуется программа настройки, которая устанавливает компоненты ODBC. Им также может понадобиться программа администрирования ODBC, которая будет получать информацию об имеющихся драйверах, указывать драйверы по умолчанию и настраивать источники данных. В этой заметке описывается использование API установки ODBC для написания этих программ.

## <a name="writing-an-odbc-setup-program"></a><a name="_mfcnotes_writing_an_odbc_setup_program"></a>Написание программы настройки ODBC

Приложение базы данных MFC требует менеджера драйвера ODBC (ODBC. DLL) и драйверы ODBC, чтобы иметь возможность добраться до источников данных. Многие драйверы ODBC также требуют дополнительной сети и связи DLLs. Большинство водителей ODBC отправляются с программой настройки, которая установит необходимые компоненты ODBC. Разработчики приложений, использующие классы баз данных MFC, могут:

- Опирайтесь на программы настройки для установки компонентов ODBC. Это не потребует дальнейшей работы со стороны разработчика - вы можете просто перераспределить программу установки драйвера.

- Кроме того, вы можете написать собственную программу настройки, которая установит менеджера водителя и водителя.

API установки ODBC может быть использован для записи программ настройки приложения. Функции в API установки выполняются установщиком ODBC DLL - ODBCINST. DLL на 16-битных Windows и ODBCCP32. DLL на Win32. Приложение может `SQLInstallODBC` позвонить в установщик DLL, который установит менеджер драйвера ODBC, драйверы ODBC и любые необходимые переводчики. Затем он записывает установленные драйверы и переводчиков в ODBCINST. Файл INI (или реестр, на NT). `SQLInstallODBC`требует полного пути к ODBC. Файл INF, содержащий список драйверов, которые будут установлены, и описывает файлы, составляющие каждый драйвер. Он также содержит аналогичную информацию о менеджере водителя и переводчиках. Odbc. Файлы INF обычно поставляются разработчиками драйверов.

Программа также может устанавливать отдельные компоненты ODBC. Чтобы установить менеджер драйвера, `SQLInstallDriverManager` программа сначала звонит в установщик DLL, чтобы получить целевой каталог для менеджера драйвера. Обычно это каталог, в котором находятся DLL Windows. Затем программа использует информацию в разделе «Менеджер драйверов ODBC» ODBC. Файл INF для копирования менеджера драйверов и связанных с ним файлов с диска установки в этот каталог. Чтобы установить отдельный драйвер, `SQLInstallDriver` программа сначала вызывает в установщик DLL, чтобы добавить спецификацию драйвера к ODBCINST. Файл INI (или реестр, на NT). `SQLInstallDriver`возвращает целевой каталог драйвера — обычно каталог, в котором находятся DLL Windows. Затем программа использует информацию в разделе драйвера ODBC. Файл INF для копирования драйвера DLL и связанных с ним файлов с диска установки в этот каталог.

Для получения дополнительной информации о ODBC. INF, ODBCINST. INI и с помощью API-установки, см. *Справку программиста* ODBC SDK, глава 19, Установка программного обеспечения ODBC.

## <a name="writing-an-odbc-administrator"></a><a name="_mfcnotes_writing_an_odbc_administrator"></a>Написание администратора ODBC

Приложение базы данных MFC может настроить и настроить источники данных ODBC одним из двух способов:

- Используйте администраторOD (доступен как программа или как элемент панели управления).

- Создайте собственную программу для настройки источников данных.

Программа, настраивая источники данных, делает вызовы функций на DLL-установку. Установщик DLL вызывает установку DLL для настройки источника данных. Существует одна установка DLL для каждого водителя; это может быть сам драйвер DLL или отдельный DLL. Настройка DLL подсказывает пользователю информацию, необходимую водителю для подключения к источнику данных и переводчику по умолчанию, если он поддерживается. Затем он вызывает установщик DLL и Windows AIS для записи этой информации в ODBC. Файл INI (или реестр).

Для отображения диалогового окна, с помощью которого `SQLManageDataSources` пользователь может добавлять, изменять и удалять источники данных, программа звонит в Установщик DLL. Эта функция вызывается при вызове установщика DLL из панели управления. Чтобы добавить, изменить или удалить `SQLManageDataSources` `ConfigDSN` источник данных, вызовы в настройке DLL для драйвера, связанного с этим источником данных. Чтобы непосредственно добавить, изменить или удалить `SQLConfigDataSource` источники данных, программа вызывает в установщик dLL. Программа передает имя источника данных и опцию, которая определяет действие. `SQLConfigDataSource`вызывает `ConfigDSN` в установке DLL и передает `SQLConfigDataSource`ему аргументы от .

Для получения дополнительной информации смотрите *справку программиста* ODBC SDK, главу 23, справку о функциях настройки DLL и главу 24, справку о функции установки DLL.

## <a name="see-also"></a>См. также раздел

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические заметки по категориям](../mfc/technical-notes-by-category.md)
