---
description: 'Дополнительные сведения о: TN048: написание программ установки и администрирования ODBC для приложений базы данных MFC'
title: TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC
ms.date: 11/04/2016
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
ms.openlocfilehash: bca8616bae8f7243b9e66b2eccc980afa3865842
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97215109"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC

> [!NOTE]
> Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

Приложениям, использующим классы баз данных MFC, потребуется программа установки, устанавливающая компоненты ODBC. Им также может потребоваться программа администрирования ODBC, которая будет получать сведения о доступных драйверах, указывать драйверы по умолчанию и настраивать источники данных. В этом заметке описывается использование API установщика ODBC для написания этих программ.

## <a name="writing-an-odbc-setup-program"></a><a name="_mfcnotes_writing_an_odbc_setup_program"></a> Написание программы установки ODBC

Приложение базы данных MFC требует, чтобы драйверы ODBC Driver Manager (ODBC.DLL) и ODBC могли получить доступ к источникам данных. Многим драйверам ODBC также требуются дополнительные сетевые и коммуникационные библиотеки DLL. Большинство драйверов ODBC поставляются с программой установки, которая установит необходимые компоненты ODBC. Разработчики приложений, использующие классы баз данных MFC, могут:

- Для установки компонентов ODBC используются программы установки, относящиеся к драйверу. Это не потребует дальнейшей работы на части разработчика — вы можете просто распространить программу установки драйвера.

- Кроме того, можно написать собственную программу установки, которая установит диспетчер драйверов и драйвер.

API установщика ODBC можно использовать для написания программ установки, зависящих от приложения. Функции в API установщика реализуются библиотекой DLL установщика ODBC — ODBCINST.DLL в 16-разрядных Windows и ODBCCP32.DLL в Win32. Приложение может вызвать `SQLInstallODBC` в библиотеке DLL установщика, которая установит диспетчер драйверов ODBC, драйверы ODBC и все необходимые переводчики. Затем он записывает установленные драйверы и переводчики в файл ODBCINST.INI (или в реестре в NT). `SQLInstallODBC` требуется полный путь к ODBC. INF-файл, который содержит список устанавливаемых драйверов и описывает файлы, составляющие каждый драйвер. Он также содержит похожие сведения о диспетчере драйверов и переводчиках. Соединения. INF-файлы обычно предоставляются разработчиками драйверов.

Программа также может устанавливать отдельные компоненты ODBC. Чтобы установить диспетчер драйверов, сначала программа вызывает `SQLInstallDriverManager` в DLL-библиотеке установщика, чтобы получить целевой каталог для диспетчера драйверов. Обычно это каталог, в котором находятся библиотеки DLL Windows. Затем программа использует информацию из раздела [ODBC Driver Manager] ODBC. INF-файл для копирования диспетчера драйверов и связанных с ним файлов с установочного диска в этот каталог. Чтобы установить отдельный драйвер, программа сначала вызывает `SQLInstallDriver` в библиотеке DLL установщика, чтобы добавить спецификацию драйвера в файл ODBCINST.INI (или реестр, в NT). `SQLInstallDriver` Возвращает целевой каталог драйвера — обычно каталог, в котором находятся библиотеки DLL Windows. Затем программа использует информацию в разделе драйвера ODBC. INF-файл для копирования библиотеки DLL драйвера и связанных с ним файлов с установочного диска в этот каталог.

Для получения дополнительных сведений об ODBC. INF, ODBCINST.INI и использование API установщика, см. Справочник по *программированию для* ODBC SDK, глава 19, установка программного обеспечения ODBC.

## <a name="writing-an-odbc-administrator"></a><a name="_mfcnotes_writing_an_odbc_administrator"></a> Написание администратора ODBC

Приложение базы данных MFC может устанавливать и настраивать источники данных ODBC одним из двух способов, как показано ниже.

- Используйте администратор ODBC (доступен как программа или элемент панели управления).

- Создайте собственную программу для настройки источников данных.

Программа, которая настраивает источники данных, выполняет вызовы функций в библиотеку DLL установщика. Библиотека DLL установщика вызывает библиотеку DLL установки для настройки источника данных. Для каждого драйвера имеется одна библиотека DLL установки. Это может быть сама библиотека DLL драйвера или отдельная библиотека DLL. Библиотека DLL установки запрашивает у пользователя сведения, необходимые драйверу для подключения к источнику данных и переводчику по умолчанию (если поддерживается). Затем он вызывает библиотеку DLL установщика и API Windows для записи этих сведений в файл ODBC.INI (или в реестр).

Для вывода диалогового окна, с помощью которого пользователь может добавлять, изменять и удалять источники данных, программа вызывает `SQLManageDataSources` в библиотеке DLL установщика. Эта функция вызывается при вызове библиотеки DLL установщика из панели управления. Чтобы добавить, изменить или удалить источник данных, `SQLManageDataSources` вызывает `ConfigDSN` в библиотеке DLL установки драйвер, связанный с этим источником данных. Для непосредственного добавления, изменения или удаления источников данных программа вызывает `SQLConfigDataSource` в библиотеке DLL установщика. Программа передает имя источника данных и параметр, указывающий действие, которое необходимо выполнить. `SQLConfigDataSource` вызывает `ConfigDSN` в библиотеке DLL программы установки и передает ей аргументы из `SQLConfigDataSource` .

Дополнительные сведения см. в разделах *Справочник по программированию для* ODBC SDK, глава 23, Справочник по функциям DLL программы установки и глава 24, Справочник по функциям DLL установщика.

## <a name="see-also"></a>См. также раздел

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические примечания по категориям](../mfc/technical-notes-by-category.md)
