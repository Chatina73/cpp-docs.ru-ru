---
title: TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC
ms.date: 11/04/2016
f1_keywords:
- vc.mfc.odbc
helpviewer_keywords:
- installing ODBC
- ODBC, installing
- setup, ODBC setup programs
- TN048
- ODBC, and MFC
- MFC, database applications
ms.assetid: d456cdd4-0513-4a51-80c0-9132b66115ce
ms.openlocfilehash: b31ceb8bfc48decb5387d386ee8e8b64822f72ed
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50584138"
---
# <a name="tn048-writing-odbc-setup-and-administration-programs-for-mfc-database-applications"></a>TN048. Написание программ настройки и администрирования ODBC для приложений баз данных MFC

> [!NOTE]
>  Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

Приложения, использование классов базы данных MFC требуется программу установки, которая устанавливает компоненты ODBC. Может также необходима программа администрирования ODBC, которая будет получать сведения о доступных драйверов, чтобы задать стандартные драйверы и для настройки источников данных. Эта заметка описывает использование API-интерфейса установщика ODBC для записи этих программ.

##  <a name="_mfcnotes_writing_an_odbc_setup_program"></a> Запись программы установки ODBC

Приложения базы данных MFC требуется диспетчер драйверов ODBC (ODBC. Библиотека DLL) и драйверы ODBC, чтобы иметь возможность получать к источникам данных. Многие драйверы ODBC также требуют дополнительных библиотек для подключения. Большинство драйверы ODBC поставляются с программой установки, которая установит необходимые компоненты ODBC. Разработчики приложений с помощью классов MFC базы данных можно:

- Зависит от программы настройки конкретного драйвера для установки компонентов ODBC. В этом случае потребуется дальнейшая действий со стороны разработчика — просто можно распространять программу установки драйвера.

- Кроме того можно написать собственную программу установки, которая установит диспетчера драйверов и драйвер.

API-интерфейса установщика ODBC можно использовать для написания программ установки конкретного приложения. Функции в установщике API реализуются с помощью установщика ODBC библиотеки DLL — ODBCINST. Библиотеки DLL на 16-разрядных Windows и ODBCCP32. Библиотеки DLL на Win32. Приложение может вызвать `SQLInstallODBC` в установщике библиотеки DLL, которая будет установить диспетчер драйверов ODBC, драйверов ODBC и любые необходимые переводчики. Затем фиксирует установленных драйверов и преобразователи в ODBCINST. INI-файл (или реестра, на NT). `SQLInstallODBC` требуется полный путь к ODBC. INF-файл, который содержит список драйверов должны быть установлены и описания файлов, которые составляют каждого драйвера. Он также содержит аналогичные сведения о диспетчера драйверов и переводчиков. ODBC. Файлы INF обычно также предоставляет разработчикам драйверов.

Программа также можно установить отдельные компоненты ODBC. Чтобы установить диспетчер драйверов, программа сначала вызывает `SQLInstallDriverManager` в установщике библиотеки DLL, чтобы получить целевой каталог для диспетчера драйверов. Обычно это каталог, в которой находятся библиотеки DLL Windows. Затем программа использует информацию в разделе [Диспетчер драйверов ODBC] ODBC. Файл INF для копирования диспетчера драйверов и связанные файлы с установочного диска в этот каталог. Чтобы установить отдельным драйвером, программа сначала вызывает `SQLInstallDriver` в библиотеку DLL для добавления в драйвер спецификации для ODBCINST установщик. INI-файл (или реестра, на NT). `SQLInstallDriver` Возвращает целевой каталог драйвера — обычно каталог, в которой находятся библиотеки DLL Windows. Затем программа использует информацию в разделе драйверов в ODBC. INF-файл для копирования DLL-файла драйвера и связанные файлы с установочного диска в этот каталог.

Дополнительные сведения о ODBC. INF, ODBCINST. INI и с помощью установщика API, см. в разделе ODBC SDK *справочнике программиста* главе 19, установка программного обеспечения ODBC.

##  <a name="_mfcnotes_writing_an_odbc_administrator"></a> Запись администратора ODBC

Приложения базы данных MFC можно установить и настроить источники данных ODBC одним из двух способов следующим образом:

- Используйте администратор ODBC (доступно в качестве программы или компонента панели управления).

- Создайте собственную программу для настройки источников данных.

Это программа, которая настраивает источники данных делает вызовы функций DLL программы установки. Библиотека DLL установщика вызов установки библиотеки DLL для настройки источника данных. Имеется один DLL-файлов установки для каждого драйвера; Возможно, драйвер сама Библиотека или отдельный файл DLL. Библиотека DLL программы установки запрашивает у пользователя сведения, необходимые драйверу для подключения к источнику данных и преобразователь по умолчанию, если поддерживается. Затем он вызывает установщик, библиотеки DLL и API-интерфейсы Windows для записи этой информации в ODBC. INI-файл (или реестра).

Чтобы отобразить диалоговое окно, с помощью которого пользователь можно добавлять, изменять и удалять источники данных, программа вызывает `SQLManageDataSources` в установщике библиотеки DLL. Эта функция вызывается, когда установщик DLL вызывается с помощью панели управления. Добавление, изменение или удаление источника данных, `SQLManageDataSources` вызовы `ConfigDSN` в DLL-файлов установки драйвера, связанного с источником данных. Чтобы напрямую добавить, изменить или удалить данные источники, программа вызывает `SQLConfigDataSource` в установщике библиотеки DLL. Программа передает имя источника данных и параметр, который указывает действие, выполняемое. `SQLConfigDataSource` вызовы `ConfigDSN` в DLL-файлов установки и передает его аргументы из `SQLConfigDataSource`.

Дополнительные сведения см. в разделе ODBC SDK *справочнике программиста* Глава 23, справочник по функциям библиотеки DLL программы установки и Глава 24, справочник по функциям библиотеки DLL установщика.

## <a name="see-also"></a>См. также

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические примечания по категории](../mfc/technical-notes-by-category.md)

