---
title: Серверы. Реализация оконных рамок на месте
ms.date: 09/09/2019
helpviewer_keywords:
- frame windows [MFC], implementing
- OLE server applications [MFC], frame windows
- servers, in-place frame windows
- frame windows [MFC], in-place
- in-place frame windows
ms.assetid: 09bde4d8-15e2-4fba-8d14-9b954d926b92
ms.openlocfilehash: bc5439003b7c891ac3f4000c9b7820746aec4c8d
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907542"
---
# <a name="servers-implementing-in-place-frame-windows"></a>Серверы. Реализация оконных рамок на месте

В этой статье объясняется, что необходимо сделать для реализации встроенных окон фрейма в приложении Visual Editing Server, если не используется мастер приложений для создания серверного приложения. Вместо выполнения процедуры, описанной в этой статье, можно использовать существующий класс окна фрейма на месте из приложения, созданного с помощью мастера приложений, или образца, представленного в Visual C++.

#### <a name="to-declare-an-in-place-frame-window-class"></a>Объявление класса фрейма окна на месте

1. Создайте производный класс окна фрейма на месте из `COleIPFrameWnd`.

   - Используйте макрос DECLARE_DYNCREATE в файле заголовка класса.

   - Используйте макрос IMPLEMENT_DYNCREATE в файле реализации класса (. cpp). Это позволяет платформе создавать объекты этого класса.

1. Объявите `COleResizeBar` элемент в классе фреймового окна. Это необходимо, если требуется поддержка изменения размера на месте в серверных приложениях.

   Объявите обработчик сообщений `OnCreate` (с помощью [мастера классов](reference/mfc-class-wizard.md))и вызовите `Create` свой член `COleResizeBar`, если он определен.

1. Если у вас есть панель инструментов, объявите `CToolBar` элемент в классе фреймового окна.

   Переопределите функцию-член, чтобы создать панель инструментов, когда сервер активен. `OnCreateControlBars` Например:

   [!code-cpp[NVC_MFCOleServer#1](../mfc/codesnippet/cpp/servers-implementing-in-place-frame-windows_1.cpp)]

   См. Описание этого кода, приведенного на шаге 5.

1. Включите файл заголовка для этого класса встроенного фрейма окна в основной CPP-файл.

1. В `InitInstance` для класса приложения `SetServerInfo` вызовите функцию объекта шаблона документа, чтобы указать ресурсы и окно фрейма на месте, которое будет использоваться при открытии и редактировании на месте.

Последовательность вызовов функций в операторе **If** создает панель инструментов из ресурсов, предоставленных сервером. На этом этапе панель инструментов является частью иерархии окон контейнера. Поскольку эта панель инструментов является производной от `CToolBar`, она передает ей свои сообщения владельцу, окно фрейма приложения контейнера, если владелец не изменен. Именно поэтому вызов `SetOwner` необходим. Этот вызов изменяет окно, куда отправляются команды, в окно размещения на сервере, в результате чего сообщения передаются на сервер. Это позволяет серверу реагировать на операции на панели инструментов, которые он предоставляет.

Идентификатор точечного рисунка панели инструментов должен быть таким же, как и другие ресурсы на месте, определенные в серверном приложении. См [. меню и ресурсы: Дополнения](../mfc/menus-and-resources-server-additions.md) сервера для получения дополнительных сведений.

Дополнительные сведения см. в разделе [COleIPFrameWnd](../mfc/reference/coleipframewnd-class.md), [колересизебар](../mfc/reference/coleresizebar-class.md)и [CDocTemplate:: Сетсерверинфо](../mfc/reference/cdoctemplate-class.md#setserverinfo) в *справочнике по библиотеке классов*.

## <a name="see-also"></a>См. также

[Серверы](../mfc/servers.md)<br/>
[Серверы. Реализация сервера](../mfc/servers-implementing-a-server.md)<br/>
[Серверы. Реализация документов сервера](../mfc/servers-implementing-server-documents.md)<br/>
[Серверы. Элементы сервера](../mfc/servers-server-items.md)
