---
title: Серверы автоматизации
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers
- COM components, Automation servers
- dispatch maps [MFC], Automation servers
- servers, Automation
ms.assetid: 523fd155-51ce-4f91-b986-b74bdbdd7d92
ms.openlocfilehash: 510acfa032ca4303962164a19130ecd1971060fc
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907965"
---
# <a name="automation-servers"></a>Серверы автоматизации

Автоматизация позволяет приложению манипулировать объектами, реализованными в другом приложении, или предоставлять объекты, чтобы их можно было манипулировать. Сервер автоматизации — это приложение, которое предоставляет программируемые объекты (называемые объектами автоматизации) другим приложениям (называемым [клиентами автоматизации](../mfc/automation-clients.md)). Серверы автоматизации иногда называются компонентами автоматизации.

Предоставление объектов автоматизации позволяет клиентам автоматизировать определенные процедуры путем прямого доступа к объектам и функциям, которые сервер делает доступным. Предоставление объектов таким способом полезно, когда приложения предоставляют функциональные возможности, которые удобно использовать для других приложений. Например, текстовый процессор может предоставлять свои функции проверки орфографии, чтобы другие программы могли его использовать. Таким образом, раскрытие объектов позволяет поставщикам улучшить функциональность своих приложений с помощью готовых функций других приложений.

Эти объекты автоматизации имеют свойства и методы в качестве внешнего интерфейса. Свойства являются именованными атрибутами объекта автоматизации. Свойства подобны элементам данных C++ класса. Методы — это функции, которые работают с объектами автоматизации. Методы подобны открытым функциям- C++ членам класса.

> [!NOTE]
>  Хотя свойства подобны C++ элементам данных, они недоступны напрямую. Чтобы обеспечить прозрачный доступ, настройте внутреннюю переменную в объекте автоматизации с помощью пары функций-членов Get/Set для доступа к ним.

Предоставляя функциональные возможности приложения через общий, четко определенный интерфейс, Автоматизация позволяет создавать приложения на одном общем языке программирования, таком как Microsoft Visual Basic, а не в различных приложениях, макросах, зависящих от приложения. Языки.

##  <a name="_core_support_for_automation_servers"></a>Поддержка серверов автоматизации

Visual C++ и MFC обеспечивают расширенную поддержку серверов автоматизации. Они обрабатывали большую часть издержек, связанных с созданием сервера автоматизации, поэтому вы можете сосредоточиться на работе с функциями приложения.

Основной механизм платформы для поддержки автоматизации — это схема диспетчеризации, набор макросов, который дополняет объявления и вызовы, необходимые для предоставления методов и свойств OLE. Типичная схема диспетчеризации выглядит следующим образом:

[!code-cpp[NVC_MFCAutomation#1](../mfc/codesnippet/cpp/automation-servers_1.cpp)]

[Мастер классов](reference/mfc-class-wizard.md) и представление классов помогают поддерживать карты диспетчеризации. При добавлении в класс нового метода или свойства Visual Studio добавляет соответствующий `DISP_FUNCTION` макрос или `DISP_PROPERTY` с параметрами, указывающими имя класса, внешние и внутренние имена метода или свойства, а также типы данных.

Диалоговое окно **Добавление класса** также упрощает объявление классов автоматизации и управление их свойствами и операциями. При использовании диалогового окна Добавление класса для добавления класса в проект необходимо указать его базовый класс. Если базовый класс допускает автоматизацию, в диалоговом окне Добавление класса отображаются элементы управления, используемые для указания, должен ли новый класс поддерживать автоматизацию, является ли он «создаваемым OLE» (то есть, могут ли объекты класса создаваться по запросу от клиента COM). и внешнее имя для используемого COM-клиента.

Затем диалоговое окно **Добавление класса** создает объявление класса, включая соответствующие макросы для указанных компонентов OLE. Он также добавляет скелет кода для реализации функций члена класса.

Мастер приложений MFC упрощает выполнение действий, связанных с началом работы с сервером автоматизации. Если установить флажок **Автоматизация** на странице **Дополнительные компоненты** , мастер приложений MFC добавляет в `InitInstance` функцию приложения вызовы, необходимые для регистрации объектов автоматизации и запуска приложения в виде Сервер автоматизации.

### <a name="what-do-you-want-to-do"></a>Что Вы хотите делать

- [Дополнительные сведения о клиентах автоматизации](../mfc/automation-clients.md)

- [Дополнительные сведения о классе от CCmdTarget](../mfc/reference/ccmdtarget-class.md)

- [Дополнительные сведения о классе COleDispatchDriver](../mfc/reference/coledispatchdriver-class.md)

## <a name="see-also"></a>См. также

[Автоматизация](../mfc/automation.md)<br/>
[Мастер приложений MFC](../mfc/reference/mfc-application-wizard.md)
