---
title: Серверы автоматизации
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers
- COM components, Automation servers
- dispatch maps [MFC], Automation servers
- servers, Automation
ms.assetid: 523fd155-51ce-4f91-b986-b74bdbdd7d92
ms.openlocfilehash: 391cb2f6ff5673296f40e21113e3a6510f71d475
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370840"
---
# <a name="automation-servers"></a>Серверы автоматизации

Автоматизация позволяет приложению манипулировать объектами, реализованными в другом приложении, или разоблачать объекты, чтобы ими можно было манипулировать. Сервер автоматизации — это приложение, которое предоставляет программируемые объекты (называемые объектами автоматизации) другим приложениям (так [называемые клиенты автоматизации).](../mfc/automation-clients.md) Серверы автоматизации иногда называют компонентами автоматизации.

Разоблачение объектов автоматизации позволяет клиентам автоматизировать определенные процедуры, непосредственно доступ к объектам и функциональности сервера предоставляется. Разоблачение объектов таким образом полезно, когда приложения предоставляют функциональность, которая полезна для других приложений. Например, текстовый процессор может предоставить свою функциональность проверки орфографии, чтобы другие программы могли использовать его. Таким образом, экспозиция объектов позволяет поставщикам улучшить функциональность своих приложений, используя готовые функциональные возможности других приложений.

Эти объекты автоматизации имеют свойства и методы в качестве внешнего интерфейса. Свойства называются атрибутами объекта автоматизации. Свойства подобны членам данных класса СЗ. Методы являются функциями, которые работают на объектах автоматизации. Методы подобны функциям публичного члена класса СЗ.

> [!NOTE]
> Несмотря на то, что свойства похожи на членов данных СЗ, они не доступны напрямую. Чтобы обеспечить прозрачный доступ, навяжьте внутреннюю переменную в объекте автоматизации с парой функций члена get/set для доступа к ним.

Разоблачая функциональность приложений с помощью общего, четко определенного интерфейса, Автоматизация позволяет создавать приложения на одном общем языке программирования, например на Microsoft Visual Basic, а не на различных, специфических макроязыках.

## <a name="support-for-automation-servers"></a><a name="_core_support_for_automation_servers"></a>Поддержка серверов автоматизации

Визуальный C и MFC рамки обеспечивают широкую поддержку для автоматизации серверов. Они обрабатывают большую часть накладных расходов, связанных с созданием сервера автоматизации, так что вы можете сосредоточить свои усилия на функциональности вашего приложения.

Основным механизмом поддержки автоматизации платформы является карта отправки, набор макросов, который расширяется в декларации и вызовы, необходимые для разоблачения методов и свойств для OLE. Типичная карта отправки выглядит следующим образом:

[!code-cpp[NVC_MFCAutomation#1](../mfc/codesnippet/cpp/automation-servers_1.cpp)]

[Класс Мастера](reference/mfc-class-wizard.md) и Класс Вид помочь в обслуживании диспетчерских карт. При добавлении нового метода или свойства в `DISP_FUNCTION` класс `DISP_PROPERTY` Visual Studio добавляет соответствующий или макрос с параметрами, указывающими имя класса, внешние и внутренние имена метода или свойства, а также типы данных.

Диалоговый ящик **Add Class** также упрощает декларирование классов автоматизации и управление их свойствами и операциями. При использовании диалогового окна Add Class для добавления класса в проект указывается его базовый класс. Если базовый класс позволяет автоматизацию, то диалоговое окно Add Class отображает элементы управления, которые используются для определения того, должен ли новый класс поддерживать автоматизацию, будь то "OLE creatable" (т.е. могут ли объекты класса быть созданы по запросу клиента COM), и внешнее имя клиента COM для использования.

Затем в диалоговом окне **Add Class** создается объявление класса, включая соответствующие макросы для указанных вами функций OLE. Он также добавляет код скелета для реализации функций членов вашего класса.

MFC Application Wizard упрощает шаги, связанные с получением приложения сервера автоматизации от земли. Если вы выберете флажок **автоматизации** со страницы **Расширенные функции,** Мастер приложения MFC добавляет к `InitInstance` функции приложения вызовы, необходимые для регистрации объектов автоматизации и запуска приложения в качестве сервера автоматизации.

### <a name="what-do-you-want-to-do"></a>Что Вы хотите делать

- [Узнайте больше о клиентах автоматизации](../mfc/automation-clients.md)

- [Узнайте больше о классе CCmdTarget](../mfc/reference/ccmdtarget-class.md)

- [Узнайте больше о классе COleDispatchDriver](../mfc/reference/coledispatchdriver-class.md)

## <a name="see-also"></a>См. также раздел

[Служба автоматизации](../mfc/automation.md)<br/>
[Мастер приложений MFC](../mfc/reference/mfc-application-wizard.md)
