---
title: Слияние меню "Справка"
ms.date: 11/04/2016
helpviewer_keywords:
- menus [MFC], merging
- merging Help menus [MFC]
- Help [MFC], for active document containers
ms.assetid: 9d615999-79ba-471a-9288-718f0c903d49
ms.openlocfilehash: e1e8f9af696b6ea4cd485f4215e1c8425098e987
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57296854"
---
# <a name="help-menu-merging"></a>Слияние меню "Справка"

При активном в контейнере объекта слияние протокола OLE документов меню предоставляет объект полный контроль **помочь** меню. Как следствие разделы справки контейнера доступно, только если пользователь отключает объект. Архитектура вложения активного документа при развертывании на правилах для слияния для контейнера и активный документ, который активен для совместного использования меню меню на месте. Новые правила — это просто дополнительные соглашения о какой компонент, которому принадлежит какая часть меню и правила составления общее меню.

Новое соглашение прост. В активных документах **помочь** меню содержит два элемента меню верхнего уровня, упорядочены следующим образом:

`Help`

`Container Help >`

`Object Help    >`

Например, когда активно раздел Word в Office Binder, а затем **помочь** меню будет выглядеть следующим образом:

`Help`

`Binder Help >`

`Word Help   >`

Обе команды меню, вложенные меню, при которых любые дополнительные пункты меню для контейнера и объекта предоставляются пользователю. Какие элементы будут отображаться здесь будет зависеть от контейнеров и объектов участвующих.

Для построения данного слияние **помочь** меню, вложения активного документа архитектура изменяет обычную процедуру OLE-документы. В соответствии с документов OLE, в строке меню после слияния могут иметь шесть группы меню, а именно **файл**, **изменить**, **контейнера**, **объект**,  **Окно**, **помочь**в этом порядке. В каждой группе может быть ноль или более меню. Группы **файл**, **контейнера**, и **окно** принадлежат контейнер и группам **изменить**, **объект,** и **помочь** принадлежит объекту. Когда объект хочет выполнить слияние меню, он создает строку пустое меню и передает его в контейнер. Контейнер, затем вставляет его меню путем вызова `IOleInPlaceFrame::InsertMenus`. Объект также передает структуру, представляет собой массив из шести ДЛИННЫЕ значения (**OLEMENUGROUPWIDTHS**). После вставки меню, контейнер помечает как множество меню, он будет добавлен в каждом из его группы, а затем возвращает. Затем объект вставляет свои меню, обращая внимание на число меню в каждой группы контейнеров. Наконец объект передается в строке меню после слияния и массива (который содержит количество меню в каждой группе) OLE, который возвращает значение opaque «дескриптор меню» обработать. Позднее объект передает этот дескриптор и в строке меню после слияния в контейнер с помощью `IOleInPlaceFrame::SetMenu`. В настоящее время контейнер отображает в строке меню после слияния и также передает дескриптор OLE, таким образом, чтобы OLE можно сделать правильной диспетчеризации сообщений меню.

В процедуре измененный активный документ, сначала необходимо инициализировать объект **OLEMENUGROUPWIDTHS** элементов до нуля перед передачей его в контейнер. Контейнер выполняет обычный меню вставки, за одним исключением: Операции вставки контейнера **помочь** меню как последний элемент и сохраняет значение 1 в последней записи (шестая) **OLEMENUGROUPWIDTHS** массива (то есть ширины [5], к которой принадлежит к группе справки объекта). Это **помочь** меню будет иметь только один элемент, который является подчиненным меню, "**справки контейнера** >» cascade меню как описано выше.

Объект, затем выполняет свой код вставки обыкновенное меню, за исключением, перед вставкой его **помочь** меню, он проверяет шестой ввод **OLEMENUGROUPWIDTHS** массива. Если значение равно 1 и последнее меню называется **помочь** (или соответствующий Локализованная строка), то вставляет объект его **помочь** меню в виде подменю контейнера **помочь** меню.

Объект затем задает шестой элемент **OLEMENUGROUPWIDTHS** нулю и увеличивает на единицу пятого элемента. Это позволяет OLE следует помнить, что **помочь** меню принадлежит к контейнеру и меню сообщений, соответствующих соответствующее меню (и его подменю) должно быть направлено в контейнер. Отвечает за затем контейнера пересылать **WM_INITMENUPOPUP**, **WM_SELECT**, **WM_COMMAND**и других сообщений, связанных с меню, принадлежащих объекту часть **помочь** меню. Это достигается с помощью **WM_INITMENU** Снимите флаг, который определяет контейнер, является ли пользователь перешел в объект **помочь** меню. Затем отслеживает контейнер **WM_MENUSELECT** для записи в "или" Выход "из любого элемента на **помочь** меню, в котором контейнер не добавил себя. На входе значит пользователь перешел в меню объекта, поэтому контейнер устанавливает флаг «в "меню Справка" объект» и использует состояние флага для пересылки любой **WM_MENUSELECT**, **WM_INITMENUPOPUP**и  **WM_COMMAND** сообщений, как минимум, в окно объекта. (На выходе контейнера снимает флаг и затем во время обработки этих же сообщения.) Окно, возвращаемый из объекта следует использовать контейнер `IOleInPlaceActiveObejct::GetWindow` функционировать в качестве назначения для этих сообщений.

Если объект обнаруживает ноль в элементе шестой **OLEMENUGROUPWIDTHS**, оно проходит согласно обычным правилам OLE-документы. Эта процедура охватывает контейнеры, которые участвуют в **помочь** слияния, а также не меню.

При вызове объекта `IOleInPlaceFrame::SetMenu`, прежде чем ли отображение объединенных меню проверки контейнера **помочь** меню содержит дополнительные подменю, в дополнение к вставке контейнера. Если таким образом, контейнер покидает его **помочь** меню в строке меню после слияния. Если **помочь** меню не имеет дополнительных подменю, контейнер приведет к удалению его **помочь** меню в строке меню после слияния. Эта процедура охватывает объектов, участвующих в **помочь** слияния, а также не меню.

И, наконец, когда наступает время, чтобы дизассемблировать меню, объект удаляет inserted **помочь** меню в дополнение к удалением остальных вставлено меню. Когда контейнер удаляет его меню, он удалит его **помочь** меню в дополнение к другим меню, которые он вставил.

## <a name="see-also"></a>См. также

[Контейнеры активных документов](../mfc/active-document-containers.md)
