---
title: Серверы. Элементы сервера
ms.date: 11/04/2016
helpviewer_keywords:
- server items, implementing
- servers [MFC], server items
- architecture [MFC], server-item
- server items
- OLE server applications [MFC], server items
ms.assetid: 28ba81a1-726a-4728-a52d-68bc7efd5a3c
ms.openlocfilehash: 8ae24104a30a0b44e92b889006907911124310f7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81355115"
---
# <a name="servers-server-items"></a>Серверы. Элементы сервера

Когда контейнер запускает сервер, чтобы пользователь мог отсеять встроенный или связанный элемент OLE, серверное приложение создает "серверный элемент". Элемент сервера, который является объектом класса, полученным из, `COleServerItem`обеспечивает интерфейс между серверным документом и контейнерным приложением.

Класс `COleServerItem` определяет несколько переизликвых функций-членов, которые называются OLE, как правило, в ответ на запросы из контейнера. Элементы сервера могут представлять часть серверного документа или весь документ. При встраивании элемента OLE в контейнерный документ элемент сервера представляет весь серверный документ. При подключении элемента OLE элемент сервера может представлять часть серверного документа или весь документ, в зависимости от того, является ли ссылка на часть или на целую.

В примере [HIERSVR,](../overview/visual-cpp-samples.md) например, в `CServerItem`классе сервера-элемента есть элемент, который `CServerNode`является указателем на объект класса. Объект `CServerNode` является узлом в документе приложения HIERSVR, который является деревом. Когда `CServerNode` объект является корневым `CServerItem` узлам, объект представляет весь документ. Когда `CServerNode` объект является узлами `CServerItem` ребенка, объект представляет собой часть документа. Пример такого взаимодействия с образцом [HIERSVR](../overview/visual-cpp-samples.md) MFC OLE.

## <a name="implementing-server-items"></a><a name="_core_implementing_server_items"></a>Реализация элементов сервера

Если вы используете мастер приложения для создания кода "стартер" для вашего приложения, все, что вам нужно сделать, чтобы включить элементы сервера в ваш стартовый код, чтобы выбрать один из вариантов сервера со страницы OLE Options. Если вы добавляете элементы сервера в существующее приложение, выполните следующие действия:

#### <a name="to-implement-a-server-item"></a>Для реализации элемента сервера

1. Создайте производный класс от класса `COleServerItem`.

1. В вашем производном `OnDraw` классе переопределить функцию члена.

   Рамки требует `OnDraw` внести элемент OLE в метафайл. Контейнерное приложение использует этот метафайл для визуализации элемента. Класс представления приложения также имеет `OnDraw` функцию члена, которая используется для визуализации элемента при активной работе серверного приложения.

1. Реализация переопределения `OnGetEmbeddedItem` для класса серверных документов. Для получения дополнительной информации смотрите статью [Серверы: Реализация серверных документов](../mfc/servers-implementing-server-documents.md) и MFC OLE образца [HIERSVR](../overview/visual-cpp-samples.md).

1. Реализация функции члена класса `OnGetExtent` сервера-элемента. Фрейм вызывает эту функцию для получения размера элемента. Реализация по умолчанию не выполняет никаких действий.

## <a name="a-tip-for-server-item-architecture"></a><a name="_core_a_tip_for_server.2d.item_architecture"></a>Совет для архитектуры сервера-элемента

Как отмечено в [«Реализации элементов сервера»,](#_core_implementing_server_items)серверные приложения должны быть в состоянии отображать элементы как в представлении сервера, так и в метафайле, используемом контейнерным приложением. В архитектуре приложений Библиотеки присяжет `OnDraw` к классу Microsoft Foundation функция члена класса представления отображает элемент при его редактировании (см. [CView::OnDraw](../mfc/reference/cview-class.md#ondraw) в справочнике *библиотеки класса).* Элемент сервера `OnDraw` отображает элемент в метафайл во всех других случаях (см. [COleServerItem:OnDraw).](../mfc/reference/coleserveritem-class.md#ondraw)

Можно избежать дублирования кода, написав функции помощника в классе серверных документов и выведя их из `OnDraw` функций в представлении и классах серверных элементов. В образце MFC OLE [HIERSVR](../overview/visual-cpp-samples.md) `CServerView::OnDraw` используется `CServerItem::OnDraw` эта `CServerDoc::DrawTree` стратегия: функции и оба вызова для визуализации элемента.

Представление и элемент имеют `OnDraw` функции члена, поскольку они рисуют в разных условиях. В представлении должны учитываться такие факторы, как масштабирование, размер выбора и размер, отсечение и элементы пользовательского интерфейса, такие как бары прокрутки. С другой стороны, элемент сервера всегда рисует весь объект OLE.

Для получения дополнительной информации [см. CView::OnDraw](../mfc/reference/cview-class.md#ondraw), [COleServerItem](../mfc/reference/coleserveritem-class.md), [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#ondraw), и [COleServerDoc::OnGetEmbeddedItem](../mfc/reference/coleserverdoc-class.md#ongetembeddeditem) в *справочнике библиотеки класса*.

## <a name="see-also"></a>См. также раздел

[Серверы](../mfc/servers.md)
