---
title: 'серверы: Элементы сервера'
ms.date: 11/04/2016
helpviewer_keywords:
- server items, implementing
- servers [MFC], server items
- architecture [MFC], server-item
- server items
- OLE server applications [MFC], server items
ms.assetid: 28ba81a1-726a-4728-a52d-68bc7efd5a3c
ms.openlocfilehash: abee619aa921b3e036a2bbeb1b4f5ae08d83f5bb
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58767903"
---
# <a name="servers-server-items"></a>серверы: Элементы сервера

Когда контейнер запускает сервер таким образом, пользователь может изменить элемент внедренных или связанных OLE, серверное приложение создает «элемент-server». Серверный элемент, который является объектом класса, производного от `COleServerItem`, предоставляет интерфейс между серверного документа и приложения-контейнера.

`COleServerItem` Класс определяет несколько функций является переопределяемым элементом, вызываемым OLE, обычно в ответ на запросы из контейнера. Элементы сервера может представлять часть серверного документа или весь документ. При внедрении элемента OLE в документе-контейнере, серверный элемент представляет документ, всего сервера. При компоновке элемента OLE серверный элемент может представлять часть серверного документа или весь документ, в зависимости от того, является ли ссылку к части или целого.

В [HIERSVR](../overview/visual-cpp-samples.md) выборки, например, класс элемента сервера `CServerItem`, содержит член, указатель на объект класса `CServerNode`. `CServerNode` Объект является узлом приложения HIERSVR документа, который представляет собой дерево. Когда `CServerNode` объект является корневым узлом, `CServerItem` представляет весь документ. Когда `CServerNode` объекта является дочерним для узла, `CServerItem` представляет части этого документа. См. в разделе примера MFC OLE [HIERSVR](../overview/visual-cpp-samples.md) пример взаимодействия.

##  <a name="_core_implementing_server_items"></a> Реализация элементы сервера

Если вы используете мастер приложений для получения кода «Начальная» для вашего приложения, все, что нужно сделать, чтобы включить элементы сервера в начальный код является выберите один из параметров сервера на странице параметров OLE. Если вы добавляете элементы сервера в существующее приложение, выполните следующие действия:

#### <a name="to-implement-a-server-item"></a>Чтобы реализовать это элемент сервера

1. Создайте производный класс от класса `COleServerItem`.

1. В производном классе, переопределить `OnDraw` функция-член.

   Платформа вызывает `OnDraw` для отрисовки элемента OLE в метафайл. Приложение-контейнер использует этот метафайла для отрисовки элемента. Класс представления приложения также имеет `OnDraw` функцией-членом, которая используется для отрисовки элемента при активном серверное приложение.

1. Реализовать переопределение `OnGetEmbeddedItem` для класса серверный документ. Для получения дополнительных сведений см. в статье [серверов: Реализация документов сервера](../mfc/servers-implementing-server-documents.md) и образцом MFC OLE [HIERSVR](../overview/visual-cpp-samples.md).

1. Реализовать классу элемента сервера `OnGetExtent` функция-член. Платформа вызывает эту функцию для определения размера элемента. Реализация по умолчанию не выполняет никаких действий.

##  <a name="_core_a_tip_for_server.2d.item_architecture"></a> Совет для архитектуры элемент сервера

Как отмечалось в [элементы реализации сервера](#_core_implementing_server_items), серверных приложений должен иметь возможность визуализации элементов, как в режиме сервера, так и в метафайл, используемый приложением-контейнером. В библиотеки Microsoft Foundation Class приложения архитектуры, класс представления `OnDraw` функция-член выполняет визуализацию элемента при его редактировании (см. в разделе [CView::OnDraw](../mfc/reference/cview-class.md#ondraw) в *Справочник по библиотеке классов* ). Элемент сервера `OnDraw` отображает элемент в метафайл во всех остальных случаях (см. в разделе [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#ondraw)).

Можно избежать дублирования кода путем написания вспомогательных функций в классе серверного документа и вызывать их из `OnDraw` функций в классах представление и элемента сервера. Пример MFC OLE [HIERSVR](../overview/visual-cpp-samples.md) применяет эту стратегию: функции `CServerView::OnDraw` и `CServerItem::OnDraw` обе точки вызова `CServerDoc::DrawTree` для отрисовки элемента.

Представление, так и элемент `OnDraw` для функций-членов так, как они рисования в различных условиях. Представление необходимо учитывать такие факторы как масштабирование, выделенного фрагмента и экстент, обрезки и элементы пользовательского интерфейса, такие как полосы прокрутки. С другой стороны, серверный элемент всегда рисует всей OLE-объекта.

Дополнительные сведения см. в разделе [CView::OnDraw](../mfc/reference/cview-class.md#ondraw), [COleServerItem](../mfc/reference/coleserveritem-class.md), [COleServerItem::OnDraw](../mfc/reference/coleserveritem-class.md#ondraw), и [COleServerDoc::OnGetEmbeddedItem](../mfc/reference/coleserverdoc-class.md#ongetembeddeditem)в *класса Справочник по библиотеке*.

## <a name="see-also"></a>См. также

[Серверы](../mfc/servers.md)
