---
title: Альтернативы архитектуре просмотра документов
ms.date: 11/04/2016
helpviewer_keywords:
- documents [MFC], applications without
- CDocument class [MFC], space requirements
- views [MFC], applications without
ms.assetid: 2c22f352-a137-45ce-9971-c142173496fb
ms.openlocfilehash: 41af30d25d7ddb9e2bdbb7a0f7b86cb741ae1048
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370797"
---
# <a name="alternatives-to-the-documentview-architecture"></a>Альтернативы для архитектуры "документ-представление"

Приложения MFC обычно используют архитектуру документа/просмотра для управления информацией, форматами файлов и визуальным представлением данных пользователям. Для большинства настольных приложений архитектура документа/просмотра является подходящей и эффективной архитектурой приложений. Эта архитектура отделяет данные от просмотра и в большинстве случаев упрощает приложение и уменьшает избыточный код.

Однако архитектура документа/просмотра не подходит для некоторых ситуаций. Рассмотрим следующие примеры:

- При переносе приложения, написанного в C для Windows, может потребоваться завершить порт перед добавлением поддержки документа/просмотра в приложение.

- Если вы пишете облегченный утилиты, вы можете обнаружить, что вы можете обойтись без документа / просмотра архитектуры.

- Если исходный код уже смешивает управление данными с просмотром данных, перенос кода в модель документа/просмотра не стоит усилий, потому что необходимо разделить их. Вы можете предпочесть оставить код как есть.

Чтобы создать приложение, в которое не используется архитектура документа/просмотра, очистите флажок **поддержки архитектуры документа/просмотра** в шаге 1 Мастера приложения MFC. Подробнее о ней читайте в материале [«Мастер приложений MFC».](../mfc/reference/mfc-application-wizard.md)

> [!NOTE]
> Приложения на основе Dialog, созданные MFC Application Wizard, не используют архитектуру документа/просмотра, поэтому флажок **поддержки архитектуры документа/просмотра** отключен при выборе типа приложения диалогов.

Мастера Visual C', а также редакторы источников и диалогов работают с генерируемым приложением так же, как и с любым другим приложением Wizard. Приложение может поддерживать панели инструментов, прокрутки и панель статуса, и имеет поле **About.** Ваша заявка не будет регистрировать шаблоны документов и не будет содержать класс документов.

Обратите внимание, что ваше генерируемое приложение имеет класс представления, `CChildView`полученный из `CWnd`. MFC создает и позиционирует один экземпляр класса представления в окнах кадра, созданных вашим приложением. MFC по-прежнему применяет сярприсс с помощью окна представления, поскольку упрощает позиционирование и управление содержимым приложения. Вы можете добавить `OnPaint` код живописи члену этого класса. Код должен добавлять прокрутки в представление, а не в кадр.

Поскольку архитектура документа/просмотра, предоставляемая MFC, отвечает за реализацию многих основных функций приложения, его отсутствие в проекте означает, что вы несете ответственность за реализацию многих важных функций приложения:

- По данным Мастера приложения MFC, меню для приложения содержит только **новые** и **выходные** команды в меню **файла.** (Новая **New** команда поддерживается только для приложений MDI, а не для приложений SDI без поддержки Document/View.) Сгенерированный ресурс меню не будет поддерживать список MRU (самый недавно используемый).

- Необходимо добавить функции обработчика и реализации для любых команд, которые будет поддерживать приложение, включая **Open** и **Сохранить** в меню **файла.** MFC обычно предоставляет код для поддержки этих функций, но эта поддержка тесно связана с архитектурой документа/просмотра.

- Панель инструментов для приложения, если вы запросили его, будет минимальной.

Настоятельно рекомендуется использовать MFC Application Wizard для создания приложений без архитектуры документа/просмотра, поскольку мастер гарантирует правильную архитектуру MFC. Однако, если вы должны избегать использования мастера, здесь есть несколько подходов для обхода архитектуры документа/просмотра в коде:

- Относитесь к документу как к неиспользованному придатку и реализуйте код управления данными в классе представления, как это было предложено выше. Накладные расходы по документу являются относительно низкими. Один объект [CDocument](../mfc/reference/cdocument-class.md) несет небольшое количество накладных расходов сам по `CDocument`себе, плюс небольшие накладные расходы базовых классов, [CCmdTarget](../mfc/reference/ccmdtarget-class.md) и [CObject](../mfc/reference/cobject-class.md). Оба последних класса являются небольшими.

   Объявлено `CDocument`в:

  - Два `CString` объекта.

  - Три **BOOL**s.

  - Один `CDocTemplate` указатель.

  - Один `CPtrList` объект, содержащий список представлений документа.

  Кроме того, документ требует времени для создания объекта документа, объектов представления, окна кадра и объекта шаблона документа.

- Относитесь как к документу, так и к представлению как к неиспользованной придатке. Поместите управление данными и код рисования в окно кадра, а не в представление. Этот подход ближе к модели программирования на си-языке.

- Переопределить части платформы MFC, которые создают документ, и представление для их устранения вообще. Процесс создания документа начинается `CWinApp::AddDocTemplate`с вызова . Устраните этот вызов `InitInstance` из функции члена класса приложения `InitInstance` и вместо этого создайте окно кадра в себе. Поместите код управления данными в класс оконного окна кадра. Процесс создания документа/просмотра иллюстрируется в [документе/посмотреть создание](../mfc/document-view-creation.md). Это больше работы и требует более глубокого понимания структуры, но это полностью освобождает вас от документа / просмотра накладных расходов.

В статье [MFC: Использование классов баз данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md) дает более конкретные примеры альтернатив документооборота/просмотра в контексте приложений баз данных.

## <a name="see-also"></a>См. также раздел

[Архитектура документов/просмотра](../mfc/document-view-architecture.md)
