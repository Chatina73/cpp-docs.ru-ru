---
title: Буфер обмена. Использование буфера обмена Windows
ms.date: 11/04/2016
helpviewer_keywords:
- Clipboard commands
- Cut/Copy and Paste command handler functions [MFC]
- handler functions, Cut/Copy and Paste commands
- Clipboard [MFC], commands
- commands [MFC], implementing Edit
- Clipboard commands [MFC], implementing
- Windows Clipboard [MFC]
- Clipboard [MFC], Windows Clipboard API
ms.assetid: 24415b42-9301-4a70-b69a-44c97918319f
ms.openlocfilehash: 67bc337af2cf55a4f39698f730ce14a3369ef742
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50460701"
---
# <a name="clipboard-using-the-windows-clipboard"></a>Буфер обмена. Использование буфера обмена Windows

В этом разделе описывается, как использовать стандартные API буфера обмена Windows в приложении MFC.

Большинство приложений для Windows поддерживает вырезания или копирования данных в буфер обмена Windows и вставки данных из буфера обмена. Форматы данных буфера обмена отличаются для различных приложений. Платформа поддерживает только ограниченный набор форматов буфера обмена для некоторых классов. Обычно вы реализуете команды, связанные с буфер обмена, вырезания, копирования и вставки — в меню "Правка" для представления. Библиотека классов определяет идентификаторы команд для этих команд: **ID_EDIT_CUT**, **ID_EDIT_COPY**, и **ID_EDIT_PASTE**. Также определяются их запросы строка сообщения.

[Сообщения и команды платформы](../mfc/messages-and-commands-in-the-framework.md) способы обработки команды меню в приложении, сопоставив команду меню функцию обработчика событий. До тех пор, пока приложение не определяет функции обработчика для буфера команд в меню "Правка", они остаются отключенными. Чтобы создать функции обработчика для команды вырезания и копирования, реализуйте выбора в приложении. Чтобы написать функцию обработчика событий для команды Paste, запрос в буфер обмена, чтобы узнать, содержит ли данные в формате, который может принимать приложения. Например чтобы включить команду копирования, можно написать обработчик примерно следующим образом:

[!code-cpp[NVC_MFCListView#2](../atl/reference/codesnippet/cpp/clipboard-using-the-windows-clipboard_1.cpp)]

Команды вырезания, копирования и вставки важны только в определенных контекстах. Команды вырезания и копирования должен быть включен только в том случае, если что-то выбран, и команда "Вставить", только когда что-то в буфер обмена. Это поведение можно указать путем определения функции обработчика обновления, включающие или отключающие эти команды в зависимости от контекста. Дополнительные сведения см. в разделе [обновление объектов пользовательского интерфейса](../mfc/how-to-update-user-interface-objects.md).

Библиотеки Microsoft Foundation Class поддерживают буфер обмена текста при редактировании с `CEdit` и `CEditView` классы. Классы OLE упрощают реализацию операции с буфером обмена, включающие элементы OLE. Дополнительные сведения о классы OLE, см. в разделе [буфер обмена: использование механизма буфера обмена OLE](../mfc/clipboard-using-the-ole-clipboard-mechanism.md).

Реализация других изменить меню команд, таких как отмены (**ID_EDIT_UNDO**) и повтора (**ID_EDIT_REDO**), вам также остается. Если приложение не поддерживает эти команды, их можно легко удалить из файла ресурсов с помощью редакторы ресурсов Visual C++.

## <a name="what-do-you-want-to-know-more-about"></a>Выберите для получения дополнительных сведений

- [Копирование и вставка данных](../mfc/clipboard-copying-and-pasting-data.md)

- [Использование механизма буфера обмена OLE](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)

## <a name="see-also"></a>См. также

[Буфер обмена](../mfc/clipboard.md)

