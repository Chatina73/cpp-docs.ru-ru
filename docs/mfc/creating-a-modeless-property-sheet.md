---
title: Создание безмодальной вкладки свойства
ms.date: 11/04/2016
helpviewer_keywords:
- modeless property sheets
- property sheets, modeless
- Create method [MFC], property sheets
ms.assetid: eafd8a92-cc67-4a69-a5fb-742c920d1ae8
ms.openlocfilehash: 90f6dcd5659d308a4b39d6a7d5a42003fc1f2111
ms.sourcegitcommit: 1e6386be9084f70def7b3b8b4bab319a117102b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/30/2019
ms.locfileid: "71685690"
---
# <a name="creating-a-modeless-property-sheet"></a>Создание безмодальной вкладки свойства

Обычно создаваемые страницы свойств будут модальными. При использовании модальной страницы свойств пользователь должен закрыть страницу свойств перед использованием любой другой части приложения. В этой статье описываются методы, которые можно использовать для создания немодальной страницы свойств, позволяющей пользователю оставаться открытой на странице свойств при использовании других частей приложения.

Чтобы отобразить страницу свойств как немодальное диалоговое окно, а не как модальное диалоговое окно, вызовите метод [CPropertySheet:: Create](../mfc/reference/cpropertysheet-class.md#create) вместо [DoModal](../mfc/reference/cpropertysheet-class.md#domodal). Кроме того, необходимо реализовать некоторые дополнительные задачи для поддержки немодальной страницы свойств.

Одной из дополнительных задач является обмен данными между страницей свойств и внешним объектом, который он изменяет, когда открыта страница свойств. Обычно это та же задача, что и для стандартных немодальных диалоговых окон. Частью этой задачи является реализация канала связи между немодальной страницей свойств и внешним объектом, к которому применяются параметры свойств. Эта реализация гораздо проще, если вы наследуете класс от [CPropertySheet](../mfc/reference/cpropertysheet-class.md) для немодальной страницы свойств. В этой статье предполагается, что вы сделали это.

Одним из способов связи между немодальной страницей свойств и внешним объектом (например, текущим выделением в представлении) является определение указателя из страницы свойств на внешний объект. Определите функцию (называемую `SetMyExternalObject`) в классе, производном от `CPropertySheet`, чтобы изменить указатель при каждом изменении фокуса с одного внешнего объекта на другой. Функции `SetMyExternalObject` необходимо сбросить параметры для каждой страницы свойств, чтобы отразить только что выбранный внешний объект. Для этого функция `SetMyExternalObject` должна иметь возможность доступа к объектам [CPropertyPage](../mfc/reference/cpropertypage-class.md) , принадлежащим классу `CPropertySheet`.

Самый удобный способ предоставления доступа к страницам свойств на странице свойств заключается в внедрении объектов `CPropertyPage` в объект, производный от `CPropertySheet`. Внедрение `CPropertyPage` объектов в объект, производный от `CPropertySheet`, отличается от типичного дизайна для модальных диалоговых окон, где владелец страницы свойств создает `CPropertyPage` объекты и передает их в страницу свойств с помощью [CPropertySheet:: addPage](../mfc/reference/cpropertysheet-class.md#addpage).

Существует множество вариантов пользовательского интерфейса, позволяющих определить, когда параметры немодальной страницы свойств должны быть применены к внешнему объекту. Одним из альтернативных способов является применение параметров текущей страницы свойств каждый раз, когда пользователь изменяет любое значение. Другой альтернативой является предоставление кнопки Apply, которая позволяет пользователю накапливать изменения на страницах свойств перед их фиксацией внешнему объекту. Сведения о способах обработки кнопки "Применить" см. в статье [Обработка кнопки "Применить"](../mfc/handling-the-apply-button.md).

## <a name="see-also"></a>См. также:

[Вкладки свойств](../mfc/property-sheets-mfc.md)<br/>
[Обмен данными](../mfc/exchanging-data.md)<br/>
[Работа с диалоговыми окнами в MFC](../mfc/life-cycle-of-a-dialog-box.md)
