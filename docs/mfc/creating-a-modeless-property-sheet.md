---
description: 'Дополнительные сведения: создание немодальной страницы свойств'
title: Создание безмодальной вкладки свойства
ms.date: 11/04/2016
helpviewer_keywords:
- modeless property sheets
- property sheets, modeless
- Create method [MFC], property sheets
ms.assetid: eafd8a92-cc67-4a69-a5fb-742c920d1ae8
ms.openlocfilehash: 1eaec55fe3c7c69ba558a10616dc2658025282d0
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97310061"
---
# <a name="creating-a-modeless-property-sheet"></a>Создание безмодальной вкладки свойства

Обычно создаваемые страницы свойств будут модальными. При использовании модальной страницы свойств пользователь должен закрыть страницу свойств перед использованием любой другой части приложения. В этой статье описываются методы, которые можно использовать для создания немодальной страницы свойств, позволяющей пользователю оставаться открытой на странице свойств при использовании других частей приложения.

Чтобы отобразить страницу свойств как немодальное диалоговое окно, а не как модальное диалоговое окно, вызовите метод [CPropertySheet:: Create](reference/cpropertysheet-class.md#create) вместо [DoModal](reference/cpropertysheet-class.md#domodal). Кроме того, необходимо реализовать некоторые дополнительные задачи для поддержки немодальной страницы свойств.

Одной из дополнительных задач является обмен данными между страницей свойств и внешним объектом, который он изменяет, когда открыта страница свойств. Обычно это та же задача, что и для стандартных немодальных диалоговых окон. Частью этой задачи является реализация канала связи между немодальной страницей свойств и внешним объектом, к которому применяются параметры свойств. Эта реализация гораздо проще, если вы наследуете класс от [CPropertySheet](reference/cpropertysheet-class.md) для немодальной страницы свойств. В этой статье предполагается, что вы сделали это.

Одним из способов связи между немодальной страницей свойств и внешним объектом (например, текущим выделением в представлении) является определение указателя из страницы свойств на внешний объект. Определите функцию (которая вызывает нечто вроде `SetMyExternalObject` ) в `CPropertySheet` классе, производном от, чтобы изменить указатель при каждом изменении фокуса с одного внешнего объекта на другой. `SetMyExternalObject`Функция должна сбросить параметры для каждой страницы свойств, чтобы отразить только что выбранный внешний объект. Для этого `SetMyExternalObject` функция должна иметь возможность доступа к объектам [CPropertyPage](reference/cpropertypage-class.md) , принадлежащим `CPropertySheet` классу.

Самый удобный способ предоставления доступа к страницам свойств на странице свойств заключается в внедрении `CPropertyPage` объектов в `CPropertySheet` объект, производный от. Внедрение `CPropertyPage` объектов в `CPropertySheet` производный объект отличается от типичного дизайна для модальных диалоговых окон, где владелец страницы свойств создает `CPropertyPage` объекты и передает их на страницу свойств через [CPropertySheet:: addPage](reference/cpropertysheet-class.md#addpage).

Существует множество вариантов пользовательского интерфейса, позволяющих определить, когда параметры немодальной страницы свойств должны быть применены к внешнему объекту. Одним из альтернативных способов является применение параметров текущей страницы свойств каждый раз, когда пользователь изменяет любое значение. Другой альтернативой является предоставление кнопки Apply, которая позволяет пользователю накапливать изменения на страницах свойств перед их фиксацией внешнему объекту. Сведения о способах обработки кнопки "Применить" см. в статье [Обработка кнопки "Применить"](handling-the-apply-button.md).

## <a name="see-also"></a>См. также раздел

[Вкладки свойств](property-sheets-mfc.md)<br/>
[Обмен данными](exchanging-data.md)<br/>
[Работа с диалоговыми окнами в MFC](life-cycle-of-a-dialog-box.md)
