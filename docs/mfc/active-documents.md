---
title: Активные документы
ms.date: 11/04/2016
helpviewer_keywords:
- active documents [MFC]
- active documents [MFC], requirements
- view objects [MFC], requirements
- OLE [MFC], active documents
- views [MFC], active documents
- active documents [MFC], views
ms.assetid: 1378f18e-aaa6-420b-8501-4b974905baa0
ms.openlocfilehash: e6f8161432cc951b5e224ec28142429efbdf0726
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50639664"
---
# <a name="active-documents"></a>Активные документы

Активные документы расширить составной документ технологии OLE. Эти расширения предоставляются в виде дополнительных интерфейсов, которые управляют представления, так что объекты могут работать в контейнерах и еще сохранить контроль над их отображения и печати функции. Этот процесс позволяет отображать документы внешнего кадров (например, Microsoft Office Binder или Microsoft Internet Explorer) и в кадрах машинного кода (например, просмотр портов продукта собственные).

В этом разделе описываются функционального [требования для активных документов](#requirements_for_active_documents). Активный документ является владельцем набора данных и имеет доступ к хранилищу, где можно сохранить и извлечь данные. Его можно создать и управлять один или несколько представлений его данных. В дополнение к поддержке обычные внедрения и интерфейсы встроенной активации документов OLE, активный документ взаимодействует его способность создавать представления через `IOleDocument`. Через этот интерфейс контейнера можно задать для создания (и возможно перечислить) представления, которые можно отобразить в активный документ. Через этот интерфейс активного документа можно также предоставляют различные сведения о себе, такие как поддержка нескольких представлений или сложных прямоугольники.

Ниже приведен `IOleDocument` интерфейс. Обратите внимание, что `IEnumOleDocumentViews` интерфейс — это стандартный перечислитель OLE для `IOleDocumentView*` типов.

```
interface IOleDocument : IUnknown
    {
    HRESULT CreateView(
        [in] IOleInPlaceSite *pIPSite,
        [in] IStream *pstm,
        [in] DWORD dwReserved,
        [out] IOleDocumentView **ppView);

    HRESULT GetDocMiscStatus([out] DWORD *pdwStatus);

    HRESULT EnumViews(
        [out] IEnumOleDocumentViews **ppEnum,
        [out] IOleDocumentView **ppView);
    }
```

Каждый активный документ должен быть поставщик фрейма представления с этим интерфейсом. Если документ не внедрен в контейнере, сам сервер активного документа необходимо предоставить фрейм представления. Тем не менее когда активный документ внедряется в контейнер активного документа, контейнер предоставляет фрейм представления.

Активного документа можно создать один или несколько типов [представления](#requirements_for_view_objects) данных (например, обычный, структуры, макета страницы и так далее). Представления действуют как фильтры, через которые можно увидеть данные. Даже если документ имеет только один тип представления, могут по-прежнему требуется поддерживать несколько представлений с точки зрения поддержки новой функциональности окна (например, **новое окно** товара **окно** меню в Office приложения).

##  <a name="requirements_for_active_documents"></a> Требования для активных документов

Активный документ, который может быть отображен в контейнер активного документа необходимо:

- Использовать файлов комплексной OLE в качестве механизма хранения путем реализации `IPersistStorage`.

- Поддерживают базовые возможности внедрения OLE документов, включая **создать из файла**. Это требуется открытое интерфейсы `IPersistFile`, `IOleObject`, и `IDataObject`.

- Поддерживают одно или несколько представлений, каждое из которых является возможность активации на месте. То есть представления должен поддерживать интерфейс `IOleDocumentView` а также интерфейсы `IOleInPlaceObject` и `IOleInPlaceActiveObject` (с помощью контейнера `IOleInPlaceSite` и `IOleInPlaceFrame` интерфейсов).

- Поддерживает интерфейсы стандартный активного документа `IOleDocument`, `IOleCommandTarget`, и `IPrint`.

В эти требования подразумевается знания, когда и как использовать интерфейсы стороне контейнера.

##  <a name="requirements_for_view_objects"></a> Требования для представления объектов

Активного документа можно создать одно или несколько представлений данных. С функциональной точки зрения эти представления похожи на порты на конкретный метод для отображения данных. Если в активном документе поддерживает только одно представление, активный документ и что одно представление может осуществляться с помощью одного класса. `IOleDocument::CreateView` Возвращает тот же объект `IOleDocumentView` указатель на интерфейс.

Представляются в контейнер активного документа, должен поддерживать компонента представления `IOleInPlaceObject` и `IOleInPlaceActiveObject` в дополнение к `IOleDocumentView`:

```
interface IOleDocumentView : IUnknown
    {
    HRESULT SetInPlaceSite([in] IOleInPlaceSite *pIPSite);
    HRESULT GetInPlaceSite([out] IOleInPlaceSite **ppIPSite);
    HRESULT GetDocument([out] IUnknown **ppunk);
    [input_sync] HRESULT SetRect([in] LPRECT prcView);
    HRESULT GetRect([in] LPRECT prcView);
    [input_sync] HRESULT SetRectComplex(
        [in] LPRECT prcView,
        [in] LPRECT prcHScroll,
        [in] LPRECT prcVScroll,
        [in] LPRECT prcSizeBox);
    HRESULT Show([in] BOOL fShow);
    HRESULT UIActivate([in] BOOL fUIActivate);
    HRESULT Open(void);
    HRESULT CloseView([in] DWORD dwReserved);
    HRESULT SaveViewState([in] IStream *pstm);
    HRESULT ApplyViewState([in] IStream *pstm);
    HRESULT Clone(
        [in] IOleInPlaceSite *pIPSiteNew,
        [out] IOleDocumentView **ppViewNew);
    }
```

Каждое представление имеет связанное представление сайта, который инкапсулирует фрейм представления и порта просмотра (HWND и прямоугольную область, в этом окне). Этот узел предлагает эту функцию, хотя стандарте `IOleInPlaceSite` интерфейс. Обратите внимание, что можно иметь более одного порта просмотра на один HWND.

Как правило каждый тип представления имеет другое представление печати. Таким образом представления и соответствующие сайты представления должны реализовывать интерфейсы печати если `IPrint` и `IContinueCallback`, соответственно. Фрейм представления должны согласовать с поставщиком представления через `IPrint` когда печать начинается, таким образом, заголовки, нижние колонтитулы, поля и связанные элементы будут напечатаны неправильно. Поставщик представления уведомляет рамки, связанные с печатью событий с помощью `IContinueCallback`. Дополнительные сведения об использовании этих интерфейсов см. в разделе [программный печати](../mfc/programmatic-printing.md).

Обратите внимание, что если активного документа поддерживает только одно представление, затем активного документа и что единое представление может осуществляться с помощью одного конкретного класса. `IOleDocument::CreateView` просто возвращает тот же объект `IOleDocumentView` указатель на интерфейс. Короче говоря нет необходимости, существует быть два экземпляра отдельный объект, когда требуется только одно представление.

Объект представления также может быть целевой объект команды. Путем реализации `IOleCommandTarget` представление может получать команды, расположенных в пользовательском интерфейсе контейнера (такие как **New**, **откройте**, **Сохранить как**,  **Печать** на **файл** меню; и **копирования**, **вставить**, **отменить** на **изменить** меню). Дополнительные сведения см. в разделе [обработка сообщений и цели команды](../mfc/message-handling-and-command-targets.md).

## <a name="see-also"></a>См. также

[Вложение активного документа](../mfc/active-document-containment.md)

