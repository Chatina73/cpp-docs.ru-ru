---
title: Добавление нескольких представлений в один документ
ms.date: 11/04/2016
helpviewer_keywords:
- multiple views [MFC], SDI applications
- documents [MFC], multiple views
- single document interface (SDI), adding views
- views [MFC], SDI applications
ms.assetid: 86d0c134-01d5-429c-b672-36cfb956dc01
ms.openlocfilehash: 4fa39a4d9369c84d2cffdaeff28dc9cb2f966b31
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370857"
---
# <a name="adding-multiple-views-to-a-single-document"></a>Добавление нескольких представлений в один документ

В приложении интерфейса с одним документом (SDI), созданном в библиотеке Microsoft Foundation Class (MFC), каждый тип документа связан с одним типом представления. В некоторых случаях желательно иметь возможность переключить текущее представление документа с новым представлением.

> [!TIP]
> Дополнительные процедуры по реализации нескольких представлений для одного документа см. [CDocument::AddView](../mfc/reference/cdocument-class.md#addview) и образец [COLLECT](../overview/visual-cpp-samples.md) MFC.

Эту функцию можно реализовать, `CView`добавив новый класс и дополнительный код для динамического переключения представлений в существующее приложение MFC.

Для этого необходимо выполнить следующие шаги:

- [Изменение существующего класса приложений](#vcconmodifyexistingapplicationa1)

- [Создание и изменение класса нового представления](#vcconnewviewclassa2)

- [Создание и присоединение нового представления](#vcconattachnewviewa3)

- [Реализация функции переключения](#vcconswitchingfunctiona4)

- [Добавление поддержки для переключения представления](#vcconswitchingtheviewa5)

Остальная часть этой темы предполагает следующее:

- Название `CWinApp`объекта, полученного, `CMyWinApp` `CMyWinApp` объявлено и определено в *MYWINAPP. H* и *MYWINAPP. CPP*.

- `CNewView`— это название `CView`объекта, полученного `CNewView` из нового, и объявляется и определяется в *NEWVIEW. H* и *NEWVIEW. CPP*.

## <a name="modify-the-existing-application-class"></a><a name="vcconmodifyexistingapplicationa1"></a>Изменение существующего класса приложений

Для переключения между представлениями приложений необходимо изменить класс приложения, добавив переменные для хранения представлений и способ их переключения.

Добавьте следующий код `CMyWinApp` в декларацию в *MYWINAPP. H*:

[!code-cpp[NVC_MFCDocViewSDI#1](../mfc/codesnippet/cpp/adding-multiple-views-to-a-single-document_1.h)]

Новые переменные `m_pOldView` члена, и, `m_pNewView`указать на текущее представление и вновь созданный. Новый метод`SwitchView`() переключает представления по запросу пользователя. Тело метода обсуждается позже в этой теме в [функции коммутации Implement](#vcconswitchingfunctiona4).

Последняя модификация класса приложений требует включения нового файла заголовка, который определяет сообщение Windows **(WM_INITIALUPDATE),** который используется в функции переключения.

Вставьте следующую строку в раздел *MYWINAPP. CPP*:

[!code-cpp[NVC_MFCDocViewSDI#2](../mfc/codesnippet/cpp/adding-multiple-views-to-a-single-document_2.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="create-and-modify-the-new-view-class"></a><a name="vcconnewviewclassa2"></a>Создание и изменение класса нового представления

Создание нового класса представления облегчается с помощью команды **Нового класса,** доступной из класса View. Единственным требованием для этого класса является `CView`то, что он происходит от . Добавьте этот новый класс в приложение. Для получения конкретной информации о добавлении нового класса в проект [см.](../ide/adding-a-class-visual-cpp.md)

После добавления класса в проект необходимо изменить доступность некоторых членов класса представления.

Измените *NEWVIEW. H,* изменяя спецификатор доступа от **защищенного** к **общедоступным** для конструктора и деструктора. Это позволяет создать и уничтожить класс динамически и изменить внешний вид представления до его появления.

Сохраните изменения и перейдите к следующему шагу.

## <a name="create-and-attach-the-new-view"></a><a name="vcconattachnewviewa3"></a>Создание и присоединение нового представления

Чтобы создать и прикрепить новое представление, необходимо изменить функцию `InitInstance` класса приложений. Изменение добавляет новый код, который создает новый `m_pOldView` объект `m_pNewView` представления, а затем инициализирует оба и с двумя существующими объектами представления.

Поскольку новое представление создается в функции, `InitInstance` как новые, так и существующие представления сохраняются в течение всего срока службы приложения. Тем не менее, приложение может так же легко создать новое представление динамически.

Вставьте этот код `ProcessShellCommand`после вызова:

[!code-cpp[NVC_MFCDocViewSDI#3](../mfc/codesnippet/cpp/adding-multiple-views-to-a-single-document_3.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="implement-the-switching-function"></a><a name="vcconswitchingfunctiona4"></a>Реализация функции переключения

На предыдущем этапе добавлен код, который создал и инициализировал новый объект представления. Последняя важная часть заключается в `SwitchView`реализации метода переключения, .

В конце файла реализации для вашего класса*приложений (MYWINAPP. CPP*), добавить следующее определение метода:

[!code-cpp[NVC_MFCDocViewSDI#4](../mfc/codesnippet/cpp/adding-multiple-views-to-a-single-document_4.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="add-support-for-switching-the-view"></a><a name="vcconswitchingtheviewa5"></a>Добавление поддержки для переключения представления

Заключительный шаг включает в себя `SwitchView` добавление кода, который вызывает метод, когда приложение должно переключаться между представлениями. Это можно сделать несколькими способами: либо добавив новый элемент меню для пользователя, чтобы выбрать или переключение представлений внутри, когда определенные условия выполнены.

Для получения дополнительной информации о добавлении новых элементов меню и функций обработчика команд см. [Обработчики для команд и уведомлений о контроле.](../mfc/handlers-for-commands-and-control-notifications.md)

## <a name="see-also"></a>См. также раздел

[Архитектура документов/просмотра](../mfc/document-view-architecture.md)
