---
title: Добавление нескольких представлений в один документ
ms.date: 11/04/2016
helpviewer_keywords:
- multiple views [MFC], SDI applications
- documents [MFC], multiple views
- single document interface (SDI), adding views
- views [MFC], SDI applications
ms.assetid: 86d0c134-01d5-429c-b672-36cfb956dc01
ms.openlocfilehash: 95de3a582c3d45db858e2b4bce0268e1dab63931
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87215976"
---
# <a name="adding-multiple-views-to-a-single-document"></a>Добавление нескольких представлений в один документ

В приложении с одним документом (SDI), созданном с помощью библиотеки Microsoft Foundation Class (MFC), каждый тип документа связан с одним типом представления. В некоторых случаях желательно иметь возможность переключения текущего представления документа на новое представление.

> [!TIP]
> Дополнительные процедуры по реализации нескольких представлений для одного документа см. в разделе [CDocument:: аддвиев](reference/cdocument-class.md#addview) и пример " [Получение](../overview/visual-cpp-samples.md) MFC".

Эту функцию можно реализовать, добавив новый `CView` класс, производный от, и дополнительный код для динамического переключения представлений в существующее приложение MFC.

Выполняются следующие шаги.

- [Изменение существующего класса приложения](#vcconmodifyexistingapplicationa1)

- [Создание и изменение нового класса представления](#vcconnewviewclassa2)

- [Создание и присоединение нового представления](#vcconattachnewviewa3)

- [Реализация функции переключения](#vcconswitchingfunctiona4)

- [Добавление поддержки для переключения представления](#vcconswitchingtheviewa5)

Оставшаяся часть этого раздела предполагает следующее:

- Имя `CWinApp` объекта, производного от, имеет значение `CMyWinApp` , а `CMyWinApp` объявляется и определяется в *мивинапп. H* и *мивинапп. CPP*.

- `CNewView`имя нового `CView` производного объекта, `CNewView` которое объявляется и определяется в *неввиев. H* и *неввиев. CPP*.

## <a name="modify-the-existing-application-class"></a><a name="vcconmodifyexistingapplicationa1"></a>Изменение существующего класса приложения

Чтобы приложение переключаться между представлениями, необходимо изменить класс приложения, добавив переменные-члены для хранения представлений и метод для их переключения.

Добавьте следующий код в объявление `CMyWinApp` в *мивинапп. З*:

[!code-cpp[NVC_MFCDocViewSDI#1](codesnippet/cpp/adding-multiple-views-to-a-single-document_1.h)]

Новые переменные члена `m_pOldView` и `m_pNewView` указывают на текущее и только что созданное представление. Новый метод ( `SwitchView` ) переключает представления по запросу пользователя. Тело метода обсуждается далее в этом разделе в статье [Реализация функции переключения](#vcconswitchingfunctiona4).

Последнее изменение класса приложения требует включения нового файла заголовка, определяющего сообщение Windows (**WM_INITIALUPDATE**), которое используется в функции переключения.

Вставьте следующую строку в раздел include раздела *мивинапп. CPP*:

[!code-cpp[NVC_MFCDocViewSDI#2](codesnippet/cpp/adding-multiple-views-to-a-single-document_2.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="create-and-modify-the-new-view-class"></a><a name="vcconnewviewclassa2"></a>Создание и изменение нового класса представления

Создание нового класса представления упрощается благодаря использованию **новой команды класса** , доступной из представление классов. Единственным требованием для этого класса является то, что он является производным от `CView` . Добавьте этот новый класс в приложение. Конкретные сведения о добавлении нового класса в проект см. в разделе [Добавление класса](../ide/adding-a-class-visual-cpp.md).

После добавления класса в проект необходимо изменить доступность некоторых членов класса представления.

Измените *неввиев. З* , изменив спецификатор доступа с **`protected`** на на **`public`** для конструктора и деструктора. Это позволяет динамически создавать и уничтожать класс, а также изменять внешний вид представления, прежде чем он станет видимым.

Сохраните изменения и перейдите к следующему шагу.

## <a name="create-and-attach-the-new-view"></a><a name="vcconattachnewviewa3"></a>Создание и присоединение нового представления

Чтобы создать и присоединить новое представление, необходимо изменить `InitInstance` функцию класса приложения. Изменение добавляет новый код, который создает новый объект представления, а затем инициализирует `m_pOldView` и `m_pNewView` с двумя существующими объектами представления.

Так как новое представление создается внутри `InitInstance` функции, новые и существующие представления сохраняются в течение времени существования приложения. Однако приложение может легко создать новое представление динамически.

Вставьте этот код после вызова `ProcessShellCommand` :

[!code-cpp[NVC_MFCDocViewSDI#3](codesnippet/cpp/adding-multiple-views-to-a-single-document_3.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="implement-the-switching-function"></a><a name="vcconswitchingfunctiona4"></a>Реализация функции переключения

На предыдущем шаге был добавлен код, который создал и инициализировал новый объект представления. Последним основным элементом является реализация метода коммутации, `SwitchView` .

В конце файла реализации для класса приложения (*мивинапп. CPP*), добавьте следующее определение метода:

[!code-cpp[NVC_MFCDocViewSDI#4](codesnippet/cpp/adding-multiple-views-to-a-single-document_4.cpp)]

Сохраните изменения и перейдите к следующему шагу.

## <a name="add-support-for-switching-the-view"></a><a name="vcconswitchingtheviewa5"></a>Добавление поддержки для переключения представления

Последний шаг включает добавление кода, который вызывает `SwitchView` метод, когда приложению необходимо переключаться между представлениями. Это можно сделать несколькими способами: путем добавления нового пункта меню для пользователя для выбора или переключения представлений внутренне при выполнении определенных условий.

Дополнительные сведения о добавлении новых пунктов меню и функций обработчика команд см. в разделе [обработчики для команд и Управление уведомлениями](handlers-for-commands-and-control-notifications.md).

## <a name="see-also"></a>См. также раздел

[Архитектура документа/представления](document-view-architecture.md)
