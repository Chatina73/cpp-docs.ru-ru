---
title: 'Объекты данных и источников данных: Манипуляции'
ms.date: 11/04/2016
helpviewer_keywords:
- data objects [MFC], manipulating
- data sources [MFC], data operations
- data sources [MFC], inserting data
- Clipboard [MFC], determining available formats
- OLE [MFC], data objects
- Clipboard [MFC], passing format information
- data sources [MFC], determining available formats
- delayed rendering [MFC]
- OLE [MFC], data sources
ms.assetid: f7f27e77-bb5d-4131-b819-d71bf929ebaf
ms.openlocfilehash: 81dfe911866c4d1ba1720ee2c9854076c499f0a3
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62241553"
---
# <a name="data-objects-and-data-sources-manipulation"></a>Объекты данных и источников данных: Манипуляции

После создания объекта данных или источник данных можно выполнить ряд определенных распространенные операции с данным, таких как вставка и удаление данных, перечисления форматов, ваши данные, и многое другое. В этой статье описаны методы, необходимые для выполнения наиболее распространенных операций. Ниже приведен список разделов.

- [Вставка данных в источник данных](#_core_inserting_data_into_a_data_source)

- [Определение форматов, доступных в объекте данных](#_core_determining_the_formats_available_in_a_data_object)

- [Извлечение данных из объекта данных](#_core_retrieving_data_from_a_data_object)

##  <a name="_core_inserting_data_into_a_data_source"></a> Вставка данных в источник данных

Как данные вставляются в источник данных зависит от того, ли данные, предоставляются немедленно или по требованию и в какой среде они передаются. Возможные значения — следующим образом.

### <a name="supplying-data-immediately-immediate-rendering"></a>Предоставление данных немедленно (немедленное подготовки отчетов)

- Вызовите `COleDataSource::CacheGlobalData` несколько раз для каждого формат буфера обмена, в которой указываются данные. Формат буфера обмена для использования, передайте дескриптор памяти, содержащий данные, возможно, **FORMATETC** структуры, описывающий данные.

     -или-

- Если требуется работать непосредственно с **STGMEDIUM** структуры, вы вызываете `COleDataSource::CacheData` вместо `COleDataSource::CacheGlobalData` в параметре выше.

### <a name="supplying-data-on-demand-delayed-rendering"></a>Предоставляет данные по требованию (отложенная отрисовка)

Это довольно сложная тема.

- Вызовите `COleDataSource::DelayRenderData` несколько раз для каждого формат буфера обмена, в которой указываются данные. Передайте формат буфера обмена для использования и, возможно, **FORMATETC** структуры, описывающий данные. При запросе данных, платформа вызывает `COleDataSource::OnRenderData`, который необходимо переопределить.

     -или-

- Если вы используете `CFile` объект в качестве источника данных, вызовите `COleDataSource::DelayRenderFileData` вместо `COleDataSource::DelayRenderData` в предыдущем варианте. При запросе данных, платформа вызывает `COleDataSource::OnRenderFileData`, который необходимо переопределить.

##  <a name="_core_determining_the_formats_available_in_a_data_object"></a> Определение форматов, доступных в объекте данных

Прежде чем приложение позволяет пользователю вставлять данные в него, его необходимо знать, если существует форматов в буфере обмена, который он может обработать. Для этого приложения следует сделайте следующее:

1. Создание `COleDataObject` объекта и **FORMATETC** структуры.

1. Вызовите объект данных `AttachClipboard` функция-член должен быть сопоставлен объект данных данные в буфере обмена.

1. Выполните одно из следующих действий.

   - Вызовите объект данных `IsDataAvailable` требуется функция-член, если имеется только один или два форматах. Это позволит сэкономить время в случаях, где данные в буфере обмена поддерживает форматы значительно больше, чем приложения.

         -or-

   - Вызовите объект данных `BeginEnumFormats` функция-член перечисление форматов данных в буфере обмена. Затем вызовите `GetNextFormat` до возврата буфера обмена ваше приложение поддерживает формат или что нет Дополнительные форматы.

Если вы используете **ON_UPDATE_COMMAND_UI**, теперь можно включить вставить и, возможно, Специальная вставка элементов в меню "Правка". Чтобы сделать это, вызовите `CMenu::EnableMenuItem` или `CCmdUI::Enable`. Дополнительные сведения о какой контейнер приложений следует сделать с помощью пунктов меню и когда, см. в разделе [меню и ресурсы: Добавление контейнеров](../mfc/menus-and-resources-container-additions.md).

##  <a name="_core_retrieving_data_from_a_data_object"></a> Извлечение данных из объекта данных

Если вы решите от формата данных, остается только для получения данных из объекта данных. Чтобы сделать это, пользователь решает, куда помещаются данные, и приложение вызывает соответствующую функцию. Данные будут доступны в одном из следующих носители:

|Средняя|Функция, вызываемая|
|------------|----------------------|
|Глобальная память (`HGLOBAL`)|`COleDataObject::GetGlobalData`|
|Файл (`CFile`)|`COleDataObject::GetFileData`|
|**STGMEDIUM** структуры (`IStorage`)|`COleDataObject::GetData`|

Обычно носитель должен указываться вместе с его формат буфера обмена. Например **CF_EMBEDDEDSTRUCT** объект всегда находится в `IStorage` носитель, который требует **STGMEDIUM** структуры. Таким образом, используется `GetData` так как это только один из этих функций, которые могут принимать **STGMEDIUM** структуры.

Для случаев, когда является формат буфера обмена в `IStream` или `HGLOBAL` среднего размера, можно предоставить платформу `CFile` указатель, который ссылается на данные. Приложение может затем использовать файл прочитать, чтобы получить данные во многом так же, как он может импортировать данные из файла. По сути, это клиентский интерфейс для `OnRenderData` и `OnRenderFileData` подпрограммы в источнике данных.

Пользователь может теперь вставки данных в документ так же, как для любых других данных, в том же формате.

### <a name="what-do-you-want-to-know-more-about"></a>Выберите для получения дополнительных сведений

- [Операции перетаскивания](../mfc/drag-and-drop-ole.md)

- [Буфер обмена](../mfc/clipboard.md)

## <a name="see-also"></a>См. также

[Объекты и источники данных (OLE)](../mfc/data-objects-and-data-sources-ole.md)<br/>
[Класс COleDataObject](../mfc/reference/coledataobject-class.md)<br/>
[Класс COleDataSource](../mfc/reference/coledatasource-class.md)
