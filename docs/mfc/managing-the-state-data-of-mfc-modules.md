---
title: Управление данными состояния модулей MFC
ms.date: 11/19/2018
helpviewer_keywords:
- global state [MFC]
- data management [MFC], MFC modules
- window procedure entry points [MFC]
- exported interfaces and global state [MFC]
- module states [MFC], saving and restoring
- data management [MFC]
- MFC, managing state data
- multiple modules [MFC]
- module state restored [MFC]
ms.assetid: 81889c11-0101-4a66-ab3c-f81cf199e1bb
ms.openlocfilehash: 0cdb368dc70b73ba70b3721fecdaf47de36686d5
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57293801"
---
# <a name="managing-the-state-data-of-mfc-modules"></a>Управление данными состояния модулей MFC

В этой статье обсуждаются данные состояния модулей MFC и как это состояние будет обновлено, когда поток выполнения (в коде объекта path принимает с помощью приложения при выполнении) и покидает его модуля. Переключение состояния модулей с макросами AFX_MANAGE_STATE и METHOD_PROLOGUE также рассматривается.

> [!NOTE]
>  Термин «модуль» здесь обозначает исполняемую программу или DLL (или набор библиотек DLL), независимо от остальной части приложения, но использует общий копию библиотеки DLL MFC. Элемент управления ActiveX — типичный пример модуля.

Как показано на следующем рисунке, MFC предоставляет данные о состоянии для каждого модуля, используемые в приложениях. Эти данные относятся дескрипторы экземпляров Windows (используется для загрузки ресурсов), указатели на текущий `CWinApp` и `CWinThread` объектов приложения, счетчики ссылок модуля OLE и набор схем, которые поддерживают соединения между Windows объект дескрипторы и соответствующие экземпляры объектов MFC. Тем не менее, когда приложение использует несколько модулей, данные о состоянии каждого модуля не приложение ширину. Вместо этого каждый модуль содержит личную копию данных состояния в MFC.

![Данные для одного модуля состояния &#40;приложения&#41;](../mfc/media/vc387n1.gif "данные для одного модуля состояния &#40;приложения&#41;") <br/>
Данные состояния для отдельного модуля (приложение)

Данные о состоянии модуля содержатся в структуре и всегда доступен через указатель на этой структуре. Когда поток выполнения вводит определенного модуля, как показано на рисунке ниже, состояние этого модуля должно иметь состояние «current» или «эффективных». Таким образом каждый поток объект имеет указатель на структуру действующие состояния этого приложения. Сохранение этого указателя, обновляться раз является управление глобальное состояние приложения и поддержание целостности состояния каждого модуля. Неправильное управление глобальное состояние может привести к непредсказуемое поведение приложения.

![Данные из нескольких модулей состояния](../mfc/media/vc387n2.gif "данные из нескольких модулей состояния") <br/>
Данными состояния нескольких модулей

Другими словами каждый модуль отвечает за правильно переключения между состояниями модуля вообще его точки входа. «Точка входа» – это любое место, где потока выполнения, можно ввести код модуля. Ниже перечислены точки входа.

- [Экспортированные функции в библиотеке DLL](../mfc/exported-dll-function-entry-points.md)

- [Функции-члены интерфейсов COM.](../mfc/com-interface-entry-points.md)

- [Процедуры окна](../mfc/window-procedure-entry-points.md)

## <a name="see-also"></a>См. также

[Общие разделы по MFC](../mfc/general-mfc-topics.md)
