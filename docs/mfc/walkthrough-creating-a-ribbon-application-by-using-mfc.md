---
title: Пошаговое руководство. Создание приложения с лентой с помощью MFC
ms.date: 09/09/2019
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 41084a78287521610ba400deab32d1052c9217c1
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907396"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>Пошаговое руководство. Создание приложения с лентой с помощью MFC

В этом пошаговом руководстве показано, как с помощью **мастера приложений MFC** создать приложение с лентой по умолчанию. Затем можно развернуть ленту, добавив **настраиваемую** категорию ленты с панелью **"Избранное"** , а затем добавив на панель несколько часто используемых команд.

## <a name="prerequisites"></a>Предварительные требования

В этом пошаговом руководстве предполагается, что вы настроили Visual Studio для использования **общих параметров разработки**. Если вы используете разные параметры, некоторые из элементов пользовательского интерфейса, на которые имеются ссылки в следующих инструкциях, могут не отображаться.

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>Создание приложения MFC с лентой

1. Используйте **Мастер приложений MFC** для создания приложения MFC с лентой. См. [Пошаговое руководство: Использование новых элементов управления](walkthrough-using-the-new-mfc-shell-controls.md) оболочки MFC для получения инструкций о том, как открыть мастер для вашей версии Visual Studio.

1. Задайте следующие параметры в **мастере приложений MFC**.

    1. В разделе **Тип приложения** в разделе **стиль оформления и цвета**выберите **Office 2007 (синяя тема)** .

    1. В разделе **Поддержка составных документов** убедитесь, что не выбрано **значение нет** .

    1. В разделе **Свойства шаблона документа** в поле **расширение файла** введите расширение имени файла для документов, создаваемых этим приложением, например *мфкрбнапп*.

    1. В разделе **Поддержка базы данных** (только для Visual Studio 2015) убедитесь, что флажок **нет** установлен.

    1. В разделе **функции пользовательского интерфейса** убедитесь, что выбран параметр **использовать ленту** .

    1. По умолчанию **Мастер приложений MFC** добавляет поддержку нескольких закрепляемых областей. Поскольку в этом руководстве рассматривается только лента, эти компоненты можно удалить из приложения. В разделе **Дополнительные функции** снимите флажок все параметры.

1. Нажмите кнопку **Готово** , чтобы создать приложение MFC.

1. Чтобы убедиться, что приложение успешно создано, соберите и запустите его. Чтобы выполнить сборку приложения, в меню **Сборка** выберите пункт **построить решение**. Если приложение успешно строится, запустите его, выбрав команду **начать отладку** в меню **Отладка** .

    Мастер автоматически создаст ленту с одной категорией ленты с именем **Home**. Эта лента содержит три панели ленты, которые называются " **буфер обмена**", " **вид**" и " **окно**".

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>Добавление категории и панели на ленту

1. Чтобы открыть созданный мастером ресурс ленты, в меню **вид** выберите **другие окна** , а затем щелкните **представление ресурсов**. В **представление ресурсов**щелкните **Лента** , а затем дважды щелкните **IDR_RIBBON**.

1. Сначала добавьте пользовательскую категорию на ленту, дважды щелкнув **категорию** на **панели элементов**.

    Создается категория с заголовком **Category1** . По умолчанию категория содержит одну панель.

    Щелкните правой кнопкой мыши **Category1** и выберите пункт **свойства**. В окне **Свойства** измените **заголовок** на *Пользовательский*.

    Свойства **крупные изображения** и **небольшие изображения** задают растровые изображения, используемые в качестве значков для элементов ленты в этой категории. Поскольку создание пользовательских точечных рисунков выходит за рамки этого руководства, просто используйте точечные рисунки, созданные мастером. Маленькие точечные рисунки имеют размер 16 пикселей на 16 пикселей. Для небольших изображений используйте точечные рисунки, к которым обращается `IDB_FILESMALL` идентификатор ресурса. Большие точечные рисунки имеют размер 32 пикселей на 32 пикселей. Для больших изображений используйте точечные рисунки, к которым обращается `IDB_FILELARGE` идентификатор ресурса.

    > [!NOTE]
    > На HDPI-мониторах автоматически используются HDPI-версии изображений.

1. Теперь необходимо настроить панель. Панели используются для группирования элементов, логически связанных друг с другом. Например, на вкладке " **Главная** " этого приложения команды " **Вырезать**", " **Копировать**" и " **Вставить** " находятся на панели **буфера обмена** . Чтобы настроить панель, щелкните правой кнопкой мыши **Panel1** и выберите пункт **свойства**. В окне **Свойства** измените **заголовок** на *Избранное*.

    Можно указать **индекс изображения** для панели. Этот номер указывает значок, отображаемый при добавлении панели ленты на **панель быстрого доступа**. Значок не отображается на панели ленты.

1. Чтобы убедиться, что категория и панель ленты успешно созданы, просмотрите элемент управления "лента". На **панели инструментов редактора ленты**нажмите кнопку **Тестовая лента** . На ленте должна отобразиться **Пользовательская** вкладка и панель **избранного** .

### <a name="to-add-elements-to-the-ribbon-panels"></a>Добавление элементов на панели ленты

1. Чтобы добавить элементы на панель, созданную в предыдущей процедуре, перетащите элементы управления из раздела **Редактор ленты** на **панели элементов** на панель в представлении конструктора.

1. Сначала добавьте кнопку **Печать** . Кнопка **Печать** будет содержать подменю, содержащее команду **быстрой печати** , которая выводит на печать с помощью принтера по умолчанию. Обе эти команды уже определены для этого приложения. Они находятся в меню приложения.

    Чтобы создать кнопку « **Печать** », перетащите инструмент Button на панель.

    В окне " **Свойства** " измените значение свойства **ID** на **ID_FILE_PRINT**, которое уже должно быть определено. Измените **заголовок** на *Печать*. Измените значение **индекса образа** на *4*.

    Чтобы создать кнопку **быстрой печати** , щелкните столбец значение свойства рядом с **элементами меню**, а затем нажмите кнопку с многоточием ( **...** ). В **редакторе элементов**нажмите кнопку **Добавить** без метки, чтобы создать пункт меню. В окне **Свойства** измените **заголовок** на *Быстрая печать*, **идентификатор** на *ID_FILE_PRINT_DIRECT*и **изображение** на *5*. Свойство Image указывает значок **быстрой печати** в `IDB_FILESMALL` ресурсе точечного рисунка.

1. Чтобы убедиться, что кнопки добавлены на панель ленты, соберите приложение и запустите его. Чтобы выполнить сборку приложения, в меню **Сборка** выберите пункт **построить решение**. Если приложение успешно строится, запустите его, выбрав команду **начать отладку** в меню **Отладка** . Будет отображена кнопка **Печать** и поле со списком на панели **Избранное** на вкладке **Настройка** ленты.

## <a name="next-steps"></a>Следующие шаги

[Практическое руководство. Настройка панели быстрого доступа](../mfc/how-to-customize-the-quick-access-toolbar.md)

[Практическое руководство. Настройка кнопки приложения](../mfc/how-to-customize-the-application-button.md)

Комплексные примеры см. в разделе [образцы (пакет дополнительных компонентов MFC)](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также

[Пошаговые руководства](../mfc/walkthroughs-mfc.md)<br/>
[Образцы (пакет дополнительных компонентов MFC)](../overview/visual-cpp-samples.md)
