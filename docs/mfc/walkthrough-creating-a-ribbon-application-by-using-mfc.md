---
title: Пошаговое руководство. Создание приложения ленты с помощью MFC
ms.date: 11/04/2016
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 29991a389a09e1fe3dc0074b80fd9a255458f673
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58781228"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>Пошаговое руководство. Создание приложения ленты с помощью MFC

В этом пошаговом руководстве показано, как использовать **мастер приложений MFC** для создания приложения с лентой, по умолчанию. Ленты можно развернуть, добавив **Custom** категорией, которая имеет **"Избранное"** ленте панели, а затем добавив некоторые часто используемые команды на панель.

## <a name="prerequisites"></a>Предварительные требования

В этом пошаговом руководстве предполагается, что установки Visual Studio для использования **обычные параметры разработки**. Если вы используете другие параметры, некоторые элементы пользовательского интерфейса (UI), которые упоминаются в приведенных ниже инструкциях может не отображаться.

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>Создание приложения MFC с лентой

1. Используйте **мастер приложений MFC** Создание приложения MFC с лентой. Чтобы запустить мастер, на **файл** последовательно выберите пункты **New**и нажмите кнопку **проекта**.

1. В **новый проект** диалогового окна последовательно раскройте элементы **Visual C++** в узле **установленные шаблоны**выберите **MFC**, а затем выберите  **Приложения MFC**. Например, введите имя проекта, *MFCRibbonApp*, а затем нажмите кнопку **ОК**.

1. Задать следующие параметры **мастер приложений MFC**:

    1. В **тип приложения** раздела **визуальный стиль и цвета**выберите **Office 2007 (синяя тема)**.

    1. В **поддержка составных документов** разделе, убедитесь, что **None** выбран.

    1. В **свойства шаблона документа** раздела **расширение файла** введите расширение имени файла для документов, создаваемых этим приложением, например, *mfcrbnapp*.

    1. В **Поддержка баз данных** разделе, убедитесь, что **None** выбран.

    1. В **возможностей пользовательского интерфейса** разделе, убедитесь, что **использовать ленту** выбран.

    1. По умолчанию **мастер приложений MFC** добавляет поддержку нескольких закрепляемых областей. Поскольку в этом руководстве рассматривается только лента, эти компоненты можно удалить из приложения. В **дополнительные функции** снимите все параметры.

1. Нажмите кнопку **Готово** для создания приложения MFC.

1. Чтобы убедиться, что приложение успешно создано, соберите и запустите его. Для построения приложения, на **построения** меню, щелкните **построить решение**. Если сборка приложения прошла успешно, запустите его, выбрав **начать отладку** на **Отладка** меню.

    Мастер автоматически создает ленту с одной категорией, которая называется **Главная**. Эта лента содержит три панели ленты, которые называются **буфер обмена**, **представление**, и **окно**.

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>Добавление категории и панели на ленту

1. Чтобы открыть ресурс ленты, мастер создания **представление** последовательно выберите пункты **Other Windows** и нажмите кнопку **представление ресурсов**. В **представление ресурсов**, нажмите кнопку **ленты** и дважды щелкните **IDR_RIBBON**.

1. Сначала добавьте на ленту пользовательскую категорию, дважды щелкнув **категории** в **элементов**.

    Категории с заголовком **Категория1** создается. По умолчанию категория содержит одну панель.

    Щелкните правой кнопкой мыши **Категория1** и нажмите кнопку **свойства**. В **свойства** измените **заголовок** для *Custom*.

    **Больших изображений** и **маленькие изображения** задают точечные рисунки, используются в качестве значков для элементов ленты в этой категории. Поскольку создание пользовательских точечных рисунков выходит за рамки этого руководства, просто используйте точечные рисунки, созданные мастером. Маленькие точечные рисунки имеют размер 16 пикселей на 16 пикселей. Для небольших изображений используйте точечные рисунки, используемые `IDB_FILESMALL` идентификатор ресурса. Большие точечные рисунки имеют размер 32 пикселей на 32 пикселей. Используйте больших изображений точечные рисунки, осуществляется по `IDB_FILELARGE` идентификатор ресурса.

    > [!NOTE]
    > На HDPI-мониторах автоматически используются HDPI-версии изображений.

1. Теперь необходимо настроить панель. Панели используются для группирования элементов, логически связанных друг с другом. Например, на **Главная** вкладке этого приложения **Вырезать**, **копирования**, и **вставить** команды, находятся на  **Буфер обмена** панели. Чтобы настроить панель, щелкните правой кнопкой мыши **Panel1** и нажмите кнопку **свойства**. В **свойства** измените **заголовок** для *"Избранное"*.

    Можно указать **индекс образа** для панели. Это число определяет значок, отображаемый, если добавляется на панель ленты **быстрого доступа**. На самой панели ленты значок не отображается.

1. Чтобы убедиться, что категория и панель ленты успешно созданы, просмотрите элемент управления "лента". На **панели инструментов редактора ленты**, нажмите кнопку **проверить ленту** кнопки. Объект **Custom** вкладку и **"Избранное"** панели должны отображаться на ленте.

### <a name="to-add-elements-to-the-ribbon-panels"></a>Добавление элементов на панели ленты

1. Чтобы добавить элементы на панель, созданную в предыдущей процедуре, перетащите элементы управления из **редактора ленты** раздел **элементов** панели в представлении конструирования.

1. Во-первых, добавьте **печати** кнопки. **Печати** кнопка будет иметь подменю, содержащее **Быстрая печать** команду, которая выводит на принтер по умолчанию. Обе эти команды уже определены для этого приложения. Они находятся в меню приложения.

    Чтобы создать **печати** "Кнопка", перетащите на панель инструмент "Кнопка".

    В **свойства** измените **идентификатор** свойства **ID_FILE_PRINT**, который должен быть уже определена. Изменение **заголовок** для *печати*. Изменение **изображения индекс** для *4*.

    Чтобы создать **Быстрая печать** "Кнопка", щелкните столбец значения свойства рядом с полем **пунктов меню**и нажмите кнопку с многоточием (**...** ). В **редактор элементов**, нажмите неподписанную **добавить** кнопку, чтобы создать элемент меню. В **свойства** измените **заголовок** для *Быстрая печать*, **идентификатор** для *ID_FILE_PRINT_DIRECT*, и **изображение** для *5*. Указывает свойство image **Быстрая печать** значок в `IDB_FILESMALL` точечного рисунка ресурса.

1. Чтобы убедиться, что кнопки добавлены на панель ленты, соберите приложение и запустите его. Для построения приложения, на **построения** меню, щелкните **построить решение**. Если сборка приложения прошла успешно, запустите приложение, выбрав **начать отладку** на **Отладка** меню. **Печати** кнопки и поля со списком поле **"Избранное"** на панели **Custom** должны отображаться на вкладке ленты.

## <a name="next-steps"></a>Следующие шаги

[Практическое руководство. Настройка панели быстрого доступа](../mfc/how-to-customize-the-quick-access-toolbar.md)

[Практическое руководство. Настройка кнопки приложения](../mfc/how-to-customize-the-application-button.md)

End-to-end примеры, см. в разделе [примеры (пакет компонентов MFC)](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также

[Пошаговые руководства](../mfc/walkthroughs-mfc.md)<br/>
[Примеры (пакет компонентов MFC)](../overview/visual-cpp-samples.md)
