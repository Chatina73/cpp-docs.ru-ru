---
title: Элементы управления ActiveX в MFC. Методы
ms.date: 11/04/2016
helpviewer_keywords:
- MFC ActiveX controls [MFC], methods
ms.assetid: e20271de-6ffa-4ba0-848b-bafe6c9e510c
ms.openlocfilehash: 9f9ec06852ed0376583363df7649331a0be02105
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84621240"
---
# <a name="mfc-activex-controls-methods"></a>Элементы управления ActiveX в MFC. Методы

Элемент управления ActiveX запускает события для взаимодействия между собой и контейнером элемента управления. Контейнер также может взаимодействовать с элементом управления с помощью методов и свойств. Методы также называются функциями.

Методы и свойства предоставляют экспортированный интерфейс для использования другими приложениями, такими как клиенты автоматизации и контейнеры элементов управления ActiveX. Дополнительные сведения о свойствах элементов управления ActiveX см. в статье [элементы управления ActiveX в MFC: свойства](mfc-activex-controls-properties.md).

Методы похожи на использование и предназначены для функций-членов класса C++. Существует два типа методов, которые может реализовать ваш элемент управления: акции и пользовательские. Как и в случае с финансовыми событиями, акции — это методы, для которых [COleControl](reference/colecontrol-class.md) предоставляет реализацию. Дополнительные сведения о методах хранения см. в статье [элементы управления ActiveX в MFC: Добавление методов акции](mfc-activex-controls-adding-stock-methods.md). Пользовательские методы, определяемые разработчиком, позволяют выполнять дополнительную настройку элемента управления. Дополнительные сведения см. в статье [элементы управления ActiveX в MFC: Добавление пользовательских методов](mfc-activex-controls-adding-custom-methods.md).

В библиотека Microsoft Foundation Class (MFC) реализован механизм, позволяющий элементу управления поддерживать акции и пользовательские методы. Первая часть — класс `COleControl` . `CWnd`Функции элементов, производные от, `COleControl` поддерживают стандартные методы для всех элементов управления ActiveX. Второй частью этого механизма является схема диспетчеризации. Схема диспетчеризации аналогична схеме сообщений. Однако вместо сопоставления функции с ИДЕНТИФИКАТОРом сообщения Windows, карта диспетчеризации сопоставляет виртуальные функции-члены с ИДЕНТИФИКАТОРами IDispatch.

Чтобы элемент управления поддерживал различные методы должным образом, его класс должен объявить карту диспетчеризации. Это выполняется с помощью следующей строки кода, расположенной в заголовке класса Control (. H) файл:

[!code-cpp[NVC_MFC_AxUI#13](codesnippet/cpp/mfc-activex-controls-methods_1.h)]

Основная цель схемы диспетчеризации — установить связь между именами методов, используемыми внешним вызывающим объектом (например, контейнером), и функциями-членами класса элемента управления, реализующими методы. После объявления схемы диспетчеризации ее необходимо определить в реализации элемента управления (. CPP). Следующие строки кода определяют карту диспетчеризации:

[!code-cpp[NVC_MFC_AxUI#14](codesnippet/cpp/mfc-activex-controls-methods_2.cpp)]
[!code-cpp[NVC_MFC_AxUI#15](codesnippet/cpp/mfc-activex-controls-methods_3.cpp)]

Если для создания проекта использовался [Мастер элементов ActiveX MFC](reference/mfc-activex-control-wizard.md) , эти строки были добавлены автоматически. Если мастер элементов ActiveX MFC не использовался, необходимо добавить эти строки вручную.

В следующих статьях подробно рассматриваются методы:

- [Элементы ActiveX в MFC. Добавление стандартных методов](mfc-activex-controls-adding-stock-methods.md)

- [Элементы ActiveX в MFC. Добавление пользовательских методов](mfc-activex-controls-adding-custom-methods.md)

- [Элементы управления ActiveX в MFC. Возврат кодов ошибок из метода](mfc-activex-controls-returning-error-codes-from-a-method.md)

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](mfc-activex-controls.md)
