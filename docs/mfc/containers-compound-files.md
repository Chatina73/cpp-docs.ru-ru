---
title: Контейнеры. Составные файлы
ms.date: 11/04/2016
helpviewer_keywords:
- compound files [MFC]
- compound documents
- containers [MFC], compound files
- OLE documents [MFC], compound files
- performance [MFC], compound files
- files [MFC], compound
- standardized file structure compound files
- documents [MFC], compound
- documents [MFC], OLE
- OLE containers [MFC], compound files
- access modes for files [MFC]
ms.assetid: 8b83cb3e-76c8-4bbe-ba16-737092b36f49
ms.openlocfilehash: 5a8ba0821d92ab41a4b95fb7b2a26da63c1df285
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50643275"
---
# <a name="containers-compound-files"></a>Контейнеры. Составные файлы

В этой статье описаны компоненты и реализации составных файлов, а также их преимущества и недостатки использования составных файлов в приложениях OLE.

Составные файлы являются неотъемлемой частью OLE. Они используются для упрощения передачи данных и хранилище документов OLE. Составные файлы представляет собой реализацию модели Active структурированного хранилища. Согласованных интерфейсов существует, поддерживают сериализацию для хранилища, потока или объекта файла. Составные файлы поддерживаются классы в библиотеке Microsoft Foundation Class `COleStreamFile` и `COleDocument`.

> [!NOTE]
>  С помощью составного файла не означает, что данные поступают из документа OLE или составной документ. Составные файлы являются одним из способов для хранения составных документов OLE-документы и другие данные.

##  <a name="_core_components_of_a_compound_file"></a> Компоненты составного файла

Реализация OLE составных файлов использует три типа объектов: объекты потока, объекты хранилища, и `ILockBytes` объектов. Эти объекты похожи на компоненты Стандартная файловая система одним из следующих способов:

- Stream объекты, такие как файлы, хранить данные любого типа.

- Объекты хранилища, такие как каталоги, могут содержать другие хранения и потоковые объекты.

- `LockBytes` объекты представляют собой интерфейс между объектами хранилища и физическим оборудованием. Они определяют, как фактические байты написаны на любом устройстве хранения `LockBytes` объект обращается к, такие как жесткий диск или область глобальной памяти. Дополнительные сведения о `LockBytes` объектов и `ILockBytes` интерфейсом, см. в разделе *справочнике программиста OLE*.

##  <a name="_core_advantages_and_disadvantages_of_compound_files"></a> Преимущества и недостатки составные файлы

Составные файлы предоставить преимущества доступны не для предыдущих методов хранилища файлов. В их число входят следующее.

- Доступ к добавочные файл.

- Файл режимы доступа.

- Стандартизация структуры файлов.

Потенциальные недостатки составные файлы — крупные проблемы размером и производительностью, связанных с хранением на дисковод гибких дисков, должно быть продуманным when решите, следует ли использовать их в своем приложении.

###  <a name="_core_incremental_access_to_files"></a> Добавочные доступ к файлам

Добавочные доступ к файлам — это программа автоматического использования составных файлов. Так как составной файл можно рассматривать как «файловая система в файле», отдельные типы объектов, такие как поток или хранилище, может осуществляться без необходимости загрузки всего файла. Время приложения требуется доступ к новые объекты для редактирования пользователем, можно значительно уменьшить. Добавочное обновление, на основе на то же самое, аналогичные преимущества в отношении предложения. Вместо сохранения файла всего лишь для того, чтобы сохранить изменения, внесенные в один объект OLE сохраняет только поток или хранилище объект изменено пользователем.

###  <a name="_core_file_access_modes"></a> Режимы доступа для файла

Вы можете определить, когда изменения объектов в составном файле не записаны на диск — это другое преимущество использования составных файлов. Режим, в котором файлам, либо с поддержкой транзакций, либо напрямую, определяет, при фиксации изменений.

- Режиме транзакций использует операцию двухфазной фиксации для изменения объектов в составном файле, оставив старые и новые копии документа доступны, пока пользователь решает сохранить или отменить изменения.

- Прямой режим включает изменения в документе, как они выполняются, если отсутствует возможность отменить их позже.

Дополнительные сведения о режимах доступа см. в разделе *справочнике программиста OLE*.

###  <a name="_core_standardization"></a> Стандартизация

Стандартизированные структура составных файлов позволяет различных приложений OLE Просмотр составных файлов, создаваемых приложением OLE не имея сведений приложения, в котором был создан файл.

###  <a name="_core_size_and_performance_considerations"></a> Размер и вопросы производительности

Из-за сложности составной файл структуры хранилища, а также для сохранения данных постепенно, файлы, используя следующий формат, как правило, еще больше, чем других файлов с помощью неструктурированных или хранения данных «неструктурированный файл». Если приложение часто загружает и сохраняет файлы, с помощью составных файлов может привести к размер файла, чтобы увеличить гораздо быстрее, чем noncompound файлы. Поскольку составные файлы могут иметь большой объем, время доступа для файлов хранятся на и загрузки с дискеты также может быть изменено, приводит к замедлению доступа к файлам.

Еще одна проблема, которая влияет на производительность — составного файл фрагментации. Размер составного файла определяется разницу между секторов первый и последний диска, используемую в файле. Фрагментированный файл может содержать множество области свободного пространства, которые не содержат данных, но учитываются при вычислении размера. В течение времени существования составной файл эти области создаются путем вставки или удаления объектов хранилища.

##  <a name="_core_using_compound_files_format_for_your_data"></a> С помощью составных файлов формата данных

После успешного создания приложения, производный от класса документов `COleDocument`, убедиться, что ваш конструктор основного документа вызывает `EnableCompoundFile`. Когда мастер приложения создает OLE-приложения контейнера, этот вызов вставляется автоматически.

В *справочнике программиста OLE*, см. в разделе [IStream](/windows/desktop/api/objidl/nn-objidl-istream), [IStorage](/windows/desktop/api/objidl/nn-objidl-istorage), и [ILockBytes](/windows/desktop/api/objidl/nn-objidl-ilockbytes).

## <a name="see-also"></a>См. также

[Контейнеры](../mfc/containers.md)<br/>
[Контейнеры. Проблемы пользовательского интерфейса](../mfc/containers-user-interface-issues.md)<br/>
[Класс COleStreamFile](../mfc/reference/colestreamfile-class.md)<br/>
[Класс COleDocument](../mfc/reference/coledocument-class.md)
