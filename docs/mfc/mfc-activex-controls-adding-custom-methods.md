---
title: Элементы управления ActiveX в MFC. Добавление пользовательских методов
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], methods
- PtInCircle custom method [MFC]
ms.assetid: 8f8dc344-44a0-4021-8db5-4cdd3d700e18
ms.openlocfilehash: 88d486248eab5d980463764db34bf40b05b830dc
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364715"
---
# <a name="mfc-activex-controls-adding-custom-methods"></a>Элементы управления ActiveX в MFC. Добавление пользовательских методов

Пользовательские методы отличаются от методов акции `COleControl`тем, что они еще не реализованы . Необходимо предоставить реализацию для каждого пользовательского метода, который вы добавляете к элементу управления.

>[!IMPORTANT]
> ActiveX является устаревшей технологией, которая не должна использоваться для новых разработок. Для получения дополнительной информации о современных технологиях, которые заменяли ActiveX, [см.](activex-controls.md)

Пользователь управления ActiveX может вызвать пользовательский метод в любое время для выполнения контрольных действий. Запись на карту отправки для пользовательских методов имеет форму DISP_FUNCTION.

## <a name="adding-a-custom-method-with-the-add-method-wizard"></a><a name="_core_adding_a_custom_method_with_classwizard"></a>Добавление пользовательского метода с мастером метода добавления

Следующая процедура демонстрирует добавление пользовательского метода PtInCircle в код скелета управления ActiveX. PtInCircle определяет, находятся ли координаты, передаваемые элементу управления внутри или за пределами круга. Эта же процедура также может быть использована для добавления других пользовательских методов. Замените имя пользовательского метода и его параметры для имени и параметров метода PtInCircle.

> [!NOTE]
> В этом `InCircle` примере используется функция из статьи События. Для получения дополнительной информации об этой функции смотрите статью [MFC ActiveX Controls: Добавление пользовательских событий в ActiveX Control](../mfc/mfc-activex-controls-adding-custom-events.md).

#### <a name="to-add-the-ptincircle-custom-method-using-the-add-method-wizard"></a>Добавление пользовательского метода PtInCircle с помощью мастера метода добавления

1. Загрузите проект управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. Из меню ярлыка, нажмите **Добавить,** а затем нажмите **Добавить метод**.

   Это открывает мастер метода добавления.

1. В поле **Имя метода** введите *PtInCircle*.

1. В поле **Внутреннего Имен** введите имя внутренней функции метода или используйте значение по умолчанию (в данном случае *PtInCircle).*

1. В поле **Return Type** нажмите **VARIANT_BOOL** для типа возврата метода.

1. Используя элементуправления **типа параметра** и **названия параметров,** добавьте параметр, называемый *xCoord* (тип *OLE_XPOS_PIXELS).*

1. Используя элемент управления **типом параметра** и **название параметра,** добавьте параметр под названием *yCoord* (тип *OLE_YPOS_PIXELS).*

1. Нажмите кнопку **Готово**.

## <a name="add-method-wizard-changes-for-custom-methods"></a><a name="_core_classwizard_changes_for_custom_methods"></a>Добавить изменения мастера метода для пользовательских методов

При добавлении пользовательского метода мастер метода добавления вносит некоторые изменения в заголовок класса управления (. H) и реализации (. CPP) файлы. Следующая строка добавляется в декларацию карты отправки в заголовке класса управления (. H) файл:

[!code-cpp[NVC_MFC_AxUI#18](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_1.h)]

Этот код объявляет обработчик `PtInCircle`метода отправки под названием . Эта функция может быть вызвана пользователем `PtInCircle`управления, используя внешнее имя.

Следующая строка добавляется к элементу управления. IDL файл:

[!code-cpp[NVC_MFC_AxUI#19](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_2.idl)]

Эта строка `PtInCircle` присваивает методу определенный идентификационный номер, положение метода в методах и свойствах Add Method. Поскольку мастер метода добавления использовался для добавления пользовательского метода, запись для него была автоматически добавлена в проект. IdL файл.

Кроме того, следующая строка, расположенная в реализации (. CPP) файл класса управления, добавляется на карту диспетчерской карты управления:

[!code-cpp[NVC_MFC_AxUI#20](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_3.cpp)]

В DISP_FUNCTION макрокарт `PtInCircle` метода к функции `PtInCircle`обработчика управления, объявляет тип возврата, чтобы быть **VARIANT_BOOL,** и `PtInCircle`объявляет два параметра типа **VTS_XPOS_PIXELS** и **VTS_YPOSPIXELS,** которые должны быть переданы.

Наконец, мастер метода добавления добавляет функцию `CSampleCtrl::PtInCircle` заглушки в нижнюю часть реализации элемента управления (. CPP) файл. Для `PtInCircle` того, чтобы функционировать, как указано ранее, он должен быть изменен следующим образом:

[!code-cpp[NVC_MFC_AxUI#21](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-methods_4.cpp)]

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Значки просмотра классов и объектного браузера](/visualstudio/ide/class-view-and-object-browser-icons)
