---
title: Меню и ресурсы. Добавление серверов
ms.date: 11/04/2016
helpviewer_keywords:
- OLE visual editing servers [MFC]
- accelerator tables [MFC], server applications
- visual editing [MFC], application menus and resources
- server applications [MFC], accelerator table
- string tables [MFC], visual editing applications
- servers [MFC], menu additions
- resources [MFC], server applications
- OLE server applications [MFC], menus and resources
- string editing [MFC], visual editing applications
- IDP_OLE_INIT_FAILED macro [MFC]
- server applications [MFC], OLE menus and resources
- OLE initialization failure [MFC]
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
ms.openlocfilehash: f67212dc7d4e2ab90421c7b2eee48acae4745940
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626186"
---
# <a name="menus-and-resources-server-additions"></a>Меню и ресурсы. Добавление серверов

В этой статье описываются изменения, которые необходимо внести в меню и другие ресурсы в приложении Visual Editing Server (компонент). Серверное приложение требует много дополнений к структуре меню и другим ресурсам, так как ее можно запустить в одном из трех режимов: автономной, встроенной или на месте. Как описано в разделе [меню и ресурсы (OLE)](menus-and-resources-ole.md) , существует не более четырех наборов меню. Все четыре используются для многосерверного приложения MDI, в то время как для минисервер используются только три. Мастер приложений создаст макет меню, необходимый для требуемого типа сервера. Может потребоваться выполнить некоторые настройки.

Если мастер приложений не используется, возможно, вы захотите ознакомиться с HIERSVR. RC, скрипт ресурсов для примера приложения MFC [HIERSVR](../overview/visual-cpp-samples.md), чтобы увидеть, как эти изменения реализуются.

В этой статье рассматриваются следующие темы:

- [Добавления меню "сервер"](#_core_server_menu_additions)

- [Добавление таблицы сочетаний клавиш](#_core_server_application_accelerator_table_additions)

- [Добавление таблицы строк](menus-and-resources-container-additions.md)

- [Дополнения минисервер](#_core_mini.2d.server_additions)

## <a name="server-menu-additions"></a><a name="_core_server_menu_additions"></a>Добавления меню "сервер"

Для поддержки визуального редактирования OLE-приложений в приложениях сервера (компонента) должны быть добавлены ресурсы меню. Меню, используемые при запуске приложения в автономном режиме, не нужно изменять, но перед созданием приложения необходимо добавить два новых ресурса меню: один для поддержки встроенной активации, а другой для поддержки полностью открытого сервера. Оба ресурса меню используются приложениями Full-and минисервер.

- Для поддержки встроенной активации необходимо создать ресурс меню, который очень похож на ресурс меню, используемый при запуске в изолированном режиме. Разница в этом меню заключается в том, что файлы и элементы окон (и любые другие пункты меню, которые работают с приложением, а не данные) отсутствуют. Приложение контейнера будет предоставлять эти пункты меню. Дополнительные сведения о, а также пример этой методики слияния меню см. в меню [и ресурсах](menus-and-resources-menu-merging.md)статьи.

- Для поддержки полностью открытых активаций необходимо создать ресурс меню почти аналогично ресурсу меню, используемому при работе в автономном режиме. Единственное изменение в этом ресурсе меню состоит в том, что некоторые элементы переносятся в несколько слов, чтобы отразить тот факт, что сервер работает на элементе, внедренном в составной документ.

В дополнение к изменениям, перечисленным в этой статье, файл ресурсов должен включать АФКСОЛЕСВ. Версия-кандидат, необходимый для реализации библиотека Microsoft Foundation Class. Этот файл находится в подкаталоге Мфк\инклуде.

## <a name="server-application-accelerator-table-additions"></a><a name="_core_server_application_accelerator_table_additions"></a>Добавление таблицы Server Application Accelerator

В серверные приложения необходимо добавить два новых ресурса таблицы ускорителя. они непосредственно соответствуют новым ресурсам меню, описанным выше. Первая таблица сочетаний клавиш используется, когда серверное приложение активировано на месте. Он состоит из всех записей в таблице сочетаний клавиш представления, за исключением тех, которые привязаны к меню файл и окно.

Вторая таблица является практически точной копией таблицы сочетаний клавиш представления. Все различия в параллельных изменениях, внесенных в полностью открытое меню, упомянутые в [дополнениях к меню сервера](#_core_server_menu_additions).

Чтобы получить пример этих изменений в таблице сочетаний клавиш, Сравните IDR_HIERSVRTYPE_SRVR_IP и IDR_HIERSVRTYPE_SRVR_EMB таблицы сочетаний клавиш с IDR_MAINFRAME в HIERSVR. RC-файл, который входит в пример MFC OLE для примера [HIERSVR](../overview/visual-cpp-samples.md). Ускорители файлов и окон отсутствуют в таблице на месте, и их точные копии находятся во внедренной таблице.

## <a name="string-table-additions-for-server-applications"></a><a name="_core_string_table_additions_for_server_applications"></a>Добавление строк таблицы для серверных приложений

В серверном приложении требуется только одно добавление строковых таблиц — строка, означающая, что инициализация OLE не удалась. Ниже приведен пример записи в таблице строк, создаваемой мастером приложений.

|ID|Строка|
|--------|------------|
|IDP_OLE_INIT_FAILED|Не удалось инициализировать OLE. Убедитесь, что используются правильные версии библиотек OLE.|

## <a name="miniserver-additions"></a><a name="_core_mini.2d.server_additions"></a>Дополнения минисервер

Одни и те же дополнения применяются для минисерверс, как описано выше для полных серверов. Так как минисервер не может быть запущен в изолированном режиме, его главное меню намного меньше. Главное меню, созданное мастером приложений, содержит только меню файл, в котором содержатся только элементы выход и о программе. Встроенные и встроенные меню и ускорители для минисерверс одинаковы для всех серверов.

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](menus-and-resources-ole.md)<br/>
[Меню и ресурсы. Слияние меню](menus-and-resources-menu-merging.md)
