---
title: 'Меню и ресурсы: Добавление серверов'
ms.date: 11/04/2016
f1_keywords:
- IDP_OLE_INIT_FAILED
helpviewer_keywords:
- OLE visual editing servers [MFC]
- accelerator tables [MFC], server applications
- visual editing [MFC], application menus and resources
- server applications [MFC], accelerator table
- string tables [MFC], visual editing applications
- servers [MFC], menu additions
- resources [MFC], server applications
- OLE server applications [MFC], menus and resources
- string editing [MFC], visual editing applications
- IDP_OLE_INIT_FAILED macro [MFC]
- server applications [MFC], OLE menus and resources
- OLE initialization failure [MFC]
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
ms.openlocfilehash: 0cf5b495ca1e3f6e7b0ae434c09e014a29eadb00
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57281960"
---
# <a name="menus-and-resources-server-additions"></a>Меню и ресурсы: Добавление серверов

В этой статье объясняется изменения, которые должны быть выполнены на меню и другие ресурсы в приложении visual редактирования server (компонент). Серверное приложение требует много добавлений к структуре меню и другие ресурсы, так как он может быть запущен в одном из трех режимов: выделить отдельно, внедренные, или на месте. Как описано в разделе [меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md) статьи, существует более четырех наборов меню. Все четыре используются для полносерверные приложения MDI, в то время как для miniserver используются только три. Мастер приложений создаст макет меню необходимые для типа сервера. Некоторые настройки может потребоваться.

Если вы не используете мастер приложений, можно рассмотреть HIERSVR. Версия-Кандидат, сценарий ресурсов для примера приложения MFC [HIERSVR](../visual-cpp-samples.md), чтобы увидеть, как реализованы эти изменения.

В этой статье рассматриваются:

- [Добавление серверов меню](#_core_server_menu_additions)

- [Дополнения таблицы сочетаний клавиш](#_core_server_application_accelerator_table_additions)

- [Строка таблицы дополнения](../mfc/menus-and-resources-container-additions.md)

- [Дополнения miniserver](#_core_mini.2d.server_additions)

##  <a name="_core_server_menu_additions"></a> Добавление серверов меню

Приложения сервера (компонент), должны иметь ресурсы меню, добавленные для поддержки визуального редактирования OLE. Меню, используемых при запуске приложения в автономном режиме не нужно изменить, но до начала создания приложения необходимо добавить два новых ресурсов меню: один для поддержки активации на месте и один для поддержки на сервере или полностью открытыми. Full - и miniserver приложениями используются оба ресурса меню.

- Для поддержки активации на месте, необходимо создать ресурс меню, которая очень похожа на ресурс меню, используемую при выполнении в автономном режиме. В этом меню разница, что отсутствуют элементы файла и окно (и все другие пункты меню, которые имеют дело с приложения, а не данных). Приложение-контейнер будет поддерживать эти пункты меню. Дополнительные сведения о и пример, эта методика слияние меню, см. в статье [меню и ресурсы: Слияние меню](../mfc/menus-and-resources-menu-merging.md).

- Для поддержки полностью открытыми активации, необходимо создать ресурс меню практически идентичен меню ресурс, используемый при запуске в изолированном режиме. Единственное изменение, этот ресурс меню —, чтобы отразить тот факт, что сервер работает на элемент, внедренных в составном документе изменена формулировка некоторые элементы.

Помимо изменений, описанных в этой статье в файл ресурсов должен включать AFXOLESV. Версия-Кандидат, которая необходима для реализации библиотеки классов Microsoft Foundation. Этот файл расположен в подкаталоге MFC\Include.

##  <a name="_core_server_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш для сервера приложений

Необходимо добавить два новых ресурсов таблицы сочетаний клавиш для сервера приложений; они соответствуют непосредственно к новому ресурсу меню описано выше. В первой таблице сочетаний клавиш используется при активации приложения сервера на месте. Он состоит из всех записей в таблице сочетаний клавиш для этого представления, за исключением того, связанные в файл и меню.

Во второй таблице — это почти точная копия этого представления таблицы сочетаний клавиш. Все различия параллельные изменения, внесенные в полностью открыть меню, упомянутые в [Добавление меню серверов](#_core_server_menu_additions).

Например, эти изменения таблицы сочетаний клавиш Сравните IDR_HIERSVRTYPE_SRVR_IP и IDR_HIERSVRTYPE_SRVR_EMB таблицы сочетаний клавиш с IDR_MAINFRAME в HIERSVR. RC-файл, включенный в пример MFC OLE [HIERSVR](../visual-cpp-samples.md). Ускорители файл и окна отсутствуют в таблице на месте и являются точными копиями внедренные таблицы.

##  <a name="_core_string_table_additions_for_server_applications"></a> Строка таблицы дополнения для серверных приложений

В серверном приложении необходима только одна строка таблицы сложения — строку для обозначения того, что не удалось выполнить инициализацию OLE. Например вот запись таблицу строк, созданный мастером приложений:

|Идентификатор|Строка|
|--------|------------|
|IDP_OLE_INIT_FAILED|Не удалось инициализировать OLE. Убедитесь в наличии правильной версии библиотек OLE.|

##  <a name="_core_mini.2d.server_additions"></a> Дополнения miniserver

Применить же дополнения для miniservers перечисленными выше для full серверов. Поскольку miniserver могут работать в автономном режиме, его главное меню – намного меньше. В главном меню, создаваемый мастером приложений есть только меню файл, содержащий только те элементы завершения и около. Внедренные и на месте меню и сочетания клавиш для miniservers одинаковы как для полной серверов.

## <a name="see-also"></a>См. также

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Меню и ресурсы: Слияние меню](../mfc/menus-and-resources-menu-merging.md)
