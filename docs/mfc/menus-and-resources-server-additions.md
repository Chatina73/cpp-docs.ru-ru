---
title: Меню и ресурсы. Добавление серверов
ms.date: 11/04/2016
helpviewer_keywords:
- OLE visual editing servers [MFC]
- accelerator tables [MFC], server applications
- visual editing [MFC], application menus and resources
- server applications [MFC], accelerator table
- string tables [MFC], visual editing applications
- servers [MFC], menu additions
- resources [MFC], server applications
- OLE server applications [MFC], menus and resources
- string editing [MFC], visual editing applications
- IDP_OLE_INIT_FAILED macro [MFC]
- server applications [MFC], OLE menus and resources
- OLE initialization failure [MFC]
ms.assetid: 56ce9e8d-8f41-4db8-8dee-e8b0702d057c
ms.openlocfilehash: 8366cd8b0376766b7914c94a24cef6598761a805
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375979"
---
# <a name="menus-and-resources-server-additions"></a>Меню и ресурсы. Добавление серверов

В этой статье объясняется изменения, которые необходимо внести в меню и другие ресурсы в приложении сервера визуального редактирования (компонента). Серверное приложение требует много дополнений к структуре меню и другим ресурсам, поскольку его можно запустить в одном из трех режимов: отдельно, встроено или на месте. Как описано в статье [Меню и Ресурсы (OLE),](../mfc/menus-and-resources-ole.md) существует максимум четыре набора меню. Все четыре используются для полносерверного приложения MDI, в то время как только три используются для мини-сервера. Мастер приложения создаст макет меню, необходимый для типа сервера, который вы хотите. Может потребоваться некоторая настройка.

Если вы не используете мастера приложения, вы можете посмотреть на HIERSVR. RC, скрипт ресурса для mFC образца приложения [HIERSVR](../overview/visual-cpp-samples.md), чтобы увидеть, как эти изменения реализуются.

Темы, затронутые в этой статье, включают:

- [Дополнения меню сервера](#_core_server_menu_additions)

- [Дополнения таблицы акселератора](#_core_server_application_accelerator_table_additions)

- [Дополнения строки таблицы](../mfc/menus-and-resources-container-additions.md)

- [Минисервер Дополнения](#_core_mini.2d.server_additions)

## <a name="server-menu-additions"></a><a name="_core_server_menu_additions"></a>Дополнения меню сервера

Серверные (компонентные) приложения должны иметь ресурсы меню, добавленные для поддержки визуального редактирования OLE. Меню, используемые при запуске приложения в автономном режиме, не должны быть изменены, но перед созданием приложения необходимо добавить два новых ресурса меню: один для поддержки активации на месте и один для поддержки полностью открытого сервера. Оба ресурса меню используются приложениями с полным и минисервером.

- Для поддержки активации на месте необходимо создать ресурс меню, очень похожий на ресурс меню, используемый при работе в автономном режиме. Разница в этом меню заключается в том, что элементы файла и окна (и любые другие элементы меню, которые имеют дело с приложением, а не данные) отсутствуют. Контейнерное приложение будет поставлять эти пункты меню. Для получения дополнительной информации и пример, этот метод слияния [Menus and Resources: Menu Merging](../mfc/menus-and-resources-menu-merging.md)меню, см.

- Чтобы поддерживать полностью открытую активацию, необходимо создать ресурс меню, почти идентичный ресурсу меню, используемому при запуске в автономном режиме. Единственное изменение этого ресурса меню состоит в том, что некоторые элементы переформулированы, чтобы отразить тот факт, что сервер работает на элементе, встроенном в сложный документ.

В дополнение к изменениям, перечисленным в этой статье, ваш файл ресурсов должен включать AFXOLESV. RC, который необходим для реализации библиотеки класса Microsoft Foundation. Этот файл находится в субдиректоре MFC.Включите.

## <a name="server-application-accelerator-table-additions"></a><a name="_core_server_application_accelerator_table_additions"></a>Добавления в таблицу ускорителя серверных приложений

Два новых ресурса таблицы акселератора должны быть добавлены в серверные приложения; они непосредственно соответствуют ранее описанным ресурсам меню. Первая таблица ускорителей используется при активации серверного приложения. Он состоит из всех записей в таблице акселератора представления, за исключением тех, которые привязаны к меню файла и окна.

Вторая таблица представляет собой почти точную копию таблицы ускорителя представления. Любые различия параллельные изменения, внесенные в полностью открытое меню, упомянутое в [дополнениях меню серверов.](#_core_server_menu_additions)

Для примера этих изменений таблицы акселератора сравните таблицы IDR_HIERSVRTYPE_SRVR_IP и IDR_HIERSVRTYPE_SRVR_EMB с IDR_MAINFRAME в HIERSVR. RC файл, включенный в mFC OLE образца [HIERSVR](../overview/visual-cpp-samples.md). Ускорители файлов и окон отсутствуют в таблице на месте, а точные их копии находятся во встроенной таблице.

## <a name="string-table-additions-for-server-applications"></a><a name="_core_string_table_additions_for_server_applications"></a>Дополнения строки таблицы для приложений сервера

В серверном приложении необходимо только одно дополнение строки, чтобы обозначить, что инициализация OLE не сработала. В качестве примера можно привести запись строки, которую генерирует мастер приложения:

|ID|Строка|
|--------|------------|
|IDP_OLE_INIT_FAILED|Инициализация OLE не удалась. Убедитесь, что библиотеки OLE являются правильной версией.|

## <a name="miniserver-additions"></a><a name="_core_mini.2d.server_additions"></a>Минисервер Дополнения

Те же дополнения применяются для минисерверов, как те, перечисленные выше для полных серверов. Поскольку минисервер не может работать в автономном режиме, его основное меню намного меньше. Основное меню, созданное мастером приложения, содержит только меню файлов, содержащее только элементы Exit and About. Встроенные и на месте меню и ускорители для минисерверов такие же, как и для полных серверов.

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Меню и ресурсы. Слияние меню](../mfc/menus-and-resources-menu-merging.md)
