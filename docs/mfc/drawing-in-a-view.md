---
title: Рисование в представлении
ms.date: 11/04/2016
helpviewer_keywords:
- drawing [MFC], in views
- views [MFC], printing
- views [MFC], updating
- printing [MFC], views
- views [MFC], rendering
- printing views [MFC]
- paint messages in view class [MFC]
- device contexts, screen drawings
ms.assetid: e3761db6-0f19-4482-a4cd-ac38ef7c4d3a
ms.openlocfilehash: c60d99fdebcd64ad844bc19918a30beb90b86af3
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84618939"
---
# <a name="drawing-in-a-view"></a>Рисование в представлении

Почти все рисунки в приложении происходят в `OnDraw` функции элемента представления, которую необходимо переопределить в классе представления. (Исключение — прорисовка мыши, как описано в разделе [Интерпретация вводимых пользователем данных с помощью представления](interpreting-user-input-through-a-view.md).) `OnDraw`Переопределение:

1. Получает данные путем вызова предоставляемых функций элементов документа.

1. Отображает данные, вызывая функции-члены объекта контекста устройства, в который передается платформа `OnDraw` .

Когда данные документа каким-либо образом изменяются, представление необходимо перерисовать, чтобы отразить изменения. Как правило, это происходит, когда пользователь вносит изменения через представление документа. В этом случае представление вызывает функцию элемента [UpdateAllViews](reference/cdocument-class.md#updateallviews) документа, чтобы уведомлять все представления в том же документе, чтобы обновить себя. `UpdateAllViews`вызывает функцию члена [OnUpdate](reference/cview-class.md#onupdate) для каждого представления. Реализация по умолчанию `OnUpdate` делает недействительным всю клиентскую область представления. Его можно переопределить, чтобы сделать недействительными только те регионы клиентской области, которые соответствуют измененным частям документа.

`UpdateAllViews`Функция Member класса `CDocument` и `OnUpdate` функция члена класса `CView` позволяют передавать сведения, описывающие, какие части документа были изменены. Этот механизм "Подсказка" позволяет ограничить область, которую должно перерисовываться в представлении. `OnUpdate`принимает два аргумента "указание". Первый, *лхинт*, типа **lParam**, позволяет передавать любые данные, а второе, *финт*, типа `CObject` *, позволяет передавать указатель на любой объект, производный от `CObject` .

Если представление станет недопустимым, Windows отправляет его **WM_PAINT** сообщение. Функция обработчика [onpain](reference/cwnd-class.md#onpaint) представления реагирует на сообщение путем создания объекта контекста устройства класса [кпаинтдк](reference/cpaintdc-class.md) и вызывает `OnDraw` функцию-член представления. Обычно не требуется писать `OnPaint` функцию обработчика переопределения.

[Контекст устройства](device-contexts.md) — это структура данных Windows, которая содержит сведения об атрибутах рисования устройства, такого как экран или принтер. Все вызовы рисования выполняются через объект контекста устройства. Для рисования на экране `OnDraw` передается `CPaintDC` объект. Для рисования на принтере ему передается объект [CDC](reference/cdc-class.md) , настроенный для текущего принтера.

Код для рисования в представлении сначала получает указатель на документ, а затем выполняет вызовы рисования через контекст устройства. В следующем простом `OnDraw` примере показан процесс:

[!code-cpp[NVC_MFCDocView#1](codesnippet/cpp/drawing-in-a-view_1.cpp)]

В этом примере вы определите `GetData` функцию как член класса производного документа.

В этом примере выводится строка, которую он получает из документа, по центру представления. Если `OnDraw` вызов предназначен для рисования на экране, то `CDC` объект, переданный в *PDC* , является, `CPaintDC` конструктор которого уже вызывался `BeginPaint` . Вызовы функций рисования выполняются через указатель контекста устройства. Сведения о контекстах устройств и вызовах рисования см. в разделе класс [CDC](reference/cdc-class.md) в *справочнике MFC* и [Работа с объектами Window](working-with-window-objects.md).

Дополнительные примеры написания см `OnDraw` . в разделе [примеры MFC](../overview/visual-cpp-samples.md#mfc-samples).

## <a name="see-also"></a>См. также раздел

[Использование представлений](using-views.md)
