---
title: Рисование в представлении
ms.date: 11/04/2016
helpviewer_keywords:
- drawing [MFC], in views
- views [MFC], printing
- views [MFC], updating
- printing [MFC], views
- views [MFC], rendering
- printing views [MFC]
- paint messages in view class [MFC]
- device contexts, screen drawings
ms.assetid: e3761db6-0f19-4482-a4cd-ac38ef7c4d3a
ms.openlocfilehash: 227c4614bad42706893301c69882c3f40af12e2f
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80214348"
---
# <a name="drawing-in-a-view"></a>Рисование в представлении

Почти все рисунки в приложении происходят в функции члена `OnDraw` представления, которую необходимо переопределить в классе представления. (Исключение — прорисовка мыши, как описано в разделе [Интерпретация вводимых пользователем данных с помощью представления](../mfc/interpreting-user-input-through-a-view.md).) Переопределение `OnDraw`:

1. Получает данные путем вызова предоставляемых функций элементов документа.

1. Отображает данные, вызывая функции-члены объекта контекста устройства, который платформа передает в `OnDraw`.

Когда данные документа каким-либо образом изменяются, представление необходимо перерисовать, чтобы отразить изменения. Как правило, это происходит, когда пользователь вносит изменения через представление документа. В этом случае представление вызывает функцию элемента [UpdateAllViews](../mfc/reference/cdocument-class.md#updateallviews) документа, чтобы уведомлять все представления в том же документе, чтобы обновить себя. `UpdateAllViews` вызывает функцию члена [OnUpdate](../mfc/reference/cview-class.md#onupdate) для каждого представления. Реализация `OnUpdate` по умолчанию делает недействительным всю клиентскую область представления. Его можно переопределить, чтобы сделать недействительными только те регионы клиентской области, которые соответствуют измененным частям документа.

Функция члена `UpdateAllViews` класса `CDocument` и `OnUpdate` функции Member класса `CView` позволяют передавать сведения, описывающие, какие части документа были изменены. Этот механизм "Подсказка" позволяет ограничить область, которую должно перерисовываться в представлении. `OnUpdate` принимает два аргумента "указание". Первый, *лхинт*, тип **lParam**, позволяет передавать любые данные, а второе, *финт*, типа `CObject`*, позволяет передавать указатель на любой объект, производный от `CObject`.

Если представление станет недопустимым, Windows отправляет его **WM_PAINT** сообщение. Функция обработчика [onpain](../mfc/reference/cwnd-class.md#onpaint) представления реагирует на сообщение путем создания объекта контекста устройства класса [кпаинтдк](../mfc/reference/cpaintdc-class.md) и вызывает функцию-член `OnDraw` представления. Обычно нет необходимости писать переопределение функции обработчика `OnPaint`.

[Контекст устройства](../mfc/device-contexts.md) — это структура данных Windows, которая содержит сведения об атрибутах рисования устройства, такого как экран или принтер. Все вызовы рисования выполняются через объект контекста устройства. Для рисования на экране `OnDraw` передается объект `CPaintDC`. Для рисования на принтере ему передается объект [CDC](../mfc/reference/cdc-class.md) , настроенный для текущего принтера.

Код для рисования в представлении сначала получает указатель на документ, а затем выполняет вызовы рисования через контекст устройства. Следующий простой `OnDraw` пример иллюстрирует процесс:

[!code-cpp[NVC_MFCDocView#1](../mfc/codesnippet/cpp/drawing-in-a-view_1.cpp)]

В этом примере вы определите `GetData` функцию как член класса производного документа.

В этом примере выводится строка, которую он получает из документа, по центру представления. Если `OnDraw` вызов предназначен для рисования на экране, объект `CDC`, переданный в *PDC* , является `CPaintDC`, конструктор которого уже вызвал `BeginPaint`. Вызовы функций рисования выполняются через указатель контекста устройства. Сведения о контекстах устройств и вызовах рисования см. в разделе класс [CDC](../mfc/reference/cdc-class.md) в *справочнике MFC* и [Работа с объектами Window](../mfc/working-with-window-objects.md).

Дополнительные примеры написания `OnDraw`см. в разделе [примеры MFC](../overview/visual-cpp-samples.md#mfc-samples).

## <a name="see-also"></a>См. также раздел

[Использование представлений](../mfc/using-views.md)
