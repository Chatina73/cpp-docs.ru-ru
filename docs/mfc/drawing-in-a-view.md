---
title: Рисование в представлении
ms.date: 11/04/2016
helpviewer_keywords:
- drawing [MFC], in views
- views [MFC], printing
- views [MFC], updating
- printing [MFC], views
- views [MFC], rendering
- printing views [MFC]
- paint messages in view class [MFC]
- device contexts, screen drawings
ms.assetid: e3761db6-0f19-4482-a4cd-ac38ef7c4d3a
ms.openlocfilehash: bc461347b56379976cdf62014507e3a15529f081
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62408030"
---
# <a name="drawing-in-a-view"></a>Рисование в представлении

Почти все рисования в приложении происходит в представлении `OnDraw` функция-член, который необходимо переопределить в классе представления. (Исключением является мыши рисования, рассматриваемые в [интерпретации пользователя входных данных через представление](../mfc/interpreting-user-input-through-a-view.md).) Ваш `OnDraw` переопределить:

1. Получает данные путем вызова функции-члены вами документ.

1. Отображает данные путем вызова функции-члены объекта контекста устройства, который передает framework `OnDraw`.

При изменении данных документа иным образом, чтобы отразить изменения необходимо перерисовать представления. Как правило это происходит, когда пользователь вносит изменение через представление документа. В этом случае представление вызывает документа [UpdateAllViews](../mfc/reference/cdocument-class.md#updateallviews) функция-член для уведомления о всех представлений в одном документе систему обновлять саму себя. `UpdateAllViews` вызывает каждое представление [OnUpdate](../mfc/reference/cview-class.md#onupdate) функция-член. Реализация по умолчанию `OnUpdate` делает недействительной всю клиентскую область представления. Вы можете переопределить его, чтобы сделать недействительным только те области клиентской области, которые сопоставляются измененные части документа.

`UpdateAllViews` Функция-член класса `CDocument` и `OnUpdate` функция-член класса `CView` позволяют передавать сведения, описывающие, какие части документа были изменены. Этот механизм «подсказка» позволяет ограничить область, представлении должен перерисовать. `OnUpdate` принимает два аргумента «подсказка». Во-первых, *lHint*, типа **LPARAM**, позволяет передать все данные, вам нравится, а для второго, *pHint*, типа `CObject`*, позволяет передать указатель на любой объект, производный из `CObject`.

Когда представление становится недействительным, Windows отправляет его **WM_PAINT** сообщения. Представления [OnPaint](../mfc/reference/cwnd-class.md#onpaint) обработчик — функция отвечает на сообщение, создав объект контекста устройства класса [CPaintDC](../mfc/reference/cpaintdc-class.md) и вызывает вашего представления `OnDraw` функция-член. У вас нет обычно записываемый переопределения `OnPaint` функция обработчика.

Объект [контекста устройства](../mfc/device-contexts.md) — это структура данных Windows, содержащий сведения о атрибутов рисования устройства, такие как экран или принтер. Все вызовы рисования выполняются через объект контекста устройства. Для рисования на экране `OnDraw` передается `CPaintDC` объекта. Для рисования на принтере, он передается [CDC](../mfc/reference/cdc-class.md) объект для текущего принтера.

Рисование в представлении кода сначала извлекает указатель на документ, а затем выполняет вызовы рисования через контекст устройства. Следующий простой `OnDraw` пример иллюстрирует этот процесс:

[!code-cpp[NVC_MFCDocView#1](../mfc/codesnippet/cpp/drawing-in-a-view_1.cpp)]

В этом примере необходимо определить `GetData` членов, документ производного класса.

В примере выводится любых строк, получаемый от документа, по центру представления. Если `OnDraw` будет на рисование экрана `CDC` переданный объект *pDC* — `CPaintDC` , конструктор которого уже вызван `BeginPaint`. Вызовы рисования функции выполняются через указатель контекста устройства. Сведения о контекстах устройств и вызовы рисования, см. в разделе класса [CDC](../mfc/reference/cdc-class.md) в *Справочник по библиотеке MFC* и [работа с объектами окон](../mfc/working-with-window-objects.md).

Дополнительные примеры создания `OnDraw`, см. в разделе [примеры MFC](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также

[Использование представлений](../mfc/using-views.md)
