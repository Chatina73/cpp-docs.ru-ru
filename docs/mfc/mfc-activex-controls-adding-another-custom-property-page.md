---
title: Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств
ms.date: 11/04/2016
helpviewer_keywords:
- property pages [MFC], MFC ActiveX controls
- custom property pages [MFC]
- ActiveX controls [MFC], property pages
- MFC ActiveX controls [MFC], property pages
ms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af
ms.openlocfilehash: 02c87c2c5283b7293c2a7ab028ec9a2abbba2b33
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364744"
---
# <a name="mfc-activex-controls-adding-another-custom-property-page"></a>Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств

Иногда элемент управления ActiveX будет иметь больше свойств, чем может разумно поместиться на одной странице свойств. В этом случае можно добавить страницы свойств в управление ActiveX для отображения этих свойств.

В этой статье обсуждается добавление новых страниц свойств в элемент управления ActiveX, который уже имеет по крайней мере одну страницу свойств. Для получения дополнительной информации о добавлении страниц свойств акций (шрифт, изображение или цвет), см. статью [MFC ActiveX Controls: Использование страниц фондового свойства](../mfc/mfc-activex-controls-using-stock-property-pages.md).

В следующих процедурах используется образец системы управления ActiveX, созданный Мастером управления ActiveX. Таким образом, имена классов и идентификаторы уникальны для этого примера.

Для получения дополнительной информации об использовании страниц свойств в элементе управления ActiveX см.

- [Элементы ActiveX в MFC. Страницы свойств](../mfc/mfc-activex-controls-property-pages.md)

- [Элементы ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)

    > [!NOTE]
    >  Настоятельно рекомендуется, чтобы новые страницы свойств соответствовали стандарту размера для страниц свойств управления ActiveX. Страницы фондового изображения и цветового свойства измеряют 250x62 единиц диалогов (DLU). Стандартная страница свойства шрифта 250x110 DLUs. Страница свойств по умолчанию, созданная Мастером управления ActiveX, использует стандарт DLU 250x62.

### <a name="to-insert-a-new-property-page-template-into-your-project"></a>Вставить новый шаблон страницы свойств в проект

1. С открытым проектом управления, открыть вид ресурсов в рабочей области проекта.

1. Нажмите в ресурсе View, чтобы открыть меню ярлыка и нажмите **Добавить ресурс**.

1. Расширьте узла **Dialog** и выберите **IDD_OLE_PROPPAGE_SMALL.**

1. Нажмите **"Новый",** чтобы добавить ресурс в проект.

1. Выберите новый шаблон страницы свойств для обновления окна **Свойств** (в **виде ресурсов).**

1. Введите новое значение для свойства **идентификатора.** Этот пример использует **IDD_PROPPAGE_NEWPAGE**.

1. Нажмите кнопку **Сохранить** на панели инструментов.

### <a name="to-associate-the-new-template-with-a-class"></a>Связать новый шаблон с классом

1. Открытый вид класса.

1. Нажмите в классе View, чтобы открыть меню ярлыка.

1. Из меню ярлыка, нажмите **Добавить,** а затем нажмите **Добавить класс**.

   Это открывает диалоговую коробку [Add Class.](../ide/add-class-dialog-box.md)

1. Дважды щелкните шаблон **класса MFC.**

1. В поле **Название класса** в [классе MFC Волшебник](../mfc/reference/mfc-add-class-wizard.md)— введите имя для нового класса диалога. (В этом `CAddtlPropPage`примере.)

1. Если вы хотите изменить имена файлов, нажмите **«Изменение».** Введите имена для ваших файлов реализации и заголовка или примите имена по умолчанию.

1. В поле **базового** `COlePropertyPage`класса выберите .

1. В поле **Dialog ID** выберите **IDD_PROPPAGE_NEWPAGE.**

1. Нажмите **Закончить,** чтобы создать класс.

Чтобы предоставить пользователям управления доступ к этой новой странице свойств, внести следующие изменения в макрораздел идоидов страницы свойств управления (находится в файле реализации элемента управления):

[!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]

Обратите внимание, что необходимо увеличить второй параметр макроса BEGIN_PROPPAGEIDS (количество страниц свойств) с 1 до 2.

Необходимо также изменить файл реализации элемента управления (. CPP) файл для включения заголовка (. H) файл нового класса страницы свойств.

Следующий шаг предполагает создание двух новых строковых ресурсов, которые будут предоставлять имя типа и заголовок для новой страницы свойств.

#### <a name="to-add-new-string-resources-to-a-property-page"></a>Добавление новых ресурсов строки на страницу свойств

1. С открытым проектом управления, открытым видом ресурсов.

1. Дважды щелкните папку **строки таблицы,** а затем дважды щелкните существующий ресурс строки таблицы, к которому вы хотите добавить строку.

   Это открывает стол строки в окне.

1. Выберите пустую строку в конце строки и введите текст или подпись строки: например, "Дополнительная страница свойств".

   Это открывает страницу **String Properties,** показывающую **подписные и** **идентификационные** коробки. Коробка **caption** содержит набранную строку.

1. В **id-поле** выберите или введите идентификатор для строки. Нажмите Введите, когда вы закончите.

   В этом примере используется **IDS_SAMPLE_ADDPAGE** для введома новой страницы свойств.

1. Повторите шаги 3 и 4, используя **IDS_SAMPLE_ADDPPG_CAPTION** для идентификатора и "Дополнительная страница свойств" для заголовка.

1. В. CPP файл вашего нового класса страницы `CAddtlPropPage`свойств `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` (в этом примере, ) изменить так, что IDS_SAMPLE_ADDPAGE передается [AfxOleRegisterPropertyPageClass](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), как и в следующем примере:

   [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]

1. Измените конструктор `CAddtlPropPage` так, чтобы IDS_SAMPLE_ADDPPG_CAPTION `COlePropertyPage` передается конструктору, следующим образом:

   [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]

После внесения необходимых изменений перестроить проект и использовать тестовый контейнер для тестирования новой страницы свойств. Сведения о том, как получить доступ к Контейнеру для тестирования, см. в разделе [Тестирование свойств и событий в Контейнере для тестирования](../mfc/testing-properties-and-events-with-test-container.md) .

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)
