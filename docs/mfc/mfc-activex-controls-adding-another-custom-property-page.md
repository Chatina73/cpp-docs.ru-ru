---
title: Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств
ms.date: 11/04/2016
helpviewer_keywords:
- property pages [MFC], MFC ActiveX controls
- custom property pages [MFC]
- ActiveX controls [MFC], property pages
- MFC ActiveX controls [MFC], property pages
ms.assetid: fcf7e119-9f29-41a9-908d-e9b1607e08af
ms.openlocfilehash: ac72258e881d10723a02b5103c602ac5cec6a1f5
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50465316"
---
# <a name="mfc-activex-controls-adding-another-custom-property-page"></a>Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств

В некоторых случаях элемент управления ActiveX будет иметь больше свойств, чем достаточно может поместиться на одной странице свойств. В этом случае можно добавить страницы свойств в элемент управления ActiveX по отображению этих свойств.

В этой статье рассматривается добавление новых страниц свойств в элемент управления ActiveX, который уже содержит по крайней мере одну страницу свойства. Дополнительные сведения о добавлении стандартное свойство страниц (шрифт, рисунок или цвет), см. в статье [элементы управления MFC ActiveX: использование запасных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md).

В следующих процедурах используются платформа управления ActiveX примера, созданного с помощью мастера управления ActiveX. Таким образом имена классов и идентификаторы являются уникальными в этом примере.

Дополнительные сведения об использовании страницы свойств в элементе управления ActiveX см. в разделе со следующими статьями:

- [Элементы ActiveX в MFC. Страницы свойств](../mfc/mfc-activex-controls-property-pages.md)

- [Элементы ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)

    > [!NOTE]
    >  Настоятельно рекомендуется этого нового свойства, которые страниц соответствовать размеру стандарт в страницах свойств элементов управления ActiveX. Стандартное свойство изображения и цвет страницы диалоговых единицах 250 x 62 мер (Единица). Страница свойств стандартного шрифта является DLU 250 x 110. Страница свойств по умолчанию, создаваемые с помощью мастера управления ActiveX использует стандарт Единица 250 x 62.

### <a name="to-insert-a-new-property-page-template-into-your-project"></a>Чтобы вставить новый шаблон страницы свойств в проект

1. Проект управления открыт откройте представление ресурсов в рабочей области проекта.

1. Щелкните правой кнопкой мыши в представлении ресурсов, чтобы открыть контекстное меню и нажмите кнопку **добавить ресурс**.

1. Разверните **диалоговое окно** узел и выберите **IDD_OLE_PROPPAGE_SMALL**.

1. Нажмите кнопку **New** для добавления ресурса в проект.

1. Выберите шаблон страницы свойств для обновления окна «Свойства».

1. Введите новое значение для **идентификатор** свойство. В этом примере используется **IDD_PROPPAGE_NEWPAGE**.

1. Нажмите кнопку **Сохранить** на панели инструментов.

### <a name="to-associate-the-new-template-with-a-class"></a>Чтобы связать новый шаблон с помощью класса

1. Откройте представление классов.

1. Щелкните правой кнопкой мыши в представлении классов, чтобы открыть контекстное меню.

1. В контекстном меню, щелкните **добавить** и нажмите кнопку **Добавление класса**.

   Откроется [Добавление класса](../ide/add-class-dialog-box.md) диалоговое окно.

1. Дважды щелкните **класс MFC** шаблона.

1. В **имя класса** поле [мастер классов MFC](../mfc/reference/mfc-add-class-wizard.md), введите имя для нового класса диалогового окна. (В этом примере `CAddtlPropPage`.)

1. Если вы хотите изменить имена файлов, нажмите кнопку **изменить**. Введите имена для вашей реализации и файлами заголовков, или примите имена по умолчанию.

1. В **базовый класс** выберите `COlePropertyPage`.

1. В **идентификатор диалогового окна** выберите **IDD_PROPPAGE_NEWPAGE**.

9. Нажмите кнопку **Готово** создаваемого класса.

Чтобы разрешить пользователям элемента управления доступ к этой новой странице свойств, внесите следующие изменения элемента управления свойство страницы идентификаторы макрос раздел (находится в файле реализации элемента управления):

[!code-cpp[NVC_MFC_AxUI#32](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_1.cpp)]

Обратите внимание на то, что нужно увеличить вторым параметром begin_proppageids-макрос (количество страниц свойств) от 1 до 2.

Необходимо также изменить файл реализации элемента управления (. Файл CPP) для включения заголовка (. H) файл нового класса страницы свойств.

Следующим этапом является создание двух новых ресурсов, которые предоставят имени типа и заголовок для новой страницы свойств.

#### <a name="to-add-new-string-resources-to-a-property-page"></a>Для добавления новых ресурсов, если для страницы свойств

1. Проект управления открыт откройте представление ресурсов.

1. Дважды щелкните **таблица строк** папку и дважды щелкните существующую строку ресурса, к которому вы хотите добавить строку таблицы.

   В таблице Строка откроется в окне.

1. Выберите пустую строку в конце строки таблицы и введите текст или заголовок, строки: например, «дополнительные свойства Page.»

   Откроется **свойства строки** отображение страницы **заголовок** и **идентификатор** поля. **Заголовок** поле содержит строку, вы ввели.

1. В **идентификатор** выберите или введите идентификатор для строки. Когда вы закончите, нажмите клавишу ВВОД.

   В этом примере используется **IDS_SAMPLE_ADDPAGE** для имени типа новые страницы свойств.

1. Повторите шаги 3 и 4 с помощью **IDS_SAMPLE_ADDPPG_CAPTION** для идентификатора и «Страница дополнительные свойства» для заголовка.

1. В. CPP-файла нового класса страницы свойств (в этом примере `CAddtlPropPage`) изменить `CAddtlPropPage::CAddtlPropPageFactory::UpdateRegistry` , чтобы IDS_SAMPLE_ADDPAGE передается по [AfxOleRegisterPropertyPageClass](../mfc/reference/registering-ole-controls.md#afxoleregisterpropertypageclass), как показано в следующем примере:

   [!code-cpp[NVC_MFC_AxUI#33](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_2.cpp)]

1. Измените конструктор элемента `CAddtlPropPage` таким образом, передать IDS_SAMPLE_ADDPPG_CAPTION `COlePropertyPage` конструктора, как показано ниже:

   [!code-cpp[NVC_MFC_AxUI#34](../mfc/codesnippet/cpp/mfc-activex-controls-adding-another-custom-property-page_3.cpp)]

После внесения необходимые изменения заново Постройте свой проект и использовать контейнер для тестирования новую страницу свойств. Сведения о том, как получить доступ к Контейнеру для тестирования, см. в разделе [Тестирование свойств и событий в Контейнере для тестирования](../mfc/testing-properties-and-events-with-test-container.md) .

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)

