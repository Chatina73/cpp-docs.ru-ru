---
title: Элементы управления ActiveX MFC
ms.date: 11/19/2018
f1_keywords:
- MFC ActiveX Controls (MFC)
helpviewer_keywords:
- COleControl class [MFC], MFC ActiveX controls
- ActiveX controls [MFC], MFC
- containers [MFC], MFC ActiveX controls
- MFC ActiveX controls [MFC], serializing
- MFC ActiveX controls [MFC], containers
- serialization [MFC], MFC ActiveX controls
- dispatch maps [MFC], for MFC ActiveX controls
- MFC ActiveX controls [MFC], active/inactive state
- events [MFC], ActiveX controls
- MFC ActiveX controls [MFC]
ms.assetid: c911fb74-3afc-4bf3-a0f5-7922b14d9a1b
ms.openlocfilehash: e9cc38eebed0b1f8e0932e89ef1452261aefd7dd
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365441"
---
# <a name="mfc-activex-controls"></a>Элементы управления ActiveX MFC

Элемент управления ActiveX — это многоразовый программный компонент, основанный на модели COM, который поддерживает широкий набор функциональных возможностей OLE и может быть настроен под различные потребности программного обеспечения.

>[!IMPORTANT]
> ActiveX является устаревшей технологией, которая не должна использоваться для новых разработок. Для получения дополнительной информации [см.](activex-controls.md)

Элементы управления ActiveX предназначены для использования как в обычных контейнерах управления ActiveX, так и в Интернете, на страницах World Wide Web. Вы можете создавать элементы управления ActiveX либо с MFC, описанные здесь, или с [Active Template Library (ATL).](../atl/active-template-library-atl-concepts.md)

Управление ActiveX может рисовать себя в собственном окне, реагировать на события (например, клики мыши), и управляться через интерфейс, который включает в себя свойства и методы, аналогичные тем, которые в объектах автоматизации.

Эти элементы управления могут быть разработаны для многих целей, таких как доступ к базе данных, мониторинг данных или график. Помимо переносимости, ActiveX управляет функциями поддержки, ранее не доступными для элементов управления ActiveX, такими как совместимость с существующими контейнерами OLE и возможность интеграции их меню с меню контейнеров OLE. Кроме того, контроль ActiveX полностью поддерживает автоматизацию, что позволяет элементу управления выставлять свойства чтения и набор методов, которые могут быть вызваны пользователем управления.

Можно создавать элементы управления и элементы управления ActiveX без окон, которые создают окно только тогда, когда они становятся активными. Управление без окон ускоряет отображение приложения и позволяет иметь прозрачные и непрямоугольные элементы управления. Вы также можете загружать свойства управления ActiveX асинхронно.

Элемент управления ActiveX реализован в качестве сервера в процессе (обычно небольшой объект), который может быть использован в любом контейнере OLE. Обратите внимание, что полная функциональность управления ActiveX доступна только при использовании в контейнере OLE, предназначенном для информирования о элементах управления ActiveX. Ознакомиться [с другими приложениями](../mfc/containers-for-activex-controls.md) можно посмотреть в порт ActiveX для получения списка контейнеров, поддерживающих элементы управления ActiveX. Этот тип контейнера, который в дальнейшем называется "контейнер управления", может управлять управлением ActiveX, используя свойства и методы управления, и получать уведомления от управления ActiveX в виде событий. Следующее взаимодействие демонстрирует следующая цифра.

![Взаимодействие элемента управления ActiveX и его контейнера](../mfc/media/vc37221.gif "Взаимодействие элемента управления ActiveX и его контейнера") <br/>
Взаимодействие между контейнером управления ActiveX и оконным управлением ActiveX

Для получения недавной информации об оптимизации элементов управления ActiveX [см.](../mfc/mfc-activex-controls-optimization.md)

Для создания управления MFC ActiveX [см.](../mfc/reference/mfc-activex-control-wizard.md)

Дополнительные сведения см. в разделе:

- [Контейнеры управления ActiveX](../mfc/activex-control-containers.md)

- [Активные документы](../mfc/active-documents.md)

- [Понимание управления ActiveX](/windows/win32/com/activex-controls)

- [Обновление существующего управления ActiveX, который будет использоваться в Интернете](../mfc/upgrading-an-existing-activex-control.md)

## <a name="basic-components-of-an-activex-control"></a><a name="_core_basic_components_of_an_activex_control"></a>Основные компоненты управления ActiveX

Управление ActiveX использует несколько программных элементов для эффективного взаимодействия с контейнером управления и с пользователем. Это класс [COleControl,](../mfc/reference/colecontrol-class.md)набор функций стрельбы событий и карта отправки.

Каждый разрабатываемый вами объект управления ActiveX наследует мощный набор функций из базового класса MFC. `COleControl` Эти функции включают активацию на месте и логику автоматизации. `COleControl`может предоставить объектуправления с той же функциональностью, что и объект окна MFC, а также возможность стрельбы событий. `COleControl`может также обеспечить [без окон элементы управления](../mfc/providing-windowless-activation.md), которые полагаются на их контейнер для помощи с некоторыми из функциональности окно предоставляет (захват мыши, клавиатура фокус, прокрутка), но предлагают гораздо быстрее дисплей.

Поскольку класс управления `COleControl`происходит от , он наследует возможность отправлять или "огонь" сообщения, называемые событиями, в контейнер управления, когда определенные условия выполнены. Эти события используются для уведомления контейнера управления, когда что-то важное происходит в элементе управления. Дополнительную информацию о событии можно отправить в контейнер управления, прикрепив параметры к событию. Для получения дополнительной информации о событиях управления ActiveX смотрите в статье [MFC ActiveX Controls: Events](../mfc/mfc-activex-controls-events.md).

Окончательным элементом является диспетчерская карта, которая используется для размещения набора функций (называемых методов) и атрибутов (так называемых свойств) пользователю управления. Свойства позволяют контейнеру управления или пользователю управления манипулировать управлением различными способами. Пользователь может изменить внешний вид элемента управления, изменить определенные значения элемента управления или сделать запросы элемента управления, например, получить доступ к определенной части данных, которую сохраняет элемент управления. Этот интерфейс определяется разработчиком управления и определяется с помощью **Class View.** Для получения дополнительной информации о методах и [MFC ActiveX Controls: Methods](../mfc/mfc-activex-controls-methods.md) свойствах управления ActiveX [Properties](../mfc/mfc-activex-controls-properties.md)см.

## <a name="interaction-between-controls-with-windows-and-activex-control-containers"></a><a name="_core_interaction_between_controls_with_windows_and_activex_control_containers"></a>Взаимодействие между элементами управления с Windows и контейнерами управления ActiveX

Когда элемент управления используется в контейнере управления, он использует два механизма для связи: он раскрывает свойства и методы, и он запускает события. Следующая цифра демонстрирует, как эти два механизма реализуются.

![Элемент управления ActiveX взаимодействует со своим контейнером](../mfc/media/vc37222.gif "Элемент управления ActiveX взаимодействует со своим контейнером") <br/>
Связь между контейнером управления ActiveX и управлением ActiveX

Предыдущая цифра также иллюстрирует, как другие интерфейсы OLE (кроме автоматизации и событий) обрабатываются элементами управления.

Вся связь управления с контейнером `COleControl`выполняется . Для обработки некоторых запросов `COleControl` контейнера вызовут функции членов, реализованные в классе управления. Все методы и некоторые свойства обрабатываются таким образом. Класс элемента управления также может инициировать связь с `COleControl`контейнером, вызывая функции участника. События зажигаются таким образом.

## <a name="active-and-inactive-states-of-an-activex-control"></a><a name="_core_active_and_inactive_states_of_an_activex_control"></a>Активные и неактивные состояния управления ActiveX

Элемент управления имеет два основных состояния: активное и неактивное. Традиционно эти состояния отличались тем, имел ли контроль окно. Активный контроль имел окно; неактивных управления не сделал. С введением активации без окон это различие уже не является универсальным, но все же применяется ко многим элементам управления.

Когда [управление без окон](../mfc/providing-windowless-activation.md) становится активным, он вызывает захват мыши, фокус клавиатуры, прокрутку и другие оконные службы из своего контейнера. Вы также можете [обеспечить взаимодействие мыши с неактивными элементами управления,](../mfc/providing-mouse-interaction-while-inactive.md)а также создать элементы управления, которые [ждут, пока не активируется для создания окна.](../mfc/turning-off-the-activate-when-visible-option.md)

Когда элемент управления с окном становится активным, он может полностью взаимодействовать с контейнером управления, пользователем и Windows. На рисунке ниже показаны пути связи между управлением ActiveX, контейнером управления и операционной системой.

![Обработка сообщений в элементе управления ActiveX активного окна](../mfc/media/vc37223.gif "Обработка сообщений в элементе управления ActiveX активного окна") <br/>
Обработка сообщений Windows в оконном управлении ActiveX (Когда активна)

## <a name="serialization"></a><a name="_core_serializing_activex_elements"></a>Сериализации

Возможность сериализации данных, иногда называемая сохранением, позволяет элементу управления записывать значение своих свойств в постоянное хранилище. Элементы управления могут быть воссозданы путем чтения состояния объекта из хранилища.

Обратите внимание, что элемент управления не несет ответственности за получение доступа к среде хранения. Вместо этого контейнер управления отвечает за обеспечение элемента управления средой хранения для использования в соответствующее время. Для получения дополнительной информации о [MFC ActiveX Controls: Serializing](../mfc/mfc-activex-controls-serializing.md)сериализации, см. Подробнее об оптимизации сериализации [можно](../mfc/optimizing-persistence-and-initialization.md) узнать в обзоре ActiveX Controls: Optimization.

## <a name="installing-activex-control-classes-and-tools"></a><a name="_core_installing_activex_control_classes_and_tools"></a>Установка классов управления ActiveX и инструментов

При установке Visual C ,, MFC ActiveX классов управления и розничной торговли и отладки ActiveX управления время выполнения DLLs автоматически устанавливаются, если ActiveX элементы управления выбраны в настройке (они выбраны по умолчанию).

По умолчанию классы управления и инструменты ActiveX устанавливаются в следующих субдиректорах в рамках программы «Файлы» Microsoft Visual Studio .NET:

- **«Общие7»Инструменты**

   Содержит файлы контейнера тестирования (TstCon32.exe, а также его файлы справки).

- **«Vc7»atlmfc» включает**

   Содержит файлы, необходимые для разработки элементов управления ActiveX с MFC

- **(Vc7)**

   Содержит исходный код для конкретных классов управления ActiveX в MFC

- **«Vc7»atlmfc-lib**

   Содержит библиотеки, необходимые для разработки элементов управления ActiveX с MFC

Есть также образцы для управления MFC ActiveX. Для получения дополнительной информации [Controls Samples: MFC-Based ActiveX Controls](../overview/visual-cpp-samples.md) об этих образцах см.

## <a name="see-also"></a>См. также раздел

[Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)
