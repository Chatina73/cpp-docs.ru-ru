---
title: Элементы управления ActiveX MFC
ms.date: 11/19/2018
f1_keywords:
- MFC ActiveX Controls (MFC)
helpviewer_keywords:
- COleControl class [MFC], MFC ActiveX controls
- ActiveX controls [MFC], MFC
- containers [MFC], MFC ActiveX controls
- MFC ActiveX controls [MFC], serializing
- MFC ActiveX controls [MFC], containers
- serialization [MFC], MFC ActiveX controls
- dispatch maps [MFC], for MFC ActiveX controls
- MFC ActiveX controls [MFC], active/inactive state
- events [MFC], ActiveX controls
- MFC ActiveX controls [MFC]
ms.assetid: c911fb74-3afc-4bf3-a0f5-7922b14d9a1b
ms.openlocfilehash: a1c7bb070a75f4406556817163931f0707706c40
ms.sourcegitcommit: 389c559918d9bfaf303d262ee5430d787a662e92
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2019
ms.locfileid: "69508116"
---
# <a name="mfc-activex-controls"></a>Элементы управления ActiveX MFC

Элемент управления ActiveX — это многоразовый программный компонент, основанный на модели COM, который поддерживает широкий набор функциональных возможностей OLE и может быть настроен под различные потребности программного обеспечения.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения см. в разделе [элементы управления ActiveX](activex-controls.md).

Элементы управления ActiveX предназначены для использования как в обычных контейнерах элементов управления ActiveX, так и в Интернете, на веб-страницах Интернета. Элементы управления ActiveX можно создавать с помощью MFC, как описано здесь, или с помощью [библиотеки ATL](../atl/active-template-library-atl-concepts.md).

Элемент управления ActiveX может рисовать себя в собственном окне, реагировать на события (например, щелчки мыши) и управлять через интерфейс, который включает свойства и методы, аналогичные методам в объектах автоматизации.

Эти элементы управления можно разрабатывать для многих целей, таких как доступ к базам данных, мониторинг данных или графика. Помимо переносимости элементы управления ActiveX поддерживают функции, ранее недоступные для элементов управления ActiveX, такие как совместимость с существующими контейнерами OLE и возможность интеграции их меню с меню контейнера OLE. Кроме того, элемент управления ActiveX полностью поддерживает автоматизацию, что позволяет элементу управления предоставлять свойства реад\врите и набор методов, которые могут вызываться пользователем элемента управления.

Вы можете создавать элементы управления ActiveX без окон и элементы управления, которые создают окно, только когда они становятся активными. Элементы управления без окон ускоряют отображение приложения и позволяют иметь прозрачные и непрямоугольные элементы управления. Свойства элемента управления ActiveX также можно загрузить асинхронно.

Элемент управления ActiveX реализуется как внутрипроцессный сервер (обычно небольшой объект), который можно использовать в любом контейнере OLE. Обратите внимание, что все функции элемента управления ActiveX доступны только при использовании в контейнере OLE, предназначенном для осведомленности об элементах управления ActiveX. Список контейнеров, поддерживающих элементы управления ActiveX, см. [в разделе Управление портами ActiveX для других приложений](../mfc/containers-for-activex-controls.md) . Этот тип контейнера, который затем называется контейнером управления, может использовать элемент управления ActiveX с помощью свойств и методов элемента управления, а также получать уведомления от элемента управления ActiveX в форме событий. Это взаимодействие показано на следующем рисунке.

![Взаимозависимость элементов управления ActiveX и контейнеров](../mfc/media/vc37221.gif "Взаимозависимость элементов управления ActiveX и контейнеров") <br/>
Взаимодействие между контейнером элемента управления ActiveX и оконным элементом управления ActiveX

Последние сведения об оптимизации элементов управления ActiveX см [. в статье элементы управления ActiveX в MFC. Оптимизация](../mfc/mfc-activex-controls-optimization.md).

Сведения о создании элемента управления ActiveX в MFC см. в разделе [Создание проекта элемента управления ActiveX](../mfc/reference/mfc-activex-control-wizard.md).

Дополнительные сведения:

- [Контейнеры для элементов ActiveX](../mfc/activex-control-containers.md)

- [Активные документы](../mfc/active-documents.md)

- [Общие сведения об элементах управления ActiveX](/windows/win32/com/activex-controls)

- [Обновление существующего элемента управления ActiveX для использования в Интернете](../mfc/upgrading-an-existing-activex-control.md)

##  <a name="_core_basic_components_of_an_activex_control"></a>Основные компоненты элемента управления ActiveX

Элемент управления ActiveX использует несколько программных элементов для эффективного взаимодействия с контейнером элемента управления и с пользователем. Это класс [COleControl](../mfc/reference/colecontrol-class.md), набор функций, которые обрабатывают события, и карту диспетчеризации.

Каждый разрабатываемый управляющий объект ActiveX наследует мощный набор функций из базового класса `COleControl`MFC. Эти функции включают в себя активацию на месте и логику автоматизации. `COleControl`может предоставить управляющий объект с теми же функциональными возможностями, что и объект окна MFC, а также возможность запуска событий. `COleControl`также может предоставлять [безоконные элементы управления](../mfc/providing-windowless-activation.md), которые полагаются на контейнер для помощи с некоторыми функциями, предоставляемыми окном (захват мыши, клавиатурный фокус, прокрутка), но обеспечивают гораздо более быстрый вывод.

Поскольку класс Control является производным от `COleControl`, он наследует возможность отправки или пожара сообщений, называемых событиями, в контейнер элемента управления, когда выполняются определенные условия. Эти события используются для уведомления контейнера элементов управления, когда что-то важное происходит в элементе управления. Дополнительные сведения о событии можно отправить в контейнер элемента управления, присоединив параметры к событию. Дополнительные сведения о событиях элементов управления ActiveX см. в статье [элементы управления ActiveX в MFC. События](../mfc/mfc-activex-controls-events.md).

Последний элемент представляет собой карту диспетчеризации, которая используется для предоставления пользователю элемента управления набора функций (называемых методами) и атрибутов (называемых свойствами). Свойства позволяют контейнеру элемента управления или пользователю элемента управления манипулировать элементом управления различными способами. Пользователь может изменять внешний вид элемента управления, изменять определенные значения элемента управления или делать запросы элемента управления, например получать доступ к конкретному фрагменту данных, который поддерживает элемент управления. Этот интерфейс определяется разработчиком элемента управления и определяется с помощью **представление классов**. Дополнительные сведения о методах и свойствах элементов управления ActiveX см. [в статьях, посвященных элементам ActiveX MFC: Методы](../mfc/mfc-activex-controls-methods.md) и [Свойства](../mfc/mfc-activex-controls-properties.md).

##  <a name="_core_interaction_between_controls_with_windows_and_activex_control_containers"></a>Взаимодействие между элементами управления с контейнерами элементов управления Windows и ActiveX

Когда элемент управления используется в контейнере элемента управления, он использует два механизма для взаимодействия: он предоставляет свойства и методы и запускает события. На следующем рисунке показано, как реализуются эти два механизма.

![Элемент управления ActiveX взаимодействует со своим контейнером](../mfc/media/vc37222.gif "Элемент управления ActiveX взаимодействует со своим контейнером") <br/>
Обмен данными между контейнером элемента управления ActiveX и элементом управления ActiveX

На предыдущем рисунке также показано, как другие интерфейсы OLE (помимо автоматизации и событий) обрабатываются элементами управления.

Все элементы управления, взаимосвязь с контейнером, выполняются `COleControl`. Для обработки некоторых запросов `COleControl` контейнера будет вызывать функции членов, реализованные в классе Control. Все методы и некоторые свойства обрабатываются таким образом. Класс элемента управления также может инициировать связь с контейнером путем вызова функций `COleControl`членов. События запускаются таким образом.

##  <a name="_core_active_and_inactive_states_of_an_activex_control"></a>Активные и неактивные состояния элемента управления ActiveX

Элемент управления имеет два основных состояния: активный и неактивный. Обычно эти Штаты были различны, когда элемент управления имел окно. Активный элемент управления имел окно; неактивный элемент управления не был. С появлением безоконной активации это различие больше не является универсальным, но по-прежнему применяется ко многим элементам управления.

Когда [безоконный элемент управления](../mfc/providing-windowless-activation.md) становится активным, он вызывает захват мыши, клавиатурный фокус, прокрутку и другие службы окон из своего контейнера. Можно также [обеспечить взаимодействие мыши с неактивными элементами управления](../mfc/providing-mouse-interaction-while-inactive.md), а также создать элементы управления, [ожидающие активации, чтобы создать окно](../mfc/turning-off-the-activate-when-visible-option.md).

Когда элемент управления, работающий с окном, становится активным, он может полностью взаимодействовать с контейнером элемента управления, пользователем и Windows. На рисунке ниже показаны пути взаимодействия между элементом управления ActiveX, контейнером элемента управления и операционной системой.

![Обработка сообщений в активном элементе ActiveX с окнами](../mfc/media/vc37223.gif "Обработка сообщений в активном элементе ActiveX с окнами") <br/>
Обработка сообщений Windows в оконном элементе ActiveX (если он активен)

##  <a name="_core_serializing_activex_elements"></a>Сериализовать

Возможность сериализации данных, которые иногда называют сохраняемостью, позволяет элементу управления записывать значения его свойств в постоянное хранилище. Элементы управления могут быть созданы повторно путем считывания состояния объекта из хранилища.

Обратите внимание, что элемент управления не отвечает за получение доступа к носителю хранилища. Вместо этого контейнер элемента управления отвечает за предоставление элемента управления со средним хранилищем для использования в нужное время. Дополнительные сведения о сериализации см. в статье [элементы управления ActiveX в MFC. Сериализация](../mfc/mfc-activex-controls-serializing.md). Сведения об оптимизации сериализации см. в разделе [Оптимизация сохранения и инициализации](../mfc/optimizing-persistence-and-initialization.md) в элементах управления ActiveX. Улучшение.

##  <a name="_core_installing_activex_control_classes_and_tools"></a>Установка классов и средств элементов управления ActiveX

При установке визуального C++элемента ActiveX-библиотеки элементов управления MFC и Retail и Debug ActiveX автоматически устанавливаются, если в программе установки выбраны элементы управления ActiveX (они выбираются по умолчанию).

По умолчанию классы и средства элементов управления ActiveX устанавливаются в следующие подкаталоги в папке \Program Files\Microsoft Visual Studio .NET:

- **\Common7\Tools**

   Содержит файлы тестовых контейнеров (TstCon32. exe, а также файлы справки).

- **\Vc7\atlmfc\include**

   Содержит включаемые файлы, необходимые для разработки элементов управления ActiveX с помощью MFC

- **\Vc7\atlmfc\src\mfc**

   Содержит исходный код для конкретных классов элементов управления ActiveX в MFC

- **\Vc7\atlmfc\lib**

   Содержит библиотеки, необходимые для разработки элементов управления ActiveX с помощью MFC

Существуют также примеры для элементов управления ActiveX MFC. Дополнительные сведения об этих примерах см. [в разделе примеры элементов управления: Элементы управления ActiveX на основе MFC](../overview/visual-cpp-samples.md)

## <a name="see-also"></a>См. также

[Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)
