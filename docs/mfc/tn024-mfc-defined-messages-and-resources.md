---
title: TN024. Сообщения и ресурсы, определенные MFC
ms.date: 11/04/2016
helpviewer_keywords:
- resources [MFC]
- Windows messages [MFC], MFC-defined
- messages [MFC], MFC
- TN024
ms.assetid: c65353ce-8096-454b-ad22-1a7a1dd9a788
ms.openlocfilehash: 24bcacd46b839babe9c9c89facb1cc56d18c0ee5
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370353"
---
# <a name="tn024-mfc-defined-messages-and-resources"></a>TN024. Сообщения и ресурсы, определенные MFC

> [!NOTE]
> Следующее техническое примечание не было обновлено, поскольку сначала оно было включено в электронную документацию. В результате некоторые процедуры и разделы могут быть устаревшими или неверными. Для получения последних сведений рекомендуется выполнить поиск интересующей темы в алфавитном указателе документации в Интернете.

В этой заметке описаны внутренние сообщения Windows и форматы ресурсов, используемые MFC. Эта информация объясняет реализацию платформы и поможет вам в отладке приложения. Для предприимчивых, даже если вся эта информация официально не поддерживается, вы можете использовать часть этой информации для продвинутых реализаций.

Эта записка содержит сведения о частной реализации MFC; все содержимое может быть изменено в будущем. Личные сообщения MFC Windows имеют смысл только в одном приложении, но в будущем будут изменяться, чтобы содержать общесистемные сообщения.

Диапазон частных сообщений ИКМ и типов ресурсов mFC находятся в зарезервированном диапазоне "системы", отведенном Microsoft Windows. В настоящее время используются не все номера в диапазонах, и в будущем могут использоваться новые числа в диапазоне. Используемые в настоящее время номера могут быть изменены.

MFC частных сообщений Windows находятся в диапазоне 0x360->0x37F.

Типы частных ресурсов MFC находятся в диапазоне 0xF0->0xFF.

**MFC Частные сообщения Windows**

Эти сообщения Windows используются вместо виртуальных функций СЗ, где требуется относительно свободное соединение между оконными объектами и где виртуальная функция C's не подходит.

Эти частные сообщения Windows и связанные с ними структуры параметров объявляются в частном заголовке MFC 'AFXPRIV. H'. Имейте в виду, что любой из ваших кодов, включающих этот заголовок, может полагаться на поведение незарегистрированных и, скорее всего, будет нарушаться в будущих версиях MFC.

В редких случаях необходимости обрабатывать одно из этих сообщений следует использовать макрос карты ON_MESSAGE сообщений и обрабатывать сообщение в общем формате LRESULT/WPARAM/LPARAM.

**WM_QUERYAFXWNDPROC**

Это сообщение отправляется в создаваемый окно. Это отправляется в самом начале процесса создания в качестве метода определения, если WndProc является **AfxWndProc. AfxWndProc** возвращает 1.

|||
|-|-|
|wParam|Не используется|
|lParam|Не используется|
|возвращает|1 при **обработке AfxWndProc**|

**WM_SIZEPARENT**

Это сообщение отправляется окном кадра своим непосредственным`CFrameWnd::OnSize` `CFrameWnd::RecalcLayout` детям `CWnd::RepositionBars`во время повторного размера (вызовов, которые звонят) для переориентации баров управления вокруг боковой части кадра. Структура AFX_SIZEPARENTPARAMS содержит текущий доступный клиентский прямоугольник родителя и HDWP (который может быть NULL), с помощью которого можно вызвать, `DeferWindowPos` чтобы свести к минимуму перекраску.

|||
|-|-|
|wParam|Не используется|
|lParam|Адрес AFX_SIZEPARENTPARAMS структуры|
|возвращает|Не используется (0)|

Игнорирование сообщения указывает на то, что окно не принимает участия в макете.

**WM_SETMESSAGESTRING**

Это сообщение отправляется в окно кадра, чтобы попросить его обновить строку сообщения в строке состояния. Либо идентификатор строки или LPCSTR может быть указан (но не оба).

|||
|-|-|
|wParam|Идентификатор строки (или ноль)|
|lParam|LPCSTR для строки (или NULL)|
|возвращает|Не используется (0)|

**WM_IDLEUPDATECMDUI**

Это сообщение отправляется в простое время для реализации простоя обновления обработчиков uI управления обновлениями. Если окно (обычно панель управления) обрабатывает сообщение, `CCmdUI` оно создает объект (или объект производного класса) и вызывает `CCmdUI::DoUpdate` каждый из "элементов" в окне. Это, в свою очередь, позволит проверить обработчик ON_UPDATE_COMMAND_UI для объектов в цепочке обработчика команд.

|||
|-|-|
|wParam|BOOL bDisableIfNoHandler|
|lParam|Не используется (0)|
|возвращает|Не используется (0)|

*bDisableIfNoHandler* неявляется для того, чтобы отключить объект uI, если нет ни ON_UPDATE_COMMAND_UI, ни ON_COMMAND обработчика.

**WM_EXITHELPMODE**

Это сообщение размещено `CFrameWnd` в режиме помощи, чтобы выйти из контекста чувствительный режим справки. Получение этого сообщения завершает цикл модального `CFrameWnd::OnContextHelp`цикла, начатый .

|||
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Не используется|

**WM_INITIALUPDATE**

Это сообщение отправляется шаблоном документа всем потомкам окна кадра, когда им безопасно сделать их первоначальное обновление. Он отображает вызов, `CView::OnInitialUpdate` но может быть `CWnd`использован в других классах, полученных для других одноразового обновления.

|||
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Не используется (0)|

**WM_RECALCPARENT**

Это сообщение отправляется представлением в родительское `GetParent`окно (получено через), чтобы заставить перерасчет макета (обычно, родитель будет звонить). `RecalcLayout` Это используется в серверных приложениях OLE, где необходимо, чтобы кадр рос в размерах по мере роста общего размера представления.

Если родительское окно обрабатывает это сообщение, оно должно вернуть ИСТИНу и заполнить RECT, пройденое в lParam, новым размером клиентской области. Это используется `CScrollView` для правильной обработки прокруток (место, то на внешней стороне окна, когда они добавляются), когда объект сервера на месте активирован.

|||
|-|-|
|wParam|Не используется (0)|
|lParam|LPRECT rectClient, может быть NULL|
|возвращает|ПРАВДА, если новый прямоугольник клиента вернулся, FALSE в противном случае|

**WM_SIZECHILD**

Это сообщение отправляется `COleResizeBar` в окно `GetOwner`владельца (через) при повторном размере панели с помощью реразмерных ручек. `COleIPFrameWnd`отвечает на это сообщение, пытаясь изменить положение окна кадра по запросу пользователя.

Новый прямоугольник, приведенный в координатах клиента относительно окна рамы, содержащего панель реразмерного размера, указывается на lParam.

|||
|-|-|
|wParam|Не используется (0)|
|lParam|LPRECT rectNew|
|возвращает|Не используется (0)|

**WM_DISABLEMODAL**

Это сообщение отправляется во все всплывающие окна, принадлежащие окну кадра, которое деактивируется. Окно кадра использует результат, чтобы определить, следует ли отключить всплывающее окно.

Это можно использовать для выполнения специальной обработки в всплывающем окне, когда кадр входит в состояние модального устройства, или для того, чтобы некоторые всплывающие окна не были отключены. Tooltips используют это сообщение, чтобы уничтожить себя, когда окно кадра переходит в модальное состояние, например.

|||
|-|-|
|wParam|Не используется (0)|
|lParam|Не используется (0)|
|возвращает|Ненулевой, чтобы **НЕ** отключить окно, 0 указывает окно будет отключено|

**WM_FLOATSTATUS**

Это сообщение отправляется во все всплывающие окна, принадлежащие окну кадра, когда кадр активируется или отключается другим окном кадра верхнего уровня. Это используется реализацией MFS_SYNCACTIVE `CMiniFrameWnd`в, чтобы сохранить активацию этих всплывающих окон в синхронизации с активацией окна верхнего уровня кадра.

|||
|-|-|
|wParam|— может иметь одно из следующих значений.<br /><br /> FS_SHOW<br /><br /> FS_HIDE<br /><br /> FS_ACTIVATE<br /><br /> FS_DEACTIVATE<br /><br /> FS_ENABLEFS_DISABLE<br /><br /> FS_SYNCACTIVE|
|lParam|Не используется (0)|

Значение возврата должно быть ненулевым, если FS_SYNCACTIVE установлено, и окно синхронизирует свою активацию с родительским кадром. `CMiniFrameWnd`возвращает сяпонь, когда стиль установлен на MFS_SYNCACTIVE.

Для получения дополнительной информации, `CMiniFrameWnd`см.

## <a name="wm_activatetoplevel"></a>WM_ACTIVATETOPLEVEL

Это сообщение отправляется в окно верхнего уровня, когда окно в его "группе верхнего уровня" либо активируется, либо деактивируется. Окно является частью группы верхнего уровня, если оно является окном верхнего уровня (без родителя или владельца), или оно принадлежит такому окну. Это сообщение аналогично WM_ACTIVATEAPP, но работает в ситуациях, когда окна, принадлежащие к различным процессам, смешиваются в иерархии одного окна (обычно в приложениях OLE).

## <a name="wm_commandhelp-wm_helphittest-wm_exithelpmode"></a>WM_COMMANDHELP, WM_HELPHITTEST, WM_EXITHELPMODE

Эти сообщения используются в реализации чувствительной к контексту справки. Для получения дополнительной информации обратитесь к [Technical Note 28.](../mfc/tn028-context-sensitive-help-support.md)

## <a name="mfc-private-resource-formats"></a>Форматы частных ресурсов МФЦ

В настоящее время МФЦ определяет два формата частных ресурсов: RT_TOOLBAR и RT_DLGINIT.

## <a name="rt_toolbar-resource-format"></a>Формат RT_TOOLBAR ресурсов

Панель инструментов по умолчанию, поставляемая AppWizard, основана на RT_TOOLBAR пользовательском ресурсе, который был введен в MFC 4.0. Этот ресурс можно отредатить с помощью редактора панели инструментов.

## <a name="rt_dlginit-resource-format"></a>Формат RT_DLGINIT ресурсов

Один формат частных ресурсов MFC используется для хранения дополнительной информации о инициализации диалога. Это включает в себя начальные строки, хранящиеся в комбо-коробке. Формат этого ресурса не предназначен для ручного редактирования, а обрабатывается Visual C.

Визуальный СЗ и этот RT_DLGINIT ресурс не обязаны использовать соответствующие функции MFC, так как есть альтернатива API использованию информации в ресурсе. Использование Визуального СЗ значительно упрощает запись, обслуживание и перевод приложения в долгосрочной перспективе.

Основная структура ресурса RT_DLGINIT заключается в следующем:

```
+---------------+    \
| Control ID    |   UINT             |
+---------------+    |
| Message #     |   UINT             |
+---------------+    |
|length of data |   DWORD            |
+---------------+    |   Repeated
|   Data        |   Variable Length  |   for each control
|   ...         |   and Format       |   and message
+---------------+    /
|     0         |   BYTE
+---------------+
```

Повторный раздел содержит идентификатор управления для отправки сообщения, Сообщение для отправки (обычное сообщение Windows) и переменную длину данных. Сообщение Windows отправляется в форме:

```
SendDlgItemMessage(<Control ID>, <Message #>, 0, &<Data>);
```

Это очень общий формат, позволяющий любые сообщения Windows и содержание данных. Редактор ресурсов Visual C и MFC поддерживают только ограниченное подмножество сообщений Windows: CB_ADDSTRING для первоначального списка выбор комбо-коробок (данные — текстовая строка).

## <a name="see-also"></a>См. также раздел

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические заметки по категориям](../mfc/technical-notes-by-category.md)
