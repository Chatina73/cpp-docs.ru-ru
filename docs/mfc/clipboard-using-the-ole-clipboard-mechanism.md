---
title: Буфер обмена. Использование механизма буфера обмена OLE
ms.date: 11/04/2016
helpviewer_keywords:
- applications [OLE], Clipboard
- OLE Clipboard
- Clipboard [MFC], OLE formats
- OLE Clipboard, formats
- formats [MFC], Clipboard for OLE
ms.assetid: 229cc610-5bb1-435e-bd20-2c8b9964d1af
ms.openlocfilehash: d8ef93b306c0968adf2c23c841c792d2f7af5de3
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62327047"
---
# <a name="clipboard-using-the-ole-clipboard-mechanism"></a>Буфер обмена. Использование механизма буфера обмена OLE

OLE использует стандартные форматы и некоторых OLE-форматы для передачи данных через буфер обмена.

Когда Вырезать или копировать данные из приложения, данные хранятся в буфере обмена для последующего использования в операции вставки. Эти данные имеют различные форматы. Когда пользователь выбирает для вставки данных из буфера обмена, приложение может выбрать, какие из этих форматов, для использования. Приложения должны записываться в выбирать формат, который предоставляет наиболее полные сведения, в том случае, если пользователь специально запрашивает определенный формат, с помощью Специальная вставка. Прежде чем продолжить, вы можете прочитать [объекты данных и источники данных (OLE)](../mfc/data-objects-and-data-sources-ole.md) разделы. Они описывают основы работы, как передача данных и способы их реализации в приложениях.

Windows определяет несколько стандартных форматов, которые могут использоваться для передачи данных через буфер обмена. К ним относятся метафайлы, текст, растровые изображения и другие. OLE определяет ряд OLE прикладные строковые представления, а также. Для приложений, которым требуется больше информации, чем предоставленное эти стандартные форматы рекомендуется зарегистрировать свои собственные пользовательские форматы буфера обмена. Используйте функцию Win32 API [RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata) это сделать.

Например Microsoft Excel регистрирует пользовательский формат для электронных таблиц. Этот формат содержит гораздо больше сведений, чем, например, выполняет растрового изображения. При этом данные будут вставлены в приложение, поддерживающее формате электронной таблицы, все формулы и значения из электронной таблицы сохраняются и могут быть обновлены, при необходимости. Microsoft Excel также помещает данные в буфере обмена в форматах, таким образом, чтобы его можно вставить как объект OLE. Любой документ OLE-контейнер можно вставить эту информацию в виде внедренного элемента. Этот внедренный элемент можно изменить с помощью Microsoft Excel. Буфер обмена содержит также простых растровых изображений изображения для выбранного диапазона на листе. Это можно вставить в контейнеры документов OLE или точечного рисунка редакторов, например Paint. В случае с растровым изображением тем не менее, нет способа для работы с данными в виде электронной таблицы.

Чтобы получить максимальный объем сведений из буфера обмена, приложений должны проверять эти пользовательские форматы перед вставкой данных из буфера обмена.

Например чтобы включить команды вырезания, можно написать обработчик примерно следующим образом:

[!code-cpp[NVC_MFCListView#3](../atl/reference/codesnippet/cpp/clipboard-using-the-ole-clipboard-mechanism_1.cpp)]

## <a name="what-do-you-want-to-know-more-about"></a>Выберите для получения дополнительных сведений

- [Копирование и вставка данных](../mfc/clipboard-copying-and-pasting-data.md)

- [Добавление других форматов](../mfc/clipboard-adding-other-formats.md)

- [Использование буфера обмена Windows](../mfc/clipboard-using-the-windows-clipboard.md)

- [OLE](../mfc/ole-background.md)

- [Объекты и данные источников данных OLE и универсальный код передачи данных](../mfc/data-objects-and-data-sources-ole.md)

## <a name="see-also"></a>См. также

[Буфер обмена](../mfc/clipboard.md)
