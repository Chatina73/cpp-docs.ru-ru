---
description: 'Дополнительные сведения о: операции перетаскивания элементов управления деревом'
title: Операции перетаскивания древовидного элемента управления
ms.date: 11/04/2016
helpviewer_keywords:
- CTreeCtrl class [MFC], drag and drop operations
- drag and drop [MFC], CTreeCtrl
- tree controls [MFC], drag and drop operations
ms.assetid: 3cf78b4c-4579-4fe1-9bc9-c5ab876e4af1
ms.openlocfilehash: 000255ad4aa6801cbe27676603a3f42d0abbef30
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97264184"
---
# <a name="tree-control-drag-and-drop-operations"></a>Операции перетаскивания древовидного элемента управления

Элемент управления "дерево" ([CTreeCtrl](../mfc/reference/ctreectrl-class.md)) отправляет уведомление, когда пользователь начинает перетаскивать элемент. Элемент управления отправляет сообщение уведомления [TVN_BEGINDRAG](/windows/win32/Controls/tvn-begindrag) , когда пользователь начинает перетаскивать элемент с помощью левой кнопки мыши и сообщения [TVN_BEGINRDRAG](/windows/win32/Controls/tvn-beginrdrag) уведомления, когда пользователь начинает перетаскивание с правой кнопки. Можно предотвратить отправку таких уведомлений элементом управления "дерево", предоставив TVS_DISABLEDRAGDROP стиль управления деревом.

Вы получаете изображение для показа во время операции перетаскивания путем вызова функции-члена [креатедрагимаже](../mfc/reference/ctreectrl-class.md#createdragimage) . Элемент управления "дерево" создает перетаскивание растрового изображения на основе метки перетаскиваемого элемента. Затем элемент управления "дерево" создает список изображений, добавляет к нему растровое изображение и возвращает указатель на объект [CImageList](../mfc/reference/cimagelist-class.md) .

Необходимо указать код, который будет перетаскивать элемент. Обычно это касается использования возможностей перетаскивания в списке изображений и обработки [WM_MOUSEMOVE](/windows/win32/inputdev/wm-mousemove) и [WM_LBUTTONUP](/windows/win32/inputdev/wm-lbuttonup) (или [WM_RBUTTONUP](/windows/win32/inputdev/wm-rbuttonup)) сообщений, отправленных после начала операции перетаскивания. Дополнительные сведения о функциях списка изображений см. в разделе [CImageList](../mfc/reference/cimagelist-class.md) *справочника по MFC* и в [списках изображений](/windows/win32/controls/image-lists) в Windows SDK. Дополнительные сведения о перетаскивании элемента управления "дерево" см. в разделе [перетаскивание элемента древовидного представления](/windows/win32/Controls/tree-view-controls)также в Windows SDK.

Если элементы в элементе управления "дерево" являются целевыми объектами операции перетаскивания, необходимо знать, когда курсор мыши находится на целевом элементе. Вы можете узнать, вызвав функцию члена [HitTest](../mfc/reference/ctreectrl-class.md#hittest) . Вы указываете точку и целое число или адрес структуры [твхиттестинфо](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) , которая содержит текущие координаты курсора мыши. При возврате функции целое число или структура содержит флаг, указывающий расположение курсора мыши относительно элемента управления "дерево". Если курсор находится над элементом в элементе управления "дерево", структура также содержит маркер элемента.

Можно указать, что элемент является целевым объектом операции перетаскивания, вызвав функцию-член [сетитем](../mfc/reference/ctreectrl-class.md#setitem) , чтобы установить в качестве состояния `TVIS_DROPHILITED` значение. Элемент с этим состоянием рисуется в стиле, который указывает на цель перетаскивания.

## <a name="see-also"></a>См. также раздел

[Использование CTreeCtrl](../mfc/using-ctreectrl.md)<br/>
[Элементы управления](../mfc/controls-mfc.md)
