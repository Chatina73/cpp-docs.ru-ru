---
description: 'Дополнительные сведения: Мастер потребителей MFC ODBC'
title: мастер потребителей ODBC MFC
ms.date: 08/29/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: ffc1378f18ab30d77da00da4ce657a5788e04172
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97219139"
---
# <a name="mfc-odbc-consumer-wizard"></a>мастер потребителей ODBC MFC

::: moniker range="msvc-160"

Этот мастер недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="<=msvc-150"

Этот мастер настраивает класс набора записей ODBC и привязки данных, необходимые для доступа к указанному источнику данных.

## <a name="uielement-list"></a>Список элементов пользовательского интерфейса

- **Источник данных**

  Кнопка **источник данных** позволяет настроить указанный источник данных с помощью УКАЗАННОГО драйвера ODBC. Дополнительные сведения о файлах источников данных (DSN) см. в разделе [Файловые источники данных](/sql/odbc/reference/file-data-sources) в пакете SDK для ODBC.

  Диалоговое окно **Выбор источника данных** имеет две вкладки:

  - Вкладка « **Файловый источник данных** »:

     В поле **Искать в** указывается каталог, в котором следует выбирать файлы для использования в качестве источников данных. Значение по умолчанию — \Program Files\Common Филес\одбк\дата sources. Существующие файловые источники данных (DSN-файлы) отображаются в главном списке. Вы можете настроить источники данных заранее с помощью вкладки **Файловый DSN** [администратора источника данных ODBC](/sql/odbc/admin/odbc-data-source-administrator)или создать новые с помощью этого диалогового окна.

     Чтобы создать новый файловый источник данных из этого диалогового окна, щелкните, `New` чтобы указать имя DSN; откроется диалоговое окно **Создание нового источника данных** . В диалоговом окне **Создание нового источника данных** выберите подходящий драйвер и нажмите кнопку `Next` **Обзор**, а затем выберите имя файла, который будет использоваться в качестве источника данных (выберите «все файлы», чтобы просмотреть файлы, не являющиеся DSN-именами, например XLS-файлы); нажмите кнопку `Next` , а затем кнопку **Готово**. (Если вы выбрали файл, отличный от DSN, появится диалоговое окно для конкретного драйвера, например «программа установки ODBC Microsoft Excel», которая преобразует файл в имя DSN.)

     > [!NOTE]
     > Кроме того, можно заранее создать новый файловый источник данных с помощью администратора источников данных ODBC. В меню **Пуск** выберите **Параметры**, **Панель управления** **, Администрирование,** **Источники данных (ODBC)**, а затем — **Администратор источника данных ODBC**.

     Поле **имя DSN** позволяет указать имя для файлового источника данных. Необходимо убедиться, что имя DSN заканчивается соответствующим расширением файла, например XLS для файлов Excel или MDB для доступа к файлам.

     Дополнительные сведения об именах DSN см. в разделе [Файловые источники данных](/sql/odbc/reference/file-data-sources) в пакете SDK для ODBC.

  - Вкладка " **источник данных компьютера** ":

     На этой вкладке перечислены системные и пользовательские источники данных. Пользовательские источники данных зависят от пользователя на этом компьютере. Системные источники данных могут использоваться всеми пользователями на этом компьютере или в общедоступной службе. См. раздел [Источники данных на компьютере](/sql/odbc/reference/machine-data-sources) в пакете SDK для ODBC.

     Дополнительные сведения об источниках данных ODBC см. в разделе [Источники данных](/sql/odbc/reference/data-sources) в пакете SDK для ODBC.

  Для завершения нажмите кнопку **ОК**. Появится диалоговое окно **Выберите объект базы данных**. В этом диалоговом окне выберите таблицу или представление, которые будет использовать потребитель. Обратите внимание, что можно выбрать несколько представлений и таблиц, удерживая клавишу Control, щелкая их. Для завершения нажмите кнопку **ОК**.

- **Класс**

   Имя класса-получателя по умолчанию на основе имени выбранного файла или источника данных компьютера.

- **H-файл**

   Имя файла заголовка класса-получателя по умолчанию на основе выбранного имени файла или источника данных компьютера.

- **CPP-файл**

   Имя файла реализации класса потребителя по умолчанию на основе выбранного имени файла или источника данных компьютера.

- **Тип**

   Указывает, является ли набор записей динамическим (по умолчанию) или моментальным снимком.

  - **Динамическое подмножество**. указывает, что набор записей является динамическим множеством. Динамический набор — это результат запроса, который предоставляет индексированное представление данных запрашиваемой базы данных. Динамический набор кэширует только целочисленный индекс исходных данных и, таким же, обеспечивает повышение производительности по сравнению с моментальным снимком. Индекс указывает непосредственно на каждую запись, найденную в результате запроса, и указывает, удаляется ли запись. У вас также есть доступ к обновленной информации в запрашиваемых записях. Это значение по умолчанию.

  - **Моментальный снимок**: указывает, что набор записей является моментальным снимком. Моментальный снимок является результатом запроса и представляет собой представление базы данных в один момент времени. Все записи, найденные в результате запроса, кэшируются, поэтому изменения в исходных записях не отображаются.

- **Привязать все столбцы**

   Указывает, привязаны ли все столбцы в выбранной таблице. При выборе этого поля (по умолчанию) все столбцы будут привязаны; Если этот флажок не установлен, столбцы не привязаны, и их необходимо привязать вручную в классе Recordset.

::: moniker-end

## <a name="see-also"></a>См. также раздел

[Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)
