---
title: мастер потребителей ODBC MFC
ms.date: 08/29/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: 84fdc0d180f5b1b0f2e64c3597cb474611ad3914
ms.sourcegitcommit: e10a5feea193c249ddc5a6faba48e7c6d8784e73
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/30/2019
ms.locfileid: "70177431"
---
# <a name="mfc-odbc-consumer-wizard"></a>мастер потребителей ODBC MFC

::: moniker range="vs-2019"

Этот мастер недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="<=vs-2017"

Этот мастер настраивает класс набора записей ODBC и привязки данных, необходимые для доступа к указанному источнику данных.

## <a name="uielement-list"></a>Список элементов пользовательского интерфейса

- **Источник данных**

  Кнопка **источник данных** позволяет настроить указанный источник данных с помощью УКАЗАННОГО драйвера ODBC. Дополнительные сведения о файлах источников данных (DSN) см. в разделе [Файловые источники данных](/sql/odbc/reference/file-data-sources) в пакете SDK для ODBC.

  Диалоговое окно **Выбор источника данных** имеет две вкладки:

  - Вкладка « **Файловый источник данных** »:

     В поле **Искать в** указывается каталог, в котором следует выбирать файлы для использования в качестве источников данных. Значение по умолчанию — \Program Files\Common Филес\одбк\дата sources. Существующие файловые источники данных (DSN-файлы) отображаются в главном списке. Вы можете настроить источники данных заранее с помощью вкладки **Файловый DSN** [администратора источника данных ODBC](/sql/odbc/admin/odbc-data-source-administrator)или создать новые с помощью этого диалогового окна.

     Чтобы создать новый файловый источник данных из этого диалогового окна, `New` щелкните, чтобы указать имя DSN; откроется диалоговое окно **Создание нового источника данных** . В диалоговом окне **Создание нового источника данных** выберите подходящий драйвер и нажмите кнопку `Next` **Обзор**, а затем выберите имя файла, который будет использоваться в качестве источника данных (для просмотра файлов, не являющихся DSN-файлами, таких как XLS-файлы, необходимо выбрать значение "все файлы"); нажмите кнопку , а затем нажмите кнопку **Готово.** `Next` (Если вы выбрали файл, отличный от DSN, появится диалоговое окно для конкретного драйвера, например «программа установки ODBC Microsoft Excel», которая преобразует файл в имя DSN.)

     > [!NOTE]
     > Кроме того, можно заранее создать новый файловый источник данных с помощью администратора источников данных ODBC. В меню **Пуск** выберите **Параметры**, **Панель управления**, Администрирование, **Источники данных (ODBC)** , а затем — **Администратор источника данных ODBC**.

     Поле **имя DSN** позволяет указать имя для файлового источника данных. Необходимо убедиться, что имя DSN заканчивается соответствующим расширением файла, например XLS для файлов Excel или MDB для доступа к файлам.

     Дополнительные сведения об именах DSN см. в разделе [Файловые источники данных](/sql/odbc/reference/file-data-sources) в пакете SDK для ODBC.

  - Вкладка " **источник данных компьютера** ":

     На этой вкладке перечислены системные и пользовательские источники данных. Пользовательские источники данных зависят от пользователя на этом компьютере. Системные источники данных могут использоваться всеми пользователями на этом компьютере или в общедоступной службе. См. раздел [Источники данных на компьютере](/sql/odbc/reference/machine-data-sources) в пакете SDK для ODBC.

     Дополнительные сведения об источниках данных ODBC см. в разделе [Источники данных](/sql/odbc/reference/data-sources) в пакете SDK для ODBC.

  Щелкните **ОК** для завершения. Появится диалоговое окно **Выберите объект базы данных**. В этом диалоговом окне выберите таблицу или представление, которые будет использовать потребитель. Обратите внимание, что можно выбрать несколько представлений и таблиц, удерживая клавишу Control, щелкая их. Щелкните **ОК** для завершения.

- **Класс**

      The name of the consumer class, based by default on the name of the file or machine data source that you selected.

- **H-файл**

   Имя файла заголовка класса-получателя по умолчанию на основе выбранного имени файла или источника данных компьютера.

- **CPP-файл**

   Имя файла реализации класса потребителя по умолчанию на основе выбранного имени файла или источника данных компьютера.

- **Type**

   Указывает, является ли набор записей динамическим (по умолчанию) или моментальным снимком.

   - **Динамический**набор: Указывает, что набор записей является динамическим множеством. Динамический набор — это результат запроса, который предоставляет индексированное представление данных запрашиваемой базы данных. Динамический набор кэширует только целочисленный индекс исходных данных и, таким же, обеспечивает повышение производительности по сравнению с моментальным снимком. Индекс указывает непосредственно на каждую запись, найденную в результате запроса, и указывает, удаляется ли запись. У вас также есть доступ к обновленной информации в запрашиваемых записях. Это значение по умолчанию.

   - **Моментальный снимок**: Указывает, что набор записей является моментальным снимком. Моментальный снимок является результатом запроса и представляет собой представление базы данных в один момент времени. Все записи, найденные в результате запроса, кэшируются, поэтому изменения в исходных записях не отображаются.

- **Привязать все столбцы**

   Указывает, привязаны ли все столбцы в выбранной таблице. При выборе этого поля (по умолчанию) все столбцы будут привязаны; Если этот флажок не установлен, столбцы не привязаны, и их необходимо привязать вручную в классе Recordset.

::: moniker-end

## <a name="see-also"></a>См. также

[Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)
