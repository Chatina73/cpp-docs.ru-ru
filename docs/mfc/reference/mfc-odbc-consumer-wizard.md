---
title: мастер потребителей ODBC MFC
ms.date: 05/09/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: 2e8741677031ff9b12989d75243a13550d74b608
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2019
ms.locfileid: "65707386"
---
# <a name="mfc-odbc-consumer-wizard"></a>мастер потребителей ODBC MFC

::: moniker range="vs-2019"

Этот мастер не доступны в Visual Studio 2019 г. и более поздних версий.

::: moniker-end

::: moniker range="<=vs-2017"

Этот мастер устанавливает класс набора записей ODBC и привязки данных для доступа к указанному источнику данных.

## <a name="uielement-list"></a>Список элементов пользовательского интерфейса

- **Источник данных**

  **Источника данных** кнопку настраивать указанного источника данных с помощью заданного драйвера ODBC. Дополнительные сведения о файлах источника данных (DSN), см. в разделе [файловые источники данных](/sql/odbc/reference/file-data-sources) в ODBC SDK.

  **Выбор источника данных** диалоговое окно содержит две вкладки:

  - **Источник данных файла** вкладке:

     **Папка** поле указывает каталог, в котором для выбора файлов для использования в качестве источников данных. По умолчанию используется \Program Files\Common Files\ODBC\Data источников. В главном списке отображаются существующие файловые источники данных (DSN-файлы). Вы можете выбрать источники данных заранее с помощью **файловый DSN** вкладке [администратор источников данных ODBC](/sql/odbc/admin/odbc-data-source-administrator), или создать новые с помощью этого диалогового окна.

     Чтобы создать новый источник данных файла в этом диалоговом окне, щелкните `New` для указания имени DSN; **Создание нового источника данных** откроется диалоговое окно. В **Создание нового источника данных** диалоговое окно, выберите подходящий драйвер и нажмите кнопку `Next`; щелкните **Обзор**и выберите имя файла для использования в качестве источника данных (необходимо выбрать «Все файлы» в представление не DSN файлов, например XLS-файлы); Нажмите кнопку `Next`, а затем нажмите кнопку **Готово**. (Если выбран файл, не являющиеся DSN, вы получите специфические для драйвера диалоговое окно, например «Настройка ODBC Microsoft Excel, «который преобразует файл в DSN.)

     > [!NOTE]
     > Можно также создать новый источник данных файла заранее с помощью администратора источника данных ODBC. Из **запустить** меню, выберите **параметры**, **панели управления**, **Администрирование**, **источники данных (ODBC)**, а затем **администратор источников данных ODBC**.

     **Имя DSN** поле позволяет указать имя файла источника данных. Необходимо убедиться, что имя DSN заканчивается соответствующее расширение файла, например .xls для файлов Excel или .mdb для доступа к файлам.

     Дополнительные сведения о источников данных, см. в разделе [файловые источники данных](/sql/odbc/reference/file-data-sources) в ODBC SDK.

  - **Компьютера источника данных** вкладке:

     На этой вкладке перечислены системы и источники данных. Источники данных пользователя относятся только к пользователя на этом компьютере. Системные источники данных может использоваться всеми пользователями на этом компьютере или в службе для всей системы. См. в разделе [машинные источники данных](/sql/odbc/reference/machine-data-sources) в пакете SDK ODBC

     Дополнительные сведения об источниках данных ODBC см. в разделе [источников данных](/sql/odbc/reference/data-sources) в ODBC SDK.

  Нажмите кнопку **ОК** до конца. **Выбор объектов базы данных** откроется диалоговое окно. В этом диалоговом окне выберите таблицу или просмотреть, что потребитель будет использовать. Обратите внимание на то, что можно выбрать несколько представлений и таблиц, удерживая клавишу CTRL при щелчке элементов. Нажмите кнопку **ОК** до конца.

- **Класс**

      The name of the consumer class, based by default on the name of the file or machine data source that you selected.

- **H-файл**

   Имя файла заголовка класса потребителя, по умолчанию на основе имени файла или компьютера источника данных, выбранного.

- **CPP-файл**

   Имя файла реализации класса потребителя, по умолчанию на основе имени файла или компьютера источника данных, выбранного.

- **Type**

   Указывает, является ли набор записей подмножества (по умолчанию) или моментального снимка.

   - **Динамический набор**: Указывает, что набор записей является динамическим подмножеством данных. Динамический набор является результатом запроса, который предоставляет индексированное представление в запрошенных данных базы данных. Подмножества кэширует только целочисленный индекс исходных данных и таким образом обеспечивается повышение производительности за моментального снимка. Индекс точки непосредственно для каждой записи найденных в результате запроса и указывает, если запись удаляется. Также имеется доступ к обновленным данным в запрошенных записях. Это значение по умолчанию.

   - **Моментальный снимок**: Указывает, что набор записей является моментальным снимком. Моментальный снимок является результатом запроса и — это представление базы данных в один момент времени. Все записи, обнаруженные в результате запроса кэшируются, поэтому вы не видите любые изменения исходных записей.

- **Привязать все столбцы**

   Указывает, связаны ли все столбцы в выбранной таблице. Если установить этот флажок (по умолчанию), все столбцы привязаны; Если этот флажок не установлен, столбцы не привязаны, и необходимо привязать их вручную в классе наборов записей.

::: moniker-end

## <a name="see-also"></a>См. также

[Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)
