---
title: мастер потребителей ODBC MFC
ms.date: 08/29/2019
helpviewer_keywords:
- wizards [MFC]
ms.assetid: f64a890b-a252-4887-88a1-782a7cd4ff3d
ms.openlocfilehash: 45087434c0093f99383096761d58a8029c9d5009
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373026"
---
# <a name="mfc-odbc-consumer-wizard"></a>мастер потребителей ODBC MFC

::: moniker range="vs-2019"

Этот мастер недоступен в Visual Studio 2019 и более поздних версиях.

::: moniker-end

::: moniker range="<=vs-2017"

Этот мастер устанавливает класс записей ODBC и привязки данных, необходимые для доступа к указанному источнику данных.

## <a name="uielement-list"></a>Список элементов пользовательского интерфейса

- **Источник данных**

  Кнопка **«Источник данных»** позволяет настроить указанный источник данных с помощью указанного драйвера ODBC. Для получения дополнительной информации о файлах источника данных (DSN) [см.](/sql/odbc/reference/file-data-sources)

  Поле для диалога **Select Data Source** имеет две вкладки:

  - Вкладка **Источник данных файлов:**

     **Взгляд в** поле определяет каталог, в котором можно выбрать файлы, которые будут использоваться в качестве источников данных. По умолчанию по умолчанию —«Файлы программы», Общие файлы, «Источники данных ODBC». Существующие источники данных файлов (.dsn- файлы) отображаются в основном поле списка. Вы можете либо настроить источники данных заранее, используя вкладку **Файл DSN** на [администраторе источника данных ODBC,](/sql/odbc/admin/odbc-data-source-administrator)или создать новые, используя этот диалоговый ящик.

     Чтобы создать новый источник данных файла `New` из этого диалогового окна, нажмите, чтобы указать имя DSN; Отображается диалоговый ящик **«Создай новый источник данных».** В диалоговом окне **«Создайте новый** `Next`источник данных» выберите подходящий драйвер и нажмите кнопку ; нажмите **«Просмотреть»** и выбрать название файла, который будет использоваться в качестве источника данных (для просмотра файлов, не относятсяотных на DSN, таких как файлы .xls); нажмите `Next`, а затем нажмите **Закончить**. (Если вы выбрали файл, не относясь к DSN, вы получите поле диалога, например "ODBC Microsoft Excel Setup", которое преобразует файл в DSN.)

     > [!NOTE]
     > Можно также заранее создать новый источник данных файла с помощью администратора источника данных ODBC. Из меню **«Пуск»** выберите **Настройки,** **Панель управления,** **Административные инструменты,** **Источники данных (ODBC),** а затем **администратор источника данных ODBC.**

     Поле **dSN Name** позволяет указать имя источника данных файла. Необходимо убедиться, что имя DSN заканчивается соответствующим расширением файла, например .xls для файлов Excel или .mdb для файлов Access.

     Для получения дополнительной информации о DSNs, [см.](/sql/odbc/reference/file-data-sources)

  - **Вкладка "Источник данных машины":**

     В этой вкладке перечислены системы и источники DATA пользователя. Источники пользовательских данных специфичны для пользователя на этой машине. Источники системных данных могут использоваться всеми пользователями на этой машине или в общесистемном сервисе. Смотрите [источники данных машины](/sql/odbc/reference/machine-data-sources) в ODBC SDK

     Более подробную информацию об источниках данных ODBC можно освяить [в](/sql/odbc/reference/data-sources) ODBC SDK.

  Для завершения нажмите кнопку **ОК**. Появится диалоговое окно **Выберите объект базы данных**. Из этого окна диалога выберите таблицу или представление, которое будет использовать потребитель. Обратите внимание, что вы можете выбрать несколько представлений и таблиц, удерживая ключ управления при нажатии на элементы. Для завершения нажмите кнопку **ОК**.

- **Class**

   Имя класса потребителей, основанное по умолчанию на названии выбранного вами файла или источника машинных данных.

- **H-файл**

   Имя выбранного файла заголовка класса потребителя, основанного по умолчанию на выбранном вами типе файла или машинных данных.

- **CPP-файл**

   Имя выбранного файла реализации класса потребителя, основанного по умолчанию на названии выбранного файла или источника машинных данных.

- **Type**

   Уточняется, является ли запись динасетом (по умолчанию) или моментальным снимком.

  - **Dynaset**: Указывает, что рекорд - динасет. Динасет является результатом запроса, который предоставляет индексированное представление в данные запрашиваемых баз данных. Динасет кэши только интегральный индекс исходных данных и, таким образом, предлагает увеличение производительности по сравнению с моментальным снимком. Индекс указывает непосредственно на каждую запись, найденную в результате запроса, и указывает, удалена ли запись. У вас также есть доступ к обновленной информации в запрашиваемых записях. Это значение по умолчанию.

  - **Снимок**: Указывает, что запись является моментальным снимком. Снимок является результатом запроса и представляет собой представление в базу данных в один момент времени. Все записи, найденные в результате запроса, кэшируются, поэтому вы не видите никаких изменений в исходных записях.

- **Связать все столбцы**

   Определяется, связаны ли все столбцы в выбранной таблице. При выборе этого окна (по умолчанию) все столбцы связаны; если вы не выберете эту коробку, никакие столбцы не связаны, и вы должны связать их вручную в классе recordset.

::: moniker-end

## <a name="see-also"></a>См. также раздел

[Потребление MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md)<br/>
[Добавление функциональных возможностей с помощью мастеров кода](../../ide/adding-functionality-with-code-wizards-cpp.md)
