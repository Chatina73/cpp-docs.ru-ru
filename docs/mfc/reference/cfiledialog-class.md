---
title: Класс CFileDialog
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: c301766b64af7fc1523b39adad91d9b52a5e88f7
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69506597"
---
# <a name="cfiledialog-class"></a>Класс CFileDialog

Инкапсулирует общее диалоговое окно, используемое для операций открытия или сохранения файлов.

## <a name="syntax"></a>Синтаксис

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CFileDialog:: CFileDialog](#cfiledialog)|Создает объект `CFileDialog`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CFileDialog:: Аддчеккбуттон](#addcheckbutton)|Добавляет кнопку проверки в диалоговое окно.|
|[CFileDialog:: Аддкомбобокс](#addcombobox)|Добавляет поле со списком в диалоговое окно.|
|[CFileDialog:: Аддконтролитем](#addcontrolitem)|Добавляет элемент в контейнерный элемент управления в диалоговом окне.|
|[CFileDialog:: Аддедитбокс](#addeditbox)|Добавляет поле ввода в диалоговое окно.|
|[CFileDialog:: ДобавитьМеню](#addmenu)|Добавляет меню в диалоговое окно.|
|[CFileDialog:: Аддплаце](#addplace)|Перегружен. Добавляет папку в список мест, доступных пользователю для открытия или сохранения элементов.|
|[CFileDialog:: Аддпушбуттон](#addpushbutton)|Добавляет кнопку в диалоговое окно.|
|[CFileDialog:: Аддрадиобуттонлист](#addradiobuttonlist)|Добавляет к диалоговому окну группу переключателей (также называемую переключателем).|
|[CFileDialog:: Аддсепаратор](#addseparator)|Добавляет разделитель в диалоговое окно.|
|[CFileDialog:: AddText](#addtext)|Добавляет текстовое содержимое в диалоговое окно.|
|[CFileDialog:: Апплйофнтошеллдиалог](#applyofntoshelldialog)|Обновляет состояние `CFileDialog` объекта в соответствии с параметрами и флагами, хранящимися `m_ofn` в переменной элемента.|
|[CFileDialog::D Омодал](#domodal)|Отображает диалоговое окно и позволяет пользователю сделать выбор.|
|[CFileDialog:: Енаблеопендропдовн](#enableopendropdown)|Включает раскрывающийся список на кнопке **Открыть** или **сохранить** в диалоговом окне.|
|[CFileDialog:: Ендвисуалграуп](#endvisualgroup)|Останавливает Добавление элементов в визуальную группу в диалоговом окне.|
|[CFileDialog:: Жетчеккбуттонстате](#getcheckbuttonstate)|Возвращает текущее состояние кнопки проверки (флажок) в диалоговом окне.|
|[CFileDialog:: Жетконтролитемстате](#getcontrolitemstate)|Возвращает текущее состояние элемента в контейнерном элементе управления, найденном в диалоговом окне.|
|[CFileDialog:: Жетконтролстате](#getcontrolstate)|Возвращает текущее состояние видимости и включенных для данного элемента управления.|
|[CFileDialog:: Жетедитбокстекст](#geteditboxtext)|Возвращает текущий текст в элементе управления "поле ввода".|
|[CFileDialog::GetFileExt](#getfileext)|Возвращает расширение выбранного файла.|
|[CFileDialog:: имя_файла](#getfilename)|Возвращает имя выбранного файла.|
|[CFileDialog:: Жетфилетитле](#getfiletitle)|Возвращает заголовок выбранного файла.|
|[CFileDialog:: GetFolderPath](#getfolderpath)|Извлекает путь к открытой в данный момент папке или каталогу в диалоговом окне в стиле обозревателя **Открыть** или **Сохранить как** общее.|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|Извлекает внутренний COM-объект для настраиваемого `CFileDialog` объекта.|
|[CFileDialog:: Жетифилеопендиалог](#getifileopendialog)|Извлекает внутренний COM-объект для `CFileDialog` , который используется как диалоговое окно **открытия** файла.|
|[CFileDialog:: Жетифилесаведиалог](#getifilesavedialog)|Извлекает внутренний COM-объект для `CFileDialog` , который используется как диалоговое окно **сохранения** файла.|
|[CFileDialog:: Жетнекстпаснаме](#getnextpathname)|Возвращает полный путь к следующему выбранному файлу.|
|[CFileDialog::GetOFN](#getofn)|`OPENFILENAME` Извлекает структуру`CFileDialog` объекта.|
|[CFileDialog:: путь к файлу](#getpathname)|Возвращает полный путь к выбранному файлу.|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|Возвращает состояние "только для чтения" выбранного файла.|
|[CFileDialog::GetResult](#getresult)|Возвращает вариант, который пользователь сделал в диалоговом окне.|
|[CFileDialog:: в результатах](#getresults)|Возвращает варианты выбора пользователя в диалоговом окне, допускающем множественный выбор.|
|[CFileDialog:: Жетселектедконтролитем](#getselectedcontrolitem)|Возвращает определенный элемент из указанных элементов управления контейнера в диалоговом окне.|
|[CFileDialog:: Жетстартпоситион](#getstartposition)|Возвращает расположение первого элемента в списке имен файлов.|
|[CFileDialog:: Хидеконтрол](#hidecontrol)|Скрывает указанный элемент управления в стиле обозревателя ( **Открытие** или **Сохранение** в общем диалоговом окне).|
|[CFileDialog:: Испиккфолдерсмоде](#ispickfoldersmode)|Определяет, находится ли текущее диалоговое окно в режиме выбора папки.|
|[CFileDialog:: Макепроминент](#makeprominent)|Помещает элемент управления в диалоговом окне, чтобы он был сравнен с другими добавленными элементами управления.|
|[CFileDialog:: Ремовеконтролитем](#removecontrolitem)|Удаляет элемент из элемента управления контейнера в диалоговом окне.|
|[CFileDialog:: Сетчеккбуттонстате](#setcheckbuttonstate)|Задает текущее состояние кнопки проверки (флажок) в диалоговом окне.|
|[CFileDialog:: Сетконтролитемстате](#setcontrolitemstate)|Задает текущее состояние элемента в контейнерном элементе управления, найденном в диалоговом окне.|
|[CFileDialog:: Сетконтролитемтекст](#setcontrolitemtext)|Задает текст элемента управления. Например, текст, сопровождающий переключатель или элемент в меню.|
|[CFileDialog:: Сетконтроллабел](#setcontrollabel)|Задает текст, связанный с элементом управления, например текст кнопки или метка поля редактирования.|
|[CFileDialog:: Сетконтролстате](#setcontrolstate)|Задает текущее состояние видимости и включенных для данного элемента управления.|
|[CFileDialog:: Сетконтролтекст](#setcontroltext)|Задает текст для указанного элемента управления в стиле обозревателя **Открыть** или **Сохранить как** общее диалоговое окно.|
|[CFileDialog:: Сетдефекст](#setdefext)|Задает расширение имени файла по умолчанию для обозревателя в стиле « **Открыть** » или « **Сохранить как** общее».|
|[CFileDialog:: Сетедитбокстекст](#seteditboxtext)|Задает текущий текст в элементе управления "поле ввода".|
|[CFileDialog:: SetProperties](#setproperties)|Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.|
|[CFileDialog:: Сетселектедконтролитем](#setselectedcontrolitem)|Задает выбранное состояние определенного элемента в группе переключателей или поле со списком, которое находится в диалоговом окне.|
|[CFileDialog:: Сеттемплате](#settemplate)|Задает шаблон диалогового окна для `CFileDialog` объекта.|
|[CFileDialog:: Стартвисуалграуп](#startvisualgroup)|Объявляет визуальную группу в диалоговом окне. Последующие вызовы любого метода "Add" добавляют эти элементы в эту группу.|
|[CFileDialog:: Упдатеофнфромшеллдиалог](#updateofnfromshelldialog)|Обновляет данные, хранящиеся в `m_ofn` переменной элемента, в соответствии с текущим состоянием диалогового окна файла.|

### <a name="protected-methods"></a>Защищенные методы

|name|Описание|
|----------|-----------------|
|[CFileDialog:: Онбуттонкликкед](#onbuttonclicked)|Вызывается при нажатии кнопки.|
|[CFileDialog:: Ончеккбуттонтогглед](#oncheckbuttontoggled)|Вызывается, когда флажок установлен или снят.|
|[CFileDialog:: Онконтролактиватинг](#oncontrolactivating)|Вызывается при активном элементе управления.|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|Обрабатывает сообщение CDN_SELCHANGE WM_NOTIFY.|
|[CFileDialog:: Онфиленамеок](#onfilenameok)|Проверяет имя файла, указанное в диалоговом окне.|
|[CFileDialog:: Онфолдерчанже](#onfolderchange)|Обрабатывает сообщение CDN_FOLDERCHANGE WM_NOTIFY.|
|[CFileDialog:: Онинитдоне](#oninitdone)|Обрабатывает сообщение CDN_INITDONE WM_NOTIFY.|
|[CFileDialog:: Онитемселектед](#onitemselected)|Вызывается при выборе элемента контейнера.|
|[CFileDialog:: Онлбселчанжеднотифи](#onlbselchangednotify)|Позволяет выполнять настраиваемые действия при изменении выбора файлов.|
|[CFileDialog::OnShareViolation](#onshareviolation)|Обрабатывает нарушения общего доступа.|
|[CFileDialog::OnTypeChange](#ontypechange)|Обрабатывает сообщение CDN_TYPECHANGE WM_NOTIFY.|

### <a name="public-data-members"></a>Открытые члены данных

|name|Описание|
|----------|-----------------|
|[CFileDialog:: m_ofn](#m_ofn)|Структура Windows `OPENFILENAME` . Предоставляет доступ к базовым параметрам диалогового окна файла.|

## <a name="remarks"></a>Примечания

Общие диалоговые окна файлов позволяют реализовать диалоговые окна выбора файлов, например **Открыть файл** и **Сохранить как**, так, чтобы они соответствовали стандартам Windows.

Можно использовать `CFileDialog` в качестве с предоставленным конструктором или создать собственный класс диалогового окна из `CFileDialog` и написать конструктор в соответствии с вашими потребностями. В любом случае эти диалоговые окна будут вести себя так же, как стандартные диалоговые окна MFC, поскольку они являются производными от [класса ккоммондиалог](../../mfc/reference/ccommondialog-class.md). `CFileDialog`полагается на КОММДЛГ. DLL-файл, включенный в Windows.

Как внешний вид, так и функциональные возможности `CFileDialog` в Windows Vista или более поздней версии отличаются от более ранних версий Windows. По умолчанию `CFileDialog` автоматически используется новый стиль Windows Vista или более поздней версии без изменения кода, если программа компилируется и запускается в Windows Vista или более поздней версии. Используйте параметр *бвистастиле* в конструкторе, чтобы вручную переопределить это автоматическое обновление. Исключением из автоматического обновления являются настраиваемые диалоговые окна. Они не будут преобразованы в новый стиль. Дополнительные сведения о конструкторе см. в разделе [CFileDialog:: CFileDialog](#cfiledialog).

> [!NOTE]
>  Система ИДЕНТИФИКАТОРов элементов управления отличается в Windows Vista или более поздней версии от более ранних версий `CFileDialog`Windows при использовании. Прежде чем можно будет перенести проект `CFileDialog` из более ранней версии Windows, необходимо обновить все ссылки на элементы управления в коде.

Некоторые `CFileDialog` методы не поддерживаются в Windows Vista и более поздних версиях. Дополнительные сведения о том, поддерживается ли метод, см. в разделе по отдельным методам. Кроме того, в Windows Vista и более поздних версиях не поддерживаются следующие унаследованные функции:

- [CDialog:: Онинитдиалог](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog:: Онсетфонт](../../mfc/reference/cdialog-class.md#onsetfont)

Сообщения Windows для `CFileDialog` класса зависят от используемой операционной системы. Например, в `CFileDialog` Windows XP не поддерживается класс [CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel) и [CDialog:: ОНОК](../../mfc/reference/cdialog-class.md#onok) для класса. Однако операционные системы Windows Vista и более поздних версий поддерживают их. Дополнительные сведения о различных создаваемых сообщениях и порядке их получения см. в разделе [CFileDialog Sample: Регистрация порядка](../../overview/visual-cpp-samples.md)событий.

Чтобы использовать `CFileDialog` объект, сначала создайте объект с `CFileDialog` помощью конструктора. После создания диалогового окна можно задать или изменить любые значения в структуре [CFileDialog:: m_ofn](#m_ofn) , чтобы инициализировать значения или состояния элементов управления диалогового окна. Структура имеет тип `OPENFILENAME`. `m_ofn` Дополнительные сведения см. в описании структуры [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) в Windows SDK.

После инициализации элементов управления диалогового окна вызовите метод [CFileDialog::D омодал](#domodal) , чтобы отобразить диалоговое окно, чтобы пользователь мог ввести путь и имя файла. `DoModal`Возвращает значение, указывающее, щелкнул пользователь кнопку ОК (ИДОК) или Отмена (ИДКАНЦЕЛ). Если `DoModal` возвращает идок, можно использовать одну `CFileDialog` из открытых функций члена для получения сведений, получающих пользователя.

> [!NOTE]
> В Windows Vista или более поздних версиях несколько вызовов [ифиледиалог:: сетфилетипес](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes) вызывает ошибку. Второй вызов метода `SetFileTypes` для любого экземпляра `CFileDialog` функции возвратит E_UNEXPECTED в Windows Vista или более поздней версии. Некоторые `CFileDialog` функции методов вызывают `SetFileTypes`. Например, два вызова `CFileDialog::DoModal` для одного и того же экземпляра `CFileDialog` создает [Assert](diagnostic-services.md#assert).

`CFileDialog`включает несколько защищенных членов, которые позволяют выполнять пользовательскую обработку нарушений общего доступа, проверки имени файла и уведомления об изменении списка. Эти защищенные члены являются функциями обратного вызова, которые не должны использоваться большинством приложений, так как обработка по умолчанию выполняется автоматически. Записи схемы сообщений для этих функций не требуются, так как они являются стандартными виртуальными функциями.

Вы можете использовать функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка во время инициализации диалогового окна, и получить дополнительные сведения об ошибке.

Уничтожение `CFileDialog` объектов обрабатывается автоматически. Нет необходимости вызывать метод [CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog).

Чтобы пользователь мог выбрать несколько файлов, установите флаг OFN_ALLOWMULTISELECT перед вызовом `DoModal`. Необходимо указать собственный буфер имени файла, чтобы разместить возвращенный список имен нескольких файлов. Для этого замените `m_ofn.lpstrFile` указателем на выделенный буфер после `CFileDialog`создания, но перед вызовом `DoModal`.

Кроме того, необходимо задать `m_ofn.nMaxFile` с помощью числа символов в буфере, `m_ofn.lpstrFile`на который указывает. Если задать максимальное число файлов для выбора `n`, `n * (_MAX_PATH + 1) + 1`размер буфера должен быть. Первый элемент, возвращенный в буфере, — это путь к папке, в которой были выбраны файлы. В диалоговых окнах Windows Vista и более поздних версий строки имен каталогов и файлов завершаются нулем, а после последнего имени файла — символом NULL. Этот формат позволяет диалоговым окнам в стиле обозревателя возвращать длинные имена файлов, содержащие пробелы. В диалоговых окнах старого стиля строки имен файлов и каталогов разделяются пробелами, а функция использует короткие имена файлов для имен файлов с пробелами.

В следующем примере демонстрируется использование буфера для извлечения и перечисления нескольких имен файлов.

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Чтобы изменить размер буфера в ответ на выбор нескольких имен файлов, необходимо создать новый класс из `CFileDialog` и переопределить метод [CFileDialog:: онфиленамечанже](#onfilenamechange) .

Если вы наследуете новый класс от `CFileDialog`, для работы с сообщениями можно использовать схему сообщений. Чтобы расширить обработку сообщений по умолчанию, создайте производный класс `CFileDialog`от, добавьте к новому классу схему сообщений и предоставьте функции-члены для новых сообщений. Для настройки диалогового окна не требуется предоставлять функцию-обработчик.

Чтобы настроить диалоговое окно, создайте производный класс от `CFileDialog`, предоставьте настраиваемый шаблон диалогового окна и добавьте карту сообщений для обработки сообщений уведомлений из расширенных элементов управления. Передайте все необработанные сообщения базовому классу. Настраивать функцию-обработчик не нужно.

При использовании формата `CFileDialog`Windows Vista или более поздней версии нельзя использовать схемы сообщений и шаблоны диалоговых окон. Вместо этого для подобной функциональности необходимо использовать интерфейсы COM.

Дополнительные сведения об использовании `CFileDialog`см. в разделе [Общие классы диалоговых окон](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[ккоммондиалог](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>Требования

**Заголовок:** афксдлгс. h

##  <a name="addcheckbutton"></a>CFileDialog:: Аддчеккбуттон

Добавляет кнопку проверки в диалоговое окно.

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
ИДЕНТИФИКАТОР добавляемой кнопки проверки.

*strLabel*<br/>
Имя кнопки проверки.

*бчеккед*<br/>
Логическое значение, указывающее текущее состояние кнопки проверки. Значение TRUE, если флажок установлен; FALSE в противном случае

### <a name="remarks"></a>Примечания

##  <a name="addcombobox"></a>CFileDialog:: Аддкомбобокс

Добавляет поле со списком в диалоговое окно.

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор добавляемого поля со списком.

### <a name="remarks"></a>Примечания

##  <a name="addcontrolitem"></a>CFileDialog:: Аддконтролитем

Добавляет элемент в контейнерный элемент управления в диалоговом окне.

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера, в который добавляется элемент.

*двидитем*<br/>
Идентификатор элемента.

*strLabel*<br/>
Текст элемента.

### <a name="remarks"></a>Примечания

##  <a name="addeditbox"></a>CFileDialog:: Аддедитбокс

Добавляет поле ввода в диалоговое окно.

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор добавляемого поля ввода.

*стртекст*<br/>
Имя поля редактирования.

### <a name="remarks"></a>Примечания

##  <a name="addmenu"></a>CFileDialog:: ДобавитьМеню

Добавляет меню в диалоговое окно.

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор добавляемого меню.

*strLabel*<br/>
Имя меню.

### <a name="remarks"></a>Примечания

##  <a name="addplace"></a>CFileDialog:: Аддплаце

Добавляет папку в список мест, доступных пользователю для открытия или сохранения элементов.

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>Параметры

*лпсзфолдер*<br/>
Путь к папке, которую необходимо сделать доступной для пользователя. Это может быть только папка.

*фдап*<br/>
Указывает место размещения папки в списке.

*PSI*<br/>
Указатель на объект интерфейса IShellItem, представляющий папку, доступную пользователю. Это может быть только папка.

### <a name="remarks"></a>Примечания

##  <a name="addpushbutton"></a>CFileDialog:: Аддпушбуттон

Добавляет кнопку в диалоговое окно.

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
ИДЕНТИФИКАТОР добавляемой кнопки.

*strLabel*<br/>
Имя кнопки.

### <a name="remarks"></a>Примечания

##  <a name="addradiobuttonlist"></a>CFileDialog:: Аддрадиобуттонлист

Добавляет к диалоговому окну группу переключателей (также называемую переключателем).

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
ИДЕНТИФИКАТОР добавляемой группы переключателей.

### <a name="remarks"></a>Примечания

##  <a name="addseparator"></a>CFileDialog:: Аддсепаратор

Добавляет разделитель в диалоговое окно.

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор добавления разделителя.

### <a name="remarks"></a>Примечания

##  <a name="addtext"></a>CFileDialog:: AddText

Добавляет текст в диалоговое окно.

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор добавляемого текста.

*стртекст*<br/>
Текстовое имя.

### <a name="remarks"></a>Примечания

##  <a name="applyofntoshelldialog"></a>CFileDialog:: Апплйофнтошеллдиалог

Обновляет текущее состояние [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основе значений, хранящихся в `m_ofn` структуре данных.

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>Примечания

В версиях Windows до Windows Vista структура данных [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) элемента была непрерывно синхронизирована с состоянием `CFileDialog`. Любые изменения переменной члена [m_ofn](#m_ofn) сразу же отражены в состоянии диалогового окна. Кроме того, любые изменения состояния диалогового окна немедленно обновляют `m_ofn` переменную члена.

В Windows Vista и более поздних версиях значения в `m_ofn` переменной и состоянии `CFileDialog` элемента не гарантированно синхронизированы. Эта функция принудительно обновляет состояние `CFileDialog` объекта, чтобы оно `m_ofn` соответствовало структуре. Windows вызывает эту функцию автоматически во время [CFileDialog::D омодал](#domodal).

Дополнительные сведения об использовании `CFileDialog` класса в Windows Vista или более поздней версии см. в разделе [класс CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Пример

  См. пример для [CFileDialog:: упдатеофнфромшеллдиалог](#updateofnfromshelldialog).

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

Эта функция вызывается для создания стандартного диалогового окна Windows File.

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>Параметры

*бопенфиледиалог*<br/>
окне Параметр, указывающий тип создаваемого диалогового окна. Задайте для него значение TRUE, чтобы создать диалоговое окно **открытия файла** . Задайте для него значение FALSE, чтобы создать диалоговое окно **Сохранить как файл** .

*лпсздефекст*<br/>
окне Расширение имени файла по умолчанию. Если пользователь не включил известное расширение (которое имеет ассоциацию на компьютере пользователя) в поле filename (имя файла), расширение, указанное в *лпсздефекст* , автоматически добавляется к имени. Если этот параметр имеет значение NULL, расширение не добавляется.

*лпсзфиленаме*<br/>
окне Начальное имя файла, которое отображается в поле имя файла. Если значение равно NULL, начальное имя файла не отображается.

*dwFlags*<br/>
окне Сочетание одного или нескольких флагов, которые можно использовать для настройки диалогового окна. Описание этих флагов см. в описании структуры [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) в Windows SDK. При изменении `m_ofn.Flags` члена структуры используйте оператор побитового или в изменениях, чтобы не изменять поведение по умолчанию.

*лпсзфилтер*<br/>
окне Набор пар строк, задающих фильтры, которые можно применить к файлу. При указании фильтров файлов в списке файлов будут отображаться только файлы, соответствующие условиям фильтра. Дополнительные сведения о работе с фильтрами файлов см. в разделе "Примечания".

*ппарентвнд*<br/>
окне Указатель на родительское или окно-владелец диалогового окна файла.

*двсизе*<br/>
окне Размер `OPENFILENAME` структуры. Это значение зависит от версии операционной системы. MFC использует этот параметр, чтобы определить соответствующий тип создаваемого диалогового окна. Размер по умолчанию 0 означает, что код MFC определит правильный размер диалогового окна для использования в зависимости от версии операционной системы, в которой выполняется программа.

*бвистастиле*<br/>
окне **Примечание** . Этот параметр доступен в Visual Studio 2008 и более поздних версиях и приводит к тому, что диалоговое окно нового стиля будет использоваться только при работе в Windows Vista или более поздней версии.

Параметр, задающий стиль диалогового окна файла. Задайте значение TRUE, чтобы использовать новые диалоговые окна файла стиля Vista. В противном случае будет использоваться старый стиль диалоговых окон. Дополнительные сведения о работе в Vista см. в разделе "Примечания".

### <a name="remarks"></a>Примечания

В зависимости от значения *бопенфиледиалог*создается диалоговое окно **Открытие файла** или **Сохранение файла** .

Указание расширения по умолчанию с помощью *лпсздефекст* может не привести к ожидаемому поведению, так как это редко прогнозирует, какие расширения имеют сопоставления файлов на компьютере пользователя. Если требуется больший контроль над добавлением расширения по умолчанию, можно создать собственный класс из `CFileDialog`и `CFileDialog::OnFileNameOK` переопределить метод для выполнения собственной обработки расширения.

Чтобы разрешить пользователю выбирать несколько файлов, установите флаг OFN_ALLOWMULTISELECT перед вызовом [DoModal](#domodal). Необходимо указать собственный буфер имени файла для хранения возвращенного списка имен нескольких файлов. Для этого замените `m_ofn.lpstrFile` указателем на выделенный буфер после создания [CFileDialog](../../mfc/reference/cfiledialog-class.md), но перед вызовом `DoModal`. Кроме того, необходимо задать `m_ofn.nMaxFile` количество символов в буфере, `m_ofn.lpstrFile`на которое указывает. Если задать для параметра Максимальное число файлов, которое будет выбрано равным *n*, то необходимый размер `n`буфера будет равным * (_MAX_PATH + 1) + 1. Например:

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

Чтобы разрешить пользователю изменять размер диалогового окна в стиле обозревателя с помощью мыши или клавиатуры, установите флаг OFN_ENABLESIZING. Установка этого флага необходима только в том случае, если вы предоставляете процедуру-обработчик или пользовательский шаблон. Флаг работает только с диалоговым окном «обозреватель-стиль». невозможно изменить размер диалоговых окон старого типа.

Параметр *лпсзфилтер* используется для определения типа имени файла, который должен быть отображен в списке файлов. Первая строка в паре строк описывает фильтр. Вторая строка указывает расширение имени файла для использования. Можно указать несколько расширений, используя точку с запятой (символ ";") в качестве разделителя. Строка заканчивается двумя символами "&#124;", за которыми следует символ null. Для этого параметра также можно использовать объект [CString](../../atl-mfc-shared/using-cstring.md) .

Например, Microsoft Excel позволяет пользователям открывать файлы с расширениями кслк (диаграмма) или XLS (лист). Фильтр для Excel можно написать следующим образом:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

Однако если вы планируете использовать эту строку для непосредственного обновления `OPENFILENAME` структуры, следует разделить строки символами NULL, "\ 0", а не вертикальными линиями ("&#124;").

Параметр *бвистастиле* применяется только при работе под управлением Windows Vista или более поздней версии. В более ранних версиях Windows этот параметр игнорируется. Если для *бвистастиле* ЗАДАНО значение true, то при компиляции программы в Visual Studio 2008 или более поздней версии будет использоваться **диалоговое окно нового файла** стиля Vista. В противном случае будет использоваться предыдущее **диалоговое окно файла** стиля MFC.

Шаблоны диалоговых окон не поддерживаются в диалоговых окнах, основанных на *бвистастиле*

### <a name="example"></a>Пример

  См. пример для [CFileDialog::D омодал](#domodal).

##  <a name="domodal"></a>CFileDialog::D Омодал

Вызовите эту функцию, чтобы открыть диалоговое окно Common File Windows и позволить пользователю просматривать файлы и каталоги и вводить имя файла.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Возвращаемое значение

ИДОК или ИДКАНЦЕЛ. Если возвращается ИДКАНЦЕЛ, вызовите функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка.

ИДОК и ИДКАНЦЕЛ — это константы, которые указывают, выбрал ли пользователь кнопку ОК или Отмена.

### <a name="remarks"></a>Примечания

Если требуется инициализировать различные параметры диалогового окна файла путем установки членов `m_ofn` структуры, следует сделать это перед вызовом метода `DoModal`, но после создания объекта диалогового окна.

Например, если вы хотите разрешить пользователю выбирать несколько файлов, установите флаг OFN_ALLOWMULTISELECT перед вызовом `DoModal`, как показано в примере кода в этом разделе.

Когда пользователь нажимает кнопку «ОК» или «отмена» диалогового окна или выбирает параметр «закрыть» в меню управления диалогового окна, элемент управления возвращается в приложение. Затем можно вызвать другие функции члена для получения параметров или сведений, вводимых пользователем в диалоговое окно.

`DoModal`— это виртуальная функция, переопределенная из класса `CDialog`.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>CFileDialog:: Енаблеопендропдовн

Включает раскрывающийся список на кнопке Открыть или сохранить в диалоговом окне.

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор раскрывающегося списка.

### <a name="remarks"></a>Примечания

##  <a name="endvisualgroup"></a>CFileDialog:: Ендвисуалграуп

Останавливает Добавление элементов в визуальную группу в диалоговом окне.

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>Возвращаемое значение

В случае успешного выполнения возвращает значение S_OK; значение ошибки в противном случае.

### <a name="remarks"></a>Примечания

##  <a name="getcheckbuttonstate"></a>CFileDialog:: Жетчеккбуттонстате

Извлекает текущее состояние кнопки проверки (флажок) в диалоговом окне.

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор флажка.

*бчеккед*<br/>
Состояние флажка. Значение TRUE указывает, что установлен флажок; Значение FALSE означает, что флажок снят.

### <a name="remarks"></a>Примечания

##  <a name="getcontrolitemstate"></a>CFileDialog:: Жетконтролитемстате

Извлекает текущее состояние элемента в контейнерном элементе управления, найденном в диалоговом окне.

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента.

*двстате*<br/>
Ссылка на переменную, которая получает одно из нескольких значений из перечисления КДКОНТРОЛСТАТЕ, которое указывает текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="getcontrolstate"></a>CFileDialog:: Жетконтролстате

Извлекает текущие состояния видимости и включения данного элемента управления.

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления.

*двстате*<br/>
Ссылка на переменную, которая получает одно или несколько значений из перечисления КДКОНТРОЛСТАТЕ, которое указывает текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="geteditboxtext"></a>CFileDialog:: Жетедитбокстекст

Извлекает текущий текст в элементе управления "поле ввода".

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор поля ввода.

*стртекст*<br/>
Текстовое значение.

### <a name="remarks"></a>Примечания

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

Вызовите эту функцию, чтобы получить расширение имени файла, указанного в диалоговом окне.

```
CString GetFileExt() const;
```

### <a name="return-value"></a>Возвращаемое значение

Расширение имени файла.

### <a name="remarks"></a>Примечания

Например, если в качестве имени файла указаны данные. Txt, `GetFileExt` возвращает «txt».

Если `m_ofn.Flags` параметр имеет установленный флаг OFN_ALLOWMULTISELECT, эта строка содержит последовательность строк, завершающихся нулем, первая строка которой является путем к каталогу выбранной файловой группы, а затем имена всех файлов, выбранных пользователем. Чтобы получить пути к файлам, используйте функции члена [жетстартпоситион](#getstartposition) и [жетнекстпаснаме](#getnextpathname) .

##  <a name="getfilename"></a>CFileDialog:: имя_файла

Вызовите эту функцию, чтобы получить имя файла, указанного в диалоговом окне.

```
CString GetFileName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Имя файла

### <a name="remarks"></a>Примечания

Имя файла включает как префикс, так и расширение. Например, `GetFileName` вернет "Text. DAT» для файла К:\ФИЛЕС\ТЕКСТ.дат.

Если `m_ofn.Flags` параметр `OFN_ALLOWMULTISELECT` имеет установленный флаг, необходимо вызвать [жетстартпоситион](#getstartposition) и [жетнекстпаснаме](#getnextpathname) , чтобы получить путь к файлу.

##  <a name="getfiletitle"></a>CFileDialog:: Жетфилетитле

Вызовите эту функцию, чтобы получить заголовок файла, указанного в диалоговом окне.

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Заголовок файла.

### <a name="remarks"></a>Примечания

Заголовок файла включает только его префикс, без пути или расширения. Например, `GetFileTitle` вернет "Text" для файла к:\филес\текст.дат.

Если `m_ofn.Flags` параметр имеет установленный флаг OFN_ALLOWMULTISELECT, эта строка содержит последовательность строк, завершающихся нулем, первая строка которой является путем к каталогу выбранной файловой группы, а затем имена всех файлов, выбранных пользователем. По этой причине используйте функции члена [жетстартпоситион](#getstartposition) и [жетнекстпаснаме](#getnextpathname) для получения следующего имени файла в списке.

### <a name="example"></a>Пример

  См. пример для [CFileDialog::D омодал](#domodal).

##  <a name="getfolderpath"></a>CFileDialog:: GetFolderPath

Вызовите эту функцию-член для получения пути к открытой в данный момент папке или каталогу в диалоговом окне Обозреватель в стиле открыть или сохранить как общее.

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , содержащий открытую в данный момент папку или каталог.

### <a name="remarks"></a>Примечания

Диалоговое окно должно быть создано с использованием стиля OFN_EXPLORER. в противном случае метод завершится ошибкой с утверждением.

Этот метод можно вызывать только при отображении диалогового окна. После закрытия диалогового окна Эта функция больше не будет работать, и метод завершится с утверждением.

##  <a name="getifiledialogcustomize"></a>CFileDialog:: Жетифиледиалогкустомизе

Получает указатель на внутренний COM-объект для заданного [CFileDialog](../../mfc/reference/cfiledialog-class.md).

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний COM-объект для `CFileDialog`. Вы обязаны правильно выпустить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, для которого параметр *бвистастиле* имеет значение true. Если вы используете эту функцию, когда *бвистастиле* имеет значение false, он вернет NULL в режим Release и выдаст утверждение в режиме отладки.

Дополнительные сведения об интерфейсе `IFileDialogCustomize` см. в разделе [ифиледиалогкустомизе](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

### <a name="example"></a>Пример

В этом примере извлекается внутренний COM-объект. Чтобы запустить этот пример кода, необходимо скомпилировать его в Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>CFileDialog:: Жетифилеопендиалог

Извлекает указатель на внутренний COM-объект для заданного `CFileDialog`объекта.

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний COM-объект для `CFileDialog`. Вы обязаны правильно выпустить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, для которого параметр *бвистастиле* имеет значение true. Эта функция возвращает значение null, `CFileDialog` если не является **открытым** диалоговым окном или если *бвистастиле* имеет значение false. В этом последнем случае функция возвращает значение NULL в режиме выпуска — в режиме отладки будет создано утверждение.

Дополнительные сведения об интерфейсе `IFileOpenDialog` см. в разделе [ифилеопендиалог](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog).

### <a name="example"></a>Пример

В этом примере извлекается внутренний COM-объект. Чтобы выполнить этот код, необходимо скомпилировать его в Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>CFileDialog:: Жетифилесаведиалог

Извлекает указатель на внутренний COM-объект для заданного `CFileDialog`объекта.

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на внутренний COM-объект для `CFileDialog`. Вы обязаны правильно выпустить этот указатель.

### <a name="remarks"></a>Примечания

Используйте эту функцию только в Windows Vista или более поздней версии с объектом, для которого параметр *бвистастиле* имеет значение true. Эта функция возвращает null, если `CFileDialog` не является диалоговым окном **сохранения** или если *бвистастиле* имеет значение false. В этом последнем случае функция возвращает значение NULL в режиме выпуска — в режиме отладки будет создано утверждение.

Дополнительные сведения об интерфейсе `IFileSaveDialog` см. в разделе [ифилесаведиалог](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog).

### <a name="example"></a>Пример

В этом примере извлекается внутренний COM-объект. Чтобы запустить этот пример кода, необходимо скомпилировать его в Windows Vista или более поздней версии.

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: Жетнекстпаснаме

Вызовите эту функцию, чтобы получить следующее имя файла из группы, выбранной в диалоговом окне.

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>Параметры

*POS*<br/>
Ссылка на значение значения value, возвращаемое предыдущим `GetNextPathName` вызовом функции или `GetStartPosition` . Значение NULL, если достигнут конец списка.

### <a name="return-value"></a>Возвращаемое значение

Полный путь к файлу.

### <a name="remarks"></a>Примечания

Путь к имени файла включает заголовок файла и полный путь к каталогу. Например, `GetNextPathName` возвратит "к:\филес\текст. DAT» для файла К:\ФИЛЕС\ТЕКСТ.дат. Можно использовать `GetNextPathName` в цикле прямой итерации, если исходное расположение устанавливается с `GetStartPosition`вызовом.

Если выбор состоит только из одного файла, будет возвращено это имя файла.

##  <a name="getofn"></a>CFileDialog:: Жетофн

Извлекает связанную `OPENFILENAME` структуру.

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>Возвращаемое значение

Структура [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) .

### <a name="remarks"></a>Примечания

Используйте вторую версию этой функции, чтобы инициализировать внешний вид диалогового окна **открытия файла** или **файла сохранить как** после его создания, но перед `DoModal` отображением с помощью функции-члена. Например, можно задать `lpstrTitle` `m_ofn` член в качестве заголовка, который должен иметь диалоговое окно.

##  <a name="getpathname"></a>CFileDialog:: путь к файлу

Вызовите эту функцию, чтобы получить полный путь к файлу, указанному в диалоговом окне.

```
CString GetPathName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Полный путь к файлу.

### <a name="remarks"></a>Примечания

Путь к имени файла включает заголовок файла и полный путь к каталогу. Например, `GetPathName` возвратит "к:\филес\текст. DAT» для файла К:\ФИЛЕС\ТЕКСТ.дат.

Если `m_ofn.Flags` параметр имеет установленный флаг OFN_ALLOWMULTISELECT, эта строка содержит последовательность строк со значением NULL, а первая строка — путь к каталогу выбранной файловой группы, за которым следуют имена всех файлов, выбранных пользователем. По этой причине используйте функции члена [жетстартпоситион](#getstartposition) и [жетнекстпаснаме](#getnextpathname) для получения следующего имени файла в списке.

### <a name="example"></a>Пример

  См. пример для [CFileDialog::D омодал](#domodal).

##  <a name="getreadonlypref"></a>CFileDialog:: Жетреадонлипреф

Вызовите эту функцию, чтобы определить, был ли установлен флажок только для чтения в диалоговых окнах открытия и сохранения файлов Windows Standard.

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если установлен флажок только чтение в диалоговом окне; в противном случае — 0.

### <a name="remarks"></a>Примечания

Флажок "только чтение" можно скрыть, задав стиль OFN_HIDEREADONLY в `CFileDialog` конструкторе.

> [!NOTE]
> Объекты стилей `CFileDialog` Windows Vista и более поздних версий не поддерживают эту функцию. При попытке использовать эту функцию в Windows Vista или более поздней `CFileDialog` версии будет выдано исключение [кнотсуппортедексцептион](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="getresult"></a>CFileDialog:: в результате

Извлекает выбор, сделанный пользователем в диалоговом окне.

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект интерфейса IShellItem, который представляет выбранный пользователем элемент.

### <a name="remarks"></a>Примечания

##  <a name="getresults"></a>CFileDialog:: в результатах

Получает варианты выбора пользователя в диалоговом окне, допускающем множественный выбор.

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на Ишеллитемаррай, через который можно получить доступ к элементам, выбранным в диалоговом окне.

### <a name="remarks"></a>Примечания

##  <a name="getselectedcontrolitem"></a>CFileDialog:: Жетселектедконтролитем

Извлекает определенный элемент из указанного элемента управления контейнера в диалоговом окне.

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента, выбранного пользователем в элементе управления.

### <a name="remarks"></a>Примечания

##  <a name="getstartposition"></a>CFileDialog:: Жетстартпоситион

Вызовите эту функцию члена, чтобы получить расположение первого имени файла в списке, если `m_ofn.Flags` установлен флаг OFN_ALLOWMULTISELECT.

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение расположения, которое можно использовать для итерации; Значение NULL, если список пуст.

##  <a name="hidecontrol"></a>CFileDialog:: Хидеконтрол

Вызовите эту функцию-член, чтобы скрыть заданный элемент управления в стиле обозревателя — открытие или сохранение в общем диалоговом окне.

```
void HideControl(int nID);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор элемента управления, который необходимо скрыть.

### <a name="remarks"></a>Примечания

Диалоговое окно должно быть создано с использованием стиля OFN_EXPLORER. в противном случае функция завершится ошибкой с утверждением.

##  <a name="ispickfoldersmode"></a>CFileDialog:: Испиккфолдерсмоде

Определяет, находится ли текущее диалоговое окно в режиме выбора папки.

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если диалоговое окно находится в режиме выбора папок. в противном случае — FALSE.

### <a name="remarks"></a>Примечания

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`представляет собой структуру типа `OPENFILENAME`. Данные в этой структуре представляют текущее состояние `CFileDialog`.

### <a name="remarks"></a>Примечания

Используйте эту структуру для инициализации внешнего вида диалогового окна **открытия файла** или **файла сохранить как** после его создания, но перед отображением его с помощью метода [DoModal](#domodal) . Например, можно задать `m_ofn` для элемента *лпстртитле* заголовок, который должен иметь диалоговое окно.

В Windows Vista и более поздних версиях [CFileDialog](../../mfc/reference/cfiledialog-class.md)не `m_ofn` гарантируется, что всегда будет соответствовать состоянию диалогового окна. Он синхронизируется с диалоговым окном в более ранних версиях Windows. Дополнительные сведения о `m_ofn` синхронизации структуры и `CFileDialog` состояния в Windows Vista или более поздней версии см. в разделе [CFileDialog:: апплйофнтошеллдиалог](#applyofntoshelldialog) and [CFileDialog:: упдатеофнфромшеллдиалог](#updateofnfromshelldialog) .

Диалоговые окна файлов стилей Windows Vista и более поздних версий не поддерживают определенные члены и `CFileDialog`флаги. В результате они не будут действовать.

Ниже приведен список элементов, которые не поддерживаются в Windows Vista и более поздних версиях.

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

Следующие флаги не поддерживаются, поэтому они не влияют на использование Windows Vista или более поздних версий `CFileDialog`.

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES — эффективно в Windows Vista или более поздней версии

- OFN_NOLONGNAMES — эффективно всегда отключен в Windows Vista или более поздних версиях

- OFN_NONETWORKBUTTON — эффективно в Windows Vista или более поздней версии

- OFN_READONLY

- OFN_SHOWHELP

Дополнительные сведения об этой структуре см. в описании структуры [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) в Windows SDK.

##  <a name="makeprominent"></a>CFileDialog:: Макепроминент

Помещает элемент управления в диалоговом окне, чтобы он был сравнен с другими элементами управления.

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="onbuttonclicked"></a>CFileDialog:: Онбуттонкликкед

Вызывается при нажатии кнопки.

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор кнопки.

### <a name="remarks"></a>Примечания

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: Ончеккбуттонтогглед

Вызывается, когда флажок установлен или снят.

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор флажка.

*бчеккед*<br/>
Установлен или снят.

### <a name="remarks"></a>Примечания

##  <a name="oncontrolactivating"></a>CFileDialog:: Онконтролактиватинг

Вызывается при активации элемента управления.

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="onfilenamechange"></a>CFileDialog:: Онфиленамечанже

Переопределите этот метод, если требуется выполнить обработку сообщения WM_NOTIFY CDN_SELCHANGE.

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>Примечания

Система отправляет сообщение CDN_SELCHANGE, когда пользователь выбирает новый файл или папку в списке файлов диалогового окна **Открыть** или **Сохранить как** . Переопределите этот метод, если вы хотите выполнять любые действия в ответ на это сообщение.

Система отправляет это сообщение только в том случае, если диалоговое окно было создано с включенным флагом OFN_EXPLORER. Дополнительные сведения об уведомлении см. в разделе [CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange). Сведения о флаге OFN_EXPLORER см. в статьях структура [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) , а [также открытие и сохранение в виде диалоговых](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)окон.

##  <a name="onfilenameok"></a>CFileDialog:: Онфиленамеок

Переопределяйте эту функцию только в том случае, если требуется обеспечить пользовательскую проверку имен файлов, вводимых в диалоговое окно общего файла.

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>Возвращаемое значение

1, если имя файла не является допустимым именем файла; в противном случае — 0.

### <a name="remarks"></a>Примечания

Эта функция позволяет отклонить имя файла для любой причины, зависящей от приложения. Обычно нет необходимости использовать эту функцию, поскольку платформа предоставляет проверку имен файлов по умолчанию и отображает окно сообщения, если введено недопустимое имя файла.

Если возвращается значение 1, диалоговое окно остается видимым пользователю для ввода другого имени файла. Процедура диалогового окна закрывает диалоговое окно, если возвращается значение 0. Другие ненулевые возвращаемые значения в настоящее время зарезервированы и не должны использоваться.

##  <a name="onfolderchange"></a>CFileDialog:: Онфолдерчанже

Переопределите эту функцию, чтобы она обрабатывала сообщение WM_NOTIFYCDN_FOLDERCHANGE.

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>Примечания

Сообщение уведомления отправляется при открытии новой папки в диалоговом окне Открыть или сохранить как.

Уведомление отправляется только в том случае, если диалоговое окно было создано с использованием стиля OFN_EXPLORER. Дополнительные сведения об уведомлении см. в разделе [CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange). Сведения о стиле OFN_EXPLORER см. в статьях структура [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) , а [также открытие и сохранение в виде диалоговых](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)окон.

##  <a name="oninitdone"></a>CFileDialog:: Онинитдоне

Переопределите эту функцию, чтобы она обрабатывал сообщение WM_NOTIFY CDN_INITDONE.

```
virtual void OnInitDone();
```

### <a name="remarks"></a>Примечания

Система отправляет это уведомление, когда система завершает упорядочение элементов управления в диалоговом окне **Открытие** или **Сохранение как** , чтобы освободить место для элементов управления дочернего диалогового окна.

Система отправляет этот объект только в том случае, если диалоговое окно было создано с использованием стиля OFN_EXPLORER. Дополнительные сведения об уведомлении см. в разделе [CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone). Сведения о стиле OFN_EXPLORER см. в статьях структура [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) , а [также открытие и сохранение в виде диалоговых](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)окон.

> [!NOTE]
> Диалоговые окна файлов стилей Windows Vista и более поздних версий не поддерживают эту функцию. При попытке использовать эту функцию в диалоговом окне файла стиля Windows Vista или более поздней версии будет выдано исключение [кнотсуппортедексцептион](../../mfc/reference/cnotsupportedexception-class.md).

##  <a name="onitemselected"></a>CFileDialog:: Онитемселектед

Вызывается, когда выбран элемент контейнера.

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента.

### <a name="remarks"></a>Примечания

##  <a name="onlbselchangednotify"></a>CFileDialog:: Онлбселчанжеднотифи

Эта функция вызывается при каждом изменении текущего выбора в окне списка.

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>Параметры

*нидбокс*<br/>
Идентификатор списка или поля со списком, в котором произошло выделение.

*икурсел*<br/>
Индекс текущего выделения.

*нкоде*<br/>
Код уведомления элемента управления. Этот параметр должен иметь одно из следующих значений:

- CD_LBSELCHANGE указывает, что *икурсел* является выбранным элементом в списке с единственным выбором.

- CD_LBSELSUB указывает, что *икурсел* больше не выбран в списке многовыборочного выбора.

- CD_LBSELADD указывает, что *икурсел* выбран в списке многовариантного выбора.

- CD_LBSELNOITEMS указывает, что ни один выбор не существует в списке многовариантного выбора.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, чтобы обеспечить настраиваемую обработку изменений выбора в списке. Например, эту функцию можно использовать для вывода прав доступа или даты последнего изменения каждого файла, выбираемого пользователем.

##  <a name="onshareviolation"></a>CFileDialog:: Оншаревиолатион

Переопределите эту функцию, чтобы обеспечить настраиваемую обработку нарушений общего доступа.

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Параметры

*лпсзпаснаме*<br/>
Путь к файлу, в котором произошло нарушение общего ресурса.

### <a name="return-value"></a>Возвращаемое значение

Одно из следующих значений:

- OFN_SHAREFALLTHROUGH. имя файла возвращается из диалогового окна.

- OFN_SHARENOWARN. дальнейшие действия не требуются.

- OFN_SHAREWARN. пользователь получает стандартное предупреждающее сообщение для этой ошибки.

### <a name="remarks"></a>Примечания

Как правило, эта функция не требуется, поскольку платформа обеспечивает проверку нарушений общего доступа по умолчанию и отображает окно сообщения, если возникает нарушение общего ресурса.

Если вы хотите отключить проверку нарушений общего доступа, используйте оператор побитового или, чтобы объединить флаг OFN_SHAREAWARE `m_ofn.Flags`с.

##  <a name="ontypechange"></a>CFileDialog:: Онтипечанже

Переопределите эту функцию, чтобы она обрабатывала сообщение WM_NOTIFYCDN_TYPECHANGE.

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>Примечания

Сообщение уведомления отправляется, когда пользователь выбирает новый тип файла из списка типов файлов в диалоговом окне Открыть или сохранить как.

Уведомление отправляется только в том случае, если диалоговое окно было создано с использованием стиля OFN_EXPLORER. Дополнительные сведения об уведомлении см. в разделе [CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange). Сведения о стиле OFN_EXPLORER см. в статьях структура [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew) , а [также открытие и сохранение в виде диалоговых](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)окон.

##  <a name="removecontrolitem"></a>CFileDialog:: Ремовеконтролитем

Удаляет элемент из элемента управления контейнера в диалоговом окне.

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера, из которого удаляется элемент.

*двидитем*<br/>
Идентификатор элемента.

### <a name="remarks"></a>Примечания

##  <a name="setcheckbuttonstate"></a>CFileDialog:: Сетчеккбуттонстате

Задает текущее состояние кнопки проверки (флажок) в диалоговом окне.

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор флажка.

*бчеккед*<br/>
Состояние флажка. Значение TRUE указывает, что установлен флажок; Значение FALSE означает, что флажок снят.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolitemstate"></a>CFileDialog:: Сетконтролитемстате

Задает текущее состояние элемента в контейнерном элементе управления, найденном в диалоговом окне.

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента.

*двстате*<br/>
Одно или несколько значений из перечисления КДКОНТРОЛСТАТЕ, которые указывают на новое состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolitemtext"></a>CFileDialog:: Сетконтролитемтекст

Задает текст элемента управления. Например, текст, сопровождающий переключатель или элемент в меню.

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента.

*strLabel*<br/>
Текст элемента.

### <a name="remarks"></a>Примечания

##  <a name="setcontrollabel"></a>CFileDialog:: Сетконтроллабел

Задает текст, связанный с элементом управления, например текст кнопки или метка поля редактирования.

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления.

*strLabel*<br/>
Имя элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontrolstate"></a>CFileDialog:: Сетконтролстате

Задает текущее состояние видимости и включенных для данного элемента управления.

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления.

*двстате*<br/>
Одно или несколько значений из перечисления КДКОНТРОЛСТАТЕ, которые указывают текущее состояние элемента управления.

### <a name="remarks"></a>Примечания

##  <a name="setcontroltext"></a>CFileDialog:: Сетконтролтекст

Вызовите этот метод, чтобы задать текст для указанного элемента управления в диалоговом окне в стиле обозревателя **Открыть** или **Сохранить как** .

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Идентификатор элемента управления, для которого задается текст.

*лпсз*<br/>
окне Указатель на строку, содержащую текст, заданный для элемента управления.

### <a name="remarks"></a>Примечания

Обе версии этой функции являются допустимыми для приложений, использующих Юникод. Однако для приложений, использующих ANSI, допустима только версия с типом LPCSTR.

Чтобы использовать этот метод, необходимо создать диалоговое окно с стилем OFN_EXPLORER. В противном случае функция завершится ошибкой с утверждением.

##  <a name="setdefext"></a>CFileDialog:: Сетдефекст

Вызывайте эту функцию, чтобы задать расширение имени файла по умолчанию для обозревателя в стиле «открыть» или «сохранить как общее».

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>Параметры

*лпсз*<br/>
Указатель на строку, содержащую расширение по умолчанию, используемое для объекта диалогового окна. Эта строка не должна содержать точку (.).

### <a name="remarks"></a>Примечания

Диалоговое окно должно быть создано с использованием стиля OFN_EXPLORER. в противном случае функция завершится ошибкой с утверждением.

##  <a name="seteditboxtext"></a>CFileDialog:: Сетедитбокстекст

Задает текущий текст в элементе управления "поле ввода".

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор поля ввода.

*стртекст*<br/>
Текстовое значение.

### <a name="remarks"></a>Примечания

##  <a name="setproperties"></a>CFileDialog:: SetProperties

Предоставляет хранилище свойств, которое определяет значения по умолчанию для сохраняемого элемента.

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>Параметры

*лпсзпроплист*<br/>
Список предварительно заданных свойств, разделенных точкой с запятой (";"). Список флагов см. в разделе flags статьи [OpenFileName](/windows/win32/api/commdlg/ns-commdlg-openfilenamew).

### <a name="remarks"></a>Примечания

##  <a name="setselectedcontrolitem"></a>CFileDialog:: Сетселектедконтролитем

Задает выбранное состояние определенного элемента в группе переключателей или поле со списком, которое находится в диалоговом окне.

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор элемента управления контейнера.

*двидитем*<br/>
Идентификатор элемента, выбранного пользователем в элементе управления.

### <a name="remarks"></a>Примечания

##  <a name="settemplate"></a>CFileDialog:: Сеттемплате

Задает шаблон диалогового окна для объекта [CFileDialog](../../mfc/reference/cfiledialog-class.md) .

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>Параметры

*nWin3ID*<br/>
окне Содержит идентификационный номер ресурса шаблона для объекта, не являющегося обозревателем `CFileDialog` . Этот шаблон используется только в Windows NT 3,51 или при отсутствии стиля OFN_EXPLORER.

*nWin4ID*<br/>
окне Содержит идентификационный номер ресурса шаблона для объекта Explorer `CFileDialog` . Этот шаблон используется только в Windows NT 4,0 и более поздних версиях, Windows 95 и более поздних версиях, а также при наличии стиля OFN_EXPLORER.

*lpWin3ID*<br/>
окне Содержит имя ресурса шаблона для объекта, не являющегося обозревателем `CFileDialog` . Этот шаблон используется только в Windows NT 3,51 или при отсутствии стиля OFN_EXPLORER.

*lpWin4ID*<br/>
окне Содержит имя ресурса шаблона объекта Explorer `CFileDialog` . Этот шаблон используется только в Windows NT 4,0 и более поздних версиях, Windows 95 и более поздних версиях, а также при наличии стиля OFN_EXPLORER.

### <a name="remarks"></a>Примечания

Система будет использовать только один из указанных шаблонов. Система определяет, какой шаблон следует использовать, в зависимости от наличия стиля OFN_EXPLORER и операционной системы, в которой работает приложение. Если указать как обозреватель, так и шаблон, не являющийся обозревателем, можно легко поддерживать Windows NT 3,51, Windows NT 4,0 и более поздние версии, а также Windows 95 и более поздние версии.

> [!NOTE]
> Диалоговые окна файлов в формате Windows Vista и более поздних версий не поддерживают эту функцию. При попытке использовать эту функцию в диалоговом окне файл стиля Windows Vista или более поздней версии будет выдано исключение [кнотсуппортедексцептион](../../mfc/reference/cnotsupportedexception-class.md). Альтернативой является использование настроенного диалогового окна. Дополнительные сведения об использовании пользовательской `CFileDialog`функции см. в разделе [ифиледиалогкустомизе](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize).

##  <a name="startvisualgroup"></a>CFileDialog:: Стартвисуалграуп

Объявляет визуальную группу в диалоговом окне. Последующие вызовы любого метода "Add" добавляют эти элементы в эту группу.

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>Параметры

*двидктл*<br/>
Идентификатор визуальной группы.

*strLabel*<br/>
Имя группы.

### <a name="remarks"></a>Примечания

##  <a name="updateofnfromshelldialog"></a>CFileDialog:: Упдатеофнфромшеллдиалог

Обновляет структуру данных `m_ofn` [CFileDialog](../../mfc/reference/cfiledialog-class.md) на основе текущего состояния внутреннего объекта.

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>Примечания

В версиях Windows до Windows Vista структура данных [OpenFileName](/previous-versions/windows/embedded/ms911906\(v=msdn.10\)) элемента была непрерывно синхронизирована с состоянием `CFileDialog`. Любые изменения в переменной члена [m_ofn](#m_ofn) непосредственно затронули состояние диалогового окна. Кроме того, любые изменения состояния диалогового окна сразу же обновляют переменную члена m_ofn.

В Windows Vista или более поздней `m_ofn` версии структура данных не обновляется автоматически. Чтобы гарантировать точность данных в `m_ofn` переменной члена, следует `UpdateOFNFromShellDialog` вызвать функцию перед доступом к данным. Windows вызывает эту функцию автоматически во время обработки [ифиледиалог:: OnFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok).

Дополнительные сведения об использовании `CFileDialog` класса в Windows Vista или более поздней версии см. в разделе [класс CFileDialog](../../mfc/reference/cfiledialog-class.md).

### <a name="example"></a>Пример

В `CFileDialog` этом примере перед отображением обновляется. Перед обновлением `m_ofn` переменной члена необходимо синхронизировать ее с текущим состоянием диалогового окна.

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>См. также

[Класс CCommonDialog](../../mfc/reference/ccommondialog-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)
