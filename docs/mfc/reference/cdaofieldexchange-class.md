---
title: Класс Кдаофиелдексчанже
ms.date: 09/17/2019
f1_keywords:
- CDaoFieldExchange
- AFXDAO/CDaoFieldExchange
- AFXDAO/CDaoFieldExchange::IsValidOperation
- AFXDAO/CDaoFieldExchange::SetFieldType
- AFXDAO/CDaoFieldExchange::m_nOperation
- AFXDAO/CDaoFieldExchange::m_prs
helpviewer_keywords:
- CDaoFieldExchange [MFC], IsValidOperation
- CDaoFieldExchange [MFC], SetFieldType
- CDaoFieldExchange [MFC], m_nOperation
- CDaoFieldExchange [MFC], m_prs
ms.assetid: 350a663e-92ff-44ab-ad53-d94efa2e5823
ms.openlocfilehash: cfffebd16c3c1d62dc4084b962c22911e4b46ae5
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426087"
---
# <a name="cdaofieldexchange-class"></a>Класс Кдаофиелдексчанже

Поддерживает процедуры обмена полями записей (DAO DFX), используемые классами баз данных DAO.

DAO поддерживается в Office 2013. Версия DAO 3,6 является окончательной и считается устаревшей.

## <a name="syntax"></a>Синтаксис

```
class CDaoFieldExchange
```

## <a name="members"></a>Члены

### <a name="public-methods"></a>Открытые методы

|Имя|Description|
|----------|-----------------|
|[Кдаофиелдексчанже:: Исвалидоператион](#isvalidoperation)|Возвращает ненулевое значение, если текущая операция подходит для типа обновляемого поля.|
|[Кдаофиелдексчанже:: Сетфиелдтипе](#setfieldtype)|Указывает тип элемента данных набора записей — столбец или параметр, представленный всеми последовательными вызовами функций DFX до следующего вызова `SetFieldType`.|

### <a name="public-data-members"></a>Открытые элементы данных

|Имя|Description|
|----------|-----------------|
|[Кдаофиелдексчанже:: m_nOperation](#m_noperation)|Операция DFX, выполняемая текущим вызовом функции члена `DoFieldExchange` набора записей.|
|[Кдаофиелдексчанже:: m_prs](#m_prs)|Указатель на набор записей, для которого выполняются операции DFX.|

## <a name="remarks"></a>Remarks

`CDaoFieldExchange` не имеет базового класса.

Этот класс используется при написании подпрограмм обмена данными для пользовательских типов данных. в противном случае вы не будете использовать этот класс напрямую. DFX обменивается данными между элементами данных поля объекта [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) и соответствующими полями текущей записи в источнике данных. DFX управляет обменом в обоих направлениях: от источника данных до источника данных. Сведения о написании пользовательских подпрограмм с DFX см. в [техническом примечании 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md) .

> [!NOTE]
>  Классы базы данных DAO отличаются от классов баз данных MFC, основанных на открытом подключении к базам данных (ODBC). Все имена классов баз данных DAO имеют префикс "Кдао". Вы по-прежнему можете обращаться к источникам данных ODBC с помощью классов DAO. Как правило, классы MFC, основанные на DAO, более поддерживаются, чем классы MFC, основанные на ODBC. Классы на основе DAO могут обращаться к данным, включая драйверы ODBC, через собственное ядро СУБД. Они также поддерживают операции языка описания данных (DDL), такие как добавление таблиц через классы вместо того, чтобы вызывать DAO самостоятельно.

> [!NOTE]
>  Обмен полями записей DAO очень похож на обмен полями записи (RFX) в классах базы данных MFC на основе ODBC (`CDatabase`, `CRecordset`). Если вы понимаете RFX, вы сможете легко использовать DFX.

Объект `CDaoFieldExchange` предоставляет сведения о контексте, необходимые для обмена полями записей DAO. `CDaoFieldExchange` объекты поддерживают ряд операций, включая параметры привязки и элементы данных полей, а также задание различных флагов для полей текущей записи. Неdfx операции выполняются с членами данных класса набора записей типов, определяемых **перечислением** **FieldType** в `CDaoFieldExchange`. Возможные значения **FieldType** :

- `CDaoFieldExchange::outputColumn` для элементов данных полей.

- `CDaoFieldExchange::param` для элементов данных параметров.

Функция-член [исвалидоператион](#isvalidoperation) предназначена для написания собственных пользовательских подпрограмм DFX. Часто вы будете использовать [сетфиелдтипе](#setfieldtype) в функциях [CDaoRecordset::D офиелдексчанже](../../mfc/reference/cdaorecordset-class.md#dofieldexchange) . Дополнительные сведения о неdfx глобальных функциях см. в статье [функции обмена полями записи](../../mfc/reference/record-field-exchange-functions.md). Дополнительные сведения о написании настраиваемых подпрограмм DFX для собственных типов данных см. в [техническом примечании 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`CDaoFieldExchange`

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

##  <a name="isvalidoperation"></a>Кдаофиелдексчанже:: Исвалидоператион

При написании собственной функции DFX вызовите `IsValidOperation` в начале функции, чтобы определить, может ли текущая операция выполняться над определенным типом элемента данных поля (`CDaoFieldExchange::outputColumn` или `CDaoFieldExchange::param`).

```
BOOL IsValidOperation();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая операция подходит для типа обновляемого поля.

### <a name="remarks"></a>Remarks

Некоторые операции, выполняемые методом DFX, применяются только к одному из возможных типов полей. Используйте модель существующих функций DFX.

Дополнительные сведения о написании пользовательских подпрограмм DFX см. в [техническом примечании 53](../../mfc/tn053-custom-dfx-routines-for-dao-database-classes.md).

##  <a name="m_noperation"></a>Кдаофиелдексчанже:: m_nOperation

Определяет операцию, которая должна быть выполнена с объектом [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) , связанным с объектом поля обмена.

### <a name="remarks"></a>Remarks

Объект `CDaoFieldExchange` предоставляет контекст для нескольких различных операций DFX в наборе записей.

> [!NOTE]
>  Значение ПСЕУДОНУЛЛ, описанное в операциях Маркфорадднев и Сетфиелднулл ниже, является значением, используемым для пометки полей значением NULL. Механизм обмена полями записей DAO (DFX) использует это значение, чтобы определить, какие поля были явно отмечены как null. ПСЕУДОНУЛЛ не является обязательным для полей [COleDateTime](../../atl-mfc-shared/reference/coledatetime-class.md) и [COleCurrency](../../mfc/reference/colecurrency-class.md) .

Возможные значения `m_nOperation`:

|Операция|Description|
|---------------|-----------------|
|`AddToParameterList`|Выполняет построение предложения **Parameters** инструкции SQL.|
|`AddToSelectList`|Выполняет сборку предложения **SELECT** инструкции SQL.|
|`BindField`|Привязывает поле в базе данных к расположению в памяти в приложении.|
|`BindParam`|Задает значения параметров для запроса набора записей.|
|`Fixup`|Задает состояние NULL для поля.|
|`AllocCache`|Выделяет кэш, используемый для проверки полей "грязных" в наборе записей.|
|`StoreField`|Сохраняет текущую запись в кэш.|
|`LoadField`|Восстанавливает переменные элементов кэшированных данных в наборе записей.|
|`FreeCache`|Освобождает кэш, используемый для проверки полей "грязных" в наборе записей.|
|`SetFieldNull`|Задает для поля Состояние значение NULL и значение ПСЕУДОНУЛЛ.|
|`MarkForAddNew`|Помечает поля как "грязные", если не ПСЕУДОНУЛЛ.|
|`MarkForEdit`|Помечает поля как "грязные", если они не совпадают с кэшем.|
|`SetDirtyField`|Задает значения полей, помеченные как "грязные".|
|`DumpField`|Выводит содержимое поля (только для отладки).|
|`MaxDFXOperation`|Используется для проверки входных данных.|

##  <a name="m_prs"></a>Кдаофиелдексчанже:: m_prs

Содержит указатель на объект [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) , связанный с объектом `CDaoFieldExchange`.

### <a name="remarks"></a>Remarks

##  <a name="setfieldtype"></a>Кдаофиелдексчанже:: Сетфиелдтипе

Вызовите `SetFieldType` в переопределении `DoFieldExchange` класса `CDaoRecordset`.

```
void SetFieldType(UINT nFieldType);
```

### <a name="parameters"></a>Параметры

*нфиелдтипе*<br/>
Значение **перечисления FieldType**, объявленное в `CDaoFieldExchange`, которое может иметь одно из следующих значений:

- `CDaoFieldExchange::outputColumn`

- `CDaoFieldExchange::param`

### <a name="remarks"></a>Remarks

Обычно ClassWizard записывает этот вызов. Если вы напишете собственную функцию и используете мастер для написания функции `DoFieldExchange`, добавьте вызовы собственной функции за пределами таблицы полей. Если мастер не используется, таблица полей не будет сопоставлена. Вызов предшествует вызовам DFX функций, по одному для каждого элемента данных поля класса, и определяет тип поля как `CDaoFieldExchange::outputColumn`.

При параметризации класса набора записей следует добавлять DFX вызовы для всех элементов данных параметров (за пределами таблицы полей) и перед этими вызовами с помощью вызова `SetFieldType`. Передайте значение `CDaoFieldExchange::param`. (Вместо этого можно использовать [кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md) и задать значения его параметров.)

Обычно перед каждой группой вызовов DFX, связанных с элементами данных поля или элементами данных параметров, должен предшествовать вызов `SetFieldType`. Параметр *нфиелдтипе* каждого вызова `SetFieldType` идентифицирует тип элементов данных, представленных вызовами функции DFX, которые следуют за вызовом `SetFieldType`.

## <a name="see-also"></a>См. также раздел

[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)
