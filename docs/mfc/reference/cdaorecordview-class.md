---
title: Класс CDaoRecordView
ms.date: 11/04/2016
f1_keywords:
- CDaoRecordView
- AFXDAO/CDaoRecordView
- AFXDAO/CDaoRecordView::CDaoRecordView
- AFXDAO/CDaoRecordView::IsOnFirstRecord
- AFXDAO/CDaoRecordView::IsOnLastRecord
- AFXDAO/CDaoRecordView::OnGetRecordset
- AFXDAO/CDaoRecordView::OnMove
helpviewer_keywords:
- CDaoRecordView [MFC], CDaoRecordView
- CDaoRecordView [MFC], IsOnFirstRecord
- CDaoRecordView [MFC], IsOnLastRecord
- CDaoRecordView [MFC], OnGetRecordset
- CDaoRecordView [MFC], OnMove
ms.assetid: 5aa7d0e2-bd05-413e-b216-80c404ce18ac
ms.openlocfilehash: f63aa8ed17619a9eef36e36bcc9243a3b973889a
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62207198"
---
# <a name="cdaorecordview-class"></a>Класс CDaoRecordView

Представление, которое отображает записи базы данных в элементах управления.

## <a name="syntax"></a>Синтаксис

```
class AFX_NOVTABLE CDaoRecordView : public CFormView
```

## <a name="members"></a>Участники

### <a name="protected-constructors"></a>Защищенные конструкторы

|name|Описание|
|----------|-----------------|
|[CDaoRecordView::CDaoRecordView](#cdaorecordview)|Создает объект `CDaoRecordView`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CDaoRecordView::IsOnFirstRecord](#isonfirstrecord)|Возвращает ненулевое значение, если текущая запись является первой записью в связанных записей.|
|[CDaoRecordView::IsOnLastRecord](#isonlastrecord)|Возвращает ненулевое значение, если текущая запись является последней записи в наборе связанных записей.|
|[CDaoRecordView::OnGetRecordset](#ongetrecordset)|Возвращает указатель на объект класса, производного от `CDaoRecordset`. ClassWizard переопределяет эту функцию автоматически и при необходимости создает набор записей.|
|[CDaoRecordView::OnMove](#onmove)|При изменении текущей записи, обновляет его в источнике данных, а затем переходит к указанной записи (следующего, предыдущего, первого или последнего).|

## <a name="remarks"></a>Примечания

Представление — представление формы, который напрямую подключен к `CDaoRecordset` объекта. Представление создается на основе ресурса шаблона диалоговых окон и отображает поля `CDaoRecordset` в элементах управления шаблона диалогового окна. `CDaoRecordView` Объект использует обмен данными диалоговых окон (DDX) и обмен полями записей DAO (DFX) для автоматизации перемещения данных между полями набора записей и элементов управления на форме. `CDaoRecordView` также предоставляет реализацию по умолчанию для перехода к первой, далее, предыдущих или последних записей и интерфейс для обновления записи в данный момент в представлении.

> [!NOTE]
>  Классы баз данных DAO, отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». Вы можете по-прежнему доступ к источникам данных ODBC с помощью классов DAO. классы DAO обычно предлагают превосходные возможности, так как они используют ядро базы данных Microsoft Jet.

С помощью мастера приложений является наиболее распространенным способом для создания представления записи. Мастер приложения создает класс представления записей и его связанного набора записей класса как часть приложения скелет starter.

Если вам достаточно одной форме, мастер приложений варианте развертывания упрощается. ClassWizard позволяет решить, использование представления записей позже в процессе разработки. Если не создать класс представления записей с помощью мастера приложений, его можно создать позже с помощью классов. Создание представления записей и записей отдельно и затем подключите их с помощью ClassWizard — это самый гибкий подход, потому, что он предоставляет больший контроль при именовании класса набора записей и его. H /. CPP-файлов. Такой подход также позволяет иметь несколько представлений записей для одного класса набор записей.

Чтобы упростить для конечных пользователей, для перемещения по записям в представлении записей, мастер приложения создает меню (и, при необходимости, панели инструментов) материалы по переходу к первой, далее, предыдущих или последних записей. Если создать класс представления записей с помощью классов, необходимо создать эти ресурсы самостоятельно с меню и растровое изображение редакторов.

Сведения о реализации по умолчанию для перемещения между записями, см. в разделе `IsOnFirstRecord` и `IsOnLastRecord` и статью [использование представления записей](../../data/using-a-record-view-mfc-data-access.md), которая применяется к обоим `CRecordView` и `CDaoRecordView`.

`CDaoRecordView` отслеживает этой положение пользователя в наборе записей, представление записей можно обновить пользовательский интерфейс. Когда пользователь переходит на любом конце набора записей, представление записей отключает объектов пользовательского интерфейса, например пункты меню или кнопки панели инструментов — для перемещения в одном направлении.

Дополнительные сведения об объявлении и с помощью представления записей и классов набора записей, см. в разделе «Проектирование и создание записи представления» в этой статье [представления записей](../../data/record-views-mfc-data-access.md). Дополнительные сведения о как запись представления рабочих и способах их использования см. в статье [использование представления записей](../../data/using-a-record-view-mfc-data-access.md). Все статьи, упомянутых выше, относятся к `CRecordView` и `CDaoRecordView`.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CDaoRecordView`

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

##  <a name="cdaorecordview"></a>  CDaoRecordView::CDaoRecordView

При создании объекта типа производным от `CDaoRecordView`, вызывать любую из конструктора для инициализации объекта представления и определения ресурса диалогового окна, на котором основано представление.

```
explicit CDaoRecordView(LPCTSTR lpszTemplateName);
explicit CDaoRecordView(UINT nIDTemplate);
```

### <a name="parameters"></a>Параметры

*lpszTemplateName*<br/>
Содержащий заканчивающуюся нулем строку, имя ресурса шаблона диалоговых окон.

*nIDTemplate*<br/>
Содержит идентификатор ресурса шаблона диалоговых окон.

### <a name="remarks"></a>Примечания

Можно либо указать ресурс по имени (pass строку в качестве аргумента конструктору) или по его Идентификатору (pass целое число без знака в качестве аргумента). Ресурс идентификатор рекомендуется использовать.

> [!NOTE]
>  Производный класс необходимо предоставить собственный конструктор. В конструкторе производного класса, вызовите конструктор `CDaoRecordView::CDaoRecordView` с именем ресурса или идентификатор в качестве аргумента.

`CDaoRecordView::OnInitialUpdate` вызовы `CWnd::UpdateData`, который вызывает `CWnd::DoDataExchange`. Этот исходный вызов `DoDataExchange` подключается `CDaoRecordView` управляет (косвенно) к `CDaoRecordset` поля элементов данных, созданных классов. Эти элементы данных не может использоваться до, после вызова метода базового класса `CFormView::OnInitialUpdate` функция-член.

> [!NOTE]
>  Если вы используете ClassWizard, мастер определяет **перечисления** значение `CDaoRecordView::IDD` в объявление класса и использует его в инициализации членов списка для конструктора.

[!code-cpp[NVC_MFCDatabase#35](../../mfc/codesnippet/cpp/cdaorecordview-class_1.cpp)]

##  <a name="isonfirstrecord"></a>  CDaoRecordView::IsOnFirstRecord

Вызывайте эту функцию члена, чтобы определить, является ли текущая запись первой записи в объекте набора записей, связанный с этим представлением записи.

```
BOOL IsOnFirstRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является первой записью в наборе записей; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция полезна для написания собственных реализаций по умолчанию обработчики обновления команд, созданных классов.

Если пользователь переходит на первую запись, отключает framework, никакого пользовательского интерфейса объекты (например, пункты меню или кнопки панели инструментов) у вас есть для перемещения к первому или предыдущей записи.

##  <a name="isonlastrecord"></a>  CDaoRecordView::IsOnLastRecord

Вызывайте эту функцию члена, чтобы определить, является ли текущая запись последней записи в объекте набора записей, связанный с этим представлением записи.

```
BOOL IsOnLastRecord();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текущая запись является последней записи в наборе записей; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция полезна для написания собственных реализаций по умолчанию обработчики обновления команд, которые ClassWizard записывает поддержку пользовательского интерфейса для перехода между записями.

> [!CAUTION]
>  Результат этой функции надежен, за исключением того, что представление не удается обнаружить конца набора данных, пока пользователь уже прошел его. Пользователь может потребоваться переместить за пределы последнюю запись, прежде чем представления записей можно сказать, что его необходимо отключить все объекты пользовательского интерфейса для перемещения к следующей или последней записи. Если пользователь перемещается за пределы последнюю запись и затем переход к последней записи (или перед ним), представление записей можно отслеживать положение пользователя в наборе записей и корректно отключена объекты пользовательского интерфейса.

##  <a name="ongetrecordset"></a>  CDaoRecordView::OnGetRecordset

Возвращает указатель на `CDaoRecordset`-производного объекта, связанного с представлением записи.

```
virtual CDaoRecordset* OnGetRecordset() = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CDaoRecordset`-производного объекта, если объект был успешно создан; в противном случае указатель NULL.

### <a name="remarks"></a>Примечания

Эта функция-член для создания или получения объекта набора записей и возврата указателя на его необходимо переопределить. Если вы объявляете класс представления записей с помощью классов, мастер создает переопределение по умолчанию. Реализация по умолчанию в ClassWizard возвращает набор записей указателем, сохраненным в представление записей, если он существует. Если нет, он создает объект набора записей типа вы указали с ClassWizard и вызывает его `Open` член функции для открытия таблицы или выполнения запроса и затем возвращает указатель на объект.

Дополнительные сведения и примеры см. в статье [представления записей: Использование представления записей](../../data/using-a-record-view-mfc-data-access.md).

##  <a name="onmove"></a>  CDaoRecordView::OnMove

Вызов этой функции-члена для перемещения на другую запись в наборе записей и отобразить ее поля в элементах управления представления записи.

```
virtual BOOL OnMove(UINT nIDMoveCommand);
```

### <a name="parameters"></a>Параметры

*nIDMoveCommand*<br/>
Одно из следующих значений ID стандартную команду:

- Переместите ID_RECORD_FIRST первой записи в наборе записей.

- ID_RECORD_LAST перейти к последней записи в наборе записей.

- ID_RECORD_NEXT перемещения к следующей записи в наборе записей.

- ID_RECORD_PREV перейти к предыдущей записи в наборе записей.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.

### <a name="remarks"></a>Примечания

Реализация по умолчанию вызывает соответствующую функцию-член перемещения из `CDaoRecordset` объекта, связанного с представлением записи.

По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь изменил его в представлении записей.

В мастере приложений создает ресурс меню с пунктами меню первой записи, последнюю запись, следующая запись и предыдущей записи. Если выбран параметр Первичная панель инструментов, мастер приложений также создает панель инструментов с кнопками, соответствующий эти команды.

При перемещении за последней записью в наборе записей, представление записей продолжают отображаться последнюю запись. Если переместить назад после первой записи, представление записей продолжают отображаться первой записи.

> [!CAUTION]
>  Вызов `OnMove` создает исключение, если набор записей не имеющей записей. Вызов функции-обработчика обновить соответствующий пользовательский интерфейс — `OnUpdateRecordFirst`, `OnUpdateRecordLast`, `OnUpdateRecordNext`, или `OnUpdateRecordPrev` — до соответствующего переместить операцию, чтобы определить, имеет ли набор записей какие-либо записи.

## <a name="see-also"></a>См. также

[Класс CFormView](../../mfc/reference/cformview-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)<br/>
[Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)<br/>
[Класс CFormView](../../mfc/reference/cformview-class.md)
