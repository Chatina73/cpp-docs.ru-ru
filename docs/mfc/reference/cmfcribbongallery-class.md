---
title: Класс CMFCRibbonGallery
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: aa2996cba7d4839387d5801d2bab70b428134db4
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57298637"
---
# <a name="cmfcribbongallery-class"></a>Класс CMFCRibbonGallery

Реализует коллекции лент в стиле Office 2007.
Дополнительные сведения см. в исходном коде, расположенном в папке **VC\\atlmfc\\src\\mfc** каталога установки Visual Studio.

## <a name="syntax"></a>Синтаксис

```
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание:|
|----------|-----------------|
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|Создает и инициализирует объект `CMFCRibbonGallery`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание:|
|----------|-----------------|
|[CMFCRibbonGallery::AddGroup](#addgroup)|Добавляет новую группу в коллекции.|
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|Добавляет новый элемент меню в раскрывающемся меню.|
|[CMFCRibbonGallery::Clear](#clear)|Очищает содержимое коллекции.|
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|Включает или отключает изменение размера панели меню.|
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|Включает или отключает боковой панели слева от во всплывающем меню.|
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(Переопределяет [CMFCRibbonButton::GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).)|
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(Переопределяет [CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown).)|
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|Возвращает имя группы, расположенный по указанному индексу.|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|Возвращает количество элементов в строке галереи ленты.|
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|Возвращает текст подсказки, связанный с элементом в коллекции.|
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|Возвращает индекс последнего элемента в коллекции, выбранного пользователем.|
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|Возвращает идентификатор текущей коллекции.|
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(Переопределяет [CMFCRibbonButton::GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).)|
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(Переопределяет [CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).)|
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|Указывает, содержится ли в коллекции кнопки коллекции.|
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|Указывает, является ли изменение размеров меню включен или отключен.|
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|Указывает, включена ли на боковой панели.|
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(Переопределяет `CMFCRibbonButton::OnAfterChangeRect`.)|
|[CMFCRibbonGallery::OnDraw](#ondraw)|(Переопределяет [CMFCRibbonButton::OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).)|
|[CMFCRibbonGallery::OnEnable](#onenable)|(Переопределяет `CMFCRibbonBaseElement::OnEnable`.)|
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(Переопределяет [CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).)|
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|Перерисовывает коллекции.|
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|Удаляет подсказки из всех элементов в коллекции.|
|[CMFCRibbonGallery::SelectItem](#selectitem)||
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(Переопределяет [CMFCRibbonButton::SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).)|
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|Указывает, следует ли отображать галереи ленты, разворачивающуюся кнопку или палитры непосредственно на ленте.|
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|Задает имя группы.|
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|Определяет количество элементов на каждую строку в коллекции.|
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|Задает текст подсказки для элемента в коллекции.|
|[CMFCRibbonGallery::SetPalette](#setpalette)|Присоединяет палитры к коллекции лент.|
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|Определяет идентификатор команды, который отправляется в сообщении WM_COMMAND, при выборе элемента галереи.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание:|
|----------|-----------------|
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|Вызывается платформой при рисовании значок в виде коллекции.|

## <a name="remarks"></a>Примечания

Кнопка коллекции ведет себя так же, как обычное меню кнопки, за исключением того, что он отображает коллекции, когда пользователь открывает его. При выборе элемента в коллекции, инфраструктура отправляет сообщение WM_COMMAND, а также идентификатор команды кнопки. Когда вы обрабатываете сообщения, следует вызывать [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) для определения, какой элемент был выбран из коллекции.

## <a name="example"></a>Пример

Следующий пример демонстрирует использование различных методов `CMFCRibbonGallery` класс для настройки `CMFCRibbonGallery` объекта. Пример иллюстрирует способ указать количество элементов на каждую строку в коллекции, включить изменение размера панели меню, на боковой панели слева от всплывающего меню и отображения галереи ленты как палитра непосредственно на панели ленты. Этот фрагмент кода входит в состав [примера Draw Client](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>Требования

**Заголовок:** afxRibbonPaletteGallery.h

##  <a name="addgroup"></a>  CMFCRibbonGallery::AddGroup

Добавляет новую группу в коллекции.

```
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>Параметры

*lpszGroupName*<br/>
[in] Указывает имя группы.

*uiImagesPaletteResID*<br/>
[in] Указывает идентификатор списка изображений с изображениями для группы ресурсов.

*cxPaletteImage*<br/>
[in] Задает ширину в пикселях изображения.

*imagesGroup*<br/>
[in] Ссылка на список изображений, содержащий группы образов.

*nIconsNum*<br/>
[in] Указывает количество значков в группе. Этот параметр должен быть указан только для пользовательских (рисование владельцем) группы.

### <a name="remarks"></a>Примечания

Элементы коллекции лент можно разделить на несколько групп, вызвав этот метод. Каждая группа может иметь заголовок.

##  <a name="addsubitem"></a>  CMFCRibbonGallery::AddSubItem

Добавляет новый элемент меню в раскрывающемся меню.

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>Параметры

*pSubItem*<br/>
[in] Указатель на элемент, добавляемый в меню.

*nIndex*<br/>
[in] Указывает место вставки элемента, отсчитываемый от нуля индекс расположения.

*bOnTop*<br/>
[in] Значение TRUE, чтобы указать, что элемент следует вставить перед галереи ленты; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Всплывающее окно галереи можно объединить с элементов всплывающих меню путем вызова данного метода. Пункты меню можно поместить до или после коллекции.

Чтобы вставить пункт до коллекции, задайте *bOnTop* значение true. Задайте *bOnTop* значение false, чтобы вставить элемент под коллекцию.

> [!NOTE]
>  Параметр *nIndex* указывает индекс вставки, как в верхней части коллекции, так и в нижней части галереи. Например, если необходимо вставить элемент на одну позицию перед коллекции, задайте *nIndex* 1 и *bOnTop* значение true. Аналогичным образом, если необходимо вставить элемент на одну позицию под коллекцию, задайте *nIndex* 1 и *bOnTop* значение false.

##  <a name="clear"></a>  CMFCRibbonGallery::Clear

Очищает содержимое коллекции.

```
virtual void Clear();
```

### <a name="remarks"></a>Примечания

Вызовите этот метод, чтобы удалить все содержимое из галереи ленты. Это необходимо сделать перед присоединением новой коллекции лент или набор групп к коллекции лент.

##  <a name="cmfcribbongallery"></a>  CMFCRibbonGallery::CMFCRibbonGallery

Создает и инициализирует [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md) объекта.

```
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Указывает идентификатор команды выполнения, когда пользователь нажимает кнопку команды.

*lpszText*<br/>
Задает текст, отображаемый на кнопке.

*nSmallImageIndex*<br/>
Отсчитываемый от нуля индекс небольшое изображение, отображаемый на кнопке.

*nLargeImageIndex*<br/>
Отсчитываемый от нуля индекс большого изображения, отображаемый на кнопке.

*imagesPalette*<br/>
Ссылку на [CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md) , содержащий изображения, отображаются в коллекции.

*uiImagesPaletteResID*<br/>
Идентификатор ресурса в список изображений для отображения в коллекции.

*cxPaletteImage*<br/>
Задает ширину в пикселях изображения в коллекции.

*sizeIcon*<br/>
Размер в пикселях образа из коллекции.

*nIconsNum*<br/>
Задает количество значков в галерее.

*bDefaultButtonStyle*<br/>
Указывает, следует ли использовать значение по умолчанию или стиль кнопки, рисуемый владельцем.

### <a name="remarks"></a>Примечания

##  <a name="enablemenuresize"></a>  CMFCRibbonGallery::EnableMenuResize

Включает или отключает изменение размера панели меню.

```
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
[in] Значение TRUE, чтобы включить изменение размеров меню; в противном случае — значение FALSE.

*bVertcalOnly*<br/>
[in] Значение TRUE, чтобы указать, что коллекции могут быть изменены размеры только по вертикали; Значение FALSE, чтобы указать, что коллекции могут быть изменены размеры горизонтальном и вертикальном направлениях.

### <a name="remarks"></a>Примечания

Этот метод позволяет включить или отключить изменение размера коллекции лент. Если изменение размера галереи ленты выводит захвата, пользователь может использовать для изменения размера.

##  <a name="enablemenusidebar"></a>  CMFCRibbonGallery::EnableMenuSideBar

Включает или отключает боковой панели слева от во всплывающем меню.

```
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
[in] Значение TRUE, чтобы указать, что включено на боковой панели; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Этот метод используется для включения или отключения Office XP в стиле боковой панели в левой части меню.

##  <a name="getcompactsize"></a>  CMFCRibbonGallery::GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

[in] *основного контроллера домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getgroupname"></a>  CMFCRibbonGallery::GetGroupName

Возвращает имя группы, расположенный по указанному индексу.

```
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>Параметры

*nGroupIndex*<br/>
[in] Указывает отсчитываемый от нуля индекс для группы, имя которого требуется извлечь.

### <a name="return-value"></a>Возвращаемое значение

Имя группы, расположенный по указанному индексу. Недопустимый индекс передачи приведет к утверждение, вызвавшее сбой.

### <a name="remarks"></a>Примечания

##  <a name="getgroupoffset"></a>  CMFCRibbonGallery::GetGroupOffset

```
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="geticonsinrow"></a>  CMFCRibbonGallery::GetIconsInRow

Возвращает количество элементов в строке галереи ленты.

```
int GetIconsInRow() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число элементов в строке.

### <a name="remarks"></a>Примечания

##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip

Возвращает текст подсказки, связанный с элементом в коллекции.

```
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>Параметры

*nItemIndex*<br/>
[in] Указывает отсчитываемый от нуля индекс элемента, для которого необходимо получить текст подсказки.

### <a name="return-value"></a>Возвращаемое значение

Указатель на строку подсказки, присвоенное элементу в коллекции лент. Он может иметь значение NULL, если к этому элементу назначено никакого tooltip.

### <a name="remarks"></a>Примечания

##  <a name="getlastselecteditem"></a>  CMFCRibbonGallery::GetLastSelectedItem

Возвращает индекс последнего элемента в коллекции лент, выбранного пользователем.

```
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>Параметры

*uiCmdID*<br/>
[in] Указывает идентификатор команды пункта меню, который открыт галереи ленты.

### <a name="return-value"></a>Возвращаемое значение

Когда пользователь выбирает любой элемент в коллекции лент, библиотека отправляет сообщение WM_COMMAND, а также идентификатор команды меню кнопки, которая открывается галереи ленты.

### <a name="remarks"></a>Примечания

##  <a name="getpaletteid"></a>  CMFCRibbonGallery::GetPaletteID

Возвращает идентификатор текущей палитре.

```
int GetPaletteID() const;
```

### <a name="return-value"></a>Возвращаемое значение

Идентификатор команды выделенного палитры.

### <a name="remarks"></a>Примечания

##  <a name="getregularsize"></a>  CMFCRibbonGallery::GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

[in] *основного контроллера домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="getselecteditem"></a>  CMFCRibbonGallery::GetSelectedItem

```
int GetSelectedItem() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="hasmenu"></a>  CMFCRibbonGallery::HasMenu

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="isbuttonmode"></a>  CMFCRibbonGallery::IsButtonMode

Указывает, содержится ли в коллекции кнопке палитры.

```
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если палитре отображается как кнопка с раскрывающимся меню; Значение FALSE, если палитре отображается непосредственно на ленте.

### <a name="remarks"></a>Примечания

##  <a name="ismenuresizeenabled"></a>  CMFCRibbonGallery::IsMenuResizeEnabled

Указывает, включена ли изменение размеров меню.

```
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если изменение размеров меню включен; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

##  <a name="ismenuresizevertical"></a>  CMFCRibbonGallery::IsMenuResizeVertical

```
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

##  <a name="ismenusidebar"></a>  CMFCRibbonGallery::IsMenuSideBar

Указывает, включена ли на боковой панели.

```
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если на боковой панели в стиле Office XP выводится с левой стороны меню; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

##  <a name="onafterchangerect"></a>  CMFCRibbonGallery::OnAfterChangeRect

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>Параметры

[in] *основного контроллера домена*<br/>

### <a name="remarks"></a>Примечания

##  <a name="ondraw"></a>  CMFCRibbonGallery::OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Параметры

[in] *основного контроллера домена*<br/>

### <a name="remarks"></a>Примечания

##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon

Вызывается платформой при рисовании значок в виде коллекции.

```
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
[in] Указатель на контекст устройства, который используется для рисования.

*rectIcon*<br/>
[in] Указывает ограничивающий прямоугольник значка для рисования.

*nIconIndex*<br/>
[in] Указывает отсчитываемый от нуля индекс в списке изображений значков в галерее значка для рисования.

*pIcon*<br/>
[in] Указатель на значок, который отрисовывается.

*clrText*<br/>
[in] Указывает цвет для текста элемента для рисования.

### <a name="remarks"></a>Примечания

Можно переопределить этот метод в производном классе, чтобы настроить внешний вид коллекции лент.

##  <a name="onenable"></a>  CMFCRibbonGallery::OnEnable

```
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>Параметры

[in] *bEnable*<br/>

### <a name="remarks"></a>Примечания

##  <a name="onrtlchanged"></a>  CMFCRibbonGallery::OnRTLChanged

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>Параметры

[in] *bIsRTL*<br/>

### <a name="remarks"></a>Примечания

##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons

Перерисовывает коллекции.

```
void RedrawIcons();
```

### <a name="remarks"></a>Примечания

Эта функция вызывается для перерисовки коллекции. Этот метод необходимо вызвать при изменении содержимого коллекции во время выполнения.

##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips

Удаляет подсказки из всех элементов в коллекции.

```
void RemoveItemToolTips();
```

### <a name="remarks"></a>Примечания

##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem

```
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>Параметры

[in] *nItemIndex*<br/>

### <a name="remarks"></a>Примечания

##  <a name="setaccdata"></a>  CMFCRibbonGallery::SetACCData

Заполняет указанный объект `CAccessibilityData` , используя данные специальных возможностей из галереи ленты.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Параметры

*pParent*<br/>
[in] Родительское окно окна галереи ленты.

*data*<br/>
[out] Объект `CAccessibilityData` объект, получающий данные специальных возможностей из галереи ленты.

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Примечания

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

##  <a name="setbuttonmode"></a>  CMFCRibbonGallery::SetButtonMode

Определяет, следует ли отображать галереи ленты, разворачивающуюся кнопку или палитры непосредственно на ленте.

```
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Параметры

*bSet*<br/>
[in] Значение TRUE для отображения галереи ленты как кнопка с раскрывающимся меню; Значение FALSE, чтобы отобразить содержимое коллекции лент непосредственно на ленте.

### <a name="remarks"></a>Примечания

##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName

Задает имя группы.

```
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>Параметры

*nGroupIndex*<br/>
[in] Указывает отсчитываемый от нуля индекс, для которого изменяется имя группы.

*lpszGroupName*<br/>
[in] Указывает новое имя для группы.

### <a name="remarks"></a>Примечания

Группа, имя которого изменяется должно быть добавлено с помощью [CMFCRibbonGallery::AddGroup](#addgroup) метод.

##  <a name="seticonsinrow"></a>  CMFCRibbonGallery::SetIconsInRow

Указывает количество элементов на каждую строку в коллекции.

```
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>Параметры

*nIconsInRow*<br/>
[in] Указывает количество элементов в каждой строке коллекции.

### <a name="remarks"></a>Примечания

Этот метод позволяет задать ширину галереи ленты.

##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip

Задает текст подсказки для элемента в коллекции.

```
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>Параметры

*nItemIndex*<br/>
[in] Отсчитываемый от нуля индекс элемента палитры, с которым связывается всплывающей подсказки.

*lpszToolTip*<br/>
[in] Текст для отображения в подсказке.

### <a name="remarks"></a>Примечания

##  <a name="setpalette"></a>  CMFCRibbonGallery::SetPalette

Присоединяет палитры к коллекции лент.

```
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>Параметры

*imagesPalette*<br/>
[in] Задает список изображений, содержащий значки, которые отображаются в коллекции.

*uiImagesPaletteResID*<br/>
[in] Указывает идентификатор ресурса в список изображений, содержащий значки, которые отображаются в коллекции.

*cxPaletteImage*<br/>
[in] Задает ширину в пикселях изображения в коллекции.

### <a name="remarks"></a>Примечания

##  <a name="setpaletteid"></a>  CMFCRibbonGallery::SetPaletteID

Определяет идентификатор команды, который отправляется в сообщении WM_COMMAND, когда пользователь выбирает элемент коллекции.

```
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
[in] Указывает идентификатор команды, который отправляется в сообщении WM_COMMAND, когда пользователь выбирает элемент коллекции.

### <a name="remarks"></a>Примечания

Чтобы определить конкретный элемент, который пользователь выбрал из коллекции, вызовите [CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem) статический метод.

## <a name="see-also"></a>См. также

[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Классы](../../mfc/reference/mfc-classes.md)<br/>
[Класс CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[Класс CMFCRibbonGalleryMenuButton](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
