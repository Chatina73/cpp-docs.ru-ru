---
title: Поддержка базы данных, мастер приложений MFC
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: c13d56d2fee45e130aba81168188bec6d8828d51
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365878"
---
# <a name="database-support-mfc-application-wizard"></a>Поддержка базы данных, мастер приложений MFC

На этой странице приведены варианты, позволяющие указать уровень поддержки базы данных (плюс источник данных, если это необходимо) для проекта.

- **Поддержка баз данных**

   Устанавливает уровень поддержки базы данных для вашего проекта.

   |Параметр|Описание|
   |------------|-----------------|
   |**Нет**|Поддержка базы данных не предоставляется. Это параметр по умолчанию.|
   |**Только файлы заголовка**|Обеспечивает базовый уровень поддержки базы данных для вашего приложения. Если вы выбираете поддержку ODBC **по типу клиента,** Волшебник приложения MFC включает в свой проект файл заголовка AFXDB. H. Он добавляет библиотеки ссылки, но не создает классы, связанные с базой данных. Вы можете создавать записи позже и использовать их для изучения и обновления записей. Если вы выберете поддержку OLE DB **под типом клиента,** в него включены следующие файлы заголовка: ATLBASE. H AFXOLEDB. H ATLPLUS. H|
   |**Представление базы данных без поддержки файлов**|Включает файлы заголовка базы данных, библиотеки ссылки, представление записей и набор записей. (Доступно только для приложений с опцией **поддержки архитектуры документа/просмотра,** выбранной на странице [Типа приложения.)](../../mfc/reference/application-type-mfc-application-wizard.md) Этот параметр включает поддержку документов, но не поддержку сериализации. Если вы решили включить представление базы данных, необходимо указать источник данных.|
   |**Представление базы данных с поддержкой файлов**|Включает файлы заголовка базы данных, библиотеки ссылки, представление записей и набор записей. (Доступно только для приложений с опцией **поддержки архитектуры документа/просмотра,** выбранной на странице **Типа приложения.)** Эта опция поддерживает сериализацию документов, которую можно использовать, например, для обновления файла профиля пользователя. Приложения для баз данных, как правило, работают на основе записи, а не на основе одного файла, и поэтому не нуждаются в сериализации. Тем не менее, вы можете иметь специальное использование для сериализации. Если вы решили включить представление базы данных, необходимо указать источник данных.|

   > [!NOTE]
   > В **соответствии с поддержкой базы данных,** если вы выбираете вид **базы данных без поддержки файлов** или представление базы **данных с поддержкой файла,** производство класса представления отличается, в зависимости от выбора типа **клиента,** следующим образом:

  - Если вы выбираете **ODBC** по **типу клиента,** то класс представления приложения происходит от [CRecordView.](../../mfc/reference/crecordview-class.md) Этот класс связан с классом [CRecordset,](../../mfc/reference/crecordset-class.md)который также создает для вас MFC Application Wizard. Эта опция дает вам приложение на основе формы, в котором представление записи используется для просмотра и обновления записей через его рекордный установить.

  - Если вы выберете **OLE DB** по **типу клиента,** то класс представления происходит от [COleDBRecordView,](../../mfc/reference/coledbrecordview-class.md)и это связано с [классом CTable](../../data/oledb/ctable-class.md) или CCommand-производным. [CCommand](../../data/oledb/ccommand-class.md)

- **Тип клиента**

   Указывает, использует ли ваш проект классы OLE DB или ODBC.

   |Параметр|Описание|
   |------------|-----------------|
   |**OLE DB**|При выборе этой опции нажатие кнопки **«Источник данных»** вызывает мастера **свойств ссылок данных,** чтобы помочь вам создать соединение с источником данных OLE DB.|
   |**ODBC**|При выборе этой опции нажатие кнопки **«Источник данных»** вызывает мастер-измастерие **«Выберите источник данных»,** чтобы помочь создать соединение с источником данных ODBC.|

- **Источник данных**

   > [!NOTE]
   > AtL OLE DB Потребительский мастер и MFC ODBC Потребительский мастер не доступны в Visual Studio 2019 и позже. Эту функцию все еще можно добавить вручную. Дополнительные сведения см. в статье [Создание объекта-получателя без помощи мастера](../../data/oledb/creating-a-consumer-without-using-a-wizard.md).

   Нажмите кнопку **«Источник данных»,** чтобы настроить источник данных с помощью указанного драйвера или поставщика и базы данных. Если вы выбрали OLE DB в опции **типа Клиента,** эта кнопка отображает диалоговую коробку **Data Link Properties.** Если вы выбрали ODBC в опции **типа Клиента,** эта кнопка предоставляет поле диалога **Select Data Source.** Эта опция доступна только в том случае, если вы решите включить представление базы данных в приложение.

   |Параметр|Описание|
   |------------|-----------------|
   |**Свойства ссылки данных** (OLE DB)|Устанавливает указанный источник данных с помощью указанного поставщика OLE DB. Необходимо указать поставщика OLE DB, местоположение данных, источник данных, идентификатор входа и (по желанию) пароль. Для получения подробной информации об этом [ATL OLE DB Consumer Wizard](../../atl/reference/atl-ole-db-consumer-wizard.md)диалоговом поле, **см.**|
   |**Выберите источник данных** (ODBC)|Устанавливает указанный источник данных с помощью указанного драйвера ODBC. Необходимо выбрать имя источника данных для выбора таблицы для источника данных. Мастер связывает все столбцы таблицы с переменными-членами класса a `CRecordset`-derived. Для получения подробной информации об этом [MFC ODBC Consumer Wizard](../../mfc/reference/mfc-odbc-consumer-wizard.md)диалоговом поле, **см.**|

- **Создание приписываемого класса базы данных**

   Доступно только для клиента OLE DB. Определяет, используют ли классы баз данных в генерируемых атрибутах проекта.

- **Связать все столбцы**

   Доступно только для клиента ODBC. Определяется, связаны ли все столбцы в выбранной таблице. Если вы выберете это поле, все столбцы связаны; если вы не выберете эту коробку, никакие столбцы не связаны, и вы должны связать их вручную в классе recordset.

- **Type**

   Доступно только для клиента ODBC. Определяет, является ли набор записей динасетом или моментальным снимком, как описано в следующей таблице.

   |Параметр|Описание|
   |------------|-----------------|
   |**Динамический набор**|Уточняется, что рекордявляется динасетом. Динасет является результатом запроса, который предоставляет индексированное представление в данные запрашиваемых баз данных. Динасет кэши только интегральный индекс исходных данных и, таким образом, предлагает увеличение производительности по сравнению с моментальным снимком. Индекс указывает непосредственно на каждую запись, найденную в результате запроса, и указывает, удалена ли запись. У вас также есть доступ к обновленной информации в запрашиваемых записях.|
   |**Снимок**|Уточняется, что запись представляет собой снимок. Снимок является результатом запроса и представляет собой представление в базу данных в один момент времени. Все записи, найденные в результате запроса, кэшируются, поэтому вы не видите никаких изменений в исходных записях.|

## <a name="see-also"></a>См. также раздел

[Мастер приложений MFC](../../mfc/reference/mfc-application-wizard.md)
