---
description: 'Дополнительные сведения: поддержка баз данных, мастер приложений MFC'
title: Поддержка базы данных, мастер приложений MFC
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: 4c6f980155e980c772b5ee78f83c80a236998b91
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97220309"
---
# <a name="database-support-mfc-application-wizard"></a>Поддержка базы данных, мастер приложений MFC

На этой странице представлены параметры, позволяющие указать уровень поддержки базы данных (а также источник данных, если это необходимо) для проекта.

- **Поддержка баз данных**

   Задает уровень поддержки базы данных для проекта.

   |Параметр|Описание|
   |------------|-----------------|
   |**None**|Не поддерживает базу данных. Это параметр по умолчанию.|
   |**Только файлы заголовков**|Предоставляет базовый уровень поддержки баз данных для вашего приложения. При выборе поддержки ODBC в разделе **Тип клиента** мастер приложений MFC включает в проект файл заголовка Афксдб. H. Он добавляет библиотеки компоновки, но не создает классы, связанные с базами данных. Вы можете создавать наборы записей позже и использовать их для проверки и обновления записей. Если в поле **Тип клиента** выбран вариант поддержка OLE DB, включаются следующие файлы заголовков: atlbase. H АФКСОЛЕДБ. H АТЛПЛУС. Высоты|
   |**Представление базы данных без поддержки файлов**|Включает файлы заголовков базы данных, библиотеки компоновки, представление записей и набор записей. (Доступно только для приложений с **поддержкой архитектуры "документ/представление** ", выбранной на странице " [Тип приложения](../../mfc/reference/application-type-mfc-application-wizard.md) ".) Этот параметр включает поддержку документов, но не поддерживает сериализацию. Если вы решили включить представление базы данных, необходимо указать источник данных.|
   |**Представление базы данных с поддержкой файлов**|Включает файлы заголовков базы данных, библиотеки компоновки, представление записей и набор записей. (Доступно только для приложений с **поддержкой архитектуры "документ/представление** ", выбранной на странице " **Тип приложения** ".) Этот параметр поддерживает сериализацию документов, которые можно использовать, например, для обновления файла профиля пользователя. Приложения баз данных обычно работают с каждой записью, а не с каждым файлом и поэтому не требуют сериализации. Однако для сериализации может использоваться специальное предложение. Если вы решили включить представление базы данных, необходимо указать источник данных.|

   > [!NOTE]
   > Если в разделе **Поддержка базы** данных выбрано **представление базы данных без поддержки файлов** или **представление базы данных с поддержкой файлов**, то наследование класса представления отличается в зависимости от выбора **типа клиента** , как показано ниже.

  - Если в поле **Тип клиента** выбрано значение **ODBC** , класс представления приложения является производным от класса [CRecordView](../../mfc/reference/crecordview-class.md). Этот класс связан с классом, производным от класса [CRecordset](../../mfc/reference/crecordset-class.md), который также создается мастером приложений MFC. Этот параметр предоставляет приложение на основе форм, в котором представление записей используется для просмотра и обновления записей с помощью набора записей.

  - Если в поле **Тип клиента** выбрано **OLE DB** , то класс представления является производным от [коледбрекордвиев](../../mfc/reference/coledbrecordview-class.md)и связан с классом, производным от [CTable](../../data/oledb/ctable-class.md) или [CCommand](../../data/oledb/ccommand-class.md).

- **Тип клиента**

   Указывает, использует ли проект классы OLE DB или ODBC.

   |Параметр|Описание|
   |------------|-----------------|
   |**OLE DB**|Если этот параметр выбран, при нажатии кнопки **источник данных** вызывается мастер **свойств связи данных** , помогающий создать соединение с источником данных OLE DB.|
   |**ODBC**|Если этот параметр выбран, при нажатии кнопки **источник данных** вызывается мастер **Выбор источника** данных, который поможет создать соединение с источником данных ODBC.|

- **Источник данных**

   > [!NOTE]
   > Мастер ATL OLE DB Consumer и мастер потребителей ODBC MFC недоступны в Visual Studio 2019 и более поздних версиях. Эту функцию все еще можно добавить вручную. Дополнительные сведения см. в статье [Создание объекта-получателя без помощи мастера](../../data/oledb/creating-a-consumer-without-using-a-wizard.md).

   Нажмите кнопку **источник данных** , чтобы настроить источник данных с помощью указанного драйвера или поставщика и базы данных. Если в параметре **Тип клиента** выбрано OLE DB, то эта кнопка открывает диалоговое окно **Свойства связи данных** . Если в параметре **Тип клиента** выбрано значение ODBC, то эта кнопка предоставляет диалоговое окно **Выбор источника данных** . Этот параметр доступен, только если вы решили включить представление базы данных в приложение.

   |Параметр|Описание|
   |------------|-----------------|
   |**Свойства канала передачи данных** (OLE DB)|Устанавливает указанный источник данных с помощью указанного поставщика OLE DB. Необходимо указать поставщик OLE DB, расположение данных, источник данных, идентификатор входа и (необязательно) пароль. Дополнительные сведения об этом диалоговом окне см. в разделе **источник данных** в [мастере потребителей ATL OLE DB](../../atl/reference/atl-ole-db-consumer-wizard.md).|
   |**Выбор источника данных** (ODBC)|Устанавливает указанный источник данных с помощью указанного драйвера ODBC. Необходимо выбрать имя источника данных, чтобы выбрать таблицу для источника данных. Мастер привязывает все столбцы таблицы к переменным `CRecordset` -членам класса, производного от. Дополнительные сведения об этом диалоговом окне см. в разделе **источник данных** в [мастере потребителей MFC ODBC](../../mfc/reference/mfc-odbc-consumer-wizard.md).|

- **Создать класс базы данных с атрибутами**

   Доступно только для OLE DB клиента. Указывает, используют ли классы базы данных в создаваемом проекте атрибуты.

- **Привязать все столбцы**

   Доступно только для клиента ODBC. Указывает, привязаны ли все столбцы в выбранной таблице. Если установить этот флажок, все столбцы будут привязаны. Если этот флажок не установлен, столбцы не привязаны, и их необходимо привязать вручную в классе Recordset.

- **Тип**

   Доступно только для клиента ODBC. Указывает, является ли набор записей динамическим или моментальным снимком, как описано в следующей таблице.

   |Параметр|Описание|
   |------------|-----------------|
   |**Динамический набор**|Указывает, что набор записей является динамическим множеством. Динамический набор — это результат запроса, который предоставляет индексированное представление данных запрашиваемой базы данных. Динамический набор кэширует только целочисленный индекс исходных данных и, таким же, обеспечивает повышение производительности по сравнению с моментальным снимком. Индекс указывает непосредственно на каждую запись, найденную в результате запроса, и указывает, удаляется ли запись. У вас также есть доступ к обновленной информации в запрашиваемых записях.|
   |**Моментальный снимок**|Указывает, что набор записей является моментальным снимком. Моментальный снимок является результатом запроса и представляет собой представление базы данных в один момент времени. Все записи, найденные в результате запроса, кэшируются, поэтому изменения в исходных записях не отображаются.|

## <a name="see-also"></a>См. также раздел

[Мастер приложений MFC](../../mfc/reference/mfc-application-wizard.md)
