---
title: Класс CToolBarCtrl
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 92f5adcea50e660ecfad131313247e118312e609
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2019
ms.locfileid: "58781267"
---
# <a name="ctoolbarctrl-class"></a>Класс CToolBarCtrl

Предоставляет функциональные возможности стандартного элемента управления "панель инструментов" Windows.

## <a name="syntax"></a>Синтаксис

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|Создает объект `CToolBarCtrl`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CToolBarCtrl::AddBitmap](#addbitmap)|Добавляет один или несколько точечных рисунков кнопки в список изображений кнопок, доступных для элемента управления панели инструментов.|
|[CToolBarCtrl::AddButtons](#addbuttons)|Добавляет одну или несколько кнопок в элемент управления toolbar.|
|[CToolBarCtrl::AddString](#addstring)|Добавляет новую строку, переданный в качестве идентификатора ресурса панели инструментов внутренний список строк.|
|[CToolBarCtrl::AddStrings](#addstrings)|Добавляет новую строку или строки, переданного как указатель на буфер строк, разделенных на значение null, панели инструментов внутренний список строк.|
|[CToolBarCtrl::AutoSize](#autosize)|Изменяет размер элемента управления панели инструментов.|
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|Изменяет растрового изображения для кнопки на текущий элемент управления панели инструментов.|
|[CToolBarCtrl::CheckButton](#checkbutton)|Проверяет, или очищает указанной кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|Возвращает отсчитываемый от нуля индекс для кнопки, связанной с указанным идентификатором команды.|
|[CToolBarCtrl::Create](#create)|Создает элемент управления панели инструментов и присоединяет его к `CToolBarCtrl` объекта.|
|[CToolBarCtrl::CreateEx](#createex)|Создает элемент управления toolbar с указанным расширенные стили Windows и присоединяет его к `CToolBarCtrl` объекта.|
|[CToolBarCtrl::Customize](#customize)|Отображает диалоговое окно Настройка панели инструментов.|
|[CToolBarCtrl::DeleteButton](#deletebutton)|Удаление кнопки из панели инструментов.|
|[CToolBarCtrl::EnableButton](#enablebutton)|Включает или отключает указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|Извлекает привязки выделения для панели инструментов.|
|[CToolBarCtrl::GetBitmap](#getbitmap)|Извлекает индекс растровое изображение, связанное с кнопкой на панели инструментов.|
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|Получает флаги, связанные с растровым изображением панели инструментов.|
|[CToolBarCtrl::GetButton](#getbutton)|Извлекает сведения об указанной кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|Получает число кнопок в панели инструментов.|
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|Возвращает сведения для кнопки на панели инструментов.|
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|Извлекает текущую ширину и высоту кнопок панели инструментов, в пикселях.|
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|Возвращает цветовую схему текущего элемента управления панели инструментов.|
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|Извлекает список изображений, элемент управления панели инструментов используется для отображения отключен кнопок.|
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|Извлекает [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) интерфейс для элемента управления панели инструментов.|
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|Извлекает расширенные стили для элемента управления панели инструментов.|
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|Извлекает список изображений, элемент управления панель инструментов используется для отображения кнопки «горячие». Кнопку в активном состоянии выделяется, когда указатель мыши находится над ним.|
|[CToolBarCtrl::GetHotItem](#gethotitem)|Извлекает индекс элемента, "Горячий" в панели инструментов.|
|[CToolBarCtrl::GetImageList](#getimagelist)|Извлекает список изображений, элемент управления панель инструментов используется для отображения кнопки в состоянии по умолчанию.|
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|Извлекает текущий знак вставки для панели инструментов.|
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Получает цвет, используемый для рисования знак вставки для панели инструментов.|
|[CToolBarCtrl::GetItemRect](#getitemrect)|Возвращает ограничивающий прямоугольник, кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|Получает общий размер всех видимых кнопок и разделителя групп разрядов в панели инструментов.|
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|Извлекает максимальное количество строк текста, отображаемый на кнопке панели инструментов.|
|[CToolBarCtrl::GetMetrics](#getmetrics)|Извлекает метрики из элемента управления панели инструментов.|
|[CToolBarCtrl::GetPadding](#getpadding)|Возвращает горизонтальные и вертикальные заполнение текущего элемента управления панели инструментов.|
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|Извлекает список изображений, текущего элемента управления панель инструментов используется для представления кнопки в состоянии нажатия.|
|[CToolBarCtrl::GetRect](#getrect)|Получает ограничивающий прямоугольник для указанной кнопки панели инструментов.|
|[CToolBarCtrl::GetRows](#getrows)|Возвращает число строк, кнопок, отображаемых на панели инструментов.|
|[CToolBarCtrl::GetState](#getstate)|Извлекает сведения о состоянии от указанной кнопки в элементе управления панели инструментов, таких как она включена, нажата ли флажок установлен.|
|[CToolBarCtrl::GetString](#getstring)|Извлекает строку, панели инструментов.|
|[CToolBarCtrl::GetStyle](#getstyle)|Получает стили в настоящий момент для элемента управления панели инструментов.|
|[CToolBarCtrl::GetToolTips](#gettooltips)|Извлекает дескриптор элемента управления всплывающей подсказки, если имеется, сопоставленный с элементом управления панели инструментов.|
|[CToolBarCtrl::HideButton](#hidebutton)|Скрытие или отображение указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::HitTest](#hittest)|Определяет, где находится точка элемента управления toolbar.|
|[CToolBarCtrl::Indeterminate](#indeterminate)|Задает или удаляет неопределенное состояние (серый) от указанной кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::InsertButton](#insertbutton)|Вставляет кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|Извлекает сведения знак вставки для точки в панели инструментов.|
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|Указывает, проверяется ли указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|Указывает, включена ли указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|Указывает, скрыт ли указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|Проверяет состояние выделения кнопки панели инструментов.|
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|Сообщает, является ли состояние от указанной кнопки в элемент управления toolbar неопределенное (серый).|
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|Указывает, нажата ли указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::LoadImages](#loadimages)|Загружает растровые изображения в панели инструментов элемента управления списка изображений.|
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|Сопоставляет символ сочетаний клавиш для кнопки панели инструментов.|
|[CToolBarCtrl::MarkButton](#markbutton)|Задает состояние выделения указанной кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::MoveButton](#movebutton)|Перемещает кнопки из одного индекса в другую.|
|[CToolBarCtrl::PressButton](#pressbutton)|Нажимает или отпускает указанную кнопку в элементе управления панели инструментов.|
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|Заменяет существующий растрового изображения в текущий элемент управления панели инструментов новое растровое изображение.|
|[CToolBarCtrl::RestoreState](#restorestate)|Восстанавливает состояние элемента управления панели инструментов.|
|[CToolBarCtrl::SaveState](#savestate)|Сохраняет состояние элемента панели инструментов.|
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|Задает выделение привязки параметра для панели инструментов.|
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|Задает размер точечных рисунков, добавляемый в элемент управления toolbar.|
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|Задает информацию для существующей кнопки в панели инструментов.|
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|Задает размер кнопки, чтобы добавить в элемент управления toolbar.|
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|Указывает размер `TBBUTTON` структуры.|
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|Задает кнопки, минимальное и максимальное значения ширины в панели инструментов.|
|[CToolBarCtrl::SetCmdID](#setcmdid)|Задает идентификатор команды, отправляемые окну-владельцу при нажатии указанную кнопку.|
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|Задает цветовую схему текущего элемента управления панели инструментов.|
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|Задает список изображений, будет использоваться элементом управления панели инструментов для отображения отключен кнопок.|
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Задает флаги в функции Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), который используется для рисования текста в указанном прямоугольнике, отформатированный согласно установке флаги.|
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|Задает расширенные стили для элемента управления панели инструментов.|
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|Задает список изображений, панели инструментов будет использоваться для отображения кнопки «горячие».|
|[CToolBarCtrl::SetHotItem](#sethotitem)|Задает элемент "Горячий" в панели инструментов.|
|[CToolBarCtrl::SetImageList](#setimagelist)|Задает список изображений, панели инструментов будет использоваться для отображения кнопок, которые находятся в состоянии по умолчанию.|
|[CToolBarCtrl::SetIndent](#setindent)|Задает отступ для первой кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|Задает текущий знак вставки для панели инструментов.|
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Задает цвет, используемый для рисования знак вставки для панели инструментов.|
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|Задает максимальное количество строк текста, отображаемый на кнопке панели инструментов.|
|[CToolBarCtrl::SetMetrics](#setmetrics)|Задает метрики элемента управления toolbar.|
|[CToolBarCtrl::SetOwner](#setowner)|Задает окно для получения сообщений уведомления из элемента управления панели инструментов.|
|[CToolBarCtrl::SetPadding](#setpadding)|Задает величину заполнения горизонтальные и вертикальные текущего элемента управления панели инструментов.|
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|Задает список изображений, текущего элемента управления панель инструментов используется для представления кнопки в состоянии нажатия.|
|[CToolBarCtrl::SetRows](#setrows)|Задает число строк, кнопок, отображаемых на панели инструментов.|
|[CToolBarCtrl::SetState](#setstate)|Задает состояние для указанной кнопки в элементе управления панели инструментов.|
|[CToolBarCtrl::SetStyle](#setstyle)|Задает стили для элемента управления панели инструментов.|
|[CToolBarCtrl::SetToolTips](#settooltips)|Связывает элемент управления всплывающей подсказки с панели инструментов.|
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|Задает визуальный стиль элемента управления toolbar.|

## <a name="remarks"></a>Примечания

Этот элемент управления (и, следовательно `CToolBarCtrl` класс) доступны только для программ, работающих в Windows 95/98 и Windows NT версии 3.51 и более поздних версиях.

Общего элемента управления панели инструментов Windows — прямоугольная дочернее окно, содержащий одну или несколько кнопок. Эти кнопки можно отобразить растровое изображение и строка. Когда пользователь нажимает кнопку, он отправляет сообщение команды панели инструментов окна-владельца. Как правило кнопок на панели инструментов, соответствующие элементам в меню приложения; они предоставляют более прямой способ для пользователя для доступа к командам приложения.

`CToolBarCtrl` объекты содержат несколько важных внутренних структур данных: список точечного рисунка для кнопки изображения или списка изображений, список строк метки кнопки и список `TBBUTTON` структур, которые связать изображение и/или string позицией, стиль, состояние и идентификатор кнопки. Каждый из элементов этих структур данных ссылается отсчитываемый от нуля индекс. Перед использованием `CToolBarCtrl` объекта, необходимо настроить эти структуры данных. Список строк может использоваться только для надписей на кнопках; не удается извлечь строки из панели инструментов.

Чтобы использовать `CToolBarCtrl` объекта, вы обычно выполняются следующие действия:

1. Создать `CToolBarCtrl` объекта.

1. Вызовите [создать](#create) для создания общего элемента управления панели инструментов Windows и присоединить его к `CToolBarCtrl` объекта. С помощью стилей, например TBSTYLE_TRANSPARENT для прозрачного панели инструментов или TBSTYLE_DROPDOWN для панели инструментов, которая поддерживает кнопки раскрывающегося списка, указывающих стиль параметра панели инструментов.

1. Определите способ кнопки на панели инструментов отображается:

   - Чтобы использовать растровые изображения для кнопок, добавьте точечного рисунка для кнопки панели инструментов путем вызова [AddBitmap](#addbitmap).

   - Чтобы использовать изображений, отображаемых в списке изображений для кнопок, укажите список изображений, вызвав [SetImageList](#setimagelist), [SetHotImageList](#sethotimagelist), или [SetDisabledImageList](#setdisabledimagelist).

   - Чтобы использовать строку метки для кнопки, добавлять строки панели инструментов, вызвав [AddString](#addstring) и/или [AddStrings](#addstrings).

1. Добавьте структур кнопки панели инструментов, вызвав метод [AddButtons](#addbuttons).

1. Если вы хотите всплывающие подсказки для кнопки панели инструментов в окно-владелец, не `CFrameWnd`, вам нужно обрабатывать TTN_NEEDTEXT сообщения в окно-владелец панели инструментов, как описано в разделе [обработка уведомлений всплывающих совет](../../mfc/handling-tool-tip-notifications.md). Если родительское окно панели инструментов является производным от `CFrameWnd`, всплывающие подсказки отображаются без дополнительных усилий от вас, так как `CFrameWnd` предоставляет обработчик по умолчанию.

1. Если требуется, чтобы пользователь имел возможность настроить панель инструментов, обрабатывать настройки уведомляющих сообщений в окно-владелец, как описано в разделе [обработка уведомлений о настройке](../../mfc/handling-customization-notifications.md).

Можно использовать [SaveState](#savestate) для сохранения текущего состояния элемента управления панели инструментов в реестре и [RestoreState](#restorestate) для восстановления состояния на основе сведений, которые ранее хранились в реестре. Помимо сохранения состояния панели инструментов между используется приложения, приложения обычно хранят состояние, прежде чем пользователь начинает настраивать панели инструментов, в случае, если позже пользователь хочет восстановить в исходное состояние панели инструментов.

## <a name="support-for-internet-explorer-version-40-and-later"></a>Поддержка Internet Explorer версии 4.0 и более поздние версии

Для поддержки функциональных возможностей, появившихся в Internet Explorer версии 4.0 и более поздних версий, MFC предоставляет поддержку списка образов и прозрачные и плоский стили для элементов управления панели инструментов.

Прозрачные панели инструментов позволяет клиенту под панелью инструментов видны сквозь. Чтобы создать прозрачные панели инструментов, используйте стили TBSTYLE_FLAT и TBSTYLE_TRANSPARENT. Прозрачные панели инструментов компонентов отслеживание; то есть при перемещении указателя мыши на кнопку в активном состоянии на панели инструментов, внешний вид кнопки изменяется. Панели инструментов, созданные с помощью стиль TBSTYLE_FLAT будет содержать кнопки, которые не являются прозрачными.

Поддержка списка образов позволяет гибкость управления, поведение по умолчанию, наиболее часто используемыми изображениями и отключенные образов. Используйте [GetImageList](#getimagelist), [GetHotImageList](#gethotimagelist), и [GetDisabledImageList](#getdisabledimagelist) с помощью панели инструментов, прозрачное для операций с изображением в зависимости от его состояния:

Дополнительные сведения об использовании `CToolBarCtrl`, см. в разделе [элементов управления](../../mfc/controls-mfc.md) и [использование CToolBarCtrl](../../mfc/using-ctoolbarctrl.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>Требования

**Заголовок:** afxcmn.h

##  <a name="addbitmap"></a>  CToolBarCtrl::AddBitmap

Добавляет один или несколько образов кнопки в список изображений кнопок, хранящихся в панели инструментов.

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>Параметры

*nNumButtons*<br/>
Количество изображений кнопки в точечном рисунке.

*nBitmapID*<br/>
Идентификатор ресурса точечного рисунка, который содержит изображение кнопки или изображения.

*pBitmap*<br/>
Указатель на `CBitmap` объект, содержащий изображение кнопки или изображения.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первого новый образ, если выполнение прошло успешно; в противном случае - 1.

### <a name="remarks"></a>Примечания

Вы можете использовать Windows API [CreateMappedBitmap](/windows/desktop/api/commctrl/nf-commctrl-createmappedbitmap) для сопоставления цветов перед добавлением растрового изображения на панель инструментов. Если передать указатель на `CBitMap` объекта, необходимо убедиться, что точечный рисунок не уничтожается до, после уничтожения панели инструментов.

##  <a name="addbuttons"></a>  CToolBarCtrl::AddButtons

Добавляет одну или несколько кнопок в элемент управления toolbar.

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>Параметры

*nNumButtons*<br/>
Число кнопок для добавления.

*lpButtons*<br/>
Адрес массива `TBBUTTON` структур, содержащих сведения о кнопках для добавления. Должно быть одинаковое количество элементов в массиве, как кнопки, определяемое *nNumButtons*.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

*LpButtons* указатель указывает на массив `TBBUTTON` структуры. Каждый `TBBUTTON` структура связывает кнопку, добавляемый с помощью стиля кнопки, состояние образа или строку, идентификатор команды и определенные пользователем данные:

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

Далее приведены элементы.

- `iBitmap`

   Отсчитываемый от нуля индекс изображения для кнопки, -1, если изображение не для данной кнопки.

- `idCommand`

   Идентификатор команды, связанный с кнопкой. Этот идентификатор отправляется в сообщении WM_COMMAND, после нажатия кнопки. Если `fsStyle` имеет значение TBSTYLE_SEP, этот элемент должен быть равен нулю.

- `fsState`

   Флаги состояния кнопок. Это может быть сочетанием значений, перечисленных ниже:

   - TBSTATE_CHECKED кнопки имеет стиль TBSTYLE_CHECKED и нажат.

   - TBSTATE_ENABLED кнопки принимает входные данные пользователя. Кнопка, которая не поддерживает это состояние не принимает ввод данных пользователем и отображается серым цветом.

   - TBSTATE_HIDDEN кнопка не отображается и не может принимать ввод данных пользователем.

   - TBSTATE_INDETERMINATE кнопки отображается серым цветом.

   - TBSTATE_PRESSED кнопка нажата.

   - Разрыв строки типа TBSTATE_WRAP ниже кнопки. Кнопки также должен иметь состояние TBSTATE_ENABLED.

- `fsStyle`

   Стиль кнопки. Это может быть сочетанием значений, перечисленных ниже:

   - TBSTYLE_BUTTON создает стандартные кнопки.

   - Создает TBSTYLE_CHECK кнопки переключения между состояниями нажатого и ненажатое каждый раз пользователь нажимает ее. Кнопка имеет другой цвет фона, когда он находится в нажатом состоянии.

   - TBSTYLE_CHECKGROUP создает кнопку проверки, которая остается нажатия клавиш еще одну кнопку в группе.

   - TBSTYLE_GROUP создает кнопку, которая остается нажатия клавиш еще одну кнопку в группе.

   - TBSTYLE_SEP создает разделитель, предоставляя небольшой разрыв между группами кнопки. Кнопки, содержащей этот стиль не ввода данных пользователем.

- `dwData`

   Определяемые пользователем данные.

- `iString`

   Отсчитываемый от нуля индекс строки для использования в качестве кнопки метки, -1, если строка не для данной кнопки.

Изображения и/или строка, индекс которого вами необходимо ранее были добавлены в элемент управления панели инструментов списка с помощью [AddBitmap](#addbitmap), [AddString](#addstring), и/или [AddStrings](#addstrings).

##  <a name="addstring"></a>  CToolBarCtrl::AddString

Добавляет новую строку, переданный в качестве идентификатора ресурса панели инструментов внутренний список строк.

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>Параметры

*nStringID*<br/>
Идентификатор ресурса строкового ресурса, добавляемый в список строк элемента управления панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первого новая строка добавляется, если выполнение прошло успешно; в противном случае-1.

##  <a name="addstrings"></a>  CToolBarCtrl::AddStrings

Добавляет новую строку или строки в список строк, доступных для элемента управления панели инструментов.

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>Параметры

*lpszStrings*<br/>
Адрес буфера, который содержит один или несколько нулем строки для добавления в список строк на панели инструментов. Последняя строка должна заканчиваться точкой с двумя символами null.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс первого новая строка добавляется, если выполнение прошло успешно; в противном случае-1.

### <a name="remarks"></a>Примечания

Строки в буфере, должны быть разделены нуль-символом. Необходимо убедиться, что последняя строка имеет два конца. Чтобы правильно отформатировать строковую константу, можно написать его как:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

или

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

Не следует передавать `CString` объект этой функции, поскольку он не может быть более одного символа null `CString`.

##  <a name="autosize"></a>  CToolBarCtrl::AutoSize

Изменяет размер элемента управления панель инструментов полностью.

```
void AutoSize();
```

### <a name="remarks"></a>Примечания

Эту функцию следует вызывать при изменении размера родительского окна или при изменении размера панели инструментов (например, при установке размер растрового изображения или кнопки, или добавить строки).

##  <a name="changebitmap"></a>  CToolBarCtrl::ChangeBitmap

Изменяет растрового изображения для кнопки на текущий элемент управления панели инструментов.

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*idButton*|[in] Идентификатор команды кнопки, который принимает новое растровое изображение.|
|*iBitmap*|[in] Отсчитываемый от нуля индекс изображения в список изображений для текущего элемента управления панели инструментов.|

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Если этот метод выполняется успешно, система отображает указанное изображение в указанную кнопку.

Этот метод отправляет [TB_CHANGEBITMAP](/windows/desktop/Controls/tb-changebitmap) сообщения, который описан в пакете Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода изменяется растрового изображения для **сохранения файла** кнопку, чтобы растровое изображение для **о** кнопки.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

##  <a name="checkbutton"></a>  CToolBarCtrl::CheckButton

Проверяет, или очищает указанной кнопки в элементе управления панели инструментов.

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки установите или снимите флажок.

*bПроверять обновления*<br/>
Значение true, чтобы проверка кнопки, значение FALSE, чтобы очистить его.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Когда переключатель кажется нажатия. Если вы хотите изменить несколько состояний кнопки, рассмотрите возможность вызова [SetState](#setstate) вместо этого.

##  <a name="commandtoindex"></a>  CToolBarCtrl::CommandToIndex

Возвращает отсчитываемый от нуля индекс для кнопки, связанной с указанным идентификатором команды.

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды, индекса, кнопка которой вы хотите найти.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс кнопки, связанной с идентификатором команды.

### <a name="remarks"></a>Примечания

##  <a name="create"></a>  CToolBarCtrl::Create

Создает элемент управления панели инструментов и присоединяет его к `CToolBarCtrl` объекта.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*dwStyle*<br/>
Задает стиль элемента управления панели инструментов. Панели инструментов всегда должен иметь стиль WS_CHILD. Кроме того, можно указать любое сочетание стили окна и панели инструментов, как описано в разделе **"Примечания"**.

*rect*<br/>
При необходимости указывает размер и положение элемента управления панели инструментов. Может быть либо [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или [RECT](/previous-versions/dd162897\(v=vs.85\)) структуры.

*pParentWnd*<br/>
Указывает родительскому окну элемента управления панели инструментов. Он не должен иметь значение NULL.

*nID*<br/>
Указывает идентификатор элемента управления панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

При создании `CToolBarCtrl` в два этапа. Во-первых, вызовите конструктор, а затем вызвать `Create`, который создает элемент управления панели инструментов и присоединяет его к `CToolBarCtrl` объекта. Применяются следующие стили окна в элемент управления toolbar.

- WS_CHILD всегда

- WS_VISIBLE обычно

- WS_DISABLED редко

См. в разделе [CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) в пакете SDK для Windows, описание стили окна.

При необходимости применить сочетание [общие стили элемента управления](/windows/desktop/Controls/common-control-styles), как описано в пакете Windows SDK.

Применить сочетание стили панели инструментов на элемент управления или кнопки, сами. Стили, описаны в разделе [панели инструментов и стили кнопок](/windows/desktop/Controls/toolbar-control-and-button-styles) в пакете Windows SDK.

Чтобы использовать стили расширенных панели инструментов, вызовите [SetExtendedStyle](#setextendedstyle) после вызова метода `Create`. Чтобы создать панель инструментов с расширенные стили окна, вызовите [CToolBarCtrl::CreateEx](#createex) вместо `Create`.

Панели инструментов автоматически задает размер и положение окна инструментов. Высота основана на высоту кнопок на панели инструментов. Ширина равна так же, как Ширина клиентской области родительского окна. Стили CCS_TOP и CCS_BOTTOM определить, установлен ли вдоль верхней или нижней части клиентской области панели инструментов. По умолчанию панель инструментов имеет стиль CCS_TOP.

##  <a name="createex"></a>  CToolBarCtrl::CreateEx

Создает элемент управления (дочернего окна) и связывает его с `CToolBarCtrl` объекта.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*dwExStyle*<br/>
Указывает расширенный стиль создаваемого элемента управления. Список расширенных стилей Windows, см. в разделе *dwExStyle* параметр для [CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) в пакете Windows SDK.

*dwStyle*<br/>
Задает стиль элемента управления панели инструментов. Панели инструментов всегда должен иметь стиль WS_CHILD. Кроме того, можно указать любое сочетание стили окна и панели инструментов, как описано в разделе **"Примечания"** раздел [создать](#create).

*rect*<br/>
Ссылку на [RECT](/previous-versions/dd162897\(v=vs.85\)) структура, описывающая размер и положение окна, создаваемых в клиентских координатах *pParentWnd*.

*pParentWnd*<br/>
Указатель на окно, которое является родительским для элемента управления.

*nID*<br/>
Идентификатор элемента управления дочернего окна.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Используйте `CreateEx` вместо [создать](#create) применение расширенных стилей Windows, определяемое префикс расширенного стиля Windows **WS_EX_**. `CreateEx` Создает элемент управления с помощью расширенных стилей Windows, определяемое *dwExStyle*. Расширенные стили, определенные для элемента управления с помощью набора [SetExtendedStyle](#setextendedstyle). Например, использовать `CreateEx` такие стили заданы как WS_EX_CONTEXTHELP, но используют `SetExtendedStyle` должны стать TBSTYLE_EX_DRAWDDARROWS подобные стили. Дополнительные сведения см. в разделе стили, описанные в [расширенные стили панели инструментов](/windows/desktop/Controls/toolbar-extended-styles) в пакете Windows SDK.

##  <a name="ctoolbarctrl"></a>  CToolBarCtrl::CToolBarCtrl

Создает объект `CToolBarCtrl`.

```
CToolBarCtrl();
```

### <a name="remarks"></a>Примечания

Необходимо вызвать [создать](#create) чтобы можно было использовать на панели инструментов.

##  <a name="customize"></a>  CToolBarCtrl::Customize

Отображает диалоговое окно Настройка панели инструментов.

```
void Customize();
```

### <a name="remarks"></a>Примечания

Это диалоговое окно позволяет пользователю настроить путем добавления и удаления кнопок панели инструментов. Для поддержки настройки, на панели инструментов родительского окна необходимо обрабатывать сообщения уведомления настройки, как описано в разделе [обработка уведомлений о настройке](../../mfc/handling-customization-notifications.md). На панель инструментов должна также быть создана в стиле CCS_ADJUSTABLE, как описано в разделе [CToolBarCtrl::Create](#create).

##  <a name="deletebutton"></a>  CToolBarCtrl::DeleteButton

Удаление кнопки из панели инструментов.

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс кнопки для удаления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

##  <a name="enablebutton"></a>  CToolBarCtrl::EnableButton

Включает или отключает указанную кнопку в элементе управления панели инструментов.

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для включения или отключения кнопки.

*bEnable*<br/>
Значение TRUE, чтобы включить кнопку; Значение FALSE, чтобы отключить кнопку.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Кнопка включена, может быть нажата и при проверки. Если вы хотите изменить несколько состояний кнопки, рассмотрите возможность вызова [SetState](#setstate) вместо этого.

##  <a name="getanchorhighlight"></a>  CToolBarCtrl::GetAnchorHighlight

Извлекает привязки выделения для панели инструментов.

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>Возвращаемое значение

Если значение ненулевое, включено выделение привязки. Если значение равно нулю, выделение привязки будет отключено.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-getanchorhighlight), как описано в пакете Windows SDK.

##  <a name="getbitmap"></a>  CToolBarCtrl::GetBitmap

Извлекает индекс растровое изображение, связанное с кнопкой на панели инструментов.

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки — точечного рисунка, индекс которого требуется извлечь.

### <a name="return-value"></a>Возвращаемое значение

Возвращает индекс точечного рисунка, если успешно, или нуль, в противном случае.

### <a name="remarks"></a>Примечания

Реализует функции [TB_GETBITMAP](/windows/desktop/Controls/tb-getbitmap) в пакете Windows SDK.

##  <a name="getbitmapflags"></a>  CToolBarCtrl::GetBitmapFlags

Извлекает флаги растрового изображения на панели инструментов.

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>Возвращаемое значение

Целое число без знака, флаг TBBF_LARGE Если отображение поддерживает растровые изображения панели инструментов, в противном случае снимите.

### <a name="remarks"></a>Примечания

Его следует вызывать после создания панели инструментов, но перед добавлением растровые изображения в панели инструментов. Возвращаемое значение указывает, поддерживает ли отображение большие точечные рисунки. Если отображение поддерживает большие точечные рисунки, и если вы решили использовать их, вызвать [SetBitmapSize](#setbitmapsize) и [SetButtonSize](#setbuttonsize) перед добавлением большую битовую карту с помощью [AddBitmap](#addbitmap).

##  <a name="getbutton"></a>  CToolBarCtrl::GetButton

Извлекает сведения об указанной кнопки в элементе управления панели инструментов.

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс кнопки, для которого требуется извлечь сведения.

*lpButton*<br/>
Адрес `TBBUTTON` структуры, который принимает копию сведения о кнопке. См. в разделе [CToolBarCtrl::AddButtons](#addbuttons) сведения о `TBBUTTON` структуры.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

##  <a name="getbuttoncount"></a>  CToolBarCtrl::GetButtonCount

Получает число кнопок в панели инструментов.

```
int GetButtonCount() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число кнопок.

##  <a name="getbuttoninfo"></a>  CToolBarCtrl::GetButtonInfo

Возвращает сведения для кнопки на панели инструментов.

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*ptbbi*<br/>
Указатель на [TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa) структуру, которая получает сведения о кнопке.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс кнопки, если выполнение прошло успешно; в противном случае-1.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETBUTTONINFO](/windows/desktop/Controls/tb-getbuttoninfo), как описано в пакете Windows SDK.

##  <a name="getbuttonsize"></a>  CToolBarCtrl::GetButtonSize

Получает размер кнопки панели инструментов.

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение DWORD, содержащее значения ширины и высоты в LOWORD и HIWORD, соответственно.

##  <a name="getbuttontext"></a>  CToolBarCtrl::GetButtonText

Получает отображаемый текст данного указанную кнопку на текущий элемент управления панели инструментов.

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*idButton*|[in] Идентификатор для кнопки, извлечения, отображаемый текст.|

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/using-cstring.md) , содержащий отображаемый текст от указанной кнопки.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_GETBUTTONTEXT](/windows/desktop/Controls/tb-getbuttontext) сообщения, который описан в пакете Windows SDK.

##  <a name="getcolorscheme"></a>  CToolBarCtrl::GetColorScheme

Возвращает цветовую схему текущего элемента управления панели инструментов.

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*lpColorScheme*|[out] Указатель на [COLORSCHEME](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme) структуру, которая получает сведения о схеме цвет. При возвращении данного метода структура описывает цветом и цветом тени панели инструментов.|

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_GETCOLORSCHEME](/windows/desktop/Controls/tb-getcolorscheme) сообщения, который описан в пакете Windows SDK.

##  <a name="getdisabledimagelist"></a>  CToolBarCtrl::GetDisabledImageList

Извлекает список изображений, элемент управления панели инструментов используется для отображения отключен кнопок.

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объекта, или значение NULL, если список изображений отключено не задано.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-getdisabledimagelist), как описано в пакете Windows SDK. Реализация MFC `GetDisabledImageList` использует `CImageList` образы объект, содержащий кнопку панели инструментов, вместо того чтобы дескриптор списка изображений.

##  <a name="getdroptarget"></a>  CToolBarCtrl::GetDropTarget

Извлекает [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) интерфейс для элемента управления панели инструментов.

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>Параметры

*ppDropTarget*<br/>
Указатель на [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) указатель на интерфейс. Если возникает ошибка, указатель NULL помещается в этот адрес.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение HRESULT указывает на успешное или неуспешное выполнение операции.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETOBJECT](/windows/desktop/Controls/tb-getobject), как описано в пакете Windows SDK.

##  <a name="getextendedstyle"></a>  CToolBarCtrl::GetExtendedStyle

Извлекает расширенные стили для элемента управления панели инструментов.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, представляющее расширенные стили в настоящий момент для элемента управления панели инструментов. Список стилей, см. в разделе [расширенные стили панели инструментов](/windows/desktop/Controls/toolbar-extended-styles), в пакете Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETEXTENDEDSTYLE](/windows/desktop/Controls/tb-getextendedstyle), как описано в пакете Windows SDK.

##  <a name="gethotimagelist"></a>  CToolBarCtrl::GetHotImageList

Извлекает список изображений, элемент управления панель инструментов используется для отображения кнопки «горячие». Кнопку в активном состоянии выделяется, когда указатель мыши находится над ним.

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объекта, или значение NULL, если список изображений отключено не задано.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETHOTIMAGELIST](/windows/desktop/Controls/tb-gethotimagelist), как описано в пакете Windows SDK. Кнопку в активном состоянии выделяется, когда указатель мыши находится над ним.

##  <a name="gethotitem"></a>  CToolBarCtrl::GetHotItem

Извлекает индекс элемента, "Горячий" в панели инструментов.

```
int GetHotItem() const;
```

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс элемента, "Горячий" в панели инструментов.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETHOTITEM](/windows/desktop/Controls/tb-gethotitem), как описано в пакете Windows SDK.

##  <a name="getimagelist"></a>  CToolBarCtrl::GetImageList

Извлекает список изображений, элемент управления панель инструментов используется для отображения кнопки в состоянии по умолчанию.

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объекта, или значение NULL, если список изображений не задано.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETIMAGELIST](/windows/desktop/Controls/tb-getimagelist), как описано в пакете Windows SDK.

##  <a name="getinsertmark"></a>  CToolBarCtrl::GetInsertMark

Извлекает текущий знак вставки для панели инструментов.

```
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>Параметры

*ptbim*<br/>
Указатель на [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) структуру, которая получает знак вставки.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETINSERTMARK](/windows/desktop/Controls/tb-getinsertmark), как описано в пакете Windows SDK.

##  <a name="getinsertmarkcolor"></a>  CToolBarCtrl::GetInsertMarkColor

Получает цвет, используемый для рисования знак вставки для панели инструментов.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение COLORREF, содержащее текущий цвет знака вставки.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETINSERTMARKCOLOR](/windows/desktop/Controls/tb-getinsertmarkcolor), как описано в пакете Windows SDK.

##  <a name="getitemrect"></a>  CToolBarCtrl::GetItemRect

Возвращает ограничивающий прямоугольник, кнопки в элементе управления панели инструментов.

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс кнопки, для которого требуется извлечь сведения.

*lpRect*<br/>
Адрес [RECT](/previous-versions/dd162897\(v=vs.85\)) структуры или [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, получающий координаты ограничивающего прямоугольника.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция не извлекает ограничивающий прямоугольник для кнопки, состояние которого имеет значение TBSTATE_HIDDEN.

##  <a name="getmaxsize"></a>  CToolBarCtrl::GetMaxSize

Получает общий размер всех видимых кнопок и разделителя групп разрядов в панели инструментов.

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>Параметры

*pSize*<br/>
Указатель на [размер](/windows/desktop/api/windef/ns-windef-tagsize) структуру, которая получает размер элементов.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETMAXSIZE](/windows/desktop/Controls/tb-getmaxsize), как описано в пакете Windows SDK.

##  <a name="getmaxtextrows"></a>  CToolBarCtrl::GetMaxTextRows

Извлекает максимальное количество строк текста, отображаемый на кнопке панели инструментов.

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>Возвращаемое значение

Максимальное количество строк текста, отображаемый на кнопке панели инструментов.

##  <a name="getmetrics"></a>  CToolBarCtrl::GetMetrics

Извлекает метрики `CToolBarCtrl` объекта.

```
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>Параметры

*ptbm*<br/>
Указатель на [TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics) структуры `CToolBarCtrl` объекта.

### <a name="remarks"></a>Примечания

Эта функция-член эмулирует функциональные возможности [TB_GETMETRICS](/windows/desktop/Controls/tb-getmetrics) сообщения, как описано в пакете Windows SDK.

##  <a name="getpadding"></a>  CToolBarCtrl::GetPadding

Возвращает горизонтальные и вертикальные заполнение текущего элемента управления панели инструментов.

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*pnHorzPadding*|[out] Целое число, Получает горизонтальный отступ элемента управления панели инструментов, в пикселях.|
|*pnVertPadding*|[out] Целое число, Получает вертикальный отступ элемента управления панели инструментов, в пикселях.|

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_GETPADDING](/windows/desktop/Controls/tb-getpadding) сообщения, который описан в пакете Windows SDK.

##  <a name="getpressedimagelist"></a>  CToolBarCtrl::GetPressedImageList

Извлекает список изображений, текущего элемента управления панель инструментов используется для представления кнопки в состоянии нажатия.

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий список изображений для текущего элемента управления, или значение NULL, если такой список изображений не установлен.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_GETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-getpressedimagelist) сообщения, который описан в пакете Windows SDK.

##  <a name="getrect"></a>  CToolBarCtrl::GetRect

Получает ограничивающий прямоугольник для указанной кнопки панели инструментов.

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*lpRect*<br/>
Указатель на [RECT](/previous-versions/dd162897\(v=vs.85\)) структуру для получения ограничивающего прямоугольника сведения.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если успешно; в противном случае — FALSE.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETRECT](/windows/desktop/Controls/tb-getrect), как описано в пакете Windows SDK.

##  <a name="getrows"></a>  CToolBarCtrl::GetRows

Возвращает число строк, кнопок, отображаемых элементом управления панели инструментов.

```
int GetRows() const;
```

### <a name="return-value"></a>Возвращаемое значение

Количество строк, кнопок, отображаемых на панели инструментов.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что количество строк всегда будет один Если панели инструментов был создан с помощью TBSTYLE_WRAPABLE стиль.

##  <a name="getstate"></a>  CToolBarCtrl::GetState

Извлекает сведения о состоянии от указанной кнопки в элементе управления панели инструментов, таких как она включена, нажата ли флажок установлен.

```
int GetState(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки, для которого необходимо получить сведения.

### <a name="return-value"></a>Возвращаемое значение

Сведения о кнопке состояние успеха или - 1 в противном случае. Сведения о состоянии кнопки может представлять собой сочетание значений, перечисленных в [CToolBarCtrl::AddButtons](#addbuttons).

### <a name="remarks"></a>Примечания

Эта функция особенно полезна в том случае, если вы хотите получить более чем одно из состояний кнопки. Чтобы просто получить одно состояние, используйте один из следующих функций-членов: [IsButtonEnabled](#isbuttonenabled), [IsButtonChecked](#isbuttonchecked), [IsButtonPressed](#isbuttonpressed), [IsButtonHidden](#isbuttonhidden), или [IsButtonIndeterminate](#isbuttonindeterminate). Тем не менее `GetState` функция-член является единственным способом для обнаружения состояния кнопки TBSTATE_WRAP.

##  <a name="getstring"></a>  CToolBarCtrl::GetString

Извлекает строку, панели инструментов.

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>Параметры

*nString*<br/>
Индекс строки.

*lpstrString*<br/>
Указатель на буфер, используемый для возврата строки.

*cchMaxLen*<br/>
Длина буфера в байтах.

*str*<br/>
Строка.

### <a name="return-value"></a>Возвращаемое значение

Длина строки, в случае успешного выполнения -1, если это не так.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_GETSTRING](/windows/desktop/Controls/tb-getstring), как описано в пакете Windows SDK.

##  <a name="getstyle"></a>  CToolBarCtrl::GetStyle

Получает стили, примененные к элементу управления панели инструментов.

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>Возвращаемое значение

DWORD, содержащее сочетание [стили элемента управления панели инструментов](/windows/desktop/Controls/toolbar-control-and-button-styles), как описано в пакете Windows SDK.

##  <a name="gettooltips"></a>  CToolBarCtrl::GetToolTips

Извлекает дескриптор элемента управления всплывающей подсказки, если имеется, сопоставленный с элементом управления панели инструментов.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) объект, связанный с этой панели инструментов или значение NULL, если панель инструментов содержит нет связанного всплывающая подсказка.

### <a name="remarks"></a>Примечания

Так как элемент управления панели инструментов обычно создает и обслуживает собственную всплывающая подсказка, большинство программ не нужно вызывать эту функцию.

##  <a name="hittest"></a>  CToolBarCtrl::HitTest

Определяет, где находится точка элемента управления toolbar.

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>Параметры

*PPT*<br/>
Указатель на [ТОЧКИ](/previous-versions/dd162805\(v=vs.85\)) структуру, содержащую Координата по оси x для проверки нажатия в `x` член и Координата y в которой произведен щелчок тестирования в `y` член. Координаты указываются относительно клиентской области панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Целое число, указывающее расположение точки на панели инструментов. Если значение равно 0 или положительное значение, возвращаемое значение — это отсчитываемый от нуля индекс элемента nonseparator, в которой находится точка.

Если возвращаемое значение отрицательное, точку выйдет за пределы кнопки. Абсолютное значение возвращаемого значения является индекс элемент разделителя или ближайший элемент nonseparator.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_HITTEST](/windows/desktop/Controls/tb-hittest), как описано в пакете Windows SDK.

##  <a name="hidebutton"></a>  CToolBarCtrl::HideButton

Скрытие или отображение указанную кнопку в элементе управления панели инструментов.

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды для кнопки, чтобы скрыть или отобразить.

*bHide*<br/>
Значение TRUE, чтобы скрыть кнопки, FALSE, он будет отображаться.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Если вы хотите изменить несколько состояний кнопки, рассмотрите возможность вызова [SetState](#setstate) вместо этого.

##  <a name="indeterminate"></a>  CToolBarCtrl::Indeterminate

Задает или удаляет неопределенное состояние указанной кнопки в элементе управления панели инструментов.

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды является неопределенное состояние которого нужно установить или очистить кнопки.

*bIndeterminate*<br/>
Значение TRUE, чтобы задать неопределенное состояние кнопки значение FALSE, чтобы очистить его.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Неопределенное кнопки отображаются серым цветом, такие, как будут выглядеть способ полужирным кнопки на панели инструментов текстового редактора, когда выделение текста содержит символы полужирным шрифтом и регулярных. Если вы хотите изменить несколько состояний кнопки, рассмотрите возможность вызова [SetState](#setstate) вместо этого.

##  <a name="insertbutton"></a>  CToolBarCtrl::InsertButton

Вставляет кнопки в элементе управления панели инструментов.

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс кнопки. Эта функция вставляет новую кнопку слева от этой кнопки.

*lpButton*<br/>
Адрес `TBBUTTON` структуру, содержащую сведения о кнопке для вставки. См. в разделе [CToolBarCtrl::AddButtons](#addbuttons) описание `TBBUTTON` структуры.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Изображения и/или строка, индекс которого вами необходимо ранее были добавлены в элемент управления панели инструментов списка с помощью [AddBitmap](#addbitmap), [AddString](#addstring), и/или [AddStrings](#addstrings).

##  <a name="insertmarkhittest"></a>  CToolBarCtrl::InsertMarkHitTest

Извлекает сведения знак вставки для точки в панели инструментов.

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>Параметры

*PPT*<br/>
Указатель на [ТОЧКИ](/previous-versions/dd162805\(v=vs.85\)) структуру, содержащую нажатия координаты относительно клиентской области панели инструментов.

*ptbim*<br/>
Указатель на [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) структуры, получающий сведения знак вставки.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_INSERTMARKHITTEST](/windows/desktop/Controls/tb-insertmarkhittest), как описано в пакете Windows SDK.

##  <a name="isbuttonchecked"></a>  CToolBarCtrl::IsButtonChecked

Определяет, проверяется ли указанную кнопку в элементе управления панели инструментов.

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопок в панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если установлен флажок кнопки; в противном случае значение равно нулю.

### <a name="remarks"></a>Примечания

Рассмотрите возможность вызова [GetState](#getstate) Если вы хотите получить более одного состояния кнопки.

##  <a name="isbuttonenabled"></a>  CToolBarCtrl::IsButtonEnabled

Определяет, включен ли указанную кнопку в элементе управления панели инструментов.

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопок в панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если кнопка доступна; в противном случае значение равно нулю.

### <a name="remarks"></a>Примечания

Рассмотрите возможность вызова [GetState](#getstate) Если вы хотите получить более одного состояния кнопки.

##  <a name="isbuttonhidden"></a>  CToolBarCtrl::IsButtonHidden

Определяет, скрыт ли указанную кнопку в элементе управления панели инструментов.

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопок в панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если кнопка скрыта; в противном случае значение равно нулю.

### <a name="remarks"></a>Примечания

Рассмотрите возможность вызова [GetState](#getstate) Если вы хотите получить более одного состояния кнопки.

##  <a name="isbuttonhighlighted"></a>  CToolBarCtrl::IsButtonHighlighted

Проверяет состояние выделения кнопки панели инструментов.

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
[in] Идентификатор команды для кнопки панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Положительное целое число, если выделена кнопка, 0, если не остается выделенным, кнопки или -1, если ошибка возникает.

##  <a name="isbuttonindeterminate"></a>  CToolBarCtrl::IsButtonIndeterminate

Определяет, является ли неопределенном указанную кнопку в элементе управления панели инструментов.

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
[in] Идентификатор команды кнопок в панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Положительное целое число, если кнопка находится в неопределенном состоянии нуль, если кнопка не определено или значение-1, когда возникает ошибка.

### <a name="remarks"></a>Примечания

Неопределенное кнопки отображаются серым цветом, такие, как выглядит способ полужирным кнопки на панели инструментов текстового редактора, когда выделенный текст содержит символы полужирным шрифтом и регулярных. Рассмотрите возможность вызова [GetState](#getstate) Если вы хотите получить более одного состояния кнопки.

##  <a name="isbuttonpressed"></a>  CToolBarCtrl::IsButtonPressed

Определяет, нажата ли указанную кнопку в элементе управления панели инструментов.

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопок в панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если ее нажать, в противном случае — нуль.

### <a name="remarks"></a>Примечания

Рассмотрите возможность вызова [GetState](#getstate) Если вы хотите получить более одного состояния кнопки.

##  <a name="loadimages"></a>  CToolBarCtrl::LoadImages

Загружает растровые изображения в панели инструментов элемента управления списка изображений.

```
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>Параметры

*iBitmapID*<br/>
Идентификатор растрового изображения с изображениями для загрузки. Чтобы указать собственные ресурса точечного рисунка, значение этого параметра идентификатор ресурса точечного рисунка, а значение *hInst* значение NULL. Растровое изображение ресурса добавляются к списку изображений в качестве одного образа. Можно добавить стандартные, системный точечные рисунки, установив *hinst* HINST_COMMCTRL и присвоить ему один из следующих идентификаторов:

|Идентификатор растрового изображения|Описание|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|Точечные рисунки Explorer большого размера|
|IDB_HIST_SMALL_COLOR|Обозреватель растровых изображений небольшого размера|
|IDB_STD_LARGE_COLOR|Стандартный растровых изображений большого размера|
|IDB_STD_SMALL_COLOR|Стандартный растровых изображений небольшого размера|
|IDB_VIEW_LARGE_COLOR|Растровые изображения представления большого размера|
|IDB_VIEW_SMALL_COLOR|Представление растровых изображений небольшого размера|

*hinst*<br/>
Дескриптор экземпляра программы вызывающему приложению. Этот параметр может быть HINST_COMMCTRL для загрузки списка стандартного образа.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_LOADIMAGES](/windows/desktop/Controls/tb-loadimages), как описано в пакете Windows SDK.

##  <a name="mapaccelerator"></a>  CToolBarCtrl::MapAccelerator

Сопоставляет символ сочетаний клавиш для кнопки панели инструментов.

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>Параметры

*chAccel*<br/>
Символ сочетаний клавиш для сопоставления. Это тот же знак, подчеркнутый в текст кнопки.

*pIDBtn*<br/>
Указатель на целое число без знака, который получает идентификатор команды, кнопки, соответствующий ускоритель, указанный в *chAccel*.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_MAPACCELERATOR](/windows/desktop/Controls/tb-mapaccelerator), как описано в пакете Windows SDK.

##  <a name="markbutton"></a>  CToolBarCtrl::MarkButton

Задает состояние выделения указанной кнопки в элементе управления панели инструментов.

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*fHighlight*<br/>
Указывает состояние выделения устанавливаемое значение. По умолчанию TRUE. Если задано значение FALSE, кнопки устанавливается в состояние по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_MARKBUTTON](/windows/desktop/Controls/tb-markbutton), как описано в пакете Windows SDK.

##  <a name="movebutton"></a>  CToolBarCtrl::MoveButton

Перемещает кнопки из одного индекса в другую.

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>Параметры

*nOldPos*<br/>
Отсчитываемый от нуля индекс кнопки для перемещения.

*nNewPos*<br/>
Отсчитываемый от нуля индекс назначения кнопки.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_MOVEBUTTON](/windows/desktop/Controls/tb-movebutton), как описано в пакете Windows SDK.

##  <a name="pressbutton"></a>  CToolBarCtrl::PressButton

Нажимает или отпускает указанную кнопку в элементе управления панели инструментов.

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
[in] Идентификатор команды нажатии и отпускании кнопки.

*bPress*<br/>
[in] Значение TRUE, чтобы нажмите указанную кнопку; Значение FALSE, чтобы освободить указанную кнопку. Значение по умолчанию — TRUE.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Если вы хотите изменить несколько состояний кнопки, рассмотрите возможность вызова [SetState](#setstate) вместо этого.

Этот метод отправляет [TB_PRESSBUTTON](/windows/desktop/Controls/tb-pressbutton) сообщения, который описан в пакете Windows SDK.

##  <a name="replacebitmap"></a>  CToolBarCtrl::ReplaceBitmap

Заменяет существующий растрового изображения в текущий элемент управления панели инструментов новое растровое изображение.

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*pReplaceBitmap*|[in] Указатель на [TBREPLACEBITMAP](/windows/desktop/api/commctrl/ns-commctrl-tbreplacebitmap) структура, описывающая точечный рисунок заменяемого и новая Битовая карта.|

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод выполнен успешно; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_REPLACEBITMAP](/windows/desktop/Controls/tb-replacebitmap) сообщения, который описан в пакете Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода заменяет растрового изображения для стандартной панели инструментов разных растрового изображения.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

##  <a name="restorestate"></a>  CToolBarCtrl::RestoreState

Восстанавливает состояние элемента управления панели инструментов из расположения в реестре, указанный параметрами.

```
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Параметры

*hKeyRoot*<br/>
Определяет открытый ключ в реестре или любой из следующих предопределенных зарезервированных дескриптор:

- РАЗДЕЛ HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Указатель на заканчивающуюся нулем строку, содержащую имя подраздела, с которым связано значение. Этот параметр может быть null или указатель на пустую строку. Если параметр имеет значение NULL, значение будет добавляться ключ, обозначенный *hKeyRoot* параметра.

*lpszValueName*<br/>
Указывает строку, содержащую имя извлекаемого значения. Значение с таким именем уже отсутствует в ключе, то функция прибавляет к ключу.

##  <a name="savestate"></a>  CToolBarCtrl::SaveState

Сохраняет состояние элемента панели инструментов в расположение в реестре, указанный параметрами.

```
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>Параметры

*hKeyRoot*<br/>
Определяет открытый ключ в реестре или любой из следующих предопределенных зарезервированных дескриптор:

- РАЗДЕЛ HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
Указатель на заканчивающуюся нулем строку, содержащую имя подраздела, с которым связано значение. Этот параметр может быть null или указатель на пустую строку. Если параметр имеет значение NULL, значение будет добавляться ключ, обозначенный *hKeyRoot* параметра.

*lpszValueName*<br/>
Указывает строку, содержащую имя присваиваемое значение. Значение с таким именем уже отсутствует в ключе, то функция прибавляет к ключу.

##  <a name="setanchorhighlight"></a>  CToolBarCtrl::SetAnchorHighlight

Задает выделение привязки параметра для панели инструментов.

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>Параметры

*fAnchor*<br/>
[in] Указывает, если выделение привязки включен или отключен. Если это значение имеет ненулевое значение, выделение привязка включена. Если это значение равно нулю, выделение привязки к отключении

### <a name="return-value"></a>Возвращаемое значение

Предыдущее значение привязки. Если выделение было включено, это значение не равно нулю. Если выделение не был включен, это значение равно нулю.

### <a name="remarks"></a>Примечания

Этот метод реализует поведение сообщение Win32 [TB_SETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-setanchorhighlight), как описано в пакете Windows SDK.

##  <a name="setbitmapsize"></a>  CToolBarCtrl::SetBitmapSize

Задает размер фактического точечных рисунков, добавляемый в элемент управления toolbar.

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Ширина и высота в пикселях, растровых изображений.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Эту функцию необходимо вызывать только для того, перед добавлением любые точечные рисунки в панели инструментов. Если приложение явно не задавать размер растрового изображения, по умолчанию до 15, 16 пикселей.

##  <a name="setbuttoninfo"></a>  CToolBarCtrl::SetButtonInfo

Задает информацию для существующей кнопки в панели инструментов.

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор кнопки.

*ptbbi*<br/>
Указатель на [TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa) структуру, которая получает сведения о кнопке.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Функция-член реализует поведение сообщение Win32 [TB_SETBUTTONINFO](/windows/desktop/Controls/tb-setbuttoninfo), как описано в пакете Windows SDK.

##  <a name="setbuttonsize"></a>  CToolBarCtrl::SetButtonSize

Задает размер кнопок в панели инструментов.

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Ширина и высота в пикселях, кнопок.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Размер кнопок всегда должен быть по крайней мере размер растрового изображения, он помещает. Эту функцию необходимо вызывать только для того, перед добавлением любые точечные рисунки в панели инструментов. Если приложение явно не задает размер кнопок, по умолчанию до 24 x 22 пикселей.

### <a name="example"></a>Пример

  См. в примере [CToolBar::GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl).

##  <a name="setbuttonstructsize"></a>  CToolBarCtrl::SetButtonStructSize

Указывает размер `TBBUTTON` структуры.

```
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>Параметры

*nSize*<br/>
Размер в байтах, из `TBBUTTON` структуры.

### <a name="remarks"></a>Примечания

Если вы хотите хранить дополнительные данные в `TBBUTTON` структуры, можно либо создать новую структуру из `TBBUTTON`, добавление элементов вы необходимые или создать новую структуру, содержащий `TBBUTTON` структуру, что ее первого элемента. Затем необходимо вызвать эту функцию, чтобы определить размер новой структуры, панели инструментов.

См. в разделе [CToolBarCtrl::AddButtons](#addbuttons) Дополнительные сведения о `TBBUTTON` структуры.

##  <a name="setbuttonwidth"></a>  CToolBarCtrl::SetButtonWidth

Задает кнопки, минимальное и максимальное значения ширины в панели инструментов.

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>Параметры

*cxMin*<br/>
Кнопка Минимальная ширина в пикселях. Кнопки панели инструментов, никогда не будет уже, чем это значение.

*cxMax*<br/>
Максимальное число кнопок ширина в пикселях. Текст кнопки слишком велик, элемент управления отображает с точками кнопку с многоточием.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETBUTTONWIDTH](/windows/desktop/Controls/tb-setbuttonwidth), как описано в пакете Windows SDK.

##  <a name="setcmdid"></a>  CToolBarCtrl::SetCmdID

Задает идентификатор команды, которое будет отправляться окну-владельцу, при нажатии кнопки указанного.

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс кнопки, чей идентификатор команды для задается.

*nID*<br/>
Идентификатор команды, значение выделенной кнопки.

### <a name="return-value"></a>Возвращаемое значение

Возвращает ненулевое значение, если выполнение прошло успешно; в противном случае значение равно нулю.

##  <a name="setcolorscheme"></a>  CToolBarCtrl::SetColorScheme

Задает цветовую схему текущего элемента управления панели инструментов.

```
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*lpColorScheme*|[in] Указатель на [COLORSCHEME](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme) структура, описывающая цвет выделения и цвет тени элемента управления панели инструментов.|

### <a name="remarks"></a>Примечания

Если задано значение тему Windows Vista, этот метод игнорируется.

Этот метод отправляет [TB_SETCOLORSCHEME](/windows/desktop/Controls/tb-setcolorscheme) сообщения, который описан в пакете Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода задает цветовую схему текущего элемента управления панели инструментов. В примере кода делает синий левом и верхнем края кнопки каждый инструмент красный и краями вправо и вниз. Когда пользователь нажимает кнопку, красный края кнопки синим цветом и краям синий красным цветом.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

##  <a name="setdisabledimagelist"></a>  CToolBarCtrl::SetDisabledImageList

Задает список изображений, будет использоваться элементом управления панели инструментов для отображения отключен кнопок.

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*pImageList*<br/>
Указатель на `CImageList` объект, содержащий изображения, используемые элементом управления для отображения неактивных изображения кнопки панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объект, который ранее использовался с элементом управления для отображения неактивных изображения кнопки панели инструментов.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-setdisabledimagelist), как описано в пакете Windows SDK. Реализация MFC `SetDisabledImageList` использует `CImageList` образы объект, содержащий кнопку панели инструментов в отключенном состоянии, а не дескриптор списка изображений.

##  <a name="setdrawtextflags"></a>  CToolBarCtrl::SetDrawTextFlags

Задает флаги в функции Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), который используется для рисования текста в указанном прямоугольнике, отформатированный согласно установке флаги.

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>Параметры

*dwMask*<br/>
Сочетание одного или нескольких флагов DT_, указанные в функции Win32 [DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext), указывающий, что биты *dwDTFlags* будет использоваться при рисовании текста.

*dwDTFlags*<br/>
Сочетание одного или нескольких флагов DT_, указанные в функции Win32 `DrawText`, которые указывают, как будут отображаться на кнопке отображается надпись. Это значение передается `DrawText` рисованием текста кнопки.

### <a name="return-value"></a>Возвращаемое значение

DWORD, содержащее рисования флаги предыдущего текста.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETDRAWTEXTFLAGS](/windows/desktop/Controls/tb-setdrawtextflags), как описано в пакете Windows SDK. Эта функция-член задает флаги в функции Win32 `DrawText`, которая рисует текст в указанном прямоугольнике, отформатированный согласно установке флаги.

##  <a name="setextendedstyle"></a>  CToolBarCtrl::SetExtendedStyle

Задает расширенные стили для элемента управления панели инструментов.

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>Параметры

*dwExStyle*<br/>
Значение, определяющее новые расширенные стили. Этот параметр может представлять собой сочетание расширенные стили панели инструментов.

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, представляющий предыдущий расширенные стили. Список стилей, см. в разделе [расширенные стили панели инструментов](/windows/desktop/Controls/toolbar-extended-styles), в пакете Windows SDK.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETEXTENDEDSTYLE](/windows/desktop/Controls/tb-setextendedstyle), как описано в пакете Windows SDK.

##  <a name="sethotimagelist"></a>  CToolBarCtrl::SetHotImageList

Задает список изображений, панели инструментов будет использоваться для отображения кнопки «горячие».

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*pImageList*<br/>
Указатель на `CImageList` объект, содержащий изображения, которые будут использоваться элементом управления панели инструментов для отображения изображений кнопку в активном состоянии.

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объект, который ранее использовался элементом управления панели инструментов для отображения изображений кнопку в активном состоянии.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETHOTIMAGELIST](/windows/desktop/Controls/tb-sethotimagelist), как описано в пакете Windows SDK.

Реализация MFC `SetHotImageList` использует `CImageList` образы объект, содержащий кнопку панели инструментов в активном состоянии, а не дескриптор списка изображений. Кнопку в активном состоянии выделяется, когда указатель находится над ним.

##  <a name="sethotitem"></a>  CToolBarCtrl::SetHotItem

Задает элемент "Горячий" в панели инструментов.

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>Параметры

*nHot*<br/>
Отсчитываемый от нуля индекс элемента, который станет "Горячий". Если это значение равно -1, ни один из элементов будет "Горячий".

### <a name="return-value"></a>Возвращаемое значение

Индекс предыдущего элемента "Горячий" или -1, если не было "Горячий" элемента.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETHOTITEM](/windows/desktop/Controls/tb-sethotitem), как описано в пакете Windows SDK.

##  <a name="setimagelist"></a>  CToolBarCtrl::SetImageList

Задает список изображений, панели инструментов будет использоваться для отображения кнопок, которые находятся в состоянии по умолчанию.

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

*pImageList*<br/>
Указатель на `CImageList` объект, содержащий изображения, которые будут использоваться элементом управления панели инструментов для отображения изображения кнопки в состоянии по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) объект, который ранее использовался элементом управления панели инструментов для отображения изображения кнопки в состоянии по умолчанию.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETIMAGELIST](/windows/desktop/Controls/tb-setimagelist), как описано в пакете Windows SDK.

Реализация MFC `SetImageList` использует `CImageList` образы объект, содержащий кнопку панели инструментов, вместо того чтобы дескриптор списка изображений.

##  <a name="setindent"></a>  CToolBarCtrl::SetIndent

Задает отступ для первой кнопки в элементе управления панели инструментов.

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>Параметры

*iIndent*<br/>
Значение, указывающее отступа в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

##  <a name="setinsertmark"></a>  CToolBarCtrl::SetInsertMark

Задает текущий знак вставки для панели инструментов.

```
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>Параметры

*ptbim*<br/>
Указатель на [TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark) структуру, содержащую знак вставки.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETINSERTMARK](/windows/desktop/Controls/tb-setinsertmark), как описано в пакете Windows SDK.

##  <a name="setinsertmarkcolor"></a>  CToolBarCtrl::SetInsertMarkColor

Задает цвет, используемый для рисования знак вставки для панели инструментов.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Параметры

*clrNew*<br/>
Значение COLORREF, содержащее новый цвет знака вставки.

### <a name="return-value"></a>Возвращаемое значение

Значение COLORREF, содержащий предыдущий цвет знака вставки.

### <a name="remarks"></a>Примечания

Эта функция-член реализует поведение сообщение Win32 [TB_SETINSERTMARKCOLOR](/windows/desktop/Controls/tb-setinsertmarkcolor), как описано в пакете Windows SDK.

##  <a name="setmaxtextrows"></a>  CToolBarCtrl::SetMaxTextRows

Задает максимальное количество строк текста, отображаемый на кнопке панели инструментов.

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>Параметры

*iMaxRows*<br/>
Максимальное число строк, устанавливаемое значение.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

##  <a name="setmetrics"></a>  CToolBarCtrl::SetMetrics

Задает метрики `CToolBarCtrl` объекта.

```
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>Параметры

*ptbm*<br/>
Указатель на [TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics) структуры `CToolBarCtrl` объекта.

### <a name="remarks"></a>Примечания

Эта функция-член эмулирует функциональные возможности [TB_SETMETRICS](/windows/desktop/Controls/tb-setmetrics) сообщения, как описано в пакете Windows SDK.

##  <a name="setowner"></a>  CToolBarCtrl::SetOwner

Задает владельца окна панели инструментов.

```
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>Параметры

*pWnd*<br/>
Указатель на `CWnd` или `CWnd`-производного объекта, который будет входить новый окну-владельцу панели инструментов.

### <a name="remarks"></a>Примечания

Окно-владелец является окно, которое получает уведомления из панели инструментов.

##  <a name="setpadding"></a>  CToolBarCtrl::SetPadding

Задает величину заполнения горизонтальные и вертикальные текущего элемента управления панели инструментов.

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*nHorzPadding*|[in] Указывает горизонтальное заполнение элемента управления панели инструментов, в пикселях.|
|*nVertPadding*|[in] Задает вертикальный отступ элемента управления панели инструментов, в пикселях.|

### <a name="return-value"></a>Возвращаемое значение

Значение типа DWORD, младшее слово содержит предыдущее значение заполнения по горизонтали, а, старшее слово предыдущее значение вертикальный отступ. Заполнение значения измеряются в пикселях.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_SETPADDING](/windows/desktop/Controls/tb-setpadding) сообщения, который описан в пакете Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода задает величину заполнения горизонтальные и вертикальные текущего элемента управления панели инструментов до 20 пикселей.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

##  <a name="setpressedimagelist"></a>  CToolBarCtrl::SetPressedImageList

Задает список изображений, текущего элемента управления панель инструментов используется для представления кнопки в состоянии нажатия.

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>Параметры

|Параметр|Описание|
|---------------|-----------------|
|*iImageID*|[in] Отсчитываемый от нуля индекс списка изображений. Установите этот параметр равным нулю, если вы используете только один список изображений.|
|*pImageList*|[in] Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий новый список изображений.|

### <a name="return-value"></a>Возвращаемое значение

Указатель на [CImageList](../../mfc/reference/cimagelist-class.md) , содержащий предыдущий список изображений для текущего элемента управления, или значение NULL, если такой список изображений не было задано.

### <a name="remarks"></a>Примечания

Этот метод отправляет [TB_SETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-setpressedimagelist) сообщения, который описан в пакете Windows SDK.

### <a name="example"></a>Пример

В следующем примере кода задает список изображений, нажатия должны совпадать как список изображений по умолчанию.

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

##  <a name="setrows"></a>  CToolBarCtrl::SetRows

Запрашивает, панели инструментов, чтобы изменить размер самого запрашиваемое количество строк.

```
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*nRows*<br/>
Запрашиваемое количество строк.

*bLarger*<br/>
Указывает, следует ли использовать несколько строк или меньше строк, если размер панели инструментов не может быть изменен запрашиваемое количество строк.

*lpRect*<br/>
Указывает на [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или [RECT](/previous-versions/dd162897\(v=vs.85\)) структуры, который получит новый ограничивающий прямоугольник на панели инструментов.

### <a name="remarks"></a>Примечания

Если панель инструментов не может сама изменять размер запрошенного числа или строки, он будет сама изменять размер либо Далее большего размера или Далее меньше допустимого размера; в зависимости от значения *bLarger*. Если *bLarger* имеет значение TRUE, новому числу строк будет больше запрошенного числа. Если *bLarger* имеет значение FALSE, новому числу строк будет меньше запрошенного числа.

Заданное количество строк является допустимым для панели инструментов, если кнопки, которые могут быть упорядочены таким образом, что все строки имеют одинаковый номер кнопок (за исключением может быть последней строки). Например панель инструментов, которая содержит четыре кнопки может не настраиваются в три строки из-за последних двух строк, пришлось бы короче. Если вы пытаетесь сделать его три строки, получаемому четыре строки, если *bLarger* имело значение TRUE и две строки *bLarger* был значение FALSE.

При возникновении разделителей в панели инструментов, когда заданное количество строк является действительным правила выполняется сложнее. Макет является вычисляемым, таким образом, чтобы группы кнопки (кнопки с разделителем перед первым) и последней кнопки в группе никогда не подразделяются на несколько строк, если группы не может поместиться на одной строке.

Если группы не помещается на одной строке, следующей группы запустится в следующей строке, даже если он поместится на строке, где заканчивается большой группы. Это правило предназначена для разделения больших групп более заметным. Итоговый вертикальной разделители, рассматриваются как строки.

Обратите внимание, что `SetRows` функция-член всегда выберу макет, который приводит к наименьший размер панели инструментов. Создание панели инструментов с помощью TBSTYLE_WRAPABLE стиля и затем изменения размеров элемента управления будет просто примените метода, описанного выше прав ширину элемента управления.

Эта функция может вызываться только для панелей инструментов, которые были созданы в стиле TBSTYLE_WRAPABLE.

##  <a name="setstate"></a>  CToolBarCtrl::SetState

Задает состояние для указанной кнопки в элементе управления панели инструментов.

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор команды кнопки.

*nState*<br/>
Флаги состояния. Он может быть сочетания значений, указанных для состояния кнопки в [CToolBarCtrl::AddButtons](#addbuttons).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция особенно полезна в том случае, если вы хотите установить более одного из состояний кнопки. Чтобы просто задать одно состояние, используйте один из следующих функций-членов. [EnableButton](#enablebutton), [CheckButton](#checkbutton), [HideButton](#hidebutton), [неопределенном](#indeterminate), или [PressButton](#pressbutton).

##  <a name="setstyle"></a>  CToolBarCtrl::SetStyle

Задает стили для элемента управления панели инструментов.

```
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>Параметры

*dwStyle*<br/>
DWORD, содержащее сочетание [стили элемента управления панели инструментов](/windows/desktop/Controls/toolbar-control-and-button-styles), как описано в пакете Windows SDK.

##  <a name="settooltips"></a>  CToolBarCtrl::SetToolTips

Связывает элемент управления всплывающей подсказки с элементом управления панели инструментов.

```
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>Параметры

*pTip*<br/>
Указатель на [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) объекта.

##  <a name="setwindowtheme"></a>  CToolBarCtrl::SetWindowTheme

Задает визуальный стиль `CToolBarCtrl` объекта.

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>Параметры

*pszSubAppName*<br/>
Указатель на строку Юникода, которая содержит визуальный стиль панели инструментов для задания.

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение не используется.

### <a name="remarks"></a>Примечания

Эта функция-член эмулирует функциональные возможности [TB_SETWINDOWTHEME](/windows/desktop/Controls/tb-setwindowtheme) сообщения, как описано в пакете Windows SDK.

## <a name="see-also"></a>См. также

[Образец CMNCTRL1 MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример MFC MFCIE](../../overview/visual-cpp-samples.md)<br/>
[Класс CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CToolBar](../../mfc/reference/ctoolbar-class.md)
