---
title: Класс COleClientItem
ms.date: 07/02/2019
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 9f97f117f0fd8570855079aca7bdfd7a63118bc5
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2020
ms.locfileid: "78855561"
---
# <a name="coleclientitem-class"></a>Класс COleClientItem

Определяет контейнерный интерфейс для элементов OLE.

## <a name="syntax"></a>Синтаксис

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Description|
|----------|-----------------|
|[COleClientItem:: COleClientItem](#coleclientitem)|Формирует объект `COleClientItem`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Description|
|----------|-----------------|
|[COleClientItem:: Activate](#activate)|Открывает элемент OLE для операции, а затем выполняет указанную команду.|
|[COleClientItem:: Активатеас](#activateas)|Активирует элемент как другой тип.|
|[COleClientItem:: Аттачдатаобжект](#attachdataobject)|Обращается к данным в объекте OLE.|
|[COleClientItem:: Канкреатефромдата](#cancreatefromdata)|Указывает, может ли приложение-контейнер создать внедренный объект.|
|[COleClientItem:: Канкреателинкфромдата](#cancreatelinkfromdata)|Указывает, может ли приложение-контейнер создать связанный объект.|
|[COleClientItem:: Канпасте](#canpaste)|Указывает, содержит ли буфер обмена внедренный или статичный OLE элемент.|
|[COleClientItem:: Канпастелинк](#canpastelink)|Указывает, содержит ли буфер обмена связываемый OLE-элемент.|
|[COleClientItem:: Close](#close)|Закрывает связь с сервером, но не уничтожает элемент OLE.|
|[COleClientItem:: ConvertTo](#convertto)|Преобразует элемент в другой тип.|
|[COleClientItem:: Копитоклипбоард](#copytoclipboard)|Копирует элемент OLE в буфер обмена.|
|[COleClientItem:: Креатеклонефром](#createclonefrom)|Создает дубликат существующего элемента.|
|[COleClientItem:: Креатефромклипбоард](#createfromclipboard)|Создает внедренный элемент из буфера обмена.|
|[COleClientItem:: Креатефромдата](#createfromdata)|Создает внедренный элемент из объекта данных.|
|[COleClientItem:: CreateFromFile](#createfromfile)|Создает внедренный элемент из файла.|
|[COleClientItem:: Креателинкфромклипбоард](#createlinkfromclipboard)|Создает связанный элемент из буфера обмена.|
|[COleClientItem:: Креателинкфромдата](#createlinkfromdata)|Создает связанный элемент на основе объекта данных.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Создает связанный элемент из файла.|
|[COleClientItem::CreateNewItem](#createnewitem)|Создает новый внедренный элемент путем запуска серверного приложения.|
|[COleClientItem:: Креатестатикфромклипбоард](#createstaticfromclipboard)|Создает статический элемент из буфера обмена.|
|[COleClientItem:: Креатестатикфромдата](#createstaticfromdata)|Создает статический элемент из объекта данных.|
|[COleClientItem::D еактивате](#deactivate)|Деактивирует элемент.|
|[COleClientItem::DeactivateUI](#deactivateui)|Восстанавливает пользовательский интерфейс приложения контейнера в исходном состоянии.|
|[COleClientItem::D удалить](#delete)|Удаляет или закрывает элемент OLE, если он был связанным элементом.|
|[COleClientItem::D Одрагдроп](#dodragdrop)|Выполняет операцию перетаскивания.|
|[COleClientItem::DoVerb](#doverb)|Выполняет указанную команду.|
|[COleClientItem::D RAW](#draw)|Рисует элемент OLE.|
|[COleClientItem:: Жетактивевиев](#getactiveview)|Возвращает представление, в котором элемент активируется на месте.|
|[COleClientItem:: Жеткачедекстент](#getcachedextent)|Возвращает границы прямоугольника объекта OLE.|
|[COleClientItem::, ClassID](#getclassid)|Возвращает идентификатор класса текущего элемента.|
|[COleClientItem:: Жетклипбоарддата](#getclipboarddata)|Возвращает данные, которые будут помещены в буфер обмена путем вызова функции члена `CopyToClipboard`.|
|[COleClientItem:: a Document](#getdocument)|Возвращает объект `COleDocument`, содержащий текущий элемент.|
|[COleClientItem:: Жетдраваспект](#getdrawaspect)|Возвращает текущее представление элемента для отрисовки.|
|[COleClientItem:: расширение](#getextent)|Возвращает границы прямоугольника объекта OLE.|
|[COleClientItem:: Жетиконфромрегистри](#geticonfromregistry)|Извлекает маркер значка, связанного с сервером определенного идентификатора CLSID.|
|[COleClientItem:: Жетиконикметафиле](#geticonicmetafile)|Возвращает метафайл, используемый для рисования значка элемента.|
|[COleClientItem:: Жетинплацевиндов](#getinplacewindow)|Возвращает указатель на окно редактирования на месте элемента.|
|[COleClientItem:: Жетитемстате](#getitemstate)|Возвращает текущее состояние элемента.|
|[COleClientItem:: Жетластстатус](#getlaststatus)|Возвращает состояние последней операции OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Возвращает режим обновления для связанного элемента (дополнительная функция).|
|[COleClientItem:: GetType](#gettype)|Возвращает тип (внедренный, связанный или статический) элемента OLE.|
|[COleClientItem:: Жетусертипе](#getusertype)|Возвращает строку, описывающую тип элемента.|
|[COleClientItem:: Исинплацеактиве](#isinplaceactive)|Возвращает значение TRUE, если элемент находится в активном месте.|
|[COleClientItem:: Ислинкуптодате](#islinkuptodate)|Возвращает значение TRUE, если связанный элемент находится в актуальном состоянии с исходным документом.|
|[COleClientItem::IsModified](#ismodified)|Возвращает значение TRUE, если элемент был изменен с момента последнего сохранения.|
|[COleClientItem:: OnOpen](#isopen)|Возвращает значение TRUE, если элемент в данный момент открыт в серверном приложении.|
|[COleClientItem:: выполнение](#isrunning)|Возвращает значение TRUE, если серверное приложение элемента выполняется.|
|[COleClientItem:: OnActivate](#onactivate)|Вызывается платформой для уведомления об активации элемента.|
|[COleClientItem:: Онактиватеуи](#onactivateui)|Вызывается платформой для уведомления элемента о том, что он активирован и должен отображать пользовательский интерфейс.|
|[COleClientItem:: OnChange](#onchange)|Вызывается, когда сервер изменяет элемент OLE. Требуется реализация.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Вызывается структурой при деактивации элемента.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Вызывается платформой при удалении сервером пользовательского интерфейса на месте.|
|[COleClientItem:: Онжетклипбоарддата](#ongetclipboarddata)|Вызвано структурой для получения данных, которые должны быть скопированы в буфер обмена.|
|[COleClientItem:: Онинсертменус](#oninsertmenus)|Вызывается платформой для создания составного меню.|
|[COleClientItem:: Онремовеменус](#onremovemenus)|Вызвано платформой для удаления меню контейнера из составного меню.|
|[COleClientItem:: Онсетмену](#onsetmenu)|Вызывается платформой для установки и удаления составного меню.|
|[COleClientItem:: Оншовконтролбарс](#onshowcontrolbars)|Вызывается платформой для отображения и скрытия панелей элементов управления.|
|[COleClientItem:: Онупдатефраметитле](#onupdateframetitle)|Вызывается платформой для обновления заголовка окна фрейма.|
|[COleClientItem:: Реактиватеандундо](#reactivateandundo)|Повторно активирует элемент и отменяет последнюю операцию редактирования на месте.|
|[COleClientItem:: Release](#release)|Освобождает подключение к связанному элементу OLE и закрывает его, если он был открыт. Не уничтожает клиентский элемент.|
|[COleClientItem:: перезагрузить](#reload)|Перезагружает элемент после вызова метода `ActivateAs`.|
|[COleClientItem:: Run](#run)|Запускает приложение, связанное с элементом.|
|[COleClientItem:: Сетдраваспект](#setdrawaspect)|Задает текущее представление элемента для подготовки к просмотру.|
|[COleClientItem:: Сетекстент](#setextent)|Задает ограничивающий прямоугольник элемента OLE.|
|[COleClientItem:: Сесостнамес](#sethostnames)|Задает имена, отображаемые сервером при изменении элемента OLE.|
|[COleClientItem:: Сетиконикметафиле](#seticonicmetafile)|Кэширует метафайл, используемый для рисования значка элемента.|
|[COleClientItem:: SetItemRects](#setitemrects)|Задает ограничивающий прямоугольник элемента.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Задает режим обновления для связанного элемента (дополнительная функция).|
|[COleClientItem:: Сетпринтдевице](#setprintdevice)|Задает целевое устройство печати для этого элемента клиента.|
|[COleClientItem:: Упдателинк](#updatelink)|Обновляет кэш представления элемента.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Description|
|----------|-----------------|
|[COleClientItem:: Канактивате](#canactivate)|Вызывается платформой для определения, разрешена ли активация на месте.|
|[COleClientItem:: OnChangeItemPosition](#onchangeitemposition)|Вызывается структурой при изменении позиции элемента.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Вызывается платформой для отмены после активации.|
|[COleClientItem:: Ондискардундостате](#ondiscardundostate)|Вызывается платформой для удаления сведений о состоянии отмены элемента.|
|[COleClientItem:: Онжетклипрект](#ongetcliprect)|Вызывается платформой для получения координат прямоугольника обрезки.|
|[COleClientItem:: OnGetItemPosition](#ongetitemposition)|Вызвано структурой для получения позиции элемента относительно представления.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Вызывается платформой, когда элемент активируется на месте.|
|[COleClientItem:: Онскроллби](#onscrollby)|Вызвано структурой для прокрутки элемента на представление.|
|[COleClientItem:: Оншовитем](#onshowitem)|Вызывается платформой для вывода элемента OLE.|

## <a name="remarks"></a>Remarks

Элемент OLE представляет данные, которые создаются и обслуживаются серверным приложением, которое можно легко встроить в документ, чтобы пользователь мог стать отдельным документом. Результатом является «составной документ», состоящий из элемента OLE и содержащего его документа.

Элемент OLE может быть либо внедренным, либо связанным. Если он внедрен, его данные хранятся как часть составного документа. Если он связан, его данные хранятся как часть отдельного файла, созданного серверным приложением, а в составном документе сохраняется только ссылка на этот файл. Все элементы OLE содержат сведения, указывающие серверное приложение, которое должно быть вызвано для их редактирования.

`COleClientItem` определяет несколько переопределяемых функций, которые вызываются в ответ на запросы от серверного приложения; Эти оверридаблес обычно действуют как уведомления. Это позволяет серверному приложению уведомлять контейнер изменений, вносимых пользователем при редактировании элемента OLE, или извлекать сведения, необходимые во время редактирования.

`COleClientItem` можно использовать с классом [коледокумент](../../mfc/reference/coledocument-class.md), [колелинкингдок](../../mfc/reference/colelinkingdoc-class.md)или [колесервердок](../../mfc/reference/coleserverdoc-class.md) . Чтобы использовать `COleClientItem`, создайте производный от него класс и реализуйте функцию-член [onChange](#onchange) , которая определяет, как контейнер реагирует на изменения, вносимые в элемент. Для поддержки активации на месте переопределите функцию-член [OnGetItemPosition](#ongetitemposition) . Эта функция предоставляет сведения об отображаемой позиции объекта OLE.

Дополнительные сведения об использовании интерфейса контейнера см. в статье [контейнеры статей: Реализация контейнера](../../mfc/containers-implementing-a-container.md) и [Активация](../../mfc/activation-cpp.md).

> [!NOTE]
>  Windows SDK ссылается на внедренные и связанные элементы как "объекты" и относится к типам элементов как "классы". Эта ссылка использует термин "элемент", чтобы отличить сущность OLE от соответствующего C++ объекта и термин "тип", чтобы ОТЛИЧАТЬ категорию OLE от C++ класса.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[кдоЦитем](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Требования

**Заголовок:** афксоле. h

##  <a name="activate"></a>COleClientItem:: Activate

Вызовите эту функцию, чтобы выполнить указанную команду вместо [доверб](#doverb) , чтобы можно было выполнять собственную обработку при возникновении исключения.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*нверб*<br/>
Задает выполняемую команду. Может принимать одно из следующих значений:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичная команда|(нет)|
|- 1|Отображаемый элемент для редактирования|OLEIVERB_SHOW|
|- 2|Изменить элемент в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрыть элемент|OLEIVERB_HIDE|

Значение-1 обычно является псевдонимом для другой команды. Если открытая Правка не поддерживается,-2 имеет тот же результат, что и-1. Дополнительные значения см. в разделе [иолеобжект::D оверб](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) в Windows SDK.

*pView*<br/>
Указатель на окно представления контейнера, содержащее элемент OLE; Это используется серверным приложением для активации на месте. Этот параметр должен иметь значение NULL, если контейнер не поддерживает активацию на месте.

*лпмсг*<br/>
Указатель на сообщение, вызвавшее активацию элемента.

### <a name="remarks"></a>Remarks

Если серверное приложение было написано с помощью библиотека Microsoft Foundation Class, эта функция приводит к выполнению функции члена [ондоверб](../../mfc/reference/coleserveritem-class.md#ondoverb) соответствующего объекта `COleServerItem`.

Если первичная команда является редактируемой и в параметре *нверб* задано значение 0, то серверное приложение запускается, чтобы разрешить редактирование элемента OLE. Если приложение-контейнер поддерживает активацию на месте, то редактирование можно выполнить на месте. Если контейнер не поддерживает активацию на месте (или если указана команда Open), то сервер запускается в отдельном окне, и редактирование может быть сделано. Как правило, когда пользователь приложения-контейнера дважды щелкает элемент OLE, значение первичной команды в параметре *нверб* определяет, какое действие может предпринять пользователь. Однако если сервер поддерживает только одно действие, он принимает это действие независимо от того, какое значение указано в параметре *нверб* .

Дополнительные сведения см. в разделе [иолеобжект::D оверб](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) в Windows SDK.

##  <a name="activateas"></a>COleClientItem:: Активатеас

Использует средства преобразования объектов OLE для активации элемента, как будто это элемент типа, заданного параметром *клсиднев*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*лпсзусертипе*<br/>
Указатель на строку, представляющую целевой тип пользователя, например "документ Word".

*клсидолд*<br/>
Ссылка на текущий идентификатор класса элемента. Идентификатор класса должен представлять тип фактического объекта, как сохраненный, если только он не является ссылкой. В этом случае это должен быть идентификатор CLSID элемента, к которому относится ссылка. [Колеконвертдиалог](../../mfc/reference/coleconvertdialog-class.md) автоматически предоставляет правильный идентификатор класса для элемента.

*клсиднев*<br/>
Ссылка на идентификатор целевого класса.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Это автоматически вызывается [колеконвертдиалог::D оконверт](../../mfc/reference/coleconvertdialog-class.md#doconvert). Обычно он не вызывается напрямую.

##  <a name="attachdataobject"></a>COleClientItem:: Аттачдатаобжект

Эта функция вызывается для инициализации [коледатаобжект](../../mfc/reference/coledataobject-class.md) для доступа к данным в OLE-элементе.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Параметры

*рдатаобжект*<br/>
Ссылка на объект `COleDataObject`, который будет инициализирован для разрешения доступа к данным в OLE-элементе.

##  <a name="canactivate"></a>COleClientItem:: Канактивате

Вызывается платформой, когда пользователь запрашивает встроенную активацию OLE-элемента; Возвращаемое значение этой функции определяет, разрешена ли активация на месте.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если активация по месту разрешена; в противном случае — 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию обеспечивает активацию на месте, если контейнер имеет допустимое окно. Переопределите эту функцию, чтобы реализовать специальную логику для принятия или отказа в запросе на активацию. Например, запрос на активацию может быть отклонен, если элемент OLE слишком мал или не виден в данный момент.

Дополнительные сведения см. в разделе [иолеинплацесите:: канинплацеактивате](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) в Windows SDK.

##  <a name="cancreatefromdata"></a>COleClientItem:: Канкреатефромдата

Проверяет, может ли приложение-контейнер создать внедренный объект из заданного `COleDataObject` объекта.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [коледатаобжект](../../mfc/reference/coledataobject-class.md) , из которого будет создан OLE-элемент.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер может создать внедренный объект из объекта `COleDataObject`; в противном случае — 0.

### <a name="remarks"></a>Remarks

Класс `COleDataObject` используется при передаче данных для получения данных в различных форматах из буфера обмена с помощью перетаскивания или из внедренного элемента OLE.

Контейнеры могут использовать эту функцию для включения или отключения своих специальных команд "Правка вставки и Правка".

Дополнительные сведения см. в статьях [объекты данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>COleClientItem:: Канкреателинкфромдата

Проверяет, может ли приложение-контейнер создать связанный объект из заданного `COleDataObject` объекта.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [коледатаобжект](../../mfc/reference/coledataobject-class.md) , из которого будет создан OLE-элемент.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер может создать связанный объект из объекта `COleDataObject`.

### <a name="remarks"></a>Remarks

Класс `COleDataObject` используется при передаче данных для получения данных в различных форматах из буфера обмена с помощью перетаскивания или из внедренного элемента OLE.

Контейнеры могут использовать эту функцию, чтобы решить, включать или отключать команды "изменить Специальная вставка" и "изменить ссылку".

Дополнительные сведения см. в статьях [объекты данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>COleClientItem:: Канпасте

Вызовите эту функцию, чтобы определить, можно ли вставлять внедренный объект OLE из буфера обмена.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если внедренный OLE элемент можно вставлять из буфера обмена. в противном случае — 0.

### <a name="remarks"></a>Remarks

Дополнительные сведения см. в разделе [олежетклипбоард](/windows/win32/api/ole2/nf-ole2-olegetclipboard) и [олекуерикреатефромдата](/windows/win32/api/ole2/nf-ole2-olequerycreatefromdata) в Windows SDK.

##  <a name="canpastelink"></a>COleClientItem:: Канпастелинк

Вызовите эту функцию, чтобы определить, можно ли вставлять связанный OLE-элемент из буфера обмена.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если связанный OLE-элемент можно вставлять из буфера обмена. в противном случае — 0.

### <a name="remarks"></a>Remarks

Дополнительные сведения см. в разделе [олежетклипбоард](/windows/win32/api/ole2/nf-ole2-olegetclipboard) и [олекуерилинкфромдата](/windows/win32/api/ole2/nf-ole2-olequerylinkfromdata) в Windows SDK.

##  <a name="close"></a>COleClientItem:: Close

Вызывайте эту функцию, чтобы изменить состояние объекта OLE с "выполняется" на "загруженное", т. е. загружается вместе с обработчиком в памяти, но при этом сервер не работает.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Параметры

*двклосеоптион*<br/>
Флаг, указывающий, при каких обстоятельствах объект OLE сохраняется при возвращении в состояние загруженности. Он может иметь одно из следующих значений:

- OLECLOSE_SAVEIFDIRTY сохранить элемент OLE.

- OLECLOSE_NOSAVE не сохранять элемент OLE.

- OLECLOSE_PROMPTSAVE предложить пользователю, следует ли сохранить элемент OLE.

### <a name="remarks"></a>Remarks

Эта функция не действует, если элемент OLE не работает.

Дополнительные сведения см. в разделе [иолеобжект:: Close](/windows/win32/api/oleidl/nf-oleidl-ioleobject-close) в Windows SDK.

##  <a name="coleclientitem"></a>COleClientItem:: COleClientItem

Создает объект `COleClientItem` и добавляет его в коллекцию элементов документа контейнера, которая создает только C++ объект и не выполняет инициализацию OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Параметры

*пконтаинердок*<br/>
Указатель на документ контейнера, который будет содержать этот элемент. Это может быть любой производный [коледокумент](../../mfc/reference/coledocument-class.md) .

### <a name="remarks"></a>Remarks

Если передается пустой указатель, добавление в документ контейнера не выполняется. Необходимо явно вызвать [коледокумент:: AddItem](../../mfc/reference/coledocument-class.md#additem).

Перед использованием элемента OLE необходимо вызвать одну из следующих функций элемента создания:

- [креатефромклипбоард](#createfromclipboard)

- [креатефромдата](#createfromdata)

- [CreateFromFile](#createfromfile)

- [креатестатикфромклипбоард](#createstaticfromclipboard)

- [креатестатикфромдата](#createstaticfromdata)

- [креателинкфромклипбоард](#createlinkfromclipboard)

- [креателинкфромдата](#createlinkfromdata)

- [креателинкфромфиле](#createlinkfromfile)

- [креатеневитем](#createnewitem)

- [креатеклонефром](#createclonefrom)

##  <a name="convertto"></a>COleClientItem:: ConvertTo

Вызовите эту функцию члена, чтобы преобразовать элемент в тип, заданный параметром *клсиднев*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*клсиднев*<br/>
Идентификатор класса целевого типа.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Это автоматически вызывается [колеконвертдиалог](../../mfc/reference/coleconvertdialog-class.md). Необязательно вызывать его напрямую.

##  <a name="copytoclipboard"></a>COleClientItem:: Копитоклипбоард

Вызовите эту функцию, чтобы скопировать элемент OLE в буфер обмена.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Параметры

*бинклуделинк*<br/>
Значение TRUE, если сведения о ссылке должны быть скопированы в буфер обмена, что позволяет вставлять связанные элементы. в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Как правило, эта функция вызывается при записи обработчиков сообщений для команд копирования или вырезания из меню Правка. Необходимо реализовать выбор элементов в приложении контейнера, если требуется реализовать команды копирования или вырезания.

Дополнительные сведения см. в разделе [олесетклипбоард](/windows/win32/api/ole2/nf-ole2-olesetclipboard) в Windows SDK.

##  <a name="createclonefrom"></a>COleClientItem:: Креатеклонефром

Вызовите эту функцию, чтобы создать копию указанного объекта OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Параметры

*псрЦитем*<br/>
Указатель на объект OLE для дублирования.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Копия идентична исходному элементу. Эту функцию можно использовать для поддержки операций отмены.

##  <a name="createfromclipboard"></a>COleClientItem:: Креатефромклипбоард

Вызовите эту функцию, чтобы создать внедренный элемент из содержимого буфера обмена.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Обычно эта функция вызывается из обработчика сообщений для команды вставить в меню Правка. (Команда вставки включается платформой, если функция-член [канпасте](#canpaste) возвращает ненулевое значение.)

Дополнительные сведения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createfromdata"></a>COleClientItem:: Креатефромдата

Вызовите эту функцию, чтобы создать внедренный элемент из объекта `COleDataObject`.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [коледатаобжект](../../mfc/reference/coledataobject-class.md) , из которого будет создан OLE-элемент.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Операции передачи данных, такие как копирование из буфера обмена или операции перетаскивания, предоставляют `COleDataObject` объекты, содержащие сведения, предоставляемые серверным приложением. Обычно он используется в переопределении [CView:: OnDrop](../../mfc/reference/cview-class.md#ondrop).

Дополнительные сведения см. в разделе [олекреатефромдата](/windows/win32/api/ole2/nf-ole2-olecreatefromdata), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createfromfile"></a>COleClientItem:: CreateFromFile

Вызовите эту функцию, чтобы создать внедренный элемент OLE из файла.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзфиленаме*<br/>
Указатель на имя файла, из которого будет создан OLE-элемент.

*этому*<br/>
Зарезервировано для последующего использования.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Платформа вызывает эту функцию из [колеинсертдиалог:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) , если пользователь нажимает кнопку ОК в диалоговом окне «Вставка объекта» при выборе кнопки Создать из файла.

Дополнительные сведения см. в разделе [олекреатефромфиле](/windows/win32/api/ole/nf-ole-olecreatefromfile), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createlinkfromclipboard"></a>COleClientItem:: Креателинкфромклипбоард

Вызовите эту функцию, чтобы создать связанный элемент из содержимого буфера обмена.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Обычно эта функция вызывается из обработчика сообщений для команды вставить ссылку в меню Правка. (Команда Вставить ссылку включена в реализации [коледокумент](../../mfc/reference/coledocument-class.md) по умолчанию, если в буфере обмена СОДЕРЖИТСЯ элемент OLE, с которым может быть связан.)

Дополнительные сведения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createlinkfromdata"></a>COleClientItem:: Креателинкфромдата

Вызовите эту функцию, чтобы создать связанный элемент из объекта `COleDataObject`.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [коледатаобжект](../../mfc/reference/coledataobject-class.md) , из которого будет создан OLE-элемент.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Этот метод вызывается во время операции удаления, когда пользователь указывает на необходимость создания ссылки. Его также можно использовать для работы с командой Edit вставки. Он вызывается платформой в `COleClientItem::CreateLinkFromClipboard` и в [колепастеспеЦиалдиалог:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) , если выбран параметр Link.

Дополнительные сведения см. в разделе [олекреателинкфромдата](/windows/win32/api/ole2/nf-ole2-olecreatelinkfromdata), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createlinkfromfile"></a>COleClientItem:: Креателинкфромфиле

Вызовите эту функцию, чтобы создать связанный элемент OLE из файла.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзфиленаме*<br/>
Указатель на имя файла, из которого будет создан OLE-элемент.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Платформа вызывает эту функцию, если пользователь нажимает кнопку ОК в диалоговом окне Вставка объекта, когда выбрана кнопка Создать из файла и установлен флажок связь. Он вызывается из [колеинсертдиалог:: CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Дополнительные сведения см. в разделе [олекреателинктофиле](/windows/win32/api/ole2/nf-ole2-olecreatelinktofile), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createnewitem"></a>COleClientItem:: Креатеневитем

Вызовите эту функцию, чтобы создать внедренный элемент. Эта функция запускает серверное приложение, позволяющее пользователю создать элемент OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*этому*<br/>
Идентификатор, который однозначно определяет тип создаваемого объекта OLE.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Платформа вызывает эту функцию, если пользователь нажимает кнопку ОК в диалоговом окне Вставка объекта при выборе кнопки Создать новую.

Дополнительные сведения см. в разделе [олекреате](/windows/win32/api/ole/nf-ole-olecreate), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createstaticfromclipboard"></a>COleClientItem:: Креатестатикфромклипбоард

Вызовите эту функцию, чтобы создать статический элемент из содержимого буфера обмена.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Статический элемент содержит данные презентации, но не собственные данные. Следовательно, ее нельзя изменить. Обычно эта функция вызывается при сбое функции члена [креатефромклипбоард](#createfromclipboard) .

Дополнительные сведения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="createstaticfromdata"></a>COleClientItem:: Креатестатикфромдата

Вызовите эту функцию, чтобы создать статический элемент из объекта `COleDataObject`.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на объект [коледатаобжект](../../mfc/reference/coledataobject-class.md) , из которого будет создан OLE-элемент.

*обрабатывает*<br/>
Флаг, указывающий, как сервер будет визуализировать элемент OLE. Возможные значения см. в разделе [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender) в Windows SDK.

*кфформат*<br/>
Указывает формат данных буфера обмена для кэширования при создании элемента OLE.

*лпформатетк*<br/>
Указатель на структуру [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) , используемую, если *Render* имеет OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра, только если требуется указать дополнительные сведения о форматировании после формата буфера обмена, заданного параметром *кфформат*. Если этот параметр не задан, для других полей в структуре `FORMATETC` используются значения по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Статический элемент содержит данные презентации, но не собственные данные. Следовательно, его нельзя изменить. По сути, это то же самое, что [креатестатикфромклипбоард](#createstaticfromclipboard) , за исключением того, что статический элемент можно создать из произвольного `COleDataObject`, а не только из буфера обмена.

Используется в [колепастеспеЦиалдиалог:: CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) при выборе Static.

Дополнительные сведения см. в разделе [олекреатестатикфромдата](/windows/win32/api/ole2/nf-ole2-olecreatestaticfromdata), [олерендер](/windows/win32/api/oleidl/ne-oleidl-olerender)и [форматетк](/windows/win32/api/objidl/ns-objidl-formatetc) в Windows SDK.

##  <a name="deactivate"></a>COleClientItem::D еактивате

Вызовите эту функцию, чтобы отключить элемент OLE и освободить все связанные с ним ресурсы.

```
void Deactivate();
```

### <a name="remarks"></a>Remarks

Обычно неактивен активный элемент OLE на месте, когда пользователь щелкает мышью в клиентской области вне границ элемента. Обратите внимание, что деактивация объекта OLE приведет к удалению его состояния отмены, что сделает невозможным вызов функции члена [реактиватеандундо](#reactivateandundo) .

Если приложение поддерживает операцию отмены, не вызывайте `Deactivate`; Вместо этого вызовите [деактиватеуи](#deactivateui).

Дополнительные сведения см. в разделе [иолеинплацеобжект:: инплацедеактивате](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в Windows SDK.

##  <a name="deactivateui"></a>COleClientItem::D Еактиватеуи

Вызывайте эту функцию, когда пользователь отключает элемент, который был активирован на месте.

```
void DeactivateUI();
```

### <a name="remarks"></a>Remarks

Эта функция восстанавливает пользовательский интерфейс приложения-контейнера в исходное состояние, скрывая все меню и другие элементы управления, созданные для активации на месте.

Эта функция не очищает сведения о состоянии отмены для элемента. Эта информация сохраняется, чтобы [реактиватеандундо](#reactivateandundo) можно было использовать для выполнения команды undo в серверном приложении, если команда отмены в контейнере выбрана сразу после деактивации элемента.

Дополнительные сведения см. в разделе [иолеинплацеобжект:: инплацедеактивате](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в Windows SDK.

##  <a name="delete"></a>COleClientItem::D удалить

Вызовите эту функцию, чтобы удалить элемент OLE из документа контейнера.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Параметры

*баутоделете*<br/>
Указывает, должен ли элемент быть удален из документа.

### <a name="remarks"></a>Remarks

Эта функция вызывает функцию члена [выпуска](#release) , которая, в свою очередь, C++ удаляет объект для элемента, окончательно удаляя элемент OLE из документа. Если элемент OLE является внедренным, то исходные данные для этого элемента удаляются. Он всегда закрывает выполняющийся сервер; Таким образом, если элемент является открытой ссылкой, эта функция закрывает ее.

##  <a name="dodragdrop"></a>COleClientItem::D Одрагдроп

Вызовите функцию-член `DoDragDrop`, чтобы выполнить операцию перетаскивания.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Параметры

*лпитемрект*<br/>
Прямоугольник элемента на экране в координатах клиента (в пикселях).

*птоффсет*<br/>
Смещение от *лпитемрект* , где позиция мыши находилась в момент перетаскивания.

*бинклуделинк*<br/>
Установите значение TRUE, если данные ссылки должны быть скопированы в буфер обмена. Задайте значение FALSE, если серверное приложение не поддерживает ссылки.

*двеффектс*<br/>
Определяет, какие эффекты будет разрешено источником перетаскивания в операции перетаскивания.

*лпректстартдраг*<br/>
Указатель на прямоугольник, который определяет, где фактически начинается перетаскивание. Дополнительные сведения см. в разделе "Примечания".

### <a name="return-value"></a>Возвращаемое значение

Значение ДРОПЕФФЕКТ. Если это DROPEFFECT_MOVE, исходные данные должны быть удалены.

### <a name="remarks"></a>Remarks

Операция перетаскивания не запускается немедленно. Он ждет, пока курсор мыши не покидает прямоугольник, заданный параметром *лпректстартдраг* , или до тех пор, пока не пройдет указанное число миллисекунд. Если *лпректстартдраг* имеет значение null, размер прямоугольника равен одному пикселю.

Время задержки задается параметром раздела реестра. Время задержки можно изменить, вызвав [CWinApp:: вритепрофилестринг](../../mfc/reference/cwinapp-class.md#writeprofilestring) или [CWinApp:: вритепрофилеинт](../../mfc/reference/cwinapp-class.md#writeprofileint). Если не указать время задержки, используется значение по умолчанию 200 миллисекунд. Время задержки перетаскивания сохраняется следующим образом:

- Время задержки перетаскивания Windows NT хранится в HKEY_LOCAL_MACHINE \Софтваре\микрософт\виндовс\нт\куррентверсион\инифилемаппинг\вин.ини\виндовс\драгделай.

- Время задержки перетаскивания Windows 3. x сохраняется в ВЫИГРЫШе. INI-файл в разделе [Windows}.

- Время задержки перетаскивания Windows 95/98 хранится в кэшированной версии WIN. Ссылки.

Дополнительные сведения о том, как данные задержки перетаскивания хранятся в реестре или в. INI-файла см. в разделе [вритепрофилестринг](/windows/win32/api/winbase/nf-winbase-writeprofilestringw) в Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Вызовите `DoVerb`, чтобы выполнить указанную команду.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*нверб*<br/>
Задает выполняемую команду. Он может включать один из следующих элементов:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичная команда|(нет)|
|- 1|Отображаемый элемент для редактирования|OLEIVERB_SHOW|
|- 2|Изменить элемент в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрыть элемент|OLEIVERB_HIDE|

Значение-1 обычно является псевдонимом для другой команды. Если открытая Правка не поддерживается,-2 имеет тот же результат, что и-1. Дополнительные значения см. в разделе [иолеобжект::D оверб](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) в Windows SDK.

*pView*<br/>
Указатель на окно представления; Это используется сервером для активации на месте. Если приложение-контейнер не поддерживает активацию на месте, этот параметр должен иметь значение NULL.

*лпмсг*<br/>
Указатель на сообщение, вызвавшее активацию элемента.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если команда успешно выполнена; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция вызывает функцию члена [активации](#activate) для выполнения команды. Он также перехватывает исключения и отображает окно сообщения пользователю, если оно возникает.

Если первичная команда является редактируемой и в параметре *нверб* задано значение 0, то серверное приложение запускается, чтобы разрешить редактирование элемента OLE. Если приложение-контейнер поддерживает активацию на месте, то редактирование можно выполнить на месте. Если контейнер не поддерживает активацию на месте (или если указана команда Open), то сервер запускается в отдельном окне, и редактирование может быть сделано. Как правило, когда пользователь приложения-контейнера дважды щелкает элемент OLE, значение первичной команды в параметре *нверб* определяет, какое действие может предпринять пользователь. Однако если сервер поддерживает только одно действие, он принимает это действие независимо от того, какое значение указано в параметре *нверб* .

##  <a name="draw"></a>COleClientItem::D RAW

Вызовите эту функцию, чтобы нарисовать элемент OLE в заданном ограничивающем прямоугольнике, используя указанный контекст устройства.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на объект [CDC](../../mfc/reference/cdc-class.md) , используемый для рисования элемента OLE.

*лпбаундс*<br/>
Указатель на объект [крект](../../atl-mfc-shared/reference/crect-class.md) или структуру `RECT`, определяющую ограничивающий прямоугольник, в котором будет НАРИСОВАН элемент OLE (в логических устройствах, определенных контекстом устройства).

*ндраваспект*<br/>
Задает аспект объекта OLE, то есть способ его отображения. Если *ндраваспект* имеет значение-1, то используется последний набор аспектов с использованием [сетдраваспект](#setdrawaspect) . Дополнительные сведения о возможных значениях этого флага см. в разделе [сетдраваспект](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Функция может использовать представление метафайла OLE элемента, созданного функцией члена [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) `COleServerItem`.

Обычно для отображения экрана используется `Draw`, передающий контекст устройства экрана в качестве *основного контроллера домена*. В этом случае необходимо указать только первые два параметра.

Параметр *лпбаундс* определяет прямоугольник в контексте целевого устройства (относительно текущего режима сопоставления). Отрисовка может содержать масштабирование изображения и может использоваться приложениями-контейнерами для создания представления, которое масштабируется между отображаемым представлением и окончательным печатным изображением.

Дополнительные сведения см. в разделе [ивиевобжект::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw) в Windows SDK.

##  <a name="getactiveview"></a>COleClientItem:: Жетактивевиев

Возвращает представление, в котором элемент активирован на месте.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на представление; значение NULL, если элемент не активирован на месте.

##  <a name="getcachedextent"></a>COleClientItem:: Жеткачедекстент

Вызовите эту функцию, чтобы получить размер объекта OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*лпсизе*<br/>
Указатель на `SIZE` структуру или объект [ксизе](../../atl-mfc-shared/reference/csize-class.md) , который получит сведения о размере.

*ндраваспект*<br/>
Задает аспект объекта OLE, границы которого должны быть извлечены. Возможные значения см. в разделе [сетдраваспект](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; 0, если объект OLE пуст.

### <a name="remarks"></a>Remarks

Эта функция предоставляет те же сведения, что и [расширение](#getextent). Однако можно вызвать `GetCachedExtent`, чтобы получить сведения о экстентах во время обработки других обработчиков OLE, например [onChange](#onchange). Измерения находятся в единицах MM_HIMETRIC.

Это возможно, поскольку `GetCachedExtent` использует интерфейс [IViewObject2](/windows/win32/api/oleidl/nn-oleidl-iviewobject2) вместо использования интерфейса [иолеобжект](/windows/win32/api/oleidl/nn-oleidl-ioleobject) для получения экстента этого элемента. `IViewObject2` COM-объект кэширует сведения о экстенте, используемые в предыдущем вызове метода [ивиевобжект::D RAW](/windows/win32/api/oleidl/nf-oleidl-iviewobject-draw).

Дополнительные сведения см. в разделе [IViewObject2:: "расширение](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) " в Windows SDK.

##  <a name="getclassid"></a>COleClientItem::, ClassID

Возвращает идентификатор класса элемента в память, на которую указывает *pClassId равен*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Параметры

*pClassId равен*<br/>
Указатель на идентификатор типа [CLSID](/windows/win32/com/clsid-key-hklm) для получения идентификатора класса. Дополнительные сведения об CLSID см. в Windows SDK.

### <a name="remarks"></a>Remarks

Идентификатор класса — это 128-разрядное число, уникально идентифицирующее приложение, которое редактирует элемент.

Дополнительные сведения см. в разделе [IPersist:: "ClassID](/windows/win32/api/objidl/nf-objidl-ipersist-getclassid) " в Windows SDK.

##  <a name="getclipboarddata"></a>COleClientItem:: Жетклипбоарддата

Вызовите эту функцию, чтобы получить объект `COleDataSource`, содержащий все данные, которые будут помещены в буфер обмена с помощью вызова функции-члена [копитоклипбоард](#copytoclipboard) .

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Параметры

*пдатасаурце*<br/>
Указатель на объект [COleDataSource](../../mfc/reference/coledatasource-class.md) , который будет принимать данные, содержащиеся в OLE-элементе.

*бинклуделинк*<br/>
Значение TRUE, если необходимо добавить данные ссылки; в противном случае — FALSE.

*лпоффсет*<br/>
Смещение курсора мыши от начала объекта в пикселях.

*лпсизе*<br/>
Размер объекта в пикселях.

### <a name="remarks"></a>Remarks

`GetClipboardData` вызывается как реализация [онжетклипбоарддата](#ongetclipboarddata)по умолчанию. Переопределяйте `OnGetClipboardData` только в том случае, если требуется предлагать форматы данных в дополнение к предложениям, предлагаемым `CopyToClipboard`. Поместите эти форматы в объект `COleDataSource` до или после вызова `CopyToClipboard`, а затем передайте объект `COleDataSource` в функцию [COleDataSource:: сетклипбоард](../../mfc/reference/coledatasource-class.md#setclipboard) . Например, если нужно, чтобы позиция элемента OLE в документе контейнера была размещена в буфере обмена, необходимо определить собственный формат для передачи этой информации и поместить его в `COleDataSource` перед вызовом `CopyToClipboard`.

##  <a name="getdocument"></a>COleClientItem:: a Document

Вызовите эту функцию, чтобы получить указатель на документ, содержащий элемент OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на документ, содержащий элемент OLE. Значение NULL, если элемент не является частью документа.

### <a name="remarks"></a>Remarks

Этот указатель разрешает доступ к объекту `COleDocument`, переданному в качестве аргумента в конструктор `COleClientItem`.

##  <a name="getdrawaspect"></a>COleClientItem:: Жетдраваспект

Вызовите функцию члена `GetDrawAspect`, чтобы определить текущий аспект или представление элемента.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение из перечисления ДВАСПЕКТ, значения которого перечислены в справочнике по [сетдраваспект](#setdrawaspect).

### <a name="remarks"></a>Remarks

Аспект определяет способ подготовки элемента к просмотру.

##  <a name="getextent"></a>COleClientItem:: расширение

Вызовите эту функцию, чтобы получить размер объекта OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Параметры

*лпсизе*<br/>
Указатель на `SIZE`ную структуру или объект `CSize`, который получит сведения о размере.

*ндраваспект*<br/>
Задает аспект объекта OLE, границы которого должны быть извлечены. Возможные значения см. в разделе [сетдраваспект](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; 0, если объект OLE пуст.

### <a name="remarks"></a>Remarks

Если серверное приложение было написано с помощью библиотека Microsoft Foundation Class, эта функция приводит к вызову функции члена [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) соответствующего объекта `COleServerItem`. Обратите внимание, что полученный размер может отличаться от размера, который последний задается функцией члена [сетекстент](#setextent) . размер, указанный в `SetExtent`, рассматривается как предложение. Измерения находятся в единицах MM_HIMETRIC.

> [!NOTE]
>  Не вызывайте `GetExtent` во время обработки обработчика OLE, например [onChange](#onchange). Вместо этого вызовите [жеткачедекстент](#getcachedextent) .

Дополнительные сведения см. в разделе [иолеобжект:: "расширение](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) " в Windows SDK.

##  <a name="geticonfromregistry"></a>COleClientItem:: Жетиконфромрегистри

Вызовите эту функцию-член, чтобы получить маркер ресурса значка, связанного с сервером определенного идентификатора CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Параметры

*этому*<br/>
Ссылка на идентификатор CLSID для сервера, связанного со значком.

### <a name="return-value"></a>Возвращаемое значение

Допустимый маркер для ресурса значка или значение NULL, если не удается найти значок сервера или значок по умолчанию.

### <a name="remarks"></a>Remarks

Эта функция-член не запустит сервер или динамически получить значок, даже если сервер уже запущен. Вместо этого эта функция члена открывает исполняемый образ сервера и получает статический значок, связанный с сервером при его регистрации.

##  <a name="geticonicmetafile"></a>COleClientItem:: Жетиконикметафиле

Извлекает метафайл, используемый для рисования значка элемента.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Возвращаемое значение

Маркер метафайла в случае успеха; в противном случае — NULL.

### <a name="remarks"></a>Remarks

Если текущего значка нет, возвращается значок по умолчанию. Он вызывается автоматически в диалоговых окнах MFC/OLE и обычно не вызывается напрямую.

Эта функция также вызывает [сетиконикметафиле](#seticonicmetafile) для кэширования метафайла для последующего использования.

##  <a name="getinplacewindow"></a>COleClientItem:: Жетинплацевиндов

Вызовите функцию-член `GetInPlaceWindow`, чтобы получить указатель на окно, в котором элемент был открыт для редактирования на месте.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на окно редактирования на месте элемента; Значение NULL, если элемент неактивен или его сервер недоступен.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться только для тех элементов, которые активны на месте.

##  <a name="getitemstate"></a>COleClientItem:: Жетитемстате

Вызовите эту функцию, чтобы получить текущее состояние объекта OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Возвращаемое значение

`COleClientItem::ItemState` перечислимое значение, которое может быть одним из следующих: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Сведения об этих состояниях см. в разделе [контейнеры статей: состояния клиентских элементов](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Remarks

Чтобы получать уведомления об изменении состояния элемента OLE, используйте функцию члена [onChange](#onchange) .

Дополнительные сведения см. в разделе [контейнеры статей: состояния клиентских элементов](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>COleClientItem:: Жетластстатус

Возвращает код состояния последней операции OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение SCODE.

### <a name="remarks"></a>Remarks

Для функций-членов, возвращающих логическое значение FALSE, или других функций-членов, возвращающих значение NULL, `GetLastStatus` возвращает более подробные сведения об ошибках. Имейте в виду, что большинство функций OLE Member создают исключения для более серьезных ошибок. Конкретные сведения о интерпретации SCODE зависят от базового вызова OLE, который последним возвратил значение SCODE.

Дополнительные сведения о SCODE см. в разделе [структура кодов ошибок COM](/windows/win32/com/structure-of-com-error-codes) в документации по Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Вызовите эту функцию, чтобы получить текущее значение параметра link-Update для элемента OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Возвращаемое значение

Одно из следующих значений:

- OLEUPDATE_ALWAYS обновлять связанный элемент везде, где это возможно. Этот параметр поддерживает переключатель Автоматическое обновление связи в диалоговом окне "ссылки".

- OLEUPDATE_ONCALL обновлять связанный элемент только по запросу из приложения-контейнера (при вызове функции-члена [упдателинк](#updatelink) ). Этот параметр поддерживает переключатель ссылки "вручную" для обновления в диалоговом окне "ссылки".

### <a name="remarks"></a>Remarks

Это дополнительная операция.

Эта функция вызывается автоматически классом [колелинксдиалог](../../mfc/reference/colelinksdialog-class.md) .

Дополнительные сведения см. в разделе [иолелинк:: жетупдатеоптионс](/windows/win32/api/oleidl/nf-oleidl-iolelink-getupdateoptions) в Windows SDK.

##  <a name="gettype"></a>COleClientItem:: GetType

Вызовите эту функцию, чтобы определить, является ли элемент OLE внедренным или связанным или статическим.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Возвращаемое значение

Целое число без знака с одним из следующих значений:

- OT_LINK элемент OLE является ссылкой.

- OT_EMBEDDED элемент OLE внедрен.

- OT_STATIC элемент OLE является статическим, то есть он содержит только данные представления, а не собственные данные и поэтому не может быть изменен.

##  <a name="getusertype"></a>COleClientItem:: Жетусертипе

Вызовите эту функцию, чтобы получить видимую пользователю строку, описывающую тип объекта OLE, например "документ Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Параметры

*нусеркласстипе*<br/>
Значение типа, указывающее нужный вариант строки, описывающий тип объекта OLE. Может иметь одно из следующих значений:

- USERCLASSTYPE_FULL полное имя типа, отображаемое пользователю.

- USERCLASSTYPE_SHORT короткое имя (не более 15 символов) для использования во всплывающих меню и в диалоговом окне Изменение ссылок.

- USERCLASSTYPE_APPNAME имя приложения, обслуживающего класс.

*rStr*<br/>
Ссылка на объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , в который будет возвращена строка, описывающая тип объекта OLE.

### <a name="remarks"></a>Remarks

Часто это запись в системной базе данных регистрации.

Если полное имя типа запрошено, но недоступно, вместо него используется короткое имя. Если в базе данных регистрации отсутствует запись для типа OLE-элемента или если для типа элемента OLE не зарегистрированы пользовательские типы, то используется тип пользователя, который в данный момент хранится в OLE-элементе. Если имя типа пользователя является пустой строкой, используется значение "неизвестный объект".

Дополнительные сведения см. в разделе [иолеобжект:: жетусертипе](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getusertype) в Windows SDK.

##  <a name="isinplaceactive"></a>COleClientItem:: Исинплацеактиве

Вызовите эту функцию, чтобы определить, является ли элемент OLE активным.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент OLE находится в активном месте; в противном случае — 0.

### <a name="remarks"></a>Remarks

Обычно выполняется другая логика в зависимости от того, редактируется ли элемент на месте. Функция проверяет, равно ли текущее состояние элемента либо `activeState`, либо `activeUIState`.

##  <a name="islinkuptodate"></a>COleClientItem:: Ислинкуптодате

Вызовите эту функцию, чтобы узнать, не устарел ли элемент OLE.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект OLE является актуальным; в противном случае — 0.

### <a name="remarks"></a>Remarks

Связанный элемент может устареть, если его исходный документ был обновлен. Внедренный элемент, содержащий ссылки внутри него, также может устареть. Функция выполняет рекурсивную проверку элемента OLE. Обратите внимание, что определение того, является ли объект OLE устаревшим, может считаться дорогостоящим, так как фактически выполняется обновление.

Это вызывается автоматически реализацией [колелинксдиалог](../../mfc/reference/colelinksdialog-class.md) .

Дополнительные сведения см. в разделе [иолеобжект:: исуптодате](/windows/win32/api/oleidl/nf-oleidl-ioleobject-isuptodate) в Windows SDK.

##  <a name="ismodified"></a>COleClientItem:: Modified

Вызовите эту функцию, чтобы определить, является ли объект OLE "грязным" (измененным с момента последнего сохранения).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект OLE является "грязным"; в противном случае — 0.

### <a name="remarks"></a>Remarks

Дополнительные сведения см. в разделе [иперсистстораже:: IsDirty](/windows/win32/api/objidl/nf-objidl-ipersiststorage-isdirty) в Windows SDK.

##  <a name="isopen"></a>COleClientItem:: OnOpen

Вызовите эту функцию, чтобы определить, открыт ли элемент OLE; то есть, открывается в экземпляре серверного приложения, работающего в отдельном окне.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект OLE открыт; в противном случае — 0.

### <a name="remarks"></a>Remarks

Он используется для определения времени рисования объекта с шаблоном штриховки. Открытый объект должен иметь шаблон штриховки, нарисованный поверх объекта. Это можно сделать с помощью объекта [кректтраккер](../../mfc/reference/crecttracker-class.md) .

##  <a name="isrunning"></a>COleClientItem:: выполнение

Вызовите эту функцию, чтобы определить, работает ли элемент OLE. то есть, загружается ли элемент и выполняется в серверном приложении.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент OLE работает. в противном случае — 0.

### <a name="remarks"></a>Remarks

Дополнительные сведения см. в разделе [олеисруннинг](/windows/win32/api/ole2/nf-ole2-oleisrunning) в Windows SDK.

##  <a name="onactivate"></a>COleClientItem:: OnActivate

Вызывается платформой для уведомления элемента о том, что он только что был активирован на месте.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Remarks

Обратите внимание, что эта функция вызывается, чтобы указать, что сервер работает, а не указывает, что его пользовательский интерфейс установлен в приложении-контейнере. На этом этапе объект не имеет активного пользовательского интерфейса (не `activeUIState`). На нем не установлены меню или панель инструментов. Функция-член [онактиватеуи](#onactivateui) вызывается, когда это происходит.

Реализация по умолчанию вызывает функцию-член [onChange](#onchange) с OLE_CHANGEDSTATE в качестве параметра. Переопределите эту функцию для выполнения пользовательской обработки, когда элемент станет активным на месте.

##  <a name="onactivateui"></a>COleClientItem:: Онактиватеуи

Платформа вызывает `OnActivateUI`, когда объект перешел в активное состояние пользовательского интерфейса.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Remarks

Теперь объект установил панель инструментов и меню.

Реализация по умолчанию запоминает HWND сервера для последующего `GetServerWindow` вызовов.

##  <a name="onchange"></a>COleClientItem:: OnChange

Вызывается платформой, когда пользователь изменяет, сохраняет или закрывает объект OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Параметры

*нкоде*<br/>
Причина, по которой сервер изменил этот элемент. Он может иметь одно из следующих значений:

- OLE_CHANGED внешний вид элемента OLE изменился.

- OLE_SAVED объект OLE сохранен.

- OLE_CLOSED элемент OLE был закрыт.

- OLE_CHANGED_STATE, что элемент OLE был изменен с одного состояния на другое.

*двпарам*<br/>
Если *нкоде* имеет значение OLE_SAVED или OLE_CLOSED, этот параметр не используется. Если *нкоде* имеет OLE_CHANGED, этот параметр задает аспект объекта OLE, который был изменен. Возможные значения см. в описании параметра *двпарам* объекта [COleClientItem::D RAW](#draw). Если *нкоде* имеет OLE_CHANGED_STATE, этот параметр является `COleClientItem::ItemState` перечислимым значением и описывает значение, которое необходимо указать. Он может иметь одно из следующих значений: `emptyState`, `loadedState`, `openState`, `activeState`или `activeUIState`.

### <a name="remarks"></a>Remarks

(Если серверное приложение написано с помощью библиотека Microsoft Foundation Class, эта функция вызывается в ответ на `Notify` функции-члены `COleServerDoc` или `COleServerItem`.) Реализация по умолчанию помечает документ контейнера как измененный, если *нкоде* имеет OLE_CHANGED или OLE_SAVED.

Для OLE_CHANGED_STATE текущее состояние, возвращенное из [жетитемстате](#getitemstate) , останется прежним, то есть состоянием, которое было текущим до этого изменения состояния.

Переопределите эту функцию, чтобы она отвечала на изменения в состоянии элемента OLE. Как правило, вы обновляете внешний вид элемента путем непроверки области, в которой отображается элемент. Вызовите реализацию базового класса в начале переопределения.

##  <a name="onchangeitemposition"></a>COleClientItem:: OnChangeItemPosition

Вызывается платформой для уведомления контейнера о том, что экстент объекта OLE изменился во время активации на месте.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Параметры

*ректпос*<br/>
Указывает позицию элемента относительно клиентской области приложения контейнера.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если позиция элемента успешно изменена; в противном случае — 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию определяет новый видимый прямоугольник элемента OLE и вызывает [SetItemRects](#setitemrects) с новыми значениями. Реализация по умолчанию вычисляет видимый прямоугольник для элемента и передает эту информацию на сервер.

Переопределите эту функцию, чтобы применить специальные правила к операции изменения размера или перемещения. Если приложение написано в MFC, это вызов приводит к получению из-за того, что сервер вызвал [колесервердок:: рекуестпоситиончанже](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>COleClientItem:: OnDeactivate

Вызвано структурой при переходе OLE-элемента из активного состояния (`activeState`) в состояние "Загружено". Это означает, что оно деактивируется после активации на месте.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Remarks

Обратите внимание, что эта функция вызывается, чтобы указать, что OLE-элемент закрыт, а не на то, что его пользовательский интерфейс был удален из приложения-контейнера. В этом случае вызывается функция-член [ондеактиватеуи](#ondeactivateui) .

Реализация по умолчанию вызывает функцию-член [onChange](#onchange) с OLE_CHANGEDSTATE в качестве параметра. Переопределите эту функцию, чтобы выполнить пользовательскую обработку при деактивации активного элемента на месте. Например, если в приложении-контейнере поддерживается команда Undo, можно переопределить эту функцию, чтобы отменить состояние отмены, указывающее, что последняя операция, выполненная над элементом OLE, не может быть отменена после деактивации элемента.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Вызывается платформой, когда пользователь вызывает команду Undo после активации элемента OLE на месте.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Remarks

Реализация по умолчанию вызывает [деактиватеуи](#deactivateui) для деактивации пользовательского интерфейса сервера. Переопределите эту функцию, если вы реализуете команду Undo в приложении контейнера. В переопределении вызовите версию базового класса функции, а затем отмените последнюю команду, выполненную в приложении.

Дополнительные сведения см. в разделе [иолеинплацесите::D еактиватеандундо](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) в Windows SDK.

##  <a name="ondeactivateui"></a>COleClientItem:: Ондеактиватеуи

Вызывается, когда пользователь отключает элемент, который был активирован на месте.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Параметры

*бундоабле*<br/>
Указывает, отменяются ли изменения редактирования.

### <a name="remarks"></a>Remarks

Эта функция восстанавливает пользовательский интерфейс приложения-контейнера в исходное состояние, скрывая все меню и другие элементы управления, созданные для активации на месте.

Если *бундоабле* имеет значение false, контейнер должен отключить команду Undo, в результате отменив состояние отмены контейнера, так как это указывает на то, что последняя операция, выполненная сервером, не может быть отменена.

##  <a name="ondiscardundostate"></a>COleClientItem:: Ондискардундостате

Вызывается платформой, когда пользователь выполняет действие, которое удаляет состояние отмены при редактировании элемента OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Remarks

Реализация по умолчанию не выполняет никаких действий. Переопределите эту функцию, если вы реализуете команду Undo в приложении контейнера. В переопределении отмените состояние отмены для приложения контейнера.

Если сервер был записан с библиотека Microsoft Foundation Class, сервер может вызвать эту функцию, вызвав [колесервердок::D искардундостате](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Дополнительные сведения см. в разделе [иолеинплацесите::D искардундостате](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) в Windows SDK.

##  <a name="ongetclipboarddata"></a>COleClientItem:: Онжетклипбоарддата

Вызывается платформой для получения объекта `COleDataSource`, содержащего все данные, которые будут помещены в буфер обмена путем вызова функции-члена [копитоклипбоард](#copytoclipboard) или [DoDragDrop](#dodragdrop) .

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Параметры

*бинклуделинк*<br/>
Задайте значение TRUE, если данные связи должны быть скопированы в буфер обмена. Установите значение FALSE, если серверное приложение не поддерживает ссылки.

*лпоффсет*<br/>
Указатель на смещение курсора мыши от начала объекта в пикселях.

*лпсизе*<br/>
Указатель на размер объекта в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект [COleDataSource](../../mfc/reference/coledatasource-class.md) , содержащий данные буфера обмена.

### <a name="remarks"></a>Remarks

Реализация по умолчанию этой функции вызывает [жетклипбоарддата](#getclipboarddata).

##  <a name="ongetcliprect"></a>COleClientItem:: Онжетклипрект

Платформа вызывает функцию-член `OnGetClipRect`, чтобы получить координаты обрезкиного прямоугольника элемента, который редактируется на месте.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Параметры

*рклипрект*<br/>
Указатель на объект класса [крект](../../atl-mfc-shared/reference/crect-class.md) , который будет содержать координаты вырезанного прямоугольника элемента.

### <a name="remarks"></a>Remarks

Координаты задаются в пикселях относительно клиентской области окна приложения контейнера.

Реализация по умолчанию просто возвращает клиентский прямоугольник представления, в котором элемент находится в активном месте.

##  <a name="ongetitemposition"></a>COleClientItem:: OnGetItemPosition

Платформа вызывает функцию-член `OnGetItemPosition`, чтобы получить координаты элемента, который редактируется на месте.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Параметры

*rPosition*<br/>
Ссылка на объект [крект](../../atl-mfc-shared/reference/crect-class.md) , который будет содержать координаты позиции элемента.

### <a name="remarks"></a>Remarks

Координаты задаются в пикселях относительно клиентской области окна приложения контейнера.

Реализация по умолчанию этой функции не выполняет никаких действий. Для приложений, поддерживающих редактирование на месте, требуется реализация.

##  <a name="ongetwindowcontext"></a>COleClientItem:: Онжетвиндовконтекст

Вызывается платформой, когда элемент активируется на месте.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Параметры

*ппмаинфраме*<br/>
Указатель на указатель на главное окно фрейма.

*ппдокфраме*<br/>
Указатель на указатель на окно фрейма документа.

*лпфрамеинфо*<br/>
Указатель на структуру [олеинплацефрамеинфо](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) , которая будет принимать сведения о окне фрейма.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Эта функция используется для получения сведений о родительском окне элемента OLE.

Если контейнер является приложением MDI, реализация по умолчанию возвращает указатель на объект [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) в *ппмаинфраме* и указатель на активный объект [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md) в *ппдокфраме*. Если контейнер является приложением SDI, реализация по умолчанию возвращает указатель на объект [CFrameWnd](../../mfc/reference/cframewnd-class.md) в *ппмаинфраме* и возвращает значение NULL в *ппдокфраме*. Реализация по умолчанию также заполняет члены *лпфрамеинфо*.

Переопределяйте эту функцию, только если реализация по умолчанию не соответствует приложению; Например, если приложение имеет парадигму пользовательского интерфейса, отличающуюся от SDI или MDI. Это расширенный переопределяемый объект.

Дополнительные сведения см. в разделе [иолеинплацесите:: GetWindowContext](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) и структура [олеинплацефрамеинфо](/windows/win32/api/oleidl/ns-oleidl-oleinplaceframeinfo) в Windows SDK.

##  <a name="oninsertmenus"></a>COleClientItem:: Онинсертменус

Вызывается платформой во время активации на месте для вставки меню приложения-контейнера в пустое меню.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Параметры

*пменушаред*<br/>
Указывает на пустое меню.

*лпменувидсс*<br/>
Указывает на массив из шести ДЛИННых значений, указывающих, сколько меню находится в каждой из следующих групп меню: файл, Правка, контейнер, объект, окно, Справка. Приложение-контейнер отвечает за группы меню файл, контейнер и окно, соответствующие элементам 0, 2 и 4 этого массива.

### <a name="remarks"></a>Remarks

Это меню затем передается на сервер, который вставляет собственные меню, создавая составное меню. Эту функцию можно вызывать многократно для создания нескольких составных меню.

Реализация по умолчанию вставляет в *пменушаред* меню контейнера на месте; то есть группы меню файл, контейнер и окно. [CDocTemplate:: сетконтаинеринфо](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) используется для задания этого ресурса меню. Реализация по умолчанию также назначает соответствующие значения элементам 0, 2 и 4 в *лпменувидсс*, в зависимости от ресурса меню. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для связывания ресурсов с типами документов. При переопределении этой функции следует также переопределить [онсетмену](#onsetmenu) и [онремовеменус](#onremovemenus). Это расширенный переопределяемый объект.

Дополнительные сведения см. в разделе [иолеинплацефраме:: инсертменус](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) в Windows SDK.

##  <a name="onremovemenus"></a>COleClientItem:: Онремовеменус

Вызывается платформой для удаления меню контейнера из указанного составного меню при завершении активации на месте.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Параметры

*пменушаред*<br/>
Указывает на составное меню, созданное вызовом функции члена [онинсертменус](#oninsertmenus) .

### <a name="remarks"></a>Remarks

Реализация по умолчанию удаляет из *пменушаред* меню контейнера на месте, т. е. группы меню файл, контейнер и окно. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для связывания ресурсов с типами документов. При переопределении этой функции, вероятно, следует также переопределить [онинсертменус](#oninsertmenus) и [онсетмену](#onsetmenu) . Это расширенный переопределяемый объект.

Подменю *пменушаред* могут совместно использоваться несколькими составными меню, если сервер несколько раз вызывает `OnInsertMenus`. Поэтому не следует удалять подменю в переопределении `OnRemoveMenus`; их следует отсоединить только.

Дополнительные сведения см. в разделе [иолеинплацефраме:: ремовеменус](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) в Windows SDK.

##  <a name="onscrollby"></a>COleClientItem:: Онскроллби

Вызывается платформой для прокрутки элемента OLE в ответ на запросы от сервера.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Параметры

*сизикстент*<br/>
Задает расстояния (в пикселях) для прокрутки в направлениях x и y.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент прокручивается; 0, если не удалось прокручивать элемент.

### <a name="remarks"></a>Remarks

Например, если элемент OLE является частично видимым и пользователь переходит за пределы видимой области при выполнении редактирования на месте, эта функция вызывается для сохранения видимости курсора. Реализация по умолчанию не выполняет никаких действий. Переопределите эту функцию, чтобы прокрутить элемент на заданный объем. Обратите внимание, что в результате прокрутки видимая часть объекта OLE может измениться. Вызовите [SetItemRects](#setitemrects) , чтобы обновить видимый прямоугольник элемента.

Дополнительные сведения см. в разделе [иолеинплацесите:: Scroll](/windows/win32/api/oleidl/nf-oleidl-ioleinplacesite-scroll) в Windows SDK.

##  <a name="onsetmenu"></a>COleClientItem:: Онсетмену

Вызывается структурой два раза при начале и окончании активации на месте; Первая установка составного меню и второй раз (с *холемену* , равным null), чтобы удалить его.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Параметры

*пменушаред*<br/>
Указатель на составное меню, созданное вызовом функции члена [онинсертменус](#oninsertmenus) и функции `InsertMenu`.

*холемену*<br/>
Дескриптор меню, возвращаемого функцией `OleCreateMenuDescriptor`, или значение NULL, если нужно удалить код диспетчеризации.

*хвндактивеобжект*<br/>
Обработчик для окна редактирования элемента OLE. Это окно, которое будет принимать команды редактирования из OLE.

### <a name="remarks"></a>Remarks

Реализация по умолчанию устанавливает или удаляет составное меню, а затем вызывает функцию [олесетменудескриптор](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor) для установки или удаления кода диспетчеризации. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения. При переопределении этой функции, вероятно, следует также переопределить [онинсертменус](#oninsertmenus) и [онремовеменус](#onremovemenus) . Это расширенный переопределяемый объект.

Дополнительные сведения см. в разделе [олекреатеменудескриптор](/windows/win32/api/ole2/nf-ole2-olecreatemenudescriptor), [олесетменудескриптор](/windows/win32/api/ole2/nf-ole2-olesetmenudescriptor)и [иолеинплацефраме:: сетмену](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) в Windows SDK.

##  <a name="onshowcontrolbars"></a>COleClientItem:: Оншовконтролбарс

Вызывается платформой для отображения и скрытия панелей управления приложения контейнера.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Параметры

*пфрамевнд*<br/>
Указатель на окно фрейма приложения контейнера. Это может быть либо главное окно фрейма, либо дочернее окно MDI.

*bShow*<br/>
Указывает, должны ли отображаться или скрываться панели управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов функции приводит к изменению состояния панелей управления; 0, если вызов не приводит к изменению, или если *пфрамевнд* не указывает на окно фрейма контейнера.

### <a name="remarks"></a>Remarks

Эта функция возвращает 0, если панели элементов управления уже находятся в состоянии, заданном параметром *бшов.* Это может произойти, например, если панели элементов управления скрыты и *бшов* имеет значение false.

Реализация по умолчанию удаляет панель инструментов из окна фрейма верхнего уровня.

##  <a name="onshowitem"></a>COleClientItem:: Оншовитем

Вызывается платформой для отображения элемента OLE, делая его полностью видимым во время редактирования.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Remarks

Он используется, когда приложение-контейнер поддерживает ссылки на внедренные элементы (то есть если класс документа был производным от [колелинкингдок](../../mfc/reference/colelinkingdoc-class.md)). Эта функция вызывается при активации по месту или когда элемент OLE является источником ссылки и пользователь хочет изменить его. Реализация по умолчанию активирует первое представление в документе контейнера. Переопределите эту функцию для прокрутки документа, чтобы элемент OLE был видимым.

##  <a name="onupdateframetitle"></a>COleClientItem:: Онупдатефраметитле

Вызывается платформой во время активации на месте для обновления заголовка окна фрейма.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если эта функция успешно обновила заголовок фрейма; в противном случае — ноль.

### <a name="remarks"></a>Remarks

Реализация по умолчанию не изменяет заголовок окна фрейма. Переопределите эту функцию, если вам требуется другая рамка для приложения, например " *серверное приложение* - *элемент* в *докнаме*" (например, "Microsoft Excel — электронная таблица в отчете". DOC "). Это расширенный переопределяемый объект.

##  <a name="reactivateandundo"></a>COleClientItem:: Реактиватеандундо

Вызовите эту функцию, чтобы повторно активировать OLE-элемент и отменить последнюю операцию, выполненную пользователем во время редактирования на месте.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Если приложение контейнера поддерживает команду "отменить", вызовите эту функцию, если пользователь выберет команду "отменить" сразу после деактивации элемента OLE.

Если серверное приложение написано с помощью библиотек Microsoft Foundation Class, эта функция заставляет сервер вызывать [колесервердок:: онреактиватеандундо](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Дополнительные сведения см. в разделе [иолеинплацеобжект:: реактиватеандундо](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) в Windows SDK.

##  <a name="release"></a>COleClientItem:: Release

Вызывайте эту функцию для очистки ресурсов, используемых элементом OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Параметры

*двклосеоптион*<br/>
Флаг, указывающий, при каких обстоятельствах объект OLE сохраняется при возвращении в состояние загруженности. Список возможных значений см. в разделе [COleClientItem:: Close](#close).

### <a name="remarks"></a>Remarks

`Release` вызывается деструктором `COleClientItem`.

Дополнительные сведения см. в разделе [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) в Windows SDK.

##  <a name="reload"></a>COleClientItem:: перезагрузить

Закрывает и перезагружает элемент.

```
BOOL Reload();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Вызовите функцию `Reload` после активации элемента в качестве элемента другого типа путем вызова [активатеас](#activateas).

##  <a name="run"></a>COleClientItem:: Run

Запускает приложение, связанное с этим элементом.

```
void Run();
```

### <a name="remarks"></a>Remarks

Вызовите функцию члена `Run`, чтобы запустить серверное приложение перед активацией элемента. Это делается автоматически с помощью [активации](#activate) и [доверб](#doverb), поэтому обычно нет необходимости вызывать эту функцию. Вызывайте эту функцию, если необходимо запустить сервер, чтобы задать атрибут элемента, например [сетекстент](#setextent), перед выполнением [доверб](#doverb).

##  <a name="setdrawaspect"></a>COleClientItem:: Сетдраваспект

Вызовите функцию члена `SetDrawAspect`, чтобы задать "аспект" или представление элемента.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Параметры

*ндраваспект*<br/>
Значение из перечисления ДВАСПЕКТ. Этот параметр может принимать одно из следующих значений:

- DVASPECT_CONTENT элемент представлен таким образом, что он может отображаться как внедренный объект внутри своего контейнера.

- DVASPECT_THUMBNAIL элемент отображается в виде эскиза, чтобы его можно было отобразить в средстве просмотра.

- DVASPECT_ICON элемент представлен значком.

- DVASPECT_DOCPRINT элемент представлен так, как если бы он был распечатан с помощью команды Печать в меню файл.

### <a name="remarks"></a>Remarks

Аспект определяет способ отрисовки элемента путем [рисования](#draw) при использовании значения по умолчанию для аргумента *ндраваспект* этой функции.

Эта функция вызывается автоматически значком изменения (и другими диалоговыми окнами, которые вызывают диалоговое окно изменения значка) для включения аспекта изображения значка при запросе пользователя.

##  <a name="setextent"></a>COleClientItem:: Сетекстент

Вызовите эту функцию, чтобы указать, сколько места доступно для элемента OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Объект [ксизе](../../atl-mfc-shared/reference/csize-class.md) , содержащий сведения о размере.

*ндраваспект*<br/>
Задает аспект объекта OLE, границы которого должны быть установлены. Возможные значения см. в разделе [сетдраваспект](#setdrawaspect).

### <a name="remarks"></a>Remarks

Если серверное приложение было написано с помощью библиотека Microsoft Foundation Class, то вызывается функция члена [онсетекстент](../../mfc/reference/coleserveritem-class.md#onsetextent) соответствующего объекта `COleServerItem`. Затем элемент OLE может соответствующим образом скорректировать свой экран. Измерения должны быть в единицах MM_HIMETRIC. Вызывайте эту функцию, когда пользователь изменяет размер элемента OLE или если поддерживается определенная форма согласования макета.

Дополнительные сведения см. в разделе [иолеобжект:: сетекстент](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent) в Windows SDK.

##  <a name="sethostnames"></a>COleClientItem:: Сесостнамес

Вызовите эту функцию, чтобы указать имя приложения контейнера и имя контейнера для внедренного элемента OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Параметры

*лпсзост*<br/>
Указатель на видимое пользователю имя приложения-контейнера.

*лпсзостобж*<br/>
Указатель на идентифицирующую строку контейнера, который содержит элемент OLE.

### <a name="remarks"></a>Remarks

Если серверное приложение было написано с помощью библиотека Microsoft Foundation Class, эта функция вызывает функцию члена [онсесостнамес](../../mfc/reference/coleserverdoc-class.md#onsethostnames) из документа `COleServerDoc`, который содержит элемент OLE. Эти сведения используются в заголовках окон при редактировании элемента OLE. Каждый раз при загрузке документа контейнера платформа вызывает эту функцию для всех элементов OLE в документе. `SetHostNames` применимо только к внедренным элементам. Нет необходимости вызывать эту функцию каждый раз при активации внедренного элемента OLE для редактирования.

Он также вызывается автоматически с именем приложения и именем документа при загрузке объекта или при сохранении файла с другим именем. Таким образом, обычно не требуется вызывать эту функцию напрямую.

Дополнительные сведения см. в разделе [иолеобжект:: сесостнамес](/windows/win32/api/oleidl/nf-oleidl-ioleobject-sethostnames) в Windows SDK.

##  <a name="seticonicmetafile"></a>COleClientItem:: Сетиконикметафиле

Кэширует метафайл, используемый для рисования значка элемента.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Параметры

*хметапикт*<br/>
Маркер метафайла, используемый для рисования значка элемента.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Для получения метафайла используйте [жетиконикметафиле](#geticonicmetafile) .

Параметр *хметапикт* копируется в элемент. Таким образом, *хметапикт* должен быть освобожден вызывающим объектом.

##  <a name="setitemrects"></a>COleClientItem:: SetItemRects

Вызовите эту функцию, чтобы задать ограничивающий прямоугольник или видимый прямоугольник элемента OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*лпркпосрект*<br/>
Указатель на прямоугольник, содержащий границы элемента OLE, относительно его родительского окна в клиентских координатах.

*лпркклипрект*<br/>
Указатель на прямоугольник, содержащий границы видимой части элемента OLE, относительно родительского окна в клиентских координатах.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Remarks

Эта функция вызывается реализацией функции-члена [OnChangeItemPosition](#onchangeitemposition) по умолчанию. Эту функцию следует вызывать при каждом изменении позиции или видимой части объекта OLE. Как правило, это означает, что вы вызываете его из функций члена [OnSize](../../mfc/reference/cwnd-class.md#onsize) и [онскроллби](../../mfc/reference/cview-class.md#onscrollby) в представлении.

Дополнительные сведения см. в разделе [иолеинплацеобжект:: сетобжектректс](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) в Windows SDK.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Вызовите эту функцию, чтобы установить параметр Link-Update для представления указанного связанного элемента.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Параметры

*двупдатеопт*<br/>
Значение параметра link-Update для этого элемента. Это значение должно быть одним из следующих:

- OLEUPDATE_ALWAYS обновлять связанный элемент везде, где это возможно. Этот параметр поддерживает переключатель Автоматическое обновление связи в диалоговом окне "ссылки".

- OLEUPDATE_ONCALL обновлять связанный элемент только по запросу из приложения-контейнера (при вызове функции-члена [упдателинк](#updatelink) ). Этот параметр поддерживает переключатель ссылки "вручную" для обновления в диалоговом окне "ссылки".

### <a name="remarks"></a>Remarks

Как правило, не следует изменять параметры обновления, выбранные пользователем в диалоговом окне "ссылки".

Дополнительные сведения см. в разделе [иолелинк:: сетупдатеоптионс](/windows/win32/api/oleidl/nf-oleidl-iolelink-setupdateoptions) в Windows SDK.

##  <a name="setprintdevice"></a>COleClientItem:: Сетпринтдевице

Вызовите эту функцию, чтобы изменить целевое устройство печати для этого элемента.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указатель на структуру данных [двтаржетдевице](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , которая содержит сведения о новом целевом устройстве печати. Может иметь значение NULL.

*PPD*<br/>
Указатель на структуру данных [принтдлг](/windows/win32/api/commdlg/ns-commdlg-printdlga) , которая содержит сведения о новом целевом устройстве печати. Может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Remarks

Эта функция обновляет целевое устройство печати для элемента, но не обновляет кэш презентации. Чтобы обновить кэш презентации для элемента, вызовите [упдателинк](#updatelink).

Аргументы этой функции содержат сведения, которые система OLE использует для определения целевого устройства. Структура `PRINTDLG` содержит сведения, используемые Windows для инициализации стандартного диалогового окна печати. Когда пользователь закрывает диалоговое окно, Windows возвращает сведения о выборе пользователя в этой структуре. Элемент `m_pd` объекта [кпринтдиалог](../../mfc/reference/cprintdialog-class.md) является структурой `PRINTDLG`.

Дополнительные сведения об этой структуре см. в разделе [принтдлг](/windows/win32/api/commdlg/ns-commdlg-printdlga) в Windows SDK.

Дополнительные сведения см. в разделе [двтаржетдевице](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) в Windows SDK.

##  <a name="updatelink"></a>COleClientItem:: Упдателинк

Вызывайте эту функцию для немедленного обновления данных представления элемента OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.

### <a name="remarks"></a>Remarks

Для связанных элементов функция находит источник ссылки, чтобы получить новую презентацию для элемента OLE. Этот процесс может привести к запуску одного или нескольких серверных приложений, что может занять много времени. Для внедренных элементов функция работает рекурсивно, проверяя, содержит ли внедренный элемент ссылки, которые могут устареть и обновлять их. Пользователь может также вручную обновить отдельные ссылки с помощью диалогового окна "ссылки".

Дополнительные сведения см. в разделе [иолелинк:: Update](/windows/win32/api/oleidl/nf-oleidl-iolelink-update) в Windows SDK.

## <a name="see-also"></a>См. также раздел

[Пример МФКБИНД для MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример OCLIENT MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс COleServerItem](../../mfc/reference/coleserveritem-class.md)
