---
title: Класс COleClientItem
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: 2687dfc9941a512523a7cb771cb872c78b97ce2d
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "58773987"
---
# <a name="coleclientitem-class"></a>Класс COleClientItem

Определяет контейнерный интерфейс для элементов OLE.

## <a name="syntax"></a>Синтаксис

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Создает объект `COleClientItem`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Открывает элемент OLE для операции, а затем выполняет указанную команду.|
|[COleClientItem::ActivateAs](#activateas)|Активирует элемент другого типа.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Обращается к данным в OLE-объекта.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Указывает, может ли приложение-контейнер создать внедренный объект.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Указывает, может ли приложение-контейнер создать связанный объект.|
|[COleClientItem::CanPaste](#canpaste)|Указывает, содержит ли буфер обмена элемента OLE встраиваемый или статический.|
|[COleClientItem::CanPasteLink](#canpastelink)|Указывает, содержит ли буфер обмена, могут быть связаны объекта OLE.|
|[COleClientItem::Close](#close)|Закрывает ссылку на сервер, но не уничтожает объекта OLE.|
|[COleClientItem::ConvertTo](#convertto)|Преобразует элемент в другой тип.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Копирование элемента OLE в буфер обмена.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Создает дубликат существующего элемента.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Создает внедренный элемент из буфера обмена.|
|[COleClientItem::CreateFromData](#createfromdata)|Создает внедренный элемент из объекта данных.|
|[COleClientItem::CreateFromFile](#createfromfile)|Создает внедренный элемент из файла.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Создает связанный элемент из буфера обмена.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Создает связанный элемент из объекта данных.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Создает связанный элемент из файла.|
|[COleClientItem::CreateNewItem](#createnewitem)|Создает новый внедренный элемент, запустив серверное приложение.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Создает статический элемент из буфера обмена.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Создает статический элемент из объекта данных.|
|[COleClientItem::Deactivate](#deactivate)|Деактивирует элемент.|
|[COleClientItem::DeactivateUI](#deactivateui)|Восстанавливает исходное состояние пользовательского интерфейса приложения-контейнера.|
|[COleClientItem::Delete](#delete)|Удаляет или закрывает объекта OLE, если он был связанный элемент.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Выполняет операцию перетаскивания и вставки.|
|[COleClientItem::DoVerb](#doverb)|Выполняет указанную команду.|
|[COleClientItem::Draw](#draw)|Рисует объекта OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Получает представление, на котором активируется элемента на месте.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Возвращает границы прямоугольника объекта OLE.|
|[COleClientItem::GetClassID](#getclassid)|Получает идентификатор присутствует элемент класса.|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Возвращает данные, которые будут размещаться в буфер обмена, вызвав `CopyToClipboard` функция-член.|
|[COleClientItem::GetDocument](#getdocument)|Возвращает `COleDocument` , содержащий присутствует элемент.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Получает текущее представление элемента для подготовки к просмотру.|
|[COleClientItem::GetExtent](#getextent)|Возвращает границы прямоугольника объекта OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Извлекает дескриптор значка, связанного с сервером для определенного идентификатора CLSID.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Получает метафайл, используемый для рисования значка элемента.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Возвращает указатель на окно редактирования на месте элемента.|
|[COleClientItem::GetItemState](#getitemstate)|Получает текущее состояние элемента.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Возвращает состояние последней операции OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Возвращает режим обновления для связанного элемента (дополнительная возможность).|
|[COleClientItem::GetType](#gettype)|Возвращает тип объекта OLE (embedded, связанной или статический).|
|[COleClientItem::GetUserType](#getusertype)|Возвращает строку, описывающую тип данного элемента.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Возвращает значение TRUE, если элемент является активным на месте.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Возвращает значение TRUE, если связанный элемент находится в актуальном состоянии с его исходного документа.|
|[COleClientItem::IsModified](#ismodified)|Возвращает значение TRUE, если элемент был изменен с момента его последнего сохранения.|
|[COleClientItem::IsOpen](#isopen)|Возвращает значение TRUE, если элемент является в настоящее время открыть в серверном приложении.|
|[COleClientItem::IsRunning](#isrunning)|Возвращает значение TRUE, если элемента серверное приложение.|
|[COleClientItem::OnActivate](#onactivate)|Вызывается платформой для уведомления элемента о том, что он активирован.|
|[COleClientItem::OnActivateUI](#onactivateui)|Вызывается платформой для уведомления элемента, он активируется и должно отображаться его пользовательский интерфейс.|
|[COleClientItem::OnChange](#onchange)|Вызывается, когда сервер изменяет объекта OLE. Требуется реализация.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Вызывается платформой при деактивации элемента.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Вызывается платформой, когда сервер удаляется его встроенный пользовательский интерфейс.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Вызывается платформой для получения данных для копирования в буфер обмена.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Вызывается платформой для создания составного меню.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Вызывается платформой для удаления меню контейнера из составного меню.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Вызывается платформой для установки и удаления составного меню.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Вызвано структурой для отображения и скрытия панели элементов управления.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Вызывается платформой для обновления заголовка фрейма окна.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Повторно активирует элемент и отменяет последнюю операцию редактирования на месте.|
|[COleClientItem::Release](#release)|Освобождает соединение для связанного элемента OLE и закрывается, если он был открыт. Уничтожает элемент клиента.|
|[COleClientItem::Reload](#reload)|Перезагружает элемента после вызова `ActivateAs`.|
|[COleClientItem::Run](#run)|Запускает приложение, связанное с элементом.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Задает текущее представление элемента для подготовки к просмотру.|
|[COleClientItem::SetExtent](#setextent)|Задает ограничивающий прямоугольник элемента OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Задает имена на сервере отображается при редактировании объекта OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Кэширует метафайла, используемый для рисования значка элемента.|
|[COleClientItem::SetItemRects](#setitemrects)|Задает ограничивающего прямоугольника элемента.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Задает режим обновления для связанного элемента (дополнительная возможность).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Задает печати целевого устройства для этого элемента клиента.|
|[COleClientItem::UpdateLink](#updatelink)|Обновляет кэш представления элемента.|

### <a name="protected-methods"></a>Защищенные методы

|name|Описание|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Вызывается платформой для определения допустимости активации на месте.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Вызывается платформой при изменении положения элемента.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Вызывается платформой для отмены после активации.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Вызывается платформой для отмены сведения о состоянии элемента отката.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Вызывается платформой для получения координаты прямоугольника обрезки элемента.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Вызывается платформой для получения позиции относительно представления.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Вызывается платформой при активации элемента на месте.|
|[COleClientItem::OnScrollBy](#onscrollby)|Вызывается платформой для прокрутки элемента в представлении.|
|[COleClientItem::OnShowItem](#onshowitem)|Вызывается платформой для отображения объекта OLE.|

## <a name="remarks"></a>Примечания

Объект OLE представляет данные, создается и обслуживается серверного приложения, который может быть «» встраивается в документ для отображения пользователю, чтобы быть в один документ. Результатом является объекта OLE и содержащий документ «составной документ».

Объект OLE могут быть внедрены или связанные. Если он встроен, его данные хранятся как часть составного документа. Если он связан, данные хранятся как часть отдельный файл, созданный командой серверное приложение, а только ссылка на этот файл хранится в составном документе. Все элементы OLE содержат сведения, указывающие, серверное приложение, который должен быть вызван для их изменения.

`COleClientItem` определяет несколько переопределяемые функции, которые вызываются в ответ на запросы из серверного приложения; Эти переопределяемости обычно выступают в качестве уведомления. Это позволяет приложению сервера для информирования контейнера изменения, вносимые пользователем, при редактировании объекта OLE и получать сведения, необходимые во время редактирования.

`COleClientItem` можно использовать с любым [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), или [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) класса. Чтобы использовать `COleClientItem`, создать класс, производный от него и реализовать [OnChange](#onchange) функцией-членом, которая определяет, как контейнер будет реагировать на изменения, внесенные в элемент. Для поддержки активации на месте, переопределить [OnGetItemPosition](#ongetitemposition) функция-член. Эта функция предоставляет сведения о позиции отображаемого объекта OLE.

Дополнительные сведения об использовании интерфейса контейнера см. в статьях [контейнеров: Реализация контейнера](../../mfc/containers-implementing-a-container.md) и [активации](../../mfc/activation-cpp.md).

> [!NOTE]
>  Пакет SDK Windows ссылается на внедренные и связанные элементы, как «объекты» и ссылается на типы элементов в виде «классы». Эта ссылка используется термин «элемент» для различения объект OLE, соответствующий объект C++ и термин «type» для различения категории OLE из класса C++.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Требования

**Заголовок:** afxole.h

##  <a name="activate"></a>  COleClientItem::Activate

Вызывайте эту функцию для выполнения указанной команды вместо [DoVerb](#doverb) таким образом, чтобы можно было выполнять собственные обработку, когда возникает исключение.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*nVerb*<br/>
Указывает команду для выполнения. Он может принимать одно из следующих:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичный команды|(Нет)|
|- 1|Отображаемым элементом для редактирования|OLEIVERB_SHOW|
|- 2|Изменение элемента в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрытие элементов|OLEIVERB_HIDE|

Значение-1, обычно является псевдонимом для другой команды. Если открыть изменения не поддерживается, -2 имеет тот же эффект, что значение -1. Дополнительные значения, см. в разделе [функция IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) в пакете Windows SDK.

*pView*<br/>
Указатель на окно представления контейнера, содержащего элемент OLE; Это используется серверным приложением для активации на месте. Этот параметр должен иметь значение NULL, если контейнер не поддерживает активацию на месте.

*lpMsg*<br/>
Указатель на сообщение, вызвавшее активацию элемента.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки Microsoft Foundation Class, эта функция приводит к [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) функция-член соответствующего `COleServerItem` объект для выполнения.

Если первичный глагол редактирования и равно нулю в *nVerb* параметра, серверное приложение запускается разрешающее элемента OLE, подлежащего редактированию. Если приложение-контейнер поддерживает активацию на месте, редактирования можно сделать на месте. Если контейнер не поддерживает активации на месте (или если указано командой Open), сервер запускается в отдельном окне и редактирование может выполняться существует. Как правило, когда приложения-контейнера двойном щелчке объекта OLE, значение первичный глагол в *nVerb* параметр определяет действие, которое пользователь может делать. Тем не менее, если сервер поддерживает только одно действие, необходимое этого действия, независимо от того, что значение указывается в *nVerb* параметра.

Дополнительные сведения см. в разделе [функция IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) в пакете Windows SDK.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Использует средства преобразования объекта в OLE для активации элемента, как будто это элемент типа, заданного параметром *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*lpszUserType*<br/>
Указатель на строку, представляющую тип объекта пользователя, например «Документ Word».

*clsidOld*<br/>
Идентификатор ссылку на класс текущего элемента. Идентификатор класса должен представлять тип фактического объекта, как хранятся, если это ссылка. В этом случае следует идентификатор CLSID элемента, на который указывает эта ссылка. [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) автоматически предоставляет идентификатор правильного класса для элемента.

*clsidNew*<br/>
Ссылку на идентификатор целевой класс.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Это называется автоматически [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Он не вызывается обычно непосредственно.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Вызывайте эту функцию для инициализации [COleDataObject](../../mfc/reference/coledataobject-class.md) для доступа к данным в элементе OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Параметры

*rDataObject*<br/>
Ссылка на `COleDataObject` объект, который будет инициализирован, чтобы разрешить доступ к данным в элементе OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Вызывается платформой, когда пользователь запрашивает встроенной активации объекта OLE; Эта функция возвращаемое значение определяет, разрешена ли активация на месте.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если разрешена активация на месте; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию позволяет встроенной активации, если контейнер имеет допустимый окна. Переопределите эту функцию, чтобы реализовать специальную логику для принятия или отклоняет запрос на активацию. Например запрос на активацию может быть отклонен, если элемент OLE слишком мал или не видимую в данный момент.

Дополнительные сведения см. в разделе [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) в пакете Windows SDK.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Проверяет, может ли приложение-контейнер создать внедренный объект из заданного `COleDataObject` объекта.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объект, из которого будет создаваться объекта OLE.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер можно создать внедренный объект из `COleDataObject` объекта; в противном случае — значение 0.

### <a name="remarks"></a>Примечания

`COleDataObject` Класс используется в передаче данных для извлечения данных в разных форматах из буфера обмена, путем перетаскивания, или из встроенного элемента OLE.

Контейнеры эту функцию можно использовать, чтобы решить включить или отключить их вставить, изменить и Специальная вставка команд.

Дополнительные сведения см. в статье [объекты данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Проверяет ли приложение-контейнер можно создать связанный объект из заданного `COleDataObject` объекта.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объект, из которого будет создаваться объекта OLE.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер можно создать связанный объект из `COleDataObject` объекта.

### <a name="remarks"></a>Примечания

`COleDataObject` Класс используется в передаче данных для извлечения данных в разных форматах из буфера обмена, путем перетаскивания, или из встроенного элемента OLE.

Чтобы решить включить или отключить их команды Специальная вставка и изменение связать эту функцию можно использовать контейнеры.

Дополнительные сведения см. в статье [объекты данных и источники данных (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Вызывайте эту функцию, чтобы увидеть, можно ли вставить из буфера обмена встроенного элемента OLE.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если встроенного элемента OLE, можно вставить из буфера обмена; в противном случае 0.

### <a name="remarks"></a>Примечания

Дополнительные сведения см. в разделе [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) и [OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) в пакете Windows SDK.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Вызывайте эту функцию, чтобы увидеть, является ли связанный элемент OLE можно вставить из буфера обмена.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если связанный элемент OLE, можно вставить из буфера обмена; в противном случае 0.

### <a name="remarks"></a>Примечания

Дополнительные сведения см. в разделе [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) и [OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) в пакете Windows SDK.

##  <a name="close"></a>  COleClientItem::Close

Вызывайте эту функцию, чтобы изменить состояние элемента OLE из состояния выполнения в загруженное состояние, то есть загрузки с обработчиком в памяти, но на сервере не запущена.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Параметры

*dwCloseOption*<br/>
Флаг, указывающий, при каких обстоятельствах объекта OLE сохраняется при возвращении в загруженное состояние. Он может иметь одно из следующих значений:

- Элемент OLECLOSE_SAVEIFDIRTY сохранить OLE.

- OLECLOSE_NOSAVE не сохраняйте объекта OLE.

- OLECLOSE_PROMPTSAVE предлагать пользователю на необходимость сохранения элемента OLE.

### <a name="remarks"></a>Примечания

Не влияет эта функция когда объекта OLE не выполняется.

Дополнительные сведения см. в разделе [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) в пакете Windows SDK.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Создает `COleClientItem` и добавляет его в документе-контейнере коллекции элементов документа, которая создает только объект C++ и не выполняет инициализацию OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Параметры

*pContainerDoc*<br/>
Указатель на документ контейнера, который будет содержать данный элемент. Это может быть любой [COleDocument](../../mfc/reference/coledocument-class.md) производных продуктов.

### <a name="remarks"></a>Примечания

Если передать указатель NULL, не выполняется в документе-контейнере. Необходимо явно вызывать [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Перед использованием объекта OLE, необходимо вызвать одну из следующих функций-членов создания:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Вызовите эту функцию-член для преобразования типа, указанного элемента *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Параметры

*clsidNew*<br/>
Идентификатор класса типа целевого объекта.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Это называется автоматически [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Необязательно для прямого вызова.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Вызывайте эту функцию, чтобы скопировать элемента OLE в буфер обмена.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Параметры

*bIncludeLink*<br/>
Значение TRUE, если сведения о ссылках должны копироваться в буфер обмена, позволяя связанный элемент для вставки; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Как правило эта функция вызывается при записи обработчики сообщений для копирования или вырезания команд из меню "Правка". Выбор элемента необходимо реализовать в приложение-контейнер, если вы хотите реализовать команды копирования или вырезания.

Дополнительные сведения см. в разделе [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) в пакете Windows SDK.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Вызывайте эту функцию для создания копии заданного объекта OLE.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Параметры

*pSrcItem*<br/>
Указатель на элемент OLE к дублированию.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Копия будет идентична исходный элемент. Эту функцию можно использовать для поддержки отмены операций.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Вызывайте эту функцию для создания внедренного элемента из содержимого буфера обмена.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызов этой функции из обработчик сообщений для команды "Вставить" в меню "Правка". (Команда вставки включена платформой, если [CanPaste](#canpaste) функция-член возвращает ненулевое значение.)

Дополнительные сведения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Вызывайте эту функцию для создания внедренного элемента из `COleDataObject` объекта.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объект, из которого будет создаваться объекта OLE.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Укажите операций передачи данных, таких как вставки из буфера обмена или операции перетаскивания и вставки `COleDataObject` объектов, содержащий сведения о предлагаемых серверного приложения. Обычно он используется в переопределении [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Дополнительные сведения см. в разделе [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Вызывайте эту функцию для создания встроенного элемента OLE из файла.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*lpszFileName*<br/>
Указатель на имя файла, из которого будет создаваться объекта OLE.

*CLSID*<br/>
Зарезервировано для будущего использования.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Платформа вызывает эту функцию из [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) при выборе ОК в диалоговом окне Вставка объекта при выборе создания нажмите кнопку «файл».

Дополнительные сведения см. в разделе [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Вызывайте эту функцию, чтобы создать связанный элемент на основе содержимого буфера обмена.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызов этой функции из обработчика сообщений связать команду в меню "Правка". (Команда Вставить связь включена в реализации по умолчанию [COleDocument](../../mfc/reference/coledocument-class.md) если буфер обмена содержит объект OLE, который может быть связан с.)

Дополнительные сведения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Вызывайте эту функцию, чтобы создать связанный элемент из `COleDataObject` объекта.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объект, из которого будет создаваться объекта OLE.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызовите это во время операции перетаскивания, когда пользователь укажет, что следует создать ссылку. Он может также использоваться для обработки команды Вставить, изменить. Он вызывается платформой в `COleClientItem::CreateLinkFromClipboard` и в [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) Если был выбран параметр ссылку.

Дополнительные сведения см. в разделе [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Вызывайте эту функцию для создания связанного объекта OLE из файла.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*lpszFileName*<br/>
Указатель на имя файла, из которого будет создаваться объекта OLE.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Платформа вызывает эту функцию, если пользователь выбирает ОК в диалоговом окне Вставка объекта, если выбран создания нажмите кнопку «файл» и установлен флажок «ссылку». Он вызывается из [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Дополнительные сведения см. в разделе [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Вызывайте эту функцию для создания внедренного элемента; Эта функция запускается серверное приложение, позволяющее пользователю для создания объекта OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*CLSID*<br/>
Идентификатор, который однозначно определяет тип создаваемого элемента OLE.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Платформа вызывает эту функцию, если пользователь выбирает ОК в диалоговом окне Вставка объекта, при выборе создания новой кнопки.

Дополнительные сведения см. в разделе [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Вызывайте эту функцию для создания статического элемента из содержимого буфера обмена.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Статический элемент содержит представления данных, но не машинных данных; поэтому его нельзя изменить. Обычно эта функция вызывается при [CreateFromClipboard](#createfromclipboard) происходит сбой функции-члена.

Дополнительные сведения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Вызывайте эту функцию для создания статического элемента из `COleDataObject` объекта.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Параметры

*pDataObject*<br/>
Указатель на [COleDataObject](../../mfc/reference/coledataobject-class.md) объект, из которого будет создаваться объекта OLE.

*визуализации*<br/>
Флаг, указывающий, как сервер будет отрисовки элемента OLE. Возможные значения см. в разделе [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) в пакете Windows SDK.

*cfFormat*<br/>
Задает формат данных буфер обмена должен быть помещен в кэш при создании объекта OLE.

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, используемая, если *визуализации* OLERENDER_FORMAT или OLERENDER_DRAW. Укажите значение для этого параметра только в том случае, если вы хотите указать дополнительный формат сведений, чем формат буфера обмена, определяемое *cfFormat*. Если этот параметр не указан, используются значения по умолчанию для других полей в `FORMATETC` структуры.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Статический элемент содержит представления данных, но не машинных данных; Следовательно ее недоступной для редактирования. Это по сути так же, как [CreateStaticFromClipboard](#createstaticfromclipboard) за исключением того, что статический элемент могут быть созданы из произвольный `COleDataObject`, не только из буфера обмена.

Используется в [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) при выборе статического.

Дополнительные сведения см. в разделе [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), и [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) в пакете Windows SDK.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Вызывайте эту функцию, отключение элемента OLE и освободите все связанные ресурсы.

```
void Deactivate();
```

### <a name="remarks"></a>Примечания

Объект OLE на месте для active деактивировать обычно в том случае, когда пользователь щелкает мышью на клиентскую область за пределами границ элемента. Обратите внимание, что отключение элемента OLE удалит его состояние отмены, что делает невозможным для вызова [ReactivateAndUndo](#reactivateandundo) функция-член.

Если приложение поддерживает отмены, не следует вызывать `Deactivate`; вместо этого вызовите [DeactivateUI](#deactivateui).

Дополнительные сведения см. в разделе [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в пакете Windows SDK.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Эта функция вызывается, когда пользователь делает неактивным элемент, который был активирован на месте.

```
void DeactivateUI();
```

### <a name="remarks"></a>Примечания

Эта функция восстанавливает пользовательский интерфейс приложения-контейнера в исходное состояние, скрытия любого меню и другие элементы управления, которые были созданы для активации на месте.

Эта функция не сбрасывает данные состояния отмены для элемента. Что информация хранится таким образом, чтобы [ReactivateAndUndo](#reactivateandundo) позже можно выполнить команду отмены в серверном приложении, в случае, если команда undo контейнера выбирается сразу же после деактивации элемента.

Дополнительные сведения см. в разделе [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) в пакете Windows SDK.

##  <a name="delete"></a>  COleClientItem::Delete

Вызывайте эту функцию для удаления объекта OLE из документа-контейнера.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Параметры

*bAutoDelete*<br/>
Указывает, является ли элемент удален из документа.

### <a name="remarks"></a>Примечания

Эта функция вызывает [выпуска](#release) функцией-членом, которая в свою очередь удаляет объект C++ для элемента, который окончательно удаление объекта OLE из документа. Если внедряется объекта OLE, удаляется собственных данных для элемента. Он всегда закрывает работающий сервер; Таким образом Если элемент является открыть ссылку, эта функция закрывает его.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Вызовите `DoDragDrop` функция-член для выполнения операции перетаскивания и вставки.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Параметры

*lpItemRect*<br/>
Прямоугольник элемента на экране в координатах клиентской области окна (в пикселях).

*ptOffset*<br/>
Смещение от *lpItemRect* место положение указателя мыши во время операции перетаскивания.

*bIncludeLink*<br/>
Задайте значение TRUE, если ссылка, которую необходимо скопировать данные в буфер обмена. Ему присвоено значение FALSE, если серверное приложение не поддерживает ссылки.

*dwEffects*<br/>
Определяет эффекты, которые источник перетаскивания будет разрешать в операции перетаскивания.

*lpRectStartDrag*<br/>
Указатель на прямоугольник, который определяет, где фактически начинается перетаскивание. Дополнительные сведения см. в разделе "Примечания".

### <a name="return-value"></a>Возвращаемое значение

Значение DROPEFFECT. Если это DROPEFFECT_MOVE, исходные данные должны удаляться.

### <a name="remarks"></a>Примечания

Операции перетаскивания и вставки не начинается немедленно. Он ждет, пока указатель мыши покидает прямоугольник, определяемый *lpRectStartDrag* или пока не прошли указанного числа миллисекунд. Если *lpRectStartDrag* имеет значение NULL, размер прямоугольника равно одному пикселю.

Время задержки задается параметр раздела реестра. Время задержки можно изменить, вызвав [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) или [CWinApp::WriteProfileInt](../../mfc/reference/cwinapp-class.md#writeprofileint). Если вы не укажете время задержки, используется значение по умолчанию 200 миллисекунд. Время задержки перетащите хранится следующим образом:

- Перетащите Windows NT задержка времени хранится в HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Время задержки перетащите 3.x Windows хранится в WIN. INI-файл, в разделе "[Windows}".

- Перетащите Windows 95/98 задержка времени хранится в кэшированной версии WIN. INI.

Для перетащите Дополнительные сведения о том, как задержки сведения хранятся в реестре или. INI-файл, см. в разделе [WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) в пакете Windows SDK.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Вызовите `DoVerb` для выполнения указанной команды.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Параметры

*nVerb*<br/>
Указывает команду для выполнения. Он может включать одно из следующих:

|Значение|Значение|Символ|
|-----------|-------------|------------|
|- 0|первичный глагол|OLEIVERB_PRIMARY|
|- 1|Вторичный команды|(Нет)|
|- 1|Отображаемым элементом для редактирования|OLEIVERB_SHOW|
|- 2|Изменение элемента в отдельном окне|OLEIVERB_OPEN|
|- 3|Скрытие элементов|OLEIVERB_HIDE|

Значение-1, обычно является псевдонимом для другой команды. Если открыть изменения не поддерживается, -2 имеет тот же эффект, что значение -1. Дополнительные значения, см. в разделе [функция IOleObject::DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) в пакете Windows SDK.

*pView*<br/>
Указатель на окно представления; Это используется сервером для активации на месте. Этот параметр должен иметь значение NULL, если приложение-контейнер не допускает активации на месте.

*lpMsg*<br/>
Указатель на сообщение, вызвавшее активацию элемента.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если команда была выполнена успешно; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция вызывает [активировать](#activate) функция-член для выполнения команды. Она также улавливает исключения и отображает окно сообщения для пользователя, если оно создается.

Если первичный глагол редактирования и равно нулю в *nVerb* параметра, серверное приложение запускается разрешающее элемента OLE, подлежащего редактированию. Если приложение-контейнер поддерживает активацию на месте, редактирования можно сделать на месте. Если контейнер не поддерживает активации на месте (или если указано командой Open), сервер запускается в отдельном окне и редактирование может выполняться существует. Как правило, когда приложения-контейнера двойном щелчке объекта OLE, значение первичный глагол в *nVerb* параметр определяет действие, которое пользователь может делать. Тем не менее, если сервер поддерживает только одно действие, необходимое этого действия, независимо от того, что значение указывается в *nVerb* параметра.

##  <a name="draw"></a>  COleClientItem::Draw

Эта функция вызывается для отрисовки элемента OLE в обозначенного границами прямоугольника с помощью заданного контекста устройств.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на [CDC](../../mfc/reference/cdc-class.md) объект, используемый для рисования элемента OLE.

*lpBounds*<br/>
Указатель на [CRect](../../atl-mfc-shared/reference/crect-class.md) объекта или `RECT` структура, определяющая ограничивающий прямоугольник, в котором для отрисовки элемента OLE (в логических единицах определяется контекст устройства).

*nDrawAspect*<br/>
Указывает пропорции объекта OLE элемента, то есть, как он должен отображаться. Если *nDrawAspect* равно -1, устанавливается с помощью Последняя особенность [SetDrawAspect](#setdrawaspect) используется. Дополнительные сведения о возможных значениях для этого флага см. в разделе [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Функция может использовать представлением объекта OLE, созданные в метафайл [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) функцию-член `COleServerItem`.

Обычно используется `Draw` для отображения на экране, передавая контекст устройства экрана как *pDC*. В этом случае необходимо указать только первые два параметра.

*LpBounds* параметр указывает прямоугольник в контексте целевого устройства (относительно его текущий режим сопоставления). Отрисовка может включать в себя масштабирование рисунка и может использоваться приложением-контейнером для накладывают представление, которое уменьшает отображаемому представлению и печатного изображения.

Дополнительные сведения см. в разделе [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) в пакете Windows SDK.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Возвращает представление, на котором она активироваться на месте.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на представление; в противном случае — значение NULL, если элемент не активироваться на месте.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Вызывайте эту функцию для получения размера объекта OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Параметры

*lpSize*<br/>
Указатель на `SIZE` структуры или [CSize](../../atl-mfc-shared/reference/csize-class.md) объект, который будет получать сведения о размере.

*nDrawAspect*<br/>
Указывает пропорции объекта OLE, границы которого должны быть получены. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если выполнение прошло успешно; 0, если пусто объекта OLE.

### <a name="remarks"></a>Примечания

Эта функция предоставляет те же сведения, что [GetExtent](#getextent). Тем не менее, можно вызвать `GetCachedExtent` для получения степени во время обработки другие обработчики OLE, такие как [OnChange](#onchange). Измерения — в единицах MM_HIMETRIC.

Это возможно, так как `GetCachedExtent` использует [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2) интерфейс, вместо того чтобы использовать [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject) интерфейс для получения величины данного элемента. `IViewObject2` COM-объект кэширует сведения экстента, используемые в предыдущем вызове [IViewObject::Draw](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw).

Дополнительные сведения см. в разделе [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) в пакете Windows SDK.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Возвращает идентификатор класса для элемента в память, на которые указывают *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Параметры

*pClassID*<br/>
Указатель на идентификатор типа [CLSID](/windows/desktop/com/clsid-key-hklm) для получения идентификатора класса. Сведения о CLSID см. в разделе Windows SDK.

### <a name="remarks"></a>Примечания

Идентификатор класса — это 128-разрядное число, которое однозначно определяет приложение, которое изменяет элемент.

Дополнительные сведения см. в разделе [IPersist::GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) в пакете Windows SDK.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Вызовите эту функцию для получения `COleDataSource` объект, содержащий все данные, которые будут размещаться в буфер обмена с помощью вызова [CopyToClipboard](#copytoclipboard) функция-член.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Параметры

*pDataSource*<br/>
Указатель на [COleDataSource](../../mfc/reference/coledatasource-class.md) объект, который будет получать данные, содержащиеся в элементе OLE.

*bIncludeLink*<br/>
Значение TRUE, если связать данные должны быть включены; в противном случае — значение FALSE.

*lpOffset*<br/>
Смещение курсора мыши от начала координат объекта в пикселях.

*lpSize*<br/>
Размер объекта в пикселях.

### <a name="remarks"></a>Примечания

`GetClipboardData` вызывается как реализация по умолчанию [OnGetClipboardData](#ongetclipboarddata). Переопределить `OnGetClipboardData` только в том случае, если вы хотите предложить форматы данных в дополнение к предлагаемым по `CopyToClipboard`. Поместите эти форматы в `COleDataSource` объекта до или после вызова метода `CopyToClipboard`и затем передать `COleDataSource` объект [COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) функции. Например, следует расположением элемента OLE в его документе-контейнере для его сопровождения в буфер обмена можно определить собственный формат для передачи этой информации и перевести его в `COleDataSource` перед вызовом `CopyToClipboard`.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Вызывайте эту функцию, чтобы получить указатель на документ, содержащий объекта OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на документ, содержащий объекта OLE. Значение NULL, если элемент не является частью документа.

### <a name="remarks"></a>Примечания

Этот указатель позволяет получить доступ к `COleDocument` объект, который передается в качестве аргумента для `COleClientItem` конструктор.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Вызовите `GetDrawAspect` функция-член для определения текущего «аспект», или представление, элемента.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение из перечисления DVASPECT, значения которой указаны в справочнике по [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Примечания

Аспект определяет, как элемент для отображения.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Вызывайте эту функцию для получения размера объекта OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Параметры

*lpSize*<br/>
Указатель на `SIZE` структуры или `CSize` объект, который будет получать сведения о размере.

*nDrawAspect*<br/>
Указывает пропорции объекта OLE, границы которого должны быть получены. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если выполнение прошло успешно; 0, если пусто объекта OLE.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки Microsoft Foundation Class, эта функция приводит к [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) функция-член соответствующего `COleServerItem` вызов объекта. Обратите внимание, что полученный размер может отличаться от последнее задается размер [SetExtent](#setextent) функция-член; размер, указанный параметром `SetExtent` рассматривается как предложение. Измерения — в единицах MM_HIMETRIC.

> [!NOTE]
>  Не вызывайте `GetExtent` во время обработки обработчик OLE, такие как [OnChange](#onchange). Вызовите [GetCachedExtent](#getcachedextent) вместо этого.

Дополнительные сведения см. в разделе [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) в пакете Windows SDK.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Вызовите эту функцию-член для получения дескриптора ресурс значка, связанного с сервером для определенного идентификатора CLSID.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Параметры

*CLSID*<br/>
Ссылка на идентификатор CLSID для сервера, связанного со значком.

### <a name="return-value"></a>Возвращаемое значение

Допустимый дескриптор для ресурса значка, или значение NULL, если не удается найти значок "сервер" или значок по умолчанию.

### <a name="remarks"></a>Примечания

Эта функция-член не будет запустить сервер и получение значков динамически, в том случае, даже если на сервере уже установлена. Вместо этого эта функция-член открывает исполняемый образ сервера и извлекает статический значок, связанный с сервером, как она была зарегистрирована.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Получает метафайл, используемый для рисования значка элемента.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Возвращаемое значение

Дескриптор метафайла, если выполнение прошло успешно; в противном случае имеет значение NULL.

### <a name="remarks"></a>Примечания

Если отсутствует текущий значок, возвращается значок по умолчанию. Это автоматически вызывается средой диалоговые окна MFC/OLE и обычно не вызывается напрямую.

Эта функция также вызывает [SetIconicMetafile](#seticonicmetafile) кэшировать метафайла, предназначенную для последующего использования.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Вызовите `GetInPlaceWindow` функция-член для получения указателя в окно, в котором элемент открыт для редактирования на месте.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на окно редактирования на месте элемента; Значение NULL, если элемент не является активным или его сервер недоступен.

### <a name="remarks"></a>Примечания

Эта функция должна вызываться только для элементов, которые являются локально активными.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Вызывайте эту функцию, чтобы получить текущее состояние объекта OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Возвращаемое значение

Объект `COleClientItem::ItemState` перечисленное значение, которое может принимать одно из следующих: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Сведения об этих состояниях см. в статье [контейнеров: Состояния элементов клиентов](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Примечания

Чтобы получать уведомления при изменении состояния объекта OLE, использовать [OnChange](#onchange) функция-член.

Дополнительные сведения см. в статье [контейнеров: Состояния элементов клиентов](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Возвращает код состояния последней операции OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение SCODE.

### <a name="remarks"></a>Примечания

Для функций-членов, которые возвращают Логическое значение FALSE или другой член функции, которые возвращают значение NULL `GetLastStatus` возвращает более подробные сведения об ошибках. Имейте в виду, что большинство функций-членов OLE вызывать исключения для более серьезных ошибок. Подробные сведения о интерпретацию SCODE зависит от базового вызова OLE, последнее значение SCODE.

Дополнительные сведения о SCODE, см. в разделе [структуры из кодов ошибок модели COM](/windows/desktop/com/structure-of-com-error-codes) в документации по Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Вызывайте эту функцию, чтобы получить текущее значение параметра обновление связи для объекта OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Возвращаемое значение

Одно из следующих значений:

- OLEUPDATE_ALWAYS обновите связанный элемент, когда это возможно. Этот параметр поддерживает автоматическое обновление связи переключатель в диалоговом окне ссылки.

- OLEUPDATE_ONCALL обновить связанный элемент только по запросу приложения-контейнера (если [UpdateLink](#updatelink) вызывается функция-член). Этот параметр поддерживает обновление вручную связи переключатель в диалоговом окне ссылки.

### <a name="remarks"></a>Примечания

Это является сложной операцией.

Эта функция вызывается автоматически [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) класса.

Дополнительные сведения см. в разделе [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) в пакете Windows SDK.

##  <a name="gettype"></a>  COleClientItem::GetType

Вызывайте эту функцию, чтобы определить, является внедренным или связанного объекта OLE или static.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Возвращаемое значение

Целое число без знака с одним из следующих значений:

- OT_LINK OLE элемент представляет собой ссылку.

- Внедряется элемент OT_EMBEDDED OLE.

- OT_STATIC OLE элемент является статическим, то есть он содержит только данные, не собственные данные и таким образом, не могут быть изменены.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Вызовите эту функцию для получения видимое пользователю строка, описывающая тип объекта OLE, например «Документ Word».

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Параметры

*nUserClassType*<br/>
Значение, указывающее нужный вариант строка, описывающая тип объекта OLE. Это может иметь одно из следующих значений:

- USERCLASSTYPE_FULL полный введите имя, отображаемое пользователю.

- USERCLASSTYPE_SHORT объект короткое имя (не более 15 знаков) для использования в контекстных меню и диалоговые окна Изменение связей.

- Имя USERCLASSTYPE_APPNAME обслуживания класса приложения.

*rString*<br/>
Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объект, к которому возвращается строка, описывающая тип объекта OLE.

### <a name="remarks"></a>Примечания

Часто это запись в базе данных регистрации системы.

Если полное имя запрошенного, но недоступен, вместо этого используется короткое имя. Если нет записи для типа элемента OLE не найден в базе данных регистрации, или если типы не пользователь, зарегистрированный для данного типа объекта OLE, затем тип пользователя хранятся в используется объекта OLE. Если это имя типа пользователя является пустой строкой, используется «Неизвестный объект».

Дополнительные сведения см. в разделе [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) в пакете Windows SDK.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Вызывайте эту функцию ли встроенная активация объекта OLE.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент OLE активен на месте; в противном случае 0.

### <a name="remarks"></a>Примечания

Довольно часто для выполнения различную логику в зависимости от того, редактируется ли элемент на месте. Функция проверяет, равен ли текущее состояние элемента либо `activeState` или `activeUIState`.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Вызывайте эту функцию для см. в разделе, является ли элемент OLE в актуальном состоянии.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемента OLE в актуальном состоянии; в противном случае 0.

### <a name="remarks"></a>Примечания

Связанный элемент может устареть, если его исходный документ был обновлен. Внедренный элемент, содержащий ссылки в нем можно аналогичным образом устареть. Функция выполняет проверку рекурсивного элемента OLE. Обратите внимание, что определить, является ли объект OLE устаревших может быть более дорогостоящим, чем фактически выполняет обновление.

Это называется автоматически [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) реализации.

Дополнительные сведения см. в разделе [IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) в пакете Windows SDK.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Вызывайте эту функцию, находится ли элемент OLE "грязных" (изменено с момента последнего сохранения).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент OLE является "грязным"; в противном случае 0.

### <a name="remarks"></a>Примечания

Дополнительные сведения см. в разделе [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) в пакете Windows SDK.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Вызывайте эту функцию для см. в разделе, является ли элемент OLE открытым; то есть открыт в экземпляре сервера приложения, запущенного в отдельном окне.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если открыт элемент OLE; в противном случае 0.

### <a name="remarks"></a>Примечания

Он используется, чтобы определить, когда для рисования объекта с шаблон штриховки. Открытый объект должен иметь шаблон штриховки, нарисованных на основе объекта. Можно использовать [CRectTracker](../../mfc/reference/crecttracker-class.md) объект для выполнения этой задачи.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Вызывайте эту функцию, чтобы увидеть, работает ли объекта OLE; то есть ли элемент загружен и запущен в серверном приложении.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент OLE выполняется; в противном случае 0.

### <a name="remarks"></a>Примечания

Дополнительные сведения см. в разделе [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) в пакете Windows SDK.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Вызывается платформой для уведомления элемента о том, что она просто была активирована на месте.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Примечания

Обратите внимание на то, что эта функция вызывается для указания, что сервер работает не для того, чтобы указать, что его пользовательский интерфейс был установлен в приложении-контейнере. На этом этапе объект не имеет активных пользовательский интерфейс (не `activeUIState`). Она не установлена его меню или панели инструментов. [OnActivateUI](#onactivateui) функция-член вызывается в том случае, когда это происходит.

По умолчанию реализация вызывает [OnChange](#onchange) функцию-член с OLE_CHANGEDSTATE в качестве параметра. Переопределите эту функцию для выполнения специальной обработки, когда элемент становится активным на месте.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Платформа вызывает `OnActivateUI` при объекта он перешел в активное состояние пользовательского интерфейса.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Примечания

Объект теперь установлен его панели инструментов и меню.

Реализация по умолчанию запоминает HWND сервера для использования в дальнейшем `GetServerWindow` вызовов.

##  <a name="onchange"></a>  COleClientItem::OnChange

Вызывается платформой, когда пользователь изменяет, сохраняет или закрывает объекта OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Параметры

*nCode*<br/>
Причина сервера изменен этот элемент. Он может иметь одно из следующих значений:

- OLE_CHANGED OLE внешнего вида элемента изменилось.

- Элемент OLE_SAVED OLE была сохранена.

- OLE_CLOSED OLE элемента было закрыто.

- OLE_CHANGED_STATE OLE элемент изменился из одного состояния в другое.

*dwParam*<br/>
Если *nCode* OLE_SAVED или OLE_CLOSED, этот параметр не используется. Если *nCode* является OLE_CHANGED, этот параметр указывает пропорции объекта OLE, которая была изменена. Возможные значения см. в разделе *dwParam* параметр [COleClientItem::Draw](#draw). Если *nCode* является OLE_CHANGED_STATE, этот параметр является `COleClientItem::ItemState` перечисленное значение и описание состояния ввода. Он может иметь одно из следующих значений: `emptyState`, `loadedState`, `openState`, `activeState`, или `activeUIState`.

### <a name="remarks"></a>Примечания

(Если серверное приложение написан с помощью библиотеки Microsoft Foundation Class, эта функция вызывается в ответ на `Notify` функциями-членами `COleServerDoc` или `COleServerItem`.) Реализация по умолчанию помечает документе-контейнере, как изменить значение, если *nCode* OLE_CHANGED или OLE_SAVED.

Для OLE_CHANGED_STATE, текущее состояние возвращается из [GetItemState](#getitemstate) по-прежнему будут предыдущее состояние, то есть состояния, которая была текущей до этого изменения состояния.

Переопределите эту функцию для реагирования на изменения в состоянии объекта OLE. Обычно вы обновить внешний вид элемента, стал недопустимым область, в котором отображается элемент. Вызовите реализацию базового класса в начале переопределение.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Вызывается платформой для уведомления контейнер, который во время активации по месту изменения расширения объекта OLE.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Параметры

*rectPos*<br/>
Указывает расположение элемента относительно клиентской области приложения-контейнера.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если позиции элемента успешно изменен; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию определяет новый прямоугольник видимым элемент OLE, а также вызывает [SetItemRects](#setitemrects) с новыми значениями. Реализация по умолчанию вычисляет Видимый прямоугольник для элемента и передает эти сведения на сервер.

Переопределите эту функцию, применять специальные правила для операции изменения размера или перемещения. Если приложение создано в MFC, этот вызов приводит к так, как сервер называется [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Вызывается платформой при переходе объекта OLE из активного состояния на месте ( `activeState`) в загруженное состояние, это означает, что отключения после активации на месте.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Примечания

Обратите внимание на то, что эта функция вызывается для указания, что элемент OLE закрыто, не, его пользовательский интерфейс был удален из приложения-контейнера. Когда это происходит, [OnDeactivateUI](#ondeactivateui) вызывается функция-член.

По умолчанию реализация вызывает [OnChange](#onchange) функцию-член с OLE_CHANGEDSTATE в качестве параметра. Переопределите эту функцию для выполнения специальной обработки при деактивации элемента active на месте. Например если требуется поддержка команды отмены в приложение-контейнер, можно переопределить эту функцию, чтобы отменить состояние отмены, указывающее, что последняя операция над объекта OLE, невозможно отменить после деактивации элемента.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Вызывается платформой, когда пользователь осуществляет команду отмены после активации объекта OLE на месте.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает [DeactivateUI](#deactivateui) деактивировать пользовательский интерфейс сервера. Переопределите эту функцию, при реализации команды отмены в приложение-контейнер. В переопределении вызовите версии базового класса, функции и затем Отмена последней команды выполняются в приложении.

Дополнительные сведения см. в разделе [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) в пакете Windows SDK.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Вызывается, когда пользователь делает неактивным элемент, который был активирован на месте.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Параметры

*bUndoable*<br/>
Указывает, являются ли отменяемой внесения изменений.

### <a name="remarks"></a>Примечания

Эта функция восстанавливает пользовательский интерфейс приложения-контейнера в исходное состояние, скрытия любого меню и другие элементы управления, которые были созданы для активации на месте.

Если *bUndoable* имеет значение FALSE, контейнер следует отключить команды undo, фактически удаляя состояния отмены контейнера, поскольку оно указывает, что последняя операция, выполняемой сервером является необратимой.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Вызывается платформой, когда пользователь выполняет действие, которое удаляет состояние отмены при редактировании объекта OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий. Переопределите эту функцию, при реализации команды отмены в приложение-контейнер. В переопределении отменить состояния отмены приложения-контейнера.

Если сервер был записан с помощью библиотеки Microsoft Foundation Class, сервер может вызвать эту функцию для вызываться путем вызова [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Дополнительные сведения см. в разделе [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) в пакете Windows SDK.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Вызывается платформой для получения `COleDataSource` объект, содержащий все данные, которые будут размещаться в буфер обмена с помощью вызова либо [CopyToClipboard](#copytoclipboard) или [DoDragDrop](#dodragdrop) функция-член.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Параметры

*bIncludeLink*<br/>
Задайте значение TRUE, если необходимо скопировать данные на ссылку в буфер обмена. Задайте значение FALSE, если сервер приложений не поддерживает ссылки.

*lpOffset*<br/>
Указатель на смещение указателя мыши от начала координат объекта в пикселях.

*lpSize*<br/>
Указатель на размер объекта в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Указатель на [COleDataSource](../../mfc/reference/coledatasource-class.md) объект, содержащий данные из буфера обмена.

### <a name="remarks"></a>Примечания

Реализация по умолчанию эта функция вызывает [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

Платформа вызывает `OnGetClipRect` функция-член для получения координат прямоугольника обрезки элемента, который редактируется на месте.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Параметры

*rClipRect*<br/>
Указатель на объект класса [CRect](../../atl-mfc-shared/reference/crect-class.md) , будет содержать координаты прямоугольника обрезки элемента.

### <a name="remarks"></a>Примечания

Координаты указываются в пикселях относительно клиентской области окна приложения контейнера.

Реализация по умолчанию просто возвращает клиентскую область представления, на котором элемент активен на месте.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

Платформа вызывает `OnGetItemPosition` функция-член для получения координат элемента, который редактируется на месте.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Параметры

*rPosition*<br/>
Ссылка на [CRect](../../atl-mfc-shared/reference/crect-class.md) объект, который будет содержать координаты положения элемента.

### <a name="remarks"></a>Примечания

Координаты указываются в пикселях относительно клиентской области окна приложения контейнера.

Реализация по умолчанию этой функции не выполняет никаких действий. Приложения, поддерживающие редактирование на месте требуют его реализации.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Вызывается платформой при активации элемента на месте.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Параметры

*ppMainFrame*<br/>
Указатель на указатель фрейма главного окна.

*ppDocFrame*<br/>
Указатель на указатель на окне фрейма документа.

*lpFrameInfo*<br/>
Указатель на [oleinplaceframeinfo, КОТОРУЮ](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) структуры, который будет получать сведения о кадре окна.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Эта функция используется для получения сведений о родительском окне объекта OLE.

Если контейнер MDI-приложения, реализация по умолчанию возвращает указатель на [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) объекта в *ppMainFrame* и указатель на активный [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)объекта в *ppDocFrame*. Если контейнер является приложением SDI, реализация по умолчанию возвращает указатель на [CFrameWnd](../../mfc/reference/cframewnd-class.md) объекта в *ppMainFrame* и возвращает значение NULL в *ppDocFrame*. Реализация по умолчанию, а также заполняет члены *lpFrameInfo*.

Переопределите эту функцию только в том случае, если реализация по умолчанию не подходит для приложения; Например, если приложение имеет парадигма пользовательского интерфейса, которая отличается от SDI или MDI. Существует расширенная переопределяемый.

Дополнительные сведения см. в разделе [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) и [oleinplaceframeinfo, КОТОРУЮ](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) структуры в пакете Windows SDK.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Вызывается платформой при активации на месте для вставки меню приложения-контейнера в пустое меню.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указывает на пустое меню.

*lpMenuWidths*<br/>
Указывается массив значений шесть LONG, указывающее, сколько меню в каждом из следующих групп меню: Файл, изменить, контейнер, объект, в окне справки. Приложение-контейнер отвечает за файл, контейнер и окно группы меню, соответствующие элементам, 0, 2 и 4 этого массива.

### <a name="remarks"></a>Примечания

Это меню, затем передается на сервер, который вставляет свой собственный меню, создание составного меню. Эту функцию можно вызывать многократно для сборки несколько составного меню.

Реализация по умолчанию вставляет в *pMenuShared* меню контейнера на месте, то есть группы меню файл, контейнер и окна. [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) используется для задания этого ресурса меню. Реализация по умолчанию также устанавливает соответствующие значения для элементов, 0, 2 и 4 в *lpMenuWidths*, в зависимости от ресурса меню. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для сопоставления ресурсов с помощью типов документов. Если вы переопределите эту функцию, необходимо также переопределить [OnSetMenu](#onsetmenu) и [OnRemoveMenus](#onremovemenus). Существует расширенная переопределяемый.

Дополнительные сведения см. в разделе [IOleInPlaceFrame::InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) в пакете Windows SDK.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Вызывается платформой для удаления из указанного составного меню меню контейнера, при завершении активации на месте.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указывает на составного меню, созданный путем вызова [OnInsertMenus](#oninsertmenus) функция-член.

### <a name="remarks"></a>Примечания

Реализация по умолчанию удаляет из *pMenuShared* меню контейнера на месте, которая является, группы меню файл, контейнер и окна. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения; Например, если приложение не использует шаблоны документов для сопоставления ресурсов с помощью типов документов. Если вы переопределите эту функцию, возможно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnSetMenu](#onsetmenu) также. Существует расширенная переопределяемый.

Подменю на *pMenuShared* может совместно использоваться более одного составного меню, если сервер несколько раз вызывается `OnInsertMenus`. Поэтому не следует удалять вложенные в переопределении `OnRemoveMenus`; только следует отсоединять их.

Дополнительные сведения см. в разделе [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) в пакете Windows SDK.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Вызывается платформой для прокрутки элемента OLE в ответ на запросы с сервера.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Параметры

*sizeExtent*<br/>
Указывает расстояния, в пикселях, необходимо выполнить прокрутку в x и y направлениях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент был прокручивать; 0, если не выполнить прокрутку элемента.

### <a name="remarks"></a>Примечания

Например если пользователь перемещается за пределы видимой области при выполнении редактирование на месте элемента OLE является частично видимой, эта функция вызывается сохранение курсор видимыми. Реализация по умолчанию не выполняет никаких действий. Переопределите эту функцию для прокрутки элемента на заданную величину. Обратите внимание на то, что в результате прокрутки, видимую часть объекта OLE может меняться. Вызовите [SetItemRects](#setitemrects) для обновления элемента Видимый прямоугольник.

Дополнительные сведения см. в разделе [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) в пакете Windows SDK.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Вызвано структурой в два раза при активации и окончания; в первый раз, чтобы установить составного меню и во второй раз (с *holemenu* равно NULL) чтобы удалить его.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Параметры

*pMenuShared*<br/>
Указатель на составного меню, созданный путем вызова [OnInsertMenus](#oninsertmenus) функция-член и `InsertMenu` функции.

*holemenu*<br/>
Дескриптор меню дескриптор, возвращенный `OleCreateMenuDescriptor` функции, или значение NULL, если диспетчеризации код для удаления.

*hwndActiveObject*<br/>
Дескриптор окна редактирования для объекта OLE. Это окно, которое будет принимать команды редактирования из объекта OLE.

### <a name="remarks"></a>Примечания

Реализация по умолчанию устанавливает или удаляет составного меню, а затем вызывает [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor) функции для установки или удаления диспетчеризации кода. Переопределите эту функцию, если реализация по умолчанию не подходит для вашего приложения. Если вы переопределите эту функцию, возможно, следует переопределить [OnInsertMenus](#oninsertmenus) и [OnRemoveMenus](#onremovemenus) также. Существует расширенная переопределяемый.

Дополнительные сведения см. в разделе [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor), и [IOleInPlaceFrame::SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) в пакете Windows SDK.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Вызвано структурой для отображения и скрытия панели элементов управления приложения-контейнера.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Параметры

*pFrameWnd*<br/>
Указатель на фрейм окна приложения-контейнера. Это может быть фрейма главного окна или дочернего окна MDI.

*bShow*<br/>
Указывает, панелями элементов управления, следует ли отображать и скрывать.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов функции приводит к изменению в состоянии панели элементов управления; 0, если вызов не изменяются или *pFrameWnd* не указывает на контейнер окна фрейма.

### <a name="remarks"></a>Примечания

Эта функция возвращает 0, если панелей элементов управления уже находятся в состоянии, указанном *bShow.* Такое может произойти, например, если скрыты панели элементов управления и *bShow* имеет значение FALSE.

Реализация по умолчанию удаляет панели инструментов из окна фрейма верхнего уровня.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Вызывается платформой для отображения объекта OLE, делая их полностью видимыми во время редактирования.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Примечания

Он используется, когда приложение-контейнер поддерживает ссылки на внедренные элементы (то есть, в том случае, если производного от класса документа [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Эта функция вызывается во время активации на месте или когда объекта OLE источник ссылки, и пользователь хочет изменить его. Реализация по умолчанию активирует первое представление в документе-контейнере. Переопределите эту функцию, чтобы прокрутить документ, так что стали видны объекта OLE.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Вызывается платформой при активации на месте для обновления заголовка фрейма окна.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция успешно обновлен заголовок кадра, в противном случае — нуль.

### <a name="remarks"></a>Примечания

Реализация по умолчанию не изменяет заголовок окна фрейма. Переопределите эту функцию, если требуется заголовок другой кадр для вашего приложения, например " *серверного приложения* - *элемент* в *имя_документа*" (как, например «Microsoft Excel — электронной таблицы в отчете. DOC»). Существует расширенная переопределяемый.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Вызывайте эту функцию, чтобы повторно активировать элемент OLE и отменяет последнюю операцию, выполненное пользователем во время редактирования на месте.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если приложение-контейнер поддерживает команды undo, вызывайте эту функцию, если пользователь выбирает команду отмены сразу же после деактивации объекта OLE.

Если серверное приложение написан с помощью библиотеки классов Microsoft Foundation, эта функция приводит к серверу для вызова [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Дополнительные сведения см. в разделе [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) в пакете Windows SDK.

##  <a name="release"></a>  COleClientItem::Release

Вызывайте эту функцию, чтобы очистить ресурсы, используемые объектом OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Параметры

*dwCloseOption*<br/>
Флаг, указывающий, при каких обстоятельствах объекта OLE сохраняется при возвращении в загруженное состояние. Список возможных значений см. в разделе [COleClientItem::Close](#close).

### <a name="remarks"></a>Примечания

`Release` вызывается `COleClientItem` деструктор.

Дополнительные сведения см. в разделе [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) в пакете Windows SDK.

##  <a name="reload"></a>  COleClientItem::Reload

Закрывает и перезагружает элемента.

```
BOOL Reload();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Вызовите `Reload` функции после активации элемент как элемент другого типа с помощью вызова [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Запускает приложение, связанное с данным элементом.

```
void Run();
```

### <a name="remarks"></a>Примечания

Вызовите `Run` функция-член для запуска приложения сервера перед активацией элемента. Это делается автоматически [активировать](#activate) и [DoVerb](#doverb), поэтому он обычно нет необходимости для вызова этой функции. Вызывайте эту функцию, если это необходимо для запуска сервера, чтобы задать атрибут элемента, например [SetExtent](#setextent), перед выполнением [DoVerb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Вызовите `SetDrawAspect` функция-член для задания «аспект», или представление, элемента.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Параметры

*nDrawAspect*<br/>
Значение из перечисления DVASPECT. Этот параметр может принимать одно из следующих значений:

- Элемент DVASPECT_CONTENT представлен таким образом, что он может отображаться в виде внедренного объекта внутри контейнера.

- DVASPECT_THUMBNAIL будет отображен в представлении «эскиз», чтобы она может отображаться в средствах просмотра.

- Элемент DVASPECT_ICON представлен значком.

- Элемент DVASPECT_DOCPRINT представляется так, как если бы печати с помощью команды "Печать" меню "файл".

### <a name="remarks"></a>Примечания

Аспект указывает, как элемент должен быть обработан [рисования](#draw) при значение по умолчанию для этой функции *nDrawAspect* используется аргумент.

Эта функция вызывается автоматически, Смена значка (и других диалоговых окон, которые напрямую вызывают изменить значок диалогового окна) для включения аспект преобразованного в значок отображения при по запросу пользователя.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Вызывайте эту функцию, чтобы указать, сколько места доступно для объекта OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Параметры

*size*<br/>
Объект [CSize](../../atl-mfc-shared/reference/csize-class.md) , содержащий сведения о размере.

*nDrawAspect*<br/>
Указывает пропорции объекта OLE, границы которого являются устанавливаемое значение. Возможные значения см. в разделе [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки Microsoft Foundation Class, это приводит к [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) функция-член соответствующего `COleServerItem` вызов объекта. Элемент OLE затем соответствующим образом настроить его отображение. Должен быть в единицах MM_HIMETRIC. Эта функция вызывается при изменении пользователем размера объекта OLE, или если поддерживают некоторую форму согласования макета.

Дополнительные сведения см. в разделе [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) в пакете Windows SDK.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Вызывайте эту функцию, чтобы указать имя приложения-контейнера и имя контейнера для встроенного элемента OLE.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Параметры

*lpszHost*<br/>
Указатель на видимое пользователю имя приложения-контейнера.

*lpszHostObj*<br/>
Указатель на строку идентификационных контейнер, содержащий объекта OLE.

### <a name="remarks"></a>Примечания

Если серверное приложение было написано с помощью библиотеки Microsoft Foundation Class, эта функция вызывает [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) функцию-член `COleServerDoc` документа, содержащего объекта OLE. Эта информация используется в заголовки окон, при редактировании объекта OLE. Каждый раз, когда загружается контейнера документа, платформа вызывает эту функцию для всех элементов OLE в документе. `SetHostNames` применяется только для встроенных элементов. Эта функция вызывается каждый раз, когда активируется встроенного элемента OLE для редактирования необязателен.

Это также называется автоматически с именем приложения и имя документа при загрузке объекта или при сохранении файла под другим именем. Соответственно не обычно требуется вызывать эту функцию напрямую.

Дополнительные сведения см. в разделе [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) в пакете Windows SDK.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Кэширует метафайла, используемый для рисования значка элемента.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Параметры

*hMetaPict*<br/>
Дескриптор метафайла, используемый для рисования значка элемента.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Используйте [GetIconicMetafile](#geticonicmetafile) извлекаемого метафайла.

*HMetaPict* параметр копируется в элемент; таким образом, *hMetaPict* должен быть освобожден вызывающим.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Вызовите эту функцию для задания ограничивающего прямоугольника или Видимый прямоугольник элемента OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*lprcPosRect*<br/>
Указатель на прямоугольник, содержащий границы объекта OLE, относительно родительского окна в координатах клиентской области окна.

*lprcClipRect*<br/>
Указатель на прямоугольник, содержащий границы видимой части объекта OLE, относительно родительского окна в координатах клиентской области окна.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если выполнение прошло успешно; в противном случае — 0.

### <a name="remarks"></a>Примечания

Эта функция вызывается реализация по умолчанию [OnChangeItemPosition](#onchangeitemposition) функция-член. Эту функцию следует вызывать каждый раз, когда положения или видимую часть OLE элемент изменений. Обычно это означает, что его вызывать из вашего представления [OnSize](../../mfc/reference/cwnd-class.md#onsize) и [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) функций-членов.

Дополнительные сведения см. в разделе [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) в пакете Windows SDK.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Вызывайте эту функцию для задания параметра обновление связи для представления указанного связанного элемента.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Параметры

*dwUpdateOpt*<br/>
Значение параметра обновление связи для этого элемента. Это значение должно быть одно из следующих значений:

- OLEUPDATE_ALWAYS обновите связанный элемент, когда это возможно. Этот параметр поддерживает автоматическое обновление связи переключатель в диалоговом окне ссылки.

- OLEUPDATE_ONCALL обновить связанный элемент только по запросу приложения-контейнера (если [UpdateLink](#updatelink) вызывается функция-член). Этот параметр поддерживает обновление вручную связи переключатель в диалоговом окне ссылки.

### <a name="remarks"></a>Примечания

Как правило не изменяйте параметры обновления, выбранный пользователем в диалоговом окне ссылки.

Дополнительные сведения см. в разделе [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) в пакете Windows SDK.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Вызывайте эту функцию, чтобы изменить печати целевого устройства для этого элемента.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указатель на [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) структуры данных, который содержит сведения о новых печати целевого устройства. Может иметь значение NULL.

*PPD*<br/>
Указатель на [PRINTDLG](https://msdn.microsoft.com/library/windows/desktop/ms646940) структуры данных, который содержит сведения о новых печати целевого устройства. Может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция обновляет печати целевое устройство для элемента, но не обновляет кэш презентации. Чтобы обновить кэш представления для элемента, вызовите [UpdateLink](#updatelink).

Аргументы для этой функции содержат сведения, система OLE использует для идентификации целевого устройства. `PRINTDLG` Структура содержит сведения, которые Windows использует для инициализации общее диалоговое окно печати. После пользователь закрывает диалоговое окно, Windows возвращает сведения о выбранных элементов для пользователя в этой структуре. `m_pd` Членом [CPrintDialog](../../mfc/reference/cprintdialog-class.md) объект `PRINTDLG` структуры.

Дополнительные сведения об этой структуре см. в разделе [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) в пакете Windows SDK.

Дополнительные сведения см. в разделе [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) в пакете Windows SDK.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Вызывайте эту функцию для немедленного обновления данных для презентации объекта OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция выполнена успешно; в противном случае — значение 0.

### <a name="remarks"></a>Примечания

Для связанных элементов функция не обнаруживает источник ссылки для получения новой презентации для объекта OLE. Этот процесс может потребоваться запуск одного или нескольких серверных приложений, которые может занимать много времени. Для внедренных элементов функция применяется рекурсивно, проверка, содержит ли внедренный элемент ссылки, которые могут быть устаревшими и их обновления. Пользователь может также вручную обновить отдельные ссылки, с помощью диалогового окна ссылки.

Дополнительные сведения см. в разделе [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) в пакете Windows SDK.

## <a name="see-also"></a>См. также

[Пример MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Пример MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[Класс CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс COleServerItem](../../mfc/reference/coleserveritem-class.md)
