---
description: 'Дополнительные сведения о: Коледбрекордвиев Class'
title: Класс Коледбрекордвиев
ms.date: 11/04/2016
f1_keywords:
- COleDBRecordView
- AFXOLEDB/COleDBRecordView
- AFXOLEDB/COleDBRecordView::COleDBRecordView
- AFXOLEDB/COleDBRecordView::OnGetRowset
- AFXOLEDB/COleDBRecordView::OnMove
helpviewer_keywords:
- COleDBRecordView [MFC], COleDBRecordView
- COleDBRecordView [MFC], OnGetRowset
- COleDBRecordView [MFC], OnMove
ms.assetid: 98612427-c4c9-4760-b7e1-85b17448add9
ms.openlocfilehash: bce03a482aff558ed6d22c7720ff74f304a9214f
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97227316"
---
# <a name="coledbrecordview-class"></a>Класс Коледбрекордвиев

Представление, которое отображает записи базы данных в элементах управления.

## <a name="syntax"></a>Синтаксис

```
class COleDBRecordView : public CFormView
```

## <a name="members"></a>Члены

### <a name="protected-constructors"></a>Защищенные конструкторы

|Имя|Описание|
|----------|-----------------|
|[Коледбрекордвиев:: Коледбрекордвиев](#coledbrecordview)|Формирует объект `COleDBRecordView`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Коледбрекордвиев:: Онжетровсет](#ongetrowset)|Возвращает стандартное значение HRESULT.|
|[Коледбрекордвиев:: OnMove](#onmove)|Обновляет текущую запись (если "грязную") в источнике данных, а затем переходит к указанной записи (Следующая, Предыдущая, первая или последняя).|

## <a name="remarks"></a>Комментарии

Представление является представлением формы, которое напрямую подключено к `CRowset` объекту. Представление создается на основе ресурса шаблона диалогового окна и отображает поля `CRowset` объекта в элементах управления шаблона диалогового окна. `COleDBRecordView` `CRowset` Для автоматизации перемещения данных между элементами управления в форме и полями набора строк объект использует диалоговое окно обмена данными (DDX) и встроенную функцию навигации в. `COleDBRecordView` также предоставляет реализацию по умолчанию для перехода к первой, следующей, предыдущей или последней записи и интерфейс для обновления записи в данный момент в представлении.

С помощью функций DDX можно `COleDbRecordView` получать данные непосредственно из набора записей базы данных и отображать их в элементе управления диалогового окна. Следует использовать `DDX_*` методы (такие как `DDX_Text` ), а не `DDX_Field*` функции (такие как `DDX_FieldText` ) с `COleDbRecordView` . `DDX_FieldText` не будет работать с, `COleDbRecordView` так как `DDX_FieldText` принимает дополнительный аргумент типа `CRecordset*` (для `CRecordView` ) или `CDaoRecordset*` (для `CDaoRecordView` ).

> [!NOTE]
> Если вы работаете с классами объектов доступа к данным (DAO), а не OLE DB классами шаблона потребителя, используйте вместо этого класс [CDaoRecordView](../../mfc/reference/cdaorecordview-class.md) . Дополнительные сведения см. в статье [Общие сведения о программировании баз данных](../../data/data-access-programming-mfc-atl.md).

`COleDBRecordView` отслеживает расположение пользователя в наборе строк, чтобы представление записи может обновить пользовательский интерфейс. Когда пользователь переходит к концу набора строк, представление записей отключает объекты пользовательского интерфейса, такие как элементы меню или кнопки панели инструментов, для перемещения дальше в том же направлении.

Дополнительные сведения о классах наборов строк см. в статье [использование OLE DB шаблонов потребителей](../../data/oledb/ole-db-consumer-templates-cpp.md) .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`COleDBRecordView`

## <a name="requirements"></a>Требования

**Заголовок:** афксоледб. h

## <a name="coledbrecordviewcoledbrecordview"></a><a name="coledbrecordview"></a> Коледбрекордвиев:: Коледбрекордвиев

Формирует объект `COleDBRecordView`.

```
COleDBRecordView(LPCTSTR lpszTemplateName);
COleDBRecordView(UINT nIDTemplate);
```

### <a name="parameters"></a>Параметры

*лпсзтемплатенаме*<br/>
Содержит строку, завершающуюся нулем, которая является именем ресурса шаблона диалогового окна.

*нидтемплате*<br/>
Содержит ИДЕНТИФИКАЦИОНный номер ресурса шаблона диалогового окна.

### <a name="remarks"></a>Комментарии

При создании объекта типа, производного от `COleDBRecordView` , вызовите один из конструкторов для создания объекта представления и укажите ресурс диалогового окна, на котором основано представление. Ресурс можно указать по имени (передать строку в качестве аргумента в конструктор) или по его ИДЕНТИФИКАТОРу (передайте в качестве аргумента целое число без знака).

> [!NOTE]
> Производный класс *должен* предоставить собственный конструктор. В конструкторе вызовите конструктор `COleDBRecordView::COleDBRecordView` с именем ресурса или идентификатором в качестве аргумента.

## <a name="coledbrecordviewongetrowset"></a><a name="ongetrowset"></a> Коледбрекордвиев:: Онжетровсет

Возвращает маркер для объекта **crowset<>** , связанного с представлением записей.

```
virtual CRowset<>* OnGetRowset() = 0;
```

### <a name="return-value"></a>Возвращаемое значение

Стандартное значение HRESULT.

### <a name="remarks"></a>Комментарии

Необходимо переопределить эту функцию-член для создания или получения объекта набора строк и возврата к нему маркера. Если вы объявили класс представления записей с помощью ClassWizard, мастер запишет для вас переопределение по умолчанию. Реализация по умолчанию ClassWizard Возвращает обработчик набора строк, хранящийся в представлении записей, если он существует. В противном случае он конструирует объект набора строк типа, указанного с помощью ClassWizard, и вызывает его `Open` функцию-член для открытия таблицы или выполнения запроса, а затем возвращает в объект маркер.

> [!NOTE]
> Ранее в MFC 7,0 `OnGetRowset` возвращен указатель на `CRowset` . Если у вас есть код, который вызывает `OnGetRowset` , необходимо изменить возвращаемый тип на преобразованный класс **CRowset<>**.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDatabase#38](../../mfc/codesnippet/cpp/coledbrecordview-class_1.cpp)]

Дополнительные сведения и примеры см. в разделе [представления записей статьи: использование представления записей](../../data/using-a-record-view-mfc-data-access.md).

## <a name="coledbrecordviewonmove"></a><a name="onmove"></a> Коледбрекордвиев:: OnMove

Перемещает к другой записи в наборе строк и отображает ее поля в элементах управления представления записей.

```
virtual BOOL OnMove(UINT nIDMoveCommand);
```

### <a name="parameters"></a>Параметры

*нидмовекомманд*<br/>
Одно из следующих стандартных значений идентификатора команды:

- ID_RECORD_FIRST — переход к первой записи в наборе записей.

- ID_RECORD_LAST — переход к последней записи в наборе записей.

- ID_RECORD_NEXT — переход к следующей записи в наборе записей.

- ID_RECORD_PREV — переход к предыдущей записи в наборе записей.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если перемещение прошло успешно; в противном случае — 0, если запрос на перемещение был отклонен.

### <a name="remarks"></a>Комментарии

Реализация по умолчанию вызывает соответствующую `Move` функцию члена объекта, `CRowset` связанного с представлением записи.

По умолчанию `OnMove` обновляет текущую запись в источнике данных, если пользователь изменил его в представлении записей.

Мастер приложений создает ресурс меню с элементами меню первая запись, последняя запись, следующая запись и Предыдущая запись. При выборе параметра закрепляемая панель инструментов Мастер приложений также создает панель инструментов с кнопками, соответствующими этим командам.

Если переместиться за последнюю запись в наборе записей, то в представлении записей будет отображаться последняя запись. Если перейти назад после первой записи, то в представлении записей будет отображаться первая запись.

## <a name="see-also"></a>См. также раздел

[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)
