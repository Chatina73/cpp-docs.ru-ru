---
description: 'Дополнительные сведения о: Кпринтдиалог Class'
title: Класс Кпринтдиалог
ms.date: 11/04/2016
f1_keywords:
- CPrintDialog
- AFXDLGS/CPrintDialog
- AFXDLGS/CPrintDialog::CPrintDialog
- AFXDLGS/CPrintDialog::CreatePrinterDC
- AFXDLGS/CPrintDialog::DoModal
- AFXDLGS/CPrintDialog::GetCopies
- AFXDLGS/CPrintDialog::GetDefaults
- AFXDLGS/CPrintDialog::GetDeviceName
- AFXDLGS/CPrintDialog::GetDevMode
- AFXDLGS/CPrintDialog::GetDriverName
- AFXDLGS/CPrintDialog::GetFromPage
- AFXDLGS/CPrintDialog::GetPortName
- AFXDLGS/CPrintDialog::GetPrinterDC
- AFXDLGS/CPrintDialog::GetToPage
- AFXDLGS/CPrintDialog::PrintAll
- AFXDLGS/CPrintDialog::PrintCollate
- AFXDLGS/CPrintDialog::PrintRange
- AFXDLGS/CPrintDialog::PrintSelection
- AFXDLGS/CPrintDialog::m_pd
helpviewer_keywords:
- CPrintDialog [MFC], CPrintDialog
- CPrintDialog [MFC], CreatePrinterDC
- CPrintDialog [MFC], DoModal
- CPrintDialog [MFC], GetCopies
- CPrintDialog [MFC], GetDefaults
- CPrintDialog [MFC], GetDeviceName
- CPrintDialog [MFC], GetDevMode
- CPrintDialog [MFC], GetDriverName
- CPrintDialog [MFC], GetFromPage
- CPrintDialog [MFC], GetPortName
- CPrintDialog [MFC], GetPrinterDC
- CPrintDialog [MFC], GetToPage
- CPrintDialog [MFC], PrintAll
- CPrintDialog [MFC], PrintCollate
- CPrintDialog [MFC], PrintRange
- CPrintDialog [MFC], PrintSelection
- CPrintDialog [MFC], m_pd
ms.assetid: 5bdb2424-adf8-433d-a97c-df11a83bc4e4
ms.openlocfilehash: f662f3d2a522dc3a53ea887bb1031e9431df2e3a
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97343405"
---
# <a name="cprintdialog-class"></a>Класс Кпринтдиалог

Инкапсулирует службы, предоставляемые стандартным диалоговым окном Windows для печати.

## <a name="syntax"></a>Синтаксис

```
class CPrintDialog : public CCommonDialog
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кпринтдиалог:: Кпринтдиалог](#cprintdialog)|Формирует объект `CPrintDialog`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кпринтдиалог:: Креатепринтердк](#createprinterdc)|Создает контекст печатающего устройства, не отображая диалоговое окно Печать.|
|[Кпринтдиалог::D Омодал](#domodal)|Отображает диалоговое окно и позволяет пользователю сделать выбор.|
|[Кпринтдиалог:: выполняет копирование](#getcopies)|Возвращает количество запрошенных копий.|
|[Кпринтдиалог:: параметры по умолчанию](#getdefaults)|Извлекает значения по умолчанию для устройств без отображения диалогового окна.|
|[Кпринтдиалог:: Жетдевиценаме](#getdevicename)|Извлекает имя выбранного в данный момент принтера.|
|[Кпринтдиалог::](#getdevmode)|Извлекает `DEVMODE` структуру.|
|[Кпринтдиалог:: GetDriverName](#getdrivername)|Извлекает имя выбранного в данный момент драйвера принтера.|
|[Кпринтдиалог:: Жетфромпаже](#getfrompage)|Извлекает начальную страницу диапазона печати.|
|[Кпринтдиалог:: Жетпортнаме](#getportname)|Извлекает имя выбранного в данный момент порта принтера.|
|[Кпринтдиалог:: Жетпринтердк](#getprinterdc)|Извлекает маркер контекста устройства принтера.|
|[Кпринтдиалог:: Жеттопаже](#gettopage)|Извлекает конечную страницу диапазона печати.|
|[Кпринтдиалог::P Ринталл](#printall)|Определяет, следует ли печатать все страницы документа.|
|[Кпринтдиалог::P Ринтколлате](#printcollate)|Определяет, запрашиваются ли копии по копиям.|
|[Кпринтдиалог::P Ринтранже](#printrange)|Определяет, следует ли печатать только указанный диапазон страниц.|
|[Кпринтдиалог::P Ринтселектион](#printselection)|Определяет, следует ли печатать только выбранные в данный момент элементы.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Кпринтдиалог:: m_pd](#m_pd)|Структура, используемая для настройки `CPrintDialog` объекта.|

## <a name="remarks"></a>Комментарии

Общие диалоговые окна печати предоставляют простой способ реализации диалоговых окон печати и печати в соответствии со стандартами Windows.

> [!NOTE]
> `CPrintDialogEx`Класс инкапсулирует службы, предоставляемые страницей свойств печати Windows. Дополнительные сведения см. в обзоре [кпринтдиаложекс](../../mfc/reference/cprintdialogex-class.md) .

`CPrintDialog`заменяется функцией [кпажесетупдиалог](../../mfc/reference/cpagesetupdialog-class.md), которая предназначена для предоставления общего диалогового окна для настройки печати и настройки страницы.

Вы можете использовать платформу для обработки многих аспектов процесса печати приложения. В этом случае платформа автоматически отображает общее диалоговое окно Windows для печати. Кроме того, платформа может выполнять печать для приложения, но переопределять общее диалоговое окно печати с помощью собственного диалогового окна печати. Дополнительные сведения об использовании платформы для работы с задачами печати см. в статье [Печать](../../mfc/printing.md).

Если вы хотите, чтобы приложение обрабатывал печать без участия в платформе, можно использовать `CPrintDialog` класс "как есть" с предоставленным конструктором или создать собственный класс диалогового окна из `CPrintDialog` и написать конструктор в соответствии с вашими потребностями. В любом случае эти диалоговые окна будут вести себя так же, как стандартные диалоговые окна MFC, поскольку они являются производными от класса `CCommonDialog` .

Чтобы использовать `CPrintDialog` объект, сначала создайте объект с помощью `CPrintDialog` конструктора. После создания диалогового окна можно задать или изменить любые значения в структуре [m_pd](#m_pd) , чтобы инициализировать значения элементов управления диалогового окна. `m_pd`Структура имеет тип [принтдлг](/windows/win32/api/commdlg/ns-commdlg-printdlga). Дополнительные сведения об этой структуре см. в Windows SDK.

Если вы не предоставляете собственные дескрипторы `m_pd` для `hDevMode` `hDevNames` членов и, не забудьте вызвать функцию Windows `GlobalFree` для этих дескрипторов после завершения работы с диалоговым окном. При использовании реализации настройки печати платформы, предоставляемой `CWinApp::OnFilePrintSetup` , не нужно освобождать эти дескрипторы. Дескрипторы поддерживаются `CWinApp` и освобождаются `CWinApp` деструктором. Эти дескрипторы необходимо освобождать только при использовании `CPrintDialog` автономных.

После инициализации элементов управления диалогового окна вызовите `DoModal` функцию члена, чтобы открыть диалоговое окно и позволить пользователю выбрать параметры печати. `DoModal` Возвращает значение, указывающее, выбрал пользователь кнопку ОК (ИДОК) или Отмена (ИДКАНЦЕЛ).

Если `DoModal` функция ВОЗВРАЩАЕТ идок, `CPrintDialog` для получения входных данных пользователем можно использовать одну из функций члена.

`CPrintDialog::GetDefaults`Функция-член полезна для получения текущих значений по умолчанию для принтера без отображения диалогового окна. Эта функция члена не требует вмешательства пользователя.

С помощью функции Windows можно `CommDlgExtendedError` определить, произошла ли ошибка во время инициализации диалогового окна, и получить дополнительные сведения об ошибке. Дополнительные сведения об этой функции см. в Windows SDK.

`CPrintDialog` зависит от файла COMMDLG.DLL, поставляемого с Windows версии 3,1 и более поздних версий.

Чтобы настроить диалоговое окно, создайте производный класс от `CPrintDialog` , предоставьте пользовательский шаблон диалогового окна и добавьте карту сообщений для обработки сообщений уведомлений из расширенных элементов управления. Все необработанные сообщения должны передаваться в базовый класс. Настройка функции-обработчика не является обязательной.

Для обработки одного и того же сообщения по-разному в зависимости от того, является ли диалоговое окно печатью или настройкой печати, необходимо создать класс для каждого диалогового окна. Также необходимо переопределить `AttachOnSetup` функцию Windows, которая обрабатывает создание нового диалогового окна, когда в диалоговом окне Печать выбрана кнопка Настройка печати.

Дополнительные сведения об использовании см `CPrintDialog` . в разделе [Общие классы диалоговых окон](../../mfc/common-dialog-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CPrintDialog`

## <a name="requirements"></a>Требования

**Заголовок:** афксдлгс. h

## <a name="cprintdialogcprintdialog"></a><a name="cprintdialog"></a> Кпринтдиалог:: Кпринтдиалог

Создание объекта диалогового окна печати или настройки печати Windows.

```
CPrintDialog(
    BOOL bPrintSetupOnly,
    DWORD dwFlags = PD_ALLPAGES | PD_USEDEVMODECOPIES | PD_NOPAGENUMS | PD_HIDEPRINTTOFILE | PD_NOSELECTION,
    CWnd* pParentWnd = NULL);
```

### <a name="parameters"></a>Параметры

*бпринтсетупонли*<br/>
Указывает, отображается ли стандартное диалоговое окно печати Windows или диалоговое окно «Настройка печати». Задайте для этого параметра значение TRUE, чтобы отобразить стандартное диалоговое окно настройки печати Windows. Задайте для него значение FALSE, чтобы отобразить диалоговое окно Печать Windows. Если *бпринтсетупонли* имеет значение false, то в диалоговом окне Печать по-прежнему отображается кнопка Параметры печати.

*dwFlags*<br/>
Один или несколько флагов, которые можно использовать для настройки параметров диалогового окна в сочетании с помощью побитового оператора или. Например, флаг PD_ALLPAGES устанавливает диапазон печати по умолчанию для всех страниц документа. Дополнительные сведения об этих флагах см. в описании структуры [принтдлг](/windows/win32/api/commdlg/ns-commdlg-printdlga) в Windows SDK.

*ппарентвнд*<br/>
Указатель на родительский узел или окно-владелец диалогового окна.

### <a name="remarks"></a>Комментарии

Эта функция члена конструирует только объект. Используйте `DoModal` функцию члена для вывода диалогового окна.

Обратите внимание, что при вызове конструктора с параметром *бпринтсетупонли* , для которого ЗАДАНО значение false, автоматически используется флаг PD_RETURNDC. После вызова `DoModal` , `GetDefaults` или `GetPrinterDC` контроллер домена будет возвращен в `m_pd.hDC` . Этот контроллер домена должен быть освобожден с помощью вызова [делетедк](/windows/win32/api/wingdi/nf-wingdi-deletedc) вызывающим объектом `CPrintDialog` .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#174](../../mfc/codesnippet/cpp/cprintdialog-class_1.cpp)]

## <a name="cprintdialogcreateprinterdc"></a><a name="createprinterdc"></a> Кпринтдиалог:: Креатепринтердк

Создает контекст устройства принтера (DC) из структур [DEVMODE](/windows/win32/api/wingdi/ns-wingdi-devmodea) и [DEVNAMES](/windows/win32/api/commdlg/ns-commdlg-devnames) .

```
HDC CreatePrinterDC();
```

### <a name="return-value"></a>Возвращаемое значение

Обработайте с созданным контекстом печатающего устройства.

### <a name="remarks"></a>Комментарии

Предполагается, что контроллер домена является текущим контроллером домена, а все ранее полученные контроллеры домена должны быть удалены пользователем. Эта функция может быть вызвана, и полученный контроллер домена будет использоваться без отображения диалогового окна «Печать».

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#106](../../mfc/codesnippet/cpp/cprintdialog-class_2.cpp)]

## <a name="cprintdialogdomodal"></a><a name="domodal"></a> Кпринтдиалог::D Омодал

Отображает диалоговое окно обычный печать Windows, позволяющее пользователю выбирать различные параметры печати, такие как количество копий, диапазон страниц и необходимость сортировки копий.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Возвращаемое значение

ИДОК или ИДКАНЦЕЛ. Если возвращается ИДКАНЦЕЛ, вызовите функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка.

ИДОК и ИДКАНЦЕЛ — это константы, которые указывают, выбрал ли пользователь кнопку ОК или Отмена.

### <a name="remarks"></a>Комментарии

Если требуется инициализировать различные параметры диалогового окна печати путем установки элементов `m_pd` структуры, следует сделать это перед вызовом метода `DoModal` , но после создания объекта диалогового окна.

После вызова `DoModal` можно вызвать другие функции члена для получения параметров или данных, вводимых пользователем, в диалоговое окно.

Обратите внимание, что при вызове конструктора с параметром *бпринтсетупонли* , для которого ЗАДАНО значение false, автоматически используется флаг PD_RETURNDC. После вызова `DoModal` , `GetDefaults` или `GetPrinterDC` контроллер домена будет возвращен в `m_pd.hDC` . Этот контроллер домена должен быть освобожден с помощью вызова [делетедк](/windows/win32/api/wingdi/nf-wingdi-deletedc) вызывающим объектом `CPrintDialog` .

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: креатепринтердк](#createprinterdc).

## <a name="cprintdialoggetcopies"></a><a name="getcopies"></a> Кпринтдиалог:: выполняет копирование

Возвращает количество запрошенных копий.

```
int GetCopies() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число запрошенных копий.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова `DoModal` , чтобы получить количество запрошенных копий.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог::P ринтколлате](#printcollate).

## <a name="cprintdialoggetdefaults"></a><a name="getdefaults"></a> Кпринтдиалог:: параметры по умолчанию

Возвращает параметры по умолчанию для принтера по умолчанию без отображения диалогового окна.

```
BOOL GetDefaults();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Извлеченные значения помещаются в `m_pd` структуру.

В некоторых случаях вызов этой функции вызывает [конструктор](#cprintdialog) для `CPrintDialog` с параметром WITH *БПРИНТСЕТУПОНЛИ* , имеющим значение false. В таких случаях контроллеры домена и `hDevNames` `hDevMode` (два маркера, расположенных в `m_pd` члене данных) автоматически распределяются.

Если конструктор для `CPrintDialog` был вызван с параметром *бпринтсетупонли* , для которого задано значение false, эта функция не будет возвращать `hDevNames` `hDevMode` `m_pd.hDevNames` вызывающему объекту и находиться в `m_pd.hDevMode` нем, но также будет возвращать контроллер домена в `m_pd.hDC` . Ответственность за удаление контроллера домена принтера и вызов функции Windows [GlobalFree](/windows/win32/api/winbase/nf-winbase-globalfree) для дескрипторов после завершения работы с `CPrintDialog` объектом.

### <a name="example"></a>Пример

Этот фрагмент кода получает контекст устройства принтера по умолчанию и сообщает пользователю разрешение принтера в точках на дюйм. (Этот атрибут возможностей принтера часто называется DPI.)

[!code-cpp[NVC_MFCDocView#107](../../mfc/codesnippet/cpp/cprintdialog-class_3.cpp)]

## <a name="cprintdialoggetdevicename"></a><a name="getdevicename"></a> Кпринтдиалог:: Жетдевиценаме

Извлекает имя выбранного в данный момент принтера.

```
CString GetDeviceName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Имя выбранного в данный момент принтера.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова [DoModal](#domodal) , чтобы получить имя текущего выбранного принтера, или после вызова метода [Default](#getdefaults) , чтобы получить текущие значения по умолчанию для принтера по умолчанию. Используйте указатель на `CString` объект, возвращаемый в `GetDeviceName` качестве значения `lpszDeviceName` в вызове [CDC:: креатедк](../../mfc/reference/cdc-class.md#createdc).

### <a name="example"></a>Пример

Этот фрагмент кода показывает имя принтера пользователя по умолчанию и порт, к которому он подключен, а также имя диспетчера очереди печати. В коде может отображаться окно сообщения "ваш принтер по умолчанию — HP LaserJet ИИИП On \\ \сервер\шаре using винспул.", например.

[!code-cpp[NVC_MFCDocView#108](../../mfc/codesnippet/cpp/cprintdialog-class_4.cpp)]

## <a name="cprintdialoggetdevmode"></a><a name="getdevmode"></a> Кпринтдиалог::

Извлекает `DEVMODE` структуру.

```
LPDEVMODE GetDevMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Структура данных [DEVMODE](/windows/win32/api/wingdi/ns-wingdi-devmodea) , которая содержит сведения об инициализации устройства и среде драйвера печати. Необходимо разблокировать память, занятую этой структурой, с помощью функции Windows [глобалунлокк](/windows/win32/api/winbase/nf-winbase-globalunlock) , которая описана в Windows SDK.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова [DoModal](#domodal) или [по умолчанию](#getdefaults) , чтобы получить сведения о печатающем устройстве.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог::P ринтколлате](#printcollate).

## <a name="cprintdialoggetdrivername"></a><a name="getdrivername"></a> Кпринтдиалог:: GetDriverName

Извлекает имя выбранного в данный момент драйвера принтера.

```
CString GetDriverName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение типа, `CString` указывающее имя драйвера, определяемое системой.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова [DoModal](#domodal) или [по умолчанию](#getdefaults) , чтобы получить имя драйвера принтера, определенного системой. Используйте указатель на `CString` объект, возвращаемый в `GetDriverName` качестве значения `lpszDriverName` в вызове [CDC:: креатедк](../../mfc/reference/cdc-class.md#createdc).

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: жетдевиценаме](#getdevicename).

## <a name="cprintdialoggetfrompage"></a><a name="getfrompage"></a> Кпринтдиалог:: Жетфромпаже

Извлекает начальную страницу диапазона печати.

```
int GetFromPage() const;
```

### <a name="return-value"></a>Возвращаемое значение

Номер начальной страницы в диапазоне печатаемых страниц.

### <a name="remarks"></a>Комментарии

Вызывайте эту функцию после вызова `DoModal` , чтобы получить номер начальной страницы в диапазоне печатаемых страниц.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: m_pd](#m_pd).

## <a name="cprintdialoggetportname"></a><a name="getportname"></a> Кпринтдиалог:: Жетпортнаме

Извлекает имя выбранного в данный момент порта принтера.

```
CString GetPortName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Имя выбранного в данный момент порта принтера.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова [DoModal](#domodal) или [по умолчанию](#getdefaults) , чтобы получить имя выбранного в данный момент порта принтера.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: жетдевиценаме](#getdevicename).

## <a name="cprintdialoggetprinterdc"></a><a name="getprinterdc"></a> Кпринтдиалог:: Жетпринтердк

Извлекает маркер контекста устройства принтера.

```
HDC GetPrinterDC() const;
```

### <a name="return-value"></a>Возвращаемое значение

Маркер контекста устройства принтера в случае успешного выполнения; в противном случае — NULL.

### <a name="remarks"></a>Комментарии

Если параметр *бпринтсетупонли* `CPrintDialog` конструктора имеет значение false (что означает, что отображается диалоговое окно Печать), то `GetPrinterDC` возвращает маркер контекста устройства принтера. Чтобы удалить контекст устройства после завершения его использования, необходимо вызвать функцию Windows [делетедк](/windows/win32/api/wingdi/nf-wingdi-deletedc) .

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#109](../../mfc/codesnippet/cpp/cprintdialog-class_5.cpp)]

## <a name="cprintdialoggettopage"></a><a name="gettopage"></a> Кпринтдиалог:: Жеттопаже

Извлекает конечную страницу диапазона печати.

```
int GetToPage() const;
```

### <a name="return-value"></a>Возвращаемое значение

Номер конечной страницы в диапазоне печатаемых страниц.

### <a name="remarks"></a>Комментарии

Вызывайте эту функцию после вызова метода, `DoModal` чтобы получить номер конечной страницы в диапазоне печатаемых страниц.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: m_pd](#m_pd).

## <a name="cprintdialogm_pd"></a><a name="m_pd"></a> Кпринтдиалог:: m_pd

Структура, члены которой хранят характеристики объекта диалогового окна.

```
PRINTDLG& m_pd;
```

### <a name="remarks"></a>Комментарии

После создания `CPrintDialog` объекта можно использовать `m_pd` для установки различных аспектов диалогового окна перед вызовом функции-члена [DoModal](#domodal) . Дополнительные сведения о `m_pd` структуре см. в разделе [принтдлг](/windows/win32/api/commdlg/ns-commdlg-printdlga) в Windows SDK.

При `m_pd` непосредственном изменении элемента данных будет переопределено поведение по умолчанию.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#111](../../mfc/codesnippet/cpp/cprintdialog-class_6.cpp)]

## <a name="cprintdialogprintall"></a><a name="printall"></a> Кпринтдиалог::P Ринталл

Определяет, следует ли печатать все страницы документа.

```
BOOL PrintAll() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если все страницы документа должны печататься; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию после вызова `DoModal` , чтобы определить, следует ли печатать все страницы в документе.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: m_pd](#m_pd).

## <a name="cprintdialogprintcollate"></a><a name="printcollate"></a> Кпринтдиалог::P Ринтколлате

Определяет, запрашиваются ли копии по копиям.

```
BOOL PrintCollate() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если пользователь нажимает флажок COLLATE в диалоговом окне; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Вызывайте эту функцию после вызова `DoModal` , чтобы определить, должен ли принтер выполнять сортировку всех печатных копий документа.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCDocView#110](../../mfc/codesnippet/cpp/cprintdialog-class_7.cpp)]

## <a name="cprintdialogprintrange"></a><a name="printrange"></a> Кпринтдиалог::P Ринтранже

Определяет, следует ли печатать только указанный диапазон страниц.

```
BOOL PrintRange() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если требуется напечатать только диапазон страниц документа. в противном случае — 0.

### <a name="remarks"></a>Комментарии

Вызывайте эту функцию после вызова `DoModal` , чтобы определить, следует ли печатать в документе только диапазон страниц.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: m_pd](#m_pd).

## <a name="cprintdialogprintselection"></a><a name="printselection"></a> Кпринтдиалог::P Ринтселектион

Определяет, следует ли печатать только выбранные в данный момент элементы.

```
BOOL PrintSelection() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если будут распечатаны только выбранные элементы; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Вызывайте эту функцию после вызова `DoModal` , чтобы определить, следует ли печатать только выбранные в данный момент элементы.

### <a name="example"></a>Пример

  См. пример для [кпринтдиалог:: m_pd](#m_pd).

## <a name="see-also"></a>См. также раздел

[Пример DIBLOOK в MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс Ккоммондиалог](../../mfc/reference/ccommondialog-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Структура CPrintInfo](../../mfc/reference/cprintinfo-structure.md)
