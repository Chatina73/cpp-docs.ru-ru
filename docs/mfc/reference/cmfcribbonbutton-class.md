---
description: 'Дополнительные сведения о: CMFCRibbonButton Class'
title: Класс CMFCRibbonButton
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::AddSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::CanBeStretched
- AFXRIBBONBUTTON/CMFCRibbonButton::CleanUpSizes
- AFXRIBBONBUTTON/CMFCRibbonButton::ClosePopupMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawBottomText
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawImage
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawRibbonText
- AFXRIBBONBUTTON/CMFCRibbonButton::FindSubItemIndexByID
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCommandRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCompactSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIcon
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIntermediateSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenuRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetRegularSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::GetTextRowHeight
- AFXRIBBONBUTTON/CMFCRibbonButton::GetToolTipText
- AFXRIBBONBUTTON/CMFCRibbonButton::HasCompactMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasIntermediateMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasLargeMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsApplicationButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsCommandAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultPanelButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDrawTooltipImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuOnBottom
- AFXRIBBONBUTTON/CMFCRibbonButton::IsPopupDefaultMenuLook
- AFXRIBBONBUTTON/CMFCRibbonButton::IsRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsSingleLineText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnCalcTextSize
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDraw
- AFXRIBBONBUTTON/CMFCRibbonButton::OnFillBackground
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveAllSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::SetACCData
- AFXRIBBONBUTTON/CMFCRibbonButton::SetAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDescription
- AFXRIBBONBUTTON/CMFCRibbonButton::SetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::SetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetParentCategory
- AFXRIBBONBUTTON/CMFCRibbonButton::SetRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnClick
helpviewer_keywords:
- CMFCRibbonButton [MFC], CMFCRibbonButton
- CMFCRibbonButton [MFC], AddSubItem
- CMFCRibbonButton [MFC], CanBeStretched
- CMFCRibbonButton [MFC], CleanUpSizes
- CMFCRibbonButton [MFC], ClosePopupMenu
- CMFCRibbonButton [MFC], DrawBottomText
- CMFCRibbonButton [MFC], DrawImage
- CMFCRibbonButton [MFC], DrawRibbonText
- CMFCRibbonButton [MFC], FindSubItemIndexByID
- CMFCRibbonButton [MFC], GetCommandRect
- CMFCRibbonButton [MFC], GetCompactSize
- CMFCRibbonButton [MFC], GetIcon
- CMFCRibbonButton [MFC], GetImageIndex
- CMFCRibbonButton [MFC], GetImageSize
- CMFCRibbonButton [MFC], GetIntermediateSize
- CMFCRibbonButton [MFC], GetMenu
- CMFCRibbonButton [MFC], GetMenuRect
- CMFCRibbonButton [MFC], GetRegularSize
- CMFCRibbonButton [MFC], GetSubItems
- CMFCRibbonButton [MFC], GetTextRowHeight
- CMFCRibbonButton [MFC], GetToolTipText
- CMFCRibbonButton [MFC], HasCompactMode
- CMFCRibbonButton [MFC], HasIntermediateMode
- CMFCRibbonButton [MFC], HasLargeMode
- CMFCRibbonButton [MFC], HasMenu
- CMFCRibbonButton [MFC], IsAlwaysDrawBorder
- CMFCRibbonButton [MFC], IsAlwaysLargeImage
- CMFCRibbonButton [MFC], IsApplicationButton
- CMFCRibbonButton [MFC], IsCommandAreaHighlighted
- CMFCRibbonButton [MFC], IsDefaultCommand
- CMFCRibbonButton [MFC], IsDefaultPanelButton
- CMFCRibbonButton [MFC], IsDrawTooltipImage
- CMFCRibbonButton [MFC], IsLargeImage
- CMFCRibbonButton [MFC], IsMenuAreaHighlighted
- CMFCRibbonButton [MFC], IsMenuOnBottom
- CMFCRibbonButton [MFC], IsPopupDefaultMenuLook
- CMFCRibbonButton [MFC], IsRightAlignMenu
- CMFCRibbonButton [MFC], IsSingleLineText
- CMFCRibbonButton [MFC], OnCalcTextSize
- CMFCRibbonButton [MFC], OnDrawBorder
- CMFCRibbonButton [MFC], OnDraw
- CMFCRibbonButton [MFC], OnFillBackground
- CMFCRibbonButton [MFC], RemoveAllSubItems
- CMFCRibbonButton [MFC], RemoveSubItem
- CMFCRibbonButton [MFC], SetACCData
- CMFCRibbonButton [MFC], SetAlwaysLargeImage
- CMFCRibbonButton [MFC], SetDefaultCommand
- CMFCRibbonButton [MFC], SetDescription
- CMFCRibbonButton [MFC], SetImageIndex
- CMFCRibbonButton [MFC], SetMenu
- CMFCRibbonButton [MFC], SetParentCategory
- CMFCRibbonButton [MFC], SetRightAlignMenu
- CMFCRibbonButton [MFC], SetText
- CMFCRibbonButton [MFC], OnClick
ms.assetid: 732e941c-9504-4b83-a691-d18075965d53
ms.openlocfilehash: 1ea6a133ad990d9f9acfe43c775025dc79a7161a
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97293832"
---
# <a name="cmfcribbonbutton-class"></a>Класс CMFCRibbonButton

Класс `CMFCRibbonButton` реализует кнопки, которые можно размещать на элементах ленты, например на панелях, панелях быстрого доступа и во всплывающих меню.

Дополнительные сведения см. в исходном коде, расположенном в папке **VC \\ атлмфк \\ src \\ MFC** в установке Visual Studio.

## <a name="syntax"></a>Синтаксис

```
class CMFCRibbonButton : public CMFCRibbonBaseElement
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CMFCRibbonButton:: CMFCRibbonButton](#cmfcribbonbutton)|Создает объект "кнопка ленты".|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CMFCRibbonButton::AddSubItem](#addsubitem)|Добавляет во всплывающее меню элемент, связанный с кнопкой.|
|[CMFCRibbonButton::CanBeStretched](#canbestretched)|(Переопределяет [метод CMFCRibbonBaseElement:: канбестретчед](../../mfc/reference/cmfcribbonbaseelement-class.md#canbestretched).)|
|[CMFCRibbonButton::CleanUpSizes](#cleanupsizes)|(Переопределяет [метод CMFCRibbonBaseElement:: клеанупсизес](../../mfc/reference/cmfcribbonbaseelement-class.md#cleanupsizes).)|
|[CMFCRibbonButton::ClosePopupMenu](#closepopupmenu)|(Переопределяет [метод CMFCRibbonBaseElement:: клосепопупмену](../../mfc/reference/cmfcribbonbaseelement-class.md#closepopupmenu).)|
|[CMFCRibbonButton::DrawBottomText](#drawbottomtext)||
|[CMFCRibbonButton::DrawImage](#drawimage)|(Переопределяет [метод CMFCRibbonBaseElement::D равимаже](../../mfc/reference/cmfcribbonbaseelement-class.md#drawimage).)|
|[CMFCRibbonButton::DrawRibbonText](#drawribbontext)||
|[CMFCRibbonButton::FindSubItemIndexByID](#findsubitemindexbyid)|Возвращает индекс элемента всплывающего меню, связанного с указанным идентификатором команды.|
|[CMFCRibbonButton::GetCommandRect](#getcommandrect)||
|[CMFCRibbonButton::GetCompactSize](#getcompactsize)|Возвращает компактный размер элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: жеткомпактсизе](../../mfc/reference/cmfcribbonbaseelement-class.md#getcompactsize).)|
|[CMFCRibbonButton::GetIcon](#geticon)||
|[CMFCRibbonButton::GetImageIndex](#getimageindex)|Возвращает индекс изображения, связанного с кнопкой.|
|[CMFCRibbonButton::GetImageSize](#getimagesize)|Возвращает размер изображения элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: жетимажесизе](../../mfc/reference/cmfcribbonbaseelement-class.md#getimagesize).)|
|[CMFCRibbonButton::GetIntermediateSize](#getintermediatesize)|Возвращает размер элемента ленты в промежуточное состояние. (Переопределяет [метод CMFCRibbonBaseElement:: GetIntermediateSize](../../mfc/reference/cmfcribbonbaseelement-class.md#getintermediatesize).)|
|[CMFCRibbonButton::GetMenu](#getmenu)|Возвращает дескриптор меню Windows, назначенному кнопке ленты.|
|[CMFCRibbonButton::GetMenuRect](#getmenurect)||
|[CMFCRibbonButton::GetRegularSize](#getregularsize)|Возвращает стандартный размер элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: жетрегуларсизе](../../mfc/reference/cmfcribbonbaseelement-class.md#getregularsize).)|
|[CMFCRibbonButton::GetSubItems](#getsubitems)||
|[CMFCRibbonButton::GetTextRowHeight](#gettextrowheight)||
|[CMFCRibbonButton::GetToolTipText](#gettooltiptext)|Возвращает текст всплывающей подсказки элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: жеттултиптекст](../../mfc/reference/cmfcribbonbaseelement-class.md#gettooltiptext).)|
|[CMFCRibbonButton::HasCompactMode](#hascompactmode)|Задает, доступен ли для элемента ленты компактный режим. (Переопределяет [метод CMFCRibbonBaseElement:: хаскомпактмоде](../../mfc/reference/cmfcribbonbaseelement-class.md#hascompactmode).)|
|[CMFCRibbonButton::HasIntermediateMode](#hasintermediatemode)|Задает, доступен ли для элемента ленты промежуточный режим. (Переопределяет [метод CMFCRibbonBaseElement:: хасинтермедиатемоде](../../mfc/reference/cmfcribbonbaseelement-class.md#hasintermediatemode).)|
|[CMFCRibbonButton::HasLargeMode](#haslargemode)|Определяет, доступен ли для элемента ленты крупный режим. (Переопределяет [метод CMFCRibbonBaseElement:: хасларжемоде](../../mfc/reference/cmfcribbonbaseelement-class.md#haslargemode).)|
|[CMFCRibbonButton::HasMenu](#hasmenu)|(Переопределяет [метод CMFCRibbonBaseElement:: хасмену](../../mfc/reference/cmfcribbonbaseelement-class.md#hasmenu).)|
|[CMFCRibbonButton::IsAlwaysDrawBorder](#isalwaysdrawborder)||
|[CMFCRibbonButton::IsAlwaysLargeImage](#isalwayslargeimage)|(Переопределяет [метод CMFCRibbonBaseElement:: исалвайсларжеимаже](../../mfc/reference/cmfcribbonbaseelement-class.md#isalwayslargeimage).)|
|[CMFCRibbonButton::IsApplicationButton](#isapplicationbutton)||
|[CMFCRibbonButton::IsCommandAreaHighlighted](#iscommandareahighlighted)||
|[CMFCRibbonButton::IsDefaultCommand](#isdefaultcommand)|Определяет, доступна ли для кнопки ленты команда по умолчанию.|
|[CMFCRibbonButton::IsDefaultPanelButton](#isdefaultpanelbutton)||
|[CMFCRibbonButton::IsDrawTooltipImage](#isdrawtooltipimage)||
|[CMFCRibbonButton::IsLargeImage](#islargeimage)||
|[CMFCRibbonButton::IsMenuAreaHighlighted](#ismenuareahighlighted)||
|[CMFCRibbonButton::IsMenuOnBottom](#ismenuonbottom)||
|[CMFCRibbonButton::IsPopupDefaultMenuLook](#ispopupdefaultmenulook)||
|[CMFCRibbonButton::IsRightAlignMenu](#isrightalignmenu)|Определяет, выровнено ли меню по правому краю.|
|[CMFCRibbonButton::IsSingleLineText](#issinglelinetext)||
|[CMFCRibbonButton::OnCalcTextSize](#oncalctextsize)|(Переопределяет [метод CMFCRibbonBaseElement:: онкалктекстсизе](../../mfc/reference/cmfcribbonbaseelement-class.md#oncalctextsize).)|
|[CMFCRibbonButton::OnDrawBorder](#ondrawborder)||
|[CMFCRibbonButton::OnDraw](#ondraw)|Вызывается платформой для отрисовки элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: OnDraw](../../mfc/reference/cmfcribbonbaseelement-class.md#ondraw).)|
|[CMFCRibbonButton::OnFillBackground](#onfillbackground)||
|[CMFCRibbonButton::RemoveAllSubItems](#removeallsubitems)|Удаляет из всплывающего меню все элементы.|
|[CMFCRibbonButton::RemoveSubItem](#removesubitem)|Удаляет элемент из всплывающего меню.|
|[CMFCRibbonButton::SetACCData](#setaccdata)|(Переопределяет [метод CMFCRibbonBaseElement:: сетаккдата](../../mfc/reference/cmfcribbonbaseelement-class.md#setaccdata).)|
|[CMFCRibbonButton::SetAlwaysLargeImage](#setalwayslargeimage)|Задает размер свернутой кнопки: крупная или малая.|
|[CMFCRibbonButton::SetDefaultCommand](#setdefaultcommand)|Делает для кнопки ленты доступной команду по умолчанию.|
|[CMFCRibbonButton::SetDescription](#setdescription)|Задает описание элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: SetDescription](../../mfc/reference/cmfcribbonbaseelement-class.md#setdescription).)|
|[CMFCRibbonButton::SetImageIndex](#setimageindex)|Назначает индекс изображению кнопки.|
|[CMFCRibbonButton::SetMenu](#setmenu)|Назначает всплывающее меню кнопке ленты.|
|[CMFCRibbonButton::SetParentCategory](#setparentcategory)|(Переопределяет [метод CMFCRibbonBaseElement:: сетпаренткатегори](../../mfc/reference/cmfcribbonbaseelement-class.md#setparentcategory).)|
|[CMFCRibbonButton::SetRightAlignMenu](#setrightalignmenu)|Располагает всплывающее меню справа от кнопки.|
|[CMFCRibbonButton::SetText](#settext)|Задает текст элемента ленты. (Переопределяет [метод CMFCRibbonBaseElement:: SetText](../../mfc/reference/cmfcribbonbaseelement-class.md#settext).)|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание|
|----------|-----------------|
|[CMFCRibbonButton::OnClick](#onclick)|Вызывается платформой по нажатию кнопки.|

## <a name="example"></a>Пример

В следующем примере демонстрируется использование различных методов класса `CMFCRibbonButton`. Показывается создание объекта класса `CMFCRibbonButton`, назначение всплывающего меню кнопке ленты, назначение кнопке описания, удаление элемента из всплывающего меню, а также расположение всплывающего меню справа от края кнопки.

[!code-cpp[NVC_MFC_RibbonApp#7](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_1.cpp)]

## <a name="remarks"></a>Комментарии

Чтобы использовать кнопку на ленте в приложении, создайте объект кнопки и добавьте его на соответствующую [панель](../../mfc/reference/cmfcribbonpanel-class.md)ленты.

```cpp
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"), // Panel name
    m_PanelIcons.ExtractIcon (0)); // Panel icon

// Create the first button ("Paste"):
CMFCRibbonButton* pPasteButton =
    new CMFCRibbonButton (ID_EDIT_PASTE, _T("Paste"), -1, 0);

// The third parameter (-1) disables small images for button.
// This button is always displayed with a large image
// Associate a pop-up menu with the "Paste" button:
pPasteButton->SetMenu (IDR_CONTEXT_MENU);

// Add buttons to the panel. These buttons have only small images.
pPanel->Add (new CMFCRibbonButton (ID_EDIT_CUT, _T("Cut"), 1));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_COPY, _T("Copy"), 2));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_PAINT, _T("Paint"), 9));
```

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

## <a name="requirements"></a>Требования

**Заголовок:** afxribbonbutton.h

## <a name="cmfcribbonbuttonaddsubitem"></a><a name="addsubitem"></a> CMFCRibbonButton:: Аддсубитем

Добавляет во всплывающее меню элемент, связанный с кнопкой.

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1);
```

### <a name="parameters"></a>Параметры

*псубитем*<br/>
окне Указывает указатель на новый добавляемый элемент.

*ниндекс*<br/>
окне Указывает индекс, по которому добавляется элемент в массив пунктов меню кнопки. значение-1, чтобы добавить элемент в конец массива пунктов меню.

## <a name="cmfcribbonbuttoncanbestretched"></a><a name="canbestretched"></a> CMFCRibbonButton:: Канбестретчед

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttoncleanupsizes"></a><a name="cleanupsizes"></a> CMFCRibbonButton:: Клеанупсизес

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonclosepopupmenu"></a><a name="closepopupmenu"></a> CMFCRibbonButton:: Клосепопупмену

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttoncmfcribbonbutton"></a><a name="cmfcribbonbutton"></a> CMFCRibbonButton:: CMFCRibbonButton

Создает объект "кнопка ленты".

```
CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex=-1,
    int nLargeImageIndex=-1,
    BOOL bAlwaysShowDescription=FALSE);

CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    HICON hIcon,
    BOOL bAlwaysShowDescription=FALSE,
    HICON hIconSmall=NULL,
    BOOL bAutoDestroyIcon=FALSE,
    BOOL bAlphaBlendIcon=FALSE);
```

### <a name="parameters"></a>Параметры

*nID*<br/>
окне Указывает идентификатор команды для кнопки.

*lpszText*<br/>
окне Задает текстовую метку кнопки.

*нсмаллимажеиндекс*<br/>
окне Указывает отсчитываемый от нуля индекс мелкого изображения кнопки в списке изображений родительской категории.

*нларжеимажеиндекс*<br/>
окне Указывает отсчитываемый от нуля индекс крупного изображения кнопки в списке изображений родительской категории.

*hIcon*<br/>
окне Задает маркер значка, который используется приложением в качестве изображения кнопки.

### <a name="example"></a>Пример

В следующем примере показано, как создать `CMFCRibbonButton` объект.

[!code-cpp[NVC_MFC_RibbonApp#6](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_2.cpp)]

## <a name="cmfcribbonbuttondrawbottomtext"></a><a name="drawbottomtext"></a> CMFCRibbonButton::D Равботтомтекст

```
CSize DrawBottomText(
    CDC* pDC,
    BOOL bCalcOnly);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>
окне *бкалконли*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttondrawimage"></a><a name="drawimage"></a> CMFCRibbonButton::D Равимаже

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>
окне *тип*<br/>
окне *ректимаже*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttondrawribbontext"></a><a name="drawribbontext"></a> CMFCRibbonButton::D Равриббонтекст

```
virtual int DrawRibbonText(
    CDC* pDC,
    const CString& strText,
    CRect rectText,
    UINT uiDTFlags,
    COLORREF clrText = (COLORREF)-1);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>
окне *стртекст*<br/>
окне *ректтекст*<br/>
окне *уидтфлагс*<br/>
окне *клртекст*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonfindsubitemindexbyid"></a><a name="findsubitemindexbyid"></a> CMFCRibbonButton:: Финдсубитеминдексбид

Возвращает индекс элемента всплывающего меню, связанного с указанным идентификатором команды.

```
int FindSubItemIndexByID(UINT uiID) const;
```

### <a name="parameters"></a>Параметры

*uiID*<br/>
окне Указывает идентификатор команды всплывающего меню.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс подэлемента, связанного с объектом *уиид*. -1, если такой подэлемент отсутствует.

## <a name="cmfcribbonbuttongetcommandrect"></a><a name="getcommandrect"></a> CMFCRibbonButton:: Жеткоммандрект

```
CRect GetCommandRect() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetcompactsize"></a><a name="getcompactsize"></a> CMFCRibbonButton:: Жеткомпактсизе

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongeticon"></a><a name="geticon"></a> CMFCRibbonButton:: "Icon"

```
HICON GetIcon(BOOL bLargeIcon = TRUE) const;
```

### <a name="parameters"></a>Параметры

окне *бларжеикон*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetimageindex"></a><a name="getimageindex"></a> CMFCRibbonButton:: GetImageIndex

Возвращает индекс изображения, связанного с кнопкой.

```
int GetImageIndex(BOOL bLargeImage) const;
```

### <a name="parameters"></a>Параметры

*бларжеимаже*<br/>
окне Если значение — TRUE, возвращает индекс изображения в списке изображений, содержащем крупные изображения. в противном случае возвращает индекс изображения в списке изображений, содержащем небольшие изображения.

### <a name="return-value"></a>Возвращаемое значение

Индекс изображения кнопки в связанном списке изображений.

## <a name="cmfcribbonbuttongetimagesize"></a><a name="getimagesize"></a> CMFCRibbonButton:: Жетимажесизе

```
virtual CSize GetImageSize(RibbonImageType type) const;
```

### <a name="parameters"></a>Параметры

окне *тип*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetintermediatesize"></a><a name="getintermediatesize"></a> CMFCRibbonButton:: GetIntermediateSize

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetmenu"></a><a name="getmenu"></a> CMFCRibbonButton:: Menu

Возвращает дескриптор меню Windows, назначенному кнопке ленты.

```
HMENU GetMenu() const;
```

### <a name="return-value"></a>Возвращаемое значение

Маркер меню Windows, назначенный кнопке; Значение NULL, если меню не назначено.

## <a name="cmfcribbonbuttongetmenurect"></a><a name="getmenurect"></a> CMFCRibbonButton:: Жетменурект

```
CRect GetMenuRect() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetregularsize"></a><a name="getregularsize"></a> CMFCRibbonButton:: Жетрегуларсизе

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongetsubitems"></a><a name="getsubitems"></a> CMFCRibbonButton:: Жетсубитемс

```
const CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& GetSubItems() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongettextrowheight"></a><a name="gettextrowheight"></a> CMFCRibbonButton:: Жеттекстровхеигхт

```
int GetTextRowHeight() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttongettooltiptext"></a><a name="gettooltiptext"></a> CMFCRibbonButton:: Жеттултиптекст

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonhascompactmode"></a><a name="hascompactmode"></a> CMFCRibbonButton:: Хаскомпактмоде

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonhasintermediatemode"></a><a name="hasintermediatemode"></a> CMFCRibbonButton:: Хасинтермедиатемоде

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonhaslargemode"></a><a name="haslargemode"></a> CMFCRibbonButton:: Хасларжемоде

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonhasmenu"></a><a name="hasmenu"></a> CMFCRibbonButton:: Хасмену

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisalwaysdrawborder"></a><a name="isalwaysdrawborder"></a> CMFCRibbonButton:: Исалвайсдравбордер

```
virtual BOOL IsAlwaysDrawBorder() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisalwayslargeimage"></a><a name="isalwayslargeimage"></a> CMFCRibbonButton:: Исалвайсларжеимаже

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisapplicationbutton"></a><a name="isapplicationbutton"></a> CMFCRibbonButton:: Исаппликатионбуттон

```
virtual BOOL IsApplicationButton() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttoniscommandareahighlighted"></a><a name="iscommandareahighlighted"></a> CMFCRibbonButton:: Искоммандареахигхлигхтед

```
virtual BOOL IsCommandAreaHighlighted() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisdefaultcommand"></a><a name="isdefaultcommand"></a> CMFCRibbonButton:: Исдефаулткомманд

Указывает, включена ли команда по умолчанию для кнопки ленты.

```
BOOL IsDefaultCommand() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если для кнопки на ленте была включена команда по умолчанию; В противном случае — значение FALSE.

## <a name="cmfcribbonbuttonisdefaultpanelbutton"></a><a name="isdefaultpanelbutton"></a> CMFCRibbonButton:: Исдефаултпанелбуттон

```
virtual BOOL IsDefaultPanelButton() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisdrawtooltipimage"></a><a name="isdrawtooltipimage"></a> CMFCRibbonButton:: Исдравтултипимаже

```
virtual BOOL IsDrawTooltipImage() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonislargeimage"></a><a name="islargeimage"></a> CMFCRibbonButton:: Исларжеимаже

```
BOOL IsLargeImage() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonismenuareahighlighted"></a><a name="ismenuareahighlighted"></a> CMFCRibbonButton:: Исменуареахигхлигхтед

```
virtual BOOL IsMenuAreaHighlighted() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonismenuonbottom"></a><a name="ismenuonbottom"></a> CMFCRibbonButton:: Исменуонботтом

```
BOOL IsMenuOnBottom() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonispopupdefaultmenulook"></a><a name="ispopupdefaultmenulook"></a> CMFCRibbonButton:: Испопупдефаултменулук

```
virtual BOOL IsPopupDefaultMenuLook() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonisrightalignmenu"></a><a name="isrightalignmenu"></a> CMFCRibbonButton:: Исригхталигнмену

Указывает, выдается ли меню по правому краю.

```
BOOL IsRightAlignMenu() const;
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если меню выдается по правому краю; в противном случае — FALSE.

## <a name="cmfcribbonbuttonissinglelinetext"></a><a name="issinglelinetext"></a> CMFCRibbonButton:: Иссинглелинетекст

```
BOOL IsSingleLineText() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttononcalctextsize"></a><a name="oncalctextsize"></a> CMFCRibbonButton:: Онкалктекстсизе

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttononclick"></a><a name="onclick"></a> CMFCRibbonButton:: OnClick

Вызывается платформой по нажатию кнопки.

```
virtual void OnClick(CPoint point);
```

### <a name="parameters"></a>Параметры

*точки*<br/>
окне Задает расположение щелчка мышью.

### <a name="remarks"></a>Комментарии

Переопределите этот метод в производном классе, если требуется обработку этого события.

## <a name="cmfcribbonbuttonondraw"></a><a name="ondraw"></a> CMFCRibbonButton:: OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonondrawborder"></a><a name="ondrawborder"></a> CMFCRibbonButton:: Ондравбордер

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttononfillbackground"></a><a name="onfillbackground"></a> CMFCRibbonButton:: Онфиллбаккграунд

```
virtual COLORREF OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>Параметры

окне *основной контроллер домена*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonremoveallsubitems"></a><a name="removeallsubitems"></a> CMFCRibbonButton:: Ремовеаллсубитемс

Удаляет из всплывающего меню все элементы.

```cpp
void RemoveAllSubItems();
```

## <a name="cmfcribbonbuttonremovesubitem"></a><a name="removesubitem"></a> CMFCRibbonButton:: Ремовесубитем

Удаляет элемент из всплывающего меню.

```
BOOL RemoveSubItem(int nIndex);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
окне Указывает отсчитываемый от нуля индекс элемента меню, который требуется удалить.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если указанный элемент был успешно удален; в противном случае FALSE, если *ниндекс* имеет отрицательное значение или превышает число пунктов меню во всплывающем меню.

## <a name="cmfcribbonbuttonsetaccdata"></a><a name="setaccdata"></a> CMFCRibbonButton:: Сетаккдата

Задает данные специальных возможностей для кнопки ленты.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Параметры

*ппарент*<br/>
Родительское окно для элемента ленты.

*data*<br/>
Данные специальных возможностей для элемента ленты.

### <a name="return-value"></a>Возвращаемое значение

Возвращает значение TRUE в случае успешного выполнения. в противном случае — FALSE.

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonsetalwayslargeimage"></a><a name="setalwayslargeimage"></a> CMFCRibbonButton:: Сеталвайсларжеимаже

Задает размер свернутой кнопки: крупная или малая.

```cpp
void SetAlwaysLargeImage(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Параметры

*Управляемое bSet*<br/>
окне Если значение — TRUE, Кнопка отображает большое изображение. В противном случае кнопка отображает небольшое изображение.

## <a name="cmfcribbonbuttonsetdefaultcommand"></a><a name="setdefaultcommand"></a> CMFCRibbonButton:: Сетдефаулткомманд

Делает для кнопки ленты доступной команду по умолчанию.

```cpp
void SetDefaultCommand(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Параметры

*Управляемое bSet*<br/>
окне Если значение — TRUE, кнопка может выполнить команду по умолчанию. Если задано значение FALSE, кнопка не может выполнить команду по умолчанию.

### <a name="remarks"></a>Комментарии

*управляемое bSet* имеет значение, только если кнопка имеет меню. Если *управляемое bSet* имеет значение true, кнопка может выполнить свою команду по умолчанию, а назначенное всплывающее меню появится только в том случае, если пользователь нажмет стрелку на правой границе кнопки. В противном случае кнопка не может выполнить команду по умолчанию, и появится всплывающее меню, независимо от того, какая область кнопки нажата пользователем.

## <a name="cmfcribbonbuttonsetdescription"></a><a name="setdescription"></a> CMFCRibbonButton:: SetDescription

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>Параметры

окне *лпсзтекст*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonsetimageindex"></a><a name="setimageindex"></a> CMFCRibbonButton:: Сетимажеиндекс

Назначает индекс изображению кнопки.

```cpp
void SetImageIndex(
    int nIndex,
    BOOL bLargeImage);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
окне Указывает индекс изображения.

*бларжеимаже*<br/>
окне Если значение — TRUE, указанный индекс ссылается на список больших изображений. В противном случае индекс ссылается на список мелких изображений.

## <a name="cmfcribbonbuttonsetmenu"></a><a name="setmenu"></a> CMFCRibbonButton:: Сетмену

Назначает всплывающее меню кнопке ленты.

```cpp
void SetMenu(
    HMENU hMenu,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);

void SetMenu(
    UINT uiMenuResID,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);
```

### <a name="parameters"></a>Параметры

*hMenu*<br/>
Маркер меню Windows.

*бисдефаулткомманд*<br/>
Если значение — TRUE, кнопка может выполнить команду по умолчанию; в противном случае кнопка отображает всплывающее меню.

*бригхталигн*<br/>
Если значение равно TRUE, меню выдается по правому краю. В противном случае меню выровняйтеся по левому краю.

*уименуресид*<br/>
Идентификатор ресурса меню.

### <a name="remarks"></a>Комментарии

Когда приложение присваивает кнопке меню, на правой стороне кнопки отображается стрелка. Если *бисдефаулткомманд* имеет значение true, меню отображается только в том случае, если пользователь щелкнет стрелку. Если пользователь нажимает кнопку, выполняется ее команда по умолчанию. Если *бисдефаулткомманд* имеет значение false, меню появляется, если щелкнуть в любом месте кнопки.

## <a name="cmfcribbonbuttonsetparentcategory"></a><a name="setparentcategory"></a> CMFCRibbonButton:: Сетпаренткатегори

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>Параметры

окне *ппарент*<br/>

### <a name="remarks"></a>Комментарии

## <a name="cmfcribbonbuttonsetrightalignmenu"></a><a name="setrightalignmenu"></a> CMFCRibbonButton:: Сетригхталигнмену

Выровнять всплывающее меню по границе кнопки.

```cpp
void SetRightAlignMenu(BOOL bSet=TRUE);
```

### <a name="parameters"></a>Параметры

*Управляемое bSet*<br/>
окне Если значение равно TRUE, меню выдается по правому краю. В противном случае меню выровняйтеся по левому краю.

## <a name="cmfcribbonbuttonsettext"></a><a name="settext"></a> CMFCRibbonButton:: SetText

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>Параметры

окне *лпсзтекст*<br/>

### <a name="remarks"></a>Комментарии

## <a name="see-also"></a>См. также раздел

[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Классы](../../mfc/reference/mfc-classes.md)
