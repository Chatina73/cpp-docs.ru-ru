---
description: 'Дополнительные сведения о: Кдатаексчанже Class'
title: Класс Кдатаексчанже
ms.date: 11/04/2016
f1_keywords:
- CDataExchange
- AFXWIN/CDataExchange
- AFXWIN/CDataExchange::CDataExchange
- AFXWIN/CDataExchange::Fail
- AFXWIN/CDataExchange::PrepareCtrl
- AFXWIN/CDataExchange::PrepareEditCtrl
- AFXWIN/CDataExchange::PrepareOleCtrl
- AFXWIN/CDataExchange::m_bSaveAndValidate
- AFXWIN/CDataExchange::m_pDlgWnd
helpviewer_keywords:
- CDataExchange [MFC], CDataExchange
- CDataExchange [MFC], Fail
- CDataExchange [MFC], PrepareCtrl
- CDataExchange [MFC], PrepareEditCtrl
- CDataExchange [MFC], PrepareOleCtrl
- CDataExchange [MFC], m_bSaveAndValidate
- CDataExchange [MFC], m_pDlgWnd
ms.assetid: 84ed6113-325d-493e-a75d-223f03a992b8
ms.openlocfilehash: 36d11dc2b74142bd869b0e7b459d8bdb888b2cef
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97222181"
---
# <a name="cdataexchange-class"></a>Класс Кдатаексчанже

Поддерживает процедуры обмена данными диалогового окна (DDX) и проверки данных диалогового окна (DDV), используемые классами Microsoft Foundation.

## <a name="syntax"></a>Синтаксис

```
class CDataExchange
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кдатаексчанже:: Кдатаексчанже](#cdataexchange)|Формирует объект `CDataExchange`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кдатаексчанже:: Fail](#fail)|Вызывается, когда проверка завершается неудачно. Сбрасывает фокус на предыдущий элемент управления и создает исключение.|
|[Кдатаексчанже::P Репаректрл](#preparectrl)|Подготавливает указанный элемент управления к обмену данными или проверке. Используется для неизменяемых элементов управления.|
|[Кдатаексчанже::P Репаридитктрл](#prepareeditctrl)|Подготавливает указанный элемент управления "поле ввода" к обмену данными или проверке.|
|[Кдатаексчанже::P Репареолектрл](#prepareolectrl)|Подготавливает указанный элемент управления OLE для обмена данными или проверки. Используется для неизменяемых элементов управления.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Кдатаексчанже:: m_bSaveAndValidate](#m_bsaveandvalidate)|Флаг, показывающий направление DDX и DDV.|
|[Кдатаексчанже:: m_pDlgWnd](#m_pdlgwnd)|Диалоговое окно или окно, в котором происходит обмен данными.|

## <a name="remarks"></a>Комментарии

`CDataExchange` не имеет базового класса.

Этот класс используется при написании подпрограмм обмена данными для пользовательских типов данных или элементов управления или при написании собственных подпрограмм проверки данных. Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделе [Обмен данными в диалоговом окне и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

`CDataExchange`Объект предоставляет сведения о контексте, необходимые для выполнения DDX и DDV. Флаг *m_bSaveAndValidate* имеет значение false, когда DDX используется для заполнения начальных значений элементов управления диалогового окна из элементов данных. Флаг *m_bSaveAndValidate* имеет значение true, когда DDX используется для установки текущих значений элементов управления диалогового окна в элементы данных и когда DDV используется для проверки значений данных. Если проверка DDV завершается неудачно, в процедуре DDV отображается окно сообщения, объясняющее ошибку ввода. Затем процедура DDV вызывает метод `Fail` , чтобы сбросить фокус на элемент управления, вызвавший ошибку, и создать исключение для завершения процесса проверки.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`CDataExchange`

## <a name="requirements"></a>Требования

**Заголовок:** afxwin.h

## <a name="cdataexchangecdataexchange"></a><a name="cdataexchange"></a> Кдатаексчанже:: Кдатаексчанже

Вызовите эту функцию-член для создания `CDataExchange` объекта.

```
CDataExchange(
    CWnd* pDlgWnd,
    BOOL bSaveAndValidate);
```

### <a name="parameters"></a>Параметры

*пдлгвнд*<br/>
Указатель на родительское окно, содержащее элемент управления. Обычно это объект, производный от [CDialog](../../mfc/reference/cdialog-class.md).

*бсавеандвалидате*<br/>
Если значение — TRUE, этот объект проверяет данные, а затем записывает данные из элементов управления в элементы. Если значение равно FALSE, этот объект будет перемещать данные из элементов в элементы управления.

### <a name="remarks"></a>Комментарии

Создайте `CDataExchange` объект самостоятельно, чтобы сохранить дополнительные сведения в объекте обмена данными для передачи в функцию-член [CWnd::D одатаексчанже](../../mfc/reference/cwnd-class.md#dodataexchange) в окне.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCControlLadenDialog#70](../../mfc/codesnippet/cpp/cdataexchange-class_1.cpp)]

## <a name="cdataexchangefail"></a><a name="fail"></a> Кдатаексчанже:: Fail

Платформа вызывает эту функцию-член при сбое операции проверки данных диалогового окна (DDV).

```cpp
void Fail();
```

### <a name="remarks"></a>Комментарии

`Fail` восстанавливает фокус и выбор элемента управления, для которого произошел сбой проверки (если имеется элемент управления для восстановления). `Fail` затем вызывает исключение типа [кусерексцептион](../../mfc/reference/cuserexception-class.md) для завершения процесса проверки. Исключение приводит к отображению окна сообщения об ошибке. После сбоя проверки DDV пользователь может повторно ввести данные в элементе управления, вызвавшем ошибку.

При сбое проверки разработчики пользовательских подпрограмм DDV могут вызывать `Fail` из своих подпрограмм.

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="cdataexchangem_bsaveandvalidate"></a><a name="m_bsaveandvalidate"></a> Кдатаексчанже:: m_bSaveAndValidate

Этот флаг указывает направление операции обмена данными диалога (DDX).

```
BOOL m_bSaveAndValidate;
```

### <a name="remarks"></a>Комментарии

Флаг имеет ненулевое значение, если `CDataExchange` объект используется для перемещения данных из диалоговых окон элементов управления в элементы данных класса диалогового окна после того, как пользователь редактирует элементы управления. Флаг равен нулю, если объект используется для инициализации элементов управления диалогового окна из элементов данных класса диалогового окна.

Флаг также не равен нулю во время проверки данных в диалоговом окне (DDV).

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="cdataexchangem_pdlgwnd"></a><a name="m_pdlgwnd"></a> Кдатаексчанже:: m_pDlgWnd

Содержит указатель на объект [CWnd](../../mfc/reference/cwnd-class.md) , для которого выполняется обмен диалоговыми данными (DDX) или проверка (DDV).

```
CWnd* m_pDlgWnd;
```

### <a name="remarks"></a>Комментарии

Этот объект обычно является объектом [CDialog](../../mfc/reference/cdialog-class.md) . Разработчики пользовательских подпрограмм DDX или DDV могут использовать этот указатель для получения доступа к диалоговому окну, содержащему элементы управления, на которых они работают.

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="cdataexchangepreparectrl"></a><a name="preparectrl"></a> Кдатаексчанже::P Репаректрл

Платформа вызывает эту функцию-член для подготовки указанного элемента управления к обмену данными диалога (DDX) и проверке (DDV).

```
HWND PrepareCtrl(int nIDC);
```

### <a name="parameters"></a>Параметры

*нидк*<br/>
Идентификатор элемента управления, который должен быть подготовлен для DDX или DDV.

### <a name="return-value"></a>Возвращаемое значение

HWND элемента управления, подготовленного для DDX или DDV.

### <a name="remarks"></a>Комментарии

Вместо этого используйте [препаридитктрл](#prepareeditctrl) для элементов управления "Правка". Используйте эту функцию члена для всех остальных элементов управления.

Подготовка состоит из хранения HWND элемента управления в `CDataExchange` классе. Платформа использует этот обработчик для восстановления фокуса на ранее сфокусированный элемент управления в случае сбоя DDX или DDV.

Реализации пользовательских подпрограмм DDX или DDV должны вызывать `PrepareCtrl` все элементы управления, не являющиеся элементами редактирования, для которых они обмениваются данными через DDX или проверяют данные через DDV.

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="cdataexchangeprepareeditctrl"></a><a name="prepareeditctrl"></a> Кдатаексчанже::P Репаридитктрл

Платформа вызывает эту функцию-член для подготовки указанного элемента управления редактирования для обмена данными диалога (DDX) и проверки (DDV).

```
HWND PrepareEditCtrl(int nIDC);
```

### <a name="parameters"></a>Параметры

*нидк*<br/>
Идентификатор элемента управления "поле ввода", который должен быть подготовлен для DDX или DDV.

### <a name="return-value"></a>Возвращаемое значение

HWND элемента управления редактирования, подготовленный для DDX или DDV.

### <a name="remarks"></a>Комментарии

Используйте [препаректрл](#preparectrl) вместо всех элементов управления, не являющихся элементами редактирования.

Подготовка состоит из двух вещей. Сначала `PrepareEditCtrl` сохраняет HWND элемента управления в `CDataExchange` классе. Платформа использует этот обработчик для восстановления фокуса на ранее сфокусированный элемент управления в случае сбоя DDX или DDV. Во-вторых, `PrepareEditCtrl` устанавливает флаг в `CDataExchange` классе, чтобы указать, что элемент управления, для которого выполняется обмен или проверка данных, является элементом управления редактирования.

Реализации пользовательских подпрограмм DDX или DDV должны вызывать `PrepareEditCtrl` все элементы управления для редактирования, для которых они обмениваются данными посредством DDX или проверки данных через DDV.

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="cdataexchangeprepareolectrl"></a><a name="prepareolectrl"></a> Кдатаексчанже::P Репареолектрл

Платформа вызывает эту функцию-член для подготовки указанного элемента управления OLE для обмена данными диалога (DDX) и проверки (DDV).

```
COleControlSite* PrepareOleCtrl(int nIDC);
```

### <a name="parameters"></a>Параметры

*нидк*<br/>
Идентификатор элемента управления OLE, который должен быть подготовлен для DDX или DDV.

### <a name="return-value"></a>Возвращаемое значение

Указатель на узел управления OLE.

### <a name="remarks"></a>Комментарии

Используйте [препаридитктрл](#prepareeditctrl) вместо элементов управления Edit или [препаректрл](#preparectrl) для всех остальных элементов управления, отличных от OLE.

Реализации пользовательских подпрограмм DDX или DDV должны вызывать `PrepareOleCtrl` все элементы управления OLE, для которых они обмениваются данными посредством DDX или проверки данных через DDV.

Дополнительные сведения о создании собственных подпрограмм DDX и DDV см. в [техническом заметке 26](../../mfc/tn026-ddx-and-ddv-routines.md). Общие сведения о DDX и DDV см. в разделах [диалоговые окна обмена данными и проверка](../../mfc/dialog-data-exchange-and-validation.md) и [диалоговые окна](../../mfc/dialog-boxes.md).

## <a name="see-also"></a>См. также раздел

[Пример примера VIEWEX MFC](../../overview/visual-cpp-samples.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[CWnd::DoDataExchange](../../mfc/reference/cwnd-class.md#dodataexchange)<br/>
[CWnd::UpdateData](../../mfc/reference/cwnd-class.md#updatedata)
