---
description: 'Дополнительные сведения о: структура CDaoQueryDefInfo'
title: Структура CDaoQueryDefInfo
ms.date: 11/04/2016
f1_keywords:
- CDaoQueryDefInfo
helpviewer_keywords:
- DAO (Data Access Objects), QueryDefs collection
- CDaoQueryDefInfo structure [MFC]
ms.assetid: e20837dc-e78d-4171-a195-1b4075fb5d2a
ms.openlocfilehash: 46b9b49d91d3d005d941eb585663c205fe30b2da
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97271815"
---
# <a name="cdaoquerydefinfo-structure"></a>Структура CDaoQueryDefInfo

`CDaoQueryDefInfo`Структура содержит сведения об объекте QueryDef, определенном для объектов доступа к данным (DAO).

## <a name="syntax"></a>Синтаксис

```
struct CDaoQueryDefInfo
{
    CString m_strName;               // Primary
    short m_nType;   // Primary
    COleDateTime m_dateCreated;      // Secondary
    COleDateTime m_dateLastUpdated;  // Secondary
    BOOL m_bUpdatable;               // Secondary
    BOOL m_bReturnsRecords;          // Secondary
    CString m_strSQL;                // All
    CString m_strConnect;            // All
    short m_nODBCTimeout;            // All
};
```

#### <a name="parameters"></a>Параметры

*m_strName*<br/>
Уникально именует объект QueryDef. Дополнительные сведения см. в разделе "свойство Name" справки DAO. Вызовите [кдаокуеридеф:: Name](../../mfc/reference/cdaoquerydef-class.md#getname) , чтобы получить это свойство напрямую.

*m_nType*<br/>
Значение, указывающее операционный тип объекта QueryDef. Он может иметь одно из следующих значений:

- `dbQSelect` SELECT — запрос выбирает записи.

- `dbQAction` Действие — запрос перемещает или изменяет данные, но не возвращает записи.

- `dbQCrosstab` Перекрестный — запрос возвращает данные в формате, похожем на электронную таблицу.

- `dbQDelete` Delete — запрос удаляет набор указанных строк.

- `dbQUpdate` Обновление — запрос изменяет набор записей.

- `dbQAppend` Append — запрос добавляет новые записи в конец таблицы или запроса.

- `dbQMakeTable` Make-Table — запрос создает новую таблицу из набора записей.

- `dbQDDL` Определение данных — запрос влияет на структуру таблиц или их части.

- `dbQSQLPassThrough` Pass — инструкция SQL передается непосредственно в серверную часть базы данных без промежуточной обработки.

- `dbQSetOperation` Union — запрос создает объект набора записей моментального снимка, содержащий данные из всех указанных записей в двух или более таблицах с удаленными повторяющимися записями. Чтобы включить дубликаты, добавьте ключевое слово **ALL** в инструкцию SQL QueryDef.

- `dbQSPTBulk` Используется с `dbQSQLPassThrough` для указания запроса, который не возвращает записи.

> [!NOTE]
> Для создания запроса к серверу SQL не нужно задавать `dbQSQLPassThrough` константу. Он задается автоматически ядром базы данных Microsoft Jet при создании объекта QueryDef и задании свойства Connect.

Дополнительные сведения см. в разделе "свойство Type" справки DAO.

*m_dateCreated*<br/>
Дата и время создания QueryDef. Чтобы непосредственно получить дату создания объекта QueryDef, вызовите функцию члена [жетдатекреатед](../../mfc/reference/cdaotabledef-class.md#getdatecreated) `CDaoTableDef` объекта, связанного с таблицей. Дополнительные сведения см. в комментариях ниже. См. также раздел «DateCreated, свойства LastUpdated» справки DAO.

*m_dateLastUpdated*<br/>
Дата и время последнего изменения, внесенного в QueryDef. Чтобы напрямую получить дату последнего обновления таблицы, вызовите функцию члена [жетдателаступдатед](../../mfc/reference/cdaoquerydef-class.md#getdatelastupdated) объекта QueryDef. Дополнительные сведения см. в комментариях ниже. См. раздел «DateCreated, свойства LastUpdated» справки DAO.

*m_bUpdatable*<br/>
Указывает, можно ли вносить изменения в объект QueryDef. Если это свойство имеет значение TRUE, QueryDef является обновляемым; в противном случае — нет. Обновляемое значение означает, что определение запроса объекта QueryDef может быть изменено. Обновляемому свойству объекта QueryDef присваивается значение TRUE, если определение запроса может быть Обновлено, даже если результирующий набор записей невозможно обновить. Чтобы получить это свойство напрямую, вызовите функцию элемента [канупдате](../../mfc/reference/cdaoquerydef-class.md#canupdate) QueryDef. Дополнительные сведения см. в разделе "обновляемое свойство" справки DAO.

*m_bReturnsRecords*<br/>
Указывает, возвращает ли SQL Server-сквозный запрос к внешней базе данных записи. Если это свойство имеет значение TRUE, запрос возвращает записи. Чтобы напрямую получить это свойство, вызовите метод [кдаокуеридеф:: жетретурнсрекордс](../../mfc/reference/cdaoquerydef-class.md#getreturnsrecords). Не все сквозные запросы SQL к внешним базам данных возвращают записи. Например, инструкция SQL **Update** обновляет записи без возврата записей, а инструкция SQL **SELECT** возвращает записи. Дополнительные сведения см. в разделе "свойство ReturnsRecords" справки DAO.

*m_strSQL*<br/>
Инструкция SQL, определяющая запрос, выполняемый объектом QueryDef. Свойство SQL содержит инструкцию SQL, определяющую, как выбираются записи, группируются и упорядочиваются при выполнении запроса. С помощью запроса можно выбрать записи для включения в объект набора записей динамического типа или моментального снимка. Можно также определить Групповые запросы для изменения данных без возвращения записей. Значение этого свойства можно получить напрямую, вызвав функцию [жетскл](../../mfc/reference/cdaoquerydef-class.md#getsql) элемента QueryDef.

*m_strConnect*<br/>
Предоставляет сведения об источнике базы данных, используемой в транзитном запросе. Эта информация принимает форму строки подключения. Дополнительные сведения о строках соединения и сведения о получении значения этого свойства напрямую см. в описании функции члена [CDaoDatabase:: соединяю](../../mfc/reference/cdaodatabase-class.md#getconnect) .

*m_nODBCTimeout*<br/>
Количество секунд, в течение которых ядро СУБД Microsoft Jet ждет возникновения ошибки времени ожидания при выполнении запроса в базе данных ODBC. При использовании базы данных ODBC, например Microsoft SQL Server, могут возникать задержки из-за сетевого трафика или интенсивного использования сервера ODBC. Вместо бесконечного ожидания можно указать, как долго будет ждать ядро Microsoft Jet, прежде чем будет выдавать ошибку. Значение времени ожидания по умолчанию — 60 секунд. Значение этого свойства можно получить напрямую, вызвав функцию [жетодбктимеаут](../../mfc/reference/cdaoquerydef-class.md#getodbctimeout) элемента QueryDef. Дополнительные сведения см. в разделе «свойство Одбктимеаут» справки DAO.

## <a name="remarks"></a>Комментарии

QueryDef является объектом класса [кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md). Ссылки на первичный, вторичный и все вышеперечисленное указывают, как эта информация возвращается функцией-членом [жеткуеридефинфо](../../mfc/reference/cdaodatabase-class.md#getquerydefinfo) в классе `CDaoDatabase` .

Сведения, получаемые функцией-членом [CDaoDatabase:: жеткуеридефинфо](../../mfc/reference/cdaodatabase-class.md#getquerydefinfo) , хранятся в `CDaoQueryDefInfo` структуре. Вызовите `GetQueryDefInfo` объект базы данных, в коллекции QueryDef которого хранится объект QueryDef. `CDaoQueryDefInfo` также определяет `Dump` функцию-член в отладочных сборках. Можно использовать `Dump` для дампа содержимого `CDaoQueryDefInfo` объекта. Класс `CDaoDatabase` также предоставляет функции-члены для прямого доступа ко всем свойствам, возвращаемым в `CDaoQueryDefInfo` объекте, поэтому вам, вероятно, редко придется вызывать `GetQueryDefInfo` .

При добавлении нового поля или объекта параметра в коллекцию полей или параметров объекта QueryDef создается исключение, если базовая база данных не поддерживает тип данных, указанный для нового объекта.

Параметры даты и времени производятся на основе компьютера, на котором был создан или последний раз обновлен объект QueryDef. В многопользовательской среде пользователи должны получить эти параметры непосредственно с файлового сервера с помощью команды **net time** , чтобы избежать расхождений в параметрах свойств DateCreated и LastUpdated.

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

## <a name="see-also"></a>См. также раздел

[Структуры, стили, обратные вызовы и схемы сообщений](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)<br/>
[Класс Кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)
