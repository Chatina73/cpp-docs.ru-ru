---
description: 'Дополнительные сведения о: CRichEditCtrl Class'
title: Класс CRichEditCtrl
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 597f8c8b9a90dc9bc44f408558bc6ab3aa5c2779
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97264795"
---
# <a name="cricheditctrl-class"></a>Класс CRichEditCtrl

Предоставляет функции элемента управления форматированным редактированием.

## <a name="syntax"></a>Синтаксис

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CRichEditCtrl:: CRichEditCtrl](#cricheditctrl)|Формирует объект `CRichEditCtrl`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CRichEditCtrl:: Канпасте](#canpaste)|Определяет, можно ли вставлять содержимое буфера обмена в этот элемент управления Rich Edit.|
|[CRichEditCtrl:: Канредо](#canredo)|Определяет, существуют ли какие либо действия в очереди повторов элемента управления.|
|[CRichEditCtrl:: Канундо](#canundo)|Определяет, можно ли отменить операцию редактирования.|
|[CRichEditCtrl:: Чарфромпос](#charfrompos)|Извлекает сведения о символе, ближайшее к заданной точке в клиентской области элемента управления "поле ввода".|
|[CRichEditCtrl:: Clear](#clear)|Очищает текущее выделение.|
|[CRichEditCtrl:: Copy](#copy)|Копирует текущий выделенный фрагмент в буфер обмена.|
|[CRichEditCtrl:: Create](#create)|Создает элемент управления Rich Edit для Windows и связывает его с этим `CRichEditCtrl` объектом.|
|[CRichEditCtrl:: Креатикс](#createex)|Создает элемент управления Rich Edit для Windows с указанными расширенными стилями Windows и связывает его с этим `CRichEditCtrl` объектом.|
|[CRichEditCtrl:: Cut](#cut)|Вырезает текущий выделенный фрагмент в буфер обмена.|
|[CRichEditCtrl::D Исплайбанд](#displayband)|Отображает часть содержимого этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Емптюндобуффер](#emptyundobuffer)|Сбрасывает (очищает) флаг отмены для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: строки FindText](#findtext)|Находит текст в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Финдвордбреак](#findwordbreak)|Поиск следующего разрыва слова до или после указанной позиции символа или получение сведений о символе в этой позиции.|
|[CRichEditCtrl:: Форматранже](#formatrange)|Форматирует диапазон текста для целевого выходного устройства.|
|[CRichEditCtrl:: Жетчарпос](#getcharpos)|Определяет расположение заданного символа в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Жетдефаултчарформат](#getdefaultcharformat)|Извлекает текущие атрибуты форматирования символов по умолчанию в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: GetEventMask](#geteventmask)|Извлекает маску события для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Жетфирствисиблелине](#getfirstvisibleline)|Определяет верхнюю видимую строку в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Жетиричедитоле](#getiricheditole)|Получает указатель на `IRichEditOle` интерфейс для этого элемента управления Rich Edit.|
|[CRichEditCtrl:: Жетлимиттекст](#getlimittext)|Возвращает ограничение на объем текста, который пользователь может ввести в этот `CRichEditCtrl` объект.|
|[CRichEditCtrl:: Inline](#getline)|Извлекает строку текста из этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Жетлинекаунт](#getlinecount)|Извлекает количество строк в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Modify](#getmodify)|Определяет, изменилось ли содержимое этого `CRichEditCtrl` объекта с момента последнего сохранения.|
|[CRichEditCtrl:: параметр](#getoptions)|Извлекает параметры элемента управления Rich Edit.|
|[CRichEditCtrl:: Жетпараформат](#getparaformat)|Извлекает атрибуты форматирования абзаца в текущем выделенном фрагменте данного `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: препинания](#getpunctuation)|Извлекает текущие знаки пунктуации для элемента управления Rich Edit. Это сообщение доступно только в версиях операционной системы для азиатских языков.|
|[CRichEditCtrl:: коrect](#getrect)|Извлекает прямоугольник форматирования для данного `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Жетредонаме](#getredoname)|Возвращает тип следующего действия (при его наличии) в очереди повторов элемента управления.|
|[CRichEditCtrl:: Жетсел](#getsel)|Возвращает начальную и конечную позиции текущего выделения в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Жетселектиончарформат](#getselectioncharformat)|Извлекает атрибуты форматирования символов в текущем выделенном фрагменте данного `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Жетселектионтипе](#getselectiontype)|Извлекает тип содержимого в текущем выделенном фрагменте в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Жетселтекст](#getseltext)|Возвращает текст текущего выделения в этом `CRichEditCtrl` объекте|
|[CRichEditCtrl:: Жеттекстленгс](#gettextlength)|Извлекает длину текста в символах в этом `CRichEditCtrl` объекте. Не включает завершающий нуль символ.|
|[CRichEditCtrl:: Жеттекстленгсекс](#gettextlengthex)|Извлекает количество символов или байтов в представлении с расширенным редактированием. Принимает список флагов для указания метода определения длины текста в элементе управления Rich Edit|
|[CRichEditCtrl:: Жеттекстмоде](#gettextmode)|Извлекает текущий текстовый режим и уровень отменяемого элемента управления расширенного редактирования.|
|[CRichEditCtrl:: Жеттекстранже](#gettextrange)|Извлекает указанный диапазон текста.|
|[CRichEditCtrl:: Жетундонаме](#getundoname)|Возвращает тип следующего действия отмены, если оно имеется.|
|[CRichEditCtrl:: Жетвордврапмоде](#getwordwrapmode)|Извлекает текущие параметры переноса слов и разбиения по словам для элемента управления Rich Edit. Это сообщение доступно только в версиях операционной системы для азиатских языков.|
|[CRichEditCtrl:: Хидеселектион](#hideselection)|Показывает или скрывает текущий выделенный фрагмент.|
|[CRichEditCtrl:: Лимиттекст](#limittext)|Ограничивает объем текста, который пользователь может ввести в `CRichEditCtrl` объект.|
|[CRichEditCtrl:: Линефромчар](#linefromchar)|Определяет, какая строка содержит данный символ.|
|[CRichEditCtrl:: Линеиндекс](#lineindex)|Возвращает индекс символа данной строки в данном `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Линеленгс](#linelength)|Извлекает длину данной строки в данном `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Линескролл](#linescroll)|Прокручивает текст в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl::P вставить](#paste)|Вставляет содержимое буфера обмена в этот элемент управления Rich Edit.|
|[CRichEditCtrl::P АстеспеЦиал](#pastespecial)|Вставляет содержимое буфера обмена в этот элемент управления Rich Edit в указанном формате данных.|
|[CRichEditCtrl::P Осфромчар](#posfromchar)|Получает координаты клиентской области указанного символа в элементе управления "поле ввода".|
|[CRichEditCtrl:: Redo](#redo)|Повторно выполняет следующее действие в очереди повтора элемента управления.|
|[CRichEditCtrl:: Реплацесел](#replacesel)|Заменяет текущий выбор в этом `CRichEditCtrl` объекте на указанный текст.|
|[CRichEditCtrl:: Рекуестресизе](#requestresize)|Заставляет этот `CRichEditCtrl` объект отправлять уведомления об изменении размера запроса.|
|[CRichEditCtrl:: Сетаутаурлдетект](#setautourldetect)|Указывает, активно ли автоматическое обнаружение URL-адресов в элементе управления Rich Edit.|
|[CRichEditCtrl:: Сетбаккграундколор](#setbackgroundcolor)|Задает цвет фона в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Сетдефаултчарформат](#setdefaultcharformat)|Задает текущие атрибуты форматирования символов по умолчанию в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: SetEventMask](#seteventmask)|Задает маску события для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Сетмодифи](#setmodify)|Задает или очищает флаг изменения для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Сетолекаллбакк](#setolecallback)|Задает `IRichEditOleCallback` COM-объект для этого элемента управления Rich Edit.|
|[CRichEditCtrl:: Сетоптионс](#setoptions)|Задает параметры для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Сетпараформат](#setparaformat)|Задает атрибуты форматирования абзаца в текущем выделенном фрагменте в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Сетпунктуатион](#setpunctuation)|Задает знаки пунктуации для элемента управления Rich Edit. Это сообщение доступно только в версиях операционной системы для азиатских языков.|
|[CRichEditCtrl:: SetReadOnly](#setreadonly)|Устанавливает параметр "только для чтения" для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: SetRect](#setrect)|Задает прямоугольник форматирования для данного `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Сетсел](#setsel)|Задает выбор в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Сетселектиончарформат](#setselectioncharformat)|Задает атрибуты форматирования символов в текущем выделенном фрагменте в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Сеттаржетдевице](#settargetdevice)|Задает целевое устройство вывода для этого `CRichEditCtrl` объекта.|
|[CRichEditCtrl:: Сеттекстмоде](#settextmode)|Задает режим текста или уровень отмены для элемента управления расширенного редактирования. Сообщение завершается ошибкой, если элемент управления содержит текст.|
|[CRichEditCtrl:: Сетундолимит](#setundolimit)|Задает максимальное число действий, которые могут храниться в очереди отмены.|
|[CRichEditCtrl:: Сетвордчарформат](#setwordcharformat)|Задает атрибуты форматирования символов в текущем слове в этом `CRichEditCtrl` объекте.|
|[CRichEditCtrl:: Сетвордврапмоде](#setwordwrapmode)|Задает параметры переноса слов и разбиения по словам для элемента управления Rich Edit. Это сообщение доступно только в версиях операционной системы для азиатских языков.|
|[CRichEditCtrl:: Стопграуптипинг](#stopgrouptyping)|Запрещает элементу управления собирать дополнительные действия по вводу в текущее действие отмены. Элемент управления сохраняет следующее действие ввода, если оно есть, в новое действие в очереди отмены.|
|[CRichEditCtrl:: Streaming](#streamin)|Вставляет текст из входного потока в этот `CRichEditCtrl` объект.|
|[CRichEditCtrl:: потоковая передача](#streamout)|Сохраняет текст из этого `CRichEditCtrl` объекта в поток вывода.|
|[CRichEditCtrl:: Undo](#undo)|Меняет местами последнюю операцию редактирования.|

## <a name="remarks"></a>Комментарии

«Форматируемый элемент управления» — это окно, в котором пользователь может вводить и редактировать текст. Тексту можно присвоить форматирование символов и абзацев, а также включить внедренные объекты OLE. Элементы управления Rich Edit предоставляют программный интерфейс для форматирования текста. Однако приложение должно реализовывать любые компоненты пользовательского интерфейса, необходимые для того, чтобы сделать операции форматирования доступными для пользователя.

Этот общий элемент управления Windows (и, следовательно, `CRichEditCtrl` класс) доступен только для программ, работающих под управлением windows 95/98 и Windows NT версии 3,51 и более поздних версий. `CRichEditCtrl`Класс поддерживает версии 2,0 и 3,0 элемента управления Windows SDK Rich Edit.

> [!CAUTION]
> При использовании элемента управления Rich Edit в диалоговом окне (независимо от того, является ли приложение SDI, MDI или диалоговое окно), необходимо вызвать [афксинитричедит](application-information-and-management.md#afxinitrichedit) один раз перед отображением диалогового окна. Типичным местом вызова этой функции является `InitInstance` функция-член программы. Его не нужно вызывать для каждого открытия диалогового окна только в первый раз. Вам не нужно вызывать, `AfxInitRichEdit` Если вы работаете с `CRichEditView` .

Дополнительные сведения об использовании см `CRichEditCtrl` . в следующих статьях:

- [Элементы управления](../../mfc/controls-mfc.md)

- [Использование CRichEditCtrl](../../mfc/using-cricheditctrl.md)

Пример использования элемента управления Rich Edit в приложении MFC см. в примере приложения [WordPad](../../overview/visual-cpp-samples.md) .

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>Требования

**Заголовок:** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a> CRichEditCtrl:: Канпасте

Определяет, может ли элемент управления Rich Edit вставлять указанный формат буфера обмена.

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>Параметры

*нформат*<br/>
Формат данных буфера обмена для запроса. Этот параметр может быть одним из стандартных форматов буфера обмена или значением, возвращаемым функцией [регистерклипбоардформат](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если можно вставлять формат буфера обмена; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Если *нформат* имеет значение 0, `CanPaste` будет пытаться использовать любой формат в буфере обмена.

Дополнительные сведения см. в разделе [EM_CANPASTE](/windows/win32/Controls/em-canpaste) Message и [регистерклипбоардформат](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw) Function в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a> CRichEditCtrl:: Канредо

Определяет, содержит ли очередь повтора какие бы то ни было действия.

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если очередь повтора содержит действия; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Чтобы обнаружить имя операции в очереди повторов, вызовите метод [CRichEditCtrl:: жетредонаме](#getredoname). Чтобы повторить последнюю операцию отмены, вызовите метод [Redo](#redo).

Дополнительные сведения см. в разделе [EM_CANREDO](/windows/win32/Controls/em-canredo) в Windows SDK.

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a> CRichEditCtrl:: Канундо

Определяет, может ли быть отменена последняя операция редактирования.

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если последняя операция редактирования может быть отменена вызовом функции-члена [отмены](#undo) ; 0, если это невозможно отменить.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_CANUNDO](/windows/win32/Controls/em-canundo) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a> CRichEditCtrl:: Чарфромпос

Извлекает сведения о символе в точке, заданной параметром *PT*.

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>Параметры

*пт*<br/>
Объект [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) , содержащий координаты указанной точки.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс символа, ближайшего к указанной точке. Если указанная точка находится за последним символом в элементе управления, возвращаемое значение обозначает последний символ в элементе управления.

### <a name="remarks"></a>Комментарии

Эта функция-член работает с элементом управления Rich Edit. Чтобы получить сведения для элемента управления "поле ввода", вызовите метод [CEdit:: чарфромпос](../../mfc/reference/cedit-class.md#charfrompos).

Дополнительные сведения см. в разделе [EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) в Windows SDK.

## <a name="cricheditctrlclear"></a><a name="clear"></a> CRichEditCtrl:: Clear

Удаляет (очищает) текущий выбор (если есть) в элементе управления Rich Edit.

```cpp
void Clear();
```

### <a name="remarks"></a>Комментарии

Удаление, выполненное, `Clear` может быть отменено путем вызова функции [отмены](#undo) члена.

Чтобы удалить текущее выделение и поместить удаленное содержимое в буфер обмена, вызовите функцию [вырезания](#cut) члена.

Дополнительные сведения см. в разделе [WM_CLEAR](/windows/win32/dataxchg/wm-clear) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a> CRichEditCtrl:: Copy

Копирует текущее выделение (если таковое имеется) из элемента управления Rich Edit в буфер обмена.

```cpp
void Copy();
```

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [WM_COPY](/windows/win32/dataxchg/wm-copy) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a> CRichEditCtrl:: Create

Создает элемент управления Rich Edit для Windows и связывает его с этим `CRichEditCtrl` объектом.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*двстиле*<br/>
Задает стиль элемента управления "поле ввода". Примените сочетание стилей окон, перечисленных в разделе **"Примечания** " ниже, и [стили элементов управления](/windows/win32/Controls/edit-control-styles), описанные в Windows SDK.

*rect*<br/>
Задает размер и расположение элемента управления "поле ввода". Может быть объектом [крект](../../atl-mfc-shared/reference/crect-class.md) или структурой [Rect](/windows/win32/api/windef/ns-windef-rect) .

*ппарентвнд*<br/>
Указывает родительское окно элемента управления редактирования (часто это [CDialog](../../mfc/reference/cdialog-class.md)). Оно не должно иметь значение NULL.

*nID*<br/>
Указывает идентификатор элемента управления "поле ввода".

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если инициализация прошла успешно; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

`CRichEditCtrl`Объект создается в два этапа. Сначала вызовите конструктор [CRichEditCtrl](#cricheditctrl) , а затем вызовите метод `Create` , который создает элемент управления Windows Edit и присоединяет его к `CRichEditCtrl` объекту.

При создании элемента управления Rich Edit с помощью этой функции сначала необходимо загрузить необходимую библиотеку стандартных элементов управления. Чтобы загрузить библиотеку, вызовите глобальную функцию [афксинитричедит](application-information-and-management.md#afxinitrichedit), которая, в свою очередь, инициализирует библиотеку Common Controls. В процессе необходимо вызвать `AfxInitRichEdit` только один раз.

Когда `Create` выполняется, Windows отправляет в элемент управления "поле ввода" [WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate), [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize), [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)и [WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) сообщения.

Эти сообщения по умолчанию обрабатываются функциями элементов [оннккреате](../../mfc/reference/cwnd-class.md#onnccreate), [Оннккалксизе](../../mfc/reference/cwnd-class.md#onnccalcsize), [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)и [онжетминмаксинфо](../../mfc/reference/cwnd-class.md#ongetminmaxinfo) в `CWnd` базовом классе. Чтобы расширить обработку сообщений по умолчанию, создайте производный класс от `CRichEditCtrl` , добавьте к новому классу схему сообщений и переопределите приведенные выше функции-члены обработчика сообщений. Переопределение `OnCreate` , например, для выполнения необходимой инициализации нового класса.

Применить следующие [стили окна](../../mfc/reference/styles-used-by-mfc.md#window-styles) к элементу управления "поле ввода".

- WS_CHILD всегда.

- Обычно WS_VISIBLE.

- WS_DISABLED редко.

- WS_GROUP для группировки элементов управления.

- WS_TABSTOP включить элемент управления "поле ввода" в порядок перехода.

Дополнительные сведения о стилях окна см. в разделе [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a> CRichEditCtrl:: Креатикс

Создает элемент управления (дочернее окно) и связывает его с `CRichEditCtrl` объектом.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Параметры

*двексстиле*<br/>
Задает расширенный стиль создаваемого элемента управления. Список расширенных стилей Windows см. в разделе параметр *двексстиле* для [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) в Windows SDK.

*двстиле*<br/>
Задает стиль элемента управления "поле ввода". Примените сочетание стилей окон, перечисленных в разделе **"Примечания** " раздела [Создание](#create) и [изменение стилей элементов управления](/windows/win32/Controls/edit-control-styles), описанных в Windows SDK.

*rect*<br/>
Ссылка на структуру [Rect](/windows/win32/api/windef/ns-windef-rect) , описывающую размер и расположение создаваемого окна в клиентских координатах *ппарентвнд*.

*ппарентвнд*<br/>
Указатель на окно, которое является родительским элементом управления.

*nID*<br/>
Идентификатор дочернего окна элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Комментарии

Используйте `CreateEx` вместо `Create` для применения расширенных стилей Windows, заданных **WS_EX_** в расширенном стиле Windows.

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a> CRichEditCtrl:: CRichEditCtrl

Формирует объект `CRichEditCtrl`.

```
CRichEditCtrl();
```

### <a name="remarks"></a>Комментарии

Используйте [CREATE](#create) для создания элемента управления Rich Edit Windows.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a> CRichEditCtrl:: Cut

Удаление (вырезание) текущего выделения (если таковые имеются) в элементе управления Rich Edit и копирование удаленного текста в буфер обмена.

```cpp
void Cut();
```

### <a name="remarks"></a>Комментарии

Удаление, выполненное, `Cut` может быть отменено путем вызова функции [отмены](#undo) члена.

Чтобы удалить текущее выделение без помещения удаленного текста в буфер обмена, вызовите функцию [clear](#clear) Member.

Дополнительные сведения см. в разделе [WM_CUT](/windows/win32/dataxchg/wm-cut) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a> CRichEditCtrl::D Исплайбанд

Отображает часть содержимого элемента управления Rich Edit (текст и элементы OLE), как было ранее отформатировано с помощью [форматранже](#formatrange).

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>Параметры

*пдисплайрект*<br/>
Указатель на объект [Rect](/windows/win32/api/windef/ns-windef-rect) или [крект](../../atl-mfc-shared/reference/crect-class.md) , указывающий область устройства для вывода текста.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если отображение форматированного текста выполнено, в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Текст и элементы OLE обрезаются с областью, заданной указателем *пдисплайрект*.

Дополнительные сведения см. в разделе [EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [CRichEditCtrl:: форматранже](#formatrange).

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a> CRichEditCtrl:: Емптюндобуффер

Сбрасывает (очищает) флаг отмены для этого элемента управления Rich Edit.

```cpp
void EmptyUndoBuffer();
```

### <a name="remarks"></a>Комментарии

Теперь элемент управления не сможет отменить последнюю операцию редактирования. Флаг отмены задается каждый раз, когда операция в элементе управления Rich Edit может быть отменена.

Флаг отмены автоматически снимается при каждом вызове функции [](../../mfc/reference/cwnd-class.md) -члена CWnd [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

Дополнительные сведения см. в разделе [EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a> CRichEditCtrl:: строки FindText

Поиск текста в элементе управления Rich Edit.

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>Параметры

*dwFlags*<br/>
Список возможных значений см. в разделе *wParam* в [EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex) в Windows SDK.

*пфиндтекст*<br/>
Указатель на структуру [финдтекстекс](/windows/win32/api/richedit/ns-richedit-findtextexw) , которая предоставляет параметры для поиска и возвращает диапазон, в котором обнаружено совпадение.

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемая от нуля символьное расположение следующего совпадения; -1, если нет других совпадений.

### <a name="remarks"></a>Комментарии

Можно выполнить поиск либо вверх, либо вниз, установив правильные параметры диапазона в структуре [чарранже](/windows/win32/api/richedit/ns-richedit-charrange) в `FINDTEXTEX` структуре.

Дополнительные сведения см. в разделе [EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) Message и структура [финдтекстекс](/windows/win32/api/richedit/ns-richedit-findtextexw) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a> CRichEditCtrl:: Финдвордбреак

Находит следующий разрыв слова до или после расположения, указанного параметром *нстарт*.

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>Параметры

*нкоде*<br/>
Указывает действие, которое необходимо выполнить. Список возможных значений см. в описании *кода* параметра в EM_FINDWORDBREAK в Windows SDK.

*нстарт*<br/>
Отсчитываемый от нуля знак позиции, с которой начинается начало.

### <a name="return-value"></a>Возвращаемое значение

На основе параметра *нкоде*. Дополнительные сведения см. в разделе [EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) в Windows SDK.

### <a name="remarks"></a>Комментарии

Эту функцию-член можно использовать для получения сведений о символе в заданной позиции.

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a> CRichEditCtrl:: Форматранже

Форматирует диапазон текста в элементе управления расширенного редактирования для конкретного устройства.

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>Параметры

*PFR*<br/>
Указатель на структуру [форматранже](/windows/win32/api/richedit/ns-richedit-formatrange) , которая содержит сведения о выходном устройстве. Значение NULL указывает, что кэшированные данные в элементе управления Rich Edit могут быть освобождены.

*бдисплай*<br/>
Указывает, должен ли отображаться текст. Значение FALSE показывает, что текст просто измеряется.

### <a name="return-value"></a>Возвращаемое значение

Индекс последнего символа, помещается в регион плюс один.

### <a name="remarks"></a>Комментарии

Как правило, за этим вызовом следует вызов [дисплайбанд](#displayband).

Дополнительные сведения см. в разделе [EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) Message и структура [форматранже](/windows/win32/api/richedit/ns-richedit-formatrange) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a> CRichEditCtrl:: Жетчарпос

Возвращает значение позиции (верхний левый угол) заданного символа в этом `CRichEditCtrl` объекте.

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>Параметры

*лчар*<br/>
Отсчитываемый от нуля индекс символа.

### <a name="return-value"></a>Возвращаемое значение

Расположение верхнего левого угла символа, указанного параметром *лчар*.

### <a name="remarks"></a>Комментарии

Символ задается путем предоставления значения индекса, начинающегося с нуля. Если *лчар* больше, чем индекс последнего символа в этом `CRichEditCtrl` объекте, возвращаемое значение указывает координаты положения символа сразу после последнего символа в этом `CRichEditCtrl` объекте.

Дополнительные сведения см. в разделе [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) в Windows SDK.

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a> CRichEditCtrl:: Жетдефаултчарформат

Возвращает атрибуты форматирования символов по умолчанию для этого `CRichEditCtrl` объекта.

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии — указатель на `CHARFORMAT` структуру, содержащую атрибуты форматирования символов по умолчанию.

Во второй версии указатель на `CHARFORMAT2` структуру — это расширенное расширение 2,0 для `CHARFORMAT` структуры, содержащее атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

`dwMask`Элемент данных *CF*. Он указал атрибуты форматирования символов по умолчанию.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в EM_GETCHARFORMAT сообщении и `CHARFORMAT` `CHARFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [сетдефаултчарформат](#setdefaultcharformat).

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a> CRichEditCtrl:: GetEventMask

Возвращает маску события для этого `CRichEditCtrl` объекта.

```
long GetEventMask() const;
```

### <a name="return-value"></a>Возвращаемое значение

Маска события для этого `CRichEditCtrl` объекта.

### <a name="remarks"></a>Комментарии

Маска события указывает, какие сообщения уведомления `CRichEditCtrl` отправляет объект в его родительское окно.

Дополнительные сведения см. в разделе [EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [CRichEditCtrl:: SetEventMask](#seteventmask).

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a> CRichEditCtrl:: Жетфирствисиблелине

Определяет верхнюю видимую строку в этом `CRichEditCtrl` объекте.

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>Возвращаемое значение

Отсчитываемый от нуля индекс самой верхней видимой строки в этом `CRichEditCtrl` объекте.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a> CRichEditCtrl:: Жетиричедитоле

Обращается к `IRichEditOle` интерфейсу для этого `CRichEditCtrl` объекта.

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс [иричедитоле](/windows/win32/api/richole/nn-richole-iricheditole) , который может использоваться для доступа к `CRichEditCtrl` функциональным возможностям OLE этого объекта; Значение NULL, если интерфейс недоступен.

### <a name="remarks"></a>Комментарии

Используйте этот интерфейс для доступа к `CRichEditCtrl` функциональным ВОЗМОЖНОСТЯМ OLE этого объекта.

Дополнительные сведения см. в разделе [EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface) Message и интерфейс [иричедитоле](/windows/win32/api/richole/nn-richole-iricheditole) в Windows SDK.

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a> CRichEditCtrl:: Жетлимиттекст

Возвращает ограничение текста для данного `CRichEditCtrl` объекта.

```
long GetLimitText() const;
```

### <a name="return-value"></a>Возвращаемое значение

Текущее ограничение текста для этого объекта (в байтах) `CRichEditCtrl` .

### <a name="remarks"></a>Комментарии

Ограничение текста — это максимальный объем текста в байтах, который может быть принят элементом управления Rich Edit.

Дополнительные сведения см. в разделе [EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a> CRichEditCtrl:: Inline

Извлекает строку текста из этого `CRichEditCtrl` объекта.

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Отсчитываемый от нуля индекс строки для извлечения.

*лпсзбуффер*<br/>
Указывает на буфер для получения текста. В первом слове буфера должно быть указано максимальное число байтов, которое может быть скопировано в буфер.

*нмаксленгс*<br/>
Максимальное число символов, которые могут быть скопированы в *лпсзбуффер*. Вторая форма `GetLine` помещает это значение в первое слово буфера, заданное параметром *лпсзбуффер*.

### <a name="return-value"></a>Возвращаемое значение

Число символов, копируемых в *лпсзбуффер*.

### <a name="remarks"></a>Комментарии

Скопированная строка не содержит завершающего нуль-символа.

> [!NOTE]
> Так как первое слово в буфере содержит количество копируемых символов, убедитесь, что размер буфера не меньше 4 байт.

Дополнительные сведения см. в разделе [EM_GETLINE](/windows/win32/Controls/em-getline) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [жетлинекаунт](#getlinecount).

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a> CRichEditCtrl:: Жетлинекаунт

Возвращает количество строк в `CRichEditCtrl` объекте.

```
int GetLineCount() const;
```

### <a name="return-value"></a>Возвращаемое значение

Число строк в этом `CRichEditCtrl` объекте.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a> CRichEditCtrl:: Modify

Определяет, `CRichEditCtrl` было ли изменено содержимое этого объекта.

```
BOOL GetModify() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если текст в этом `CRichEditCtrl` объекте был изменен; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Windows поддерживает внутренний флаг, указывающий, изменилось ли содержимое элемента управления Rich Edit. Этот флаг снимается при создании элемента управления "поле ввода" и может также быть сброшен путем вызова функции-члена [сетмодифи](#setmodify) .

Дополнительные сведения см. в разделе [EM_GETMODIFY](/windows/win32/Controls/em-getmodify) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a> CRichEditCtrl:: параметр

Извлекает параметры, заданные в данный момент для элемента управления Rich Edit.

```
UINT GetOptions() const;
```

### <a name="return-value"></a>Возвращаемое значение

Сочетание текущих значений флагов параметров. Список этих значений см. в описании параметра *фоптионс* в сообщении [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) , как описано в Windows SDK.

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a> CRichEditCtrl:: Жетпараформат

Возвращает атрибуты форматирования абзаца для текущего выделения.

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>Параметры

*PF*<br/>
В первой версии — указатель на структуру [формата](/windows/win32/api/richedit/ns-richedit-paraformat) с параметром, в которой хранятся атрибуты форматирования абзаца текущего выделения.

Во второй версии — указатель на структуру [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) , которая представляет собой расширенное расширение Edit 2,0 для `PARAFORMAT` структуры, содержащее атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

`dwMask`Элемент данных *PF*. Он задает атрибуты форматирования абзаца, согласованные по всему текущему выделению.

### <a name="remarks"></a>Комментарии

Если выбрано более одного абзаца, *PF* получает атрибуты первого выбранного абзаца. Возвращаемое значение указывает, какие атрибуты согласованы по всему выбору.

Дополнительные сведения см. в [EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat) сообщении и `PARAFORMAT` `PARAFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [CRichEditCtrl:: сетпараформат](#setparaformat).

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a> CRichEditCtrl:: препинания

Возвращает текущие знаки пунктуации в элементе управления Rich Edit.

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>Параметры

*fType*<br/>
Флаг типа пунктуации, как описано в параметре *fType* [EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation) в Windows SDK.

*лппунк*<br/>
Указатель на структуру [пунктуации](/windows/win32/api/richedit/ns-richedit-punctuation) , как описано в Windows SDK.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция прошла

### <a name="remarks"></a>Комментарии

Эта функция-член доступна только в версиях операционной системы, предназначенных для азиатских языков.

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a> CRichEditCtrl:: коrect

Извлекает прямоугольник форматирования для данного `CRichEditCtrl` объекта.

```cpp
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
[Крект](../../atl-mfc-shared/reference/crect-class.md) или указатель на [Rect](/windows/win32/api/windef/ns-windef-rect) для получения прямоугольника форматирования данного `CRichEditCtrl` объекта.

### <a name="remarks"></a>Комментарии

Прямоугольник форматирования — это ограничивающий прямоугольник для текста. Это значение не зависит от размера `CRichEditCtrl` объекта.

Дополнительные сведения см. в разделе [EM_GETRECT](/windows/win32/Controls/em-getrect) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [лимиттекст](#limittext).

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a> CRichEditCtrl:: Жетредонаме

Возвращает тип следующего доступного действия в очереди повтора, если таковой имеется.

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>Возвращаемое значение

В случае успеха `GetRedoName` возвращает тип перечисления [ундонамеид](/windows/win32/api/richedit/ne-richedit-undonameid) , указывающий тип следующего действия в очереди повторов элемента управления. Если очередь повтора пуста или если действие повтора в очереди имеет неизвестный тип, `GetRedoName` возвращает 0.

### <a name="remarks"></a>Комментарии

Типы действий, которые могут быть отменены или повторно выполнены, включают операции ввода, удаления, перетаскивания, вырезания и вставки. Эти сведения могут быть полезны для приложений, которые предоставляют расширенный пользовательский интерфейс для операций отмены и повтора, например раскрывающийся список действий, которые можно повторить.

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a> CRichEditCtrl:: Жетсел

Извлекает границы текущего выделения в этом `CRichEditCtrl` объекте.

```cpp
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>Параметры

*Кредит*<br/>
Ссылка на структуру [чарранже](/windows/win32/api/richedit/ns-richedit-charrange) для получения границ текущего выделения.

*нстартчар*<br/>
Отсчитываемый от нуля индекс первого символа в текущем выделенном фрагменте.

*нендчар*<br/>
Отсчитываемый от нуля индекс последнего символа в текущем выделенном фрагменте.

### <a name="remarks"></a>Комментарии

Две формы этой функции предоставляют альтернативные способы получения границ для выбора. Ниже приведены краткие описания этих форм.

- **Жетсел (** `cr` **)** . Эта форма использует `CHARRANGE` структуру со своими `cpMin` `cpMax` элементами и для возврата границ.

- **Жетсел (** `nStartChar` **,** `nEndChar` **)** . Эта форма Возвращает границы параметров *нстартчар* и *нендчар*.

Выбор включает все, если начало ( `cpMin` или *нстартчар*) равно 0, а конец ( `cpMax` или *нендчар*) равен-1.

Дополнительные сведения см. в разделе [EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) Message и структура [чарранже](/windows/win32/api/richedit/ns-richedit-charrange) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a> CRichEditCtrl:: Жетселектиончарформат

Возвращает атрибуты форматирования символов для текущего выделения.

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии — указатель на структуру [чарформат](/windows/win32/api/richedit/ns-richedit-charformata) для получения атрибутов форматирования символов для текущего выделения.

Во второй версии — указатель на структуру [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , которая является расширенным расширением формата 2,0 для `CHARFORMAT` структуры, чтобы получить атрибуты форматирования символов для текущего выделения.

### <a name="return-value"></a>Возвращаемое значение

`dwMask`Элемент данных *CF*. Он задает атрибуты форматирования символов, согласованные по всему текущему выделению.

### <a name="remarks"></a>Комментарии

Параметр *CF* получает атрибуты первого символа в текущем выделенном фрагменте. Возвращаемое значение указывает, какие атрибуты согласованы по всему выбору.

Дополнительные сведения см. в [EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat) сообщении и `CHARFORMAT` `CHARFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [сетселектиончарформат](#setselectioncharformat).

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a> CRichEditCtrl:: Жетселектионтипе

Определяет тип выбора в этом `CRichEditCtrl` объекте.

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>Возвращаемое значение

Флаги, указывающие содержимое текущего выделения. Сочетание следующих флагов:

- SEL_EMPTY указывает на отсутствие текущего выбора.

- SEL_TEXT указывает, что текущий выделенный фрагмент содержит текст.

- SEL_OBJECT указывает, что текущий выделенный фрагмент содержит по крайней мере один элемент OLE.

- SEL_MULTICHAR указывает, что текущее выделение содержит более одного символа текста.

- SEL_MULTIOBJECT указывает, что текущее выделение содержит более одного объекта OLE.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a> CRichEditCtrl:: Жетселтекст

Извлекает текст из текущего выделения в этом `CRichEditCtrl` объекте.

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>Параметры

*лпбуф*<br/>
Указатель на буфер для получения текста в текущем выделенном фрагменте.

### <a name="return-value"></a>Возвращаемое значение

Зависит от формы:

- **Жетселтекст (** `lpBuf` **)** число символов, копируемых в *лпбуф*, не включая завершение null.

- **Жетселтекст ()** Строка, содержащая текущий выделенный фрагмент.

### <a name="remarks"></a>Комментарии

При использовании первой формы, **жетселтекст (** `lpBuf` **)**, необходимо убедиться в том, что буфер достаточно велик для текста, который он получает. Вызовите [жетсел](#getsel) , чтобы определить количество символов в текущем выделенном фрагменте.

Дополнительные сведения см. в разделе [EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [CRichEditCtrl:: жетселектионтипе](#getselectiontype).

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a> CRichEditCtrl:: Жеттекстленгс

Извлекает длину текста в символах в этом `CRichEditCtrl` объекте, не включая завершающий символ null.

```
long GetTextLength() const;
```

### <a name="return-value"></a>Возвращаемое значение

Длина текста в этом `CRichEditCtrl` объекте.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a> CRichEditCtrl:: Жеттекстленгсекс

Вычисляет длину текста в элементе управления Rich Edit.

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>Параметры

*dwFlags*<br/>
Значение, указывающее метод, используемый для определения длины текста. Этот элемент может быть одним или несколькими значениями, перечисленными в элементе flags элемента [жеттекстленгсекс](/windows/win32/api/richedit/ns-richedit-gettextlengthex) , описанным в Windows SDK.

*укодепаже*<br/>
Кодовая страница для перевода (CP_ACP для кодовой страницы ANSI, 1200 для Юникода).

### <a name="return-value"></a>Возвращаемое значение

Число символов или байтов в элементе управления "поле ввода". Если в *dwFlags* заданы несовместимые флаги, эта функция члена возвращает E_INVALIDARG.

### <a name="remarks"></a>Комментарии

`GetTextLengthEx` предоставляет дополнительные способы определения длины текста. Он поддерживает широкие возможности редактирования 2,0. Дополнительные сведения [об элементах управления](/windows/win32/Controls/about-rich-edit-controls) "поле ввода" см. в разделе о Windows сдкфор.

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a> CRichEditCtrl:: Жеттекстмоде

Извлекает текущий текстовый режим и уровень отменяемого элемента управления расширенного редактирования.

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Набор битовых флагов из типа перечисления [TEXTMODE](/windows/win32/api/richedit/ne-richedit-textmode) , как описано в Windows SDK. Флаги указывают текущий текстовый режим и уровень отмены элемента управления.

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a> CRichEditCtrl:: Жеттекстранже

Возвращает указанный диапазон символов.

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>Параметры

*Nпервая*<br/>
Индекс позиции символа, непосредственно предшествующий первому символу в диапазоне.

*Nпоследний*<br/>
Позиции символа, сразу после последнего символа в диапазоне.

*рефстринг*<br/>
Ссылка на объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , который получит текст.

### <a name="return-value"></a>Возвращаемое значение

Число скопированных символов, не включая завершающий символ null.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) в Windows SDK.

`GetTextRange` поддерживает широкие возможности редактирования 2,0. Дополнительные сведения [об элементах управления](/windows/win32/Controls/about-rich-edit-controls) "поле ввода" см. в разделе о Windows сдкфор.

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a> CRichEditCtrl:: Жетундонаме

Возвращает тип следующего доступного действия в очереди отмены, если таковой имеется.

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>Возвращаемое значение

Если действие отмены находится в очереди отмены элемента управления, `GetUndoName` возвращает тип перечисления [ундонамеид](/windows/win32/api/richedit/ne-richedit-undonameid) , указывающий тип следующего действия в очереди. Если очередь отмены пуста или если действие отмены в очереди имеет неизвестный тип, `GetUndoName` возвращает 0.

### <a name="remarks"></a>Комментарии

Типы действий, которые могут быть отменены или повторно выполнены, включают операции ввода, удаления, перетаскивания, вырезания и вставки. Эти сведения могут быть полезны для приложений, которые предоставляют расширенный пользовательский интерфейс для операций отмены и повтора, например раскрывающийся список действий, которые могут быть отменены.

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a> CRichEditCtrl:: Жетвордврапмоде

Извлекает текущие параметры переноса слов и разбиения по словам для элемента управления Rich Edit.

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>Возвращаемое значение

Текущие параметры переноса слов и разбиения на слова. Эти параметры описаны в разделе [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) в Windows SDK.

### <a name="remarks"></a>Комментарии

Эта функция-член доступна только для версий операционной системы на азиатских языках.

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a> CRichEditCtrl:: Хидеселектион

Изменяет видимость выбранного элемента.

```cpp
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>Параметры

*bHide*<br/>
Указывает, должно ли отображаться или скрываться выделение. значение TRUE, чтобы скрыть выделенный фрагмент.

*бперм*<br/>
Указывает, должно ли это изменение видимости для выбранного фрагмента быть постоянным.

### <a name="remarks"></a>Комментарии

Если *бперм* имеет значение true, то изменяется параметр ECO_NOHIDESEL для этого `CRichEditCtrl` объекта. Краткое описание этого параметра см. в разделе [сетоптионс](#setoptions). С помощью этой функции можно задать все параметры для этого `CRichEditCtrl` объекта.

Дополнительные сведения см. в разделе [EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a> CRichEditCtrl:: Лимиттекст

Ограничивает длину текста, который пользователь может ввести в элемент управления "поле ввода".

```cpp
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>Параметры

*типы nChar*<br/>
Задает длину (в байтах) текста, который может ввести пользователь. Если этот параметр равен 0 (значение по умолчанию), то длина текста равна 64 КБ байт.

### <a name="remarks"></a>Комментарии

Изменение ограничения текста ограничивает только текст, который может вводить пользователь. Он не влияет на текст, уже имеющийся в элементе управления "поле ввода", и не влияет на длину текста, скопированного в элемент управления "поле ввода" функцией члена [SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext) в `CWnd` . Если приложение использует `SetWindowText` функцию для размещения большего текста в элементе управления "поле ввода", чем указано в вызове `LimitText` , пользователь может удалить любой текст в элементе управления "поле ввода". Однако ограничение текста не позволит пользователю заменить существующий текст новым текстом, если только удаление текущего фрагмента текста не повлечет за пределы текста.

> [!NOTE]
> Для ограничения текста каждый элемент OLE считается одиночным символом.

Дополнительные сведения см. в разделе [EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a> CRichEditCtrl:: Линефромчар

Получает номер строки, содержащей указанный индекс символа.

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Содержит значение индекса, начинающееся с нуля, для требуемого символа в тексте элемента управления "поле ввода" или содержит-1. Если *ниндекс* имеет значение-1, то он задает текущую строку, то есть строку, содержащую курсор.

### <a name="return-value"></a>Возвращаемое значение

Номер строки (начинающийся с нуля) строки, содержащей индекс символа, заданный параметром *ниндекс*. Если *ниндекс* имеет значение-1, возвращается номер строки, содержащей первый символ выделения. Если ничего не выбрано, возвращается номер текущей строки.

### <a name="remarks"></a>Комментарии

Символьный индекс — это число символов от начала элемента управления Rich Edit. Для подсчета символов элемент OLE считается одиночным символом.

Дополнительные сведения см. в разделе [EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a> CRichEditCtrl:: Линеиндекс

Возвращает индекс символа строки в этом `CRichEditCtrl` объекте.

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>Параметры

*nСтрока*<br/>
Содержит значение индекса для нужной строки в тексте элемента управления "поле ввода" или содержит-1. Если *nСтрока* имеет значение-1, то он задает текущую строку, то есть строку, содержащую курсор.

### <a name="return-value"></a>Возвращаемое значение

Индекс символа в строке, указанной в *nСтрока* , или-1, если номер строки больше числа строк в элементе управления "поле ввода".

### <a name="remarks"></a>Комментарии

Индекс символа — это число символов от начала элемента управления Rich Edit до указанной строки.

Дополнительные сведения см. в разделе [EM_LINEINDEX](/windows/win32/controls/em-lineindex) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a> CRichEditCtrl:: Линеленгс

Извлекает длину строки в элементе управления Rich Edit.

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>Параметры

*nСтрока*<br/>
Указывает индекс символа в строке, длина которого должна быть получена. Если этот параметр имеет значение-1, то возвращается длина текущей строки (строки, содержащей курсор), не включая длину выделенного текста в строке. При `LineLength` вызове для однострочного элемента управления Edit этот параметр игнорируется.

### <a name="return-value"></a>Возвращаемое значение

Когда `LineLength` вызывается для многострочного элемента управления Edit, возвращаемое значение является длиной (в TCHAR) строки, заданной параметром *nСтрока*.  Он не включает символ возврата каретки в конце строки. При `LineLength` вызове для однострочного элемента управления "поле ввода" возвращаемое значение является длиной (в TCHAR) текста в элементе управления "поле ввода". Если nСтрока больше числа символов в элементе управления, возвращаемое значение равно нулю.

### <a name="remarks"></a>Комментарии

Используйте функцию-член [линеиндекс](#lineindex) , чтобы получить индекс символа для заданного номера строки в этом `CRichEditCtrl` объекте.

Дополнительные сведения см. в разделе [EM_LINELENGTH](/windows/win32/Controls/em-linelength) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [линеиндекс](#lineindex).

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a> CRichEditCtrl:: Линескролл

Прокручивает текст многострочного элемента управления Edit.

```cpp
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>Параметры

*нлинес*<br/>
Указывает число строк для вертикальной прокрутки.

*типы nChar*<br/>
Указывает количество позиций символов для горизонтальной прокрутки. Это значение пропускается, если элемент управления Rich Edit имеет стиль ES_RIGHT или ES_CENTER. [Изменение стилей](../../mfc/reference/styles-used-by-mfc.md#edit-styles) задается в [CREATE](#create).

### <a name="remarks"></a>Комментарии

Элемент управления "поле ввода" не прокручивается вертикально за последней строкой текста в элементе управления "поле ввода". Если текущая строка плюс число строк, заданное параметром *нлинес* , превышает общее число строк в элементе управления "поле ввода", значение корректируется таким образом, что последняя строка элемента управления "поле ввода" прокручивается до верхней границы окна "Правка-элемент управления".

`LineScroll` можно использовать для прокрутки по горизонтали за последним символом любой строки.

Дополнительные сведения см. в разделе [EM_LINESCROLL](/windows/win32/Controls/em-linescroll) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [жетфирствисиблелине](#getfirstvisibleline).

## <a name="cricheditctrlpaste"></a><a name="paste"></a> CRichEditCtrl::P вставить

Вставляет данные из буфера обмена в точку вставки в позицию курсора `CRichEditCtrl` .

```cpp
void Paste();
```

### <a name="remarks"></a>Комментарии

Данные вставляются только в том случае, если буфер обмена содержит данные в распознанном формате.

Дополнительные сведения см. в разделе [WM_PASTE](/windows/win32/dataxchg/wm-paste) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a> CRichEditCtrl::P АстеспеЦиал

Вставляет данные в конкретный формат буфера обмена в этот `CRichEditCtrl` объект.

```cpp
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>Параметры

*нклипформат*<br/>
Формат буфера обмена для вставки в этот `CRichEditCtrl` объект.

*дваспект*<br/>
Аспект устройства для получения данных из буфера обмена.

*хмф*<br/>
Маркер для метафайла, содержащего значок для вставленного объекта.

### <a name="remarks"></a>Комментарии

Новый материал вставляется в позицию курсора, где находится курсор.

Дополнительные сведения см. в разделе [EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a> CRichEditCtrl::P Осфромчар

Получает координаты клиентской области указанного символа в элементе управления "поле ввода".

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Отсчитываемый от нуля индекс символа.

### <a name="return-value"></a>Возвращаемое значение

Расположение символа (x, y). Для однострочного элемента управления «поле ввода» координата y всегда равна нулю.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) в Windows SDK.

## <a name="cricheditctrlredo"></a><a name="redo"></a> CRichEditCtrl:: Redo

Повторно выполняет следующее действие в очереди повтора элемента управления.

```
BOOL Redo();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Дополнительные сведения см. в разделе [EM_REDO](/windows/win32/Controls/em-redo) в Windows SDK.

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a> CRichEditCtrl:: Реплацесел

Заменяет текущий выбор в объекте на `CRichEditCtrl` указанный текст.

```cpp
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>Параметры

*лпсзневтекст*<br/>
Указатель на строку с завершающим нулем, содержащую замещающий текст.

*бканундо*<br/>
Чтобы указать, что эту функцию можно отменить, присвойте этому параметру значение TRUE. Значение по умолчанию — FALSE.

### <a name="remarks"></a>Комментарии

Чтобы заменить весь текст в этом `CRichEditCtrl` объекте, используйте [CWnd:: SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext).

Если текущий выбор отсутствует, замещающий текст вставляется в позицию вставки, то есть текущее положение курсора.

Эта функция форматирует вставленный текст с помощью существующего форматирования символов. При замене всего диапазона текста (путем вызова `SetSel` (0,-1) перед вызовом `ReplaceSel` ) имеется символ конца абзаца, сохраняющий форматирование предыдущего абзаца, который в унаследован вставленным текстом.

Дополнительные сведения см. в разделе [EM_REPLACESEL](/windows/win32/Controls/em-replacesel) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [линеиндекс](#lineindex).

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a> CRichEditCtrl:: Рекуестресизе

Заставляет этот `CRichEditCtrl` объект передавать сообщения EN_REQUESTRESIZE уведомления родительскому окну.

```cpp
void RequestResize();
```

### <a name="remarks"></a>Комментарии

Эта функция полезна при обработке [CWnd:: OnSize](../../mfc/reference/cwnd-class.md#onsize) для ненижнего `CRichEditCtrl` объекта.

Дополнительные сведения см. в подразделе [EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize) сообщение и элементы управления неограниченным набором данных с **небольшими возможностями** для [элементов управления Rich Edit](/windows/win32/Controls/about-rich-edit-controls) в Windows SDK.

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a> CRichEditCtrl:: Сетаутаурлдетект

Задает элемент управления Rich Edit для автоматического обнаружения URL-адреса.

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
Указывает, настроен ли для элемента управления Автоматическое обнаружение URL-адреса. Если значение — TRUE, оно включено. Если значение равно FALSE, то оно отключено.

### <a name="return-value"></a>Возвращаемое значение

Ноль в случае успеха, в противном случае — ненулевой. Например, сообщение может завершиться ошибкой из-за нехватки памяти.

### <a name="remarks"></a>Комментарии

Если этот параметр включен, элемент управления Rich Edit будет сканировать текст, чтобы определить, соответствует ли он стандартному формату URL-адреса. Список этих форматов URL-адресов см. в разделе [EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) в Windows SDK.

> [!NOTE]
> Не устанавливайте значение `SetAutoURLDetect` true, если элемент управления "поле ввода" использует CFE_LINKный результат для текста, отличного от URL-адресов. `SetAutoURLDetect` включает этот результат для URL-адресов и отключает его для всего остального текста. Дополнительные сведения о CFE_LINKном результате см. в разделе [EN_LINK](/windows/win32/Controls/en-link) .

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a> CRichEditCtrl:: Сетбаккграундколор

Задает цвет фона для этого `CRichEditCtrl` объекта.

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>Параметры

*бсисколор*<br/>
Указывает, следует ли задать цвет фона для системного значения. Если это значение равно TRUE, *CR* игнорируется.

*Кредит*<br/>
Запрошенный цвет фона. Используется, только если *бсисколор* имеет значение false.

### <a name="return-value"></a>Возвращаемое значение

Предыдущий цвет фона для этого `CRichEditCtrl` объекта.

### <a name="remarks"></a>Комментарии

Цвет фона может быть установлен в системное значение или в указанное значение [COLORREF](/windows/win32/gdi/colorref) .

Дополнительные сведения см. в разделе [EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) Message и структура [COLORREF](/windows/win32/gdi/colorref) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a> CRichEditCtrl:: Сетдефаултчарформат

Задает атрибуты форматирования символов для нового текста в этом `CRichEditCtrl` объекте.

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии — указатель на структуру [чарформат](/windows/win32/api/richedit/ns-richedit-charformata) , содержащую новые атрибуты форматирования символов по умолчанию.

Во второй версии — указатель на структуру [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , которая представляет собой расширенное расширение Edit 2,0 для `CHARFORMAT` структуры, содержащее атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Эта функция изменяет только атрибуты, указанные `dwMask` членом *CF* .

Дополнительные сведения см. в [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) сообщении и `CHARFORMAT` `CHARFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a> CRichEditCtrl:: SetEventMask

Задает маску события для этого `CRichEditCtrl` объекта.

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>Параметры

*двевентмаск*<br/>
Новая маска событий для этого `CRichEditCtrl` объекта.

### <a name="return-value"></a>Возвращаемое значение

Предыдущая маска событий.

### <a name="remarks"></a>Комментарии

Маска события указывает, какие сообщения уведомления `CRichEditCtrl` отправляет объект в его родительское окно.

Дополнительные сведения см. в разделе [EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a> CRichEditCtrl:: Сетмодифи

Задает или очищает измененный флаг для элемента управления "поле ввода".

```cpp
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Параметры

*бмодифиед*<br/>
Значение TRUE указывает, что текст был изменен, а значение FALSE указывает на то, что оно не изменено. По умолчанию измененный флаг установлен.

### <a name="remarks"></a>Комментарии

Измененный флаг показывает, был ли изменен текст в элементе управления "поле ввода". Он автоматически задается при каждом изменении пользователем текста. Его значение можно получить [с помощью функции члена.](#getmodify)

Дополнительные сведения см. в разделе [EM_SETMODIFY](/windows/win32/Controls/em-setmodify) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [изменения](#getmodify).

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a> CRichEditCtrl:: Сетолекаллбакк

Предоставляет этот `CRichEditCtrl` объект объекту, который `IRichEditOleCallback` используется для доступа к ресурсам и данным, связанным с OLE.

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>Параметры

*pCallback*<br/>
Указатель на объект [иричедитолекаллбакк](/windows/win32/api/richole/nn-richole-iricheditolecallback) , который `CRichEditCtrl` будет использоваться этим объектом для получения ресурсов и сведений, связанных с OLE.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Этот `CRichEditCtrl` объект вызывает [IUnknown:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) для увеличения числа ИСПОЛЬЗОВАНИЙ для COM-объекта, заданного параметром *пкаллбакк*.

Дополнительные сведения см. в разделе [EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback) Message и интерфейс [иричедитолекаллбакк](/windows/win32/api/richole/nn-richole-iricheditolecallback) в Windows SDK.

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a> CRichEditCtrl:: Сетоптионс

Задает параметры для этого `CRichEditCtrl` объекта.

```cpp
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>Параметры

*воп*<br/>
Указывает тип операции. Одно из следующих значений:

- ECOOP_SET задать параметры, заданные параметром *dwFlags*.

- ECOOP_OR объединить текущие параметры с параметрами, заданными параметром *dwFlags*.

- ECOOP_AND хранить только текущие параметры, которые также задаются параметром *dwFlags*.

- ECOOP_XOR логически исключаются или текущие параметры с параметрами, заданными параметром *dwFlags*.

*dwFlags*<br/>
Широкие возможности редактирования. Значения флагов перечислены в разделе "Примечания".

### <a name="remarks"></a>Комментарии

Параметры могут быть сочетанием следующих значений:

- ECO_AUTOWORDSELECTION автоматический выбор слов при двойном щелчке.

- ECO_AUTOVSCROLL автоматически прокручивает текст вправо на 10 символов, когда пользователь вводит символ в конце строки. Когда пользователь нажимает клавишу ВВОД, элемент управления прокручивает весь текст обратно в нулевое расположение.

- ECO_AUTOHSCROLL автоматически прокручивает текст вверх на одну страницу, когда пользователь нажмет клавишу ВВОД в последней строке.

- ECO_NOHIDESEL инвертирует поведение по умолчанию для элемента управления "поле ввода". Поведение по умолчанию скрывает выделение, когда элемент управления теряет фокус ввода и показывает выбор, когда элемент управления получает фокус ввода. Если указать ECO_NOHIDESEL, выделенный текст будет инвертирован, даже если элемент управления не имеет фокуса.

- ECO_READONLY не разрешает пользователю вводить или редактировать текст в элементе управления "поле ввода".

- ECO_WANTRETURN указывает, что символ возврата каретки вставляется, когда пользователь нажимает клавишу ВВОД при вводе текста в многострочный элемент управления Rich Edit в диалоговом окне. Если этот стиль не указан, нажатие клавиши ВВОД отправляет команду в родительское окно элемента управления Rich Edit, которое имитирует нажатие кнопки по умолчанию родительского окна (например, кнопка ОК в диалоговом окне). Этот стиль не влияет на однострочный элемент управления Edit.

- ECO_SAVESEL сохраняет выделение, когда элемент управления теряет фокус. По умолчанию все содержимое элемента управления выбирается, когда фокус восстанавливается.

- ECO_VERTICAL рисует текст и объекты в вертикальном направлении. Доступно только для азиатских языков.

Дополнительные сведения см. в разделе [EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a> CRichEditCtrl:: Сетпараформат

Задает атрибуты форматирования абзаца для текущего выделения в этом `CRichEditCtrl` объекте.

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>Параметры

*PF*<br/>
В первой версии — указатель на структуру [формата](/windows/win32/api/richedit/ns-richedit-paraformat) с новым атрибутом форматирования абзаца по умолчанию.

Во второй версии — указатель на структуру [PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2) , которая представляет собой расширенное расширение Edit 2,0 для `PARAFORMAT` структуры, содержащее атрибуты форматирования символов по умолчанию.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Эта функция изменяет только атрибуты, указанные `dwMask` членом *PF* .

Дополнительные сведения см. в [EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat) сообщении и `PARAFORMAT` `PARAFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a> CRichEditCtrl:: Сетпунктуатион

Задает знаки препинания в элементе управления Rich Edit.

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>Параметры

*fType*<br/>
Флаг пунктуации. Список возможных значений см. в описании параметра *fType* для [EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation) в Windows SDK.

*лппунк*<br/>
Указатель на структуру [пунктуации](/windows/win32/api/richedit/ns-richedit-punctuation) , как описано в Windows SDK.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успеха; в противном случае — 0

### <a name="remarks"></a>Комментарии

Эта функция-член доступна только для версий операционной системы на азиатских языках.

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a> CRichEditCtrl:: SetReadOnly

Изменяет параметр ECO_READONLY для этого `CRichEditCtrl` объекта.

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>Параметры

*бреадонли*<br/>
Указывает `CRichEditCtrl` , должен ли этот объект быть доступен только для чтения.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Краткое описание этого параметра см. в разделе [сетоптионс](#setoptions). С помощью этой функции можно задать все параметры для этого `CRichEditCtrl` объекта.

Дополнительные сведения см. в разделе [EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a> CRichEditCtrl:: SetRect

Задает прямоугольник форматирования для данного `CRichEditCtrl` объекта.

```cpp
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
[Крект](../../atl-mfc-shared/reference/crect-class.md) или указатель на [Rect](/windows/win32/api/windef/ns-windef-rect) , указывающий новые границы для прямоугольника форматирования.

### <a name="remarks"></a>Комментарии

Прямоугольник форматирования — это ограничивающий прямоугольник для текста. Ограничивающий прямоугольник не зависит от размера окна элемента управления Rich Edit. При `CRichEditCtrl` первом создании этого объекта размер прямоугольника форматирования совпадает с размером клиентской области окна. Используйте `SetRect` , чтобы сделать прямоугольник форматирования больше или меньше, чем окно редактирования с расширенными возможностями.

Дополнительные сведения см. в разделе [EM_SETRECT](/windows/win32/Controls/em-setrect) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a> CRichEditCtrl:: Сетсел

Задает выбор в этом `CRichEditCtrl` объекте.

```cpp
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>Параметры

*нстартчар*<br/>
Отсчитываемый от нуля индекс первого символа для выделения.

*нендчар*<br/>
Отсчитываемый от нуля индекс последнего символа для выбора.

*Кредит*<br/>
Структура [чарранже](/windows/win32/api/richedit/ns-richedit-charrange) , которая содержит границы текущего выделения.

### <a name="remarks"></a>Комментарии

Две формы этой функции предоставляют альтернативные способы установки границ для выделения. Ниже приведены краткие описания этих форм.

- **Сетсел (** `cr` **)** . Эта форма использует `CHARRANGE` структуру со своими `cpMin` `cpMax` элементами и для установки границ.

- **Сетсел (** `nStartChar` **,** `nEndChar` **)** . в этой форме для установки границ используются параметры *нстартчар* и *нендчар* .

Курсор помещается в конец выделения, обозначенный большим числом `cpMin` индексов Start (или *нстартчар*) и End ( `cpMax` или *нендчар*). Эта функция прокручивает содержимое объекта `CRichEditCtrl` таким образом, чтобы курсор был видимым.

Чтобы выделить весь текст в этом `CRichEditCtrl` объекте, вызовите `SetSel` с начальным индексом 0 и конечным индексом-1.

Дополнительные сведения см. в разделе [EM_EXSETSEL](/windows/win32/Controls/em-exsetsel) Message и структура [чарранже](/windows/win32/api/richedit/ns-richedit-charrange) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [жетсел](#getsel).

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a> CRichEditCtrl:: Сетселектиончарформат

Задает атрибуты форматирования символов для текста в текущем выделенном фрагменте данного `CRichEditCtrl` объекта.

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии — указатель на структуру [чарформат](/windows/win32/api/richedit/ns-richedit-charformata) , содержащую новые атрибуты форматирования символов для текущего выделения.

Во второй версии — указатель на структуру [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , которая представляет собой расширенное расширение Edit 2,0 для `CHARFORMAT` структуры, содержащее новые атрибуты форматирования символов для текущего выделения.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Эта функция изменяет только атрибуты, указанные `dwMask` членом *CF* .

Дополнительные сведения см. в разделе [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) и `CHARFORMAT` структуры и `CHARFORMAT2` в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a> CRichEditCtrl:: Сеттаржетдевице

Задает целевое устройство и толщину линии, используемые для WYSIWYG (отображаемое значение — это то, что вы получаете) при форматировании в этом `CRichEditCtrl` объекте.

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>Параметры

*hDC*<br/>
Обработайте контекст устройства для нового целевого устройства.

*ллиневидс*<br/>
Толщина линии, используемой для форматирования.

*dc*<br/>
[CDC](../../mfc/reference/cdc-class.md) для нового целевого устройства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Если эта функция выполнена успешно, элемент управления Rich Edit владеет контекстом устройства, передаваемым в качестве параметра. В этом случае вызывающая функция не должна уничтожить контекст устройства.

Дополнительные сведения см. в разделе [EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a> CRichEditCtrl:: Сеттекстмоде

Задает режим текста, а также уровень отмены и повтора для элемента управления расширенного редактирования.

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>Параметры

*фмоде*<br/>
Задает новые параметры для текстового режима элемента управления и параметров уровня отмены. Список возможных значений см. в описании параметра Mode для [EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode) в Windows SDK.

### <a name="return-value"></a>Возвращаемое значение

Ноль в случае успеха, в противном случае — ненулевой.

### <a name="remarks"></a>Комментарии

Описание текстовых режимов см. в разделе EM_SETTEXTMODE в Windows SDK.

Эта функция члена завершается ошибкой, если элемент управления содержит текст. Чтобы убедиться, что элемент управления пуст, отправьте сообщение [WM_SETTEXT](/windows/win32/winmsg/wm-settext) с пустой строкой.

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a> CRichEditCtrl:: Сетундолимит

Задает максимальное число действий, которые могут храниться в очереди отмены.

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>Параметры

*нлимит*<br/>
Указывает максимальное число действий, которые могут храниться в очереди отмены. Задайте значение 0, чтобы отключить отмену.

### <a name="return-value"></a>Возвращаемое значение

Новое максимальное число действий отмены для элемента управления Rich Edit.

### <a name="remarks"></a>Комментарии

По умолчанию максимальное число действий в очереди отмены — 100. Если увеличить это число, должно быть достаточно памяти для размещения нового номера. Для повышения производительности установите ограничение на наименьшее возможное значение.

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a> CRichEditCtrl:: Сетвордчарформат

Задает атрибуты форматирования символов для текущего выбранного слова в этом `CRichEditCtrl` объекте.

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>Параметры

*CF*<br/>
В первой версии — указатель на структуру [чарформат](/windows/win32/api/richedit/ns-richedit-charformata) , содержащую новые атрибуты форматирования символов для текущего выбранного слова.

Во второй версии — указатель на структуру [CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w) , которая представляет собой расширенное расширение Edit 2,0 для `CHARFORMAT` структуры, содержащее новые атрибуты форматирования символов для текущего выбранного слова.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Эта функция изменяет только атрибуты, указанные `dwMask` членом *CF* .

Дополнительные сведения см. в [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) сообщении и `CHARFORMAT` `CHARFORMAT2` структурах и в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a> CRichEditCtrl:: Сетвордврапмоде

Задает параметры переноса слов и разбиения по словам для элемента управления Rich Edit.

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>Параметры

*уфлагс*<br/>
Параметры, заданные для переноса по словам и разбиения по словам. Список возможных параметров см. в разделе [EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) в Windows SDK.

### <a name="return-value"></a>Возвращаемое значение

Текущие параметры переноса слов и разбиения на слова.

### <a name="remarks"></a>Комментарии

Это сообщение доступно только в версиях операционной системы для азиатских языков.

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a> CRichEditCtrl:: Стопграуптипинг

Запрещает элементу управления собирать дополнительные действия по вводу в текущее действие отмены.

```cpp
void StopGroupTyping();
```

### <a name="remarks"></a>Комментарии

Элемент управления сохраняет следующее действие ввода, если оно есть, в новое действие в очереди отмены.

Дополнительные сведения см. в разделе [EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) в Windows SDK.

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a> CRichEditCtrl:: Streaming

Заменяет текст в этом `CRichEditCtrl` объекте на текст из указанного входного потока.

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Параметры

*нформат*<br/>
Флаги, указывающие форматы входных данных. Дополнительные сведения см. в разделе "Примечания".

*es*<br/>
Структура [едитстреам](/windows/win32/api/richedit/ns-richedit-editstream) , указывающая входной поток. Дополнительные сведения см. в разделе "Примечания".

### <a name="return-value"></a>Возвращаемое значение

Число символов, считываемых из входного потока.

### <a name="remarks"></a>Комментарии

Значение параметра *нформат* должно быть одним из следующих:

- SF_TEXT указывает только на чтение текста.

- SF_RTF указывает на чтение текста и форматирование.

Любое из этих значений можно сочетать с SFF_SELECTION. Если указан SFF_SELECTION, `StreamIn` заменяет текущее выделение содержимым входного потока. Если он не указан, `StreamIn` заменяет все содержимое этого `CRichEditCtrl` объекта.

В `EDITSTREAM` параметре *ES* указывается функция обратного вызова, которая заполняет буфер текстом. Эта функция обратного вызова вызывается повторно, пока входной поток не будет исчерпан.

Дополнительные сведения см. в разделе [EM_STREAMIN](/windows/win32/Controls/em-streamin) Message и структура [едитстреам](/windows/win32/api/richedit/ns-richedit-editstream) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a> CRichEditCtrl:: потоковая передача

Записывает содержимое этого `CRichEditCtrl` объекта в указанный выходной поток.

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>Параметры

*нформат*<br/>
Флаги, указывающие форматы выходных данных. Дополнительные сведения см. в разделе "Примечания".

*es*<br/>
Структура [едитстреам](/windows/win32/api/richedit/ns-richedit-editstream) , указывающая выходной поток. Дополнительные сведения см. в разделе "Примечания".

### <a name="return-value"></a>Возвращаемое значение

Число символов, записанных в поток вывода.

### <a name="remarks"></a>Комментарии

Значение параметра *нформат* должно быть одним из следующих:

- SF_TEXT указывает только на запись текста.

- SF_RTF указывает на запись текста и форматирования.

- SF_RTFNOOBJS обозначает запись текста и форматирования, заменяя элементы OLE пробелами.

- SF_TEXTIZED указывает на написание текста и форматирования с помощью текстовых представлений элементов OLE.

Любое из этих значений можно сочетать с SFF_SELECTION. Если указан SFF_SELECTION, `StreamOut` записывает текущий выделенный фрагмент в выходной поток. Если он не указан, `StreamOut` записывает все содержимое этого `CRichEditCtrl` объекта.

В `EDITSTREAM` параметре *ES* указывается функция обратного вызова, которая заполняет буфер текстом. Эта функция обратного вызова вызывается повторно, пока выходной поток не будет исчерпан.

Дополнительные сведения см. в разделе [EM_STREAMOUT](/windows/win32/Controls/em-streamout) Message и структура [едитстреам](/windows/win32/api/richedit/ns-richedit-editstream) в Windows SDK.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a> CRichEditCtrl:: Undo

Отменяет последнюю операцию в элементе управления Rich Edit.

```
BOOL Undo();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если операция отмены выполнена успешно; в противном случае — значение 0.

### <a name="remarks"></a>Комментарии

Операция отмены также может быть отменена. Например, можно восстановить удаленный текст при первом вызове метода `Undo` . Пока нет промежуточных операций редактирования, можно удалить текст еще раз с помощью второго вызова `Undo` .

Дополнительные сведения см. в разделе [EM_UNDO](/windows/win32/Controls/em-undo) в Windows SDK.

### <a name="example"></a>Пример

  См. пример для [канундо](#canundo).

## <a name="see-also"></a>См. также раздел

[Образец WORDPAD для MFC](../../overview/visual-cpp-samples.md)<br/>
[CWnd, класс](../../mfc/reference/cwnd-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс CEdit](../../mfc/reference/cedit-class.md)<br/>
[Класс CRichEditView](../../mfc/reference/cricheditview-class.md)
