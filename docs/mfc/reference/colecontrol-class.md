---
title: Класс COleControl
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753935"
---
# <a name="colecontrol-class"></a>Класс COleControl

Мощный базовый класс для разработки элементов управления OLE.

## <a name="syntax"></a>Синтаксис

```
class COleControl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Создает объект `COleControl`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Извлекает текущий вид элемента управления.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Возвращает значение свойства окружающего BackColor.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Возвращает название элемента управления, указанное контейнером.|
|[COleControl::AmbientFont](#ambientfont)|Возвращает значение свойства окружающего шрифта.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Возвращает стоимость свойства окружающего ForeColor.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Возвращает идентификатор локализации контейнера.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Возвращает тип единиц, используемых контейнером.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Определяет, должны ли отображаться ручки захвата.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Определяет, следует ли отображать штриховку.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Возвращает тип выравнивания текста, указанный контейнером.|
|[COleControl::AmbientUIDead](#ambientuidead)|Определяет, должен ли элемент управления реагировать на действия пользовательского интерфейса.|
|[COleControl::AmbientUserMode](#ambientusermode)|Определяет режим контейнера.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Уведомляет контейнер об изменении связанного свойства.|
|[ColeControl::BoundPropertyЗапросEdit](#boundpropertyrequestedit)|Запрашивает разрешение на отогивание стоимости свойства.|
|[COleControl::ClientToParent](#clienttoparent)|Переводит точку относительно происхождения элемента управления в точку относительно происхождения контейнера.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Регулирует прямоугольник каретного прямоугольника, если он перекрыт элементом управления.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Вызов ими после изменения набора мнемоники, обрабатываемых элементом управления.|
|[COleControl::DisplayError](#displayerror)|Отображает события ошибки в запасе пользователю элемента управления.|
|[COleControl::DoClick](#doclick)|Реализация метода `DoClick` акций.|
|[COleControl::DoPropExchange](#dopropexchange)|Сериализирует свойства `COleControl` объекта.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Перерисовывает элемент управления OLE, который был подклассифицирован из элемента управления Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Обеспечивает простую поддержку кадра для управления.|
|[COleControl::ExchangeExtent](#exchangeextent)|Сериализирует ширину и высоту управления.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Сериализирует свойства запасов элемента управления.|
|[COleControl::ExchangeVersion](#exchangeversion)|Сериализирует номер версии управления.|
|[COleControl::FireClick](#fireclick)|Запускает акционерное `Click` событие.|
|[COleControl::FireDblClick](#firedblclick)|Запускает акционерное `DblClick` событие.|
|[COleControl::FireError](#fireerror)|Запускает акционерное `Error` событие.|
|[COleControl::FireEvent](#fireevent)|Запускает пользовательское событие.|
|[COleControl::FireKeyDown](#firekeydown)|Запускает акционерное `KeyDown` событие.|
|[COleControl::FireKeyPress](#firekeypress)|Запускает акционерное `KeyPress` событие.|
|[COleControl::FireKeyUp](#firekeyup)|Запускает акционерное `KeyUp` событие.|
|[COleControl::FireMouseDown](#firemousedown)|Запускает акционерное `MouseDown` событие.|
|[COleControl::FireMouseMove](#firemousemove)|Запускает акционерное `MouseMove` событие.|
|[COleControl::FireMouseUp](#firemouseup)|Запускает акционерное `MouseUp` событие.|
|[ColeControl::FireReadyState](#firereadystatechange)|Запускает событие при изменении состояния элемента управления.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Изменяет поведение активации по умолчанию `IPointerInactive` элемента управления, поддерживающего интерфейс.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Возвращает значение указанного свойства окружающей среды.|
|[COleControl::GetAppearance](#getappearance)|Возвращает стоимость свойства акционерного вида.|
|[ColeControl::GetBackColor](#getbackcolor)|Возвращает стоимость склада BackColor свойства.|
|[COleControl::GetBorderStyle](#getborderstyle)|Возвращает стоимость склада свойства BorderStyle.|
|[COleControl::GetCapture](#getcapture)|Определяет, имеет ли объект управления без окон активированный элемент управления захватом мыши.|
|[COleControl::GetClassID](#getclassid)|Извлекает идентификатор типа OLE элемента управления.|
|[COleControl::GetClientOffset](#getclientoffset)|Извлекает разницу между верхним левым углом прямоугольной области управления и верхним левым углом клиентской области.|
|[COleControl::GetClientRect](#getclientrect)|Получает размер клиентской зоны элемента.|
|[ColeControl::GetClientSite](#getclientsite)|Запрашивает объект для указателя на свой текущий клиентский сайт в контейнере.|
|[COleControl::GetControlFlags](#getcontrolflags)|Извлекает настройки флага управления.|
|[COleControl::GetControlSize](#getcontrolsize)|Возвращает положение и размер элемента управления OLE.|
|[COleControl::GetDC](#getdc)|Предоставляет средства для управления без окон, чтобы получить контекст устройства из контейнера.|
|[ColeControl::GetEnabled](#getenabled)|Возвращает стоимость свойства включено в акции.|
|[ColeControl::GetExtendedControl](#getextendedcontrol)|Извлекает указатель на расширенный контрольный объект, принадлежащий контейнеру.|
|[COleControl::GetFocus](#getfocus)|Определяет, имеет ли элемент управления фокус.|
|[COleControl::GetFont](#getfont)|Возвращает стоимость свойства шрифта.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Возвращает метрики `CFontHolder` объекта.|
|[COleControl::GetForeColor](#getforecolor)|Возвращает стоимость склада ForeColor собственности.|
|[COleControl::GetHwnd](#gethwnd)|Возвращает стоимость свойства stock hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Предоставляет текст панели статуса для элемента меню.|
|[COleControl::GetNotSupported](#getnotsupported)|Предотвращает доступ пользователя к свойство элемента управления.|
|[COleControl::GetReadyState](#getreadystate)|Возвращает состояние готовности элемента управления.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Возвращает прямоугольник элемента управления по отношению к контейнеру.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Возвращает метрики свойства шрифта.|
|[COleControl::GetText](#gettext)|Возвращает стоимость свойства текст или подпись.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Переопределение, позволяющее элементу управления без окон быть целью операций перетаскивания и падения.|
|[COleControl::InitializeIIDs](#initializeiids)|Информирует базовый класс IID, который будет использовать элемент управления.|
|[COleControl::InternalGetFont](#internalgetfont)|Возвращает `CFontHolder` объект для свойства шрифта.|
|[COleControl::InternalGetText](#internalgettext)|Извлекает свойство заголовок акции или текст.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Устанавливает состояние готовности элемента и запускает событие изменения готового состояния.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Недействительным области отображается элемент управления, в результате чего она будет перерисована.|
|[COleControl::InvalidateRgn](#invalidatergn)|Недействительная область клиентского окна контейнера в данном регионе. Может использоваться для перерисовки элементов управления без окон в регионе.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Позволяет специализированную загрузку управления OLE.|
|[COleControl::IsModified](#ismodified)|Определяет, изменилось ли состояние управления.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Указывает, поддерживает ли контейнер оптимизированный рисунок для текущей операции рисования.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Вызывается, чтобы определить, если управление подклассы управления Windows.|
|[COleControl::Load](#load)|Сбрасывает любые предыдущие асинхронные данные и инициирует новую нагрузку асинхронного свойства элемента управления.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Определяет, может ли ваш элемент управления быть отключен контейнером.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Вызывается при изменении свойства окружающего.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Вызывается при изменении свойства внешнего вида акций.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Вызывается при изменении свойства backColor.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Вызывается при изменении свойства акции BorderStyle.|
|[COleControl::OnClick](#onclick)|Вызывается, чтобы запустить акции Нажмите событие.|
|[COleControl::OnClose](#onclose)|Уведомляет `IOleControl::Close` о вызове элемента управления.|
|[COleControl::OnDoVerb](#ondoverb)|Вызывается после выполнения глагола управления.|
|[ColeControl::OnDraw](#ondraw)|Вызывается при запросе элемента управления для перерисовки.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Вызывается контейнером, когда требуется элемент управления перерисовать себя с помощью контекста метафайлного устройства.|
|[ColeControl::It](#onedit)|Вызывается контейнером для uI Активировать элемент управления OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Вызывается при изменении свойства включенного в акции.|
|[ColeControl::OnEnumVerbs](#onenumverbs)|Вызывается контейнером для перечисления глаголов управления.|
|[COleControl::OnEventAdvise](#oneventadvise)|Вызывается при подключении или отключении обработчиков событий от элемента управления.|
|[ColeControl::OnfontChanged](#onfontchanged)|Вызывается при изменении свойства шрифта.|
|[ColeControl::OnForeColorChanged](#onforecolorchanged)|Вызывается при изменении свойства foreColor.|
|[ColeControl::OnfreezeEvents](#onfreezeevents)|Вызывается, когда события элемента управления заморожены или разморожены.|
|[ColeControl::OnGetColorset](#ongetcolorset)|Уведомляет `IOleObject::GetColorSet` о вызове элемента управления.|
|[ColeControl::OnGetControlInfo](#ongetcontrolinfo)|Предоставляет мнемоническую информацию контейнеру.|
|[ColeControl::OnGetDisplaystring](#ongetdisplaystring)|Вызывается для получения строки для представления стоимости свойства.|
|[ColeControl::OnGetinPlacemenu](#ongetinplacemenu)|Запросы ручки меню элемента управления, которые будут объединены с меню контейнера.|
|[ColeControl::OngetNaturalExtent](#ongetnaturalextent)|Переопределение для получения размера дисплея элемента управления ближе всего к предполагаемому режиму размера и размера.|
|[ColeControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Возвращает строки, представляющие возможные значения для свойства.|
|[ColeControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Возвращает значение, соответствующее заранее определенной строке.|
|[ColeControl::OnGetViewextent](#ongetviewextent)|Переопределение для получения размера зон отображения элемента управления (может быть использовано для включения двухпроходного чертежа).|
|[ColeControl::OnGetViewRect](#ongetviewrect)|Переопределение для преобразования размера элемента управления в прямоугольник, начиная с определенного положения.|
|[ColeControl::OnGetViewstatus](#ongetviewstatus)|Переопределение для получения состояния представления элемента управления.|
|[ColeControl::OnHidetoolBars](#onhidetoolbars)|Вызывается контейнером, когда элемент управления выключен.|
|[ColeControl::OnInactiveMouseMove](#oninactivemousemove)|Переопределение контейнера для неактивного управления под диспетчером указателя мыши WM_MOUSEMOVE сообщений на управление.|
|[ColeControl::InInactiveSetCursor](#oninactivesetcursor)|Переопределение контейнера для неактивного управления под диспетчером указателя мыши WM_SETCURSOR сообщений на управление.|
|[ColeControl::OnKeydownEvent](#onkeydownevent)|Вызывается после акции KeyDown событие было уволено.|
|[ColeControl::OnKeyPressEvent](#onkeypressevent)|Вызывается после акции KeyPress событие было уволено.|
|[ColeControl::OnKeyupEvent](#onkeyupevent)|Вызывается после того, как мероприятие KeyUp было уволено.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Указано, какую страницу свойств использовать для редактирования свойства.|
|[ColeControl:OnMmonic](#onmnemonic)|Вызывается, когда мнемонический ключ управления был нажат.|
|[COleControl::OnProperties](#onproperties)|Вызывается, когда элемент управления "Свойства" глагол был вызван.|
|[ColeControl::OnqueryhitPoint](#onqueryhitpoint)|Переурядитесь, перекрывает ли дисплей элемента управления данный момент.|
|[ColeControl::On'sryHitRect](#onqueryhitrect)|Переурядитесь, перекрывает ли дисплей элемента управления какую-либо точку в данном прямоугольнике.|
|[ColeControl::OnRenderData](#onrenderdata)|Вызывается рамкой для извлечения данных в указанном формате.|
|[ColeControl::OnrenderFileData](#onrenderfiledata)|Вызывается инфраструктурой для извлечения данных из файла в указанном формате.|
|[ColeControl::OnrenderGlobalData](#onrenderglobaldata)|Вызывается фреймворцом для получения данных из глобальной памяти в указанном формате.|
|[ColeControl::OnResetState](#onresetstate)|Сброс свойств элемента управления на значения по умолчанию.|
|[ColeControl::OnsetClientsite](#onsetclientsite)|Уведомляет `IOleControl::SetClientSite` о вызове элемента управления.|
|[ColeControl::OnsetData](#onsetdata)|Заменяет данные элемента управления другим значением.|
|[ColeControl::Onsetextent](#onsetextent)|Вызывается после того, как степень контроля изменилась.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Вызывается после того, как размеры элемента управления были изменены.|
|[ColeControl::OnShowToolBars](#onshowtoolbars)|Вызывается при активации элемента управления.|
|[ColeControl::OnTextChanged](#ontextchanged)|Вызывается при изменении свойства текстового сообщения или подписи.|
|[ColeControl::OnWindowlessСообщение](#onwindowlessmessage)|Обрабатывает оконные сообщения (кроме сообщений мыши и клавиатуры) для управления без окон.|
|[ColeControl::PArentToClient](#parenttoclient)|Переводит точку относительно происхождения контейнера в точку относительно происхождения элемента управления.|
|[ColeControl::PostModalDialog](#postmodaldialog)|Уведомляет контейнер о закрытии модального диалогового окна.|
|[ColeControl::PreModalDialog](#premodaldialog)|Уведомляет контейнер о том, что в настоящее время будет отображена модальная диалоговая будка.|
|[ColeControl::ВоссоздайтеControlWindow](#recreatecontrolwindow)|Разрушает и воссоздает окно управления.|
|[ColeControl::Refresh](#refresh)|Заставляет перекрасить внешний вид управления.|
|[COleControl::ReleaseCapture](#releasecapture)|Выпускает захват мыши.|
|[ColeControl::ReleaseDC](#releasedc)|Выпускает контекст устройства отображения контейнера управления без окон.|
|[ColeControl::ReparentControlWindow](#reparentcontrolwindow)|Сброс родительского окна управления.|
|[ColeControl::ResetStockProps](#resetstockprops)|Инициализирует `COleControl` свойства акций до значений по умолчанию.|
|[ColeControl::Перезагрузка](#resetversion)|Инициализирует номер версии до заданного значения.|
|[ColeControl::ScrollWindow](#scrollwindow)|Позволяет бесконек управлять областью в пределах своего активного изображения на дисплее.|
|[ColeControl::SelectFontObject](#selectfontobject)|Выберите пользовательское свойство шрифта в контексте устройства.|
|[ColeControl::SelectStockFont](#selectstockfont)|Выберите свойство шрифта в контексте устройства.|
|[ColeControl::SerializeExtent](#serializeextent)|Сериализирует или инициализирует пространство дисплея для управления.|
|[ColeControl::SerializeStockProps](#serializestockprops)|Сериализирует или инициализирует свойства запасов. `COleControl`|
|[ColeControl::SerializeVersion](#serializeversion)|Сериализирует или инициализирует информацию о версии управления.|
|[ColeControl::SetAppearance](#setappearance)|Устанавливает стоимость свойства акционерного вида.|
|[ColeControl::SetBackColor](#setbackcolor)|Устанавливает стоимость стоимости свойства BackColor.|
|[ColeControl::SetBorderStyle](#setborderstyle)|Устанавливает стоимость склада свойства BorderStyle.|
|[ColeControl::SetCapture](#setcapture)|Вызывает захват контейнера от имени элемента управления.|
|[ColeControl::SetControlSize](#setcontrolsize)|Устанавливает положение и размер управления OLE.|
|[ColeControl::SetEnabled](#setenabled)|Устанавливает стоимость свойства включено.|
|[ColeControl::SetFocus](#setfocus)|Вызывает, что окно контейнера управления завладеет входинным фокусом от имени элемента управления.|
|[ColeControl::SetFont](#setfont)|Устанавливает стоимость свойства шрифта.|
|[ColeControl::SetForeColor](#setforecolor)|Устанавливает стоимость склада ForeColor свойства.|
|[ColeControl::SetInitialSize](#setinitialsize)|Устанавливает размер элемента управления OLE при первом отображении в контейнере.|
|[ColeControl::SetModifiedFlag](#setmodifiedflag)|Изменяет измененное состояние элемента управления.|
|[ColeControl::SetNotPermitted](#setnotpermitted)|Указано, что запрос на правку не удался.|
|[ColeControl::SetNotSupported](#setnotsupported)|Предотвращает изменение пользовательской стоимости свойства элемента управления.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Устанавливает прямоугольник элемента управления относительно контейнера.|
|[ColeControl::SetText](#settext)|Устанавливает стоимость свойства текстового текста или подписи.|
|[ColeControl::ThrowError](#throwerror)|Сигналы о том, что ошибка произошла в элементе управления OLE.|
|[ColeControl::TransformCoors](#transformcoords)|Преобразует значения координат между контейнером и элементом управления.|
|[ColeControl::TranslateColor](#translatecolor)|Преобразует OLE_COLOR значение в значение COLORREF.|
|[ColeControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Определяет, будут ли свойства окружающей среды доступны при следующей загрузке элемента управления.|
|[ColeControl::WindowProc](#windowproc)|Обеспечивает процедуру Windows `COleControl` для объекта.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Описание|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Вызывается по фреймворку, когда внешний вид элемента должен быть обновлен.|
|[COleControl::DrawMetafile](#drawmetafile)|Вызывается фреймворками при использовании контекста метафайлного устройства.|
|[ColeControl::IsvokeРазрешен](#isinvokeallowed)|Позволяет использовать метод автоматизации.|
|[ColeControl::SetInitialDataФорматы](#setinitialdataformats)|Вызывается рамочой для инициализации списка форматов данных, поддерживаемых контролем.|

## <a name="remarks"></a>Remarks

Полученные `CWnd`из этого класса наследует все функциональные возможности объекта окна Windows плюс дополнительные функциональные возможности, характерные для OLE, такие как стрельба события и возможность поддержки методов и свойств.

Элементы управления OLE могут быть вставлены в контейнерные приложения OLE и общаться с контейнером с помощью двусторонней системы стрельбы событий и обнажения методов и свойств контейнера. Обратите внимание, что стандартные контейнеры OLE поддерживают только основную функциональность управления OLE. Они не в состоянии поддерживать расширенные функции управления OLE. Стрельба события происходит, когда события отправляются в контейнер в результате определенных действий, происходящих в элементе управления. В свою очередь, контейнер взаимодействует с элементом управления, используя открытый набор методов и свойств, аналогичных функциям членов и членам данных класса СЗ. Такой подход позволяет разработчику контролировать внешний вид элемента управления и уведомлять контейнер при возникновении определенных действий.

## <a name="windowless-controls"></a>Элементы управления без окон

Элементы управления OLE можно использовать на месте, активно множетесь без окна. Элементы управления без окон имеют значительные преимущества:

- Управление без окон может быть прозрачным и непрямоугольным

- Элементы без окон уменьшают размер экземпляра и время создания объекта

Элементы управления не нуждаются в окне. Услуги, которые предлагает окно, могут быть легко предоставлены через одно общее окно (обычно контейнер) и немного диспетчерского кода. Наличие окна в основном является ненужным осложнением на объекте.

При использовании активации без окон контейнер (у которого есть окно) отвечает за предоставление услуг, которые в противном случае были бы предоставлены собственным окном элемента управления. Например, если элементуправления необходимо запросить фокус клавиатуру, запросить захват мыши или получить контекст устройства, эти операции управляются контейнером. Функции `COleControl` бесхосилия-операции вызывают эти операции на контейнере.

При включении активации без окон контейнер делегирует `IOleInPlaceObjectWindowless` ввод сообщений в интерфейс управления (расширение [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `COleControl`Реализация этого интерфейса будет отправлять эти сообщения через карту сообщений вашего элемента управления, после правильной настройки координат мыши. Вы можете обрабатывать эти сообщения, как обычные сообщения окна, добавив соответствующие записи на карту сообщений.

При управлении без окон необходимо `COleControl` всегда использовать функции `CWnd` элемента вместо соответствующих функций члена или связанных с ними функций API Windows.

Объекты управления OLE также могут создавать окно только тогда, когда они становятся активными, но объем работы, необходимый для неактивного перехода, повышается, а скорость перехода снижается. Бывают случаи, когда это проблема: в качестве примера рассмотрим сетку текстовых коробок. При беготне вверх и вниз по столбцу, каждый элемент должен быть активирован на месте, а затем отключен. Скорость неактивного/активного перехода будет непосредственно влиять на скорость прокрутки.

Для получения дополнительной информации о разработке системы управления [Overview: Creating an MFC ActiveX Control Program](../../mfc/reference/mfc-activex-control-wizard.md)OLE, см. [MFC ActiveX Controls](../../mfc/mfc-activex-controls.md) Для получения информации об оптимизации элементов управления OLE, включая без окон и мерцание, [см.](../../mfc/mfc-activex-controls-optimization.md)

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Требования

**Заголовок:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>ColeControl::AmbientBackColor

Возвращает значение свойства окружающего BackColor.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущая стоимость свойства backColor в контейнере, если такового. Если свойство не поддерживается, эта функция возвращает определяемый системой цвет фона Windows.

### <a name="remarks"></a>Remarks

Свойство BackColor доступно для всех элементов управления и определяется контейнером. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>ColeControl::AmbientDisplayName

Имя, назначенное контейнером для управления, может быть использовано в сообщениях об ошибках, отображаемых пользователю.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Возвращаемое значение

Название управления OLE. Значение по умолчанию — пустая строка.

### <a name="remarks"></a>Remarks

Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>ColeControl::AmbientFont

Возвращает значение свойства окружающего шрифта.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс отправки окружающего шрифта контейнера. Значение по умолчанию — NULL. Если возврат не равен NULL, вы несете ответственность за выпуск шрифта, позвонив в его функцию [IUnknown::Release.](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)

### <a name="remarks"></a>Remarks

Свойство окружающего шрифта определяется контейнером и доступно для всех элементов управления. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>ColeControl::AmbientForeColor

Возвращает стоимость свойства окружающего ForeColor.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущая стоимость эмбиента свойства ForeColor контейнера, если такового. Если эта функция не поддерживается, она возвращает определяемый системой цвет текста Windows.

### <a name="remarks"></a>Remarks

Свойство окружающего ForeColor доступно для всех элементов управления и определяется контейнером. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>ColeControl::AmbientLocaleID

Возвращает идентификатор локализации контейнера.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Возвращаемое значение

Значение свойства localeID контейнера, если такового. Если это свойство не поддерживается, эта функция возвращает 0.

### <a name="remarks"></a>Remarks

Элемент управления может использовать LocaleID для адаптации пользовательского интерфейса для определенных локаулов. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>ColeControl::AmbientAppearance

Извлекает текущий параметр видимости для объекта управления.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Возвращаемое значение

Внешний вид управления:

- **0** Плоский внешний вид

- **1** 3D внешний вид

### <a name="remarks"></a>Remarks

Вызовите эту функцию, чтобы получить текущее значение DISPID_AMBIENT_APPEARANCE свойствдля для элемента управления.

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>ColeControl::AmbientScaleUnits

Возвращает тип единиц, используемых контейнером.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Возвращаемое значение

Строка, содержащая окружающие ScaleUnits контейнера. Если это свойство не поддерживается, эта функция возвращает строку нулевой длины.

### <a name="remarks"></a>Remarks

Свойство эмпоновного масштаба контейнера может использоваться для отображения позиций или размеров, помеченных выбранным устройством, например, twips или сантиметрами. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>ColeControl::AmbientShowGrabРучки

Определяет, позволяет ли контейнер элементуправления отображать ручки захвата для себя при активном.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если ручки захвата должны отображаться; в противном случае 0. Если это свойство не поддерживается, эта функция возвращается ненулевой.

### <a name="remarks"></a>Remarks

Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>ColeControl::AmbientShowHatching

Определяет, позволяет ли контейнер элемент управления отображаться с вылупимым узором при активном uI.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вылупивается шаблон должен быть показан; в противном случае 0. Если это свойство не поддерживается, эта функция возвращается ненулевой.

### <a name="remarks"></a>Remarks

Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>ColeControl::AmbientTextAlign

Определяет выравнивание окружающего текста, предпочтительное контейнером управления.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние окружающего свойства textAlign контейнера. Если это свойство не поддерживается, эта функция возвращает 0.

Ниже приводится список действительных значений возврата:

|Возвращаемое значение|Значение|
|------------------|-------------|
|0|Общее выравнивание (числа справа, текст слева).|
|1|Левая оправдать|
|2|Центр.|
|3|Право оправдать|

### <a name="remarks"></a>Remarks

Это свойство доступно для всех встроенных элементов управления и определяется контейнером. Обратите внимание, что контейнер не требуется для поддержки этого свойства.

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>ColeControl::AmbientUiDead

Определяет, хочет ли контейнер, чтобы элемент управления реагировал на действия пользовательского интерфейса.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент управления должен реагировать на действия пользовательского интерфейса; в противном случае 0. Если это свойство не поддерживается, эта функция возвращает 0.

### <a name="remarks"></a>Remarks

Например, контейнер может настроить это в режиме проектирования.

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>ColeControl::AmbientUserMode

Определяет, находится ли контейнер в режиме проектирования или в пользовательском режиме.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если контейнер находится в пользовательском режиме; в противном случае 0 (в режиме проектирования). Если это свойство не поддерживается, эта функция возвращает TRUE.

### <a name="remarks"></a>Remarks

Например, контейнер может установить это в режиме проектирования FALSE.

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>ColeControl::BoundPropertyИзменен

Сигналы об изменении значения связанного свойства.

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор отправки связанного свойства элемента управления.

### <a name="remarks"></a>Remarks

Это должно вызываться каждый раз, когда значение свойства изменяется, даже в тех случаях, когда изменение не было сделано через метод набора свойств. Будьте особенно в курсе связанных свойств, которые отображаются с переменными членов. Каждый раз, когда `BoundPropertyChanged` такая переменная члена изменяется, должна быть вызвана.

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>ColeControl::BoundPropertyЗапросEdit

Запрашивает разрешение `IPropertyNotifySink` от интерфейса на изменение связанной стоимости свойства, предоставляемой элементом управления.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор отправки связанного свойства элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если изменение разрешено; в противном случае 0. Значение по умолчанию ненулевое.

### <a name="remarks"></a>Remarks

Если разрешение отклонено, элемент управления не должен позволять изменению значения свойства. Это можно сделать, игнорируя или не сумев действия, которые пытались изменить значение свойства.

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>ColeControl::Клиент-родитель

Преобразует координаты *pPoint* в родительские координаты.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Указатель на границы управления OLE внутри контейнера. Не область клиента, но область всего контроля, включая границы и прокрутки баров.

*pPoint*<br/>
Указатель на точку клиента OLE, которая должна быть переведена в координаты родительского (контейнера).

### <a name="remarks"></a>Remarks

На вхотоза *pPoint* относительно происхождения клиентской области управления OLE (верхний левый угол клиентской области управления). На выходе *pPoint* относительно происхождения родителя (верхний левый угол контейнера).

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>ColeControl::ClipCaretRect

Регулирует прямоугольник каретного прямоугольника, если он полностью или частично покрыт перекрывающимися непрозрачными объектами.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
При входе указатель на структуру [RECT,](/windows/win32/api/windef/ns-windef-rect) которая содержит область caret, которая должна быть скорректирована. На выходе, скорректированной области caret, или NULL, если прямоугольник карет полностью покрыт.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Caret — это мигающая строка, блок или бит-карта, которая обычно указывает, где будет вставлен текст или графика.

Объект без окон не может безопасно показывать карету без предварительной проверки того, частично или полностью скрыты ли уход перекрывающихся объектов. Для того, чтобы сделать это `ClipCaretRect` возможным, объект может использовать, чтобы получить caret скорректированы (сокращены), чтобы убедиться, что он вписывается в области отсечения.

Объекты, создающие карету, должны `ClipCaretRect` представлять прямоугольник caret и использовать скорректированный прямоугольник для ухода. Если каретполностью спрятан, то этот метод возвратит FALSE и caret не должен быть показан на всех в этом случае.

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>ColeControl::COleControl

Формирует объект `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Remarks

Эта функция обычно не вызывается напрямую. Вместо этого управление OLE обычно создается фабрикой класса.

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>ColeControl::ControlInfoChanged

Вызовите эту функцию, когда набор мнемоники, поддерживаемый элементом управления, изменился.

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>Remarks

Получив это уведомление, контейнер управления получает новый набор мнемоники, позвонив в [IOleControl::GetControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Обратите внимание, что контейнер не обязан отвечать на это уведомление.

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>ColeControl::DisplayОшибка

Вызывается инфраструктурой после обработки события ошибки в запасе (если только обработчик события не подавил отображение ошибки).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Параметры

*scode*<br/>
Значение кода состояния, о чем следует сообщать. Полный список возможных кодов можно узнать в статье [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszОписание*<br/>
Описание сообщения об ошибке.

*lpszSource*<br/>
Название модуля, генерирующего ошибку (обычно, название модуля управления OLE).

*lpszHelpFile*<br/>
Имя файла справки, содержащего описание ошибки.

*nHelpID*<br/>
Идентификатор контекста справки об ошибке, сообщаемой.

### <a name="remarks"></a>Remarks

Поведение по умолчанию отображает окно сообщений, содержащее описание ошибки, содержащееся в *lpszDescription*.

Переопределить эту функцию, чтобы настроить отображение ошибок.

## <a name="colecontroldoclick"></a><a name="doclick"></a>ColeControl::DoClick

Имитирует действие мыши щелчком мыши на элементе управления.

```cpp
void DoClick();
```

### <a name="remarks"></a>Remarks

Функция переизданного `COleControl::OnClick` элемента будет вызываться, и событие кнопки акции будет уволено, если поддерживается элементом управления.

Эта функция поддерживается `COleControl` базовым классом в качестве метода акций, называемого DoClick. Для получения дополнительной информации смотрите статью [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md).

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>ColeControl::DoPropExchange

Вызывается фреймворцом при загрузке или хранении элемента управления из постоянного представления хранилища, например, потока или набора свойств.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*Ppx*<br/>
Указатель на объект `CPropExchange`. Рамки поставляют этот объект для установления контекста обмена имуществом, в том числе его направления.

### <a name="remarks"></a>Remarks

Эта функция обычно делает вызовы **PX_** семейства функций для загрузки или хранения определенных пользовательских свойств управления OLE.

Если мастер управления был использован для создания проекта управления OLE, переопределенная версия этой `COleControl` функции будет сериализировать `COleControl::DoPropExchange`свойства запасов, поддерживаемые вызовом к функции базового класса, . При добавлении свойств, определяемых пользователем, в управление OLE необходимо изменить эту функцию, чтобы сериализировать новые свойства. Для получения дополнительной информации о [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md)сериализации, см.

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>ColeControl::DoSuperclassPaint

Перерисовывает элемент управления OLE, который был подклассифицирован из элемента управления Windows.

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства контейнера управления.

*rcBounds*<br/>
Область, в которой должен быть проведен контроль.

### <a name="remarks"></a>Remarks

Позвоните в эту функцию, чтобы правильно обрабатывать картину неактивного управления OLE. Эта функция должна использоваться только в том случае, если подклассы управления OLE управляют Windows и должны вызываться в `OnDraw` функции управления.

Для получения дополнительной информации об этой функции и [ActiveX Controls: Subclassing a Windows Control](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)подкласса управления Windows, см.

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>ColeControl::DrawContent

Вызывается по фреймворку, когда внешний вид элемента должен быть обновлен.

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства.

*Rc*<br/>
Прямоугольная область, в которая будет нарисована.

### <a name="remarks"></a>Remarks

Эта функция непосредственно вызывает `OnDraw` переизданную функцию.

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>ColeControl::DрауМетафиль

Вызывается фреймворками при использовании контекста метафайлного устройства.

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст метафайлного устройства.

*Rc*<br/>
Прямоугольная область, в которая будет нарисована.

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>ColeControl::EnableSimpleFrame

Включает простую раму, характерную для управления OLE.

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>Remarks

Эта характеристика позволяет контролировать визуальное сдерживание других элементов управления, но не верно ole сдерживания. Примером может быть групповое окно с несколькими элементами управления внутри. Эти элементы управления не содержатся OLE, но они находятся в одной группе коробки.

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>ColeControl:ExchangeExtent

Сериализирует или инициализирует состояние размера элемента управления (его размеры в единицах HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*Ppx*<br/>
Указатель на объект [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Рамки поставляют этот объект для установления контекста обмена имуществом, в том числе его направления.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если функция успешно; 0 в противном случае.

### <a name="remarks"></a>Remarks

Эта функция обычно вызывается реализацией `COleControl::DoPropExchange`по умолчанию.

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>ColeControl::ExchangeStockProps

Сериализирует или инициализирует состояние складских свойств элемента управления.

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*Ppx*<br/>
Указатель на объект [CPropExchange.](../../mfc/reference/cpropexchange-class.md) Рамки поставляют этот объект для установления контекста обмена имуществом, в том числе его направления.

### <a name="remarks"></a>Remarks

Эта функция обычно вызывается реализацией `COleControl::DoPropExchange`по умолчанию.

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>ColeControl::ExchangeVersion

Сериализирует или инициализирует состояние информации о версии управления.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*Ppx*<br/>
Указатель на объект `CPropExchange`. Рамки поставляют этот объект для установления контекста обмена имуществом, в том числе его направления.

*dwVersionDefault*<br/>
Текущий номер версии управления.

*bПреобразование*<br/>
Указывается, следует ли конвертировать постоянные данные в последний формат при сохранении или поддерживаться в том же формате, который был загружен.

### <a name="return-value"></a>Возвращаемое значение

Nonzero функции удалось; 0 в противном случае.

### <a name="remarks"></a>Remarks

Как правило, это будет первая функция, вызванная `COleControl::DoPropExchange`переопределением элемента управления. При загрузке эта функция считывает номер версии постоянных данных и устанавливает атрибут версии объекта [CPropExchange](../../mfc/reference/cpropexchange-class.md) соответственно. При сохранении эта функция записывает номер версии постоянных данных.

Для получения дополнительной информации о настойчивости [ActiveX Controls: Serializing](../../mfc/mfc-activex-controls-serializing.md)и версии, см.

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>ColeControl::FireClick

Вызывается по фрейму при нажатии мыши на активный элемент управления.

```cpp
void FireClick();
```

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматического запуска события Click карта события должна иметь событие акции Click.

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>ColeControl::FireDblClick

Вызывается по фреймворку, когда мышь нажат дважды над активным управлением.

```cpp
void FireDblClick();
```

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматической стрельбы события DblClick карта события должна иметь запас DblClick событие определено.

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>ColeControl::FireError

Запускает событие ошибки в запасе.

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*scode*<br/>
Значение кода состояния, о чем следует сообщать. Полный список возможных кодов можно узнать в статье [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszОписание*<br/>
Описание сообщения об ошибке.

*nHelpID*<br/>
Идентификатор справки об ошибке, сообщаемой.

### <a name="remarks"></a>Remarks

Это событие предоставляет способ сигнализации в соответствующих местах в коде о том, что ошибка произошла в вашем элементе управления. В отличие от других событий, таких как Click или MouseMove, ошибка никогда не увольняется по системе.

Чтобы сообщить об ошибке, которая происходит во время получения функции свойства, функции набора свойств или метода автоматизации, позвоните [в COleControl::ThrowError](#throwerror).

При реализации события stock Error элемента управления OLE используется значение SCODE. Если ваш элемент управления использует это событие и предназначен для использования в Visual Basic 4.0, вы будете получать ошибки, поскольку значение SCODE не поддерживается в Visual Basic.

Чтобы исправить это, вручную измените параметр SCODE в элементе управления. ODL файл в **длину**. Кроме того, любая пользовательская возможность, метод или свойство, используюметоды SCODE, также вызывает ту же проблему.

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>ColeControl::FireEvent

Увольняет событие, определяемое пользователем, из вашего контроля с любым количеством дополнительных аргументов.

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор отправки события, который будет уволен.

*pbParams*<br/>
Дескриптор для типов параметров события.

### <a name="remarks"></a>Remarks

Обычно эту функцию не следует называть напрямую. Вместо этого вы вызовете функции запуска событий в разделе карты событий в декларации класса вашего элемента управления.

*PbParams* аргумент пространстве-разделенный список **VTS_**. Одно или несколько из этих значений, разделенных пробелами (не запятыми), составляют список параметров функции. Возможны следующие значения:

|Символ|Тип параметра|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> Для всех типов вариантов определены дополнительные константы вариантов, за исключением VTS_FONT и VTS_PICTURE, которые обеспечивают указатель к константу данных варианта. Эти константы названы с помощью **VTS_P** `constantname` конвенции. Например, VTS_PCOLOR является указателем на константу VTS_COLOR.

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>ColeControl::FireKeyDown

Вызывается по системе, когда ключ нажат, в то время как элемент управления активен.

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на виртуальное значение кода ключа отжатого ключа. Список стандартных виртуальных кодов ключей можно узнать на примере Winuser.h

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматического запуска события KeyDown карта события элемента управления должна иметь определенное событие KeyDown.

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>ColeControl::FireKeyPress

Вызывается по системе, когда ключ нажат и выпущен в то время как пользовательский контроль пользовательского пользовательского времени Активный в контейнере.

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на значение символа нажатия ключа.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Получатель события может изменить *pnChar,* например, преобразовать все символы нижнего регистра в верхний регистр. Если вы хотите изучить измененный `OnKeyPressEvent`символ, переопределить .

Для автоматического стрельбы события KeyPress произойдет, карта события управления должны иметь запас KeyPress событие определено.

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>ColeControl::FireKeyUp

Вызывается по системе, когда ключ выпущен в то время как пользовательский контроль пользовательского пользовательского времени Активный в контейнере.

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на виртуальное значение кода ключа выпущенного ключа. Список стандартных виртуальных кодов ключей можно узнать на примере Winuser.h

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматического запуска события KeyUp на карте события элемента управления необходимо определить событие KeyUp.

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>ColeControl::FireMouseDown

Вызывается рамки, когда кнопка мыши нажата над активным пользовательским управлением.

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nКнопка*<br/>
Числовое значение кнопки мыши нажата. Он может содержать одно из следующих значений:

- LEFT_BUTTON Левая кнопка мыши была нажата вниз.

- MIDDLE_BUTTON Кнопка средней мыши была нажата вниз.

- RIGHT_BUTTON Правая кнопка мыши была нажата вниз.

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

*x*<br/>
X-координат курсора при нажатии кнопки мыши. Координаты относительно верхнего левого угла окна управления.

*Y*<br/>
Y-координат курсора при нажатии кнопки мыши. Координаты относительно верхнего левого угла окна управления.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматического запуска события MouseDown карта события элемента управления должна иметь определенное событие MouseDown.

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>ColeControl::FireMouseMove

Вызывается по фрейму, когда курсор перемещается через активный пользовательский контроль.

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nКнопка*<br/>
Числовое значение нажатия кнопок мыши. Содержит комбинацию из следующих значений:

- LEFT_BUTTON Левая кнопка мыши была нажата вниз во время действия.

- MIDDLE_BUTTON Кнопка средней мыши была нажата вниз во время действия.

- RIGHT_BUTTON правая кнопка мыши была нажата вниз во время действия.

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

*x*<br/>
X-координат курсора. Координаты относительно верхнего левого угла окна управления.

*Y*<br/>
Y-координат курсора. Координаты относительно верхнего левого угла окна управления.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматической стрельбы события MouseMove карта события элемента управления должна иметь определенное событие MouseMove.

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>ColeControl::FireMouseUp

Вызывается рамки, когда кнопка мыши выпущена через активный пользовательский контроль.

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nКнопка*<br/>
Численное значение кнопки мыши выпущено. Может иметь одно из следующих значений:

- LEFT_BUTTON была выпущена левая кнопка мыши.

- MIDDLE_BUTTON Была выпущена кнопка «Средняя мышь».

- RIGHT_BUTTON была выпущена правая кнопка мыши.

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

*x*<br/>
X-координат курсора, когда кнопка мыши была выпущена. Координаты относительно верхнего левого угла окна управления.

*Y*<br/>
Y-координат курсора при выпуске кнопки мыши. Координаты относительно верхнего левого угла окна управления.

### <a name="remarks"></a>Remarks

Если это событие определено как пользовательское событие, вы определяете, когда событие будет запущено.

Для автоматической стрельбы события MouseUp карта события должна иметь определяемое событие MouseUp.

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>ColeControl::FireReadyState

Запускает событие с текущей стоимостью готового состояния управления.

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>Remarks

Готовое состояние может быть одним из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Контроль в настоящее время загружает свои свойства|
|READYSTATE_LOADED|Контроль был инициализирован|
|READYSTATE_INTERACTIVE|Контроль имеет достаточно данных, чтобы быть интерактивными, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Контроль имеет все свои данные|

Используйте [GetReadyState](#getreadystate) для определения текущей готовности элемента управления.

[InternalSetReadyState](#internalsetreadystate) изменяет готовое состояние на `FireReadyStateChange`поставляемое значение, а затем вызывает.

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>ColeControl:GetActivationPolicy

Изменяет поведение активации по умолчанию `IPointerInactive` элемента управления, поддерживающего интерфейс.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Возвращаемое значение

Комбинация флагов из перечисления POINTERINACTIVE. Возможные флаги:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Объект должен быть активирован на месте, когда мышь входит в него во время операции перемещения мыши.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Объект должен быть деактивирован, когда мышь покидает объект во время операции перемещения мыши.|
|POINTERINACTIVE_ACTIVATEONDRAG|Объект должен быть активирован на месте, когда мышь перетаскивается над ним во время операции перетаскивания и падения.|

### <a name="remarks"></a>Remarks

Когда `IPointerInactive` интерфейс включен, контейнер будет делегировать WM_SETCURSOR и WM_MOUSEMOVE сообщения к нему. `COleControl`Реализация этого интерфейса будет отправлять эти сообщения через карту сообщений вашего элемента управления, после правильной настройки координат мыши.

Всякий раз, когда контейнер получает WM_SETCURSOR или WM_MOUSEMOVE сообщение с `IPointerInactive`указателем мыши `GetActivationPolicy` над неактивным объектом поддержки, он должен вызвать интерфейс и вернуть флаги из перечисления POINTERINACTIVE.

Вы можете обрабатывать эти сообщения так же, как обычные сообщения окна, добавив соответствующие записи на карту сообщений. В обработчиках избегайте использования переменной `m_hWnd` члена (или любых функций члена, которые ее используют), не проверяя, что ее значение не является NULL.

Любой объект, предназначенный для того, чтобы сделать больше, чем установить курсор мыши и/или запустить событие перемещения мыши, например, дать специальную визуальную обратную связь, должен вернуть POINTERINACTIVE_ACTIVATEONENTRY флаги и нарисовать обратную связь только при активной активности. Если объект возвращает этот флаг, контейнер должен немедленно активировать его на месте, а `GetActivationPolicy`затем направить его в то же самое сообщение, которое вызвало вызов.

Если POINTERINACTIVE_ACTIVATEONENTRY и POINTERINACTIVE_DEACTIVATEONLEAVE флаги возвращаются, то объект будет активирован только тогда, когда мышь находится над объектом. Если возвращается только POINTERINACTIVE_ACTIVATEONENTRY флаг, то объект активируется только один раз, когда мышь впервые входит в объект.

Вы также можете захотеть, чтобы неактивный элемент управления стал мишенью операции сопротивления и падения OLE. Это требует активации элемента управления в тот момент, когда пользователь перетаскивает объект над ним, так что окно элемента управления может быть зарегистрировано в качестве цели падения. Чтобы вызвать активацию во время перетаскивания, верните POINTERINACTIVE_ACTIVATEONDRAG флаг:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Информация, перевоенная, не `GetActivationPolicy` должна кэширована контейнером. Вместо этого этот метод следует вызывать каждый раз, когда мышь входит в неактивный объект.

Если неактивный объект не запрашивает активацию на месте при входе мыши, его контейнер должен отправлять последующие сообщения WM_SETCURSOR этому объекту, вызывая [OnInactiveSetCursor](#oninactivesetcursor) до тех пор, пока указатель мыши остается над объектом.

Включение `IPointerInactive` интерфейса обычно означает, что вы хотите, чтобы элемент управления был способен обрабатывать сообщения мыши в любое время. Чтобы получить такое поведение в контейнере, который не поддерживает `IPointerInactive` интерфейс, вам нужно, чтобы ваш контроль всегда активировался, когда видимый, что означает, что элемент управления должен иметь OLEMISC_ACTIVATEWHENVISIBLE флаг среди его различных флагов. Однако, чтобы этот флаг не вступил в `IPointerInactive`силу в контейнере, который поддерживается, вы также можете указать OLEMISC_IGNOREACTIVATEWHENVISIBLE флаг:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>ColeControl::GetAmbientProperty

Получает стоимость окружающего свойства контейнера.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Параметры

*dwDispid*<br/>
Идентификатор отправки желаемого свойства окружающей среды.

*vtProp*<br/>
Тег типа варианта, который определяет тип значения, которое будет возвращено в *pvProp.*

*pvProp*<br/>
Указатель на адрес переменной, которая получит значение свойства или значение возврата. Фактический тип этого указателя должен соответствовать типу, указанному *vtProp.*

|vtProp|Тип pvProp|
|------------|--------------------|
|VT_BOOL.|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если эмбиент нот поддерживается; в противном случае 0.

### <a name="remarks"></a>Remarks

Если вы `GetAmbientProperty` используете для получения окружающего DisplayName и ScaleUnits свойства, установите `CString*` *vtProp* VT_BSTR и *pvProp.* Если вы извлекаете свойство окружающего шрифта, установите *vtProp* для VT_FONT и *pvProp* на LPFONTDISP.

Обратите внимание, что функции уже предусмотрены для общих свойств окружающей среды, таких как [AmbientBackColor](#ambientbackcolor) и [AmbientFont.](#ambientfont)

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>ColeControl::GetAppearance

Реализует функцию Get свойства внешнего вида вашего элемента управления.

```
short GetAppearance ();
```

### <a name="return-value"></a>Возвращаемое значение

Значение возврата определяет текущую настройку видимости как **короткое** (VT_I2) значение, если это успешно. Это значение равно нулю, если внешний вид элемента управления плоский и 1, если внешний вид элемента 3D.

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>ColeControl::GetBackColor

Реализует функцию Get склада backColor свойства вашего элемента управления.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Значение возврата определяет текущий цвет фона как OLE_COLOR значение, если успешно. Это значение можно перевести на значение COLORREF `TranslateColor`с вызовом.

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>ColeControl::GetBorderStyle

Реализует функцию Get склада вашего элемента BorderStyle.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Возвращаемое значение

1, если контроль имеет нормальную границу; 0, если контроль не имеет границы.

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>ColeControl::GetCapture

Определяет, имеет `COleControl` ли объект захват мыши.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и не имеет окон, возвращает **это,** если элемент управления в настоящее время имеет захват мыши (как это определено контейнером элемента управления), или NULL, если он не имеет захвата.

В противном `CWnd` случае возвращает объект, который `CWnd::GetCapture`имеет захват мыши (так же, как).

### <a name="remarks"></a>Remarks

Активированный бесхозный контроль получает захват мыши при вызове [SetCapture.](#setcapture)

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>ColeControl::GetClassID

Вызывается фреймворком для получения идентификатора типа OLE элемента управления.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Параметры

*пклид*<br/>
Указатель на местоположение идентификатора класса.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов не был успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Обычно реализуется [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>ColeControl:GetClientOffset

Извлекает разницу между верхним левым углом прямоугольной области управления и верхним левым углом клиентской области.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Параметры

*pdxOffset*<br/>
Указатель на горизонтальное смещение клиентской области управления OLE.

*pdyOffset*<br/>
Указатель на вертикальное смещение клиентской области управления OLE.

### <a name="remarks"></a>Remarks

Управление OLE имеет прямоугольную область внутри контейнера. Клиентской областью управления является область управления, за исключением границ и прокруток баров. Смещение извлекается `GetClientOffset` является разница между верхним левым углом прямоугольной области управления и верхнего левого угла его клиентской области. Если ваш элемент не клиента не является клиентом, помимо стандартных границ и прокруток, переуйдите эту функцию участника, чтобы указать смещение.

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>ColeControl::GetClientRect

Получает размер клиентской зоны элемента.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на `RECT` структуру, содержащую размеры клиентской области управления без окон; то есть, размер элемента минус границы окна, рамки, прокрутки баров и так далее. Параметр *lpRect* указывает на размер клиентского прямоугольника элемента управления, а не на его положение.

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>ColeControl::GetClientSite

Запрашивает объект для указателя на свой текущий клиентский сайт в контейнере.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на текущий клиентский сайт управления в контейнере.

### <a name="remarks"></a>Remarks

Возвращается указатель указывает на `IOleClientSite`экземпляр . Интерфейс, `IOleClientSite` реализованный контейнерами, представляет собой представление объекта о его контексте: где он закреплен в документе, где он получает свое хранилище, пользовательский интерфейс и другие ресурсы.

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>ColeControl::GetControlFlags

Извлекает настройки флага управления.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Возвращаемое значение

Комбинация флагов ORed в перечислении ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Remarks

По умолчанию, `GetControlFlags` возвращает `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Если набор, использует функцию начала краски с учетом элементов управления OLE вместо API [BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) (установленпо умолчанию).|
|`clipPaintDC`|Если не установить, отстраняет вызов `IntersectClipRect` сделал `COleControl` и получает небольшое преимущество скорости. Если вы используете активацию без окон, флаг не имеет эффекта.|
|`pointerInactive`|Если набор, обеспечивает взаимодействие мыши в то `COleControl`время как `IPointerInactive` ваш элемент управления неактивен, включив 'с реализацией интерфейса, который отключен по умолчанию.|
|`noFlickerActivate`|Если установлено, устраняет дополнительные операции рисования и сопровождающих визуальный мерцание. Используйте, когда ваш элемент управления рисует одинаково в неактивных и активных состояниях. Если вы используете активацию без окон, флаг не имеет эффекта.|
|`windowlessActivate`|Если набор, указывает на ваш контроль использует активацию без окон.|
|`canOptimizeDraw`|Если установлен, указывается, что элемент управления будет выполнять оптимизированный рисунок, если контейнер поддерживает его.|

Для получения `GetControlFlags` дополнительной информации и других оптимизаций элементов управления OLE см. [ActiveX Controls: Optimization](../../mfc/mfc-activex-controls-optimization.md)

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>ColeControl::GetControlSize

Извлекает размер окна управления OLE.

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Параметры

*pcx*<br/>
Определяет ширину элемента управления в пикселях.

*pcy*<br/>
Определяет высоту управления в пикселях.

### <a name="remarks"></a>Remarks

Обратите внимание, что все координаты для окон управления относительно верхнего левого угла элемента управления.

## <a name="colecontrolgetdc"></a><a name="getdc"></a>ColeControl::GetDC

Обеспечивает для объекта без окон, чтобы получить экран (или совместимый) контекст устройства из контейнера.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Параметры

*lprcRect*<br/>
Указатель на прямоугольник управления без окон хочет перерисовать, в клиентских координатах управления. NULL означает полный размер объекта.

*dwFlags*<br/>
Рисунок атрибутов контекста устройства. Выбор:

- OLEDC_NODRAW указывает на то, что объект не будет использовать контекст устройства для выполнения любого чертежа, а просто для получения информации об устройстве отображения. Контейнер должен просто пройти DC окна без дальнейшей обработки.

- OLEDC_PAINTBKGND просит контейнер покрасить фон перед возвращением DC. Объект должен использовать этот флаг, если он запрашивает DC для перерисовки области с прозрачным фоном.

- OLEDC_OFFSCREEN информирует контейнер о том, что объект желает визуализировать в заэкранную бит-карту, которая затем должна быть скопирована на экран. Объект должен использовать этот флаг, когда операция чертежа, которая будет выполняться, генерирует много мерцания. Контейнер свободен для выполнения этого запроса или нет. Однако, если этот флаг не установлен, контейнер должен сдать экранный dc. Это позволяет объектам выполнять операции прямого экрана, такие как показ выделения (через операцию **XOR).**

### <a name="return-value"></a>Возвращаемое значение

Указатель на контекст устройства отображения для области контейнерного `CWnd` клиента в случае успеха; в противном случае значение возврата null. Контекст устройства отображения может быть использован в последующих функциях GDI для рисования в клиентской области окна контейнера.

### <a name="remarks"></a>Remarks

Функция участника [ReleaseDC](#releasedc) должна быть вызвана для освобождения контекста после картины. При `GetDC`вызове объекты передают прямоугольник, в который они хотят втянуться в свои координаты клиента. `GetDC`переводит их в координаты области контейнерного клиента. Объект не должен запрашивать желаемый прямоугольник рисунок больше, чем его собственный прямоугольник области клиента, размер которого может быть извлечен с [GetClientRect.](#getclientrect) Это предотвращает непреднамеренное рисование объектов там, где они не должны.

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>ColeControl::GetEnabled

Реализует функцию Get свойствы элемента управления включено.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент управления включен; в противном случае 0.

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>ColeControl::GetExtendedControl

Получает указатель на объект, поддерживаемый контейнером, представляющий элемент управления с расширенным набором свойств.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на расширенный контрольный объект контейнера. Если объекта нет, значение NULL.

Этим объектом можно манипулировать через его `IDispatch` интерфейс. Вы также `QueryInterface` можете использовать для получения других доступных интерфейсов, предоставляемых объектом. Однако объект не требуется для поддержки определенного набора интерфейсов. Обратите внимание, что использование специфических особенностей расширенного объекта управления контейнера ограничивает переносимость элемента управления другими произвольными контейнерами.

### <a name="remarks"></a>Remarks

Функция, которая вызывает эту функцию, отвечает за освобождение указателя при завершении с объектом. Обратите внимание, что контейнер не требуется для поддержки этого объекта.

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>ColeControl::GetFocus

Определяет, имеет `COleControl` ли объект фокус.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и не имеет окон, возвращает **это,** если элемент управления в настоящее время имеет фокус клавиатуры (как определяется контейнером элемента управления), или NULL, если он не имеет фокуса.

В противном `CWnd` случае возвращает объект, `CWnd::GetFocus`который имеет фокус (то же самое, что и).

### <a name="remarks"></a>Remarks

Активированный элемент управления без окон получает фокус при вызове [SetFocus.](#setfocus)

## <a name="colecontrolgetfont"></a><a name="getfont"></a>ColeControl::GetFont

Реализует функцию Get свойства шрифта.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс диспетчерской отправки шрифта в свойстве шрифта элемента управления.

### <a name="remarks"></a>Remarks

Обратите внимание, что абонент должен освободить объект по завершении. В рамках реализации элемента управления используйте `InternalGetFont` для доступа к объекту шрифта элемента шрифта элемента элемента элемента элемента элемента элемента элемента элемента элемента элемента элемента управления. Для получения дополнительной информации об использовании шрифтов в элементе управления смотрите статью [ActiveX Controls: Использование шрифтов в ActiveX Control](../../mfc/mfc-activex-controls-using-fonts.md).

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>ColeControl::GetFontTextMetrics

Измеряет текстовые метрики для любого `CFontHolder` объекта, принадлежащего элементу управления.

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*lptm*<br/>
Указатель на структуру [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

*FontHolder*<br/>
Ссылка на объект [CFontHolder.](../../mfc/reference/cfontholder-class.md)

### <a name="remarks"></a>Remarks

Такой шрифт можно выбрать с помощью функции [COleControl::SelectFontObject.](#selectfontobject) `GetFontTextMetrics`будет инициализировать структуру, `TEXTMETRIC` указанную *lptm* с достоверной информацией метрик о `fontHolder`шрифте 's, если успешно, или заполнить структуру с нулями, если не успешным. Вы должны использовать эту функцию вместо [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) при окрашивании элемента управления, потому что элементы управления, как и любой встроенный объект OLE, могут потребоваться, чтобы сделать себя в метафайл.

Структура `TEXTMETRIC` шрифта по умолчанию обновляется при вызове функции [SelectFontObject.](#selectfontobject) Вы должны `GetFontTextMetrics` позвонить только после выбора свойства шрифта, чтобы гарантировать, что информация, которая она предоставляет, действительна.

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>ColeControl::GetForeColor

Реализует функцию Get в свойстве ForeColor.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Значение возврата определяет текущий цвет переднего плана как OLE_COLOR значение, если успешно. Это значение можно перевести на значение [COLORREF](/windows/win32/gdi/colorref) с вызовом. `TranslateColor`

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>ColeControl::GetHwnd

Реализует функцию Get свойства stock hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Возвращаемое значение

Ручка окна управления OLE, если такового; в противном случае NULL.

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>ColeControl::GetMessageString

Вызывается в рамках, чтобы получить короткую строку, которая описывает цель элемента меню, идентифицированного *nID.*

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор элемента меню.

*rMessage*<br/>
Ссылка на объект [CString,](../../atl-mfc-shared/reference/cstringt-class.md) через который будет возвращена строка.

### <a name="remarks"></a>Remarks

Это может быть использовано для получения сообщения для отображения в панели статуса во время выделения элемента меню. Реализация по умолчанию пытается загрузить строку ресурса, идентифицированного *nID.*

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>ColeControl::GetNotSupported

Предотвращает доступ пользователя к свойство элемента управления.

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>Remarks

Вызовите эту функцию вместо функции Get любого свойства, где поиск свойства пользователем элемента управления не поддерживается. Одним из примеров может быть свойство, которое пишется только.

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>ColeControl::GetReadyState

Возвращает состояние готовности элемента управления.

```
long GetReadyState();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние готовности элемента управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Контроль в настоящее время загружает свои свойства|
|READYSTATE_LOADED|Контроль был инициализирован|
|READYSTATE_INTERACTIVE|Контроль имеет достаточно данных, чтобы быть интерактивными, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Контроль имеет все свои данные|

### <a name="remarks"></a>Remarks

Большинству простых элементов управления никогда не нужно различать LOADED и INTERACTIVE. Однако элементы управления, поддерживающие свойства пути данных, могут быть не готовы к интерактивному режиму до тех пор, пока хотя бы некоторые данные не будут получены асинхронно. Контроль должен попытаться стать интерактивным как можно скорее.

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>ColeControl::GettInContainer

Получает координаты прямоугольника управления относительно контейнера, выраженные в блоках устройства.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на структуру прямоугольника, в которую будут скопированы координаты элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент управления находится на месте активного; в противном случае 0.

### <a name="remarks"></a>Remarks

Прямоугольник действителен только в том случае, если элемент управления активен.

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>ColeControl::GetStockTextMetrics

Измеряет текстовые метрики для свойства шрифта элемента управления, которое может быть выбрано с функцией [SelectStockFont.](#selectstockfont)

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Параметры

*lptm*<br/>
Указатель на структуру [TEXTMETRIC.](/windows/win32/api/wingdi/ns-wingdi-textmetricw)

### <a name="remarks"></a>Remarks

Функция `GetStockTextMetrics` будет инициализировать `TEXTMETRIC` структуру, указанную *lptm* с достоверной информацией метрик, если успешно, или заполнить структуру с нулями, если не успешным. Используйте эту функцию вместо [GetTextMetrics](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics) при окрашивании элемента управления, поскольку для визуализации элементов управления, как и для любого встроенного объекта OLE, может потребоваться для того, чтобы превратить себя в метафайл.

Структура `TEXTMETRIC` шрифта по умолчанию обновляется при вызове функции. `SelectStockFont` Эту функцию следует называть только после выбора шрифта, чтобы гарантировать, что информация, которая она предоставляет, действительна.

## <a name="colecontrolgettext"></a><a name="gettext"></a>ColeControl::GetText

Реализует функцию Get свойства текста или подписи.

```
BSTR GetText();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение строки текста управления или строки нулевой длины, если строки нет.

> [!NOTE]
> Для получения дополнительной информации о [Data Types](../../mfc/reference/data-types-mfc.md) типе данных BSTR см.

### <a name="remarks"></a>Remarks

Обратите внимание, что абонент этой `SysFreeString` функции должен вызвать строку, возвращенную для того, чтобы освободить ресурс. В рамках реализации элемента управления используйте `InternalGetText` для доступа к свойству текста или подписи элемента управления.

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>ColeControl::GetWindowlessDropTarget

Переопределение, `GetWindowlessDropTarget` когда вы хотите, чтобы управление без окон было целью операции сопротивления и падения OLE.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `IDropTarget` интерфейс объекта. Поскольку у него нет окна, объект без `IDropTarget` окон не может зарегистрировать интерфейс. Однако, чтобы участвовать в перетаскивании и падении, объект без окон все еще может реализовать интерфейс и вернуть его в. `GetWindowlessDropTarget`

### <a name="remarks"></a>Remarks

Как правило, это требует, чтобы окно элемента управления было зарегистрировано в качестве цели падения. Но так как элемент управления не имеет собственного окна, контейнер будет использовать свое собственное окно в качестве цели падения. Элемент управления просто должен обеспечить `IDropTarget` реализацию интерфейса, на который контейнер может делегировать вызовы в соответствующее время. Пример:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>ColeControl::InitialIIDs

Информирует базовый класс IID, который будет использовать элемент управления.

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Параметры

*piidPrimary*<br/>
Указатель на идентификатор интерфейса основного диспетчерского интерфейса элемента управления.

*piidEvents*<br/>
Указатель на идентификатор интерфейса интерфейса элемента управления.

### <a name="remarks"></a>Remarks

Позвоните в эту функцию в конструкторе управления, чтобы сообщить базовый класс идентифицированных интерфейса, которые будет использоватьваш элемент управления.

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>ColeControl::InternalGetFont

Доступ к свойству шрифта вашего элемента

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылка на объект [CFontHolder,](../../mfc/reference/cfontholder-class.md) содержащий объект шрифта.

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>ColeControl::InternalGetText

Доступ к запасу Текст или Подпись собственности вашего контроля.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылка на строку текста управления.

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>ColeControl::InternalSetReadyState

Устанавливает состояние готовности элемента управления.

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Параметры

*lNewReadyState*<br/>
Состояние готовности для установки для управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|Контроль в настоящее время загружает свои свойства|
|READYSTATE_LOADED|Контроль был инициализирован|
|READYSTATE_INTERACTIVE|Контроль имеет достаточно данных, чтобы быть интерактивными, но не все асинхронные данные еще загружены|
|READYSTATE_COMPLETE|Контроль имеет все свои данные|

### <a name="remarks"></a>Remarks

Большинству простых элементов управления никогда не нужно различать LOADED и INTERACTIVE. Однако элементы управления, поддерживающие свойства пути данных, могут быть не готовы к интерактивному режиму до тех пор, пока хотя бы некоторые данные не будут получены асинхронно. Контроль должен попытаться стать интерактивным как можно скорее.

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>ColeControl::Недействительное управление

Заставляет контроль перерисовать себя.

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на область контроля, чтобы быть недействительным.

*bErase*<br/>
Определяется, следует ли стирать фон в области обновления при обработке области обновления.

### <a name="remarks"></a>Remarks

Если *lpRect* имеет значение NULL, весь элемент управления будет перерисован. Если *lpRect* не является NULL, это указывает на часть прямоугольника элемента управления, которая должна быть признана недействительной. В тех случаях, когда элемент управления не имеет окна или в настоящее время не активен, прямоугольник игнорируется, и вызов делается на функцию [IAdviseSink::OnViewChange.](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange) Используйте эту `CWnd::InvalidateRect` функцию вместо или `InvalidateRect`.

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>ColeControl::Недействительно

Недействительная область клиентского окна контейнера в данном регионе.

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*pRgn*<br/>
Указатель на объект [CRgn,](../../mfc/reference/crgn-class.md) который идентифицирует область отображения объекта OLE для признания недействительным, в координатах клиента, содержащего окно. Если этот параметр null, то размер весь предмет.

*bErase*<br/>
Определяется, следует ли стирать фон в недействительном регионе. Если true, фон стирается. Если FALSE, фон остается неизменным.

### <a name="remarks"></a>Remarks

Это может быть использовано для перерисовки без окон управления в контейнере. Недействительный регион, наряду со всеми другими областями в области обновления, помечен для покраски при отправке следующего [WM_PAINT](/windows/win32/gdi/wm-paint) сообщения.

Если *bErase* является правдой для любой части региона обновления, фон во всем регионе, а не только в данной части, стирается.

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>ColeControl::IsConvertingVBX

Позволяет специализированную загрузку управления OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент преобразуется; в противном случае 0.

### <a name="remarks"></a>Remarks

При преобразовании формы, использующей элементы управления VBX, в элементы управления OLE, может потребоваться специальный код загрузки для элементов управления OLE. Например, если вы загружаете экземпляр управления OLE, у `DoPropExchange`вас может быть звонок для [PX_Font](persistence-of-ole-controls.md#px_font) в:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Однако в элементах управления VBX не было объекта шрифта; каждое свойство шрифта было сохранено индивидуально. В этом случае можно `IsConvertingVBX` провести различие между этими двумя случаями:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Другой случай будет, если ваш контроль VBX сохранены собственные двоичные данные (в его VBM_SAVEPROPERTY обработчик сообщения), и ваш контроль OLE сохраняет свои двоичные данные в другом формате. Если вы хотите, чтобы ваш элемент управления OLE был совместим с управлением VBX, `IsConvertingVBX` вы можете прочитать как старые, так и новые форматы, используя эту функцию, различая, загружается ли управление VBX или управление OLE.

В функции `DoPropExchange` элемента управления можно проверить это условие и, если это правда, выполнить код загрузки, специфичный для этого преобразования (например, предыдущие примеры). Если элемент управления не преобразуется, можно выполнить нормальный код нагрузки. Эта способность применима только к элементам управления, преобразоваемым из аналогов VBX.

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>ColeControl::IsvokeРазрешен

Позволяет использовать метод автоматизации.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если контроль был инициализирован; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация вызовов `IDispatch::Invoke` `IsInvokeAllowed` в рамках для определения того, `dispid`может ли вызываться данная функция (идентифицированная). Поведение по умолчанию для управления OLE позволяет вызывать методы автоматизации только в том случае, если элемент управления был инициализирован; однако, `IsInvokeAllowed` является виртуальной функцией и может быть отменена при необходимости (например, когда элемент управления используется в качестве сервера автоматизации).

## <a name="colecontrolismodified"></a><a name="ismodified"></a>ColeControl:: Изменено

Определяет, было ли изменено состояние элемента управления.

```
BOOL IsModified();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если состояние элемента управления было изменено с момента его последнего сохранения; в противном случае 0.

### <a name="remarks"></a>Remarks

Состояние элемента управления изменяется при изменении значения свойства.

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>ColeControl::IsOptimizedDraw

Определяет, поддерживает ли контейнер оптимизированный рисунок для текущей операции рисования.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Возвращаемое значение

TRUE, если контейнер поддерживает оптимизированный рисунок для текущей операции рисования; в противном случае FALSE.

### <a name="remarks"></a>Remarks

Если оптимизированный рисунок поддерживается, то элемент управления не нужно выбирать старые объекты (ручки, кисти, шрифты и т.д.) в контекстустройства при завершении рисования.

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>ColeControl::IsSubclassedControl

Вызывается фреймворцом, чтобы определить, подклассы управления являются системой управления Windows.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элемент управления подклассифицирован; в противном случае 0.

### <a name="remarks"></a>Remarks

Вы должны переопределить эту функцию и вернуть ПРАВДУ, если ваш подкласс управления OLE подклассы управления Windows.

## <a name="colecontrolload"></a><a name="load"></a>ColeControl::Load

Сброс любых предыдущих данных, загруженных асинхронно и инициирует новую загрузку асинхронного свойства элемента управления.

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Параметры

*strNewPath*<br/>
Указатель на строку, содержащую путь, отосвеяет абсолютное местоположение асинхронного свойства управления.

*Prop*<br/>
Объект [CDataPathProperty,](../../mfc/reference/cdatapathproperty-class.md) реализующий асинхронное свойство управления.

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>ColeControl::LockInPlaceActive

Предотвращает деактивацию управления контейнером.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Параметры

*Блок*<br/>
TRUE, если в месте активное состояние управления должно быть заблокировано; FALSE, если он должен быть разблокирован.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если блокировка была успешной; в противном случае 0.

### <a name="remarks"></a>Remarks

Обратите внимание, что каждая блокировка элемента управления должна быть сопряжена с разблокировкой элемента управления по завершении. Вы должны заблокировать элемент управления только на короткие периоды, например, при запуске события.

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>ColeControl::OnAmbientPropertyChange

Вызывается в рамках, когда окружающее свойство контейнера изменило значение.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*dispID*<br/>
Идентификатор отправки измененного свойства окружающего или DISPID_UNKNOWN, если изменилось несколько свойств.

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>ColeControl::OnAppearanceИзменен

Вызывается по фреймворку при изменении стоимости свойства повнешней стоимости.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Remarks

Переопределить эту функцию, если требуется уведомление после изменения этого свойства. Вызовы реализации по `InvalidateControl`умолчанию.

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>ColeControl::OnBackColorChanged

Вызывается по структуре, когда стоимость недвижимости BackColor изменилась.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Remarks

Переопределить эту функцию, если требуется уведомление после изменения этого свойства. Вызовы реализации по `InvalidateControl`умолчанию.

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>ColeControl::OnborderStyleChanged

Вызывается по системе, когда стоимость недвижимости BorderStyle изменилась.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Remarks

Вызовы реализации по `InvalidateControl`умолчанию.

Переопределить эту функцию, если требуется уведомление после изменения этого свойства.

## <a name="colecontrolonclick"></a><a name="onclick"></a>ColeControl::OnClick

Вызывается по системе при нажатии кнопки мыши или вызове метода акции DoClick.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Параметры

*iButton*<br/>
Индекс кнопки мыши. Может иметь одно из следующих значений:

- LEFT_BUTTON была нажат левая кнопка мыши.

- MIDDLE_BUTTON кнопка «Средняя мышь» была нажата.

- RIGHT_BUTTON кнопка правой мыши была нажата.

### <a name="remarks"></a>Remarks

Вызовы реализации по `COleControl::FireClick`умолчанию.

Переизбь эту функцию участника для изменения или расширения обработки по умолчанию.

## <a name="colecontrolonclose"></a><a name="onclose"></a>ColeControl::Onclose

Вызывается по фрейму, когда контейнер `IOleControl::Close` вызывает функцию управления.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Параметры

*dwSaveOption*<br/>
Пометить, следует ли сохранять объект перед загрузкой. Допустимые значения:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Remarks

По умолчанию сохраняет объект управления, `OnClose` если он был изменен, и *dwSaveOption* является OLECLOSE_SAVEIFDIRTY или OLECLOSE_PROMPTSAVE.

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>ColeControl::OndoVerb

Вызывается по системе, когда `IOleObject::DoVerb` контейнер вызывает функцию члена.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*iVerb*<br/>
Индекс глагола управления, на который следует ссылаться.

*lpMsg*<br/>
Указатель на сообщение Windows, вызвавшее вызов глагола.

*hWndParent*<br/>
Ручка к родительскому окну элемента управления. Если выполнение глагола создает окно (или окна), *hWndParent* следует использовать в качестве родителя.

*lpRect*<br/>
Указатель на структуру RECT, в которую будут скопированы координаты элемента управления по отношению к контейнеру.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию использует ON_OLEVERB и ON_STDOLEVERB записи карты сообщений для определения правильной функции для ввода.

Переизбь эту функцию, чтобы изменить обработку глагола по умолчанию.

## <a name="colecontrolondraw"></a><a name="ondraw"></a>ColeControl::OnDraw

Вызывается фреймворцом, чтобы нарисовать элемент управления OLE в указанном связующего прямоугольнике с использованием заданного контекста устройства.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисунок.

*rcBounds*<br/>
Прямоугольная зона контроля, включая границу.

*rcНедействительной*<br/>
Прямоугольная область элемента управления, которая недействительна.

### <a name="remarks"></a>Remarks

`OnDraw`обычно требуется для отображения экрана, проходя контекст экрана устройства как *pDC.* Параметр *rcBounds* определяет прямоугольник в контексте целевого устройства (относительно текущего режима отображения). Параметр *rcInvalid* является фактическим прямоугольником, который является недействительным. В некоторых случаях это будет меньшая площадь, чем *rcBounds.*

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>ColeControl::OnDrawMetafile

Вызывается фреймворцом, чтобы нарисовать элемент управления OLE в указанном связующего прямоугольнике с помощью заданного контекста метафайлного устройства.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисунок.

*rcBounds*<br/>
Прямоугольная зона контроля, включая границу.

### <a name="remarks"></a>Remarks

Реализация по умолчанию вызывает функцию [OnDraw.](#ondraw)

## <a name="colecontrolonedit"></a><a name="onedit"></a>ColeControl::It

Вызывает активацию элемента управления.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpMsg*<br/>
Указатель на сообщение Windows, вызываемый глаголом.

*hWndParent*<br/>
Ручка к родительскому окну элемента управления.

*lpRect*<br/>
Указатель на прямоугольник, используемый элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов является успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Это имеет тот же эффект, что и ссылаясь на OLEIVERB_UIACTIVATE глагол управления.

Эта функция обычно используется в качестве функции обработчика для входа в карту ON_OLEVERB сообщений. Это делает глагол "Edit" доступным в меню элемента управления "Объект". Пример:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>ColeControl::OnEnabledChanged

Вызывается по фреймворку при изменении стоимости свойства включена в акции.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Remarks

Переопределить эту функцию, если требуется уведомление после изменения этого свойства. Реализация по умолчанию вызывает [недействительное управление](#invalidatecontrol).

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>ColeControl::OnEnumVerbs

Вызывается по системе, когда `IOleObject::EnumVerbs` контейнер вызывает функцию члена.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Параметры

*ppenumOleVerb*<br/>
Указатель на `IEnumOLEVERB` объект, перечисляет глаголы элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если глаголы доступны; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию перечисляет ON_OLEVERB записи на карте сообщений.

Переизбь эту функцию, чтобы изменить способ перечисления глаголов по умолчанию.

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>ColeControl::OneventAdvise

Вызывается системой, когда обработчик событий подключен к или отключен от управления OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Параметры

*bAdvise*<br/>
TRUE указывает на то, что обработчик событий был подключен к элементу управления. FALSE указывает на то, что обработчик событий был отключен от элемента управления.

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>ColeControl::OnfontChanged

Вызывается по фреймворку при изменении стоимости свойства шрифта.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Remarks

Вызовы реализации по `COleControl::InvalidateControl`умолчанию. Если элемент управления подклассирует элемент управления Windows, реализация по умолчанию также отправляет WM_SETFONT сообщение в окно элемента управления.

Переопределить эту функцию, если требуется уведомление после изменения этого свойства.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>ColeControl::OnForeColorChanged

Вызывается по структуре, когда стоимость имущества ForeColor изменилась.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Remarks

Вызовы реализации по `InvalidateControl`умолчанию.

Переопределить эту функцию, если требуется уведомление после изменения этого свойства.

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>ColeControl::OnfreezeEvents

Вызывается по системе после `IOleControl::FreezeEvents`вызова контейнера.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Параметры

*bFreeze*<br/>
TRUE, если обработка события элемента управления заморожена; в противном случае FALSE.

### <a name="remarks"></a>Remarks

Реализация по умолчанию не выполняет никаких действий.

Переопределить эту функцию, если требуется дополнительное поведение при замораживании или разморажении обработки событий.

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>ColeControl::OnGetColorset

Вызывается по системе, когда `IViewObject::GetColorSet` контейнер вызывает функцию члена.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указывает на целевое устройство, для которого должно быть отображено изображение. Если это значение null, изображение должно быть отображено для целевого устройства по умолчанию, как правило, устройства отображения.

*hicTargetDev*<br/>
Определяет информационный контекст на целевом устройстве, указанном *ptd*. Этот параметр может быть контекстом устройства, но не обязательно. Если *ptd* null, *hicTargetDev* также должен быть NULL.

*ppColorSet*<br/>
Указатель на место, в котором должен быть скопирован набор цветов, которые будут использоваться. Если функция не возвращает цветовой набор, NULL возвращается.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если верный набор цветов возвращается; в противном случае 0.

### <a name="remarks"></a>Remarks

Контейнер вызывает эту функцию, чтобы получить все цвета, необходимые для рисования управления OLE. Контейнер может использовать цветовые наборы, полученные в сочетании с цветами, необходимыми для установки общей цветовой палитры. Реализация по умолчанию возвращает FALSE.

Переопределить эту функцию, чтобы сделать любую специальную обработку этого запроса.

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>ColeControl::OnGetControlInfo

Вызывается по системе, когда контейнер управления запросил информацию о элементе управления.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Параметры

*pControlInfo*<br/>
Указатель на структуру [CONTROLINFO,](/windows/win32/api/ocidl/ns-ocidl-controlinfo) которая должна быть заполнена.

### <a name="remarks"></a>Remarks

Эта информация состоит в основном из описания мнемонических ключей управления. Реализация по умолчанию заполняет *pControlInfo* информацией по умолчанию.

Переопределить эту функцию, если ваш элемент управления необходимо обрабатывать мнемонные клавиши.

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>ColeControl::OnGetDisplaystring

Вызывается рамками для получения строки, представляющей текущую стоимость свойства, идентифицированного *dispid.*

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор диспетчера свойства элемента управления.

*strValue*<br/>
Ссылка на объект [CString,](../../atl-mfc-shared/reference/cstringt-class.md) через который будет возвращена строка.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если строка была возвращена в *strValue;* в противном случае 0.

### <a name="remarks"></a>Remarks

Переизобить эту функцию, если ваш элемент управления имеет свойство, значение которого не может быть непосредственно преобразовано в строку, и вы хотите, чтобы значение свойства отображалось в контейнерном браузере свойств.

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>ColeControl::OnGetinPlacemenu

Вызывается инфраструктурой при активации единомышлеченного элемента управления для получения меню, необходимого для объединения в существующее меню контейнера.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Ручка меню элемента управления, или NULL, если элемент управления не имеет. Реализация по умолчанию возвращает NULL.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации о слиянии ресурсов OLE, см. [Menus and Resources (OLE)](../../mfc/menus-and-resources-ole.md)

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>ColeControl::OngetNaturalExtent

Вызывается по системе в ответ `IViewObjectEx::GetNaturalExtent` на запрос контейнера.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Указывает способ представления объекта. Представления включают содержимое, значок, миниатюру или печатный документ. Допустимые значения взяты из перечисления [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*Lindex*<br/>
Часть объекта, которая представляет интерес. В настоящее время действует только -1.

*ptd*<br/>
Указывает на структуру [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) определяющую целевое устройство, для которого должен быть возвращен размер объекта.

*hicTargetDev*<br/>
Определяет информационный контекст для целевого устройства, указанный *ptd* параметром, из которого объект может извлечь метрики устройства и проверить возможности устройства. Если *ptd* null, объект должен игнорировать значение в параметре *hicTargetDev.*

*pExtentInfo*<br/>
Указывает на `DVEXTENTINFO` структуру, опознавающая данные размеров. Структура: `DVEXTENTINFO`

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Член `dwExtentMode` структуры может взять одно из двух значений:

- DVEXTENT_CONTENT Узнайте, насколько велик должен быть элемент управления, чтобы точно соответствовать содержимому (snap-to-size)

- DVEXTENT_INTEGRAL При реразмерении, пройти предлагаемый размер для управления

*psizel*<br/>
Очки для размеров данных, возвращенных управлением. Данные возврата размеров установлены до -1 для любого измерения, которое не было скорректировано.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если он успешно возвращает или регулирует размер; в противном случае 0.

### <a name="remarks"></a>Remarks

Переопределить эту функцию, чтобы вернуть размер дисплея объекта ближе всего `DVEXTENTINFO` к предлагаемому размеру и режиму размера в структуре. Реализация по умолчанию возвращает FALSE и не вносит никаких корректировок в размер.

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>ColeControl::OnGetPredefinedStrings

Вызывается в рамках для получения набора предопределенных строк, представляющих возможные значения для свойства.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор диспетчера свойства элемента управления.

*pStringArray*<br/>
Массив строк, который должен быть заполнен значениями возврата.

*pCookieArray*<br/>
Массив DWORD, который должен быть заполнен значениями возврата.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если элементы были добавлены в *pStringArray* и *pCookieArray*.

### <a name="remarks"></a>Remarks

Переопределить эту функцию, если ваш элемент управления имеет свойство с набором возможных значений, которые могут быть представлены строками. Для каждого элемента, добавленного в *pStringArray,* следует добавить соответствующий элемент "cookie" в *pCookieArray.* Эти значения "cookie" могут быть позже `COleControl::OnGetPredefinedValue` переданы фреймворком функции.

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>ColeControl::OnGetPredefinedValue

Вызывается рамкой для получения значения, соответствующего одной из предопределенных строк, ранее возвращенных переопределением `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор диспетчера свойства элемента управления.

*dwCookie*<br/>
Значение cookie, ранее возвращенное `COleControl::OnGetPredefinedStrings`переопределением.

*lpvarOut*<br/>
Указатель на `VARIANT` структуру, через которую будет возвращено значение свойства.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если значение было возвращено в *lpvarOut*; в противном случае 0.

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>ColeControl::OnGetViewextent

Вызывается по системе в ответ на [запрос IViewObject2 контейнера::GetExtent](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent) запрос.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Параметры

*dwDrawAspect*<br/>
DWORD, описывающий, какая форма или аспект объекта должна отображаться. Допустимые значения взяты из перечисления [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*Lindex*<br/>
Часть объекта, которая представляет интерес. В настоящее время действует только -1.

*ptd*<br/>
Указывает на структуру [DVTARGETDEVICE,](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) определяющую целевое устройство, для которого должен быть возвращен размер объекта.

*lpsizel*<br/>
Указывает на место, где возвращается размер объекта.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если информация о степени успешно возвращается; в противном случае 0.

### <a name="remarks"></a>Remarks

Переиздайте эту функцию, если ваш элемент управления использует двухпроходный рисунок, а его непрозрачные и прозрачные части имеют разные размеры.

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>ColeControl::OnGetViewRect

Вызывается по системе в ответ `IViewObjectEx::GetRect` на запрос контейнера.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
DWORD, описывающий, какая форма или аспект объекта должна отображаться. Допустимые значения взяты из перечисления [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2:

- DVASPECT_CONTENT связанный прямоугольник всего объекта. Верхний левый угол по происхождению и размеру `GetViewExtent`объекта равен степени, возвращенной *.*

- DVASPECT_OPAQUE Объекты с прямоугольной непрозрачной областью возвращают этот прямоугольник. Другие терпят неудачу.

- DVASPECT_TRANSPARENT Rectangle, охватывающий все прозрачные или нерегулярные части.

*pRect*<br/>
Точки к структуре [RECTL](/windows/win32/api/windef/ns-windef-rectl) с указанием прямоугольника, в котором должен быть нарисован объект. Этот параметр контролирует позиционирование и растяжение объекта.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если прямоугольник размером с объект успешно возвращается; в противном случае 0.

### <a name="remarks"></a>Remarks

Размер объекта преобразуется `OnGetViewRect` в прямоугольник, начиная с определенного положения (по умолчанию является верхний левый угол дисплея). Переиздайте эту функцию, если ваш элемент управления использует двухпроходный рисунок, а его непрозрачные и прозрачные части имеют разные размеры.

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>ColeControl::OnGetViewstatus

Вызывается по системе в ответ `IViewObjectEx::GetViewStatus` на запрос контейнера.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Возвращаемое значение

Одно из значений перечисления VIEWSTATUS в случае успеха; в противном случае 0. Возможные значения представляют собой любое сочетание:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Объект полностью непрозрачный. Если этот бит не установлен, объект содержит прозрачные части. Этот бит относится только к аспектам, связанным с содержанием, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Объект имеет сплошной фон (состоящий в цельном цвете, а не в рисунке кисти). Этот бит имеет смысл только в том случае, если VIEWSTATUS_OPAQUE установлен и применяется только к аспектам, связанным с содержанием, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Объект поддерживает DVASPECT_OPAQUE. Все методы IViewObjectEx, которые принимают аспект рисования в качестве параметра, можно назвать с помощью этого аспекта.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Объект поддерживает DVASPECT_TRANSPARENT. Все `IViewObjectEx` методы, которые принимают рисунок аспект в качестве параметра можно назвать с этим аспектом.|

### <a name="remarks"></a>Remarks

Переиздайте эту функцию, если ваш элемент управления использует двухпроходный рисунок. Реализация по умолчанию возвращается VIEWSTATUS_OPAQUE.

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>ColeControl::OnHidetoolBars

Вызывается инфраструктурой при деактивации элемента управления.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Remarks

Реализация должна скрывать все панели `OnShowToolbars`инструментов, отображаемые .

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>ColeControl::OnInactiveMouseMove

Вызывается контейнером для неактивного объекта под указателем мыши при получении сообщения WM_MOUSEMOVE.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Объект, ограничивающий прямоугольник, в клиентских координатах содержащего окна. Сообщает объекту его точное положение и размер на экране, когда было получено WM_MOUSEMOVE сообщение.

*x*<br/>
X-координаты расположения мыши в координатах клиента содержащего окна.

*Y*<br/>
Y-координаты расположения мыши в координатах клиента содержащего окна.

*dwKeyState*<br/>
Определяет текущее состояние клавиш модификатора клавиатуры на клавиатуре. Допустимые значения могут быть комбинацией любого из флагов MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON и MK_RBUTTON.

### <a name="remarks"></a>Remarks

Обратите внимание, что координаты клиента окон (пиксели) используются для прохождения положения курсора мыши. Это стало возможным благодаря также прохождению ограничивающего прямоугольника объекта в той же системе координат.

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>ColeControl::InInactiveSetCursor

Вызывается контейнером для неактивного объекта под указателем мыши при получении WM_SETCURSOR сообщения.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Объект, ограничивающий прямоугольник, в клиентских координатах содержащего окна. Сообщает объекту его точное положение и размер на экране, когда было получено WM_SETCURSOR сообщение.

*x*<br/>
X-координаты расположения мыши в координатах клиента содержащего окна.

*Y*<br/>
Y-координаты расположения мыши в координатах клиента содержащего окна.

*dwMouseMsg*<br/>
Идентификатор сообщения мыши, для которого произошло WM_SETCURSOR.

*bSetВсегда*<br/>
Определяет, должен ли объект устанавливать курсор. Если это правда, объект должен установить курсор; если FALSE, курсор не обязан устанавливать курсор, и должен вернуться S_FALSE в этом случае.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Обратите внимание, что координаты клиента окон (пиксели) используются для прохождения положения курсора мыши. Это стало возможным благодаря также прохождению ограничивающего прямоугольника объекта в той же системе координат.

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>ColeControl::OnKeydownEvent

Вызывается инфраструктурой после обработки события KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*Nchar*<br/>
Значение кода виртуального ключа отжатого ключа. Список стандартных виртуальных кодов ключей можно узнать на примере Winuser.h

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

### <a name="remarks"></a>Remarks

Переизобить эту функцию, если ваш элемент управления нуждается в доступе к ключевой информации после того, как событие было уволено.

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>ColeControl::OnKeyPressEvent

Вызывается рамки после акции KeyPress событие было уволено.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Параметры

*Nchar*<br/>
Содержит виртуальное значение кода ключа от нажатия клавиши. Список стандартных виртуальных кодов ключей можно узнать на примере Winuser.h

### <a name="remarks"></a>Remarks

Обратите внимание, что значение *nChar* может быть изменено контейнером.

Переопределить эту функцию, если требуется уведомление после этого события.

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>ColeControl::OnKeyupEvent

Вызывается инфраструктурой после обработки события KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*Nchar*<br/>
Значение кода виртуального ключа отжатого ключа. Список стандартных виртуальных кодов ключей можно узнать на примере Winuser.h

*nShiftState*<br/>
Содержит комбинацию из следующих флагов:

- SHIFT_MASK ключ SHIFT был нажат во время акции.

- CTRL_MASK ключ CTRL был нажат во время действия.

- ALT_MASK ключ ALT был нажат во время действия.

### <a name="remarks"></a>Remarks

Переизобить эту функцию, если ваш элемент управления нуждается в доступе к ключевой информации после того, как событие было уволено.

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>ColeControl::OnmappropertytoPage

Вызывается в рамках для получения идентификатора класса страницы свойств, которая реализует редактирование указанного свойства.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Параметры

*Dispid*<br/>
Идентификатор диспетчера свойства элемента управления.

*lpclsid*<br/>
Указатель на `CLSID` структуру, через которую будет возвращен идентификатор класса.

*pbPageФатив*<br/>
Возвращает индикатор того, является ли использование указанной страницы свойства необязательным.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если идентификатор класса был возвращен в *lpclsid;* в противном случае 0.

### <a name="remarks"></a>Remarks

Переизобить эту функцию, чтобы обеспечить способ вызвать страницы свойств элемента управления из браузера свойств контейнера.

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>ColeControl:OnMmonic

Вызывается рамки, когда контейнер обнаружил, что мнемонический ключ управления OLE был нажат.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Параметры

*pMsg*<br/>
Указатель на сообщение Windows, созданное нажатием назначенной клавиши.

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>ColeControl::OnProperties

Вызывается рамкой, когда глагол свойств управления был вызван контейнером.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpMsg*<br/>
Указатель на сообщение Windows, вызываемый глаголом.

*hWndParent*<br/>
Ручка к родительскому окну элемента управления.

*lpRect*<br/>
Указатель на прямоугольник, используемый элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов является успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию отображает модульное поле диалога свойств.

Вы также можете использовать эту функцию, чтобы вызвать отображение страниц свойств элемента управления. Позвоните в `OnProperties` функцию, передав ручку родительского элемента в *hWndParent.* В этом случае значения параметров *lpMsg* и *lpRect* игнорируются.

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>ColeControl::OnqueryhitPoint

Вызывается по системе в ответ `IViewObjectEx::QueryHitPoint` на запрос контейнера.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Определяет, как объект представлен. Допустимые значения взяты из перечисления [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*pRectBounds*<br/>
Указатель на `RECT` структуру, определяющую гранищий прямоугольник области клиента управления OLE.

*ptlLoc*<br/>
Указатель на `POINT` структуру с указанием точки, которая должна быть проверена на наличие удара. Точка указана в координатах клиентской области OLE.

*lCloseHint*<br/>
Расстояние, определяющее "близкое" к точке, проверенное на наличие удара.

*pHitResult*<br/>
Указатель на результат запроса попадания. Одно из следующих значений:

- HITRESULT_OUTSIDE *ptlLoc* находится за пределами объекта OLE и не закрывается.

- HITRESULT_TRANSPARENT *ptlLoc* находится в пределах объекта OLE, но не близко к изображению. Например, точка в середине прозрачного круга может быть HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* находится внутри или снаружи объекта OLE, но достаточно близко к объекту, который будет рассматриваться внутри. Небольшие, тонкие или подробные объекты могут использовать это значение. Даже если точка находится за пределами граничащий прямоугольник объекта, она все равно может быть близка (это необходимо для поражения небольших объектов).

- HITRESULT_HIT *ptlLoc* находится в изображении объекта.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если результат попадания успешно возвращается; в противном случае 0. Удар представляет собой перекрытие с зоной управления OL.

### <a name="remarks"></a>Remarks

Запрашивает, перекрывает ли прямоугольник дисплея объекта заданную точку (попадание в точку). `QueryHitPoint`могут быть переопределены для тестирования хитов для непрямоугольных объектов.

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>ColeControl::On'sryHitRect

Вызывается по системе в ответ `IViewObjectEx::QueryHitRect` на запрос контейнера.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Указывает способ представления объекта. Допустимые значения взяты из перечисления [DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect) или DVASPECT2.

*pRectBounds*<br/>
Указатель на `RECT` структуру, определяющую гранищий прямоугольник области клиента управления OLE.

*prcLoc*<br/>
Указатель на `RECT` структуру, определяющую прямоугольник, который должен быть проверен на наличие удара (перекрытие прямоугольником объекта) относительно верхнего левого угла объекта.

*lCloseHint*<br/>
Не используется.

*pHitResult*<br/>
Указатель на результат запроса попадания. Одно из следующих значений:

- HITRESULT_OUTSIDE ни одна точка в прямоугольнике не попадает под объект OLE.

- HITRESULT_HIT по крайней мере одна точка в прямоугольнике будет хитом на объекте.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если результат попадания успешно возвращается; в противном случае 0.

### <a name="remarks"></a>Remarks

Запрашивает, перекрывает ли прямоугольник дисплея объекта любую точку в данном прямоугольнике (попадание в прямоугольник). `QueryHitRect`могут быть переопределены для тестирования хитов для непрямоугольных объектов.

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>ColeControl::OnRenderData

Вызывается рамкой для извлечения данных в указанном формате.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на структуру [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) с указанием формата, в котором запрашивается информация.

*lpStgMedium*<br/>
Указывает на структуру [STGMEDIUM,](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) в которой данные должны быть возвращены.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Указанный формат — это тот, который ранее размещался в объекте управления с использованием функций участника [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) или [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) для задержки рендеринга. Реализация этой функции `OnRenderFileData` по `OnRenderGlobalData`умолчанию вызывает сявки или, соответственно, если поставляемый носитель хранения является либо файлом, либо памятью. Если запрашиваемый формат находится CF_METAFILEPICT или постоянно настроенный формат свойств, реализация по умолчанию отображает соответствующие данные и возвращает ненулевой. В противном случае, он возвращает 0 и ничего не делает.

Если *lpStgMedium->запечатывается* TYMED_NULL, STGMEDIUM должен быть выделен и заполнен в том виде, в каком указано *lpFormatEtc->свиты.* Если не TYMED_NULL, STGMEDIUM должны быть заполнены на месте с данными.

Переопределить эту функцию, чтобы предоставить данные в запрашиваемом формате и среде. В зависимости от ваших данных, вы можете переопределить одну из других версий этой функции вместо этого. Если ваши данные малы и фиксированные по размеру, переопределить. `OnRenderGlobalData` Если данные находится в файле или имеют `OnRenderFileData`переменный размер, переопределить .

Для получения дополнительной `FORMATETC` информации, см. `STGMEDIUM`

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>ColeControl::OnrenderFileData

Вызывается инфраструктурой для извлечения данных в указанном формате, когда среда хранения является файлом.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на структуру [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) с указанием формата, в котором запрашивается информация.

*pFile*<br/>
Указывает на объект [CFile,](../../mfc/reference/cfile-class.md) в котором данные должны быть отрисованы.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Указанный формат — это тот, который ранее размещался в объекте управления с помощью функции члена [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) для задержки рендеринга. Реализация этой функции по умолчанию просто возвращает FALSE.

Переопределить эту функцию, чтобы предоставить данные в запрашиваемом формате и среде. В зависимости от ваших данных, вы можете переопределить одну из других версий этой функции вместо этого. Если вы хотите обрабатывать несколько носителей хранения, переопределить. `OnRenderData` Если данные находится в файле или имеют `OnRenderFileData`переменный размер, переопределить .

Для получения дополнительной `FORMATETC` информации см.

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>ColeControl::OnrenderGlobalData

Вызывается фреймворцом для извлечения данных в указанном формате, когда указанная среда хранения является глобальной памятью.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на структуру [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) с указанием формата, в котором запрашивается информация.

*phGlobal*<br/>
Указывает на ручку глобальной памяти, в которой данные должны быть возвращены. Если память не выделена, этот параметр может быть NULL.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Указанный формат — это тот, который ранее размещался в объекте управления с помощью функции члена [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) для задержки рендеринга. Реализация этой функции по умолчанию просто возвращает FALSE.

Если *phGlobal* является NULL, то новый HGLOBAL должен быть выделен и возвращен в *phGlobal*. В противном случае HGLOBAL, указанный *phGlobal,* должен быть заполнен данными. Объем данных, размещенных в HGLOBAL, не должен превышать текущий размер блока памяти. Кроме того, блок не может быть перераспределен в больший размер.

Переопределить эту функцию, чтобы предоставить данные в запрашиваемом формате и среде. В зависимости от ваших данных, вы можете переопределить одну из других версий этой функции вместо этого. Если вы хотите обрабатывать несколько носителей хранения, переопределить. `OnRenderData` Если данные находится в файле или имеют `OnRenderFileData`переменный размер, переопределить .

Для получения дополнительной `FORMATETC` информации см.

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>ColeControl::OnResetState

Вызывается инфраструктурой, когда свойства элемента управления должны быть установлены на их значения по умолчанию.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Remarks

Реализация по умолчанию вызывает [DoPropExchange,](#dopropexchange)передавая `CPropExchange` объект, который вызывает установку свойств на их значения по умолчанию.

Автор элемента управления может вставить код инициализации для управления OLE в этом переизбытом. Эта функция называется, когда [IPersistStream::Load](/windows/win32/api/objidl/nf-objidl-ipersiststream-load) или [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) не удается, или [IPersistStreamInit::InitNew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) или `IPersistStream::Load` [IPersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew) называется, без предварительного вызова либо или `IPersistStorage::Load`.

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>ColeControl::OnsetClientsite

Вызывается по фрейму, когда контейнер `IOleControl::SetClientSite` вызывает функцию управления.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Remarks

По умолчанию проверяет, `OnSetClientSite` загружаются ли свойства пути `DoDataPathPropExchange`данных, и, если они есть, вызовы.

Переопределить эту функцию, чтобы сделать любую специальную обработку этого уведомления. В частности, переопределения этой функции следует вызывать базовым классом.

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>ColeControl::OnsetData

Вызывается рамкой для замены данных управления указанными данными.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указатель на структуру [FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc) с указанием формата данных.

*lpStgMedium*<br/>
Указатель на структуру [STGMEDIUM,](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1) в которой находятся данные.

*bRelease*<br/>
TRUE, если элемент управления должен освободить среду хранения; FALSE, если элемент управления не должен освобождать среду хранения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Если данные находится в постоянном формате набора свойств, реализация по умолчанию соответствующим образом изменяет состояние элемента управления. В противном случае реализация по умолчанию ничего не делает. Если *bRelease* является правдой, `ReleaseStgMedium` то призыв к нее; в противном случае нет.

Переопределить эту функцию, чтобы заменить данные управления указанными данными.

Для получения дополнительной `FORMATETC` информации, см. `STGMEDIUM`

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>ColeControl::Onsetextent

Вызывается по структуре, когда размер элемента управления должен быть изменен, в результате вызова на [IOleObject::SetExtent](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Параметры

*lpSizeL*<br/>
Указатель на `SIZEL` структуру, которая использует длинные целые числа для представления ширины и высоты управления, выраженные в единицах HIMETRIC.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если изменение размера было принято; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию обрабатывает размер размера элемента управления. Если элемент управления активен, то `OnPosRectChanged` делается вызов в контейнер.

Переизбь эту функцию, чтобы изменить изменение размера элемента управления по умолчанию.

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>ColeControl::OnSetObjectRects

Вызывается в рамках для реализации вызова [IOleInPlaceObject::SetObjectRects](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Параметры

*lpRectPos*<br/>
Указатель на `RECT` структуру, указывающую новое положение элемента управления и размер по отношению к контейнеру.

*lpRectClip*<br/>
Указатель на `RECT` структуру, указывающую на прямоугольную область, к которой элемент управления должен быть обрезан.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если репозиционирование было принято; в противном случае 0.

### <a name="remarks"></a>Remarks

Реализация по умолчанию автоматически обрабатывает репозиционирование и изменяние размера окна управления и возвращает TRUE.

Переизбь эту функцию, чтобы изменить поведение этой функции по умолчанию.

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>ColeControl::OnShowToolBars

Вызывается по системе, когда элемент управления был активирован.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Remarks

Реализация по умолчанию не выполняет никаких действий.

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>ColeControl::OnTextChanged

Вызывается по фреймворку при изменении стоимости свойства акции или свойства текста.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Remarks

Вызовы реализации по `InvalidateControl`умолчанию.

Переопределить эту функцию, если требуется уведомление после изменения этого свойства.

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>ColeControl::OnWindowlessСообщение

Вызывается по системе в ответ `IOleInPlaceObjectWindowless::OnWindowMessage` на запрос контейнера.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Параметры

*Msg*<br/>
Идентификатор сообщений, передаваемый Windows.

*wParam*<br/>
Как прошло мимо Windows. Определяет дополнительную информацию, конкретную для сообщений. Содержание этого параметра зависит от значения параметра *msg.*

*lParam*<br/>
Как прошло мимо Windows. Определяет дополнительную информацию, конкретную для сообщений. Содержание этого параметра зависит от значения параметра *msg.*

*plResult*<br/>
Код результатов Windows. Опознавательный результат обработки сообщений и зависит от отправленного сообщения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Обрабатывает оконные сообщения для управления без окон. `COleControl`'ы `OnWindowlessMessage` должны быть использованы для оконных сообщений, кроме мыши сообщений и сообщений клавиатуры. `COleControl`обеспечивает [SetCapture](#setcapture) и [SetFocus](#setfocus) специально, чтобы получить захват мыши и клавиатуру фокус для без окон OLE объектов.

Поскольку объекты без окон не имеют окна, им нужен механизм, позволяющий контейнеру отправлять им сообщения. Объект OLE без окон получает сообщения из `OnWindowMessage` своего `IOleInPlaceObjectWindowless` контейнера через метод на интерфейсе (расширение [IOleInPlaceObject](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `OnWindowMessage`не принимает `HWND` параметр.

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>ColeControl::PArentToClient

Переводит координаты *pPoint* в клиентские координаты.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Указатель на границы управления OLE внутри контейнера. Не область клиента, но область всего контроля, включая границы и прокрутки баров.

*pPoint*<br/>
Указатель на родительский (контейнерный) участок, который должен быть переведен в координаты клиентской области управления.

*bHitTest*<br/>
Определяет, следует ли проводить тестирование по пункту.

### <a name="return-value"></a>Возвращаемое значение

Если *bHitTest* является FALSE, возвращает HTNOWHERE. Если *bHitTest* является правдой, возвращает место, в котором родительская (контейнерная) точка приземлилась в клиентской области управления OLE и является одним из следующих значений мышиного хит-теста:

- HTBORDER В границе окна, которое не имеет границы размеров.

- HTBOTTOM В нижней горизонтальной границе окна.

- HTBOTTOMLEFTВ В левом нижнем углу оконной границы.

- HTBOTTOMRIGHT В нижнем правом углу оконной границы.

- HTCAPTION В заглавном баре.

- HTCLIENT В клиентской зоне.

- HTERROR На фоне экрана или на разделительной линии между `DefWndProc` окнами (так же, как HTNOWHERE, за исключением того, что функция Windows производит звуковой сигнал системы, чтобы указать на ошибку).

- HTGROWBOX В коробке размера.

- HTHSCROLL В горизонтальной панели прокрутки.

- HTLEFT В левой границе окна.

- HTMAXBUTTON в кнопке «Максимизация».

- HTMENU В области меню.

- HTMINBUTTON В кнопке Сведение к минимуму.

- HTNOWHERE На фоне экрана или на разделительной линии между окнами.

- HTREDUCE В кнопке Сведение к минимуму.

- HTRIGHT В правой границе окна.

- HT-EВ поле размера (то же самое, что HTGROWBOX).

- HTSYSMENU В меню управления или в кнопке «Закрыть» в окне ребенка.

- HTTOP В верхней горизонтальной границе окна.

- HTTOPLEFT В верхнем левом углу оконной границы.

- HTTOPRIGHT В верхнем правом углу оконной границы.

- HTTRANSPARENT В окне, в настоящее время покрытое другим окном.

- HTVSCROLL В вертикальном баре прокрутки.

- HT'OOM В кнопке Максим.

### <a name="remarks"></a>Remarks

На входного *pPoint* относительно происхождения родителя (верхний левый угол контейнера). На выходе *pPoint* относительно происхождения клиентской области управления OLE (верхний левый угол клиентской области управления).

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>ColeControl::PostModalDialog

Уведомляет контейнер о закрытии модального диалогового окна.

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*hWndParent*<br/>
Обработка к родительскому окну модального диалогового окна.

### <a name="remarks"></a>Remarks

Вызовите эту функцию после отображения любого модального диалогового окна. Вы должны вызвать эту функцию, чтобы контейнер мог `PreModalDialog`включить любые окна верхнего уровня отключены. Эта функция должна быть в `PreModalDialog`паре с вызовом.

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>ColeControl::PreModalDialog

Уведомляет контейнер о том, что в настоящее время будет отображена модальная диалоговая будка.

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*hWndParent*<br/>
Обработка к родительскому окну модального диалогового окна.

### <a name="remarks"></a>Remarks

Вызовите эту функцию перед отображением любого модального диалогового окна. Вы должны вызвать эту функцию, чтобы контейнер мог отключить все окна верхнего уровня. После отображения модального диалогового окна `PostModalDialog`необходимо позвонить в.

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>ColeControl::ВоссоздайтеControlWindow

Разрушает и воссоздает окно управления.

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>Remarks

Это может быть необходимо, если вам нужно изменить тип окна битов.

## <a name="colecontrolrefresh"></a><a name="refresh"></a>ColeControl::Refresh

Заставляет перекрасить управление OLE.

```cpp
void Refresh();
```

### <a name="remarks"></a>Remarks

Эта функция поддерживается `COleControl` базовым классом в качестве метода акций, называемого Refresh. Это позволяет пользователям вашего управления OLE перекрасить элемент управления в определенное время. Для получения дополнительной информации об [ActiveX Controls: Methods](../../mfc/mfc-activex-controls-methods.md)этом методе, см.

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>ColeControl::ReleaseCapture

Выпускает захват мыши.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Если элемент управления в настоящее время имеет захват мыши, захват освобождается. В противном случае эта функция не имеет никакого эффекта.

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>ColeControl::ReleaseDC

Выпускает контекст устройства отображения контейнера без окон управления, освобождая контекст устройства для использования другими приложениями.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Определяет контекст контейнерного устройства, который будет выпущен.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Приложение должно `ReleaseDC` вызывать каждый звонок в [GetDC.](#getdc)

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>ColeControl::ReparentControlWindow

Устанавливает родительский элемент управления.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Параметры

*hWndOuter*<br/>
Ручка окна управления.

*hWndParent*<br/>
Ручка нового родительского окна.

### <a name="remarks"></a>Remarks

Вызовите эту функцию, чтобы сбросить родительский элемент окна управления.

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>ColeControl::ResetStockProps

Инициализирует `COleControl` состояние свойств акций к их значениям по умолчанию.

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>Remarks

Свойства: Внешний вид, BackColor, BorderStyle, Подпись, Включено, Шрифт, ForeColor, hWnd, и текст. Для описания свойств запасов [см.](../../mfc/mfc-activex-controls-adding-stock-properties.md)

Вы можете улучшить двоичную производительность `ResetStockProps` инициализации управления с помощью и `ResetVersion` переопределить. `COleControl::OnResetState` См. пример ниже. Для получения дополнительной информации об оптимизации инициализации [см.](../../mfc/mfc-activex-controls-optimization.md)

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>ColeControl::Перезагрузка

Инициализирует номер версии до указанного значения.

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Параметры

*dwVersionDefault*<br/>
Номер версии, который будет присвоен элементу управления.

### <a name="remarks"></a>Remarks

Вы можете улучшить двоичную производительность `ResetVersion` инициализации управления с помощью и `ResetStockProps` переопределить. `COleControl::OnResetState` Смотрите пример на [ResetStockProps](#resetstockprops). Для получения дополнительной информации об оптимизации инициализации [см.](../../mfc/mfc-activex-controls-optimization.md)

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>ColeControl::ScrollWindow

Позволяет объекту OLE без окон прокручивать область в своем активном изображении на экране.

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*xAmount*<br/>
Определяет количество, в единицах устройства, горизонтальной прокрутки. Этот параметр должен быть отрицательным значением для прокрутки влево.

*yAmount*<br/>
Определяет количество вертикальной прокрутки в единицах устройства. Этот параметр должен быть отрицательным значением для прокрутки вверх.

*lpRect*<br/>
Указывает на объект [CRect](../../atl-mfc-shared/reference/crect-class.md) или структуру RECT, которая определяет часть клиентской области объекта OLE для прокрутки в координатах клиента содержащего окна. Если *lpRect* является NULL, вся клиентская область объекта OLE прокручивается.

*lpClipRect*<br/>
Указывает на `CRect` объект `RECT` или структуру, которая определяет прямоугольник для клипа. Прокручиваются только пиксели внутри прямоугольника. Биты за пределами прямоугольника не затрагиваются, даже если они находятся в прямоугольнике *lpRect.* Если *lpClipRect* является NULL, отсечение не выполняется на прямоугольнике прокрутки.

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>ColeControl::SelectFontObject

Выберите шрифт в контексте устройства.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на объект контекста устройства.

*FontHolder*<br/>
Ссылка на выбранный шрифт [CFontHolder.](../../mfc/reference/cfontholder-class.md)

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранный шрифт. Когда абонент закончил все операции рисования, которые используют *fontHolder,* он должен перевыбрать ранее выбранный шрифт, передав его в качестве параметра [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>ColeControl::SelectStockFont

Выберите свойство шрифта в контексте устройства.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в который будет выбран шрифт.

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранный `CFont` объект. Вы должны использовать [CDC::SelectObject,](../../mfc/reference/cdc-class.md#selectobject) чтобы выбрать этот шрифт обратно в контекст устройства, когда вы закончите.

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>ColeControl::SerializeExtent

Сериализирует или инициализирует состояние пространства дисплея, отведенного для управления.

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` для сериализации в или из.

### <a name="remarks"></a>Remarks

Вы можете улучшить двоичную производительность `SerializeExtent`управления, используя, `SerializeStockProps`и `SerializeVersion` переопределить. `COleControl::Serialize` См. пример ниже. Для получения дополнительной информации об оптимизации инициализации [см.](../../mfc/mfc-activex-controls-optimization.md)

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>ColeControl::SerializeStockProps

Сериализирует или инициализирует `COleControl` состояние свойств запасов: Внешний вид, BackColor, BorderStyle, Caption, Enabled, Font, ForeColor и Text.

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` для сериализации в или из.

### <a name="remarks"></a>Remarks

Для описания свойств запасов [см.](../../mfc/mfc-activex-controls-adding-stock-properties.md)

Вы можете улучшить двоичную производительность `SerializeStockProps`управления, используя, `SerializeExtent`и `SerializeVersion` переопределить. `COleControl::Serialize` Например, просмотрите код на [SerializeExtent](#serializeextent). Для получения дополнительной информации об оптимизации инициализации [см.](../../mfc/mfc-activex-controls-optimization.md)

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>ColeControl::SerializeVersion

Сериализирует или инициализирует состояние информации о версии управления.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` для сериализации в или из.

*dwVersionDefault*<br/>
Текущий номер версии управления.

*bПреобразование*<br/>
Указывается, следует ли конвертировать постоянные данные в последний формат при сохранении или поддерживаться в том же формате, что и при загрузке.

### <a name="return-value"></a>Возвращаемое значение

Номер версии управления. Если указанный архив `SerializeVersion` загружается, возвращается версия, загруженная из этого архива. В противном случае он возвращает загруженную версию.

### <a name="remarks"></a>Remarks

Вы можете улучшить двоичную производительность `SerializeVersion`управления, используя, `SerializeExtent`и `SerializeStockProps` переопределить. `COleControl::Serialize` Например, просмотрите код на [SerializeExtent](#serializeextent). Для получения дополнительной информации об оптимизации инициализации [см.](../../mfc/mfc-activex-controls-optimization.md)

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>ColeControl::SetAppearance

Устанавливает стоимость свойства объекта по внешнему виду вашего элемента управления.

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Параметры

*sAppearance*<br/>
**Краткое** (VT_I2) значение, используемое для появления элемента управления. Значение нуля устанавливает внешний вид элемента управления на плоское, а значение 1 устанавливает внешний вид элемента к 3D.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации о свойствах запасов, [см.](../../mfc/mfc-activex-controls-properties.md)

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>ColeControl::SetBackColor

Устанавливает стоимость свойства BackColor вашего элемента управления.

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Параметры

*dwBackColor*<br/>
Значение OLE_COLOR, используемое для фонового чертежа элемента управления.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации об использовании этого [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md)свойства и других связанных с ним свойств, см.

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>ColeControl::SetBorderStyle

Устанавливает стоимость свойства вашего контроля.

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Параметры

*sBorderStyle*<br/>
Новый пограничный стиль для контроля; 0 указывает на отсутствие границы и 1 указывает на нормальную границу.

### <a name="remarks"></a>Remarks

Затем окно управления будет воссоздано `OnBorderStyleChanged` и вызвано.

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>ColeControl::SetCapture

Вызывает захват контейнера от имени элемента управления.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, который ранее получал ввод мыши.

### <a name="remarks"></a>Remarks

Если элемент управления активирован и не имеет окон, эта функция приводит к тому, что окно контейнера управления завладело захватом мыши от имени элемента управления. В противном случае, эта функция вызывает сам элемент `CWnd::SetCapture`управления, чтобы овладеть захвата мыши (то же, что и ).

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>ColeControl::SetControlSize

Устанавливает размер окна управления OLE и уведомляет контейнер о том, что изменяется сайт управления.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Параметры

*Cx*<br/>
Определяет новую ширину элемента управления в пикселях.

*Cy*<br/>
Определяет новую высоту управления в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Эта функция не должна использоваться в конструкторе элемента управления.

Обратите внимание, что все координаты для окон управления относительно верхнего левого угла элемента управления.

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>ColeControl::SetEnabled

Устанавливает стоимость свойства включенного в стоимость вашего элемента управления.

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Параметры

*bВСтои*<br/>
TRUE, если элемент управления должен быть включен; в противном случае FALSE.

### <a name="remarks"></a>Remarks

После установки `OnEnabledChange` этого свойства вызывается.

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>ColeControl::SetFocus

Вызывает, что окно контейнера управления завладеет входинным фокусом от имени элемента управления.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, который ранее имел фокус ввода, или NULL, если нет такого окна.

### <a name="remarks"></a>Remarks

Если элемент управления активирован и не имеет окон, эта функция приводит к тому, что окно контейнера управления завладело входиной фокусом от имени элемента управления. Вхотозный фокус направляет вход клавиатуры в окно контейнера, и контейнер отправляет все `SetFocus`последующие сообщения клавиатуры на объект OLE, который вызывает. Любое окно, которое ранее имело входной фокус, теряет его.

Если элемент управления не является бесхотворным, эта функция заставляет сам `CWnd::SetFocus`элемент управления завладеть входной фокус (так же, как).

## <a name="colecontrolsetfont"></a><a name="setfont"></a>ColeControl::SetFont

Устанавливает свойство шрифта вашего элемента.

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Параметры

*pFontDisp*<br/>
Указатель на интерфейс диспетчерской отправки шрифта.

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>ColeControl::SetForeColor

Устанавливает стоимость свойства ForeColor foreColor вашего элемента управления.

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Параметры

*dwForeColor*<br/>
Значение OLE_COLOR, используемое для рисования элемента управления на переднем плане.

### <a name="remarks"></a>Remarks

Для получения дополнительной информации об использовании этого [ActiveX Controls: Properties](../../mfc/mfc-activex-controls-properties.md)свойства и других связанных с ним свойств, см.

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>ColeControl::SetInitialDataФорматы

Вызывается рамочой для инициализации списка форматов данных, поддерживаемых контролем.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Remarks

Реализация по умолчанию определяет два формата: CF_METAFILEPICT и постоянный набор свойств.

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>ColeControl::SetInitialSize

Устанавливает размер элемента управления OLE при первом отображении в контейнере.

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Параметры

*Cx*<br/>
Начальная ширина управления OLE в пикселях.

*Cy*<br/>
Начальная высота управления OLE в пикселях.

### <a name="remarks"></a>Remarks

Вызов ими функции в конструкторе, чтобы установить первоначальный размер элемента управления. Первоначальный размер измеряется в единицах устройства, или пикселей. Этот вызов рекомендуется сделать в конструкторе элемента управления.

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>ColeControl::SetModifiedFlag

Изменяет измененное состояние элемента управления.

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Параметры

*bИзменено*<br/>
Новое значение для измененного флага элемента управления. TRUE указывает на то, что состояние элемента управления было изменено; FALSE указывает на то, что состояние элемента управления только что было сохранено.

### <a name="remarks"></a>Remarks

Вызов ими функции при возникновении изменений, которые могут повлиять на постоянное состояние элемента управления. Например, если значение постоянного свойства изменяется, позвоните в эту функцию с *bModified* **TRUE**.

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>ColeControl::SetNotPermitted

Указано, что запрос на правку не удался.

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>Remarks

Вызов ими `BoundPropertyRequestEdit` функции при сбоях. Эта функция бросает исключение `COleDispScodeException` типа, чтобы указать, что установка операции не была разрешена.

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>ColeControl::SetNotSupported

Предотвращает изменение пользовательской стоимости свойства элемента управления.

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>Remarks

Вызовите эту функцию вместо функции Set любого свойства, где изменение значения свойства пользователем элемента управления не поддерживается. Одним из примеров может быть только свойство, которое читается.

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>ColeControl::SetRectInContainer

Устанавливает координаты прямоугольника элемента управления относительно контейнера, выраженного в блоках устройства.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на прямоугольник, содержащий новые координаты элемента управления относительно контейнера.

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Remarks

Если элемент управления открыт, он имеет реаний; в противном `OnPosRectChanged` случае функция контейнера называется.

## <a name="colecontrolsettext"></a><a name="settext"></a>ColeControl::SetText

Устанавливает стоимость свойства подписи под ценой или текстом свойства элемента управления.

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Параметры

*pszText*<br/>
Указатель на строку персонажа.

### <a name="remarks"></a>Remarks

Обратите внимание, что свойства субтитры и текста отображаются по одинаковому значению. Это означает, что любые изменения, внесенные в любое свойство, автоматически изменят оба свойства. Как правило, контроль должен поддерживать либо подпись к акции, либо свойство текста, но не оба.

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>ColeControl::ThrowError

Сигналы о возникновении ошибки в элементе управления.

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*Sc*<br/>
Значение кода состояния, о чем следует сообщать. Полный список возможных кодов можно узнать в статье [ActiveX Controls: Advanced Topics](../../mfc/mfc-activex-controls-advanced-topics.md).

*nОписание*<br/>
Идентификатор строки ресурса исключения, о которых следует сообщать.

*nHelpID*<br/>
Идентификатор справки по теме, о которой будет сообщено.

*pszОписание*<br/>
Строка, содержащая объяснение исключения, о котором следует сообщать.

### <a name="remarks"></a>Remarks

Эта функция должна вызываться только из функции Get или Set для свойства OLE или реализации метода автоматизации OLE. Если вам нужно сигнализировать об ошибках, которые происходят в другое время, следует запустить событие ошибки в запасе.

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>ColeControl::TransformCoors

Преобразует значения между единицами HIMETRIC и нативными единицами контейнера.

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Параметры

*lpptlHimetric*<br/>
Указатель на `POINTL` структуру, содержащую координаты в единицах HIMETRIC.

*lpptfContainer*<br/>
Указатель на `POINTF` структуру, содержащую координаты в размере единицы контейнера.

*flags*<br/>
Сочетание следующих значений:

- XFORMCOORDS_POSITION положение в контейнере.

- XFORMCOORDS_SIZE Размер в контейнере.

- XFORMCOORDS_HIMETRICTOCONTAINER Преобразуйте единицы HIMETRIC в блоки контейнера.

- XFORMCOORDS_CONTAINERTOHIMETRIC Преобразуйте блоки контейнера в hiMETRIC.

### <a name="remarks"></a>Remarks

Первые два флага, XFORMCOORDS_POSITION и XFORMCOORDS_SIZE, указывают, следует ли рассматривать координаты как положение или размер. Остальные два флага указывают направление преобразования.

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>ColeControl::TranslateColor

Преобразует значение цвета из OLE_COLOR типа данных в тип данных [COLORREF.](/windows/win32/gdi/colorref)

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Параметры

*clrColor*<br/>
Тип данных OLE_COLOR. Для получения дополнительной информации см. [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)

*hpal*<br/>
Ручка к дополнительной палитре; может быть NULL.

### <a name="return-value"></a>Возвращаемое значение

RGB (красный, зеленый, синий) 32-битное цветовое значение, которое определяет твердый цвет, наиболее близкий к значению *clrColor,* которое может представлять устройство.

### <a name="remarks"></a>Remarks

Эта функция полезна для перевода свойств Stock ForeColor и BackColor на типы COLORREF, используемые функциями членов [CDC.](../../mfc/reference/cdc-class.md)

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>ColeControl::WillAmbientsBeValidDuringLoad

Определяет, должен ли элемент управления использовать значения свойств окружающего в качестве значений по умолчанию, когда он впоследствии загружается из его постоянного состояния.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero указывает на то, что свойства окружающей среды будут действительными; в противном случае окружающие свойства не будут действительными.

### <a name="remarks"></a>Remarks

В некоторых контейнерах элемент управления может не иметь доступа к его окружающим свойствам во время первоначального `COleControl::DoPropExchange`вызова к переопределением. Это происходит, если контейнер вызывает [IPersistStreamInit::Load](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load) или [IPersistStorage::Load](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load) до вызова [IOleObject::SetClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite) (то есть, если он не соблюдает OLEMISC_SETCLIENTSITEFIRST бит статуса).

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>ColeControl::WindowProc

Обеспечивает процедуру Windows `COleControl` для объекта.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Параметры

*message*<br/>
Определяет сообщение Windows, подаваемый для обработки.

*wParam*<br/>
Предоставляет дополнительную информацию, используемую при обработке сообщения. Значение параметра зависит от сообщения.

*lParam*<br/>
Предоставляет дополнительную информацию, используемую при обработке сообщения. Значение параметра зависит от сообщения.

### <a name="return-value"></a>Возвращаемое значение

Значение возврата отправленного сообщения.

### <a name="remarks"></a>Remarks

Вызовите эту функцию для отправки определенных сообщений через карту сообщений управления.

## <a name="see-also"></a>См. также раздел

[MFC Образец CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC Образец TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[Класс COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Класс CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Класс CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
