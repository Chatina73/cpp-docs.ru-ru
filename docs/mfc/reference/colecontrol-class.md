---
title: Colecontrol-класс
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 30d73d546ee68a25f1e59776020477d038da65e8
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2019
ms.locfileid: "58771504"
---
# <a name="colecontrol-class"></a>Colecontrol-класс

Мощный базовый класс для разработки элементов управления OLE.

## <a name="syntax"></a>Синтаксис

```
class COleControl : public CWnd
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Создает объект `COleControl`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Извлекает текущий внешний вид элемента управления.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Возвращает значение свойства BackColor окружения.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Возвращает имя элемента управления, как указано в контейнере.|
|[COleControl::AmbientFont](#ambientfont)|Возвращает значение внешнего свойства шрифта.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Возвращает значение свойства ForeColor окружения.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Возвращает идентификатор контейнера языкового стандарта.|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Возвращает тип единиц, используемые контейнером.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Определяет, отображаются ли маркеры захвата.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Определяет, отображаются ли штриховки.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Возвращает тип выравнивания текста в указанный контейнер.|
|[COleControl::AmbientUIDead](#ambientuidead)|Определяет, если элемент управления должен реагировать на действия пользовательского интерфейса.|
|[COleControl::AmbientUserMode](#ambientusermode)|Определяет режим контейнера.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Уведомляет контейнер, что привязанное свойство было изменено.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Запрашивает разрешение на изменение значения свойства.|
|[COleControl::ClientToParent](#clienttoparent)|Преобразует точку относительно начала координат элемента управления в точку относительно его контейнера.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Корректирует прямоугольник курсор, если он перекрывается элементом управления.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Эта функция вызывается после изменения набор назначенные клавиши, обрабатываться элементом управления.|
|[COleControl::DisplayError](#displayerror)|Отображает биржевой события ошибок для элемента управления пользователя.|
|[COleControl::DoClick](#doclick)|Реализация акции `DoClick` метод.|
|[COleControl::DoPropExchange](#dopropexchange)|Сериализует свойства `COleControl` объекта.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Перерисовывает элемент управления OLE, являющийся подклассом из элемента управления Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Включает поддержку Простая рамка для элемента управления.|
|[COleControl::ExchangeExtent](#exchangeextent)|Выполняет сериализацию, ширину и высоту элемента управления.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Сериализует стандартных свойств элемента управления.|
|[COleControl::ExchangeVersion](#exchangeversion)|Сериализует номер версии элемента управления.|
|[COleControl::FireClick](#fireclick)|Срабатывает акции `Click` событий.|
|[COleControl::FireDblClick](#firedblclick)|Срабатывает акции `DblClick` событий.|
|[COleControl::FireError](#fireerror)|Срабатывает акции `Error` событий.|
|[COleControl::FireEvent](#fireevent)|Запускает пользовательское событие.|
|[COleControl::FireKeyDown](#firekeydown)|Срабатывает акции `KeyDown` событий.|
|[COleControl::FireKeyPress](#firekeypress)|Срабатывает акции `KeyPress` событий.|
|[COleControl::FireKeyUp](#firekeyup)|Срабатывает акции `KeyUp` событий.|
|[COleControl::FireMouseDown](#firemousedown)|Срабатывает акции `MouseDown` событий.|
|[COleControl::FireMouseMove](#firemousemove)|Срабатывает акции `MouseMove` событий.|
|[COleControl::FireMouseUp](#firemouseup)|Срабатывает акции `MouseUp` событий.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Инициирует событие при изменении состояния готовности элемента управления.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Изменяет поведение активации по умолчанию элемент управления, поддерживающий `IPointerInactive` интерфейс.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Возвращает значение указанного свойства окружения.|
|[COleControl::GetAppearance](#getappearance)|Возвращает значение свойства внешнего вида акций.|
|[COleControl::GetBackColor](#getbackcolor)|Возвращает значение свойства BackColor акций.|
|[COleControl::GetBorderStyle](#getborderstyle)|Возвращает значение свойства BorderStyle акций.|
|[COleControl::GetCapture](#getcapture)|Определяет, имеет ли объект элемента управления без окон, активированные захват мыши.|
|[COleControl::GetClassID](#getclassid)|Извлекает идентификатор класса элемента управления OLE.|
|[COleControl::GetClientOffset](#getclientoffset)|Извлекает разницу между в верхний левый угол прямоугольной области элемента управления и в верхнем левом углу клиентской области.|
|[COleControl::GetClientRect](#getclientrect)|Чтобы получить размер клиентской области элемента управления.|
|[COleControl::GetClientSite](#getclientsite)|Запрашивает объект для указателя на его текущем сайте клиента в пределах контейнера.|
|[COleControl::GetControlFlags](#getcontrolflags)|Получает флаг настройки элемента управления.|
|[COleControl::GetControlSize](#getcontrolsize)|Возвращает положение и размер элемента управления OLE.|
|[COleControl::GetDC](#getdc)|Предоставляет средства для элемента управления без окон для получения контекста устройства из своего контейнера.|
|[COleControl::GetEnabled](#getenabled)|Возвращает значение свойства Enabled акции.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Извлекает указатель на объект расширенного элемента управления, принадлежащие к контейнеру.|
|[COleControl::GetFocus](#getfocus)|Определяет, является ли элемент управления имеет фокус.|
|[COleControl::GetFont](#getfont)|Возвращает значение свойство Font.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Возвращает метрики `CFontHolder` объекта.|
|[COleControl::GetForeColor](#getforecolor)|Возвращает значение свойства ForeColor акций.|
|[COleControl::GetHwnd](#gethwnd)|Возвращает значение свойства акций hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Предоставляет текст строки состояния для пункта меню.|
|[COleControl::GetNotSupported](#getnotsupported)|Запрещает доступ к значению свойства элемента управления пользователем.|
|[COleControl::GetReadyState](#getreadystate)|Возвращает состояние готовности элемента управления.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Возвращает прямоугольник элемента управления относительно его контейнера.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Возвращает показатели свойство Font.|
|[COleControl::GetText](#gettext)|Возвращает значение свойства Text или Caption акций.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Переопределите, чтобы разрешить безоконный элемент управления быть целевым объектом перетаскивания и операции перетаскивания.|
|[COleControl::InitializeIIDs](#initializeiids)|Информирует базового класса со значениями IID, элемент управления будет использовать.|
|[COleControl::InternalGetFont](#internalgetfont)|Возвращает `CFontHolder` объект для свойство Font.|
|[COleControl::InternalGetText](#internalgettext)|Получает стандартное свойство заголовок или текст.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Задает состояние готовности элемента управления и запускает событие изменения для состояния готовности.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Делает недействительной область отображается элемент управления, вызывает его перерисовку.|
|[COleControl::InvalidateRgn](#invalidatergn)|Делает недействительной клиентскую область окна контейнера в пределах заданной области. Можно использовать для повторной отрисовки поверхности элементы управления без окон в регионе.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Разрешает загрузку специализированного элемента управления OLE.|
|[COleControl::IsModified](#ismodified)|Определяет, изменилась ли состояние элемента управления.|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|Указывает, поддерживает ли контейнер оптимизированное Рисование для текущей операции рисования.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Вызывается для определения, если элемент управления подклассом Windows контролировать.|
|[COleControl::Load](#load)|Сбрасывает все предыдущие данные асинхронные и инициализирует новую загрузку асинхронного свойства элемента управления.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Определяет, если элемент управления могут быть деактивированы путем контейнера.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Вызывается, когда изменяется внешнее свойство.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Вызывается при изменении стандартных свойств внешнего вида.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Вызывается при изменении стандартное свойство BackColor.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Вызывается при изменении свойства BorderStyle акций.|
|[COleControl::OnClick](#onclick)|Вызывается срабатывание акции щелкните событие.|
|[COleControl::OnClose](#onclose)|Уведомляет элемент управления, который `IOleControl::Close` был вызван.|
|[COleControl::OnDoVerb](#ondoverb)|Вызывается после выполнения команды управления.|
|[COleControl::OnDraw](#ondraw)|Вызывается при запросе элемента управления получает команду перерисовать себя.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Вызывается контейнером при запросе элемента управления получает команду перерисовать себя с помощью контекста устройства метафайла.|
|[COleControl::OnEdit](#onedit)|Вызывается контейнером для активации пользовательского интерфейса элемента управления OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Вызывается при изменении свойства Enabled акции.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Вызывается контейнером для перечисления команд элементов управления.|
|[COleControl::OnEventAdvise](#oneventadvise)|Вызывается, когда обработчики событий или вынимается из элемента управления.|
|[COleControl::OnFontChanged](#onfontchanged)|Вызывается, когда изменяется свойство Font.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Вызывается при изменении стандартное свойство цвет переднего плана.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Вызывается, когда события элемента управления зафиксирован или разморозить.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Уведомляет элемент управления, который `IOleObject::GetColorSet` был вызван.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Назначенный сведения в контейнер.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Вызывается для получения строку для отображения значения свойства.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Запрашивает дескриптор меню элемента управления, будут объединены с меню контейнера.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Переопределите, чтобы получить отображаемый размер элемента управления, ближайший к предложенное режим размера и степени.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Возвращает строк, представляющих возможные значения для свойства.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Возвращает значение, соответствующее заранее определенной строки.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Переопределите, чтобы получить размер областей отображения элемента управления (может использоваться для включения двухэтапный Рисование).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Переопределите, чтобы преобразовать размер элемента управления в прямоугольник, начиная с определенной позиции.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Переопределение для получения сведений о состоянии представления элемента управления.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Вызывается контейнером при деактивации пользовательского интерфейса элемента управления.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Переопределение для контейнера для неактивного элемента управления в группе сообщений wm_mousemove и диспетчеризации указатель мыши на элемент управления.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Переопределение для контейнера для неактивного элемента управления в группе сообщений WM_SETCURSOR диспетчеризации указатель мыши на элемент управления.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Вызывается после возникло стандартное событие KeyDown.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Вызывается после возникло стандартное событие KeyPress.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Вызывается после возникло стандартное событие KeyUp.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Указывает, какие свойства страницу, используемую для редактирования свойств.|
|[COleControl::OnMnemonic](#onmnemonic)|Вызывается, когда была нажата назначенная клавиша элемента управления.|
|[COleControl::OnProperties](#onproperties)|Вызывается, когда был вызван команду «Свойства» для элемента управления.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Переопределите, чтобы запрос ли заданная точка перекрывается отображение элемента управления.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Переопределите, чтобы запрос ли любой точки в данный прямоугольник пересекается отображение элемента управления.|
|[COleControl::OnRenderData](#onrenderdata)|Вызывается платформой для извлечения данных в указанном формате.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Вызывается платформой для извлечения данных из файла в указанном формате.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Вызывается платформой для извлечения данных из глобальной памяти в указанном формате.|
|[COleControl::OnResetState](#onresetstate)|Сбрасывает значения по умолчанию свойства элемента управления.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Уведомляет элемент управления, который `IOleControl::SetClientSite` был вызван.|
|[COleControl::OnSetData](#onsetdata)|Заменяет другого значения данных элемента управления.|
|[COleControl::OnSetExtent](#onsetextent)|Вызывается после изменения расширения элемента управления.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Вызывается после были изменены размеры элемента управления.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Вызывается, когда элемент был активироваться через UI.|
|[COleControl::OnTextChanged](#ontextchanged)|Вызывается при изменении текста stock или свойство Caption.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Обрабатывает сообщения окна (кроме сообщения клавиатуры и мыши) для элементов управления без окон.|
|[COleControl::ParentToClient](#parenttoclient)|Преобразует точку относительно контейнера в точку относительно элемента управления.|
|[COleControl::PostModalDialog](#postmodaldialog)|Уведомляет контейнер, что модальное диалоговое окно было закрыто.|
|[COleControl::PreModalDialog](#premodaldialog)|Уведомляет контейнер, в котором отображается модальное диалоговое окно.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Удаляет и повторно создает окна элемента управления.|
|[COleControl::Refresh](#refresh)|Принудительно перекрашивает внешнего вида элемента управления.|
|[COleControl::ReleaseCapture](#releasecapture)|Отпускает захват мыши.|
|[COleControl::ReleaseDC](#releasedc)|Освобождает контекст устройства отображения контейнера элемента управления без окон.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Сбрасывает родительского окна элемента управления.|
|[COleControl::ResetStockProps](#resetstockprops)|Инициализирует `COleControl` стандартные свойства к значениям по умолчанию.|
|[COleControl::ResetVersion](#resetversion)|Инициализирует номер версии до заданного значения.|
|[COleControl::ScrollWindow](#scrollwindow)|Позволяет элементу управления без окон прокручивать область в пределах его активного в встроенного изображения на экране.|
|[COleControl::SelectFontObject](#selectfontobject)|Выбор пользовательского свойства шрифта в контексте устройства.|
|[COleControl::SelectStockFont](#selectstockfont)|Выбирает свойство Font в контексте устройства.|
|[COleControl::SerializeExtent](#serializeextent)|Выполняет сериализацию или инициализирует область отображения для элемента управления.|
|[COleControl::SerializeStockProps](#serializestockprops)|Выполняет сериализацию или инициализирует `COleControl` стандартные свойства.|
|[COleControl::SerializeVersion](#serializeversion)|Выполняет сериализацию или инициализирует сведения о версии элемента управления.|
|[COleControl::SetAppearance](#setappearance)|Задает значение свойства внешнего вида акций.|
|[COleControl::SetBackColor](#setbackcolor)|Задает значение свойства BackColor акций.|
|[COleControl::SetBorderStyle](#setborderstyle)|Задает значение свойства BorderStyle акций.|
|[COleControl::SetCapture](#setcapture)|Вызывает окна контейнера элемента управления необходимо выполнить владение и захват мыши на имени элемента управления.|
|[COleControl::SetControlSize](#setcontrolsize)|Задает положение и размер элемента управления OLE.|
|[COleControl::SetEnabled](#setenabled)|Задает значение свойства Enabled акции.|
|[COleControl::SetFocus](#setfocus)|Вызывает окна контейнера элемента управления для выполнения владение фокус ввода на основе имени элемента управления.|
|[COleControl::SetFont](#setfont)|Задает значение свойство Font.|
|[COleControl::SetForeColor](#setforecolor)|Задает значение свойства ForeColor акций.|
|[COleControl::SetInitialSize](#setinitialsize)|Задает размер элемента управления OLE при первом отображении в контейнере.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Изменяет измененное состояние элемента управления.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Указывает, что запрос на редактирование произошел сбой.|
|[COleControl::SetNotSupported](#setnotsupported)|Предотвращает изменение значения свойства элемента управления пользователем.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Задает прямоугольника элемента управления относительно его контейнера.|
|[COleControl::SetText](#settext)|Задает значение свойства Text или Caption акций.|
|[COleControl::ThrowError](#throwerror)|Указывает, произошла ошибка в элементе управления OLE.|
|[COleControl::TransformCoords](#transformcoords)|Преобразования координат значения между контейнером и элемент управления.|
|[COleControl::TranslateColor](#translatecolor)|Преобразует значение OLE_COLOR значение COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Определяет, ли внешние свойства будут доступны в следующий раз элемент управления будет загружен.|
|[COleControl::WindowProc](#windowproc)|Содержит процедуры Windows `COleControl` объекта.|

### <a name="protected-methods"></a>Защищенные методы

|name|Описание|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Вызывается платформой, когда внешний вид элемента управления должен быть обновлен.|
|[COleControl::DrawMetafile](#drawmetafile)|Вызывается платформой при использовании контексте устройства метафайла.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Включает вызов метода автоматизации.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Вызывается платформой для инициализации список форматов данных, поддерживаемое элементом управления.|

## <a name="remarks"></a>Примечания

Является производным от `CWnd`, этот класс наследует все функции объекта окна Windows, а также дополнительные функциональные возможности, относящиеся к OLE, например событием и возможность поддержки методы и свойства.

Элементы управления OLE могут быть вставлены в OLE-приложения контейнера и обмениваться данными с контейнером с помощью двусторонней системы обработки событий и предоставление методов и свойств, в контейнер. Обратите внимание на то, что стандартный OLE-контейнеры поддерживают только основные функциональные возможности элемента управления OLE. Они не поддерживающие расширенные функциональные возможности элемента управления OLE. События Click происходит, когда события отправляются в контейнер, в результате некоторые действия, происходящие в элементе управления. В свою очередь контейнер взаимодействует с элементом управления, используя предоставленный набор методов и свойств, аналогично функции-члены и данные-члены класса C++. Такой подход позволяет разработчику управлять внешним видом элемента управления и уведомить контейнера при выполнении определенных действий.

## <a name="windowless-controls"></a>Элементы управления без окон

Элементы управления OLE может быть используется встроенная активация без окна. Элементы управления без окон имеют значительные преимущества.

- Элементы управления без окон может быть прозрачным и непрямоугольных

- Элементы управления без окон сократить время размера и создания экземпляра объекта

Элементы управления не обязательно окна. Службы, которые предлагает окна легко могут быть предоставлены через одного общего окна (обычно контейнера) и небольшой фрагмент кода диспетчеризации. Наличие окна является главным образом это ненужное усложнение в объекте.

При использовании активации без окна контейнера (который имеет окна) отвечает за предоставление служб, которые бы в противном случае были предоставлены с помощью элемента управления собственного окна. Например если элемент управления должен запросить фокус клавиатуры, запрос захват мыши или получения контекста устройства, эти операции управляются контейнером. `COleControl` Функций-членов без окон операции вызова этих операций в контейнере.

При включении активации без окна делегаты контейнер ввода сообщений элемента управления `IOleInPlaceObjectWindowless` интерфейс (расширение [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `COleControl`в реализации этого интерфейса передает эти сообщения через схему сообщений элемента управления, после настройки мыши координирует соответствующим образом. Эти сообщения, как и обычные окна сообщения, можно обработать, добавив соответствующие записи в схеме сообщений.

В элементе управления без окон, следует всегда использовать `COleControl` функций-членов вместо соответствующего `CWnd` функции-члены и их связанные функции Windows API.

Объекты OLE-элемент управления можно также создать окно, только в том случае, когда они становятся активными, но возрастает объем работы, необходимой для перехода неактивные — активный и скорость перехода выходит из строя. Бывают случаи, когда это проблема: например, рассмотрим таблицу текстовых полей. Когда курсора вверх и вниз в столбце, каждый элемент управления должен быть на месте активируются и деактивируются затем. Скорость перехода неактивные/активный непосредственно влияют на скорость прокрутки.

Дополнительные сведения о разработке платформу управления OLE, см. в статьях [элементы ActiveX в MFC](../../mfc/mfc-activex-controls.md) и [Обзор: Создание программы элемента управления ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Сведения об оптимизации элементов управления OLE, включая элементы управления без окон и без мелькания, см. в разделе [элементы управления MFC ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Требования

**Заголовок:** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Возвращает значение свойства BackColor окружения.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение контейнера BackColor свойства окружения, если таковые имеются. Если свойство не поддерживается, эта функция возвращает определенный системой цвет фона Windows.

### <a name="remarks"></a>Примечания

Внешнее свойство BackColor доступны для всех элементов управления и определяется в контейнере. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Имя контейнера назначенный элементу управления можно использовать в сообщениях об ошибках, отображаемых для пользователя.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Возвращаемое значение

Имя элемента управления OLE. Значение по умолчанию является строкой нулевой длины.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Возвращает значение внешнего свойства шрифта.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс диспетчеризации шрифт окружения контейнера. Значение по умолчанию имеет значение NULL. Если возвращаемое не равно NULL, вы несете ответственность за освобождение шрифта, вызвав его [IUnknown::Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) функция-член.

### <a name="remarks"></a>Примечания

Внешнее свойство Font, определенные в качестве контейнера и доступные для всех элементов управления. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Возвращает значение свойства ForeColor окружения.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение контейнера ForeColor свойства окружения, если таковые имеются. Если не поддерживается, эта функция возвращает определенный системой цвет текста Windows.

### <a name="remarks"></a>Примечания

Внешнее свойство ForeColor доступны для всех элементов управления и определяется в контейнере. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Возвращает идентификатор контейнера языкового стандарта.

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Возвращаемое значение

Значение свойства LocaleID контейнера, если таковые имеются. Если это свойство не поддерживается, эта функция возвращает 0.

### <a name="remarks"></a>Примечания

Элемент управления можно использовать код языка для адаптации его пользовательский интерфейс для конкретного местоположения. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Извлекает текущую настройку внешнего вида объекта управления.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Возвращаемое значение

Внешний вид элемента управления:

- **0** неструктурированный внешний вид

- **1** объемного внешнего вида

### <a name="remarks"></a>Примечания

Вызывайте эту функцию для получения текущего значения свойства DISPID_AMBIENT_APPEARANCE для элемента управления.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Возвращает тип единиц, используемые контейнером.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Возвращаемое значение

Строка, содержащая окружения ScaleUnits контейнера. Если это свойство не поддерживается, эта функция возвращает строку нулевой длины.

### <a name="remarks"></a>Примечания

Внешнее свойство ScaleUnits контейнера можно использовать для отображения позиций или измерения, с меткой для выбранного подразделения, например твипов или сантиметрах. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Определяет, разрешает ли контейнер элемента управления для отображения маркеров захвата для себя в активном состоянии.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если должна отображаться маркеры захвата; в противном случае 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Определяет, разрешает ли контейнер элемента управления для отображения окна с заштрихованного шаблон, если активный пользовательского интерфейса.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если заштрихованный шаблон должен отображаться; в противном случае 0. Если это свойство не поддерживается, эта функция возвращает ненулевое значение.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Определяет выравнивание текста окружения предпочитаются контейнера элемента управления.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние свойства TextAlign окружения контейнера. Если это свойство не поддерживается, эта функция возвращает 0.

Ниже приведен список допустимых возвращаемых значений:

|Возвращаемое значение|Значение|
|------------------|-------------|
|0|Общего выравнивания (номера для текста, справа, слева).|
|1|Выровнять по левому краю|
|2|Центр|
|3|Выравнивание по правому краю|

### <a name="remarks"></a>Примечания

Это свойство будет доступно все внедренные элементы управления и определяется в контейнере. Обратите внимание на то, что контейнер не требуется для поддержки этого свойства.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Определяет, если контейнер необходимо реагировать на действия пользовательского интерфейса элемента управления.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления должен отвечать на действия пользовательского интерфейса. в противном случае 0. Если это свойство не поддерживается, эта функция возвращает 0.

### <a name="remarks"></a>Примечания

Например, контейнер может задать это значение TRUE в режиме конструктора.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Определяет, если контейнер находится в режиме конструктора или в пользовательском режиме.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если контейнер находится в режиме пользователя; в противном случае — 0 (в режиме конструктора). Если это свойство не поддерживается, эта функция возвращает значение TRUE.

### <a name="remarks"></a>Примечания

Например, контейнер может задать это значение FALSE в режиме конструктора.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Указывает, изменилось значение свойства привязки.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства привязанного элемента управления.

### <a name="remarks"></a>Примечания

Оно должно вызываться каждый раз при изменении свойства, даже в случаях, где не было сделано изменение через свойство значение метода. Учтите, особенно связанных свойств, которые сопоставляются переменные-члены. Такой член изменения переменных, в любое время `BoundPropertyChanged` должен вызываться.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Запрашивает разрешение из `IPropertyNotifySink` интерфейс для изменения значения свойства привязки, предоставляемые элементом управления.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства привязанного элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если разрешено изменение; в противном случае 0. Значение по умолчанию не равно нулю.

### <a name="remarks"></a>Примечания

Если разрешения, элемент управления не следует допускать значение изменение свойства. Это можно сделать, игнорируя или переводя другой действие, которое предпринята попытка изменить значение свойства.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Преобразует координаты *pPoint* в родительских координатах.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Указатель на границы элемента управления OLE в контейнере. Область весь элемент управления, включая границы и полосы прокрутки, но не клиентской области.

*pPoint*<br/>
Указатель на точку области клиента OLE быть преобразована в координатах родительского элемента (контейнер).

### <a name="remarks"></a>Примечания

На входе *pPoint* относительно начала координат клиентской области элемента управления OLE (верхний левый угол клиентской области элемента управления). На выходе *pPoint* относительно начала координат родительского элемента (верхний левый угол контейнера).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Корректирует прямоугольник курсор, если он полностью или частично покрывается перекрывающиеся его непрозрачными объектами.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
На входе, указатель на [RECT](/windows/desktop/api/windef/ns-windef-tagrect) структуру, содержащую курсор области скорректирована. На выводе области скорректированное курсор или значение NULL, если прямоугольник курсор полностью входят.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Крышка является мигания линии, блока или точечного рисунка, который обычно указывает, где будет вставлен текст или графику.

Объект без окон невозможно безопасно отобразить курсор без предварительной проверки ли курсор будет частично или полностью скрыт перекрывающихся объектов. Для этого можно использовать объект `ClipCaretRect` для получения курсора корректируется (reduced) для обеспечения того, она помещается в области отсечения.

Объектами создается курсор должен отправлять прямоугольника, курсор `ClipCaretRect` и использовать прямоугольник, настроенную для курсора. Если курсор является полностью скрытым, этот метод вернет FALSE, и курсор не должно отображаться вообще в этом случае.

##  <a name="colecontrol"></a>  COleControl::COleControl

Создает объект `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Примечания

Эта функция обычно не вызывается напрямую. Вместо этого элемент управления OLE обычно создается путем своей фабрики класса.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Эта функция вызывается при изменении набора назначенные клавиши, поддерживаемое элементом управления.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Примечания

При получении этого уведомления, контейнер элемента управления получает новый набор назначенных клавиш с помощью вызова [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Обратите внимание, что контейнер не является обязательным реагировать на это уведомление.

##  <a name="displayerror"></a>  COleControl::DisplayError

Вызвано структурой после обработки стандартное событие ошибки (если обработчик событий заблокировал отображение ошибки).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Параметры

*SCODE*<br/>
Значение кода состояния, который требуется получить сведения об. Полный список возможных кодов, см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Описание сообщение об ошибке.

*lpszSource*<br/>
Имя модуля, формирующая ошибку (как правило, имя модуля управления OLE).

*lpszHelpFile*<br/>
Имя файла справки, содержащий описание ошибки.

*nHelpID*<br/>
Идентификатор контекста справки ошибки возвращается.

### <a name="remarks"></a>Примечания

Поведение по умолчанию отображает окно сообщения, содержащее описание ошибки, содержащихся в *lpszDescription*.

Переопределите эту функцию, чтобы настроить способ отображения ошибок.

##  <a name="doclick"></a>  COleControl::DoClick

Имитирует мыши выберите действие на элементе управления.

```
void DoClick();
```

### <a name="remarks"></a>Примечания

Переопределяемый `COleControl::OnClick` функция-член будет вызываться и акции щелкните событие активируется, если поддерживается элементом управления.

Эта функция поддерживается `COleControl` базовый класс как биржевые метод, называемый DoClick. Дополнительные сведения см. в статье [элементы управления ActiveX: Методы](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Вызывается средой, когда загружается или сохраняется элемент управления из представления постоянное хранилище, например поток или свойство набора.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*pPX*<br/>
Указатель на объект `CPropExchange` . Платформа предоставляет этот объект для формирования контекста обмена свойства, включая его направление.

### <a name="remarks"></a>Примечания

Эта функция обычно выполняет вызовы **PX_** семейству функций, чтобы загрузить или сохранить определенные пользовательские свойства элемента управления OLE.

Если мастер элементов управления используется для создания проекта элемента управления OLE, переопределенная версия этой функции будет сериализовать стандартных свойств, поддерживаемых `COleControl` с помощью вызова функции базового класса, `COleControl::DoPropExchange`. При добавлении пользовательских свойств в элемент управления OLE, вам потребуется изменить эту функцию для сериализации нового свойства. Дополнительные сведения о сериализации см. в статье [элементы управления ActiveX: Сериализация](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Перерисовывает элемент управления OLE, являющийся подклассом из элемента управления Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства контейнера элемента управления.

*rcBounds*<br/>
Область, в котором элемент управления будет отображаться.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию для правильной обработки заливку неактивную управления OLE. Эту функцию следует использовать, только если OLE управления подклассов элемента управления Windows и должен быть вызван в `OnDraw` функции элемента управления.

Дополнительные сведения о функции и создание подкласса элемента управления Windows, см. в статье [элементы управления ActiveX: Создание подкласса элемента управления Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Вызывается платформой, когда внешний вид элемента управления должен быть обновлен.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства.

*Версия-кандидат*<br/>
Прямоугольная область, для отрисовки на.

### <a name="remarks"></a>Примечания

Эта функция напрямую вызывает переопределяемый `OnDraw` функции.

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Вызывается платформой при использовании контексте устройства метафайла.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на контекст устройства метафайла.

*Версия-кандидат*<br/>
Прямоугольная область, для отрисовки на.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Позволяет характеристика Простая рамка для элемента управления OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Примечания

Эта особенность позволяет элементу управления для поддержки visual включения других элементов управления, но не значение true, вложения OLE. Примером может служить поле группы с несколькими элементами управления внутри. Эти элементы управления не содержится OLE, но они находятся в одном поле группы.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Выполняет сериализацию или инициализирует состояние объекта расширение элемента управления (его измерений в единицах HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*pPX*<br/>
Указатель на [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта. Платформа предоставляет этот объект для формирования контекста обмена свойства, включая его направление.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция обычно вызывается реализация по умолчанию `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Выполняет сериализацию или инициализирует состояние объекта стандартных свойств элемента управления.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Параметры

*pPX*<br/>
Указатель на [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта. Платформа предоставляет этот объект для формирования контекста обмена свойства, включая его направление.

### <a name="remarks"></a>Примечания

Эта функция обычно вызывается реализация по умолчанию `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Выполняет сериализацию или инициализирует состояние объекта сведений о версии элемента управления.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*pPX*<br/>
Указатель на объект `CPropExchange` . Платформа предоставляет этот объект для формирования контекста обмена свойства, включая его направление.

*dwVersionDefault*<br/>
Текущий номер версии элемента управления.

*bConvert*<br/>
Указывает, должны ли преобразовываться постоянных данных в формат последней версии при сохранении или сохраняется в том же формате, который был загружен.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если функция выполнена успешно; в противном случае 0.

### <a name="remarks"></a>Примечания

Как правило, это будет Первая функция вызывается переопределение элемента управления `COleControl::DoPropExchange`. При загрузке, эта функция считывает число версий постоянных данных и устанавливает атрибут версии [CPropExchange](../../mfc/reference/cpropexchange-class.md) объекта соответствующим образом. При сохранении, эта функция записывает номер версии постоянных данных.

Дополнительные сведения о сохраняемости и управления версиями, см. в статье [элементы управления ActiveX: Сериализация](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Вызывается платформой при щелчке мышью на активный элемент управления.

```
void FireClick();
```

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматической обработки события нажатия для сопоставления событий элемента управления должен иметь акций щелкните событие, определенное.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Вызывается платформой при двойном щелчке мыши над активный элемент управления.

```
void FireDblClick();
```

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматического запуска происходят события Двойное нажатие кнопки схема событий элемента управления должен иметь акций двойное нажатие кнопки события, определенного.

##  <a name="fireerror"></a>  COleControl::FireError

Запускает стандартное событие ошибки.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*SCODE*<br/>
Значение кода состояния, который требуется получить сведения об. Полный список возможных кодов, см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
Описание сообщение об ошибке.

*nHelpID*<br/>
Идентификатор справки сообщение об ошибке.

### <a name="remarks"></a>Примечания

Это событие позволяет сигналов, в нужных местах в коде, что произошла ошибка в элементе управления. В отличие от других стандартных событий, таких как щелчок или MouseMove ошибка не возникает платформой.

Чтобы сообщить об ошибке, которое возникло во время функция get свойства, функция set свойства или метода автоматизации, вызовите [COleControl::ThrowError](#throwerror).

Реализация Stock ошибка события элемента управления OLE использует значение SCODE. Если элемент управления использует это событие и предназначен для использования в Visual Basic 4.0, будут возникать ошибки, так как значение SCODE не поддерживается в Visual Basic.

Чтобы устранить эту проблему, вручную измените параметр SCODE в элементе управления. ODL-файла в **long**. Кроме того любое пользовательское событие, метод или свойство, которое использует параметр SCODE также приводит к той же проблемой.

##  <a name="fireevent"></a>  COleControl::FireEvent

Инициирует событие определяемых пользователем из элемента управления с любым количеством необязательные аргументы.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчеризации, возникает событие.

*pbParams*<br/>
Дескриптор для типов параметров события.

### <a name="remarks"></a>Примечания

Обычно эта функция не должен вызываться напрямую. Вместо этого будет вызывать функции обработки событий в разделе сопоставления событий объявления класса элемента управления.

*PbParams* аргумент является разделенный пробелами список **VTS_**. Одно или несколько из этих значений, разделенных пробелами (не запятыми), составляют список параметров функции. Ниже приведены возможные значения.

|Символ|Тип параметра|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Дополнительные variant константы определены для всех вариантов типов, за исключением VTS_FONT и VTS_PICTURE, которые обеспечивают указатель на константу данных variant. Эти константы, именуются с помощью **VTS_P** `constantname` соглашение. Например VTS_PCOLOR является указателем на vts_color-константа.

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Вызывается платформой при нажатии клавиши, когда элемент управления является активным в пользовательском Интерфейсе.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на значение виртуального кода клавиши нажатой клавише. Список стандартных коды виртуальных клавиш см. в разделе Winuser.h

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматической обработки события KeyDown возникает схема событий элемента управления должен иметь акций определенные события KeyDown.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Вызывается платформой при нажатии и отпускании пока пользовательский элемент управления активен пользовательского интерфейса внутри контейнера ключа.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на значение символа нажатой клавиши.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Получатель события может изменить *pnChar*, например, преобразования всех символов нижнего регистра в верхний регистр. Если вы хотите изучить измененный символ, переопределить `OnKeyPressEvent`.

Для автоматического запуска происходят события KeyPress схема событий элемента управления должен иметь акций определенные события KeyPress.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Вызывается платформой при отпускании клавиши, если пользовательский элемент управления активен пользовательского интерфейса в контейнере.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Параметры

*pnChar*<br/>
Указатель на значение виртуального кода клавиши выпущенные ключа. Список стандартных коды виртуальных клавиш см. в разделе Winuser.h

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматического срабатывание событие KeyUp, схема событий элемента управления должен иметь стандартное событие KeyUp с определенных.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Вызывается платформой при нажатии кнопки мыши active пользовательского элемента управления.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nButton*<br/>
Числовое значение параметра кнопка мыши нажата. Он может содержать одно из следующих значений:

- LEFT_BUTTON левая кнопка мыши была нажата вниз.

- MIDDLE_BUTTON средняя кнопка мыши была нажата вниз.

- RIGHT_BUTTON правая кнопка мыши была нажата вниз.

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

*x*<br/>
Координата по оси x курсор при нажатой кнопке мыши. Координата указывается относительно левого верхнего угла окна элемента управления.

*y*<br/>
Координата по оси y курсора для нажатой кнопки мыши. Координата указывается относительно левого верхнего угла окна элемента управления.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматического запуска происходят события MouseDown схема событий элемента управления должен иметь акций события MouseDown, определенного.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Вызывается платформой при перемещении курсора над active пользовательского элемента управления.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nButton*<br/>
Числовое значение кнопок мыши нажата. Содержит комбинацию из следующих значений:

- LEFT_BUTTON левая кнопка мыши была нажата работу во время выполнения действия.

- MIDDLE_BUTTON средняя кнопка мыши была нажата работу во время выполнения действия.

- RIGHT_BUTTON правая кнопка мыши была нажата работу во время выполнения действия.

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

*x*<br/>
Координата курсора по оси x. Координата указывается относительно левого верхнего угла окна элемента управления.

*y*<br/>
Координата по оси y курсора. Координата указывается относительно левого верхнего угла окна элемента управления.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматической обработки, где происходят события MouseMove, схема событий элемента управления должен иметь акций события MouseMove, определенного.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Вызывается платформой при отпускании кнопки мыши, через active пользовательского элемента управления.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Параметры

*nButton*<br/>
Числовое значение отпущена кнопка мыши. Он может иметь одно из следующих значений:

- Выпущено LEFT_BUTTON левую кнопку мыши.

- MIDDLE_BUTTON средняя кнопка мыши была выпущена.

- RIGHT_BUTTON правая кнопка мыши была выпущена.

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

*x*<br/>
Координата по оси x курсора, когда кнопка мыши отпущена. Координата указывается относительно левого верхнего угла окна элемента управления.

*y*<br/>
Координата по оси y курсора, когда кнопка мыши отпущена. Координата указывается относительно левого верхнего угла окна элемента управления.

### <a name="remarks"></a>Примечания

Если это событие определяется как пользовательское событие, вам определить, когда событие.

Для автоматического срабатывание событие MouseUp, схема событий элемента управления должен иметь стандартное событие MouseUp с определенных.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Инициирует событие с текущим значением состояние готовности элемента управления.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Примечания

Состояние готовности может принимать одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|В настоящее время загрузки его свойства элемента управления|
|READYSTATE_LOADED|Элемент управления был инициализирован.|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.|
|READYSTATE_COMPLETE|Элемент управления имеет все данные|

Используйте [GetReadyState](#getreadystate) для определения готовности текущего элемента управления.

[InternalSetReadyState](#internalsetreadystate) изменяет состояние готовности значению, переданному, а затем вызывает `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Изменяет поведение активации по умолчанию элемент управления, поддерживающий `IPointerInactive` интерфейс.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Возвращаемое значение

Сочетание флагов из перечисления POINTERINACTIVE. Ниже приведены возможные флаги.

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|Объект должен быть активироваться при его наведении во время операции перемещения указателя мыши на месте.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|Объект должен быть отключается, когда мышь покидает объекта во время операции перемещения мыши.|
|POINTERINACTIVE_ACTIVATEONDRAG|Объект должен быть активироваться при перемещении мыши над ней во время перетаскивания на месте и операции удаления.|

### <a name="remarks"></a>Примечания

Когда `IPointerInactive` интерфейс включен, делегирует WM_SETCURSOR и wm_mousemove и сообщений в этот контейнер. `COleControl`в реализации этого интерфейса передает эти сообщения через схему сообщений элемента управления, после настройки мыши координирует соответствующим образом.

Каждый раз, когда контейнер получает сообщение WM_SETCURSOR или wm_mousemove и указатель мыши через неактивные объект, поддерживающий `IPointerInactive`, он должен вызывать `GetActivationPolicy` на интерфейс и возвращаемого значения флагов из перечисления POINTERINACTIVE.

Эти сообщения так же, как обычные оконных сообщений, можно обработать, добавив соответствующие записи в схеме сообщений. В обработчиков, избегайте использования `m_hWnd` переменную-член (или все функции-члены, которые он использует) без предварительной проверки, что его значение не равно NULL.

Любой объект, который предназначен для более чем установить курсор мыши и/или запускать события перемещения мыши, такие как обеспечить специальные визуальную обратную связь, следует вернуть флаг POINTERINACTIVE_ACTIVATEONENTRY и рисования отзывы, только в том случае, если active. Если объект возвращает этот флаг, контейнер следует сразу же активировать его на месте и затем переслать его то же сообщение, которая запустила вызов `GetActivationPolicy`.

Если флаги POINTERINACTIVE_ACTIVATEONENTRY "и" POINTERINACTIVE_DEACTIVATEONLEAVE возвращаются, то объект будут активированы только когда указатель мыши находится над объектом. Флаг POINTERINACTIVE_ACTIVATEONENTRY возвращается, если только затем объекта будут активированы только после когда указатель мыши впервые входит объект.

Вы также можете неактивный элемент управления, чтобы быть целевым объектом перетаскивания OLE операции перетаскивания. Для этого требуется активация элемент управления в момент, когда пользователь перетаскивает объект, таким образом, чтобы окна элемента управления могут быть зарегистрированы в качестве цели перетаскивания. Чтобы во время перетаскивания успешной активации, возвращают флаг POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Сообщаются сведения путем `GetActivationPolicy` не должен кэшироваться в контейнере. Вместо этого этот метод должен вызываться при каждом входе мыши неактивным объектом.

Если неактивному объекту не запрашивает быть активироваться при его наведении на месте, его контейнер должен отправлять последующие сообщения WM_SETCURSOR этому объекту путем вызова [OnInactiveSetCursor](#oninactivesetcursor) условии, что указатель мыши остается над объектом.

Включение `IPointerInactive` интерфейс обычно означает, что элемент управления, чтобы иметь возможность обработать сообщения мыши все время. Для получения этого поведения в контейнере, который не поддерживает `IPointerInactive` интерфейс, будет необходимо иметь элемент управления всегда активировано, когда отображается, что означает элемент управления должен иметь флаг OLEMISC_ACTIVATEWHENVISIBLE среди прочих флаги. Тем не менее, чтобы предотвратить этот флаг из вступают в силу в контейнере, поддерживает ли `IPointerInactive`, можно также указать флаг OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Получает значение внешнее свойство контейнера.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Параметры

*dwDispid*<br/>
Идентификатор диспетчеризации требуемое внешнее свойство.

*vtProp*<br/>
Тип variant тег, который указывает тип значения должен быть возвращен в *pvProp*.

*pvProp*<br/>
Указатель на адрес переменной, которая будет принимать значение свойства или возвращаемого значения. Фактический тип указателя this должен соответствует типу, заданному параметром *vtProp*.

|vtProp|Тип pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если поддерживается внешнее свойство; в противном случае 0.

### <a name="remarks"></a>Примечания

Если вы используете `GetAmbientProperty` для извлечения внешние свойства DisplayName и ScaleUnits установите *vtProp* значение VT_BSTR и *pvProp* для `CString*`. Чтобы получить свойства шрифта окружения, задайте *vtProp* для VT_FONT и *pvProp* для LPFONTDISP *.

Обратите внимание, что функции уже были предоставлены для общих свойства окружающей среды, такие как [AmbientBackColor](#ambientbackcolor) и [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Реализует функцию Get стандартных свойств внешнего вида элемента управления.

```
short GetAppearance ();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение, указывающее текущую настройку внешнего вида как **короткие** (VT_I2) значение, при успешном выполнении. Это значение равно нулю, если внешний вид элемента управления является плоский и 1, если внешний вид элемента управления является 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Реализует функцию Get стандартных свойств BackColor элемента управления.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение указывает текущий цвет фона в виде значения OLE_COLOR, при успешном выполнении. Это значение можно преобразовать в значение COLORREF вызовом `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Реализует функцию Get стандартных BorderStyle свойств элемента управления.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Возвращаемое значение

1, если элемент управления имеет обычной границу; 0, если элемент управления не имеет границы.

##  <a name="getcapture"></a>  COleControl::GetCapture

Определяет, является ли `COleControl` объект имеет захват мыши.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и без окон, возвращает **это** Если элемент управления в настоящее время имеет записи (что определяется контейнера элемента управления), или значение NULL, если он не имеет захват мыши.

В противном случае возвращает `CWnd` объект, имеющий захват мыши (то же, что `CWnd::GetCapture`).

### <a name="remarks"></a>Примечания

Активированные безоконный элемент управления получает мыши при записи [SetCapture](#setcapture) вызывается.

##  <a name="getclassid"></a>  COleControl::GetClassID

Вызывается платформой для получения идентификатора класса OLE элемента управления.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Параметры

*pclsid*<br/>
Указатель на местоположение идентификатора класса.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов не был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Обычно реализуется [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Извлекает разницу между в верхний левый угол прямоугольной области элемента управления и в верхнем левом углу клиентской области.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Параметры

*pdxOffset*<br/>
Указатель на горизонтальное смещение клиентской области элемента управления OLE.

*pdyOffset*<br/>
Указатель на вертикальное смещение клиентской области элемента управления OLE.

### <a name="remarks"></a>Примечания

Элемент управления OLE имеет прямоугольная область в пределах контейнера. Клиентской области элемента управления — это область элемента управления, за исключением границами и полосами прокрутки. Смещение полученных `GetClientOffset` разница между в верхний левый угол прямоугольной области элемента управления и в верхнем левом углу клиентской области. Если элемент управления имеет неклиентские элементы, отличные от стандартных границ и полос прокрутки, переопределите эта функция-член для указания смещения.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Чтобы получить размер клиентской области элемента управления.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на `RECT` структура, содержащая размеры клиентской области элемента управления без окон, то есть размер элемента управления за вычетом границы окна, кадры, полосы прокрутки и т. д. *LpRect* параметр указывает размер клиентского прямоугольника элемента управления, не его позиции.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Запрашивает объект для указателя на его текущем сайте клиента в пределах контейнера.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на текущий сайт клиентского элемента управления в своем контейнере.

### <a name="remarks"></a>Примечания

Возвращаемый указатель указывает на экземпляр `IOleClientSite`. `IOleClientSite` Интерфейс, реализуемый контейнерами, является представлением объекта своего контекста: где он прикреплен в документе, где он получает свое хранилище, пользовательский интерфейс и другие ресурсы.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Получает флаг настройки элемента управления.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Возвращаемое значение

/ / ORed сочетанием флагов в перечислении ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Примечания

По умолчанию `GetControlFlags` возвращает `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Если задано, функция использует begin-paint, предназначенное для элементов управления OLE, а не [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (значение по умолчанию).|
|`clipPaintDC`|Если не установлено, отключает вызов `IntersectClipRect` сделанных `COleControl` и получает скорость. Если вы используете активации без окна, флаг не оказывает влияния.|
|`pointerInactive`|Если задано, обеспечивает взаимодействия с мышью, а элемент управления неактивен, включив `COleControl`в реализации `IPointerInactive` интерфейс, который по умолчанию отключена.|
|`noFlickerActivate`|Если задано, устраняет необходимость дополнительных операций очень рисования и им мерцание. Используется, если элемент управления самостоятельно прорисовывающий одинаково в штатах неактивными. Если вы используете активации без окна, флаг не оказывает влияния.|
|`windowlessActivate`|Если установлено, указывает на элемент управления использует активации без окна.|
|`canOptimizeDraw`|Если установлено, указывает, что элемент управления будет выполнять оптимизированное Рисование, если контейнер поддерживает его.|

Дополнительные сведения о `GetControlFlags` и другие виды оптимизации, элементов управления OLE, см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Получает размер окна элемента управления OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Параметры

*pcx*<br/>
Указывает ширину элемента управления в пикселях.

*pcy*<br/>
Задает высоту элемента управления в пикселях.

### <a name="remarks"></a>Примечания

Обратите внимание, что все координаты для элемента управления windows указываются относительно верхнего левого угла элемента управления.

##  <a name="getdc"></a>  COleControl::GetDC

Обеспечивает безоконному объекту контекста устройства get экран (или совместимые) из своего контейнера.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Параметры

*lprcRect*<br/>
Указатель на прямоугольник безоконный элемент управления намеревается перерисовать, указанный в координатах клиентской области окна элемента управления. Значение NULL означает полный объект экстента.

*dwFlags*<br/>
Атрибуты рисования контекст устройства. Доступны варианты:

- OLEDC_NODRAW указывает, что объект не будет использовать контекст устройства для выполнения любое изображение просто, но для получения сведений об устройстве отображения. Контейнер должен просто передать окна контроллера домена без дальнейшей обработки.

- OLEDC_PAINTBKGND запросов, что контейнер в качестве фона перед возвратом DC. Объект следует использовать этот флаг, если он запрашивает контроллер домена для перерисовки области с прозрачным фоном.

- OLEDC_OFFSCREEN информирует контейнер, который хочет объект визуализации в в битовом изображении, которое затем должны копироваться на экран. Объект должен использовать этот флаг, при операции рисования, которые он собирается выполнить создает массу мерцание. Контейнер может удовлетворять этот запрос или нет. Тем не менее, если этот флаг не установлен, контейнер необходимо передать обратно на экране контроллера домена. Благодаря этому объекты для выполнения операций прямого экран, например отображение выделения (через **XOR** операции).

### <a name="return-value"></a>Возвращаемое значение

Указатель на контекст устройства отображения для контейнера `CWnd` клиентской области Если успешно; в противном случае возвращает значение NULL. Контекста устройства отображения могут использоваться в последующих функций GDI для рисования в клиентской области окна контейнера.

### <a name="remarks"></a>Примечания

[ReleaseDC](#releasedc) необходимо вызвать функцию-член для освобождения контекста после рисования. При вызове `GetDC`, объекты передачи хочет привлечь в собственных клиентских координат прямоугольника. `GetDC` преобразует их в координатах клиентской области контейнера. Объект не следует запрашивать нужные изображенного прямоугольника, больше, чем область свой собственный клиентский прямоугольник, размер которой можно получить с помощью [метода GetClientRect](#getclientrect). Благодаря этому объекты случайно рисования, где они не должны.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Реализует функцию Get акций элемента управления свойство Enabled.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления включен; в противном случае 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Получает указатель на объект, который обслуживается контейнер, который представляет элемент управления с расширенный набор свойств.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на контейнер расширенных объект элемента управления. Если отсутствует объект, значение равно NULL.

Этот объект может управляться с помощью его `IDispatch` интерфейс. Можно также использовать `QueryInterface` может получать другие доступные интерфейсы, предоставляемые объектом. Тем не менее объект не обязательно поддерживать определенный набор интерфейсов. Обратите внимание, что полагаться на конкретные компоненты объекта расширенного элемента управления контейнера ограничивает переносимость в другие контейнеры произвольный элемент управления.

### <a name="remarks"></a>Примечания

Функция, которая вызывает эту функцию несет ответственность за освобождение указателя, после завершения с объектом. Обратите внимание на то, что контейнер не требуется для поддержки этого объекта.

##  <a name="getfocus"></a>  COleControl::GetFocus

Определяет, является ли `COleControl` объект имеет фокус.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Если элемент управления активирован и без окон, возвращает **это** Если элемент управления в настоящее время имеет сосредоточить внимание (в соответствии с контейнера элемента управления), или значение NULL, если он имеет фокус клавиатуры.

В противном случае возвращает `CWnd` объект, имеющий фокус (то же, что `CWnd::GetFocus`).

### <a name="remarks"></a>Примечания

Активированные безоконный элемент управления получает фокус при [SetFocus](#setfocus) вызывается.

##  <a name="getfont"></a>  COleControl::GetFont

Реализует функцию Get стандартных свойств шрифта.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на интерфейс диспетчеризации шрифта для элемента управления stock Font-свойство.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что вызывающий объект должен освободить объект после завершения. В рамках реализации элемента управления, использовать `InternalGetFont` для доступа к объекту акций шрифта для элемента управления. Дополнительные сведения об использовании шрифтов в элементе управления, см. в статье [элементы управления ActiveX: Использование шрифтов в элементе управления ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Измеряет показатели текст для любого `CFontHolder` объектов, принадлежащих данному элементу управления.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*lptm*<br/>
Указатель на [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) структуры.

*fontHolder*<br/>
Ссылка на [CFontHolder](../../mfc/reference/cfontholder-class.md) объекта.

### <a name="remarks"></a>Примечания

Можно выбрать с помощью такого шрифта [COleControl::SelectFontObject](#selectfontobject) функции. `GetFontTextMetrics` Инициализирует `TEXTMETRIC` структуры, на которые указывают *lptm* о допустимых метрик `fontHolder`элемента шрифта в случае успешного выполнения или заполнить структуру нулями, если не выполнено. Следует использовать эту функцию вместо [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) при рисование элемента управления, возможно, элементы управления, как и любой внедренного объекта OLE, необходимые для отображения самостоятельно в метафайл.

`TEXTMETRIC` Структуру для сочетания шрифт по умолчанию при обновлении [SelectFontObject](#selectfontobject) функция вызывается. Следует вызывать `GetFontTextMetrics` только после выбора свойство Font для обеспечения предсказуемой сведениями является допустимым.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Реализует функцию Get стандартных свойств цвет переднего плана.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение указывает текущий цвет переднего плана в виде значения OLE_COLOR, при успешном выполнении. Это значение можно преобразовать в [COLORREF](/windows/desktop/gdi/colorref) значение с помощью вызова `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Реализует функцию Get свойства акций hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Возвращаемое значение

Дескриптор окна элемента управления OLE, при его наличии; в противном случае имеет значение NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Вызывается платформой для получения короткую строку, описывающую назначение пункта меню, идентифицируемый *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Параметры

*nID*<br/>
Идентификатор элемента меню.

*rMessage*<br/>
Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объекта, через который будет возвращаться строка.

### <a name="remarks"></a>Примечания

Это может использоваться для получения сообщения для отображения в строке состояния, снимая выделения пункта меню. Реализация по умолчанию пытается загрузить строковый ресурс, идентифицируемый *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Запрещает доступ к значению свойства элемента управления пользователем.

```
void GetNotSupported();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию вместо функции Get любого свойства, где не поддерживается получение свойства элемента управления пользователем. Примером может служить свойство, которое доступно только для записи.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Возвращает состояние готовности элемента управления.

```
long GetReadyState();
```

### <a name="return-value"></a>Возвращаемое значение

Состояние готовности элемента управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|В настоящее время загрузки его свойства элемента управления|
|READYSTATE_LOADED|Элемент управления был инициализирован.|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.|
|READYSTATE_COMPLETE|Элемент управления имеет все данные|

### <a name="remarks"></a>Примечания

Большинство простых элементов управления не требуется различать LOADED» и «INTERACTIVE. Тем не менее элементы управления, поддерживающие свойства пути данных не может быть готовы быть интерактивным, пока по крайней мере некоторые данные получаются в асинхронном режиме. Элемент управления следует попытаться стать интерактивных как можно скорее.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Получает координаты прямоугольника элемента управления относительно контейнера, выраженный в единицах устройства.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на структуру прямоугольник, в который будут скопированы координат элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления является активным на месте; в противном случае 0.

### <a name="remarks"></a>Примечания

Прямоугольник допустимо только в том случае, если элемент управления является активным на месте.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Измеряет показатели текст для элемента управления свойство Font, которое может быть установлено с [SelectStockFont](#selectstockfont) функции.

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Параметры

*lptm*<br/>
Указатель на [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) структуры.

### <a name="remarks"></a>Примечания

`GetStockTextMetrics` Функция будет инициализировать `TEXTMETRIC` структуры, на которые указывают *lptm* с сведения о допустимых метрик при успешном выполнении или заполнения структуры нулями, если не выполнено. Используйте эту функцию вместо [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) при рисование элемента управления, возможно, элементы управления, как и любой внедренного объекта OLE, необходимые для отображения самостоятельно в метафайл.

`TEXTMETRIC` Структуру для сочетания шрифт по умолчанию при обновлении `SelectStockFont` функция вызывается. Эту функцию следует вызывать только после выбора акций шрифт для обеспечения предсказуемой сведения, предоставляемые им является допустимым.

##  <a name="gettext"></a>  COleControl::GetText

Реализует функцию Get стандартных свойств Text или Caption.

```
BSTR GetText();
```

### <a name="return-value"></a>Возвращаемое значение

Текущее значение управления текстовую строку или строку нулевой длины, если строка не присутствует.

> [!NOTE]
>  Дополнительные сведения о данные типа BSTR, см. в разделе [типы данных](../../mfc/reference/data-types-mfc.md) в разделе макросы и глобальные объекты.

### <a name="remarks"></a>Примечания

Обратите внимание, что вызывающий объект этой функции необходимо вызвать `SysFreeString` строки, возвращаемых в бесплатный ресурс. В рамках реализации элемента управления, использовать `InternalGetText` для доступа к свойству Text или Caption акций элемента управления.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Переопределить `GetWindowlessDropTarget` при необходимости безоконный элемент управления в качестве целевого объекта OLE операции перетаскивания.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на объект `IDropTarget` интерфейс. Так как он не имеет окна, безоконному объекту не удается зарегистрировать `IDropTarget` интерфейс. Тем не менее, чтобы участвовать в операции перетаскивания, безоконному объекту можно по-прежнему реализуйте интерфейс и возвратить его в `GetWindowlessDropTarget`.

### <a name="remarks"></a>Примечания

Как правило это потребует, что окна элемента управления быть зарегистрирована в качестве целевого объекта перетаскивания. Но так как элемент управления не имеет окна свои собственные, контейнер будет использовать отдельное окно как целевого объекта перетаскивания. Элемент управления необходимо предоставить реализацию `IDropTarget` интерфейс, к которому контейнера можно делегировать вызовы в соответствующее время. Пример:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Информирует базового класса со значениями IID, элемент управления будет использовать.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Параметры

*piidPrimary*<br/>
Указатель на идентификатор элемента управления первичный интерфейс диспетчеризации.

*piidEvents*<br/>
Указатель на идентификатор интерфейса событий элемента управления.

### <a name="remarks"></a>Примечания

Вызовите эту функцию в конструктор элемента управления для информирования базовый класс для элемента управления будет использовать идентификаторы интерфейсов.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Обращается к свойство Font элемента управления

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылку на [CFontHolder](../../mfc/reference/cfontholder-class.md) , содержащий акций объект шрифта.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Обращается к стандартное свойство Text или Caption элемента управления.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Возвращаемое значение

Ссылка на текстовую строку элемента управления.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Задает состояние готовности элемента управления.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Параметры

*lNewReadyState*<br/>
Состояние готовности, чтобы задать для элемента управления, одно из следующих значений:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Состояние инициализации по умолчанию|
|READYSTATE_LOADING|В настоящее время загрузки его свойства элемента управления|
|READYSTATE_LOADED|Элемент управления был инициализирован.|
|READYSTATE_INTERACTIVE|Элемент управления имеет достаточно данных, чтобы быть интерактивным, но не все асинхронные данных еще загружается.|
|READYSTATE_COMPLETE|Элемент управления имеет все данные|

### <a name="remarks"></a>Примечания

Большинство простых элементов управления не требуется различать LOADED» и «INTERACTIVE. Тем не менее элементы управления, поддерживающие свойства пути данных не может быть готовы быть интерактивным, пока по крайней мере некоторые данные получаются в асинхронном режиме. Элемент управления следует попытаться стать интерактивных как можно скорее.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Заставляет элемент управления получает команду перерисовать себя.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на область элемента управления необходимо сделать недействительным.

*bErase*<br/>
Указывает, является ли фон в пределах области обновления утрачиваются при обработке области обновления.

### <a name="remarks"></a>Примечания

Если *lpRect* имеет значение NULL, весь элемент управления перерисовывается. Если *lpRect* не равно NULL, это указывает на часть прямоугольника элемента управления, которое должно быть объявлено недействительным. В случаях, когда элемент управления не имеет окна, или в настоящее время не активен, прямоугольник учитывается, и выполняется вызов для клиентского сайта [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) функция-член. Используйте эту функцию вместо `CWnd::InvalidateRect` или `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Делает недействительной клиентскую область окна контейнера в пределах заданной области.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Параметры

*pRgn*<br/>
Указатель на [CRgn](../../mfc/reference/crgn-class.md) , определяющий область отображения объекта OLE, который требуется сделать недействительной в клиентских координатах содержащего его окна. Если этот параметр имеет значение NULL, экстент является весь объект.

*bErase*<br/>
Указывает, является ли фон в пределах Недопустимая область для удаления. Если значение равно TRUE, фон стирается. Если значение равно FALSE, фон остается неизменным.

### <a name="remarks"></a>Примечания

Это можно использовать для повторной отрисовки поверхности элементы управления без окон в контейнере. Недопустимая область, а также все другие темы, в области обновления помечен для закрашивания при следующем [WM_PAINT](/windows/desktop/gdi/wm-paint) отправляется сообщение.

Если *bErase* имеет значение TRUE для любой части области "обновления" на фоновом режиме в весь регион, а не только в указанной части, удаляется.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Разрешает загрузку специализированного элемента управления OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления преобразуется; в противном случае 0.

### <a name="remarks"></a>Примечания

При преобразовании форму, которая использует VBX элементов управления, который использует элементы управления OLE, могут потребоваться специальные загрузки кода для элементов управления OLE. Например, при загрузке экземпляра элемента управления OLE, возможно, вызов [PX_Font](persistence-of-ole-controls.md#px_font) в вашей `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Тем не менее элементы управления VBX не было объект шрифта; Каждое свойство font была сохранена по отдельности. В этом случае используется `IsConvertingVBX` для различения этих двух случаях:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Еще один случай бы в том случае, если элемент управления VBX сохраняются собственных двоичных данных (в его VBM_SAVEPROPERTY обработчик) и элемента управления OLE сохраняет его двоичных данных в другом формате. Если требуется, чтобы элемент управления OLE обратную совместимость с элементом управления VBX, можно прочитать обе старые и новые форматы, используя `IsConvertingVBX` функции, обращая внимание на ли элемент управления VBX или управления OLE при загрузке.

В системе управления `DoPropExchange` функции, можно проверить это условие и значение true, если выполнить код загрузки, определенные для этого преобразования (например, в предыдущих примерах). Если элемент управления не преобразуется, чтобы выполнить код нормальной нагрузки. Эта возможность применяется только к элементам управления, преобразованная в VBX аналоги.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Включает вызов метода автоматизации.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления был инициализирован; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация платформы `IDispatch::Invoke` вызовы `IsInvokeAllowed` для определения данной функции (определяется `dispid`), могут быть вызваны. Поведение по умолчанию для элемента управления OLE разрешено методы автоматизации, которые вызываются только в том случае, если элемент управления был инициализирован; Тем не менее `IsInvokeAllowed` является виртуальной функцией и можно переопределить при необходимости (например, при использовании элемента управления как сервера автоматизации).

##  <a name="ismodified"></a>  COleControl::IsModified

Определяет, если состояние элемента управления был изменен.

```
BOOL IsModified();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если состояние элемента управления был изменен с момента последнего сохранения; в противном случае 0.

### <a name="remarks"></a>Примечания

Состояние элемента управления изменяется при изменении значения свойства.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Определяет, поддерживает ли контейнер оптимизированное Рисование для текущей операции рисования.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если контейнер поддерживает оптимизированное Рисование для текущей операции рисования; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Если поддерживается оптимизированное Рисование, элемент управления требуется не выберите старых объектов (перья, кисти, шрифты и др.) в контексте устройства после завершения рисования.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Вызывается платформой для определения того, если элемент управления подклассом Windows контролировать.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элемент управления является подклассом; в противном случае 0.

### <a name="remarks"></a>Примечания

Необходимо переопределить эту функцию и возвращает TRUE, если ваш OLE управления подклассов элемента управления Windows.

##  <a name="load"></a>  COleControl::Load

Сбрасывает все предыдущие данные загружен в асинхронном режиме и инициирует новый загрузку асинхронного свойства элемента управления.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Параметры

*strNewPath*<br/>
Указатель на строку, содержащую путь, который ссылается на абсолютное расположение асинхронного свойства элемента управления.

*prop*<br/>
Объект [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) объект, реализующий свойство асинхронный элемент управления.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Запрещает деактивации элемента управления контейнера.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Параметры

*Блок*<br/>
Значение TRUE, если на месте активное состояние элемента управления должен быть заблокирован; Значение FALSE, если это должен быть разблокирован.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если блокировка была успешно; в противном случае 0.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что каждый блокировки элемента управления должны быть связаны с разблокировкой элемента управления после завершения. Только необходимо заблокировать элемент управления для коротких промежутков времени, например, при обработке события.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Вызывается платформой при изменении значения внешнее свойство контейнера.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Параметры

*dispID*<br/>
Идентификатор отправки измененного свойства окружения или DISPID_UNKNOWN, если несколько свойств были изменены.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Вызывается платформой, когда изменилось значение свойства Appearance акций.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если уведомление после изменения этого свойства требуется. По умолчанию реализация вызывает `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Вызывается платформой, когда изменилось значение свойства BackColor акций.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если уведомление после изменения этого свойства требуется. По умолчанию реализация вызывает `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Вызывается платформой, когда изменилось значение свойства BorderStyle акций.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает `InvalidateControl`.

Переопределите эту функцию, если уведомление после изменения этого свойства требуется.

##  <a name="onclick"></a>  COleControl::OnClick

Вызывается платформой, когда был выполнен щелчок кнопкой мыши или вызывается метод DoClick.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Параметры

*iButton*<br/>
Индекс кнопки мыши. Может принимать одно из следующих значений:

- LEFT_BUTTON левая кнопка мыши была нажата.

- MIDDLE_BUTTON средняя кнопка мыши была нажата.

- RIGHT_BUTTON правая кнопка мыши была нажата.

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает `COleControl::FireClick`.

Переопределите эту функцию-член для изменения или расширения обработку по умолчанию.

##  <a name="onclose"></a>  COleControl::OnClose

Вызывается платформой, когда контейнер элемента управления называется `IOleControl::Close` функции.

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Параметры

*dwSaveOption*<br/>
Флаг, указывающий, должен ли сохраняться объекта перед загрузкой. Допустимые значения:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Примечания

По умолчанию `OnClose` сохраняет объект элемента управления, если он был изменен и *dwSaveOption* OLECLOSE_SAVEIFDIRTY или OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Вызывается платформой, когда контейнер вызывает `IOleObject::DoVerb` функция-член.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*iVerb*<br/>
Индекс команды управления для вызова.

*lpMsg*<br/>
Указатель на сообщение Windows, вызвавшее команду для вызова.

*hWndParent*<br/>
Дескриптор родительского окна элемента управления. Если выполнение команды создает окна (или windows), *hWndParent* следует использовать в качестве родительского.

*lpRect*<br/>
Указатель на структуру RECT, координаты элемента управления, относительно контейнера, в который будут скопированы.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию использует ON_OLEVERB и ON_STDOLEVERB записей карты сообщений для определения правильного для вызова функции.

Переопределите эту функцию, чтобы изменить обработку команды по умолчанию.

##  <a name="ondraw"></a>  COleControl::OnDraw

Вызывается платформой для отрисовки элемента управления OLE в обозначенного границами прямоугольника с помощью заданного контекста устройств.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисование.

*rcBounds*<br/>
Прямоугольная область элемента управления, включая границы.

*rcInvalid*<br/>
Прямоугольная область элемента управления, который является недопустимым.

### <a name="remarks"></a>Примечания

`OnDraw` обычно вызывается для отображения на экране, передача контекста устройства экрана как *pDC*. *RcBounds* параметр указывает прямоугольник в контексте целевого устройства (относительно его текущий режим сопоставления). *RcInvalid* параметр является фактический прямоугольник, который является недопустимым. В некоторых случаях это будет меньшую область, чем *rcBounds*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Вызывается платформой для отрисовки элемента управления OLE в обозначенного границами прямоугольника, используя указанный метафайл контекст устройства.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в котором происходит рисование.

*rcBounds*<br/>
Прямоугольная область элемента управления, включая границы.

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает [OnDraw](#ondraw) функции.

##  <a name="onedit"></a>  COleControl::OnEdit

Элемент управления активироваться через UI.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpMsg*<br/>
Указатель на сообщение Windows, которое вызвало команду.

*hWndParent*<br/>
Дескриптор родительского окна элемента управления.

*lpRect*<br/>
Указатель на прямоугольник, используемые элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Это имеет тот же эффект, что и вызов команды OLEIVERB_UIACTIVATE элемента управления.

Эта функция обычно используется в качестве функции обработчика для записи карты ON_OLEVERB сообщение. Это делает доступным выполнение команды «Изменить» в меню «Объект» элемента управления. Пример:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Вызывается платформой, когда изменилось значение свойства Enabled акции.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если уведомление после изменения этого свойства требуется. По умолчанию реализация вызывает [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Вызывается платформой, когда контейнер вызывает `IOleObject::EnumVerbs` функция-член.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Параметры

*ppenumOleVerb*<br/>
Указатель на `IEnumOLEVERB` объект, который перечисляет команды элемента управления.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если доступны команды; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию перечисляет ON_OLEVERB записи в схеме сообщений.

Переопределите эту функцию, чтобы изменить способ по умолчанию перечисление команд.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Вызывается платформой при отключении от элемента управления OLE или подключения обработчика событий.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Параметры

*bAdvise*<br/>
Значение TRUE указывает, что обработчик событий был подключен к элементу управления. Значение FALSE указывает, что обработчик событий был отключен от элемента управления.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Вызывается платформой при изменении значения свойства шрифта для акций.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает `COleControl::InvalidateControl`. Если элемент управления является создание подкласса элемента управления Windows, реализация по умолчанию также отправляет сообщение WM_SETFONT окна элемента управления.

Переопределите эту функцию, если уведомление после изменения этого свойства требуется.

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Вызывается платформой, когда изменилось значение свойства ForeColor акций.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает `InvalidateControl`.

Переопределите эту функцию, если уведомление после изменения этого свойства требуется.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Вызывается структурой после вызовов контейнера `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Параметры

*bFreeze*<br/>
Значение TRUE, если элемент управления обработкой событий является замороженной; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий.

Переопределите эту функцию, если требуется дополнительное поведение, когда обработка событий является замороженным или разморозить.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Вызывается платформой, когда контейнер вызывает `IViewObject::GetColorSet` функция-член.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Параметры

*ptd*<br/>
Указывает целевое устройство, для которого необходимо отобразить изображение. Если это значение равно NULL, рисунок должен визуализироваться для целевого устройства по умолчанию обычно устройство отображения.

*hicTargetDev*<br/>
Указывает контекст сведения на целевом устройстве, обозначается *ptd*. Этот параметр может быть контекста устройства, но не обязательно. Если *ptd* имеет значение NULL, *hicTargetDev* также должен иметь значение NULL.

*ppColorSet*<br/>
Указатель на местоположение, в который необходимо скопировать набор цветов, которые будут использоваться. Если функция возвращает набор цветов, возвращается значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если возвращается набор допустимым цветом; в противном случае 0.

### <a name="remarks"></a>Примечания

Контейнер вызывает эту функцию, чтобы получить все цвета, необходимых для отрисовки элемента управления OLE. Контейнер может использовать цвет наборов, полученных в сочетании с цветами, необходимые для установки общую цветовую палитру. Реализация по умолчанию возвращает значение FALSE.

Переопределите эту функцию для выполнения специальной обработки этого запроса.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Вызывается платформой, когда запрашивает сведения об элементе управления контейнера элемента управления.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Параметры

*pControlInfo*<br/>
Указатель на [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) структуры для заполнения.

### <a name="remarks"></a>Примечания

Эти сведения в основном состоит из описание назначенным клавишам элемента управления. Заливки по умолчанию реализация *pControlInfo* с информацией по умолчанию.

Переопределите эту функцию, если элемент управления должен обрабатывать назначенные клавиши.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Вызывается платформой для получения строка, представляющая текущее значение свойства, идентифицируемого по *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*strValue*<br/>
Ссылку на [CString](../../atl-mfc-shared/reference/cstringt-class.md) объекта, через который будет возвращаться строка.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если строка была возвращена в *strValue;* 0 в противном случае.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления имеет свойство, значение которого невозможно напрямую преобразовать в строку и необходимо, чтобы значение свойства для отображения в обозревателе предоставляемую контейнера свойств.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Вызывается платформой при активации для получения меню, чтобы объединить в существующее меню контейнера пользовательского интерфейса элемента управления.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Возвращаемое значение

Дескриптор элемента управления меню или значение NULL, если элемент управления не имеет ни одного. Реализация по умолчанию возвращает значение NULL.

### <a name="remarks"></a>Примечания

Дополнительные сведения о слиянии ресурсы OLE см. в статье [меню и ресурсы (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Вызвано структурой в ответ в контейнер `IViewObjectEx::GetNaturalExtent` запроса.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Указывает способ представления объекта. Представления включают содержимое, значок, эскиз или печатном документе. Допустимые значения берутся из перечисления [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) или DVASPECT2.

*Индекс*<br/>
Часть объекта, который не представляет интереса. В настоящее время только значение -1 является допустимым.

*ptd*<br/>
Указывает на [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) структуру, определяющую целевое устройство, для которого следует вернуть размер объекта.

*hicTargetDev*<br/>
Указывает информационный контекст для целевого устройства, указанного по *ptd* параметра, из которого объект может извлечь метрики устройства и проверить его возможности. Если *ptd* имеет значение NULL, объект должен игнорировать значение в *hicTargetDev* параметра.

*pExtentInfo*<br/>
Указывает на `DVEXTENTINFO` структура, задающая данных. `DVEXTENTINFO` Структуры:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Элемент структуры `dwExtentMode` может принимать одно из двух значений:

- DVEXTENT_CONTENT запрос, как элемент управления должен быть точно по размеру содержимого (snap размер)

- DVEXTENT_INTEGRAL при изменении размера, передать предлагаемый размер элемента управления

*psizel*<br/>
Указывает на изменение размера данных, возвращаемых элементом управления. Изменения размера возвращаемых данных имеет значение -1 для любого измерения, которая не была скорректирована.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если он успешно возвращает или изменяет размер; в противном случае 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, чтобы вернуть размер объекта отображения ближайшим к предлагаемый размер и экстент режим, в `DVEXTENTINFO` структуры. Реализация по умолчанию возвращает значение FALSE и делает каких-либо корректировок по размеру.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Вызывается платформой для получения набора предварительно определенных строк, представляющих возможные значения для свойства.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*pStringArray*<br/>
Массив строк для заполнения в возвращаемые значения.

*pCookieArray*<br/>
В массив DWORD заполнения в возвращаемые значения.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если элементы были добавлены *pStringArray* и *pCookieArray*.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления имеет свойство с помощью набора возможных значений, которые могут быть представлены строками. Для каждого элемента, добавляемого *pStringArray*, следует добавить соответствующий элемент «cookie», чтобы *pCookieArray.* Эти значения «cookie» могут передаваться позже платформой для `COleControl::OnGetPredefinedValue` функции.

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Вызывается платформой для получения значений, соответствующий одному из стандартных строк были возвращены переопределение `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*dwCookie*<br/>
Значение файла cookie, ранее возвращенный переопределение `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Указатель на `VARIANT` структуры, через который будет возвращаться значение свойства.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если значение вернулся в *lpvarOut*; в противном случае — 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Вызвано структурой в ответ в контейнер [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) запроса.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Параметры

*dwDrawAspect*<br/>
DWORD, описывающий форму или пропорции объекта, будет отображаться. Допустимые значения берутся из перечисления [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) или DVASPECT2.

*Индекс*<br/>
Часть объекта, который не представляет интереса. В настоящее время только значение -1 является допустимым.

*ptd*<br/>
Указывает на [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) структуру, определяющую целевое устройство, для которого следует вернуть размер объекта.

*lpsizel*<br/>
Указывает на расположение, где возвращается размер объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если экстент сведения успешно возвращен; в противном случае 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления использует два прохода Рисование, и его частей непрозрачный и прозрачный имеют разные измерения.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Вызвано структурой в ответ в контейнер `IViewObjectEx::GetRect` запроса.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
DWORD, описывающий форму или пропорции объекта, будет отображаться. Допустимые значения берутся из перечисления [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) или DVASPECT2:

- Прямоугольник, ограничивающий DVASPECT_CONTENT всего объекта. Верхний левый угол объекта источника и размер равен в той степени, возвращенный `GetViewExtent` *.*

- Объекты DVASPECT_OPAQUE с прямоугольной области непрозрачный возвращают этот прямоугольник. Другие ошибкой.

- DVASPECT_TRANSPARENT прямоугольник, охватывающий все части прозрачный или нерегулярным.

*pRect*<br/>
Указывает на [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) структура прямоугольника, в котором должен быть нарисован объект. Этот параметр определяет расположение и Растягивание объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если прямоугольник, размеры устанавливаются в объект успешно возвращен; в противном случае 0.

### <a name="remarks"></a>Примечания

Размер объекта преобразуется в `OnGetViewRect` в прямоугольник, начиная с определенной позиции (по умолчанию — в верхний левый угол отображения). Переопределите эту функцию, если элемент управления использует два прохода Рисование, и его частей непрозрачный и прозрачный имеют разные измерения.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Вызвано структурой в ответ в контейнер `IViewObjectEx::GetViewStatus` запроса.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Возвращаемое значение

Одно из значений перечисления Просмотр СОСТОЯНИЯ успешного выполнения; в противном случае 0. Возможные значения: любое сочетание следующих:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Объект полностью непрозрачен. Если этот бит не задано, объект содержит прозрачные части. Этот бит применяется только к аспекты, связанные с содержимым, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Объект имеет непрозрачный фон (состоящему в сплошным цветом, а не узором). Этот бит имеет смысл только в том случае, если VIEWSTATUS_OPAQUE устанавливается и применяется только к аспекты, связанные с содержимым, а не к DVASPECT_ICON или DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|Объект поддерживает DVASPECT_OPAQUE. Все методы IViewObjectEx, которые принимают вид рисования, как параметр может быть вызван этот аспект.|
|VIEWSTATUS_DVASPECTTRANSPARENT|Объект поддерживает DVASPECT_TRANSPARENT. Все `IViewObjectEx` методы, которые принимают вид рисования, как параметр может быть вызван этот аспект.|

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления использует два прохода рисование. Реализация по умолчанию возвращает VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Вызывается платформой при деактивации пользовательского интерфейса элемента управления.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Примечания

Реализация следует скрыть все панели инструментов, отображаемого элементом `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Вызывается контейнером для неактивного объекта при получении сообщения wm_mousemove и указатель мыши.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Объект, ограничивающий прямоугольник, в клиентских координатах содержащего его окна. Указывает объекту его точное положение и размер на экране при получил сообщение WM_MOUSEMOVE.

*x*<br/>
Координата x расположения указателя мыши в клиентских координатах содержащего его окна.

*y*<br/>
Координата y местоположения мыши в клиентских координатах содержащего его окна.

*dwKeyState*<br/>
Определяет текущее состояние клавиш клавиатуры на клавиатуре. Допустимые значения могут представлять собой сочетание любой из флагов MK_CONTROL, MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON и MK_RBUTTON.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что окно координатах клиентской области окна (в пикселях) используются для передачи позиции указателя мыши. Это стало возможным благодаря также передает ограничивающего прямоугольника объекта в одной и той же системе координат.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Вызывается контейнером для неактивного объекта, находящегося под указателем мыши на получение сообщения WM_SETCURSOR.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Объект, ограничивающий прямоугольник, в клиентских координатах содержащего его окна. Указывает объекту его точное положение и размер на экране при получил сообщение WM_SETCURSOR.

*x*<br/>
Координата x расположения указателя мыши в клиентских координатах содержащего его окна.

*y*<br/>
Координата y местоположения мыши в клиентских координатах содержащего его окна.

*dwMouseMsg*<br/>
Идентификатор сообщения мыши, относительно которой произошло WM_SETCURSOR.

*bSetAlways*<br/>
Указывает, должен ли объект установите курсор. Значение TRUE, если объект должен установить курсор; Если значение равно FALSE, курсор не обязана установите курсор и должен возвращать в этом случае значение S_FALSE.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что окно координатах клиентской области окна (в пикселях) используются для передачи позиции указателя мыши. Это стало возможным благодаря также передает ограничивающего прямоугольника объекта в одной и той же системе координат.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Вызвано структурой после обработки стандартное событие KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Значение виртуального кода клавиши нажатой клавише. Список стандартных коды виртуальных клавиш см. в разделе Winuser.h

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления необходим доступ к данные ключа после инициировать событие.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Вызывается структурой после акции, произошло событие KeyPress.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Содержит значение виртуального кода клавиши нажатой клавиши. Список стандартных коды виртуальных клавиш см. в разделе Winuser.h

### <a name="remarks"></a>Примечания

Обратите внимание, что *nChar* значение были изменены с помощью контейнера.

Переопределите эту функцию, если требуется уведомление после возникновения этого события.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Вызвано структурой после обработки стандартное событие KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Параметры

*nChar*<br/>
Значение виртуального кода клавиши нажатой клавише. Список стандартных коды виртуальных клавиш см. в разделе Winuser.h

*nShiftState*<br/>
Содержит сочетание следующих флагов:

- Была нажата клавиша SHIFT SHIFT_MASK, во время выполнения действия.

- Была нажата клавиша CTRL CTRL_MASK, во время выполнения действия.

- Была нажата клавиша ALT ALT_MASK, во время выполнения действия.

### <a name="remarks"></a>Примечания

Переопределите эту функцию, если элемент управления необходим доступ к данные ключа после инициировать событие.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Вызывается платформой для получения идентификатора класса страницы свойств, который реализует редактирования указанного свойства.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Параметры

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства элемента управления.

*lpclsid*<br/>
Указатель на `CLSID` структуры, через который будет возвращаться идентификатор класса.

*pbPageOptional*<br/>
Возвращает указывает, является ли использование странице указанное свойство является необязательным.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если идентификатор класса был возвращен в *lpclsid*; в противном случае — 0.

### <a name="remarks"></a>Примечания

Переопределите эту функцию для предоставления способ вызова страницы свойств элемента управления из обозревателя свойств контейнера.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Вызывается платформой, когда контейнер обнаружил, что была нажата назначенная клавиша элемента управления OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Параметры

*pMsg*<br/>
Указатель на сообщение Windows, созданное нажатием назначенной клавиши.

##  <a name="onproperties"></a>  COleControl::OnProperties

Вызывается платформой, когда контейнер вызвал команду properties для элемента управления.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpMsg*<br/>
Указатель на сообщение Windows, которое вызвало команду.

*hWndParent*<br/>
Дескриптор родительского окна элемента управления.

*lpRect*<br/>
Указатель на прямоугольник, используемые элементом управления в контейнере.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию отображает свойство модальное диалоговое окно.

Эта функция используется для отображения страницы свойств элемента управления. Вызвать `OnProperties` функцию, передавая дескриптор родительского элемента управления в *hWndParent* параметра. В этом случае значения *lpMsg* и *lpRect* параметры игнорируются.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Вызвано структурой в ответ в контейнер `IViewObjectEx::QueryHitPoint` запроса.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Указывает, как именно представляется объект. Допустимые значения берутся из перечисления [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) или DVASPECT2.

*pRectBounds*<br/>
Указатель на `RECT` структуры, указывающий ограничивающий прямоугольник клиентской области элемента управления OLE.

*ptlLoc*<br/>
Указатель на `POINT` структуры, указывающий точку, для проверки нажатия. Точка задается в координаты области клиента OLE.

*lCloseHint*<br/>
Расстояние, которое определяет, «закрыть» в точку проверки нажатия.

*pHitResult*<br/>
Указатель на результат нажатия запроса. Одно из следующих значений:

- HITRESULT_OUTSIDE *ptlLoc* находится за пределами OLE объекта, а не закрыто.

- HITRESULT_TRANSPARENT *ptlLoc* находится в границах объекта OLE, но не рядом с изображения. Например точку в середине прозрачного окружность может быть HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* внутри или вне OLE-объекта, но достаточно близко к объекту, чтобы считаться внутри. Это значение может использоваться в небольших, тонкая или подробные объектами. Даже если точка находится за пределами ограничивающего прямоугольника объекта может по-прежнему быть закрыть (это требуется для обращения небольшие объекты).

- HITRESULT_HIT *ptlLoc* находится в пределах изображения объекта.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если успешно, возвращается результат нажатия; в противном случае 0. Это перекрытие с область отображения элемента управления OLE.

### <a name="remarks"></a>Примечания

Запрашивает, перекрывает ли прямоугольник отображения объекта данная точка (достигает точки). `QueryHitPoint` можно переопределить для проверки попадания для непрямоугольных объектов.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Вызвано структурой в ответ в контейнер `IViewObjectEx::QueryHitRect` запроса.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Параметры

*dwAspect*<br/>
Указывает способ представления объекта. Допустимые значения берутся из перечисления [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) или DVASPECT2.

*pRectBounds*<br/>
Указатель на `RECT` структуры, указывающий ограничивающий прямоугольник клиентской области элемента управления OLE.

*prcLoc*<br/>
Указатель на `RECT` структура прямоугольника для проверки нажатия (перекрываются прямоугольник объекта), относительно верхнего левого угла объекта.

*lCloseHint*<br/>
Не используется.

*pHitResult*<br/>
Указатель на результат нажатия запроса. Одно из следующих значений:

- HITRESULT_OUTSIDE при попадании без точки в прямоугольнике, OLE-объекта.

- HITRESULT_HIT по крайней мере одна точка в прямоугольнике бы нажатия на объекте.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если успешно, возвращается результат нажатия; в противном случае 0.

### <a name="remarks"></a>Примечания

Запрашивает, перекрывает ли прямоугольник отображения объекта любой точки в данном прямоугольнике (достигает прямоугольник). `QueryHitRect` можно переопределить для проверки попадания для непрямоугольных объектов.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Вызывается платформой для извлечения данных в указанном формате.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, задающая формат, в котором запрашиваются сведения.

*lpStgMedium*<br/>
Указывает на [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) структуры, в котором они должны быть возвращены.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат входит один ранее размещен в объект элемента управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) или [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) функции-члены для отложенной обработки. Реализация по умолчанию эта функция вызывает `OnRenderFileData` или `OnRenderGlobalData`, соответственно, если предоставленный среда хранения представляет собой файл или в памяти. Если запрошенный формат CF_METAFILEPICT или форматом набора постоянные свойства, реализация по умолчанию отображает соответствующие данные и возвращает ненулевое значение. В противном случае возвращает значение 0 и не выполняет никаких действий.

Если *lpStgMedium "->" tymed* является TYMED_NULL, STGMEDIUM должен быть выделяется объектом и заполняется в соответствии с *lpFormatEtc "->" tymed*. В противном случае TYMED_NULL, STGMEDIUM должно быть заполнено на месте с данными.

Переопределите эту функцию для предоставления данных в затребованном формате и средний. В зависимости от данных может потребоваться переопределить один из других версий эта функция вместо этого. Если данные находятся в малых и фиксированный размер, переопределить `OnRenderGlobalData`. Если данные находятся в файле, или имеет переменный размер, переопределить `OnRenderFileData`.

Дополнительные сведения см. в разделе `FORMATETC` и `STGMEDIUM` структур в пакете Windows SDK.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Вызывается платформой для извлечения данных в указанном формате в том случае, если среда хранения представляет собой файл.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, задающая формат, в котором запрашиваются сведения.

*pFile*<br/>
Указывает на [CFile](../../mfc/reference/cfile-class.md) объект, в котором должен быть прорисован данные.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат входит один ранее размещен в объект элемента управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) функция-член для отложенной подготовки к просмотру. Реализация по умолчанию эта функция просто возвращает значение FALSE.

Переопределите эту функцию для предоставления данных в затребованном формате и средний. В зависимости от данных может потребоваться переопределить один из других версий эта функция вместо этого. Если вы хотите обрабатывать несколько решений по хранению данных, переопределите `OnRenderData`. Если данные находятся в файле, или имеет переменный размер, переопределить `OnRenderFileData`.

Дополнительные сведения см. в разделе `FORMATETC` структуры в пакете Windows SDK.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Вызывается платформой для извлечения данных в указанном формате, при глобальной памяти, заданную среду хранения.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указывает на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структура, задающая формат, в котором запрашиваются сведения.

*phGlobal*<br/>
Указывает дескриптор глобальной памяти, в котором они должны быть возвращены. Если памяти не будет выделена, этот параметр может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Указанный формат входит один ранее размещен в объект элемента управления с помощью [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) функция-член для отложенной подготовки к просмотру. Реализация по умолчанию эта функция просто возвращает значение FALSE.

Если *phGlobal* имеет значение NULL, то новый HGLOBAL должен выделить и возвращены в *phGlobal*. В противном случае HGLOBAL определяемое *phGlobal* должно быть заполнено данными. Объем данных, помещаются в HGLOBAL не должен превышать текущий размер блока памяти. Кроме того блок не может быть перемещен большего размера.

Переопределите эту функцию для предоставления данных в затребованном формате и средний. В зависимости от данных может потребоваться переопределить один из других версий эта функция вместо этого. Если вы хотите обрабатывать несколько решений по хранению данных, переопределите `OnRenderData`. Если данные находятся в файле, или имеет переменный размер, переопределить `OnRenderFileData`.

Дополнительные сведения см. в разделе `FORMATETC` структуры в пакете Windows SDK.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Вызывается платформой, когда свойства элемента управления должны быть установлены значения по умолчанию.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает [DoPropExchange](#dopropexchange), передав `CPropExchange` объект, ставший причиной свойства, чтобы задать значения по умолчанию.

Модуль записи элемента управления можно вставить код инициализации для элемента управления OLE в этом переопределяемый. Эта функция вызывается, когда [IPersistStream::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) или [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) в случае сбоя или [IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) или [IPersistStorage: : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) вызывается без вызова либо `IPersistStream::Load` или `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Вызывается платформой, когда контейнер элемента управления называется `IOleControl::SetClientSite` функции.

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Примечания

По умолчанию `OnSetClientSite` проверяет, загружаются ли свойства пути данных и если да, вызывает `DoDataPathPropExchange`.

Переопределите эту функцию для выполнения специальной обработки этого уведомления. В частности переопределения для данной функции следует вызвать базовый класс.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Вызывается платформой для замены данных элемента управления с заданными данными.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Параметры

*lpFormatEtc*<br/>
Указатель на [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) структуры, указывающий формат данных.

*lpStgMedium*<br/>
Указатель на [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) структуры, в которой хранятся данные.

*bRelease*<br/>
Значение TRUE, если элемент управления должен освободить среду хранения; Значение FALSE, если элемент управления не должен освободить среду хранения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если данные в свойстве постоянных формат, реализация по умолчанию соответствующим образом изменяет состояние элемента управления. В противном случае реализация по умолчанию ничего не делает. Если *bRelease* имеет значение TRUE, то вызов `ReleaseStgMedium` осуществляется; в противном случае не.

Переопределите эту функцию, чтобы заменить данные элемента управления с заданными данными.

Дополнительные сведения см. в разделе `FORMATETC` и `STGMEDIUM` структур в пакете Windows SDK.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Вызывается платформой, когда расширение элемента управления должен быть изменен, в результате обращения к [IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Параметры

*lpSizeL*<br/>
Указатель на `SIZEL` структуру, которая использует длинных целых чисел для представления ширину и высоту элемента управления, выраженный в единицах HIMETRIC.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменения размера был принят; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию обрабатывает изменение размера элемента управления области памяти. Если элемент управления является активным на месте, вызов в контейнер `OnPosRectChanged` затем выполняется.

Переопределите эту функцию, чтобы изменить значение по умолчанию изменения размера элемента управления.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Вызывается платформой для реализации вызов [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Параметры

*lpRectPos*<br/>
Указатель на `RECT` структура, указывающая новое положение и размер относительно контейнера элемента управления.

*lpRectClip*<br/>
Указатель на `RECT` структура, указывающая прямоугольную область, которую элемент управления будет обрезаться.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если изменение положения был принят; в противном случае 0.

### <a name="remarks"></a>Примечания

Реализация по умолчанию автоматически обрабатывает изменения положения и размеров окна элемента управления и возвращает значение TRUE.

Переопределите эту функцию, чтобы изменить поведение по умолчанию для данной функции.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Вызывается платформой, когда элемент управления будет активироваться через UI.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию не выполняет никаких действий.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Вызывается платформой при изменении акций значение свойства заголовок или текст.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Примечания

По умолчанию реализация вызывает `InvalidateControl`.

Переопределите эту функцию, если уведомление после изменения этого свойства требуется.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Вызвано структурой в ответ в контейнер `IOleInPlaceObjectWindowless::OnWindowMessage` запроса.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Параметры

*msg*<br/>
Идентификатор сообщения, что передается Windows.

*wParam*<br/>
Как передавать по Windows. Задает дополнительные сведения, относящиеся к сообщению. Содержимое этого параметра зависит от значения *msg* параметра.

*lParam*<br/>
Как передавать по Windows. Задает дополнительные сведения, относящиеся к сообщению. Содержимое этого параметра зависит от значения *msg* параметра.

*plResult*<br/>
Код результата для Windows. Указывает результат обработки сообщения и зависит от отправленного сообщения.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Обрабатывает сообщения окна для элементов управления без окон. `COleControl`в `OnWindowlessMessage` должен использоваться для сообщения окна, отличные от сообщения мыши и клавиатуры. `COleControl` предоставляет [SetCapture](#setcapture) и [SetFocus](#setfocus) специально для того, чтобы получить фокус клавиатуры и захват мыши для поддерживающих OLE-объекты.

Поскольку объектам без окон не имеют окна, они должны механизма, позволяющего сообщения об отправке контейнера к ним. Без окон OLE-объекта получает сообщения из своего контейнера с помощью `OnWindowMessage` метод `IOleInPlaceObjectWindowless` интерфейс (расширение [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) для поддержки без окон). `OnWindowMessage` не принимает `HWND` параметра.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Преобразует координаты *pPoint* в координатах клиентской области окна.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Параметры

*lprcBounds*<br/>
Указатель на границы элемента управления OLE в контейнере. Область весь элемент управления, включая границы и полосы прокрутки, но не клиентской области.

*pPoint*<br/>
Указатель на родительский (контейнер) точки быть преобразована в координатах клиентской области элемента управления.

*bHitTest*<br/>
Указывает ли попадания должен выполняться в точке.

### <a name="return-value"></a>Возвращаемое значение

Если *bHitTest* имеет значение FALSE, возвращает HTNOWHERE. Если *bHitTest* имеет значение TRUE, возвращает расположение, в котором родительский (контейнер) точки попали в клиентской области элемента управления OLE, а также является одним из следующих мыши нажатия значения:

- HTBORDER в границы окна, которое не имеет границы изменения размера.

- HTBOTTOM в нижней части окна горизонтальной границы.

- HTBOTTOMLEFT в левом нижнем углу границы окна.

- HTBOTTOMRIGHT в правом нижнем углу границы окна.

- HTCAPTION в области заголовка окна.

- HTCLIENT в клиентской области.

- HTERROR на заднем плане экрана или на разделительной линии между windows (так же, как HTNOWHERE кроме тех, которые `DefWndProc` функция Windows создает звуковой сигнал в случае ошибки).

- HTGROWBOX в поле размер.

- HTHSCROLL в горизонтальной полосы прокрутки.

- HTLEFT в левой границы окна.

- Кнопка HTMAXBUTTON в максимизации.

- HTMENU в области меню.

- Кнопка HTMINBUTTON в свести к минимуму.

- HTNOWHERE на заднем плане экрана или на разделительной линии между окнами.

- Кнопка HTREDUCE в свести к минимуму.

- HTRIGHT в правой границы окна.

- HTSIZE в поле размер (то же, как HTGROWBOX).

- HTSYSMENU в оконном меню или закрыть кнопки в дочернем окне.

- HTTOP в верхнем горизонтальной границы окна.

- HTTOPLEFT в левом верхнем углу границы окна.

- HTTOPRIGHT в правом верхнем углу границы окна.

- HTTRANSPARENT в окне, в данный момент закрывается другим окном.

- HTVSCROLL в вертикальной полосы прокрутки.

- Кнопка HTZOOM в максимизации.

### <a name="remarks"></a>Примечания

На входе *pPoint* относительно начала координат родительского элемента (верхний левый угол контейнера). На выходе *pPoint* относительно начала координат клиентской области элемента управления OLE (верхний левый угол клиентской области элемента управления).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Уведомляет контейнер, что модальное диалоговое окно было закрыто.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*hWndParent*<br/>
Дескриптор родительского окна модальное диалоговое окно.

### <a name="remarks"></a>Примечания

Эта функция вызывается после отображения любое модальное диалоговое окно. Таким образом, чтобы контейнер можно включить любой окон верхнего уровня, отключил эту функцию необходимо вызывать `PreModalDialog`. Эта функция должно быть связано с вызовом `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Уведомляет контейнер, в котором отображается модальное диалоговое окно.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Параметры

*hWndParent*<br/>
Дескриптор родительского окна модальное диалоговое окно.

### <a name="remarks"></a>Примечания

Эта функция вызывается перед отображением любое модальное диалоговое окно. Эту функцию необходимо вызывать, чтобы контейнер можно отключить все его окон верхнего уровня. После отображения модального диалогового окна необходимо вызвать `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Удаляет и повторно создает окна элемента управления.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Примечания

Это может быть необходимо, если вам нужно изменить битов стиля окна.

##  <a name="refresh"></a>  COleControl::Refresh

Принудительно перекрашивает элемента управления OLE.

```
void Refresh();
```

### <a name="remarks"></a>Примечания

Эта функция поддерживается `COleControl` базовый класс как биржевые метод, называемый обновления. Это позволяет пользователям вашего элемента управления OLE для перерисовки элемента управления в определенное время. Дополнительные сведения об этом методе см. в статье [элементы управления ActiveX: Методы](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Отпускает захват мыши.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Если в настоящее время элемент управления имеет захват мыши, захвата освобождается. В противном случае эта функция не оказывает влияния.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Освобождает контекст устройства отображения контейнера элемента управления без окон, освобождение контекст устройства для использования другими приложениями.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Определяет контекст устройства контейнером снятия.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Примечания

Приложение должно вызвать `ReleaseDC` для каждого вызова [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Задает родительский объект элемента управления.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Параметры

*hWndOuter*<br/>
Дескриптор окна элемента управления.

*hWndParent*<br/>
Дескриптор нового родительского окна.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию, чтобы сбросить родительского окна элемента управления.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Инициализирует состояние объекта `COleControl` стандартные свойства к значениям по умолчанию.

```
void ResetStockProps();
```

### <a name="remarks"></a>Примечания

Это следующие свойства: Внешний вид, BackColor, BorderStyle, заголовок, Enabled, шрифт, цвет переднего плана, hWnd и текст. Описание стандартных свойств, см. в разделе [элементы управления ActiveX: Добавление стандартных свойств](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Можно повысить производительность двоичных инициализации элемента управления с помощью `ResetStockProps` и `ResetVersion` для переопределения `COleControl::OnResetState`. См. следующий пример. Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Инициализирует номер версии до указанного значения.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Параметры

*dwVersionDefault*<br/>
Номер версии, назначенный элементу управления.

### <a name="remarks"></a>Примечания

Можно повысить производительность двоичных инициализации элемента управления с помощью `ResetVersion` и `ResetStockProps` для переопределения `COleControl::OnResetState`. См. пример в [ResetStockProps](#resetstockprops). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Позволяет безоконному объекту OLE прокручивать область в пределах своего активного изображения на месте на экране.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Параметры

*xAmount*<br/>
Указывает объем в единицах устройства, горизонтальной прокрутки. Этот параметр должен иметь отрицательное значение, чтобы прокрутить влево.

*yAmount*<br/>
Указывает объем в единицах устройства, вертикальной прокрутки. Этот параметр должен быть отрицательным для прокрутки вверх.

*lpRect*<br/>
Указывает на [CRect](../../atl-mfc-shared/reference/crect-class.md) объект или структуру RECT, которая задает часть клиентской области объекта OLE для прокрутки, указанный в клиентских координатах содержащего его окна. Если *lpRect* имеет значение NULL, вышел за весь объект OLE клиентской области.

*lpClipRect*<br/>
Указывает на `CRect` объекта или `RECT` структуру, которая задает прямоугольник отсечения для. Прокручены только пиксели внутри прямоугольника. BITS вне прямоугольника не затрагиваются, даже если они находятся в *lpRect* прямоугольник. Если *lpClipRect* имеет значение NULL, прямоугольник прокрутки выполняется отсечение.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Выбирает шрифт в контексте устройства.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Указатель на объект контекста устройства.

*fontHolder*<br/>
Ссылка на [CFontHolder](../../mfc/reference/cfontholder-class.md) объект, представляющий шрифт для выбора.

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранный шрифт. Когда вызывающий объект будет завершено все операции рисования, использующие *fontHolder,* ранее выбранный шрифт должен установить заново, передавая его в качестве параметра [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Выбирает свойство Font в контексте устройства.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Параметры

*pDC*<br/>
Контекст устройства, в который будет выбран шрифт.

### <a name="return-value"></a>Возвращаемое значение

Указатель на ранее выбранным `CFont` объекта. Следует использовать [CDC::SelectObject](../../mfc/reference/cdc-class.md#selectobject) для выбора этого шрифта обратно в контекст устройства, когда вы закончите.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Выполняет сериализацию или инициализирует состояние объекта Отображаемое пространство, выделенное для элемента управления.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` сериализуемый с клиента или на объект.

### <a name="remarks"></a>Примечания

Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeExtent`, `SerializeStockProps`, и `SerializeVersion` для переопределения `COleControl::Serialize`. См. следующий пример. Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Пример

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Выполняет сериализацию или инициализирует состояние объекта `COleControl` стандартные свойства: Внешний вид, BackColor, BorderStyle, заголовок, включена, шрифт, цвет переднего плана и текста.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` сериализуемый с клиента или на объект.

### <a name="remarks"></a>Примечания

Описание стандартных свойств, см. в разделе [элементы управления ActiveX: Добавление стандартных свойств](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeStockProps`, `SerializeExtent`, и `SerializeVersion` для переопределения `COleControl::Serialize`. Например, см. в разделе кода, в [SerializeExtent](#serializeextent). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Выполняет сериализацию или инициализирует состояние объекта сведений о версии элемента управления.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Параметры

*ar*<br/>
Объект `CArchive` сериализуемый с клиента или на объект.

*dwVersionDefault*<br/>
Текущий номер версии элемента управления.

*bConvert*<br/>
Указывает, постоянные данные должны ли преобразовываться в формат последней версии при его сохранении, или изменяются в тот же формат, что при его загрузке.

### <a name="return-value"></a>Возвращаемое значение

Номер версии элемента управления. Если загружает указанный архив `SerializeVersion` возвращает версии, загруженной из этого архива. В противном случае возвращается текущая загруженная версия.

### <a name="remarks"></a>Примечания

Можно повысить производительность двоичных сохраняемости элемента управления с помощью `SerializeVersion`, `SerializeExtent`, и `SerializeStockProps` для переопределения `COleControl::Serialize`. Например, см. в разделе кода, в [SerializeExtent](#serializeextent). Дополнительные сведения об оптимизации инициализации см. в разделе [элементы управления ActiveX: Оптимизация](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Задает значение акций свойства внешнего вида элемента управления.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Параметры

*sAppearance*<br/>
Объект **короткие** (VT_I2) значение, используемое для внешнего вида элемента управления. Нулевое значение задает внешний вид элемента управления для неструктурированных и значение 1 задает внешний вид элемента управления с трехмерной графикой.

### <a name="remarks"></a>Примечания

Дополнительные сведения о стандартных свойств, см. в разделе [элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Задает акций значение свойства BackColor элемента управления.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Параметры

*dwBackColor*<br/>
Значение OLE_COLOR, используемого для фона рисования элемента управления.

### <a name="remarks"></a>Примечания

Дополнительные сведения об использовании этого свойства и других связанных свойств, см. в статье [элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Задает значение свойства BorderStyle акций вашего элемента управления.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Параметры

*sBorderStyle*<br/>
Новый стиль границы для элемента управления; 0 указывает без рамки, а 1 обычной границу.

### <a name="remarks"></a>Примечания

Затем будет создан повторно окна элемента управления и `OnBorderStyleChanged` вызывается.

##  <a name="setcapture"></a>  COleControl::SetCapture

Вызывает окна контейнера элемента управления необходимо выполнить владение и захват мыши на имени элемента управления.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, ранее получивший ввод от мыши.

### <a name="remarks"></a>Примечания

Если элемент управления активирован и без окон, эта функция преобразует окна контейнера элемента управления для выполнения владение и захват мыши, на основе имени элемента управления. В противном случае эта функция приводит к самим вступили владение захвата мыши элементом управления (то же, что `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Задает размер окна элемента управления OLE и уведомляет контейнер, который изменяет сайт элемента управления.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Параметры

*cx*<br/>
Ширина нового элемента управления в пикселях.

*CY*<br/>
Задает новую высоту элемента управления в пикселях.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Эта функция не должна использоваться в конструкторе элемента управления.

Обратите внимание, что все координаты для элемента управления windows указываются относительно верхнего левого угла элемента управления.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Задает значение свойства Enabled элемента управления акции.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Параметры

*bEnabled*<br/>
Значение TRUE, если элемент управления требуется включить; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

После установки этого свойства `OnEnabledChange` вызывается.

##  <a name="setfocus"></a>  COleControl::SetFocus

Вызывает окна контейнера элемента управления для выполнения владение фокус ввода на основе имени элемента управления.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на `CWnd` объект окна, ранее имевший фокус, или значение NULL, если такое окно не входных данных.

### <a name="remarks"></a>Примечания

Если элемент управления активирован и без окон, эта функция преобразует окна контейнера элемента управления, чтобы воспользоваться владение фокус ввода, от имени элемента управления. Фокус ввода направляет окна контейнера ввода с клавиатуры, а контейнер направляет все сообщения клавиатуры последующих в OLE-объекта, который вызывает `SetFocus`. Любое окно, ранее имевший фокус ввода теряет его.

Если элемент управления не является безоконного, эта функция вызывает сам вступили владение фокус ввода (то же, что `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Задает свойство Font элемента управления.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Параметры

*pFontDisp*<br/>
Указатель на интерфейс диспетчеризации шрифта.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Задает акций значение свойства ForeColor элемента управления.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Параметры

*dwForeColor*<br/>
Значение типа OLE_COLOR, используемый для рисования элемента управления переднего плана.

### <a name="remarks"></a>Примечания

Дополнительные сведения об использовании этого свойства и других связанных свойств, см. в статье [элементы управления ActiveX: Свойства](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Вызывается платформой для инициализации список форматов данных, поддерживаемое элементом управления.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Примечания

Реализация по умолчанию задает два формата: CF_METAFILEPICT и свойство постоянное значение.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Задает размер элемента управления OLE при первом отображении в контейнере.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Параметры

*cx*<br/>
Начальная ширина элемента управления OLE в пикселях.

*CY*<br/>
Исходную высоту элемента управления OLE в пикселях.

### <a name="remarks"></a>Примечания

Вызовите эту функцию в ваш конструктор, чтобы задать начальный размер элемента управления. Начальный размер измеряется в единицах устройства или пикселей. Рекомендуется выполнить, этот вызов в конструктор элемента управления.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Изменяет измененное состояние элемента управления.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Параметры

*bModified*<br/>
Новое значение для элемента управления модифицированная флаг. Значение TRUE указывает, что состояние элемента управления был изменен; Значение FALSE указывает, что состояние элемента управления только что был сохранен.

### <a name="remarks"></a>Примечания

Вызовите эту функцию, каждый раз, когда происходит изменение, может повлиять на постоянное состояние элемента управления. Например, если изменяется значение постоянные свойства, вызовите эту функцию с *bModified* **TRUE**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Указывает, что запрос на редактирование произошел сбой.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию при `BoundPropertyRequestEdit` завершается ошибкой. Эта функция создает исключение типа `COleDispScodeException` для указания, что не была разрешена операция set.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Предотвращает изменение значения свойства элемента управления пользователем.

```
void SetNotSupported();
```

### <a name="remarks"></a>Примечания

Вызывайте эту функцию вместо функции Set любого свойства, где не поддерживается изменение значения свойства пользователем элемента управления. Примером может служить свойство, которое доступно только для чтения.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Задает координаты прямоугольника элемента управления относительно контейнера, выраженный в единицах устройства.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Параметры

*lpRect*<br/>
Указатель на прямоугольник, содержащий новые координаты элемента управления относительно контейнера.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если вызов был успешным; в противном случае 0.

### <a name="remarks"></a>Примечания

Если элемент управления является открытым, изменения ее размера; в противном случае контейнера `OnPosRectChanged` функция вызывается.

##  <a name="settext"></a>  COleControl::SetText

Задает значение свойства элемента управления акций заголовок или текст.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Параметры

*pszText*<br/>
Указатель на строку символов.

### <a name="remarks"></a>Примечания

Обратите внимание на то, что стандартные свойства заголовок и текст сопоставлены с то же значение. Это означает, что любые изменения любого из этих свойств автоматически произойдет Замена значения оба свойства. Как правило элемент управления должен поддерживать заголовок акции или свойство Text, но не оба.

##  <a name="throwerror"></a>  COleControl::ThrowError

Сообщает о возникновении ошибки в элементе управления.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Параметры

*SC*<br/>
Значение кода состояния, который требуется получить сведения об. Полный список возможных кодов, см. в статье [элементы управления ActiveX: Дополнительные разделы](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
Идентификатор ресурса строки, исключения должна быть зафиксирована.

*nHelpID*<br/>
Идентификатор справки раздела для создания отчета.

*pszDescription*<br/>
Строка, содержащая описание исключения возвращаются.

### <a name="remarks"></a>Примечания

Эта функция должна вызываться только из внутри функции Get или Set для свойства OLE или реализации метод автоматизации OLE. Если вам нужно сообщить ошибки, возникающие в другое время, должен срабатывать стандартное событие ошибки.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Значения между единицах HIMETRIC и единицах собственного контейнера координат преобразований.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Параметры

*lpptlHimetric*<br/>
Указатель на `POINTL` структура, содержащая координаты в единицах HIMETRIC.

*lpptfContainer*<br/>
Указатель на `POINTF` структура, содержащая координаты в размер единицы контейнера.

*flags*<br/>
Сочетание следующих значений:

- Позиция XFORMCOORDS_POSITION объект в контейнере.

- Размер XFORMCOORDS_SIZE объект в контейнере.

- Единицах HIMETRIC преобразования XFORMCOORDS_HIMETRICTOCONTAINER единиц контейнера.

- XFORMCOORDS_CONTAINERTOHIMETRIC преобразование контейнера единицах в единицы HIMETRIC.

### <a name="remarks"></a>Примечания

Первые два флаги, XFORMCOORDS_POSITION и XFORMCOORDS_SIZE, указывают ли координаты должны обрабатываться как позиция или размер. Оставшиеся два флага указывают направление преобразования.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Преобразует значение цвета из типа данных OLE_COLOR [COLORREF](/windows/desktop/gdi/colorref) тип данных.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Параметры

*clrColor*<br/>
Тип данных OLE_COLOR. Дополнительные сведения см. в разделе Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) функции.

*hpal*<br/>
Дескриптор палитры необязательно; может иметь значение NULL.

### <a name="return-value"></a>Возвращаемое значение

Значение 32-разрядный цвет RGB (красный, зеленый, синий), определяющий сплошной цвет ближайший к *clrColor* значение, которое может представлять устройства.

### <a name="remarks"></a>Примечания

Эта функция полезна для преобразования стандартных свойств цвет переднего плана и цвет фона для COLORREF типы, используемые [CDC](../../mfc/reference/cdc-class.md) функций-членов.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Определяет, должен ли элемент управления использовать значения свойств окружения как значения по умолчанию, когда впоследствии он загружается из постоянного состояния.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение указывает, что внешние свойства будет действителен; в противном случае внешние свойства не действительна.

### <a name="remarks"></a>Примечания

В некоторые контейнеры, элемент управления может не иметь доступа к свойствам окружения при первом вызове переопределение метода `COleControl::DoPropExchange`. Это происходит, если контейнер вызывает [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) или [IPersistStorage::Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) до вызова метода [IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (то есть, если это не так учитывает бит OLEMISC_SETCLIENTSITEFIRST состояния).

##  <a name="windowproc"></a>  COleControl::WindowProc

Содержит процедуры Windows `COleControl` объекта.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Параметры

*message*<br/>
Задает сообщение Windows для обработки.

*wParam*<br/>
Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.

*lParam*<br/>
Предоставляет дополнительные сведения, используемые при обработке сообщения. Значение параметра зависит от сообщения.

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение отправляется сообщение.

### <a name="remarks"></a>Примечания

Вызывайте эту функцию для отправки определенных сообщений через схему сообщений элемента управления.

## <a name="see-also"></a>См. также

[Пример CIRC3 MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример MFC TESTHELP](../../overview/visual-cpp-samples.md)<br/>
[Класс COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Класс CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Класс CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
