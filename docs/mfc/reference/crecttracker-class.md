---
description: 'Дополнительные сведения о: Кректтраккер Class'
title: Класс Кректтраккер
ms.date: 11/19/2018
f1_keywords:
- CRectTracker
- AFXEXT/CRectTracker
- AFXEXT/CRectTracker::CRectTracker
- AFXEXT/CRectTracker::AdjustRect
- AFXEXT/CRectTracker::Draw
- AFXEXT/CRectTracker::DrawTrackerRect
- AFXEXT/CRectTracker::GetHandleMask
- AFXEXT/CRectTracker::GetTrueRect
- AFXEXT/CRectTracker::HitTest
- AFXEXT/CRectTracker::NormalizeHit
- AFXEXT/CRectTracker::OnChangedRect
- AFXEXT/CRectTracker::SetCursor
- AFXEXT/CRectTracker::Track
- AFXEXT/CRectTracker::TrackRubberBand
- AFXEXT/CRectTracker::m_nHandleSize
- AFXEXT/CRectTracker::m_nStyle
- AFXEXT/CRectTracker::m_rect
- AFXEXT/CRectTracker::m_sizeMin
helpviewer_keywords:
- CRectTracker [MFC], CRectTracker
- CRectTracker [MFC], AdjustRect
- CRectTracker [MFC], Draw
- CRectTracker [MFC], DrawTrackerRect
- CRectTracker [MFC], GetHandleMask
- CRectTracker [MFC], GetTrueRect
- CRectTracker [MFC], HitTest
- CRectTracker [MFC], NormalizeHit
- CRectTracker [MFC], OnChangedRect
- CRectTracker [MFC], SetCursor
- CRectTracker [MFC], Track
- CRectTracker [MFC], TrackRubberBand
- CRectTracker [MFC], m_nHandleSize
- CRectTracker [MFC], m_nStyle
- CRectTracker [MFC], m_rect
- CRectTracker [MFC], m_sizeMin
ms.assetid: 99caa7f2-3c0d-4a42-bbee-e5d1d342d4ee
ms.openlocfilehash: 8406b6b45a99ca2e1816cb650f243fcea2db8ddc
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97343024"
---
# <a name="crecttracker-class"></a>Класс Кректтраккер

Позволяет отображать, перемещать и изменять размеры элементов различными способами.

## <a name="syntax"></a>Синтаксис

```
class CRectTracker
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Кректтраккер:: Кректтраккер](#crecttracker)|Формирует объект `CRectTracker`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Кректтраккер:: Аджустрект](#adjustrect)|Вызывается при изменении размера прямоугольника.|
|[Кректтраккер::D RAW](#draw)|Визуализирует прямоугольник.|
|[Кректтраккер::D Равтраккеррект](#drawtrackerrect)|Вызывается при рисовании границы `CRectTracker` объекта.|
|[Кректтраккер:: Жесандлемаск](#gethandlemask)|Вызывается для получения маски для `CRectTracker` маркеров изменения размера элемента.|
|[Кректтраккер:: Жеттруерект](#gettruerect)|Возвращает ширину и высоту прямоугольника, включая маркеры изменения размера.|
|[Кректтраккер:: HitTest](#hittest)|Возвращает текущую позицию курсора, связанного с `CRectTracker` объектом.|
|[Кректтраккер:: Нормализехит](#normalizehit)|Нормализует код проверки нажатия.|
|[Кректтраккер:: Ончанжедрект](#onchangedrect)|Вызывается при изменении размера или перемещении прямоугольника.|
|[Кректтраккер:: Сеткурсор](#setcursor)|Задает курсор в зависимости от его положения в прямоугольнике.|
|[Кректтраккер:: Track](#track)|Позволяет пользователю управлять прямоугольником.|
|[Кректтраккер:: Траккруббербанд](#trackrubberband)|Позволяет пользователю «резиновой» выбор.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Кректтраккер:: m_nHandleSize](#m_nhandlesize)|Определяет размер маркеров изменения размера.|
|[Кректтраккер:: m_nStyle](#m_nstyle)|Текущие стили средства записи.|
|[Кректтраккер:: m_rect](#m_rect)|Текущая координата (в пикселях) прямоугольника.|
|[Кректтраккер:: m_sizeMin](#m_sizemin)|Определяет минимальную ширину и высоту прямоугольника.|

## <a name="remarks"></a>Комментарии

`CRectTracker` не имеет базового класса.

Хотя `CRectTracker` класс предназначен для того, чтобы пользователь мог взаимодействовать с ЭЛЕМЕНТАМИ OLE с помощью графического интерфейса, его использование не ограничено приложениями с поддержкой OLE. Его можно использовать в любом месте, где требуется пользовательский интерфейс.

`CRectTracker` границы могут быть сплошными или пунктирными линиями. Элементу можно присвоить штриховую границу или наложенный узор, чтобы указать различные состояния элемента. Можно разместить восемь маркеров изменения размера либо снаружи, либо внутренней границы элемента. (Описание дескрипторов изменения размера см. в разделе [жесандлемаск](#gethandlemask).) Наконец, `CRectTracker` компонент позволяет изменить ориентацию элемента во время изменения размера.

Чтобы использовать `CRectTracker` , создайте `CRectTracker` объект и укажите, какие состояния дисплея инициализируются. Затем можно использовать этот интерфейс, чтобы предоставить пользователю визуальный отзыв о текущем состоянии элемента OLE, связанного с `CRectTracker` объектом.

Дополнительные сведения об использовании см `CRectTracker` . в разделе "средства [мониторинга](../../mfc/trackers.md)статей".

## <a name="inheritance-hierarchy"></a>Иерархия наследования

`CRectTracker`

## <a name="requirements"></a>Требования

**Заголовок:** афксекст. h

## <a name="crecttrackeradjustrect"></a><a name="adjustrect"></a> Кректтраккер:: Аджустрект

Вызывается структурой при изменении размера прямоугольника отслеживания с помощью маркера изменения размера.

```
virtual void AdjustRect(
    int nHandle,
    LPRECT lpRect);
```

### <a name="parameters"></a>Параметры

*нхандле*<br/>
Индекс используемого маркера.

*лпрект*<br/>
Указатель на текущий размер прямоугольника. (Размер прямоугольника определяется высотой и шириной.)

### <a name="remarks"></a>Комментарии

Поведение этой функции по умолчанию позволяет изменять ориентацию прямоугольника только в том случае `Track` , когда и `TrackRubberBand` вызываются с помощью инвертирования разрешенных.

Переопределите эту функцию, чтобы управлять настройкой прямоугольника отслеживания во время операции перетаскивания. Один из способов — настроить координаты, заданные параметром *лпрект* , перед возвратом.

Специальные функции, которые не поддерживаются напрямую `CRectTracker` , такие как «привязка-сетка» или «сохранение-пропорции», можно реализовать путем переопределения этой функции.

## <a name="crecttrackercrecttracker"></a><a name="crecttracker"></a> Кректтраккер:: Кректтраккер

Создает и инициализирует объект `CRectTracker`.

```
CRectTracker();

CRectTracker(
    LPCRECT lpSrcRect,
    UINT nStyle);
```

### <a name="parameters"></a>Параметры

*лпсркрект*<br/>
Координаты объекта Rectangle.

*nStyle*<br/>
Задает стиль `CRectTracker` объекта. Поддерживаются следующие стили:

- `CRectTracker::solidLine` Используйте сплошную линию для границы прямоугольника.

- `CRectTracker::dottedLine` Используйте пунктирную линию для границы прямоугольника.

- `CRectTracker::hatchedBorder` Используйте штриховую схему для границы прямоугольника.

- `CRectTracker::resizeInside` Изменение размера маркеров, расположенных внутри прямоугольника.

- `CRectTracker::resizeOutside` Маркеры изменения размера, расположенные за пределами прямоугольника.

- `CRectTracker::hatchInside` Заштрихованный шаблон охватывает весь прямоугольник.

### <a name="remarks"></a>Комментарии

Конструктор по умолчанию инициализирует `CRectTracker` объект значениями из *лпсркрект* и инициализирует другие размеры до системных значений по умолчанию. Если объект создается без параметров, `m_rect` `m_nStyle` элементы данных и не инициализируются.

## <a name="crecttrackerdraw"></a><a name="draw"></a> Кректтраккер::D RAW

Вызовите эту функцию, чтобы нарисовать внешние линии прямоугольника и внутреннюю область.

```cpp
void Draw(CDC* pDC) const;
```

### <a name="parameters"></a>Параметры

*Хозяин*<br/>
Указатель на контекст устройства, на котором производится рисование.

### <a name="remarks"></a>Комментарии

Стиль инспектора определяет, как выполняется рисование. `CRectTracker`Дополнительные сведения о доступных стилях см. в описании конструктора.

## <a name="crecttrackerdrawtrackerrect"></a><a name="drawtrackerrect"></a> Кректтраккер::D Равтраккеррект

Вызывается платформой при каждом изменении расположения средства записи в `Track` `TrackRubberBand` функции элемента или.

```
virtual void DrawTrackerRect(
    LPCRECT lpRect,
    CWnd* pWndClipTo,
    CDC* pDC,
    CWnd* pWnd);
```

### <a name="parameters"></a>Параметры

*лпрект*<br/>
Указатель на объект `RECT` , содержащий прямоугольник для рисования.

*пвндклипто*<br/>
Указатель на окно, используемое при обрезке прямоугольника.

*Хозяин*<br/>
Указатель на контекст устройства, на котором производится рисование.

*Приводится*<br/>
Указатель на окно, в котором будет выполняться рисование.

### <a name="remarks"></a>Комментарии

Реализация по умолчанию вызывает метод `CDC::DrawFocusRect` , который рисует пунктирный прямоугольник.

Переопределите эту функцию, чтобы обеспечить различные отзывы во время операции отслеживания.

## <a name="crecttrackergethandlemask"></a><a name="gethandlemask"></a> Кректтраккер:: Жесандлемаск

Платформа вызывает эту функцию-член для получения маски для маркеров изменения размера прямоугольника.

```
virtual UINT GetHandleMask() const;
```

### <a name="return-value"></a>Возвращаемое значение

Маска для `CRectTracker` маркеров изменения размера элемента.

### <a name="remarks"></a>Комментарии

Маркеры изменения размера отображаются на сторонах и углах прямоугольника и позволяют пользователю управлять формой и размером прямоугольника.

Прямоугольник имеет 8 маркеров изменения размера, пронумерованных 0-7. Каждый маркер изменения размера представлен битом маски; значение этого бита равно 2 ^ *n*, где *n* — это номер маркера изменения размера. Биты 0-3 соответствуют маркерам изменения размера углов, начиная с верхнего левого угла перемещения по часовой стрелке. Биты 4-7 соответствуют маркерам изменения размера на стороне, начиная с самого верхнего движения по часовой стрелке. На следующем рисунке показаны маркеры изменения размера прямоугольника и соответствующие им номера дескрипторов изменения размера и значения:

![Изменение размера номеров маркеров](../../mfc/reference/media/vc35dp1.gif "Числа маркера изменения размера")

Реализация по умолчанию `GetHandleMask` возвращает маску битов, чтобы отображались маркеры изменения размера. Если один бит включен, будет нарисован соответствующий маркер изменения размера.

Переопределите эту функцию члена, чтобы скрыть или показать указанные маркеры изменения размера.

## <a name="crecttrackergettruerect"></a><a name="gettruerect"></a> Кректтраккер:: Жеттруерект

Вызовите эту функцию, чтобы получить координаты прямоугольника.

```cpp
void GetTrueRect(LPRECT lpTrueRect) const;
```

### <a name="parameters"></a>Параметры

*лптруерект*<br/>
Указатель на `RECT` структуру, которая будет содержать координаты устройства `CRectTracker` объекта.

### <a name="remarks"></a>Комментарии

Размеры прямоугольника включают высоту и ширину всех маркеров изменения размера, расположенных на внешней границе. После возврата *лптруерект* всегда является нормализованным прямоугольником в координатах устройства.

## <a name="crecttrackerhittest"></a><a name="hittest"></a> Кректтраккер:: HitTest

Вызовите эту функцию, чтобы выяснить, извлечен ли пользователем маркер изменения размера.

```
int HitTest(CPoint point) const;
```

### <a name="parameters"></a>Параметры

*точки*<br/>
Точка в координатах устройства для проверки.

### <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение основано на перечислимом типе `CRectTracker::TrackerHit` и может иметь одно из следующих значений:

- `CRectTracker::hitNothing` -1

- `CRectTracker::hitTopLeft` 0

- `CRectTracker::hitTopRight` одного

- `CRectTracker::hitBottomRight` открыт

- `CRectTracker::hitBottomLeft` 3-5

- `CRectTracker::hitTop` 4

- `CRectTracker::hitRight` 5.0

- `CRectTracker::hitBottom` 1-6

- `CRectTracker::hitLeft` 7

- `CRectTracker::hitMiddle` 8

## <a name="crecttrackerm_nhandlesize"></a><a name="m_nhandlesize"></a> Кректтраккер:: m_nHandleSize

Размер `CRectTracker` дескрипторов изменения размера в пикселях.

```
int m_nHandleSize;
```

### <a name="remarks"></a>Комментарии

Инициализируется с системным значением по умолчанию.

## <a name="crecttrackerm_rect"></a><a name="m_rect"></a> Кректтраккер:: m_rect

Текущее расположение прямоугольника в координатах клиента (в пикселях).

```
CRect m_rect;
```

## <a name="crecttrackerm_sizemin"></a><a name="m_sizemin"></a> Кректтраккер:: m_sizeMin

Минимальный размер прямоугольника.

```
CSize m_sizeMin;
```

### <a name="remarks"></a>Комментарии

И значения по умолчанию, `cx` и `cy` , рассчитываются из системного значения по умолчанию для ширины границы. Этот элемент данных используется только `AdjustRect` функцией-членом.

## <a name="crecttrackerm_nstyle"></a><a name="m_nstyle"></a> Кректтраккер:: m_nStyle

Текущий стиль прямоугольника.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Комментарии

Список возможных стилей см. в разделе [кректтраккер:: кректтраккер](#crecttracker) .

## <a name="crecttrackernormalizehit"></a><a name="normalizehit"></a> Кректтраккер:: Нормализехит

Вызовите эту функцию для преобразования потенциально инвертированного маркера.

```
int NormalizeHit(int nHandle) const;
```

### <a name="parameters"></a>Параметры

*нхандле*<br/>
Маркер, выбранный пользователем.

### <a name="return-value"></a>Возвращаемое значение

Индекс нормализованного маркера.

### <a name="remarks"></a>Комментарии

Когда `CRectTracker::Track` или `CRectTracker::TrackRubberBand` вызывается с разрешенным инвертированием, прямоугольник может быть инвертирован по оси x, оси y или обоим. В этом случае `HitTest` Возвращает дескрипторы, которые также будут инвертированы по отношению к прямоугольнику. Это не подходит для отображения обратной связи с курсором, так как обратная связь зависит от положения экрана прямоугольника, а не от части структуры данных в прямоугольнике, которая будет изменена.

## <a name="crecttrackeronchangedrect"></a><a name="onchangedrect"></a> Кректтраккер:: Ончанжедрект

Вызывается структурой всякий раз, когда прямоугольник средства записи изменился во время вызова `Track` .

```
virtual void OnChangedRect(const CRect& rectOld);
```

### <a name="parameters"></a>Параметры

*ректолд*<br/>
Содержит старые координаты устройства `CRectTracker` объекта.

### <a name="remarks"></a>Комментарии

При вызове этой функции удаляются все отзывы, созданные с помощью `DrawTrackerRect` . Реализация по умолчанию этой функции не выполняет никаких действий.

Переопределите эту функцию, если необходимо выполнить действия после изменения размера прямоугольника.

## <a name="crecttrackersetcursor"></a><a name="setcursor"></a> Кректтраккер:: Сеткурсор

Вызовите эту функцию, чтобы изменить форму курсора, пока она находится над `CRectTracker` областью объекта.

```
BOOL SetCursor(
    CWnd* pWnd,
    UINT nHitTest) const;
```

### <a name="parameters"></a>Параметры

*Приводится*<br/>
Указывает на окно, в котором в данный момент находится курсор.

*нхиттест*<br/>
Результаты предыдущей проверки нажатия из сообщения WM_SETCURSOR.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если предыдущее попадание было выполнено над прямоугольником инспектора; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Вызовите эту функцию из функции окна, которая обрабатывает сообщение WM_SETCURSOR (обычно `OnSetCursor` ).

## <a name="crecttrackertrack"></a><a name="track"></a> Кректтраккер:: Track

Вызовите эту функцию, чтобы отобразить пользовательский интерфейс для изменения размера прямоугольника.

```
BOOL Track(
    CWnd* pWnd,
    CPoint point,
    BOOL bAllowInvert = FALSE,
    CWnd* pWndClipTo = NULL);
```

### <a name="parameters"></a>Параметры

*Приводится*<br/>
Объект Window, содержащий прямоугольник.

*точки*<br/>
Координаты устройства текущей положения мыши относительно клиентской области.

*балловинверт*<br/>
Если значение равно TRUE, прямоугольник может быть инвертирован вдоль оси x или оси y; в противном случае — FALSE.

*пвндклипто*<br/>
Окно, в которое будут обрезаны операции рисования. Если значение равно NULL, то в качестве прямоугольника обрезки используется *приводится* .

### <a name="return-value"></a>Возвращаемое значение

Если нажата клавиша ESC, процесс отслеживания останавливается, прямоугольник, хранящийся в инспекторе, не изменяется, а возвращается значение 0. Если изменение зафиксировано, перемещая мышь и выпуская левую кнопку мыши, Новая область и (или) размер записываются в прямоугольник Tracker и возвращается ненулевое значение.

### <a name="remarks"></a>Комментарии

Обычно это вызывается из функции приложения, которая обрабатывает `WM_LBUTTONDOWN` сообщение (обычно `OnLButtonDown` ).

Эта функция захватывает мышь, пока пользователь не отпускает левую кнопку мыши, нажимает клавишу ESC или нажимает правую кнопку мыши. По мере того, как пользователь перемещает курсор мыши, обратная связь обновляется путем вызова `DrawTrackerRect` и `OnChangedRect` .

Если *балловинверт* имеет значение true, то прямоугольник отслеживания может быть инвертирован на оси x или y.

## <a name="crecttrackertrackrubberband"></a><a name="trackrubberband"></a> Кректтраккер:: Траккруббербанд

Вызовите эту функцию, чтобы выбрать вариант с резиновой полосой.

```
BOOL TrackRubberBand(
    CWnd* pWnd,
    CPoint point,
    BOOL bAllowInvert = TRUE);
```

### <a name="parameters"></a>Параметры

*Приводится*<br/>
Объект Window, содержащий прямоугольник.

*точки*<br/>
Координаты устройства текущей положения мыши относительно клиентской области.

*балловинверт*<br/>
Если значение равно TRUE, прямоугольник может быть инвертирован вдоль оси x или оси y; в противном случае — FALSE.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если мышь перемещена, а прямоугольник не пуст; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Обычно он вызывается из функции приложения, которая обрабатывает сообщение WM_LBUTTONDOWN (обычно `OnLButtonDown` ).

Эта функция захватывает мышь, пока пользователь не отпускает левую кнопку мыши, нажимает клавишу ESC или нажимает правую кнопку мыши. По мере того, как пользователь перемещает курсор мыши, обратная связь обновляется путем вызова `DrawTrackerRect` и `OnChangedRect` .

Отслеживание выполняется с выбором типа с резиным диапазоном от нижнего правого маркера. Если инвертирование разрешено, размер прямоугольника можно изменять, перетаскивая вверх, влево или вниз и вправо.

## <a name="see-also"></a>См. также раздел

[Пример средства регистрации MFC](../../overview/visual-cpp-samples.md)<br/>
[Пример DRAWCLI для MFC](../../overview/visual-cpp-samples.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс Колересизебар](../../mfc/reference/coleresizebar-class.md)<br/>
[Класс Крект](../../atl-mfc-shared/reference/crect-class.md)
