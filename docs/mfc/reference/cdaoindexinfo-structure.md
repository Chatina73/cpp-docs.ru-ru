---
description: 'Дополнительные сведения о: структура Кдаоиндексинфо'
title: Структура CDaoIndexInfo
ms.date: 06/25/2018
f1_keywords:
- CDaoIndexInfo
helpviewer_keywords:
- DAO (Data Access Objects), Indexes collection
- CDaoIndexInfo structure [MFC]
ms.assetid: 251d8285-78ce-4716-a0b3-ccc3395fc437
ms.openlocfilehash: 2e09846789dc91e4d0df67665f3e975b557c07c8
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97250768"
---
# <a name="cdaoindexinfo-structure"></a>Структура CDaoIndexInfo

`CDaoIndexInfo`Структура содержит сведения об объекте индекса, определенном для объектов доступа к данным (DAO).

## <a name="syntax"></a>Синтаксис

```cpp
struct CDaoIndexInfo {
    CDaoIndexInfo();                    // Constructor
    CString m_strName;                  // Primary
    CDaoIndexFieldInfo* m_pFieldInfos;  // Primary
    short m_nFields;                    // Primary
    BOOL m_bPrimary;                    // Secondary
    BOOL m_bUnique;                     // Secondary
    BOOL m_bClustered;                  // Secondary
    BOOL m_bIgnoreNulls;                // Secondary
    BOOL m_bRequired;                   // Secondary
    BOOL m_bForeign;                    // Secondary
    long m_lDistinctCount;              // All

    // Below the // Implementation comment:
    // Destructor, not otherwise documented
};
```

### <a name="parameters"></a>Параметры

*m_strName*<br/>
Уникально именует объект Field. Дополнительные сведения см. в разделе "свойство Name" справки DAO.

*m_pFieldInfos*<br/>
Указатель на массив объектов [кдаоиндексфиелдинфо](../../mfc/reference/cdaoindexfieldinfo-structure.md) , указывающий, какие поля объекта tabledef или набора записей являются ключевыми полями в индексе. Каждый объект определяет одно поле в индексе. Порядок индексов по умолчанию — по возрастанию. Объект индекса может иметь одно или несколько полей, представляющих ключи индекса для каждой записи. Это могут быть по возрастанию, по убыванию или комбинации.

*m_nFields*<br/>
Число полей, хранящихся в `m_pFieldInfos` .

*m_bPrimary*<br/>
Если свойство PRIMARY имеет значение TRUE, то объект index представляет первичный индекс. Первичный индекс состоит из одного или нескольких полей, которые однозначно идентифицируют все записи в таблице в стандартном порядке. Поскольку поле индекса должно быть уникальным, свойство Unique объекта index также имеет значение TRUE в DAO. Если первичный индекс состоит более чем из одного поля, каждое поле может содержать повторяющиеся значения, но каждое сочетание значений из всех индексированных полей должно быть уникальным. Первичный индекс состоит из ключа таблицы и обычно содержит те же поля, что и первичный ключ.

При задании первичного ключа для таблицы первичный ключ автоматически определяется в качестве первичного индекса для таблицы. Дополнительные сведения см. в подразделах «основное свойство» и «уникальное свойство» справки DAO.

> [!NOTE]
> В таблице может быть не более одного первичного индекса.

*m_bUnique*<br/>
Указывает, представляет ли объект индекса уникальный индекс для таблицы. Если это свойство имеет значение TRUE, то объект index представляет уникальный индекс. Уникальный индекс состоит из одного или нескольких полей, которые логически упорядочивают все записи в таблице в уникальном стандартном порядке. Если индекс состоит из одного поля, то значения в этом поле должны быть уникальными для всей таблицы. Если индекс состоит более чем из одного поля, каждое поле может содержать повторяющиеся значения, но каждое сочетание значений из всех индексированных полей должно быть уникальным.

Если для свойств UNIQUE и PRIMARY объекта index задано значение TRUE, то индекс является уникальным и первичным: он однозначно определяет все записи в таблице в стандартном логическом порядке. Если свойство PRIMARY имеет значение FALSE, то индекс является вторичным индексом. Вторичные индексы (ключевые и неключевые) логически упорядочивают записи в стандартном порядке, не указывая в качестве идентификатора для записей в таблице.

Дополнительные сведения см. в подразделах «основное свойство» и «уникальное свойство» справки DAO.

*m_bClustered*<br/>
Указывает, представляет ли объект индекса кластеризованный индекс для таблицы. Если это свойство имеет значение TRUE, то объект index представляет кластеризованный индекс. в противном случае — нет. Кластеризованный индекс состоит из одного или нескольких неключевых полей, которые, в совокупности, упорядочивают все записи в таблице в стандартном порядке. При использовании кластеризованного индекса данные в таблице буквально хранятся в порядке, указанном кластеризованным индексом. Кластеризованный индекс обеспечивает эффективный доступ к записям в таблице. Дополнительные сведения см. в разделе "кластеризованное свойство" справки DAO.

> [!NOTE]
> Свойство CLUSTERED не учитывается для баз данных, использующих ядро СУБД Microsoft Jet, так как ядро СУБД Jet не поддерживает кластеризованные индексы.

*m_bIgnoreNulls*<br/>
Указывает, существуют ли записи индекса для записей, имеющих значения NULL в своих полях индекса. Если это свойство имеет значение TRUE, то поля со значениями NULL не имеют записи индекса. Чтобы выполнить поиск записей с помощью поля быстрее, можно определить индекс для поля. Если в индексированном поле разрешены пустые записи и предполагается, что многие из записей будут иметь значение null, можно задать для свойства Игноренуллс объекта index значение TRUE, чтобы уменьшить объем пространства хранения, используемого индексом. Настройка свойства Игноренуллс и требуемый параметр свойства вместе определяют, содержит ли запись со значением индекса null, как показано в следующей таблице.

|игноренуллс|Обязательно|Значение NULL в поле индекса|
|-----------------|--------------|-------------------------|
|Верно|Неверно|Разрешено значение null; запись индекса не добавлена.|
|False|False|Разрешено значение null; добавлена запись индекса.|
|Значение true или false|Верно|Значение NULL не разрешено; запись индекса не добавлена.|

Дополнительные сведения см. в разделе «свойство Игноренуллс» справки DAO.

*m_bRequired*<br/>
Указывает, требуется ли для объекта индекса DAO значение, отличное от NULL. Если это свойство имеет значение TRUE, объект индекса не допускает значение null. Дополнительные сведения см. в подразделе «обязательное свойство» справки DAO.

> [!TIP]
> Если это свойство можно задать либо для объекта индекса DAO, либо для объекта поля (содержащегося в объекте tabledef, Recordset или QueryDef), установите его для объекта Field. Допустимость значения свойства для объекта Field проверяется перед объектом индекса.

*m_bForeign*<br/>
Указывает, представляет ли объект index внешний ключ в таблице. Если это свойство имеет значение TRUE, индекс представляет внешний ключ в таблице. Внешний ключ состоит из одного или нескольких полей в внешней таблице, которые однозначно идентифицируют строку в основной таблице. Ядро базы данных Microsoft Jet создает объект индекса для внешней таблицы и задает внешнее свойство при создании связи, которая обеспечивает целостность ссылок. Дополнительные сведения см. в разделе «внешнее свойство» справки DAO.

*m_lDistinctCount*<br/>
Указывает количество уникальных значений для объекта индекса, которые включены в связанную таблицу. Проверьте свойство DistinctCount, чтобы определить количество уникальных значений или ключей в индексе. Любой ключ подсчитывается только один раз, несмотря на то, что в индексе разрешены дублирующиеся значения. Эта информация полезна в приложениях, пытающихся оптимизировать доступ к данным путем оценки сведений об индексах. Число уникальных значений также называется кратностью объекта индекса. Свойство DistinctCount не всегда отражает фактическое количество ключей в определенное время. Например, изменение, вызванное откатом транзакции, не будет немедленно отражено в свойстве DistinctCount. Дополнительные сведения см. в разделе «свойство DistinctCount» справки DAO.

## <a name="remarks"></a>Комментарии

Ссылки на первичный, вторичный и все вышеперечисленное указывают, как эта информация возвращается функцией- `GetIndexInfo` членом в классах [Кдаотабледеф](../../mfc/reference/cdaotabledef-class.md#getindexinfo) и [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md#getindexinfo).

Объекты индекса не представлены классом MFC. Вместо этого объекты DAO базовых объектов MFC класса [кдаотабледеф](../../mfc/reference/cdaotabledef-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) содержат коллекцию объектов index, называемую коллекцией индексов. Эти классы предоставляют функции-члены для доступа к отдельным элементам сведений об индексах или для доступа к ним с помощью `CDaoIndexInfo` объекта путем вызова функции- `GetIndexInfo` члена содержащего его объекта.

`CDaoIndexInfo` имеет конструктор и деструктор для правильного выделения и освобождения сведений о поле индекса в `m_pFieldInfos` .

Сведения, полученные `GetIndexInfo` функцией-членом объекта tabledef, хранятся в `CDaoIndexInfo` структуре. Вызовите `GetIndexInfo` функцию-член содержащего объекта tabledef, в коллекции индексов которого хранится объект index. `CDaoIndexInfo` также определяет `Dump` функцию-член в отладочных сборках. Можно использовать `Dump` для дампа содержимого `CDaoIndexInfo` объекта.

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

## <a name="see-also"></a>См. также раздел

[Структуры, стили, обратные вызовы и схемы сообщений](../../mfc/reference/structures-styles-callbacks-and-message-maps.md)<br/>
[Кдаотабледеф:: Жетиндексинфо](../../mfc/reference/cdaotabledef-class.md#getindexinfo)
