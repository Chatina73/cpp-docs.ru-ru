---
title: Класс CWinAppEx
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/16/2020
ms.locfileid: "79426309"
---
# <a name="cwinappex-class"></a>Класс CWinAppEx

`CWinAppEx` обрабатывает состояние приложения, сохраняет состояние в реестр, загружает состояние из реестра, инициализирует диспетчеры приложений и предоставляет ссылки на те же диспетчеры приложений.

   Дополнительные сведения см. в исходном коде, расположенном в папке **VC\\atlmfc\\src\\mfc** каталога установки Visual Studio.
## <a name="syntax"></a>Синтаксис

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Description|
|----------|-----------------|
|[CWinAppEx:: CWinAppEx](#cwinappex)|Формирует объект `CWinAppEx`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Description|
|----------|-----------------|
|[CWinAppEx:: Клеанстате](#cleanstate)|Удаляет сведения о приложении из реестра Windows.|
|[CWinAppEx:: Енаблелоадвиндовплацемент](#enableloadwindowplacement)|Указывает, будет ли приложение загружать исходный размер и расположение главного окна фрейма из реестра.|
|[CWinAppEx:: Енаблетеароффменус](#enabletearoffmenus)|Включает для приложения меню с разрывом.|
|[CWinAppEx:: Енаблеусертулс](#enableusertools)|Позволяет пользователю создавать пользовательские команды меню в приложении.|
|[CWinAppEx:: ExitInstance](#exitinstance)|Вызывается платформой из функции члена `Run` для выхода из этого экземпляра приложения. (Переопределяет метод [CWinApp:: ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance).)|
|[CWinAppEx:: binary](#getbinary)|Считывает двоичные данные, связанные с указанным значением реестра.|
|[CWinAppEx:: Жетконтекстменуманажер](#getcontextmenumanager)|Возвращает указатель на глобальный объект [кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md) .|
|[CWinAppEx:: Жетдатаверсион](#getdataversion)||
|[CWinAppEx:: Жетдатаверсионмажор](#getdataversionmajor)|Возвращает основную версию приложения, сохраненную в реестре Windows.|
|[CWinAppEx:: Жетдатаверсионминор](#getdataversionminor)|Возвращает дополнительный номер версии приложения, сохраненного в реестре Windows.|
|[CWinAppEx:: GetInt](#getint)|Считывает числовые данные, связанные с указанным значением из реестра.|
|[CWinAppEx:: Жеткэйбоардманажер](#getkeyboardmanager)|Возвращает указатель на глобальный объект [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .|
|[CWinAppEx:: Жетмаусеманажер](#getmousemanager)|Возвращает указатель на глобальный объект [кмаусеманажер](../../mfc/reference/cmousemanager-class.md) .|
|[CWinAppEx:: GetObject](#getobject)|Считывает из реестра данные, полученные `CObject`, связанные с указанным значением.|
|[CWinAppEx:: Жетрегсектионпас](#getregsectionpath)|Возвращает строку, которая является путем к разделу реестра. Этот путь объединяет указанный относительный путь с путем к приложению.|
|[CWinAppEx:: Жетрегистрибасе](#getregistrybase)|Возвращает путь реестра для приложения.|
|[CWinAppEx:: Жетсектионбинари](#getsectionbinary)|Считывает двоичные данные, связанные с указанным ключом и значением из реестра.|
|[CWinAppEx:: Жетсектионинт](#getsectionint)|Считывает числовые данные из реестра, связанного с указанным ключом и значением.|
|[CWinAppEx:: Жетсектионобжект](#getsectionobject)|Считывает `CObject` данные, связанные с указанным ключом и значением из реестра.|
|[CWinAppEx:: Жетсектионстринг](#getsectionstring)|Считывает строковые данные, связанные с указанным ключом и значением из реестра.|
|[CWinAppEx:: Жетшеллманажер](#getshellmanager)|Возвращает указатель на глобальный объект [кшеллманажер](../../mfc/reference/cshellmanager-class.md) .|
|[CWinAppEx:: GetString](#getstring)|Считывает строковые данные, связанные с указанным значением из реестра.|
|[CWinAppEx:: Жеттултипманажер](#gettooltipmanager)|Возвращает указатель на глобальный объект [ктултипманажер](../../mfc/reference/ctooltipmanager-class.md) .|
|[CWinAppEx:: Жетусертулсманажер](#getusertoolsmanager)|Возвращает указатель на глобальный объект [кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md) .|
|[CWinAppEx:: Инитконтекстменуманажер](#initcontextmenumanager)|Инициализирует объект `CContextMenuManager`.|
|[CWinAppEx:: Иниткэйбоардманажер](#initkeyboardmanager)|Инициализирует объект `CKeyboardManager`.|
|[CWinAppEx:: Инитмаусеманажер](#initmousemanager)|Инициализирует объект `CMouseManager`.|
|[CWinAppEx:: Инитшеллманажер](#initshellmanager)|Инициализирует класс `CShellManager`|
|[CWinAppEx:: Иниттултипманажер](#inittooltipmanager)|Инициализирует класс `CTooltipManager`.|
|[CWinAppEx:: Исресаурцесмартупдате](#isresourcesmartupdate)||
|[CWinAppEx:: Исстатиксистс](#isstateexists)|Указывает, находится ли указанный ключ в реестре.|
|[CWinAppEx:: LoadState](#loadstate)|Загружает состояние приложения из реестра.|
|[CWinAppEx:: Онаппконтексселп](#onappcontexthelp)|Вызывается платформой, когда пользователь запрашивает контекстную справку для диалогового окна " **Настройка** ".|
|[CWinAppEx:: Онвиевдаублекликк](#onviewdoubleclick)|Вызывает определяемую пользователем команду, когда пользователь дважды щелкает в любом месте приложения.|
|[CWinAppEx:: Онворкспацеидле](#onworkspaceidle)||
|[CWinAppEx:: SaveState](#savestate)|Записывает состояние платформы приложений в реестр Windows.|
|[CWinAppEx:: Сетрегистрибасе](#setregistrybase)|Задает путь к разделу реестра по умолчанию. Этот ключ будет служить корнем для всех последующих вызовов реестра.|
|[CWinAppEx:: Шовпопупмену](#showpopupmenu)|Отображает всплывающее меню.|
|[CWinAppEx:: Вритебинари](#writebinary)|Записывает двоичные данные в указанное значение реестра.|
|[CWinAppEx:: Вритеинт](#writeint)|Записывает числовые данные в указанное значение реестра.|
|[CWinAppEx:: WriteObject](#writeobject)|Записывает данные, полученные из [класса CObject](../../mfc/reference/cobject-class.md) , в указанное значение реестра.|
|[CWinAppEx:: Вритесектионбинари](#writesectionbinary)|Записывает двоичные данные в значение указанного раздела реестра.|
|[CWinAppEx:: Вритесектионинт](#writesectionint)|Записывает числовые данные в значение указанного раздела реестра.|
|[CWinAppEx:: Вритесектионобжект](#writesectionobject)|Записывает данные, полученные из класса `CObject`, в значение указанного раздела реестра.|
|[CWinAppEx:: Вритесектионстринг](#writesectionstring)|Записывает строковые данные в значение указанного раздела реестра.|
|[CWinAppEx:: WriteString](#writestring)|Записывает строковые данные в указанное значение реестра.|

### <a name="protected-methods"></a>Защищенные методы

|Имя|Description|
|----------|-----------------|
|[CWinAppEx:: Лоадкустомстате](#loadcustomstate)|Вызывается платформой при загрузке состояния приложения.|
|[CWinAppEx:: Лоадвиндовплацемент](#loadwindowplacement)|Вызывается платформой при загрузке в реестре размера и расположения приложения. Загруженные данные включают размер и расположение основного кадра во время последнего закрытия приложения.|
|[CWinAppEx:: Онклосингмаинфраме](#onclosingmainframe)|Вызывается структурой при обработке WM_CLOSE главного окна фрейма.|
|[CWinAppEx::Pная LoadState](#preloadstate)|Вызывается платформой непосредственно перед загрузкой состояния приложения.|
|[CWinAppEx::P Ресавестате](#presavestate)|Вызывается платформой непосредственно перед сохранением состояния приложения.|
|[CWinAppEx:: Релоадвиндовплацемент](#reloadwindowplacement)|Перезагружает размер и расположение переданного окна из реестра.|
|[CWinAppEx:: Савекустомстате](#savecustomstate)|Вызвано структурой после записи состояния приложения в реестр.|
|[CWinAppEx:: Сторевиндовплацемент](#storewindowplacement)|Вызывается платформой для записи размера и расположения главного фрейма в реестр.|

### <a name="data-members"></a>Элементы данных

|Имя|Description|
|----------|-----------------|
|[CWinAppEx:: m_bForceImageReset](#m_bforceimagereset)|Указывает, будет ли платформа сбрасывать все изображения панели инструментов при загрузке окна фрейма, содержащего панель инструментов.|

## <a name="remarks"></a>Remarks

Большая часть функциональных возможностей, предоставляемых платформой MFC, зависит от класса `CWinAppEx`. Вы можете внедрить класс `CWinAppEx` в приложение одним из двух способов:

- Создайте класс `CWinAppEx` в основном потоке.

- Создайте класс основного приложения из `CWinAppEx`.

После включения `CWinAppEx` в приложение можно инициализировать любой диспетчер приложений. Прежде чем использовать диспетчер приложений, его необходимо инициализировать, вызвав соответствующий метод Initialize. Чтобы получить указатель на конкретный диспетчер, вызовите соответствующий метод Get. Класс `CWinAppEx` управляет следующими диспетчерами приложений: [класс кмаусеманажер](../../mfc/reference/cmousemanager-class.md), класс [кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md), [класс CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md), класс [кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md)и [класс кменутеароффманажер](../../mfc/reference/cmenutearoffmanager-class.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>Требования

**Заголовок:** афксвинаппекс. h

##  <a name="cleanstate"></a>CWinAppEx:: Клеанстате

Удаляет все сведения о приложении из реестра Windows.

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>Параметры

*лпсзсектионнаме*<br/>
окне Строка, содержащая путь к разделу реестра.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод был успешным; в противном случае — 0.

### <a name="remarks"></a>Remarks

Этот метод удаляет данные приложения из определенного раздела реестра. Можно указать раздел для очистки с помощью параметра *лпсзсектионнаме*. Если *лпсзсектионнаме* имеет значение null, этот метод будет использовать путь реестра по умолчанию, хранящийся в объекте `CWinAppEx`. Чтобы получить путь к реестру по умолчанию, используйте [CWinAppEx:: жетрегистрибасе](#getregistrybase).

##  <a name="cwinappex"></a>CWinAppEx:: CWinAppEx

Формирует объект `CWinAppEx`.

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>Параметры

*бресаурцесмартупдате*<br/>
окне Логический параметр, указывающий, должен ли объект рабочей области обнаруживать и управлять обновлениями ресурсов.

### <a name="remarks"></a>Remarks

Класс `CWinAppEx` имеет методы инициализации, предоставляет функциональные возможности для сохранения и загрузки сведений о приложениях в реестр, а также управляет глобальными параметрами приложения. Он также позволяет использовать глобальные руководители, такие как [класс CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) и [класс кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md). Каждое приложение может иметь только один экземпляр класса `CWinAppEx`.

##  <a name="enableloadwindowplacement"></a>CWinAppEx:: Енаблелоадвиндовплацемент

Указывает, будет ли приложение загружать исходный размер и расположение главного окна фрейма из реестра.

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Параметры

*bEnable*<br/>
окне Указывает, загружает ли приложение исходный размер и расположение главного окна фрейма из реестра.

### <a name="remarks"></a>Remarks

По умолчанию размер и расположение главного фрейма загружаются из реестра вместе с другими параметрами приложения. Это происходит во время [CWinAppEx:: LoadState](#loadstate). Если вы не хотите загружать исходное размещение окна из реестра, вызовите этот метод с параметром *бенабле* , для которого задано значение false.

##  <a name="enabletearoffmenus"></a>CWinAppEx:: Енаблетеароффменус

Создает и инициализирует объект [кменутеароффманажер](../../mfc/reference/cmenutearoffmanager-class.md) .

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>Параметры

*лпсзрежентри*<br/>
окне Строка, содержащая путь к разделу реестра. Приложение использует этот раздел реестра для хранения информации о неразрывных меню.

*уикмдфирст*<br/>
окне Первый разрыв из идентификатора меню.

*уикмдласт*<br/>
окне ИДЕНТИФИКАТОР меню последнего разрыва.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если `CMenuTearOffManager` создан и инициализирован успешно; Значение FALSE, если возникает ошибка или `CMenuTearOffManager` уже существует.

### <a name="remarks"></a>Remarks

Эта функция используется для включения в приложении меню разрыва. Эту функцию следует вызывать из `InitInstance`.

##  <a name="enableusertools"></a>CWinAppEx:: Енаблеусертулс

Позволяет пользователю создавать пользовательские команды меню, уменьшающие нажатия клавиш в приложении. Этот метод создает объект [кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md) .

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>Параметры

*уикмдтулсдумми*<br/>
окне Целое число без знака, используемое платформой в качестве заполнителя для идентификатора команды в меню "средства пользователя".

*уикмдфирст*<br/>
окне Идентификатор команды для первой команды средства пользователя.

*уикмдласт*<br/>
окне Идентификатор команды для последней команды средства User.

*птулртк*<br/>
окне Класс, используемый объектом `CUserToolsManager` для создания новых пользовательских инструментов.

*уаргменуид*<br/>
окне ИДЕНТИФИКАТОР меню аргументов.

*уинитдирменуид*<br/>
окне ИДЕНТИФИКАТОР меню для исходного каталога инструмента.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если метод создает и инициализирует объект `CUserToolsManager`; Значение FALSE, если метод завершается ошибкой или если объект `CUserToolsManager` уже существует.

### <a name="remarks"></a>Remarks

При включении пользовательских средств платформа автоматически поддерживает динамическое меню, которое можно расширить во время настройки. Платформа связывает каждый новый элемент с внешней командой. Платформа вызывает эти команды, когда пользователь выбирает соответствующий элемент в меню **Сервис** .

Каждый раз, когда пользователь добавляет новый элемент, платформа создает новый объект. Тип класса для нового объекта определяется *птулртк*. Тип класса *птулртк* должен быть производным от [класса кусертул](../../mfc/reference/cusertool-class.md).

Дополнительные сведения о пользовательских средствах и способах их внедрения в приложение см. в разделе пользовательские [средства](../../mfc/user-defined-tools.md).

##  <a name="exitinstance"></a>CWinAppEx:: ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Remarks

##  <a name="getbinary"></a>CWinAppEx:: binary

Считывает двоичные данные из указанного раздела реестра.

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя раздела реестра.

*ппдата*<br/>
заполняет Указатель на буфер, который метод заполняет двоичными данными.

*пбитес*<br/>
заполняет Указатель на целое число без знака, используемое методом для записи числа считанных байтов.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE в случае успешного выполнения. В противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Этот метод считывает двоичные данные, записанные в реестр. Чтобы записать данные в реестр, используйте методы [CWinAppEx:: вритебинари](#writebinary) и [CWinAppEx:: вритесектионбинари](#writesectionbinary).

Параметр *лпсзентри* — это имя записи реестра, расположенной в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getcontextmenumanager"></a>CWinAppEx:: Жетконтекстменуманажер

Возвращает указатель на глобальный объект [кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md) .

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CContextMenuManager`.

### <a name="remarks"></a>Remarks

Если объект Кконтекстменуманажер не инициализирован, эта функция вызывает [CWinAppEx:: инитконтекстменуманажер](#initcontextmenumanager) , прежде чем возвращает указатель.

##  <a name="getdataversion"></a>CWinAppEx:: Жетдатаверсион

```
int GetDataVersion() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Remarks

##  <a name="getdataversionmajor"></a>CWinAppEx:: Жетдатаверсионмажор

Возвращает основную версию приложения, которая сохраняется в реестре Windows при вызове [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>Возвращаемое значение

Целочисленное значение, содержащее основной номер версии.

##  <a name="getdataversionminor"></a>CWinAppEx:: Жетдатаверсионминор

Возвращает дополнительный номер версии приложения, который сохраняется в реестре Windows при вызове [CWinAppEx:: SaveState](#savestate).

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>Возвращаемое значение

Целочисленное значение, содержащее дополнительный номер версии.

##  <a name="getint"></a>CWinAppEx:: GetInt

Считывает целочисленные данные из указанного раздела реестра.

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя записи реестра.

*ндефаулт*<br/>
окне Значение по умолчанию, которое метод возвращает, если указанная запись реестра не существует.

### <a name="return-value"></a>Возвращаемое значение

Данные реестра, если метод был успешным; в противном случае *ндефаулт*.

### <a name="remarks"></a>Remarks

Этот метод считывает целочисленные данные из реестра. Если нет целочисленных данных, связанных с разделом реестра, указанным параметром *лпсзентри*, этот метод возвращает *ндефаулт*. Чтобы записать данные в реестр, используйте методы [CWinAppEx:: вритесектионинт](#writesectionint) и [CWinAppEx:: вритеинт](#writeint).

Параметр *лпсзентри* — это имя записи реестра, расположенной в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getkeyboardmanager"></a>CWinAppEx:: Жеткэйбоардманажер

Возвращает указатель на глобальный объект [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CKeyboardManager`.

### <a name="remarks"></a>Remarks

Если диспетчер клавиатуры не инициализирован, эта функция вызывает [CWinAppEx:: иниткэйбоардманажер](#initkeyboardmanager) , прежде чем возвращает указатель.

##  <a name="getmousemanager"></a>CWinAppEx:: Жетмаусеманажер

Возвращает указатель на глобальный объект [кмаусеманажер](../../mfc/reference/cmousemanager-class.md) .

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CMouseManager`.

### <a name="remarks"></a>Remarks

Если диспетчер мыши не инициализирован, эта функция вызывает [CWinAppEx:: инитмаусеманажер](#initmousemanager) , прежде чем возвращает указатель.

##  <a name="getobject"></a>CWinAppEx:: GetObject

Считывает данные о [CObject](../../mfc/reference/cobject-class.md)-производный из реестра.

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая относительный путь к записи реестра.

*obj*<br/>
заполняет Ссылка на `CObject`. Метод использует эту ссылку для хранения данных реестра.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод был успешным; в противном случае — 0.

### <a name="remarks"></a>Remarks

Этот метод считывает данные из реестра, который является производным от `CObject`. Чтобы записать `CObject` данные в реестр, используйте [CWinAppEx:: WriteObject](#writeobject) или [CWinAppEx:: вритесектионобжект](#writesectionobject).

Параметр *лпсзентри* — это имя записи реестра, которая находится в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getregistrybase"></a>CWinAppEx:: Жетрегистрибасе

Извлекает путь реестра по умолчанию для приложения.

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>Возвращаемое значение

Строка, содержащая путь к расположению реестра по умолчанию.

### <a name="remarks"></a>Remarks

Все методы [класса CWinAppEx](../../mfc/reference/cwinappex-class.md) , которые обращаются к реестру, начинаются в расположении по умолчанию. Этот метод используется для получения пути к расположению реестра по умолчанию. Используйте [CWinAppEx:: сетрегистрибасе](#setregistrybase) , чтобы изменить расположение реестра по умолчанию.

##  <a name="getregsectionpath"></a>CWinAppEx:: Жетрегсектионпас

Создает и возвращает абсолютный путь к разделу реестра.

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>Параметры

*сзсектионадд*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

### <a name="return-value"></a>Возвращаемое значение

`CString`, содержащий абсолютный путь к разделу реестра.

### <a name="remarks"></a>Remarks

Этот метод определяет абсолютный путь к разделу реестра, добавляя относительный путь в *сзсектионадд* в расположение реестра по умолчанию для приложения. Чтобы получить раздел реестра по умолчанию, используйте метод [CWinAppEx:: жетрегистрибасе](#getregistrybase).

##  <a name="getsectionbinary"></a>CWinAppEx:: Жетсектионбинари

Считывает двоичные данные из реестра.

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*лпсзентри*<br/>
окне Строка, содержащая значение для чтения.

*ппдата*<br/>
заполняет Указатель на буфер, в котором метод хранит данные.

*пбитес*<br/>
заполняет Указатель на целое число без знака. Метод записывает размер *ппдата* в этот параметр.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если успешно; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Этот метод считывает двоичные данные, записанные в реестр, с помощью методов [CWinAppEx:: вритебинари](#writebinary) и [CWinAppEx:: вритесектионбинари](#writesectionbinary).

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getsectionint"></a>CWinAppEx:: Жетсектионинт

Считывает целочисленные данные из реестра.

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*лпсзентри*<br/>
окне Строка, содержащая значение для чтения.

*ндефаулт*<br/>
окне Значение по умолчанию, возвращаемое, если указанное значение не существует.

### <a name="return-value"></a>Возвращаемое значение

Целочисленные данные, хранящиеся в указанном значении реестра; *ндефаулт* , если данные не существуют.

### <a name="remarks"></a>Remarks

Используйте методы [CWinAppEx:: вритеинт](#writeint) и [CWinAppEx:: вритесектионинт](#writesectionint) для записи целочисленных данных в реестр.

Параметр *лпсзсубсектион* не является абсолютным путем к записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getsectionobject"></a>CWinAppEx:: Жетсектионобжект

Считывает из реестра данные реестра [CObject](../../mfc/reference/cobject-class.md) .

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*лпсзентри*<br/>
окне Строка, содержащая значение для чтения.

*obj*<br/>
заполняет Ссылка на `CObject`. Метод использует этот `CObject` для хранения данных реестра.

### <a name="return-value"></a>Возвращаемое значение

Имеет ненулевое значение в случае успешного выполнения, иначе — 0.

### <a name="remarks"></a>Remarks

Этот метод считывает данные из реестра. Чтение данных — это `CObject` данные или данные для класса, производного от `CObject`. Чтобы записать `CObject` данные в реестр, используйте [CWinAppEx:: WriteObject](#writeobject) или [CWinAppEx:: вритесектионобжект](#writesectionobject).

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getsectionstring"></a>CWinAppEx:: Жетсектионстринг

Считывает строковые данные из реестра.

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*лпсзентри*<br/>
окне Строка, содержащая значение для чтения.

*лпсздефаулт*<br/>
окне Значение по умолчанию, возвращаемое, если указанное значение не существует.

### <a name="return-value"></a>Возвращаемое значение

Строковые данные, хранящиеся в указанном значении реестра, если данные существуют; в противном случае *лпсздефаулт*.

### <a name="remarks"></a>Remarks

Этот метод считывает строковые данные, записанные в реестр. Используйте [CWinAppEx:: WriteString](#writestring) и [CWinAppEx:: вритесектионстринг](#writesectionstring) для записи строковых данных в реестр.

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="getshellmanager"></a>CWinAppEx:: Жетшеллманажер

Возвращает указатель на глобальный объект [кшеллманажер](../../mfc/reference/cshellmanager-class.md) .

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CShellManager`.

### <a name="remarks"></a>Remarks

Если объект `CShellManager` не инициализирован, эта функция вызывает [CWinAppEx:: инитшеллманажер](#initshellmanager) , прежде чем возвращает указатель.

##  <a name="getstring"></a>CWinAppEx:: GetString

Считывает строковые данные из указанного раздела реестра.

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя раздела реестра.

*лпздефаулт*<br/>
окне Значение по умолчанию, которое метод возвращает, если указанная запись реестра не существует.

### <a name="return-value"></a>Возвращаемое значение

Строковые данные, хранящиеся в реестре в случае успеха; *лпсздефаулт* в противном случае.

### <a name="remarks"></a>Remarks

Этот метод считывает строковые данные, записанные в реестр. Чтобы записать данные в реестр, используйте методы [CWinAppEx:: WriteString](#writestring) или [CWinAppEx:: вритесектионстринг](#writesectionstring).

Параметр *лпсзентри* — это имя записи реестра, расположенной в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="gettooltipmanager"></a>CWinAppEx:: Жеттултипманажер

Возвращает указатель на глобальный объект [ктултипманажер](../../mfc/reference/ctooltipmanager-class.md) .

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CTooltipManager`.

### <a name="remarks"></a>Remarks

Если объект `CTooltipManager` не инициализирован, эта функция вызывает [CWinAppEx:: иниттултипманажер](#inittooltipmanager) , прежде чем возвращает указатель.

##  <a name="getusertoolsmanager"></a>CWinAppEx:: Жетусертулсманажер

Возвращает указатель на глобальный объект [кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md) .

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>Возвращаемое значение

Указатель на глобальный объект `CUserToolsManager`; Значение NULL, если управление пользовательскими инструментами не включено для приложения.

### <a name="remarks"></a>Remarks

Перед получением указателя на объект `CUserToolsManager` необходимо инициализировать диспетчер путем вызова [CWinAppEx:: енаблеусертулс](#enableusertools).

##  <a name="initcontextmenumanager"></a>CWinAppEx:: Инитконтекстменуманажер

Инициализирует объект [кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md) .

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод создает объект Кконтекстменуманажер; 0, если объект `CContextMenuManager` уже существует.

### <a name="remarks"></a>Remarks

При вызове [CWinAppEx:: жетконтекстменуманажер](#getcontextmenumanager)реализация по умолчанию этого метода вызывает `InitContextMenuManager`.

Если в приложении уже есть диспетчер контекстных меню и вы вызываете `InitContextMenuManager`, приложение будет иметь сбой [Assert](diagnostic-services.md#assert) . Поэтому не следует вызывать `InitContextMenuManager` при непосредственном создании объекта `CContextMenuManager`. Если пользовательская `CContextMenuManager`не используется, для создания объекта `CContextMenuManager` следует использовать `GetContextMenuManager`.

##  <a name="initkeyboardmanager"></a>CWinAppEx:: Иниткэйбоардманажер

Инициализирует объект [CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md) .

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод создает объект `CKeyboardManager`; 0, если объект `CKeyboardManager` уже существует.

### <a name="remarks"></a>Remarks

При вызове [CWinAppEx:: жеткэйбоардманажер](#getkeyboardmanager)реализация по умолчанию этого метода вызывает `InitKeyboardManager`.

Если в приложении уже есть диспетчер клавиатуры, и вы вызываете `InitKeyboardManager`, приложение будет иметь сбой [Assert](diagnostic-services.md#assert) . Поэтому не следует вызывать `InitKeyboardManager` при непосредственном создании объекта `CKeyboardManager`. Если пользовательская `CKeyboardManager`не используется, для создания объекта `CKeyboardManager` следует использовать `GetKeyboardManager`.

##  <a name="initmousemanager"></a>CWinAppEx:: Инитмаусеманажер

Инициализирует объект [кмаусеманажер](../../mfc/reference/cmousemanager-class.md) .

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод создает объект `CMouseManager`; 0, если объект `CMouseManager` уже существует.

### <a name="remarks"></a>Remarks

При вызове [CWinAppEx:: жетмаусеманажер](#getmousemanager)реализация по умолчанию этого метода вызывает `InitMouseManager`.

Если в приложении уже есть диспетчер мыши и вы вызываете `InitMouseManager`, приложение будет иметь сбой [Assert](diagnostic-services.md#assert) . Поэтому не следует вызывать `InitMouseManager` при непосредственном создании `CMouseManager` объекта. Если пользовательская `CMouseManager`не используется, для создания объекта `CMouseManager` следует использовать `GetMouseManager`.

##  <a name="initshellmanager"></a>CWinAppEx:: Инитшеллманажер

Инициализирует объект [кшеллманажер](../../mfc/reference/cshellmanager-class.md) .

```
BOOL InitShellManager();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод создает объект `CShellManager`; 0, если объект `CShellManager` уже существует.

### <a name="remarks"></a>Remarks

При вызове [CWinAppEx:: жетшеллманажер](#getshellmanager)реализация по умолчанию этого метода вызывает `InitShellManager`.

Если в приложении уже есть диспетчер оболочки и вы вызываете `InitShellManager`, приложение вызывает сбой [Assert](diagnostic-services.md#assert) . Поэтому не вызывайте `InitShellManager`, если объект `CShellManager` создается напрямую. Если вы не используете настраиваемый `CShellManager`, используйте `GetShellManager` для создания объекта `CShellManager`.

##  <a name="inittooltipmanager"></a>CWinAppEx:: Иниттултипманажер

Инициализирует объект [ктултипманажер](../../mfc/reference/ctooltipmanager-class.md) .

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод создает объект `CTooltipManager`; 0, если объект `CTooltipManager` уже существует.

### <a name="remarks"></a>Remarks

При вызове [CWinAppEx:: жеттултипманажер](#gettooltipmanager)реализация по умолчанию этого метода вызывает `InitTooltipManager`.

Если в приложении уже есть диспетчер подсказок и вы вызываете `InitTooltipManager`, приложение будет иметь сбой [Assert](diagnostic-services.md#assert) . Поэтому не следует вызывать `InitTooltipManager` при непосредственном создании объекта `CTooltipManager`. Если пользовательская `CTooltipManager`не используется, для создания объекта `CTooltipManager` следует использовать `GetTooltipManager`.

##  <a name="isresourcesmartupdate"></a>CWinAppEx:: Исресаурцесмартупдате

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Remarks

##  <a name="isstateexists"></a>CWinAppEx:: Исстатиксистс

Указывает, находится ли указанный ключ в реестре.

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>Параметры

*лпсзсектионнаме*<br/>
окне Строка, содержащая путь к разделу реестра.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если ключ находится в реестре; в противном случае — 0.

##  <a name="loadcustomstate"></a>CWinAppEx:: Лоадкустомстате

Платформа вызывает этот метод после загрузки состояния приложения из реестра.

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>Remarks

Переопределите этот метод, если требуется выполнить обработку после того, как приложение загрузит состояние из реестра. По умолчанию этот метод не выполняет никаких действий.

Чтобы загрузить сведения о пользовательском состоянии из реестра, необходимо сначала сохранить сведения с помощью [CWinAppEx:: савекустомстате](#savecustomstate).

##  <a name="loadstate"></a>CWinAppEx:: LoadState

Считывает состояние приложения из реестра Windows.

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>Параметры

*пфраме*<br/>
окне Указатель на объект окна фрейма. Метод применяет сведения о состоянии в реестре к этому окну фрейма.

*лпсзсектионнаме*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*пфрамеимпл*<br/>
окне Указатель на объект `CFrameImpl`. Метод применяет сведения о состоянии в реестре к этому окну фрейма.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения. В противном случае — 0.

### <a name="remarks"></a>Remarks

Этот метод загружает состояние приложения и все сведения о состоянии окна фрейма. Загруженные сведения для окна фрейма применяются к указанному окну фрейма. Если не указать окно фрейма, загружается только информация о состоянии приложения. Сведения о приложении включают состояние [класса кмаусеманажер](../../mfc/reference/cmousemanager-class.md), [класс кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md), [класс CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)и [класс кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md).

Реализация `CFrameImpl::OnLoadFrame` по умолчанию вызывает `LoadState`.

Параметр *лпсзсектионнаме* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="loadwindowplacement"></a>CWinAppEx:: Лоадвиндовплацемент

Вызывается платформой при загрузке размера и расположения главного окна фрейма из реестра.

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>Параметры

*ректнормалпоситион*<br/>
заполняет Прямоугольник, содержащий координаты главного окна фрейма, если он находится в восстановленной положении.

*нфлагс*<br/>
заполняет Флаги, управляющие положением окна с минимальным окном и способом переключения операционной системы между окном с минимальным и восстановленным окном.

*ншовкмд*<br/>
заполняет Целое число, указывающее состояние отображения окна. Дополнительные сведения о возможных значениях см. в разделе [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения. В противном случае — 0.

### <a name="remarks"></a>Remarks

По умолчанию MFC автоматически загружает предыдущее расположение и состояние главного окна фрейма при запуске приложения. Дополнительные сведения о хранении этих сведений в реестре см. в разделе [CWinAppEx:: сторевиндовплацемент](#storewindowplacement).

Переопределите этот метод, если требуется загрузить дополнительные сведения о главном окне фрейма.

##  <a name="m_bforceimagereset"></a>CWinAppEx:: m_bForceImageReset

Указывает, будет ли платформа сбрасывать все изображения панели инструментов при перезагрузке окна фрейма, содержащего панель инструментов.

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>Remarks

Элемент данных `m_bForceImageReset` является защищенной переменной.

##  <a name="onappcontexthelp"></a>CWinAppEx:: Онаппконтексселп

Платформа вызывает этот метод, когда пользователь запрашивает контекстную справку для диалогового окна **настройки** .

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>Параметры

*пвндконтрол*<br/>
окне Указатель на объект окна, для которого вызываемая пользователем Справка контекстного вызова.

*Двхелпидаррай []*<br/>
окне Зарезервированное значение.

### <a name="remarks"></a>Remarks

Этот метод в настоящее время зарезервирован для использования в будущем. Реализация по умолчанию не выполняет никаких действий и в настоящее время не вызывается платформой.

##  <a name="onclosingmainframe"></a>CWinAppEx:: Онклосингмаинфраме

Платформа вызывает этот метод, когда фрейм окна обрабатывает WM_CLOSE.

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>Параметры

*пфрамеимпл*<br/>
окне Указатель на объект `CFrameImpl`.

### <a name="remarks"></a>Remarks

Реализация по умолчанию этого метода сохраняет состояние *пфрамеимпл*.

##  <a name="onviewdoubleclick"></a>CWinAppEx:: Онвиевдаублекликк

Вызывает определяемую пользователем команду, связанную с представлением, когда пользователь дважды щелкает в любом месте этого представления.

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>Параметры

*Приводится*<br/>
окне Указатель на объект, производный от [класса CView](../../mfc/reference/cview-class.md).

*ивиевид*<br/>
окне Идентификатор представления.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если платформа находит команду; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Для поддержки пользовательского поведения мыши необходимо вызвать эту функцию при обработке сообщения WM_LBUTTONDBLCLK. Этот метод выполнит команду, связанную с ИДЕНТИФИКАТОРом представления, предоставленным *ивиевид*. Дополнительные сведения о пользовательском поведении мыши см. в разделе [Настройка клавиатуры и мыши](../../mfc/keyboard-and-mouse-customization.md).

##  <a name="onworkspaceidle"></a>CWinAppEx:: Онворкспацеидле

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>Параметры

окне *CWnd&#38;*<br/>

### <a name="return-value"></a>Возвращаемое значение

### <a name="remarks"></a>Remarks

##  <a name="preloadstate"></a>CWinAppEx::Pная LoadState

Платформа вызывает этот метод непосредственно перед загрузкой состояния приложения из реестра.

```
virtual void PreLoadState();
```

### <a name="remarks"></a>Remarks

Переопределите этот метод, если требуется выполнить обработку немедленно, прежде чем платформа загрузит состояние приложения.

##  <a name="presavestate"></a>CWinAppEx::P Ресавестате

Платформа вызывает этот метод непосредственно перед сохранением состояния приложения.

```
virtual void PreSaveState();
```

### <a name="remarks"></a>Remarks

Переопределите этот метод, если требуется выполнить обработку немедленно, прежде чем платформа сохранит состояние приложения.

##  <a name="reloadwindowplacement"></a>CWinAppEx:: Релоадвиндовплацемент

Перезагружает размер и расположение окна из реестра.

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>Параметры

*пфраме*<br/>
окне Указатель на окно фрейма.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если метод был успешным; 0, если загрузка не удалась или отсутствуют данные для загрузки.

### <a name="remarks"></a>Remarks

Используйте функцию [CWinAppEx:: сторевиндовплацемент](#storewindowplacement) для записи размера и расположения окна в реестр.

##  <a name="savecustomstate"></a>CWinAppEx:: Савекустомстате

Платформа вызывает этот метод после сохранения состояния приложения в реестре.

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>Remarks

Переопределите этот метод, если требуется выполнить обработку после сохранения приложением состояния в реестре. По умолчанию этот метод не выполняет никаких действий.

##  <a name="savestate"></a>CWinAppEx:: SaveState

Записывает состояние приложения в реестр Windows.

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзсектионнаме*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*пфрамеимпл*<br/>
окне Указатель на объект `CFrameImpl`. Этот кадр сохраняется в реестре Windows.

*пфраме*<br/>
окне Указатель на объект окна фрейма. Этот кадр сохраняется в реестре Windows.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE в случае успешного выполнения. В противном случае — значение FALSE.

### <a name="remarks"></a>Remarks

Этот метод сохраняет состояние приложения и все сведения о состоянии для указанного окна фрейма. Если окно фрейма не предоставлено, метод сохраняет только состояние приложения. Сведения о приложении включают состояние [класса кмаусеманажер](../../mfc/reference/cmousemanager-class.md), [класс кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md), [класс CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)и [класс кусертулсманажер](../../mfc/reference/cusertoolsmanager-class.md).

Параметр *лпсзсектионнаме* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

##  <a name="setregistrybase"></a>CWinAppEx:: Сетрегистрибасе

Задает путь реестра по умолчанию для приложения.

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>Параметры

*лпсзсектионнаме*<br/>
окне Строка, содержащая путь к разделу реестра.

### <a name="return-value"></a>Возвращаемое значение

Строка, содержащая путь к расположению реестра по умолчанию.

### <a name="remarks"></a>Remarks

Все методы [класса CWinAppEx](../../mfc/reference/cwinappex-class.md) , которые обращаются к реестру, начинаются в расположении по умолчанию. Используйте этот метод, чтобы изменить расположение реестра по умолчанию. Используйте [CWinAppEx:: жетрегистрибасе](#getregistrybase) , чтобы получить расположение реестра по умолчанию.

##  <a name="showpopupmenu"></a>CWinAppEx:: Шовпопупмену

Отображает всплывающее меню.

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>Параметры

*уименуресид*<br/>
окне Идентификатор ресурса меню.

*point*<br/>
окне Объект [CPoint](../../atl-mfc-shared/reference/cpoint-class.md) , указывающий расположение меню в экранных координатах.

*Приводится*<br/>
окне Указатель на окно, которому принадлежит всплывающее меню.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если всплывающее меню отображается успешно. 0 в противном случае.

### <a name="remarks"></a>Remarks

Этот метод отображает меню, связанное с *уименуресид*.

Для поддержки всплывающих меню необходим объект [кконтекстменуманажер](../../mfc/reference/ccontextmenumanager-class.md) . Если объект `CContextMenuManager` не инициализирован, `ShowPopupMenu` завершится ошибкой.

##  <a name="storewindowplacement"></a>CWinAppEx:: Сторевиндовплацемент

Вызывается платформой для записи размера и расположения главного окна фрейма в реестр.

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>Параметры

*нфлагс*<br/>
окне Флаги, управляющие положением окна с минимальным окном и способом переключения операционной системы между окном с минимальным и восстановленным окном.

*ншовкмд*<br/>
окне Целое число, указывающее состояние отображения окна. Дополнительные сведения о возможных значениях см. в разделе [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow).

*ректнормалпоситион*<br/>
окне Прямоугольник, содержащий координаты главного окна фрейма, если он находится в состоянии restored.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение в случае успешного выполнения. В противном случае — 0.

### <a name="remarks"></a>Remarks

По умолчанию MFC автоматически сохраняет расположение и состояние главного окна фрейма перед выходом из приложения. Эти сведения хранятся в реестре Windows в разделе Виндовплацемент раздела реестра по умолчанию для приложения. Дополнительные сведения о местоположении реестра по умолчанию для приложения см. в разделе [CWinAppEx:: жетрегистрибасе](#getregistrybase).

Переопределите этот метод, если требуется сохранить дополнительные сведения о главном окне фрейма.

##  <a name="writebinary"></a>CWinAppEx:: Вритебинари

Записывает двоичные данные в реестр.

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя раздела реестра.

*pData*<br/>
окне Данные для хранения.

*nBytes*<br/>
окне Размер *pData* в байтах.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзентри* — это имя записи реестра, которая находится в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

Если ключ, заданный параметром *лпсзентри* , не существует, этот метод создаст его.

##  <a name="writeint"></a>CWinAppEx:: Вритеинт

Записывает числовые данные в реестр.

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя раздела реестра.

*Nзначение*<br/>
окне Данные для хранения.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзентри* — это имя записи реестра, расположенной в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

Если ключ, заданный параметром *лпсзентри* , не существует, этот метод создаст его.

##  <a name="writeobject"></a>CWinAppEx:: WriteObject

Записывает данные, полученные из [класса CObject](../../mfc/reference/cobject-class.md) , в реестр.

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая заданное значение.

*obj*<br/>
окне Ссылка на `CObject` данных, которые будут храниться в методе.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Этот метод записывает данные *obj* в указанное значение в разделе реестра по умолчанию. Чтобы определить текущий раздел реестра, используйте [CWinAppEx:: жетрегистрибасе](#getregistrybase) .

##  <a name="writesectionbinary"></a>CWinAppEx:: Вритесектионбинари

Записывает двоичные данные в значение в реестре.

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая имя раздела реестра.

*лпсзентри*<br/>
окне Строка, содержащая заданное значение.

*pData*<br/>
окне Данные, записываемые в реестр.

*nBytes*<br/>
окне Размер *pData* в байтах.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

Если ключ, заданный параметром *лпсзентри* , не существует, этот метод создаст его.

##  <a name="writesectionint"></a>CWinAppEx:: Вритесектионинт

Записывает числовые данные в реестр.

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая относительный путь к разделу реестра.

*лпсзентри*<br/>
окне Строка, содержащая заданное значение.

*Nзначение*<br/>
окне Данные, записываемые в реестр.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется к разделу реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

Если ключ, заданный параметром *лпсзентри* , не существует, этот метод создаст его.

##  <a name="writesectionobject"></a>CWinAppEx:: Вритесектионобжект

Записывает данные, полученные от [класса CObject](../../mfc/reference/cobject-class.md) , в определенное значение реестра.

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая имя раздела реестра.

*лпсзентри*<br/>
окне Строка, содержащая имя устанавливаемого значения.

*obj*<br/>
окне Данные для хранения.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase)соответственно.

Если значение, заданное параметром *лпсзентри* , не существует в разделе реестра, указанном параметром *лпсзсубсектион*, этот метод создаст это значение.

##  <a name="writesectionstring"></a>CWinAppEx:: Вритесектионстринг

Записывает строковые данные в значение в реестре.

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Параметры

*лпсзсубсектион*<br/>
окне Строка, содержащая имя раздела реестра.

*лпсзентри*<br/>
окне Строка, содержащая заданное значение.

*лпсзвалуе*<br/>
окне Строковые данные для записи в реестр.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзсубсектион* не является абсолютным путем для записи реестра. Это относительный путь, который добавляется в конец раздела реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase)соответственно.

Если значение, заданное параметром *лпсзентри* , не существует в *лпсзсубсектион*, этот метод создаст его.

##  <a name="writestring"></a>CWinAppEx:: WriteString

Записывает строковые данные в реестр.

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Параметры

*лпсзентри*<br/>
окне Строка, содержащая имя раздела реестра.

*лпсзвалуе*<br/>
окне Данные для хранения.

### <a name="return-value"></a>Возвращаемое значение

Значение TRUE, если этот метод успешно выполнен; в противном случае — FALSE.

### <a name="remarks"></a>Remarks

Параметр *лпсзентри* — это имя записи реестра, расположенной в разделе реестра по умолчанию для приложения. Чтобы получить или задать раздел реестра по умолчанию, используйте методы [CWinAppEx:: жетрегистрибасе](#getregistrybase) и [CWinAppEx:: сетрегистрибасе](#setregistrybase) соответственно.

Если ключ, заданный параметром *лспзентри* , не существует, этот метод создаст его.

## <a name="see-also"></a>См. также раздел

[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Классы](../../mfc/reference/mfc-classes.md)<br/>
[Класс CWinApp](../../mfc/reference/cwinapp-class.md)<br/>
[Класс CMouseManager](../../mfc/reference/cmousemanager-class.md)<br/>
[Класс CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[Класс CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[Класс CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)
