---
title: Класс CDaoDatabase
ms.date: 09/17/2019
f1_keywords:
- CDaoDatabase
- AFXDAO/CDaoDatabase
- AFXDAO/CDaoDatabase::CDaoDatabase
- AFXDAO/CDaoDatabase::CanTransact
- AFXDAO/CDaoDatabase::CanUpdate
- AFXDAO/CDaoDatabase::Close
- AFXDAO/CDaoDatabase::Create
- AFXDAO/CDaoDatabase::CreateRelation
- AFXDAO/CDaoDatabase::DeleteQueryDef
- AFXDAO/CDaoDatabase::DeleteRelation
- AFXDAO/CDaoDatabase::DeleteTableDef
- AFXDAO/CDaoDatabase::Execute
- AFXDAO/CDaoDatabase::GetConnect
- AFXDAO/CDaoDatabase::GetName
- AFXDAO/CDaoDatabase::GetQueryDefCount
- AFXDAO/CDaoDatabase::GetQueryDefInfo
- AFXDAO/CDaoDatabase::GetQueryTimeout
- AFXDAO/CDaoDatabase::GetRecordsAffected
- AFXDAO/CDaoDatabase::GetRelationCount
- AFXDAO/CDaoDatabase::GetRelationInfo
- AFXDAO/CDaoDatabase::GetTableDefCount
- AFXDAO/CDaoDatabase::GetTableDefInfo
- AFXDAO/CDaoDatabase::GetVersion
- AFXDAO/CDaoDatabase::IsOpen
- AFXDAO/CDaoDatabase::Open
- AFXDAO/CDaoDatabase::SetQueryTimeout
- AFXDAO/CDaoDatabase::m_pDAODatabase
- AFXDAO/CDaoDatabase::m_pWorkspace
helpviewer_keywords:
- CDaoDatabase [MFC], CDaoDatabase
- CDaoDatabase [MFC], CanTransact
- CDaoDatabase [MFC], CanUpdate
- CDaoDatabase [MFC], Close
- CDaoDatabase [MFC], Create
- CDaoDatabase [MFC], CreateRelation
- CDaoDatabase [MFC], DeleteQueryDef
- CDaoDatabase [MFC], DeleteRelation
- CDaoDatabase [MFC], DeleteTableDef
- CDaoDatabase [MFC], Execute
- CDaoDatabase [MFC], GetConnect
- CDaoDatabase [MFC], GetName
- CDaoDatabase [MFC], GetQueryDefCount
- CDaoDatabase [MFC], GetQueryDefInfo
- CDaoDatabase [MFC], GetQueryTimeout
- CDaoDatabase [MFC], GetRecordsAffected
- CDaoDatabase [MFC], GetRelationCount
- CDaoDatabase [MFC], GetRelationInfo
- CDaoDatabase [MFC], GetTableDefCount
- CDaoDatabase [MFC], GetTableDefInfo
- CDaoDatabase [MFC], GetVersion
- CDaoDatabase [MFC], IsOpen
- CDaoDatabase [MFC], Open
- CDaoDatabase [MFC], SetQueryTimeout
- CDaoDatabase [MFC], m_pDAODatabase
- CDaoDatabase [MFC], m_pWorkspace
ms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d
ms.openlocfilehash: 4c594b1ddfc1464417506557bb8743c4979be677
ms.sourcegitcommit: 069e3833bd821e7d64f5c98d0ea41fc0c5d22e53
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2019
ms.locfileid: "74304286"
---
# <a name="cdaodatabase-class"></a>Класс CDaoDatabase

Представляет соединение с базой данных Access, использующей объекты доступа к данным (DAO). DAO поддерживается в Office 2013. Версия DAO 3,6 является окончательной и считается устаревшей.

## <a name="syntax"></a>Синтаксис

```
class CDaoDatabase : public CObject
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase:: CDaoDatabase](#cdaodatabase)|Создает объект `CDaoDatabase`. Вызовите `Open`, чтобы подключить объект к базе данных.|

### <a name="public-methods"></a>Общедоступные методы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase:: Кантрансакт](#cantransact)|Возвращает ненулевое значение, если база данных поддерживает транзакции.|
|[CDaoDatabase:: Канупдате](#canupdate)|Возвращает ненулевое значение, если объект `CDaoDatabase` является обновляемым (не только для чтения).|
|[CDaoDatabase:: Close](#close)|Закрывает подключение к базе данных.|
|[CDaoDatabase:: Create](#create)|Создает базовый объект базы данных DAO и инициализирует объект `CDaoDatabase`.|
|[CDaoDatabase:: Креатерелатион](#createrelation)|Определяет новое отношение между таблицами в базе данных.|
|[CDaoDatabase::D Елетекуеридеф](#deletequerydef)|Удаляет объект QueryDef, сохраненный в коллекции объектов QueryDef базы данных.|
|[CDaoDatabase::D Елетерелатион](#deleterelation)|Удаляет существующее отношение между таблицами в базе данных.|
|[CDaoDatabase::D Елететабледеф](#deletetabledef)|Удаляет определение таблицы в базе данных. При этом будет удалена фактическая таблица и все ее данные.|
|[CDaoDatabase:: Execute](#execute)|Выполняет запрос действия. Вызов `Execute` для запроса, возвращающего результаты, вызывает исключение.|
|[CDaoDatabase:: соединение](#getconnect)|Возвращает строку подключения, используемую для подключения объекта `CDaoDatabase` к базе данных. Используется для ODBC.|
|[CDaoDatabase:: Name](#getname)|Возвращает имя используемой в данный момент базы данных.|
|[CDaoDatabase:: Жеткуеридефкаунт](#getquerydefcount)|Возвращает число запросов, определенных для базы данных.|
|[CDaoDatabase:: Жеткуеридефинфо](#getquerydefinfo)|Возвращает сведения об указанном запросе, определенном в базе данных.|
|[CDaoDatabase:: GetQueryTimeout](#getquerytimeout)|Возвращает число секунд, по истечении которых время ожидания операций запроса базы данных истечет. Затрагивает все последующие операции открытия, добавления новых, обновления и изменения, а также другие операции с источниками данных ODBC (только для `Execute`ных вызовов).|
|[CDaoDatabase:: Жетрекордсаффектед](#getrecordsaffected)|Возвращает число записей, затронутых последними операциями обновления, изменения или добавления или вызовом `Execute`.|
|[CDaoDatabase:: Жетрелатионкаунт](#getrelationcount)|Возвращает число связей, определенных между таблицами в базе данных.|
|[CDaoDatabase:: Жетрелатионинфо](#getrelationinfo)|Возвращает сведения об указанной связи, определенной между таблицами в базе данных.|
|[CDaoDatabase:: Жеттабледефкаунт](#gettabledefcount)|Возвращает число таблиц, определенных в базе данных.|
|[CDaoDatabase:: Жеттабледефинфо](#gettabledefinfo)|Возвращает сведения о указанной таблице в базе данных.|
|[CDaoDatabase::/версия](#getversion)|Возвращает версию ядра СУБД, связанную с базой данных.|
|[CDaoDatabase:: OnOpen](#isopen)|Возвращает ненулевое значение, если объект `CDaoDatabase` в настоящее время подключен к базе данных.|
|[CDaoDatabase:: Open](#open)|Устанавливает соединение с базой данных.|
|[CDaoDatabase:: Getquerytimeout](#setquerytimeout)|Задает время ожидания в секундах, по истечении которого операции запроса базы данных (только для источников данных ODBC) будут истекает. Затрагивает все последующие операции открытия, добавления новых, обновления и удаления.|

### <a name="public-data-members"></a>Открытые элементы данных

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase:: m_pDAODatabase](#m_pdaodatabase)|Указатель на базовый объект базы данных DAO.|
|[CDaoDatabase:: m_pWorkspace](#m_pworkspace)|Указатель на объект [кдаоворкспаце](../../mfc/reference/cdaoworkspace-class.md) , который содержит базу данных и определяет пространство транзакции.|

## <a name="remarks"></a>Примечания

Дополнительные сведения о поддерживаемых форматах баз данных см. в описании функции члена [имени](../../mfc/reference/cdaoworkspace-class.md#getname) . В заданной рабочей области, представленной объектом [кдаоворкспаце](../../mfc/reference/cdaoworkspace-class.md) , можно активировать один или несколько объектов `CDaoDatabase`. Рабочая область содержит коллекцию открытых объектов базы данных, называемую коллекцией баз данных.

## <a name="usage"></a>Использование

Объекты базы данных можно создавать неявным образом при создании объектов набора записей. Но объекты базы данных также можно создавать явным образом. Чтобы явно использовать существующую базу данных с `CDaoDatabase`, выполните одно из следующих действий.

- Создайте объект `CDaoDatabase`, передав указатель на открытый объект [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md).

- Или создайте объект `CDaoDatabase` без указания рабочей области (MFC создает временный объект рабочей области).

Создание нового Microsoft Jet (. MDB), создайте объект `CDaoDatabase` и вызовите его функцию [CREATE](#create) -Member. *Не* вызывайте `Open` после `Create`.

Чтобы открыть существующую базу данных, создайте объект `CDaoDatabase` и вызовите его функцию [Open](#open) Member.

Любой из этих методов добавляет объект базы данных DAO в коллекцию баз данных рабочей области и открывает подключение к данным. При создании объектов [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [кдаотабледеф](../../mfc/reference/cdaotabledef-class.md)или [кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md) для работы в подключенной базе данных передайте конструкторы этих объектов в указатель на объект `CDaoDatabase`. По завершении использования соединения вызовите функцию [закрытия](#close) члена и удалите объект `CDaoDatabase`. `Close` закрывает все наборы записей, которые ранее не были закрыты.

## <a name="transactions"></a>Транзакции

Обработка транзакций базы данных предоставляется на уровне рабочей области — см. раздел функции-члены [примеры BeginTrans](../../mfc/reference/cdaoworkspace-class.md#begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#committrans)и [ROLLBACK](../../mfc/reference/cdaoworkspace-class.md#rollback) класса `CDaoWorkspace`.

## <a name="odbc-connections"></a>Подключения ODBC

Для работы с источниками данных ODBC рекомендуется присоединять внешние таблицы к Microsoft Jet (. MDB) база данных.

## <a name="collections"></a>Коллекции

Каждая база данных поддерживает собственные коллекции объектов tabledef, QueryDef, Recordset и relation. Класс `CDaoDatabase` предоставляет функции элементов для управления этими объектами.

> [!NOTE]
>  Объекты хранятся в DAO, а не в объекте базы данных MFC. MFC предоставляет классы для объектов tabledef, QueryDef и Recordset, но не для объектов связи.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoDatabase`

## <a name="requirements"></a>Требования

**Заголовок:** афксдао. h

##  <a name="cantransact"></a>CDaoDatabase:: Кантрансакт

Вызовите эту функцию члена, чтобы определить, допускает ли база данных транзакции.

```
BOOL CanTransact();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если база данных поддерживает транзакции; в противном случае — 0.

### <a name="remarks"></a>Примечания

Управление транзакциями осуществляется в рабочей области базы данных.

##  <a name="canupdate"></a>CDaoDatabase:: Канупдате

Вызовите эту функцию члена, чтобы определить, допускает ли объект `CDaoDatabase` обновления.

```
BOOL CanUpdate();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект `CDaoDatabase` допускает обновления; в противном случае — значение 0, указывающее, что вы передали TRUE в *бреадонли* при открытии объекта `CDaoDatabase` или что сама база данных доступна только для чтения. См. функцию [Open](#open) Member.

### <a name="remarks"></a>Примечания

Сведения о возможностях обновления базы данных см. в разделе "обновляемое свойство" справки DAO.

##  <a name="cdaodatabase"></a>CDaoDatabase:: CDaoDatabase

Создает объект `CDaoDatabase`.

```
CDaoDatabase(CDaoWorkspace* pWorkspace = NULL);
```

### <a name="parameters"></a>Параметры

*пворкспаце*<br/>
Указатель на объект `CDaoWorkspace`, который будет содержать новый объект базы данных. Если вы принимаете значение по умолчанию NULL, конструктор создает временный объект `CDaoWorkspace`, использующий рабочую область DAO по умолчанию. Указатель на объект рабочей области можно получить через элемент данных [m_pWorkspace](#m_pworkspace) .

### <a name="remarks"></a>Примечания

Если вы создаете новый объект Microsoft Jet (. MDB), вызовите функцию-член [CREATE](#create) объекта. Если вместо этого открывается существующая база данных, вызовите функцию [открытого](#open) члена объекта.

После завершения работы с объектом следует вызвать его [закрытую](#close) функцию Member, а затем уничтожить объект `CDaoDatabase`.

Может оказаться удобным внедрить объект `CDaoDatabase` в класс документа.

> [!NOTE]
>  Объект `CDaoDatabase` также создается неявно при открытии объекта [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) без передачи указателя на существующий объект `CDaoDatabase`. Этот объект базы данных закрывается при закрытии объекта набора записей.

##  <a name="close"></a>CDaoDatabase:: Close

Вызовите эту функцию-член, чтобы отключиться от базы данных и закрыть все открытые наборы записей, объекты tabledef и QueryDef, связанные с базой данных.

```
virtual void Close();
```

### <a name="remarks"></a>Примечания

Перед вызовом этой функции-члена рекомендуется закрыть эти объекты самостоятельно. При закрытии объекта `CDaoDatabase` он удаляется из коллекции баз данных в связанной [рабочей области](../../mfc/reference/cdaoworkspace-class.md). Поскольку `Close` не уничтожает `CDaoDatabase` объект, можно повторно использовать объект, открыв ту же базу данных или другую базу данных.

> [!CAUTION]
>  Вызовите функцию-член [Update](../../mfc/reference/cdaorecordset-class.md#update) (при наличии ожидающих изменений) и функцию-член `Close` во всех открытых объектах набора записей перед закрытием базы данных. При выходе из функции, которая объявляет объекты [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) или `CDaoDatabase` в стеке, база данных закрывается, все несохраненные изменения теряются, все ожидающие транзакции откатываются и все ожидающие изменения данных теряются.

> [!CAUTION]
>  При попытке закрыть объект базы данных при открытии любого объекта набора записей или при попытке закрыть объект рабочей области, когда все объекты базы данных, принадлежащие этой конкретной рабочей области, открыты, эти объекты набора записей будут закрыты, а все ожидающие обновления или изменения будут выполнен откат. При попытке закрыть объект рабочей области, когда все объекты базы данных, принадлежащие ей, открыты, операция закрывает все объекты базы данных, принадлежащие определенному объекту рабочей области, что может привести к закрытию незакрытых объектов набора записей. Если не закрыть объект базы данных, MFC сообщает об ошибке утверждения в отладочных сборках.

Если объект базы данных определен вне области действия функции и функция завершается без закрытия, то объект базы данных остается открытым до тех пор, пока не будет закрыт явным образом, или если модуль, в котором он определен, находится вне области действия.

##  <a name="create"></a>CDaoDatabase:: Create

Создание нового Microsoft Jet (. MDB), вызовите эту функцию-член после создания объекта `CDaoDatabase`.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int dwOptions = 0);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Строковое выражение, которое представляет собой имя создаваемого файла базы данных. Это может быть полный путь и имя файла, например "C:\\\МИДБ. MDB ". Необходимо указать имя. Если не указать расширение имени файла,. Добавляется MDB. Если сеть поддерживает соглашение об универсальных именах (UNC), можно также указать сетевой путь, например "\\\\\\\МИСЕРВЕР\\\МИШАРЕ\\\МИДИР\\\МИДБ". Только Microsoft Jet (. MDB). файлы базы данных могут быть созданы с помощью этой функции-члена. (В строковых литералах требуется двойная обратная косая черта, так как " C++\\" является escape-символом.)

*лпсзлокале*<br/>
Строковое выражение, используемое для указания порядка сортировки при создании базы данных. Значение по умолчанию — `dbLangGeneral`. Возможные значения:

- `dbLangGeneral` английский, немецкий, французский, португальский, итальянский и современный испанский

- `dbLangArabic` Арабский

- `dbLangCyrillic` Русский

- `dbLangCzech` чешский

- `dbLangDutch` Голландский

- `dbLangGreek` Греческий

- `dbLangHebrew` иврит

- `dbLangHungarian` Венгерский

- `dbLangIcelandic` Исландский

- `dbLangNordic` скандинавские языки (только для ядра СУБД Microsoft Jet версии 1,0)

- `dbLangNorwdan` норвежский и датский

- `dbLangPolish` польский

- `dbLangSpanish` традиционный испанский

- `dbLangSwedfin` шведский и финский

- `dbLangTurkish` Турецкий

*двоптионс*<br/>
Целое число, указывающее один или несколько параметров. Возможные значения:

- `dbEncrypt` создать зашифрованную базу данных.

- `dbVersion10` создать базу данных с базой данных Microsoft Jet версии 1,0.

- `dbVersion11` создать базу данных с базой данных Microsoft Jet версии 1,1.

- `dbVersion20` создать базу данных с базой данных Microsoft Jet версии 2,0.

- `dbVersion30` создать базу данных с базой данных Microsoft Jet версии 3,0.

Если опустить константу шифрования, создается незашифрованная база данных. Можно указать только одну константу версии. Если опустить константу версии, то будет создана база данных, использующая базу данных Microsoft Jet версии 3,0.

> [!CAUTION]
>  Если база данных не зашифрована, можно, даже если вы реализуете безопасность пользователей и паролей, чтобы напрямую считать файл двоичного диска, составляющий базу данных.

### <a name="remarks"></a>Примечания

`Create` создает файл базы данных и базовый объект базы данных DAO и инициализирует C++ объект. Объект добавляется в коллекцию баз данных связанной рабочей области. Объект базы данных находится в открытом состоянии. не вызывайте `Open*` после `Create`.

> [!NOTE]
>  С помощью `Create`можно создать только Microsoft Jet (. MDB) базы данных. Нельзя создавать базы данных ISAM или ODBC.

##  <a name="createrelation"></a>CDaoDatabase:: Креатерелатион

Вызовите эту функцию-член, чтобы установить связь между одним или несколькими полями в основной таблице базы данных и одним или несколькими полями в внешней таблице (другой таблице в базе данных).

```
void CreateRelation(
    LPCTSTR lpszName,
    LPCTSTR lpszTable,
    LPCTSTR lpszForeignTable,
    long lAttributes,
    LPCTSTR lpszField,
    LPCTSTR lpszForeignField);

void CreateRelation(CDaoRelationInfo& relinfo);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Уникальное имя объекта связи. Имя должно начинаться с буквы и может содержать не более 40 символов. Он может содержать цифры и символы подчеркивания, но не может содержать знаки препинания и пробелы.

*лпсзтабле*<br/>
Имя основной таблицы в связи. Если таблица не существует, MFC создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md).

*лпсзфореигнтабле*<br/>
Имя внешней таблицы в связи. Если таблица не существует, MFC вызывает исключение типа `CDaoException`.

*латтрибутес*<br/>
Значение типа Long, содержащее сведения о типе связи. Это значение можно использовать для обеспечения ссылочной целостности, помимо прочего. Оператор побитового или ( **&#124;** ) можно использовать для объединения любого из следующих значений (если это сочетание имеет смысл):

- `dbRelationUnique` связь "один к одному".

- `dbRelationDontEnforce` связь не применяется принудительно (без ссылочной целостности).

- `dbRelationInherited` связь существует в нетекущей базе данных, содержащей две соединяемые таблицы.

- `dbRelationUpdateCascade` обновления будут каскадными (Дополнительные сведения см. в разделе "Примечания").

- `dbRelationDeleteCascade` удаления будут каскадными.

*лпсзфиелд*<br/>
Указатель на строку с завершающим нулем, содержащую имя поля в основной таблице (с именем *лпсзтабле*).

*лпсзфореигнфиелд*<br/>
Указатель на строку с завершающим нулем, содержащую имя поля во внешней таблице (с именем *лпсзфореигнтабле*).

*релинфо*<br/>
Ссылка на объект [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) , содержащий сведения о связи, которую необходимо создать.

### <a name="remarks"></a>Примечания

Связь не может содержать запрос или присоединенную таблицу из внешней базы данных.

Используйте первую версию функции, если связь включает одно поле в каждой из двух таблиц. Используйте вторую версию, если связь включает несколько полей. Максимальное число полей в отношении равно 14.

Это действие создает базовый объект DAO relation, но это сведения о реализации MFC, так как инкапсуляция MFC объектов отношений содержится в классе `CDaoDatabase`. MFC не предоставляет класс для отношений.

Если задать атрибуты объекта связи для активации операций Cascade, то ядро СУБД автоматически обновит или удалит записи в одной или нескольких таблицах при внесении изменений в связанные таблицы первичного ключа.

Например, предположим, что вы установили связь каскадного удаления между таблицей Customers и таблицей Orders. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанной с этим клиентом. Кроме того, при установлении связей Cascade DELETE между таблицей Orders и другими таблицами записи из этих таблиц автоматически удаляются при удалении записей из таблицы Customers.

Связанные сведения см. в разделе «метод Креатерелатион» справки DAO.

##  <a name="deletequerydef"></a>CDaoDatabase::D Елетекуеридеф

Вызовите эту функцию-член, чтобы удалить указанный объект QueryDef (сохраненный запрос) из коллекции QueryDef объекта `CDaoDatabase`.

```
void DeleteQueryDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Имя сохраненного запроса для удаления.

### <a name="remarks"></a>Примечания

После этого запрос больше не будет определен в базе данных.

Сведения о создании объектов QueryDef см. в разделе Class [кдаокуеридеф](../../mfc/reference/cdaoquerydef-class.md). Объект QueryDef связывается с определенным объектом `CDaoDatabase` при создании `CDaoQueryDef` объекта, передавая ему указатель на объект базы данных.

##  <a name="deleterelation"></a>CDaoDatabase::D Елетерелатион

Вызовите эту функцию члена, чтобы удалить существующее отношение из коллекции связей объекта базы данных.

```
void DeleteRelation(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Имя удаляемой связи.

### <a name="remarks"></a>Примечания

После этого отношение больше не существует.

Связанные сведения см. в разделе «Удаление метода» справки DAO.

##  <a name="deletetabledef"></a>CDaoDatabase::D Елететабледеф

Вызовите эту функцию члена, чтобы удалить указанную таблицу и все ее данные из коллекции TableDefs объекта `CDaoDatabase`.

```
void DeleteTableDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Имя удаляемого объекта tabledef.

### <a name="remarks"></a>Примечания

После этого таблица больше не будет определена в базе данных.

> [!NOTE]
>  Будьте внимательны, чтобы не удалять системные таблицы.

Дополнительные сведения о создании объектов tabledef см. в разделе Class [кдаотабледеф](../../mfc/reference/cdaotabledef-class.md). Объект tabledef связывается с определенным объектом `CDaoDatabase` при создании `CDaoTableDef` объекта, передавая ему указатель на объект базы данных.

Связанные сведения см. в разделе «Удаление метода» справки DAO.

##  <a name="execute"></a>CDaoDatabase:: Execute

Вызовите эту функцию-член, чтобы выполнить запрос действия или выполнить инструкцию SQL для базы данных.

```
void Execute(
    LPCTSTR lpszSQL,
    int nOptions = dbFailOnError);
```

### <a name="parameters"></a>Параметры

*lpszSQL*<br/>
Указатель на строку, завершающуюся нулем, которая содержит допустимую команду SQL для выполнения.

*ноптионс*<br/>
Целое число, задающее параметры, относящиеся к целостности запроса. Оператор побитового или ( **&#124;** ) можно использовать для объединения любой из следующих констант (при условии, что это сочетание имеет смысл, например, не следует объединять `dbInconsistent` с `dbConsistent`):

- `dbDenyWrite` запретить разрешение на запись другим пользователям.

- непоследовательные обновления `dbInconsistent` (по умолчанию).

- `dbConsistent` последовательных обновлений.

- `dbSQLPassThrough` SQL Pass. Вызывает передачу инструкции SQL в источник данных ODBC для обработки.

- `dbFailOnError` выполнить откат обновлений при возникновении ошибки.

- `dbSeeChanges` создать ошибку времени выполнения, если измененные данные изменяются другим пользователем.

> [!NOTE]
>  Если включены и `dbInconsistent`, и `dbConsistent` или если ни одно из них не включено, результат будет по умолчанию. Описание этих констант см. в разделе "выполнение метода" справки DAO.

### <a name="remarks"></a>Примечания

`Execute` работает только для запросов действий или запросов к серверу SQL, которые не возвращают результаты. Он не работает для запросов SELECT, которые возвращают записи.

Описание и сведения о запросах действий см. в разделах «запрос действия» и «выполнение метода» справки DAO.

> [!TIP]
>  При наличии синтаксически правильных инструкций SQL и соответствующих разрешений функция-член `Execute` не будет работать, даже если не удается изменить или удалить одну строку. Поэтому всегда используйте параметр `dbFailOnError` при использовании функции члена `Execute` для выполнения запроса UPDATE или DELETE. Этот параметр приводит к тому, что MFC создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md) и откатывает все успешные изменения, если какая либо из затронутых записей заблокирована и не может быть обновлена или удалена. Обратите внимание, что вы всегда можете вызвать `GetRecordsAffected`, чтобы узнать, сколько записей было затронуто.

Вызовите функцию члена [жетрекордсаффектед](#getrecordsaffected) объекта Database, чтобы определить количество записей, затронутых последним вызовом `Execute`. Например, `GetRecordsAffected` возвращает сведения о количестве записей, удаленных, обновленных или вставленных при выполнении запроса на выполнение действия. Возвращенное число не будет отражать изменения в связанных таблицах, если действуют каскадные обновления или удаления.

`Execute` не возвращает набор записей. Использование `Execute` в запросе, выбирающем записи, приводит к созданию исключения типа `CDaoException`в MFC. (Отсутствует `ExecuteSQL` функция-член, аналогичная `CDatabase::ExecuteSQL`.)

##  <a name="getconnect"></a>CDaoDatabase:: соединение

Вызовите эту функцию члена, чтобы получить строку подключения, используемую для подключения объекта `CDaoDatabase` к базе данных ODBC или ISAM.

```
CString GetConnect();
```

### <a name="return-value"></a>Возвращаемое значение

Строка подключения при успешном вызове [Open](#open) для источника данных ODBC; в противном случае — пустая строка. Для Microsoft Jet (. MDB). строка всегда пуста, если она не задана для использования с параметром `dbSQLPassThrough`, который используется с функцией [EXECUTE](#execute) -Member или используется при открытии набора записей.

### <a name="remarks"></a>Примечания

Строка содержит сведения об источнике открытой базы данных или базе данных, используемой в транзитном запросе. Строка подключения состоит из спецификатора типа базы данных и одного или нескольких параметров, разделенных точкой с запятой.

> [!NOTE]
>  Использование классов DAO MFC для подключения к источнику данных через ODBC менее эффективно, чем подключение через присоединенную таблицу.

> [!NOTE]
>  Строка подключения используется для передачи дополнительных сведений в ODBC и определенных драйверах ISAM при необходимости. Он не используется для. Базы данных MDB. Для базовых таблиц базы данных Microsoft Jet строка подключения является пустой строкой (""), за исключением случаев, когда она используется для сквозного запроса SQL, как описано в разделе возвращаемое значение выше.

Описание того, как создается строка подключения, см. в описании функции [Open](#open) Member. После того как строка подключения будет установлена в вызове `Open`, ее можно будет использовать для проверки параметра, чтобы определить тип, путь, идентификатор пользователя, пароль или источник данных ODBC базы данных.

##  <a name="getname"></a>CDaoDatabase:: Name

Вызовите эту функцию-член, чтобы получить имя существующей базы данных, которая представляет собой имя существующего файла базы данных или имя зарегистрированного источника данных ODBC.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Полный путь и имя файла базы данных в случае успешного выполнения; в противном случае — пустой [CString](../../atl-mfc-shared/reference/cstringt-class.md).

### <a name="remarks"></a>Примечания

Если сеть поддерживает соглашение об универсальных именах (UNC), можно также указать сетевой путь, например "\\\\\\\МИСЕРВЕР\\\МИШАРЕ\\\МИДИР\\\МИДБ. MDB ". (В строковых литералах требуется двойная обратная косая черта, так как " C++\\" является escape-символом.)

Например, вы должны отобразить это имя в заголовке. При возникновении ошибки во время извлечения имени MFC создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md).

> [!NOTE]
>  Для повышения производительности при обращении к внешним базам данных рекомендуется присоединить внешние таблицы базы данных к базе данных Microsoft Jet (. MDB) вместо прямого подключения к источнику данных.

Тип базы данных определяется файлом или каталогом, на который указывает путь, следующим образом:

|Путь указывает на..|Тип базы данных|
|--------------------------|-------------------|
|. Файл MDB|База данных Microsoft Jet (Microsoft Access)|
|Каталог, содержащий. DBF-файлов|база данных dBASE|
|Каталог, содержащий. Файл XLS|База данных Microsoft Excel|
|Каталог, содержащий. PDX-файлы|База данных Paradox|
|Каталог, содержащий файлы соответствующей текстовой базы данных|База данных в текстовом формате|

Для баз данных ODBC, таких как SQL Server и Oracle, строка подключения базы данных определяет имя источника данных (DSN), зарегистрированное в ODBC.

##  <a name="getquerydefcount"></a>CDaoDatabase:: Жеткуеридефкаунт

Вызовите эту функцию члена, чтобы получить количество запросов, определенных в коллекции QueryDef базы данных.

```
short GetQueryDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число запросов, определенных в базе данных.

### <a name="remarks"></a>Примечания

`GetQueryDefCount` удобно использовать, если необходимо прокручивать все QueryDef в коллекции QueryDef. Сведения о получении сведений об определенном запросе в коллекции см. в разделе [жеткуеридефинфо](#getquerydefinfo).

##  <a name="getquerydefinfo"></a>CDaoDatabase:: Жеткуеридефинфо

Вызывайте эту функцию-член для получения различных видов информации о запросе, определенном в базе данных.

```
void GetQueryDefInfo(
    int nIndex,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetQueryDefInfo(
    LPCTSTR lpszName,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Индекс предопределенного запроса в коллекции QueryDef базы данных для поиска по индексу.

*куеридефинфо*<br/>
Ссылка на объект [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) , который возвращает запрошенную информацию.

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о наборе записей необходимо извлечь. Ниже перечислены доступные параметры, а также то, что приводит к возвращению функцией сведений о наборе записей.

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), введите

- AFX_DAO_SECONDARY_INFO первичной информации и: Дата создания, Дата последнего обновления, возвращаемые записи, обновляемые

- AFX_DAO_ALL_INFO основную и дополнительную информацию, а также: SQL, Connect, Одбктимеаут

*лпсзнаме*<br/>
Строка, содержащая имя запроса, определенного в базе данных, для поиска по имени.

### <a name="remarks"></a>Примечания

Предоставляются две версии функции, поэтому можно выбрать запрос по индексу в коллекции QueryDef базы данных или по имени запроса.

Описание сведений, возвращаемых в *куеридефинфо*, см. в разделе Структура [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. Если вы запрашиваете один уровень информации, вы также получаете все предыдущие уровни информации.

##  <a name="getquerytimeout"></a>CDaoDatabase:: GetQueryTimeout

Вызовите эту функцию члена, чтобы получить текущее количество секунд, которое будет разрешено до истечения времени ожидания последующих операций в подключенной базе данных.

```
short GetQueryTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Короткое целое число, содержащее значение времени ожидания в секундах.

### <a name="remarks"></a>Примечания

Время ожидания операции может истекает из-за проблем с доступом к сети, чрезмерного времени обработки запросов и т. д. Пока параметр действует, он влияет на все операции открытия, добавления новых, обновления и удаления для всех наборов записей, связанных с данным объектом `CDaoDatabase`. Текущий параметр времени ожидания можно изменить, вызвав [getquerytimeout](#setquerytimeout). Изменение значения времени ожидания запроса после открытия не приводит к изменению значения для набора записей. Например, последующие операции [перемещения](../../mfc/reference/cdaorecordset-class.md#move) не используют новое значение. Значение по умолчанию изначально задается при инициализации ядра СУБД.

Значение времени ожидания запроса по умолчанию берется из реестра Windows. Если параметр реестра отсутствует, по умолчанию используется значение 60 секунд. Не все базы данных поддерживают возможность установки значения времени ожидания запроса. Если задать значение времени ожидания запроса 0, время ожидания не произойдет; и связь с базой данных может перестать отвечать на запросы. Такое поведение может быть полезно во время разработки. Если вызов завершается неудачей, MFC создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md).

Связанные сведения см. в разделе "свойство QueryTimeout" справки DAO.

##  <a name="getrecordsaffected"></a>CDaoDatabase:: Жетрекордсаффектед

Вызовите эту функцию члена, чтобы определить количество записей, затронутых последним вызовом функции [EXECUTE](#execute) Member.

```
long GetRecordsAffected();
```

### <a name="return-value"></a>Возвращаемое значение

Длинное целое число, содержащее количество затронутых записей.

### <a name="remarks"></a>Примечания

Возвращаемое значение включает число записей, удаленных, обновленных или вставленных запросом действия, выполненным с `Execute`. Возвращенное число не будет отражать изменения в связанных таблицах, если действуют каскадные обновления или удаления.

Связанные сведения см. в разделе «свойство Рекордсаффектед» справки DAO.

##  <a name="getrelationcount"></a>CDaoDatabase:: Жетрелатионкаунт

Вызовите эту функцию члена, чтобы получить количество связей, определенных между таблицами в базе данных.

```
short GetRelationCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число связей, определенных между таблицами в базе данных.

### <a name="remarks"></a>Примечания

`GetRelationCount` удобно использовать, если необходимо прокручивать все определенные связи в коллекции связей базы данных. Сведения о получении сведений об определенном отношении в коллекции см. в разделе [жетрелатионинфо](#getrelationinfo).

Чтобы проиллюстрировать понятие отношения, рассмотрим таблицу «Поставщики» и таблицу «Товары», которая может иметь связь «один ко многим». В этой связи один поставщик может предоставить более одного продукта. Другие отношения — "один к одному" и "многие ко многим".

##  <a name="getrelationinfo"></a>CDaoDatabase:: Жетрелатионинфо

Вызовите эту функцию-член для получения сведений об указанной связи в коллекции связей базы данных.

```
void GetRelationInfo(
    int nIndex,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetRelationInfo(
    LPCTSTR lpszName,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Индекс объекта связи в коллекции связей базы данных для поиска по индексу.

*релинфо*<br/>
Ссылка на объект [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) , который возвращает запрошенную информацию.

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о связи необходимо извлечь. Ниже перечислены доступные параметры, а также то, что приводит к возвращению функцией сведений о связи:

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), таблица, внешняя таблица

- Атрибуты AFX_DAO_SECONDARY_INFO, сведения о полях

Сведения о поле представляют собой объект [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) , содержащий поля из основной таблицы, участвующей в связи.

*лпсзнаме*<br/>
Строка, содержащая имя объекта связи для поиска по имени.

### <a name="remarks"></a>Примечания

Две версии этой функции предоставляют доступ либо по индексу, либо по имени. Описание сведений, возвращаемых в *релинфо*, см. в разделе Структура [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. Если запросить информацию на одном уровне, вы также получите информацию на любом из предыдущих уровней.

> [!NOTE]
>  Если задать атрибуты объекта отношения для активации операций Cascade (`dbRelationUpdateCascades` или `dbRelationDeleteCascades`), то ядро базы данных Microsoft Jet автоматически обновит или удалит записи в одной или нескольких таблицах при внесении изменений в связанные таблицы первичного ключа. Например, предположим, что вы установили связь каскадного удаления между таблицей Customers и таблицей Orders. При удалении записей из таблицы Customers также удаляются записи в таблице Orders, связанной с этим клиентом. Кроме того, при установлении связей Cascade DELETE между таблицей Orders и другими таблицами записи из этих таблиц автоматически удаляются при удалении записей из таблицы Customers.

##  <a name="gettabledefcount"></a>CDaoDatabase:: Жеттабледефкаунт

Вызовите эту функцию члена, чтобы получить количество таблиц, определенных в базе данных.

```
short GetTableDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число tabledef, определенных в базе данных.

### <a name="remarks"></a>Примечания

`GetTableDefCount` удобно использовать, если необходимо прокручивать все tabledef в коллекции TableDef базы данных. Сведения о получении сведений об указанной таблице в коллекции см. в разделе [жеттабледефинфо](#gettabledefinfo).

##  <a name="gettabledefinfo"></a>CDaoDatabase:: Жеттабледефинфо

Вызывайте эту функцию-член для получения различных видов информации о таблице, определенной в базе данных.

```
void GetTableDefInfo(
    int nIndex,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetTableDefInfo(
    LPCTSTR lpszName,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*ниндекс*<br/>
Индекс объекта tabledef в коллекции объектов TableDef базы данных для поиска по индексу.

*табледефинфо*<br/>
Ссылка на объект [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) , который возвращает запрошенную информацию.

*двинфуптионс*<br/>
Параметры, указывающие, какие сведения о таблице необходимо извлечь. Ниже перечислены доступные параметры, а также то, что приводит к возвращению функцией сведений о связи:

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), обновляемый, атрибуты

- AFX_DAO_SECONDARY_INFO первичной информации и: Дата создания, Дата последнего обновления, имя исходной таблицы, подключение

- AFX_DAO_ALL_INFO первичной и дополнительной информации плюс: правило проверки, текст проверки, число записей

*лпсзнаме*<br/>
Имя объекта tabledef для поиска по имени.

### <a name="remarks"></a>Примечания

Предоставляются две версии функции, поэтому можно выбрать таблицу по индексу в коллекции TableDefs базы данных или по имени таблицы.

Описание сведений, возвращаемых в *табледефинфо*, см. в разделе Структура [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) . Эта структура содержит элементы, соответствующие элементам приведенных выше данных в описании *двинфуптионс*. Если вы запрашиваете информацию на одном уровне, вы также получаете информацию для всех предыдущих уровней.

> [!NOTE]
>  Параметр AFX_DAO_ALL_INFO предоставляет сведения, которые могут быть слишком длительными для получения. В этом случае подсчет записей в таблице может занять очень много времени при наличии большого количества записей.

##  <a name="getversion"></a>CDaoDatabase::/версия

Вызовите эту функцию члена, чтобы определить версию файла базы данных Microsoft Jet.

```
CString GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

Значение [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающее версию файла базы данных, связанного с объектом.

### <a name="remarks"></a>Примечания

Возвращаемое значение представляет номер версии в формате "основной. дополнительный"; Например, "3,0". Номер версии продукта (например, 3,0) состоит из номера версии (3), точки и номера выпуска (0). Версии до даты — 1,0, 1,1, 2,0 и 3,0.

Связанные сведения см. в разделе «свойство Version» справки DAO.

##  <a name="isopen"></a>CDaoDatabase:: OnOpen

Вызовите эту функцию-член, чтобы определить, открыт ли объект `CDaoDatabase` в базе данных.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если объект `CDaoDatabase` открыт в данный момент; в противном случае — 0.

### <a name="remarks"></a>Примечания

##  <a name="m_pdaodatabase"></a>CDaoDatabase:: m_pDAODatabase

Содержит указатель на интерфейс OLE для объекта базы данных DAO, лежащего в основе объекта `CDaoDatabase`.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если требуется прямой доступ к интерфейсу DAO.

Дополнительные сведения о непосредственном вызове DAO см. в [техническом примечании 54](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

##  <a name="m_pworkspace"></a>CDaoDatabase:: m_pWorkspace

Содержит указатель на объект [кдаоворкспаце](../../mfc/reference/cdaoworkspace-class.md) , содержащий объект базы данных.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если вам нужно напрямую обратиться к рабочей области, например для получения указателей на другие объекты базы данных в коллекции баз данных рабочей области.

##  <a name="open"></a>CDaoDatabase:: Open

Эту функцию-член необходимо вызвать для инициализации вновь созданного объекта `CDaoDatabase`, который представляет существующую базу данных.

```
virtual void Open(
    LPCTSTR lpszName,
    BOOL bExclusive = FALSE,
    BOOL bReadOnly = FALSE,
    LPCTSTR lpszConnect = _T(""));
```

### <a name="parameters"></a>Параметры

*лпсзнаме*<br/>
Строковое выражение, которое является именем существующего Microsoft Jet (. MDB) файл базы данных. Если имя файла имеет расширение, оно является обязательным. Если сеть поддерживает соглашение об универсальных именах (UNC), можно также указать сетевой путь, например "\\\\\\\МИСЕРВЕР\\\МИШАРЕ\\\МИДИР\\\МИДБ. MDB ". (В строковых литералах требуется двойная обратная косая черта, так как " C++\\" является escape-символом.)

При использовании *лпсзнаме*применяются некоторые рекомендации. Если это так:

- Ссылается на базу данных, которая уже открыта для монопольного доступа другим пользователем, MFC создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md). Перехват этого исключения, чтобы сообщить пользователю о недоступности базы данных.

- — Это пустая строка (""), а *лпсзконнект* — "ODBC;", появится диалоговое окно со списком всех зарегистрированных имен источников данных ODBC, чтобы пользователь мог выбрать базу данных. Следует избегать прямых соединений с источниками данных ODBC. Вместо этого используйте присоединенную таблицу.

- В противном случае не ссылается на существующую базу данных или допустимое имя источника данных ODBC, MFC вызывает исключение типа `CDaoException`.

> [!NOTE]
>  Дополнительные сведения о кодах ошибок DAO см. в разделе ДАОЕРР. H файл. Дополнительные сведения см. в разделе "ошибки доступа к обрабатываемым данным" справки DAO.

*бексклусиве*<br/>
Логическое значение, равное TRUE, если база данных должна быть открыта для монопольного доступа (необщий), и FALSE, если база данных должна быть открыта для общего доступа. Если опустить этот аргумент, база данных будет открыта для общего доступа.

*бреадонли*<br/>
Логическое значение, равное TRUE, если база данных должна быть открыта только для чтения, и значение FALSE, если база данных должна быть открыта для доступа на чтение и запись. Если опустить этот аргумент, база данных будет открыта для доступа на чтение и запись. Этот атрибут наследуется всеми зависимыми наборами записей.

*лпсзконнект*<br/>
Строковое выражение, используемое для открытия базы данных. Эта строка представляет аргументы ODBC Connect. Для предоставления исходной строки необходимо предоставить аргументы исключительного доступа и только для чтения. Если база данных является базой данных Microsoft Jet (. MDB), эта строка пуста (""). Синтаксис значения по умолчанию — **_T**("") — обеспечивает переносимость для Юникода, а также сборки приложения в кодировке ANSI.

### <a name="remarks"></a>Примечания

`Open` связывает базу данных с базовым объектом DAO. Нельзя использовать объект базы данных для создания объектов Recordset, tabledef или QueryDef до инициализации. `Open` добавляет объект базы данных в коллекцию баз данных связанной рабочей области.

Используйте следующие параметры:

- При открытии Microsoft Jet (. MDB), используйте параметр *лпсзнаме* и передайте пустую строку для параметра *лпсзконнект* или передайте строку пароля в формате "; PWD = пароль ", если база данных защищена паролем (. Только базы данных MDB).

- При открытии источника данных ODBC передайте допустимую строку подключения ODBC в *лпсзконнект* и пустую строку в *лпсзнаме*.

Связанные сведения см. в разделе «метод Опендатабасе» справки DAO.

> [!NOTE]
>  Для повышения производительности при доступе к внешним базам данных, включая базы данных ISAM и источники данных ODBC, рекомендуется присоединять внешние таблицы базы данных к базе данных ядра Microsoft Jet (. MDB) вместо прямого подключения к источнику данных.

Время ожидания соединения может истекает, если, например, узел СУБД недоступен. Если попытка соединения завершается неудачей, `Open` создает исключение типа [кдаоексцептион](../../mfc/reference/cdaoexception-class.md).

Остальные примечания применяются только к базам данных ODBC.

Если база данных является базой данных ODBC и параметры в вызове `Open` не содержат достаточно сведений для подключения, драйвер ODBC открывает диалоговое окно для получения необходимых сведений от пользователя. При вызове `Open`строка подключения, *лпсзконнект*, сохраняется в частном порядке и доступна путем вызова функции-члена [соединения](#getconnect) .

При желании можно открыть собственное диалоговое окно перед вызовом `Open` для получения сведений от пользователя, например пароля, а затем добавить эти сведения в строку подключения, которая передается `Open`. Или можно сохранить переданную строку подключения (возможно, в реестре Windows), чтобы ее можно было повторно использовать при следующем вызове приложения `Open` для объекта `CDaoDatabase`.

Можно также использовать строку подключения для нескольких уровней авторизации имени входа (для каждого другого объекта `CDaoDatabase`) или для передачи других сведений, относящихся к базе данных.

##  <a name="setquerytimeout"></a>CDaoDatabase:: Getquerytimeout

Вызовите эту функцию члена, чтобы переопределить количество секунд по умолчанию, которое будет разрешено до истечения времени ожидания последующих операций в подключенной базе данных.

```
void SetQueryTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*нсекондс*<br/>
Количество секунд, которое необходимо разрешить до истечения времени ожидания попытки запроса.

### <a name="remarks"></a>Примечания

Время ожидания операции может истекает из-за проблем с доступом к сети, чрезмерного времени обработки запросов и т. д. Перед открытием набора записей или перед вызовом `SetQueryTimeout` функций-членов [AddNew](../../mfc/reference/cdaorecordset-class.md#addnew), [Update](../../mfc/reference/cdaorecordset-class.md#update) или [Delete](../../mfc/reference/cdaorecordset-class.md#delete) набора записей, если требуется изменить значение времени ожидания запроса. Этот параметр влияет на все [последующие вызовы](../../mfc/reference/cdaorecordset-class.md#open), `AddNew`, `Update`и `Delete` обращения к любым наборам записей, связанным с этим объектом `CDaoDatabase`. Изменение значения времени ожидания запроса после открытия не приводит к изменению значения для набора записей. Например, последующие операции [перемещения](../../mfc/reference/cdaorecordset-class.md#move) не используют новое значение.

Значение времени ожидания запроса по умолчанию составляет 60 секунд. Не все базы данных поддерживают возможность установки значения времени ожидания запроса. Если задать значение времени ожидания запроса 0, время ожидания не произойдет; связь с базой данных может перестать отвечать на запросы. Такое поведение может быть полезно во время разработки.

Связанные сведения см. в разделе "свойство QueryTimeout" справки DAO.

## <a name="see-also"></a>См. также:

[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDatabase](../../mfc/reference/cdatabase-class.md)<br/>
[Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
