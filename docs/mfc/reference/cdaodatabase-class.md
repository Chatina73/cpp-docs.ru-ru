---
title: Класс CDaoDatabase
ms.date: 11/04/2016
f1_keywords:
- CDaoDatabase
- AFXDAO/CDaoDatabase
- AFXDAO/CDaoDatabase::CDaoDatabase
- AFXDAO/CDaoDatabase::CanTransact
- AFXDAO/CDaoDatabase::CanUpdate
- AFXDAO/CDaoDatabase::Close
- AFXDAO/CDaoDatabase::Create
- AFXDAO/CDaoDatabase::CreateRelation
- AFXDAO/CDaoDatabase::DeleteQueryDef
- AFXDAO/CDaoDatabase::DeleteRelation
- AFXDAO/CDaoDatabase::DeleteTableDef
- AFXDAO/CDaoDatabase::Execute
- AFXDAO/CDaoDatabase::GetConnect
- AFXDAO/CDaoDatabase::GetName
- AFXDAO/CDaoDatabase::GetQueryDefCount
- AFXDAO/CDaoDatabase::GetQueryDefInfo
- AFXDAO/CDaoDatabase::GetQueryTimeout
- AFXDAO/CDaoDatabase::GetRecordsAffected
- AFXDAO/CDaoDatabase::GetRelationCount
- AFXDAO/CDaoDatabase::GetRelationInfo
- AFXDAO/CDaoDatabase::GetTableDefCount
- AFXDAO/CDaoDatabase::GetTableDefInfo
- AFXDAO/CDaoDatabase::GetVersion
- AFXDAO/CDaoDatabase::IsOpen
- AFXDAO/CDaoDatabase::Open
- AFXDAO/CDaoDatabase::SetQueryTimeout
- AFXDAO/CDaoDatabase::m_pDAODatabase
- AFXDAO/CDaoDatabase::m_pWorkspace
helpviewer_keywords:
- CDaoDatabase [MFC], CDaoDatabase
- CDaoDatabase [MFC], CanTransact
- CDaoDatabase [MFC], CanUpdate
- CDaoDatabase [MFC], Close
- CDaoDatabase [MFC], Create
- CDaoDatabase [MFC], CreateRelation
- CDaoDatabase [MFC], DeleteQueryDef
- CDaoDatabase [MFC], DeleteRelation
- CDaoDatabase [MFC], DeleteTableDef
- CDaoDatabase [MFC], Execute
- CDaoDatabase [MFC], GetConnect
- CDaoDatabase [MFC], GetName
- CDaoDatabase [MFC], GetQueryDefCount
- CDaoDatabase [MFC], GetQueryDefInfo
- CDaoDatabase [MFC], GetQueryTimeout
- CDaoDatabase [MFC], GetRecordsAffected
- CDaoDatabase [MFC], GetRelationCount
- CDaoDatabase [MFC], GetRelationInfo
- CDaoDatabase [MFC], GetTableDefCount
- CDaoDatabase [MFC], GetTableDefInfo
- CDaoDatabase [MFC], GetVersion
- CDaoDatabase [MFC], IsOpen
- CDaoDatabase [MFC], Open
- CDaoDatabase [MFC], SetQueryTimeout
- CDaoDatabase [MFC], m_pDAODatabase
- CDaoDatabase [MFC], m_pWorkspace
ms.assetid: 8ff5b342-964d-449d-bef1-d0ff56aadf6d
ms.openlocfilehash: d1e9db1ddebe05d42cbb8c4ba242938d6d86cc81
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57272907"
---
# <a name="cdaodatabase-class"></a>Класс CDaoDatabase

Представляет подключение к базе данных, с помощью которого можно выполнять действия с данными.

## <a name="syntax"></a>Синтаксис

```
class CDaoDatabase : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase::CDaoDatabase](#cdaodatabase)|Создает объект `CDaoDatabase`. Вызовите `Open` подключить объект к базе данных.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CDaoDatabase::CanTransact](#cantransact)|Возвращает ненулевое значение, если база данных поддерживает транзакции.|
|[CDaoDatabase::CanUpdate](#canupdate)|Возвращает ненулевое значение, если `CDaoDatabase` объекта является обновляемым (не только для чтения).|
|[CDaoDatabase::Close](#close)|Закрывает подключение к базе данных.|
|[CDaoDatabase::Create](#create)|Создает базовый объект базы данных DAO и инициализирует `CDaoDatabase` объекта.|
|[CDaoDatabase::CreateRelation](#createrelation)|Определяет новую связь между таблицами в базе данных.|
|[CDaoDatabase::DeleteQueryDef](#deletequerydef)|Удаляет объект querydef, сохраненные в базе данных querydefs-коллекция.|
|[CDaoDatabase::DeleteRelation](#deleterelation)|Удаление существующей связи между таблицами в базе данных.|
|[CDaoDatabase::DeleteTableDef](#deletetabledef)|Удаляет определение таблицы в базе данных. При этом будут удалены реальная таблица и все ее данные.|
|[CDaoDatabase::Execute](#execute)|Выполняет запрос. Вызов `Execute` для запроса, возвращающего результаты возникло исключение.|
|[CDaoDatabase::GetConnect](#getconnect)|Возвращает строку подключения, используемую для подключения `CDaoDatabase` объекта в базе данных. Используется для ODBC.|
|[CDaoDatabase::GetName](#getname)|Возвращает имя базы данных в настоящее время используется.|
|[CDaoDatabase::GetQueryDefCount](#getquerydefcount)|Возвращает количество запросов, определенные в базе данных.|
|[CDaoDatabase::GetQueryDefInfo](#getquerydefinfo)|Возвращает сведения о на указанный запрос, определенный в базе данных.|
|[CDaoDatabase::GetQueryTimeout](#getquerytimeout)|Операции запроса в секундах после базу данных, которая возвращает время ожидания истечет. Влияет на все последующие откройте, добавить новую, обновить и изменить операции и другие операции на основе источников данных ODBC (только), такие как `Execute` вызовов.|
|[CDaoDatabase::GetRecordsAffected](#getrecordsaffected)|Возвращает число записей, затронутых последнего обновления, изменить или добавить операцию или с помощью вызова `Execute`.|
|[CDaoDatabase::GetRelationCount](#getrelationcount)|Возвращает количество взаимоотношений, определенных между таблицами в базе данных.|
|[CDaoDatabase::GetRelationInfo](#getrelationinfo)|Возвращает сведения о указанное отношение, определенных между таблицами в базе данных.|
|[CDaoDatabase::GetTableDefCount](#gettabledefcount)|Возвращает количество таблиц, определенных в базе данных.|
|[CDaoDatabase::GetTableDefInfo](#gettabledefinfo)|Возвращает сведения об указанной таблице в базе данных.|
|[CDaoDatabase::GetVersion](#getversion)|Возвращает версию компонента database engine, связанные с базой данных.|
|[CDaoDatabase::IsOpen](#isopen)|Возвращает ненулевое значение, если `CDaoDatabase` объект в данный момент подключен к базе данных.|
|[CDaoDatabase::Open](#open)|Устанавливает соединение с базой данных.|
|[CDaoDatabase::SetQueryTimeout](#setquerytimeout)|Операции (на источники данных ODBC только) запроса в секундах после базу данных, которая задает время ожидания истечет. Влияет на все последующие откройте, добавить новый, обновление и удаление операций.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание:|
|----------|-----------------|
|[CDaoDatabase::m_pDAODatabase](#m_pdaodatabase)|Указатель на базовый объект базы данных DAO.|
|[CDaoDatabase::m_pWorkspace](#m_pworkspace)|Указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объект, который содержит базу данных и определяет его место транзакций.|

## <a name="remarks"></a>Примечания

Сведения о поддерживаемых форматах базы данных, см. в разделе [GetName](../../mfc/reference/cdaoworkspace-class.md#getname) функция-член. Можно иметь один или несколько `CDaoDatabase` объектов, каждый раз в заданной «рабочей области,» представленный [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта. Рабочая область хранит коллекцию открытых объектов базы данных, именем коллекции баз данных.

> [!NOTE]
>  Классы баз данных MFC DAO отличаются от классов базы данных MFC на основе ODBC. Все имена классов DAO базы данных имеют префикс «CDao». Класс `CDaoDatabase` предоставляет интерфейс аналогичен классу ODBC [CDatabase](../../mfc/reference/cdatabase-class.md). Основное различие заключается в, `CDatabase` обращается к СУБД через Open Database Connectivity (ODBC) и драйвер ODBC для этого СУБД. `CDaoDatabase` Получает доступ к данным через доступ объект данным (DAO) на основе ядра СУБД Microsoft Jet. В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классы MFC на основе ODBC; классы на основе DAO можно получить доступ к данных, в том числе через драйверы ODBC, с помощью собственных компонент database engine. Классы на основе DAO также поддерживают операции языка описания данных DDL, например добавление таблиц через классы, не нужно звонить DAO напрямую.

## <a name="usage"></a>Использование

Можно создать объекты базы данных неявно, при создании объекта набора записей. Но можно также создать объекты базы данных явным образом. Для использования существующей базы данных явным образом с помощью `CDaoDatabase`, выполните одно из следующих:

- Создать `CDaoDatabase` объекта, передав указатель на открытый [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) объекта.

- Или создать `CDaoDatabase` объект без указания рабочей области (MFC создает объект временную рабочую область).

Чтобы создать новый Microsoft Jet (. Базы данных MDB), создания `CDaoDatabase` и вызовите его [создать](#create) функция-член. Сделать *не* вызвать `Open` после `Create`.

Чтобы открыть существующую базу данных, создания `CDaoDatabase` и вызовите его [откройте](#open) функция-член.

Любой из этих методов добавляет объект базы данных DAO коллекции баз данных рабочей области и открывает подключение к данным. При создании затем [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md), [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md), или [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md) объектов для работы в подключенной базе данных, передать конструкторы для этих объектов указатель на вашей `CDaoDatabase` объекта. Когда вы закончите, используя соединение, вызовите [закрыть](#close) члена функции и уничтожать `CDaoDatabase` объекта. `Close` Закрывает все наборы записей, которые ранее не закрыта.

## <a name="transactions"></a>Транзакции

Обработка транзакций в базе данных предоставляется на уровне рабочей области, см. в разделе [BeginTrans](../../mfc/reference/cdaoworkspace-class.md#begintrans), [CommitTrans](../../mfc/reference/cdaoworkspace-class.md#committrans), и [отката](../../mfc/reference/cdaoworkspace-class.md#rollback) функции-члены класса `CDaoWorkspace` .

## <a name="odbc-connections"></a>Подключения ODBC

Рекомендуемый способ работы с источниками данных ODBC — присоединение внешних таблиц для Microsoft Jet (. База данных MDB).

## <a name="collections"></a>Коллекции

Каждая база данных хранит свои собственные коллекции tabledef, querydef, набор записей и отношения объектов. Класс `CDaoDatabase` предоставляет функции-члены для управления этими объектами.

> [!NOTE]
>  Объекты хранятся в DAO, не в объекте базы данных MFC. MFC предоставляет классы для объектов tabledef querydef и набор записей, но не для объектов отношений.

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoDatabase`

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

##  <a name="cantransact"></a>  CDaoDatabase::CanTransact

Вызывайте эту функцию члена, чтобы определить, допускает ли базы данных транзакций.

```
BOOL CanTransact();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если базы данных поддерживает транзакции. в противном случае 0.

### <a name="remarks"></a>Примечания

Управление транзакциями выполняется в рабочей области базы данных.

##  <a name="canupdate"></a>  CDaoDatabase::CanUpdate

Вызывайте эту функцию члена, чтобы определить ли `CDaoDatabase` объект позволяет обновлений.

```
BOOL CanUpdate();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение `CDaoDatabase` объект позволяет обновления; в противном случае — 0, указывающая, что либо, переданное значение TRUE *bReadOnly* при открытии `CDaoDatabase` объект или то, что сама база данных доступна только для чтения. См. в разделе [откройте](#open) функция-член.

### <a name="remarks"></a>Примечания

Сведения о возможности обновления базы данных см. в разделе «Обновляемые свойство» в справке DAO.

##  <a name="cdaodatabase"></a>  CDaoDatabase::CDaoDatabase

Создает объект `CDaoDatabase`.

```
CDaoDatabase(CDaoWorkspace* pWorkspace = NULL);
```

### <a name="parameters"></a>Параметры

*pWorkspace*<br/>
Указатель на `CDaoWorkspace` объект, который будет содержать новый объект базы данных. Если вы принимаете значение NULL по умолчанию, конструктор создает временный `CDaoWorkspace` объект, который использует рабочую область по умолчанию DAO. Можно получить указатель на объект рабочей области с помощью [m_pWorkspace](#m_pworkspace) данные-член.

### <a name="remarks"></a>Примечания

После создания объекта, в том случае, если вы создаете новый Microsoft Jet (. MDB) базы данных, вызвать для объекта [создать](#create) функция-член. Если вы являетесь, вместо этого Открытие существующей базы данных, вызвать для объекта [откройте](#open) функция-член.

Когда вы закончите с объектом, следует вызывать его [закрыть](#close) член функции, а затем удалите `CDaoDatabase` объекта.

Может оказаться удобным для внедрения `CDaoDatabase` объекта в классе документа.

> [!NOTE]
>  Объект `CDaoDatabase` также создается объект неявно при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объект не передается указатель на существующий `CDaoDatabase` объекта. Этот объект базы данных был закрыт при закрытии объекта набора записей.

##  <a name="close"></a>  CDaoDatabase::Close

Вызывайте эту функцию члена, чтобы отключиться от базы данных и закрыть любые открытые наборы записей, tabledefs и querydefs, связанные с базой данных.

```
virtual void Close();
```

### <a name="remarks"></a>Примечания

Рекомендуется закрыть эти объекты, самостоятельно перед вызовом этой функции-члена. Закрытие `CDaoDatabase` объекта он удаляется из коллекции баз данных в связанном [рабочей области](../../mfc/reference/cdaoworkspace-class.md). Так как `Close` не уничтожает `CDaoDatabase` объекта, вы можете повторно использовать объект, открыв той же базе данных или другой базе данных.

> [!CAUTION]
>  Вызовите [обновление](../../mfc/reference/cdaorecordset-class.md#update) функция-член (если имеются незафиксированные изменения) и `Close` функция-член для всех объектов открыть набор записей, прежде чем закрыть базу данных. При выходе из функции, которая объявляет [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) или `CDaoDatabase` объекты в стеке, база данных закрыта, все несохраненные изменения будут потеряны, всех ожидающих транзакций будет выполнен откат и все ожидающие изменения к данным, теряются.

> [!CAUTION]
>  При попытке закрыть объект базы данных, пока открыты все объекты набора записей, или при попытке закрыть объект рабочей области, пока открыты объекты базы данных, принадлежащих этой определенной рабочей области, эти объекты набор записей будет закрыт, и любые имеющиеся обновления или изменения будут выполнен откат. При попытке закрыть объект рабочей области, пока объекты базы данных, размещенные в нем открыты, операция закрывает все объекты базы данных, принадлежащего этому объекту определенную рабочую область, что может привести объекты незакрытые набора записей, которые будут закрыты. Если не закрыть объект database, MFC сообщает Сбой утверждения в отладочных сборках.

Если определен объект базы данных вне области функции и выхода из функции, не закрывая его, объект базы данных будет оставаться открытым, пока не будет явно закрыт или модуль, в котором он определен выходит из области действия.

##  <a name="create"></a>  CDaoDatabase::Create

Чтобы создать новый Microsoft Jet (. MDB) базы данных, вызовите эту функцию-член, после создания `CDaoDatabase` объекта.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int dwOptions = 0);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Строковое выражение, представляющее имя файла базы данных, который вы создаете. Это может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Необходимо указать имя. Если не указать расширение файла. Добавляется MDB. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например "\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB». Только Microsoft Jet (. Файлы базы данных MDB) могут быть созданы с помощью этой функции-члена. (Двойной обратной косой черты в строковых литералах необходимы, так как "\\" escape-символом C++.)

*lpszLocale*<br/>
Строковое выражение, используемое, чтобы указать порядок сортировки при создании базы данных. Значение по умолчанию — `dbLangGeneral`. Доступны следующие значения:

- `dbLangGeneral` Испанский, английский, немецкий, французский, португальский, итальянский и современных

- `dbLangArabic` арабский

- `dbLangCyrillic` русский

- `dbLangCzech` чешский

- `dbLangDutch` нидерландский

- `dbLangGreek` греческий

- `dbLangHebrew` иврит

- `dbLangHungarian` венгерский

- `dbLangIcelandic` исландский

- `dbLangNordic` Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)

- `dbLangNorwdan` Норвежский и датской национальных настроек

- `dbLangPolish` польский

- `dbLangSpanish` Испанский (традиционный)

- `dbLangSwedfin` Шведский и финский

- `dbLangTurkish` турецкий

*dwOptions*<br/>
Целое число, указывающее один или несколько параметров. Доступны следующие значения:

- `dbEncrypt` Создание зашифрованной базы данных.

- `dbVersion10` Создание базы данных с помощью базы данных Microsoft Jet версии 1.0.

- `dbVersion11` Создание базы данных с помощью базы данных Microsoft Jet версии 1.1.

- `dbVersion20` Создание базы данных с помощью базы данных Microsoft Jet версии 2.0.

- `dbVersion30` Создание базы данных с помощью базы данных Microsoft Jet версии 3.0.

Если опустить константа Шифрование незашифрованной базы данных будет создан. Можно указать только одну версию константа. Если опустить константа версии, создается база данных, использующего базу данных Microsoft Jet версии 3.0.

> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если вы реализуете безопасности имени пользователя и пароля, напрямую прочитать диск двоичный файл, который составляет базы данных.

### <a name="remarks"></a>Примечания

`Create` Создает файл базы данных и базовый объект базы данных DAO и инициализирует объект C++. Объект присоединяется к коллекции баз данных связанную рабочую область. Объект базы данных находится в открытом состоянии; Не вызывайте `Open*` после `Create`.

> [!NOTE]
>  С помощью `Create`, можно создать только Microsoft Jet (. Баз данных MDB). Не удается создать базам данных ISAM или баз данных ODBC.

##  <a name="createrelation"></a>  CDaoDatabase::CreateRelation

Вызовите эту функцию-член для установления отношения между одно или несколько полей в основной таблице в базе данных и одно или несколько полей во внешней таблице (другой таблицы в базе данных).

```
void CreateRelation(
    LPCTSTR lpszName,
    LPCTSTR lpszTable,
    LPCTSTR lpszForeignTable,
    long lAttributes,
    LPCTSTR lpszField,
    LPCTSTR lpszForeignField);

void CreateRelation(CDaoRelationInfo& relinfo);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Уникальное имя объекта отношения. Имя должно начинаться с буквы и может содержать не более 40 символов. Он может включать цифры и символы подчеркивания, но не может содержать знаки пунктуации и пробелы.

*lpszTable*<br/>
Имя главной таблицы в связи. Если таблица существует, MFC создает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

*lpszForeignTable*<br/>
Имя внешней таблицы в связи. Если таблица существует, MFC создает исключение типа `CDaoException`.

*lAttributes*<br/>
Длинное значение, содержащее сведения о типе связи. Это значение можно использовать для обеспечения ссылочной целостности, помимо прочего. Можно использовать оператор побитового или ( **&#124;**) чтобы использовать любое сочетание следующих значений (при условии, что комбинация имеет смысл):

- `dbRelationUnique` Отношение один к одному.

- `dbRelationDontEnforce` Связь не является включенным (не ограничением ссылочной целостности).

- `dbRelationInherited` Связь существует в базе кадр, который содержит две вложенные таблицы.

- `dbRelationUpdateCascade` Обновления будут нарастать (Дополнительные сведения о каскадные см. в разделе "Примечания").

- `dbRelationDeleteCascade` Удаление происходит каскадом.

*lpszField*<br/>
Указатель на заканчивающуюся нулем строку, содержащую имя поля в таблице первичного (с именем, *lpszTable*).

*lpszForeignField*<br/>
Указатель на заканчивающуюся нулем строку, содержащую имя поля в таблице внешнего (с именем, *lpszForeignTable*).

*relinfo*<br/>
Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) , содержащий сведения о связи, вы хотите создать.

### <a name="remarks"></a>Примечания

Связь не может включать в запрос или подключенной таблицы из внешней базы данных.

Используйте первой версии функции, если связь содержит одно поле в каждом из двух таблиц. Используйте второй версии, если отношение включает в себя несколько полей. Максимальное число полей в отношение равно 14.

Это действие создает базовый объект отношения DAO, но это деталь реализации MFC, так как инкапсуляция MFC отношения объектов содержится в классе `CDaoDatabase`. MFC предоставляет класс для связей.

Если связи атрибутов объекта, чтобы активировать операций cascade, компонент database engine автоматически обновляет или удаляет записи в одну или несколько таблиц, при внесении изменений в связанных первичного ключа таблиц.

Например предположим, что установить cascade delete связь между таблицу Customers и Orders, таблица. При удалении записей из таблицы Customers, также удаляются записи в таблице заказов, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другими таблицами, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.

Дополнительные сведения см. в разделе «CreateRelation Method» в справке DAO.

##  <a name="deletequerydef"></a>  CDaoDatabase::DeleteQueryDef

Вызовите эту функцию-член для удаления указанного querydef, сохраненный запрос — из `CDaoDatabase` объекта querydefs-коллекция.

```
void DeleteQueryDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя сохраненного запроса, для удаления.

### <a name="remarks"></a>Примечания

После этого запроса больше не определен в базе данных.

Сведения о создании объектов querydef, см. в разделе класса [CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md). Объект querydef становится связанным с определенной `CDaoDatabase` объекта при создании `CDaoQueryDef` объекта, передав указатель на объект базы данных.

##  <a name="deleterelation"></a>  CDaoDatabase::DeleteRelation

Вызовите эту функцию-член для удаления существующей связи из коллекции связей объекта базы данных.

```
void DeleteRelation(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя столбца для удаления.

### <a name="remarks"></a>Примечания

После этого отношения больше не существует.

Дополнительные сведения см. в разделе «Удаление Method» в справке DAO.

##  <a name="deletetabledef"></a>  CDaoDatabase::DeleteTableDef

Вызовите эту функцию-член для удаления указанной таблицы и все его данные из `CDaoDatabase` объекта tabledefs-коллекция.

```
void DeleteTableDef(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя tabledef для удаления.

### <a name="remarks"></a>Примечания

Впоследствии эта таблица в базе данных больше не указывается.

> [!NOTE]
>  Будьте очень внимательны при удалении системных таблиц.

Сведения о создании объектов tabledef см. класс [CDaoTableDef](../../mfc/reference/cdaotabledef-class.md). Объект tabledef становится связанным с определенной `CDaoDatabase` объекта при создании `CDaoTableDef` объекта, передав указатель на объект базы данных.

Дополнительные сведения см. в разделе «Удаление Method» в справке DAO.

##  <a name="execute"></a>  CDaoDatabase::Execute

Вызовите эту функцию-член для выполнения запроса или выполнения инструкции SQL в базе данных.

```
void Execute(
    LPCTSTR lpszSQL,
    int nOptions = dbFailOnError);
```

### <a name="parameters"></a>Параметры

*lpszSQL*<br/>
Указатель на заканчивающуюся нулем строку, содержащую допустимую команду SQL для выполнения.

*nOptions*<br/>
Целое число, указывающее параметры, относящиеся к целостности запроса. Можно использовать оператор побитового или ( **&#124;**) для объединения любой из следующих констант (предоставляемый сочетания имеет смысл — например, не будут объединены `dbInconsistent` с `dbConsistent`):

- `dbDenyWrite` Запрет разрешения на запись к другим пользователям.

- `dbInconsistent` (По умолчанию) Несогласованных обновлений.

- `dbConsistent` Согласованное обновление системы.

- `dbSQLPassThrough` К серверу SQL. Приводит к передаваться к источнику данных ODBC для обработки инструкции SQL.

- `dbFailOnError` Откат обновления при возникновении ошибки.

- `dbSeeChanges` Если другой пользователь изменяет данные, которые вы изменяете, вызывают ошибку времени выполнения.

> [!NOTE]
>  Если оба `dbInconsistent` и `dbConsistent` включаются или если ни один не включены, результатом является значение по умолчанию. Описание этих констант см. в разделе «Выполнить метод» в справке DAO.

### <a name="remarks"></a>Примечания

`Execute` работает только для запросов или запросов к серверу SQL, которые не возвращают результатов. Он не работает для запросов select, которые возвращают записи.

Определение и сведения о запросах действия см. в разделах «Запрос» и «Выполнить метод» в справке DAO.

> [!TIP]
>  Учитывая синтаксическую правильность инструкции SQL и необходимых разрешений, `Execute` функция-член не произойдет, даже если не будут изменены или удалены одной строки. Таким образом, всегда используйте `dbFailOnError` параметр при использовании `Execute` функция-член для выполнения обновления или удаления запроса. Этот параметр предписывает MFC для создания исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md) и выполняет откат всех успешных изменений, если любой из записей, затронутых заблокированы и не может обновить или удалить. Обратите внимание, что всегда может вызвать `GetRecordsAffected` чтобы увидеть, сколько записей были затронуты.

Вызовите [GetRecordsAffected](#getrecordsaffected) функция-член объекта базы данных, чтобы определить количество записей, затронутых последней `Execute` вызова. Например `GetRecordsAffected` возвращает сведения о количестве записей удаления, обновления или вставки при выполнении запроса. Число, возвращаемое не будет отражать изменения в связанных таблицах, когда cascade, обновляет или удаляет вступают в силу.

`Execute` Возвращает набор записей. С помощью `Execute` на запрос, который выбирает записи вызывает MFC для создания исключения типа `CDaoException`. (Имеется не `ExecuteSQL` функция-член аналогичен `CDatabase::ExecuteSQL`.)

##  <a name="getconnect"></a>  CDaoDatabase::GetConnect

Вызывайте эту функцию члена, чтобы получить строку подключения, используемые для подключения `CDaoDatabase` объекта к базе данных ODBC или ISAM.

```
CString GetConnect();
```

### <a name="return-value"></a>Возвращаемое значение

Строка соединения, если [откройте](#open) вызван успешно на источник данных ODBC; в противном случае — пустая строка. Для Microsoft Jet (. Базы данных MDB), строка всегда пуста, если не задать его для использования с `dbSQLPassThrough` параметр, используемый с [Execute](#execute) функция-член или используется при открытии набора записей.

### <a name="remarks"></a>Примечания

Строка содержит сведения об источнике открытую базу данных или использовать в запросе к серверу базы данных. Строка подключения состоит из спецификатора типа базы данных и ноль или несколько параметров, разделенных точкой с запятой.

> [!NOTE]
>  С помощью классов MFC DAO для подключения к источнику данных через ODBC является менее эффективным, чем подключение через подключенной таблицы.

> [!NOTE]
>  Строка подключения используется для передачи дополнительных сведений к ODBC и некоторые драйверы ISAM, при необходимости. Он не используется для. Баз данных MDB. Для базовых таблиц базы данных Microsoft Jet, строка подключения является пустой строкой ("») за исключением того, при использовании его для запроса к серверу как описано в разделе возвращают значение выше.

См. в разделе [откройте](#open) функция-член описание способ создания строки подключения. После задания строки подключения `Open` вызова, можно позже использовать его для проверки параметра для определения типа, путь, идентификатор, пароль или ODBC источника данных базы данных.

##  <a name="getname"></a>  CDaoDatabase::GetName

Вызовите эту функцию-член для получения имени открытого базы данных, которое является именем существующего файла базы данных или имя зарегистрированных источников данных ODBC.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Полный путь и имя файла базы данных, если выполнение прошло успешно; в противном случае — пустой [CString](../../atl-mfc-shared/reference/cstringt-class.md).

### <a name="remarks"></a>Примечания

Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например, "\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойной обратной косой черты в строковых литералах необходимы, так как "\\" escape-символом C++.)

Может например, будет отображаться это имя в заголовке. Если произошла ошибка при получении имени, MFC вызывает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

> [!NOTE]
>  Для повышения производительности при внешние базы данных осуществляется доступ, рекомендуется подключении таблицах внешних баз данных в базу данных Microsoft Jet (. MDB) вместо того чтобы подключаться непосредственно к источнику данных.

Тип базы данных указывается файл или каталог, который указывает путь, как показано ниже:

|Указывает путь на...|Тип базы данных|
|--------------------------|-------------------|
|. MDB-файлу|База данных Microsoft Jet (Microsoft Access)|
|Каталог, содержащий. Файлы DBF|базы данных dBASE|
|Каталог, содержащий. XLS-файлов|База данных Microsoft Excel|
|Каталог, содержащий. Файлы PDX|Базы данных Paradox|
|Каталог, содержащий файлы базы данных соответствующим образом форматированный текст|База данных формата текста|

Для баз данных ODBC, например SQL Server и Oracle строку подключения базы данных определяет имя источника данных (DSN), зарегистрированный с ODBC.

##  <a name="getquerydefcount"></a>  CDaoDatabase::GetQueryDefCount

Вызовите эту функцию-член для получения количества запросов, определенных в базе данных querydefs-коллекция.

```
short GetQueryDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число запросов, определенных в базе данных.

### <a name="remarks"></a>Примечания

`GetQueryDefCount` полезно, если вам нужно перебрать все querydefs в querydefs-коллекция. Для получения сведений о конкретного запроса в коллекции, см. в разделе [GetQueryDefInfo](#getquerydefinfo).

##  <a name="getquerydefinfo"></a>  CDaoDatabase::GetQueryDefInfo

Эта функция члена для получения различного рода сведения о запросе, определенные в базе данных.

```
void GetQueryDefInfo(
    int nIndex,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetQueryDefInfo(
    LPCTSTR lpszName,
    CDaoQueryDefInfo& querydefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Индекс предопределенного запроса в querydefs-коллекция базы данных, для поиска по индексу.

*querydefinfo*<br/>
Ссылку на [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) объект, который возвращает запрошенные данные.

*dwInfoOptions*<br/>
Параметры, укажите, какие сведения о наборе записей для извлечения. А также как они вызвать функцию возврата о наборе записей доступные параметры приведен ниже.

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), тип

- AFX_DAO_SECONDARY_INFO сведения об основном плюс: Дата создания, Дата последнего обновления, возвращает записи, обновляемые

- AFX_DAO_ALL_INFO первичного и вторичного сведения плюс: SQL, подключиться, время ожидания ODBC

*lpszName*<br/>
Строка, содержащая имя запроса, определенные в базе данных, для поиска по имени.

### <a name="remarks"></a>Примечания

Две версии функции предоставляются, поэтому его можно выбрать запрос по индексу в querydefs-коллекция базы данных или по имени запроса.

Описание сведений, возвращаемых в *querydefinfo*, см. в разделе [CDaoQueryDefInfo](../../mfc/reference/cdaoquerydefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании *dwInfoOptions*. Если вы запрашивали один уровень данных, вы получаете все предыдущие уровни подобных сведений.

##  <a name="getquerytimeout"></a>  CDaoDatabase::GetQueryTimeout

Вызовите эту функцию-член для извлечения текущее количество секунд, чтобы прежде, чем последующие операции с подключенной базы данных времени ожидания.

```
short GetQueryTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Короткое целое число, содержащее значение времени ожидания в секундах.

### <a name="remarks"></a>Примечания

Операция может время ожидания выполнения из-за проблем доступа к сети, время обработки запроса чрезмерное и т. д. Пока действует параметр, он влияет на все открытые, добавить новый, обновления и удаления, выполняемых на все наборы записей, связанный с данным `CDaoDatabase` объекта. Можно изменить текущее значение времени ожидания путем вызова [SetQueryTimeout](#setquerytimeout). Изменение значение времени ожидания запроса для объекта recordset после открытия не приводит к изменению значения для набора записей. Например, последующие [переместить](../../mfc/reference/cdaorecordset-class.md#move) операции не используют новое значение. Значение по умолчанию первоначально задается при инициализации ядро базы данных.

Значение по умолчанию для времени ожидания запросов берется из реестра Windows. Если нет параметров реестра, значение по умолчанию составляет 60 секунд. Не все базы данных поддерживают возможность установить значение времени ожидания запроса. Если задать значение 0, время ожидания запроса происходит без времени ожидания; и подключения к базе данных может перестать отвечать на запросы. Такое поведение может быть полезным во время разработки. Если вызов завершается сбоем, MFC создает исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.

##  <a name="getrecordsaffected"></a>  CDaoDatabase::GetRecordsAffected

Эта функция-член для определения количества записей, затронутых в последний вызов из вызова [Execute](#execute) функция-член.

```
long GetRecordsAffected();
```

### <a name="return-value"></a>Возвращаемое значение

Длинное целое число, содержащее количество обработанных записей.

### <a name="remarks"></a>Примечания

Возвращаемое значение включает в себя количество записей удаления, обновлении или вставке, запрос на запуск с `Execute`. Число, возвращаемое не будет отражать изменения в связанных таблицах, когда cascade, обновляет или удаляет вступают в силу.

Дополнительные сведения см. в разделе «RecordsAffected свойство» в справке DAO.

##  <a name="getrelationcount"></a>  CDaoDatabase::GetRelationCount

Эта функция члена для получения номера взаимоотношений, определенных между таблицами в базе данных.

```
short GetRelationCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число взаимоотношений, определенных между таблицами в базе данных.

### <a name="remarks"></a>Примечания

`GetRelationCount` полезно, если вам нужно перебрать все отношения, определенные в коллекции связей базы данных. Для получения сведений о данное отношение в коллекции, см. в разделе [GetRelationInfo](#getrelationinfo).

Чтобы проиллюстрировать концепцию отношения, рассмотрим таблицу Suppliers и таблица товаров, который может иметь отношение один ко многим. В этом отношении один поставщик можно указать более одного продукта. Другие связи один к одному "и" многие ко многим.

##  <a name="getrelationinfo"></a>  CDaoDatabase::GetRelationInfo

Вызов этой функции-члена для получения сведений о указанное отношение в коллекции связей базы данных.

```
void GetRelationInfo(
    int nIndex,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetRelationInfo(
    LPCTSTR lpszName,
    CDaoRelationInfo& relinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Индекс связи объекта в коллекции связей базы данных, для поиска по индексу.

*relinfo*<br/>
Ссылку на [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) объект, который возвращает запрошенные данные.

*dwInfoOptions*<br/>
Параметры, укажите, какие сведения о связи для получения. А также как они вызвать функцию возврата о связи ниже перечислены доступные параметры:

- Таблица внешнего имени таблицы, AFX_DAO_PRIMARY_INFO (по умолчанию)

- Атрибуты AFX_DAO_SECONDARY_INFO, сведений о поле

Сведения о поле является [CDaoRelationFieldInfo](../../mfc/reference/cdaorelationfieldinfo-structure.md) объект, содержащий поля из первичной таблицы, участвующие в связи.

*lpszName*<br/>
Строка, содержащая имя объекта отношения для поиска по имени.

### <a name="remarks"></a>Примечания

Две версии этой функции обеспечивают доступ по индексу или по имени. Описание сведений, возвращаемых в *relinfo*, см. в разделе [CDaoRelationInfo](../../mfc/reference/cdaorelationinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании *dwInfoOptions*. Если запросить сведения на одном уровне, можно также получить информацию об всех предыдущих уровней.

> [!NOTE]
>  Если задать связь атрибутов объекта, чтобы активировать операций cascade (`dbRelationUpdateCascades` или `dbRelationDeleteCascades`), ядро базы данных Jet (Майкрософт) автоматически обновляет или удаляет записи в одном или нескольких других таблиц, при внесении изменений в связанных первичного ключа таблицы. Например предположим, что установить cascade delete связь между таблицу Customers и Orders, таблица. При удалении записей из таблицы Customers, также удаляются записи в таблице заказов, связанных с клиентом. Кроме того Если установить cascade удалить связи между таблицей заказов и другими таблицами, записи в этих таблицах автоматически удаляются при удалении записей из таблицы Customers.

##  <a name="gettabledefcount"></a>  CDaoDatabase::GetTableDefCount

Вызовите эту функцию-член для извлечения нескольких таблиц, определенных в базе данных.

```
short GetTableDefCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число tabledefs, определенные в базе данных.

### <a name="remarks"></a>Примечания

`GetTableDefCount` полезно, если вам нужно перебрать все tabledefs в tabledefs-коллекция базы данных. Чтобы получить сведения о данной таблицы в коллекции, см. в разделе [GetTableDefInfo](#gettabledefinfo).

##  <a name="gettabledefinfo"></a>  CDaoDatabase::GetTableDefInfo

Эта функция члена для получения различного рода сведения о таблице, определенные в базе данных.

```
void GetTableDefInfo(
    int nIndex,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetTableDefInfo(
    LPCTSTR lpszName,
    CDaoTableDefInfo& tabledefinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Индекс объекта tabledef в tabledefs-коллекция базы данных, для поиска по индексу.

*tabledefinfo*<br/>
Ссылку на [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) объект, который возвращает запрошенные данные.

*dwInfoOptions*<br/>
Параметры, укажите, какие сведения о таблице для получения. А также как они вызвать функцию возврата о связи ниже перечислены доступные параметры:

- AFX_DAO_PRIMARY_INFO (по умолчанию), обновляемым, атрибуты

- AFX_DAO_SECONDARY_INFO сведения об основном плюс: Дата создания, Дата последнего обновления, имя исходной таблицы, подключения

- AFX_DAO_ALL_INFO первичного и вторичного сведения плюс: Число записей текст проверки правила проверки

*lpszName*<br/>
Имя объекта tabledef, для поиска по имени.

### <a name="remarks"></a>Примечания

Две версии функции предоставляются для выбора таблицы по индексу в tabledefs-коллекция базы данных или по имени таблицы.

Описание сведений, возвращаемых в *tabledefinfo*, см. в разделе [CDaoTableDefInfo](../../mfc/reference/cdaotabledefinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании *dwInfoOptions*. Если вы запрашиваете сведения на одном уровне, вы получите сведения о всех предыдущих уровней.

> [!NOTE]
>  Параметр AFX_DAO_ALL_INFO предоставляет сведения, которые могут выполняться медленно для получения. В этом случае подсчет строк в таблице может быть очень много времени при наличии множества записей.

##  <a name="getversion"></a>  CDaoDatabase::GetVersion

Вызывайте эту функцию члена, чтобы определить версию файла базы данных Microsoft Jet.

```
CString GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию файла базы данных, связанный с объектом.

### <a name="remarks"></a>Примечания

Возвращаемое значение представляет номер версии в форме «основной.дополнительный»; например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точку и номер выпуска (0). Версии до даты, 1.0, 1.1, 2.0 и 3.0.

Дополнительные сведения см. в разделе «Свойство Version» в справке DAO.

##  <a name="isopen"></a>  CDaoDatabase::IsOpen

Вызывайте эту функцию члена, чтобы определить ли `CDaoDatabase` объекта в данный момент открыт в базе данных.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение `CDaoDatabase` объект сейчас открыт; в противном случае — 0.

### <a name="remarks"></a>Примечания

##  <a name="m_pdaodatabase"></a>  CDaoDatabase::m_pDAODatabase

Содержит указатель на интерфейс OLE для базового объекта базы данных DAO `CDaoDatabase` объекта.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если требуется доступ к интерфейсу DAO напрямую.

Сведения о вызова DAO напрямую, см. в разделе [технические 54 Примечание](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

##  <a name="m_pworkspace"></a>  CDaoDatabase::m_pWorkspace

Содержит указатель на [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) , содержащий объект базы данных.

### <a name="remarks"></a>Примечания

Используйте этот указатель, если требуется прямой доступ к рабочей области — например, чтобы получить указатели на другие объекты базы данных в коллекции баз данных рабочей области.

##  <a name="open"></a>  CDaoDatabase::Open

Эта функция-член для инициализации нового созданного необходимо вызвать `CDaoDatabase` объект, представляющий существующую базу данных.

```
virtual void Open(
    LPCTSTR lpszName,
    BOOL bExclusive = FALSE,
    BOOL bReadOnly = FALSE,
    LPCTSTR lpszConnect = _T(""));
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Строковое выражение, которое является именем существующего Microsoft Jet (. Файл базы данных MDB). Если имя файла имеет расширение, он не требуется. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например "\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойной обратной косой черты в строковых литералах необходимы, так как "\\" escape-символом C++.)

Некоторые соображения при использовании *lpszName*. Если он:

- Ссылается на базу данных, которая уже открыта для монопольного доступа другим пользователем, MFC выдает исключения типа [CDaoException](../../mfc/reference/cdaoexception-class.md). Перехватывать это исключение, чтобы позволить пользователю знать, что база данных недоступна.

- Является пустой строкой ("») и *lpszConnect* является «ODBC;», отображается диалоговое окно со списком всех зарегистрированных имен источников данных ODBC, поэтому пользователь может выбрать базу данных. Следует избегать прямые подключения к источникам данных ODBC; Вместо этого используйте подключенной таблицы.

- В противном случае не ссылаться на существующую базу данных или допустимый источник данных ODBC, MFC выдает исключения типа `CDaoException`.

> [!NOTE]
>  Дополнительные сведения о кодах ошибок DAO см. в разделе DAOERR. H-файл. Дополнительные сведения см. в разделе «Перехватываемая данных доступа ошибки» в справке DAO.

*bExclusive*<br/>
Логическое значение, равное TRUE, если база данных будет открыт для монопольного доступа (не общие) и FALSE, если база данных будет открыт для общего доступа. Если этот аргумент опущен, база данных открыта для общего доступа.

*bReadOnly*<br/>
Логическое значение, равное TRUE, если база данных будет открыт для доступа только для чтения и FALSE, если база данных будет открыт для чтения и записи. Если этот аргумент опущен, база данных открыта для чтения и записи. Все зависимые наборы записей, наследуют этот атрибут.

*lpszConnect*<br/>
Строковое выражение, используемое для открытия базы данных. Эта строка представляет собой ODBC подключения аргументы. Необходимо указать аргументы эксклюзивное и только для чтения, возможность передачи строки источника. Если база данных является базой данных Microsoft Jet (. MDB), эта строка представляет собой пустой (»»). Синтаксис для значения по умолчанию — **_T**("») — обеспечивает переносимость для Юникода, а также ANSI сборок приложения.

### <a name="remarks"></a>Примечания

`Open` связывает базу данных с помощью базового объекта DAO. Объект базы данных нельзя использовать для создания набора записей, tabledef или querydef объектов до инициализации. `Open` Добавляет объект базы данных рабочей области связанные коллекции баз данных.

Используйте параметры следующим образом:

- При открытии Microsoft Jet (. Базы данных MDB), используйте *lpszName* параметр и pass, или пустая строка для *lpszConnect* параметра или передайте Строка пароля в формате «; PWD = password» база данных находится в защищенной паролем (. MDB баз данных только).

- При открытии источник данных ODBC, передать допустимую строку подключения ODBC в *lpszConnect* и пустая строка в *lpszName*.

Дополнительные сведения см. в разделе «OpenDatabase Method» в справке DAO.

> [!NOTE]
>  Для повышения производительности при доступе к внешних баз данных, в том числе базам данных ISAM и источники данных ODBC, рекомендуется подключении таблицах внешних баз данных в базу данных Microsoft Jet Database engine (. MDB) вместо того чтобы подключаться непосредственно к источнику данных.

Существует возможность попытки подключения к времени ожидания, если, например, узел СУБД недоступен. Если попытка соединения завершается, `Open` возникло исключение типа [CDaoException](../../mfc/reference/cdaoexception-class.md).

Оставшиеся "Примечания" применяются только к базам данных ODBC.

Если база данных находится в базе данных ODBC и параметров в вашей `Open` вызова не содержат достаточно сведений для подключения, драйвер ODBC открывает диалоговое окно, чтобы получить необходимую информацию от пользователя. При вызове `Open`, строки подключения, *lpszConnect*, хранится в частном порядке и по телефону [GetConnect](#getconnect) функция-член.

При желании можно открыть диалоговое окно, перед вызовом метода `Open` для получения сведений от пользователя, такие как пароль, затем добавить эту информацию к строке подключения, передаваемый `Open`. Или может потребоваться сохранить строку подключения, передать (возможно, в реестр Windows), поэтому ее можно повторно использовать следующий раз, когда ваши приложения вызывает `Open` на `CDaoDatabase` объекта.

Можно также использовать строку подключения для нескольких уровней авторизации имени входа (для другой `CDaoDatabase` объекта) или для передачи другие данные конкретной базы данных.

##  <a name="setquerytimeout"></a>  CDaoDatabase::SetQueryTimeout

Вызывайте эту функцию члена, чтобы переопределить значение по умолчанию число секунд, чтобы перед выполнением последующих операций на время ожидания подключенной базы данных.

```
void SetQueryTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*nSeconds*<br/>
Количество секунд, чтобы разрешить до попытки запроса времени ожидания.

### <a name="remarks"></a>Примечания

Операция может время ожидания выполнения из-за проблем доступа к сети, время обработки запроса чрезмерное и т. д. Вызовите `SetQueryTimeout` перед открытием набора записей или перед вызовом набора записей [AddNew](../../mfc/reference/cdaorecordset-class.md#addnew), [обновление](../../mfc/reference/cdaorecordset-class.md#update), или [удалить](../../mfc/reference/cdaorecordset-class.md#delete) функций-членов. Если вы хотите изменить запрос значение времени ожидания. Этот параметр влияет на все последующие [откройте](../../mfc/reference/cdaorecordset-class.md#open), `AddNew`, `Update`, и `Delete` вызовы все наборы записей, связанный с данным `CDaoDatabase` объекта. Изменение значение времени ожидания запроса для объекта recordset после открытия не приводит к изменению значения для набора записей. Например, последующие [переместить](../../mfc/reference/cdaorecordset-class.md#move) операции не используют новое значение.

Значение по умолчанию для времени ожидания запросов составляет 60 секунд. Не все базы данных поддерживают возможность установить значение времени ожидания запроса. Если задать значение 0, время ожидания запроса происходит без времени ожидания; обмен данными с базой данных может перестать отвечать на запросы. Такое поведение может быть полезным во время разработки.

Дополнительные сведения см. в разделе «QueryTimeout свойство» в справке DAO.

## <a name="see-also"></a>См. также

[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDatabase](../../mfc/reference/cdatabase-class.md)<br/>
[Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
