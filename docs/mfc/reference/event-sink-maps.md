---
title: Схемы приемников событий
ms.date: 11/04/2016
helpviewer_keywords:
- event sink maps [MFC]
ms.assetid: a9757eb2-5f4a-45ec-a2cd-ce5eec85b16f
ms.openlocfilehash: aeec0acad4531e1ef0933388bbee728193853611
ms.sourcegitcommit: 934cb53fa4cb59fea611bfeb9db110d8d6f7d165
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2019
ms.locfileid: "65612229"
---
# <a name="event-sink-maps"></a>Схемы приемников событий

Если внедренный элемент управления OLE запускает событие, контейнера элемента управления получает событие, используя механизм, называемый «картой приемника событий,» предоставляемые MFC. Эта карта приемника событий указывает функции обработчика для каждого определенного события, а также параметры этих событий. Дополнительные сведения о схемы приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="event-sink-maps"></a>Схемы приемников событий

|||
|-|-|
|[BEGIN_EVENTSINK_MAP](#begin_eventsink_map)|Начинается определение картой приемника событий.|
|[DECLARE_EVENTSINK_MAP](#declare_eventsink_map)|Объявляет картой приемника событий.|
|[END_EVENTSINK_MAP](#end_eventsink_map)|Завершает определение картой приемника событий.|
|[ON_EVENT](#on_event)|Определяет обработчик событий для конкретного события.|
|[ON_EVENT_RANGE](#on_event_range)|Определяет обработчик событий для конкретного события инициируется из набора элементов управления OLE.|
|[ON_EVENT_REFLECT](#on_event_reflect)|Получает события, инициируемые элементом управления, прежде чем они будут обработаны с контейнера элемента управления.|
|[ON_PROPNOTIFY](#on_propnotify)|Определяет обработчик для обработки уведомления об свойств из элемента управления OLE.|
|[ON_PROPNOTIFY_RANGE](#on_propnotify_range)|Определяет обработчик для обработки уведомлений свойство из набора элементов управления OLE.|
|[ON_PROPNOTIFY_REFLECT](#on_propnotify_reflect)|Получает свойство уведомлений, отправляемых с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.|

##  <a name="begin_eventsink_map"></a>  BEGIN_EVENTSINK_MAP

Начинается определение карту приемника событий.

```
BEGIN_EVENTSINK_MAP(theClass, baseClass)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Указывает, что имя класса элемента управления, сопоставления которых приемника событий.

*baseClass*<br/>
Указывает имя базового класса *theClass*.

### <a name="remarks"></a>Примечания

В файле реализации (CPP), который определяет функции-члены класса запуск карты приемника событий с begin_eventsink_map-макрос, а затем добавить макрос записи для каждого события получать уведомления о и завершить карты приемника событий с end_eventsink_map-макрос.

Дополнительные сведения о схемы приемников событий и контейнеры элементов управления OLE, см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="declare_eventsink_map"></a>  DECLARE_EVENTSINK_MAP

OLE-контейнер может предоставить картой приемника событий для задания событий, которые контейнера будут уведомлены о.

```
DECLARE_EVENTSINK_MAP()
```

### <a name="remarks"></a>Примечания

Используйте declare_eventsink_map-макрос в конце объявления класса. Затем в. CPP-файл, который определяет функции-члены класса, используйте begin_eventsink_map-макрос, макрос записи для каждого события, чтобы получать уведомления о и end_eventsink_map-макрос для объявления в конец списка приемника событий.

Дополнительные сведения о схемы приемников событий см. в статье [контейнеры элементов управления ActiveX](../../mfc/activex-control-containers.md).

### <a name="requirements"></a>Требования

  **Заголовок** afxwin.h

##  <a name="end_eventsink_map"></a>  END_EVENTSINK_MAP

Завершает определение карту приемника событий.

```
END_EVENTSINK_MAP()
```

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="on_event"></a>  ON_EVENT

Используйте on_event-макрос, чтобы определить функцию обработчика событий для события, инициированные средой управления OLE.

```
ON_EVENT(theClass, id, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*id*<br/>
Идентификатор элемента управления элемента управления OLE.

*Идентификатор DISPID*<br/>
Идентификатор диспетчеризации событие, запускаемое элементом управления.

*pfnHandler*<br/>
Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь возвращаемый тип и типы параметров, которые соответствуют параметрам события BOOL (см. в разделе *vtsParams*). Данная функция должна возвращать значение TRUE указывает, что событие было обработано; в противном случае — значение FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях диспетчеризации карты, например DISP_FUNCTION.

### <a name="remarks"></a>Примечания

*VtsParams* аргумент является список с разделителями-пробелами значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Указывает список, содержащий короткое целое число, следуют Логическое значение.

Список **VTS_** константы, см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="on_event_range"></a>  ON_EVENT_RANGE

Используйте on_event_range-макрос, чтобы определить функцию обработчика событий для события, инициированные средой любого элемента управления OLE, зная идентификатор элемента управления в непрерывный диапазон идентификаторов.

```
ON_EVENT_RANGE(theClass, idFirst, idLast, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*idFirst*<br/>
Идентификатор элемента управления первого элемента управления OLE в диапазоне.

*idLast*<br/>
Идентификатор элемента управления последнего элемента управления OLE в диапазоне.

*Идентификатор DISPID*<br/>
Идентификатор диспетчеризации событие, запускаемое элементом управления.

*pfnHandler*<br/>
Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь возвращаемый тип, первый параметр типа целое число без знака (для идентификатора элемента управления), а также дополнительный параметр типы, которые соответствуют параметрам события BOOL (см. в разделе *vtsParams*). Данная функция должна возвращать значение TRUE указывает, что событие было обработано; в противном случае — значение FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Первая константа имеет тип VTS_I4, для идентификатора элемента управления Это же константы, которые используются в операциях диспетчеризации карты, например DISP_FUNCTION.

### <a name="remarks"></a>Примечания

*VtsParams* аргумент является список с разделителями-пробелами значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Указывает список, содержащий короткое целое число, следуют Логическое значение.

Список **VTS_** константы, см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="example"></a>Пример

В следующем примере показан обработчик событий для событий MouseDown, реализованы для трех элементов управления (IDC_MYCTRL1 через IDC_MYCTRL3). Функция обработчика событий, `OnRangeMouseDown`, объявляется в файле заголовка класса диалогового окна ( `CMyDlg`) как:

[!code-cpp[NVC_MFCAutomation#12](../../mfc/codesnippet/cpp/event-sink-maps_2.h)]

В следующем примере кода определяется в файле реализации класса диалогового окна.

[!code-cpp[NVC_MFCAutomation#13](../../mfc/codesnippet/cpp/event-sink-maps_3.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="on_event_reflect"></a>  ON_EVENT_REFLECT

On_event_reflect-макрос, при использовании событий приемника карты класса-оболочки элемента управления OLE, получает события, инициируемые элементом управления, прежде чем они будут обработаны с контейнера элемента управления.

```
ON_EVENT_REFLECT(theClass,  dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*Идентификатор DISPID*<br/>
Идентификатор диспетчеризации событие, запускаемое элементом управления.

*pfnHandler*<br/>
Указатель на функцию-член, который обрабатывает событие. Данная функция должна иметь возвращаемый тип и типы параметров, которые соответствуют параметрам события BOOL (см. в разделе *vtsParams*). Данная функция должна возвращать значение TRUE указывает, что событие было обработано; в противном случае — значение FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, указывающих типы параметров для события. Это же константы, которые используются в операциях диспетчеризации карты, например DISP_FUNCTION.

### <a name="remarks"></a>Примечания

*VtsParams* аргумент является список с разделителями-пробелами значений из **VTS_** константы.

Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Указывает список, содержащий короткое целое число, следуют Логическое значение.

Список **VTS_** константы, см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="on_propnotify"></a>  ON_PROPNOTIFY

Используйте on_propnotify-макрос, чтобы определить запись карты приемника событий для обработки уведомления об свойств из элемента управления OLE.

```
ON_PROPNOTIFY(theClass, id, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*id*<br/>
Идентификатор элемента управления элемента управления OLE.

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства, участвующих в уведомлении.

*pfnRequest*<br/>
Указатель на функцию-член, который обрабатывает `OnRequestEdit` уведомления для этого свойства. Данная функция должна иметь возвращаемый тип BOOL и **BOOL** <strong>\*</strong> параметра. Эту функцию следует присвоить параметру значение TRUE, чтобы разрешить изменение этого свойства и значение FALSE, чтобы запретить. Данная функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано. в противном случае — значение FALSE.

*pfnChanged*<br/>
Указатель на функцию-член, который обрабатывает `OnChanged` уведомления для этого свойства. Функция должна иметь возвращаемый тип и параметр целое число без знака типа BOOL. Данная функция должна возвращать значение TRUE указывает, что уведомление было обработано; в противном случае — значение FALSE.

### <a name="remarks"></a>Примечания

*VtsParams* аргумент является список с разделителями-пробелами значений из **VTS_** константы. Один или несколько из следующих значений, разделенных пробелами (не запятыми) Указывает список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

Указывает список, содержащий короткое целое число, следуют Логическое значение.

Список **VTS_** константы, см. в разделе [EVENT_CUSTOM](event-maps.md#event_custom).

##  <a name="on_propnotify_range"></a>  ON_PROPNOTIFY_RANGE

Используйте on_propnotify_range-макрос, чтобы определить запись карты приемника событий для обработки уведомлений свойство из любого элемента управления OLE, зная идентификатор элемента управления в непрерывный диапазон идентификаторов.

```

ON_PROPNOTIFY_RANGE(theClass, idFirst, idLast, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*idFirst*<br/>
Идентификатор элемента управления первого элемента управления OLE в диапазоне.

*idLast*<br/>
Идентификатор элемента управления последнего элемента управления OLE в диапазоне.

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства, участвующих в уведомлении.

*pfnRequest*<br/>
Указатель на функцию-член, который обрабатывает `OnRequestEdit` уведомления для этого свойства. Данная функция должна иметь `BOOL` тип возвращаемого значения и `UINT` и `BOOL*` параметров. Функции параметр должен установлен в значение TRUE, чтобы разрешить изменение этого свойства и значение FALSE, чтобы запретить. Данная функция должна возвращать значение TRUE указывает, что уведомление было обработано; в противном случае — значение FALSE.

*pfnChanged*<br/>
Указатель на функцию-член, который обрабатывает `OnChanged` уведомления для этого свойства. Функция должна иметь `BOOL` тип возвращаемого значения и `UINT` параметра. Данная функция должна возвращать значение TRUE указывает, что уведомление было обработано; в противном случае — значение FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

##  <a name="on_propnotify_reflect"></a>  ON_PROPNOTIFY_REFLECT

On_propnotify_reflect-макрос, при использовании событий приемника карты класса-оболочки элемента управления OLE, Получает свойство уведомлений, отправляемых с помощью элемента управления, прежде чем они будут обработаны с контейнера элемента управления.

```

ON_PROPNOTIFY_REFLECT(theClass, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которой принадлежит эта карта приемника событий.

*Идентификатор DISPID*<br/>
Идентификатор диспетчера свойства, участвующих в уведомлении.

*pfnRequest*<br/>
Указатель на функцию-член, который обрабатывает `OnRequestEdit` уведомления для этого свойства. Данная функция должна иметь возвращаемый тип BOOL и **BOOL** <strong>\*</strong> параметра. Эту функцию следует присвоить параметру значение TRUE, чтобы разрешить изменение этого свойства и значение FALSE, чтобы запретить. Данная функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано. в противном случае — значение FALSE.

*pfnChanged*<br/>
Указатель на функцию-член, который обрабатывает `OnChanged` уведомления для этого свойства. Функция должна иметь возвращаемый тип и без параметров типа BOOL. Данная функция должна возвращать значение TRUE, чтобы указать, что уведомление было обработано. в противном случае — значение FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="see-also"></a>См. также

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
