---
title: Схемы приемников событий
ms.date: 11/04/2016
helpviewer_keywords:
- event sink maps [MFC]
ms.assetid: a9757eb2-5f4a-45ec-a2cd-ce5eec85b16f
ms.openlocfilehash: 731ed2403aae3332e81702673d1181e9e52399a2
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365722"
---
# <a name="event-sink-maps"></a>Схемы приемников событий

Когда встроенный элемент управления OLE запускает событие, контейнер управления получает событие с помощью механизма, называемого «картой поглотителей событий», поставляемой MFC. Карта раковины события обозначает функции обработчика для каждого конкретного события, а также параметры этих событий. Для получения дополнительной информации о [ActiveX Control Containers](../../mfc/activex-control-containers.md)картах раковины событий, см.

### <a name="event-sink-maps"></a>Схемы приемников событий

|||
|-|-|
|[BEGIN_EVENTSINK_MAP](#begin_eventsink_map)|Запускает определение карты раковины события.|
|[DECLARE_EVENTSINK_MAP](#declare_eventsink_map)|Объявляет карту раковины события.|
|[END_EVENTSINK_MAP](#end_eventsink_map)|Завершает определение карты раковины события.|
|[ON_EVENT](#on_event)|Определяет обработчик события для конкретного события.|
|[ON_EVENT_RANGE](#on_event_range)|Определяет обработчик событий для конкретного события, уволенного из набора элементов управления OLE.|
|[ON_EVENT_REFLECT](#on_event_reflect)|Получает события, выпущенные элементом управления, прежде чем они обрабатываются контейнером управления.|
|[ON_PROPNOTIFY](#on_propnotify)|Определяет обработчик для обработки уведомлений об имуществе от управления OLE.|
|[ON_PROPNOTIFY_RANGE](#on_propnotify_range)|Определяет обработчик для обработки уведомлений об имуществе из набора элементов управления OLE.|
|[ON_PROPNOTIFY_REFLECT](#on_propnotify_reflect)|Получает уведомления об имуществе, отправленные элементом управления до того, как они будут обработаны контейнером управления.|

## <a name="begin_eventsink_map"></a><a name="begin_eventsink_map"></a>BEGIN_EVENTSINK_MAP

Начинается определение карты раковины события.

```
BEGIN_EVENTSINK_MAP(theClass, baseClass)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Угляните название класса управления, карта раковины событий.

*базовыйКласс*<br/>
Упогоняет название базового класса *Класса*.

### <a name="remarks"></a>Remarks

В файле реализации (.cpp), определяющем функции участника для вашего класса, запустите карту раковины событий с BEGIN_EVENTSINK_MAP макросом, затем добавьте макрозаписи для каждого события, о которых нужно уведомлять, и заполните карту погружения события с помощью END_EVENTSINK_MAP макроса.

Для получения дополнительной информации о картах раковины [ActiveX Control Containers](../../mfc/activex-control-containers.md)событий и контейнерах управления OLE см.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="declare_eventsink_map"></a><a name="declare_eventsink_map"></a>DECLARE_EVENTSINK_MAP

Контейнер OLE может предоставить карту раковины события, чтобы указать события, о которых будет уведомлен ваш контейнер.

```
DECLARE_EVENTSINK_MAP()
```

### <a name="remarks"></a>Remarks

Используйте DECLARE_EVENTSINK_MAP макрос в конце объявления класса. Затем, в . Файл CPP, определяющий функции участника для класса, используйте BEGIN_EVENTSINK_MAP макрозаписи, макрозаписи для каждого из событий, о которых следует уведомлять, и END_EVENTSINK_MAP макроса для объявления конца списка данных события.

Для получения дополнительной информации о [ActiveX Control Containers](../../mfc/activex-control-containers.md)картах раковины событий, см.

### <a name="requirements"></a>Требования

  **Заголовок** afxwin.h

## <a name="end_eventsink_map"></a><a name="end_eventsink_map"></a>END_EVENTSINK_MAP

Завершает определение карты раковины события.

```
END_EVENTSINK_MAP()
```

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="on_event"></a><a name="on_event"></a>ON_EVENT

Используйте ON_EVENT макрос для определения функции обработчика событий для события, уволенного управлением OLE.

```
ON_EVENT(theClass, id, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*id*<br/>
Идентификатор управления OL.

*Dispid*<br/>
Идентификатор отправки события, уволенный элементом управления.

*pfnHandler*<br/>
Указатель на функцию члена, которая обрабатывает событие. Эта функция должна иметь тип возврата BOOL и типы параметров, которые соответствуют параметрам события (см. *vtsParams).* Функция должна вернуться TRUE, чтобы указать, что событие было обработано; в противном случае FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, которая определяет типы параметров для события. Это те же константы, которые используются в записях от отправляемых карт, таких как DISP_FUNCTION.

### <a name="remarks"></a>Remarks

Аргумент *vtsParams* представляет собой разделенный пространством список значений из **VTS_** констант. Одно или несколько из этих значений, разделенных пробелами (не запятыми), определяет список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

определяет список, содержащий короткий ряд с последующим BOOL.

Список констант **VTS_** [EVENT_CUSTOM](event-maps.md#event_custom)см.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="on_event_range"></a><a name="on_event_range"></a>ON_EVENT_RANGE

Используйте ON_EVENT_RANGE макрос, чтобы определить функцию обработчика событий для события, уволенного любым управлением OLE, имеющим идентификатор управления в смежном диапазоне идентификаторов.

```
ON_EVENT_RANGE(theClass, idFirst, idLast, dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*idПервый*<br/>
Идентификатор управления первым управлением OLE в диапазоне.

*idLast*<br/>
Идентификатор управления последним управлением OLE в диапазоне.

*Dispid*<br/>
Идентификатор отправки события, уволенный элементом управления.

*pfnHandler*<br/>
Указатель на функцию члена, которая обрабатывает событие. Эта функция должна иметь тип возврата BOOL, первый параметр типа UINT (для идентификатора управления) и дополнительные типы параметров, которые соответствуют параметрам события (см. *vtsParams).* Функция должна вернуться TRUE, чтобы указать, что событие было обработано; в противном случае FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, которая определяет типы параметров для события. Первая константа должна быть типа VTS_I4, для идентификатора управления. Это те же константы, которые используются в записях от отправляемых карт, таких как DISP_FUNCTION.

### <a name="remarks"></a>Remarks

Аргумент *vtsParams* представляет собой разделенный пространством список значений из **VTS_** констант. Одно или несколько из этих значений, разделенных пробелами (не запятыми), определяет список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

определяет список, содержащий короткий ряд с последующим BOOL.

Список констант **VTS_** [EVENT_CUSTOM](event-maps.md#event_custom)см.

### <a name="example"></a>Пример

В следующем примере показано обработчик событий для события MouseDown, реализованный для трех элементов управления (IDC_MYCTRL1 через IDC_MYCTRL3). Функция обработчика событий, `OnRangeMouseDown`объявляется в файле заголовка класса диалогов () `CMyDlg`как:

[!code-cpp[NVC_MFCAutomation#12](../../mfc/codesnippet/cpp/event-sink-maps_2.h)]

Приведенный ниже код определен в файле реализации класса диалогов.

[!code-cpp[NVC_MFCAutomation#13](../../mfc/codesnippet/cpp/event-sink-maps_3.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="on_event_reflect"></a><a name="on_event_reflect"></a>ON_EVENT_REFLECT

Макрос ON_EVENT_REFLECT, при использовании в карте раковины в случае погружения класса обертки управления OLE, получает события, выпущенные элементом управления, прежде чем они обрабатываются контейнером управления.

```
ON_EVENT_REFLECT(theClass,  dispid, pfnHandler,  vtsParams)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*Dispid*<br/>
Идентификатор отправки события, уволенный элементом управления.

*pfnHandler*<br/>
Указатель на функцию члена, которая обрабатывает событие. Эта функция должна иметь тип возврата BOOL и типы параметров, которые соответствуют параметрам события (см. *vtsParams).* Функция должна вернуться TRUE, чтобы указать, что событие было обработано; в противном случае FALSE.

*vtsParams*<br/>
Последовательность **VTS_** констант, которая определяет типы параметров для события. Это те же константы, которые используются в записях от отправляемых карт, таких как DISP_FUNCTION.

### <a name="remarks"></a>Remarks

Аргумент *vtsParams* представляет собой разделенный пространством список значений из **VTS_** констант.

Одно или несколько из этих значений, разделенных пробелами (не запятыми), определяет список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

определяет список, содержащий короткий ряд с последующим BOOL.

Список констант **VTS_** [EVENT_CUSTOM](event-maps.md#event_custom)см.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="on_propnotify"></a><a name="on_propnotify"></a>ON_PROPNOTIFY

Используйте ON_PROPNOTIFY макрос, чтобы определить запись карты раковины события для обработки уведомлений о собственности от управления OLE.

```
ON_PROPNOTIFY(theClass, id, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*id*<br/>
Идентификатор управления OL.

*Dispid*<br/>
Идентификатор отправки имущества, участвующего в уведомлении.

*pfnЗапрос*<br/>
Указатель на функцию члена, `OnRequestEdit` которая обрабатывает уведомление для этого свойства. Эта функция должна иметь тип возврата BOOL и параметр **BOOL.** <strong>\*</strong> Эта функция должна установить параметр, чтобы true, чтобы позволить свойство изменить и FALSE запретить. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

*pfnChanged*<br/>
Указатель на функцию члена, `OnChanged` которая обрабатывает уведомление для этого свойства. Функция должна иметь тип возврата BOOL и параметр UINT. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

### <a name="remarks"></a>Remarks

Аргумент *vtsParams* представляет собой разделенный пространством список значений из **VTS_** констант. Одно или несколько из этих значений, разделенных пробелами (не запятыми), определяет список параметров функции. Пример:

[!code-cpp[NVC_MFCAutomation#11](../../mfc/codesnippet/cpp/event-sink-maps_1.cpp)]

определяет список, содержащий короткий ряд с последующим BOOL.

Список констант **VTS_** [EVENT_CUSTOM](event-maps.md#event_custom)см.

## <a name="on_propnotify_range"></a><a name="on_propnotify_range"></a>ON_PROPNOTIFY_RANGE

Используйте ON_PROPNOTIFY_RANGE макрос, чтобы определить запись карты раковины события для обработки уведомлений о собственности от любого управления OLE, имеющего идентификатор управления в пределах смежного диапазона идентификаторов.

```

ON_PROPNOTIFY_RANGE(theClass, idFirst, idLast, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*idПервый*<br/>
Идентификатор управления первым управлением OLE в диапазоне.

*idLast*<br/>
Идентификатор управления последним управлением OLE в диапазоне.

*Dispid*<br/>
Идентификатор отправки имущества, участвующего в уведомлении.

*pfnЗапрос*<br/>
Указатель на функцию члена, `OnRequestEdit` которая обрабатывает уведомление для этого свойства. Эта функция должна `BOOL` иметь `UINT` тип `BOOL*` возврата и параметры. Функция должна установить параметр, чтобы true, чтобы позволить свойство изменить и FALSE запретить. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

*pfnChanged*<br/>
Указатель на функцию члена, `OnChanged` которая обрабатывает уведомление для этого свойства. Функция должна иметь `BOOL` тип возврата `UINT` и параметр. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="on_propnotify_reflect"></a><a name="on_propnotify_reflect"></a>ON_PROPNOTIFY_REFLECT

В ON_PROPNOTIFY_REFLECT макрос, при использовании в случае раковины карту обертки класса OL управления, получает уведомления о собственности, отправленные элементом управления, прежде чем они обрабатываются контейнером управления.

```

ON_PROPNOTIFY_REFLECT(theClass, dispid, pfnRequest, pfnChanged)
```

### <a name="parameters"></a>Параметры

*theClass*<br/>
Класс, к которому принадлежит карта раковины этого события.

*Dispid*<br/>
Идентификатор отправки имущества, участвующего в уведомлении.

*pfnЗапрос*<br/>
Указатель на функцию члена, `OnRequestEdit` которая обрабатывает уведомление для этого свойства. Эта функция должна иметь тип возврата BOOL и параметр **BOOL.** <strong>\*</strong> Эта функция должна установить параметр, чтобы true, чтобы позволить свойство изменить и FALSE запретить. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

*pfnChanged*<br/>
Указатель на функцию члена, `OnChanged` которая обрабатывает уведомление для этого свойства. Функция должна иметь тип возврата BOOL и никаких параметров. Функция должна вернуться TRUE, чтобы указать, что уведомление было обработано; в противном случае FALSE.

### <a name="requirements"></a>Требования

  **Заголовок** afxdisp.h

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
