---
title: Класс CDaoWorkspace
ms.date: 11/04/2016
f1_keywords:
- CDaoWorkspace
- AFXDAO/CDaoWorkspace
- AFXDAO/CDaoWorkspace::CDaoWorkspace
- AFXDAO/CDaoWorkspace::Append
- AFXDAO/CDaoWorkspace::BeginTrans
- AFXDAO/CDaoWorkspace::Close
- AFXDAO/CDaoWorkspace::CommitTrans
- AFXDAO/CDaoWorkspace::CompactDatabase
- AFXDAO/CDaoWorkspace::Create
- AFXDAO/CDaoWorkspace::GetDatabaseCount
- AFXDAO/CDaoWorkspace::GetDatabaseInfo
- AFXDAO/CDaoWorkspace::GetIniPath
- AFXDAO/CDaoWorkspace::GetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::GetLoginTimeout
- AFXDAO/CDaoWorkspace::GetName
- AFXDAO/CDaoWorkspace::GetUserName
- AFXDAO/CDaoWorkspace::GetVersion
- AFXDAO/CDaoWorkspace::GetWorkspaceCount
- AFXDAO/CDaoWorkspace::GetWorkspaceInfo
- AFXDAO/CDaoWorkspace::Idle
- AFXDAO/CDaoWorkspace::IsOpen
- AFXDAO/CDaoWorkspace::Open
- AFXDAO/CDaoWorkspace::RepairDatabase
- AFXDAO/CDaoWorkspace::Rollback
- AFXDAO/CDaoWorkspace::SetDefaultPassword
- AFXDAO/CDaoWorkspace::SetDefaultUser
- AFXDAO/CDaoWorkspace::SetIniPath
- AFXDAO/CDaoWorkspace::SetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::SetLoginTimeout
- AFXDAO/CDaoWorkspace::m_pDAOWorkspace
helpviewer_keywords:
- CDaoWorkspace [MFC], CDaoWorkspace
- CDaoWorkspace [MFC], Append
- CDaoWorkspace [MFC], BeginTrans
- CDaoWorkspace [MFC], Close
- CDaoWorkspace [MFC], CommitTrans
- CDaoWorkspace [MFC], CompactDatabase
- CDaoWorkspace [MFC], Create
- CDaoWorkspace [MFC], GetDatabaseCount
- CDaoWorkspace [MFC], GetDatabaseInfo
- CDaoWorkspace [MFC], GetIniPath
- CDaoWorkspace [MFC], GetIsolateODBCTrans
- CDaoWorkspace [MFC], GetLoginTimeout
- CDaoWorkspace [MFC], GetName
- CDaoWorkspace [MFC], GetUserName
- CDaoWorkspace [MFC], GetVersion
- CDaoWorkspace [MFC], GetWorkspaceCount
- CDaoWorkspace [MFC], GetWorkspaceInfo
- CDaoWorkspace [MFC], Idle
- CDaoWorkspace [MFC], IsOpen
- CDaoWorkspace [MFC], Open
- CDaoWorkspace [MFC], RepairDatabase
- CDaoWorkspace [MFC], Rollback
- CDaoWorkspace [MFC], SetDefaultPassword
- CDaoWorkspace [MFC], SetDefaultUser
- CDaoWorkspace [MFC], SetIniPath
- CDaoWorkspace [MFC], SetIsolateODBCTrans
- CDaoWorkspace [MFC], SetLoginTimeout
- CDaoWorkspace [MFC], m_pDAOWorkspace
ms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52
ms.openlocfilehash: 52aaa4970ef483988194691eb6b870cbfe51f494
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81377114"
---
# <a name="cdaoworkspace-class"></a>Класс CDaoWorkspace

Управление именованным, защищенным паролем сеансом базы данных от входа до выхода одним пользователем. DAO поддерживается через Office 2013. DAO 3.6 является окончательной версией, и он считается устаревшим.

## <a name="syntax"></a>Синтаксис

```
class CDaoWorkspace : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|Имя|Описание|
|----------|-----------------|
|[CDaoWorkspace:CDaoWorkspace](#cdaoworkspace)|Строит объект рабочего пространства. После этого `Create` позвоните или `Open`.|

### <a name="public-methods"></a>Открытые методы

|Имя|Описание|
|----------|-----------------|
|[CDaoWorkspace::Приложение](#append)|Приспособает недавно созданное рабочее пространство к коллекции рабочих пространств движка базы данных.|
|[CDaoWorkspace::BeginTrans](#begintrans)|Начинается новая транзакция, которая применяется ко всем базам данных, открытым в рабочей области.|
|[CDaoWorkspace::Закрыть](#close)|Закрывает рабочее пространство и все объекты, которые она содержит. Ожидающие транзакции откатываются.|
|[CDaoWorkspace::CommitTrans](#committrans)|Завершает текущую транзакцию и сохраняет изменения.|
|[CDaoWorkspace:CompactDatabase](#compactdatabase)|Компакты (или дубликаты) базы данных.|
|[CDaoWorkspace::Создание](#create)|Создает новый объект рабочего пространства DAO.|
|[CDaoWorkspace::GetDatabaseCount](#getdatabasecount)|Возвращает количество объектов базы данных DAO в коллекцию баз данных рабочего пространства.|
|[CDaoWorkspace::GetDatabaseInfo](#getdatabaseinfo)|Возвращает информацию об указанной базе данных DAO, определенной в коллекции баз данных рабочего пространства.|
|[CDaoWorkspace::GetIniPath](#getinipath)|Возвращает расположение параметров инициализации движка базы данных Microsoft Jet в реестре Windows.|
|[CDaoWorkspace::GetIsolateODBCTrans](#getisolateodbctrans)|Возвращает значение, указываволи ли несколько транзакций, связанных с тем же источником данных ODBC, через принудительное несколько подключений к источнику данных.|
|[CDaoWorkspace:GetLoginTimeout](#getlogintimeout)|Возвращает количество секунд до ошибки, когда пользователь пытается войти в базу данных ODBC.|
|[CDaoWorkspace::GetName](#getname)|Возвращает имя, определяемое пользователем, для объекта рабочей области.|
|[CDaoWorkspace::GetUserName](#getusername)|Возвращает имя пользователя, указанное при создании рабочего пространства. Это имя владельца рабочего пространства.|
|[CDaoWorkspace:GetVersion](#getversion)|Возвращает строку, содержащую версию движка базы данных, связанную с рабочим пространством.|
|[CDaoWorkspace::GetWorkspaceCount](#getworkspacecount)|Возвращает количество объектов рабочего пространства DAO в коллекцию рабочих пространств движка базы данных.|
|[CDaoWorkspace::GetWorkspaceInfo](#getworkspaceinfo)|Возвращает информацию об определенном рабочем пространстве DAO, определенном в коллекции рабочих пространств движка базы данных.|
|[CDaoWorkspace::Idle](#idle)|Позволяет движку базы данных выполнять фоновые задачи.|
|[CDaoWorkspace::IsOpen](#isopen)|Возвращает ненулевой, если рабочее пространство открыто.|
|[CDaoWorkspace::Открыто](#open)|Явно открывает объект рабочей области, связанный с рабочим пространством DAO по умолчанию.|
|[CDaoWorkspace::RepairDatabase](#repairdatabase)|Попытки восстановить поврежденную базу данных.|
|[CDaoWorkspace::Откат](#rollback)|Завершает текущую транзакцию и не сохраняет изменения.|
|[CDaoWorkspace::SetDefaultPassword](#setdefaultpassword)|Устанавливает пароль, который использует движок базы данных при создании объекта рабочего пространства без определенного пароля.|
|[CDaoWorkspace::SetDefaultUser](#setdefaultuser)|Устанавливает имя пользователя, которое использует движок базы данных при создании объекта рабочего пространства без определенного имени пользователя.|
|[CDaoWorkspace::SetIniPath](#setinipath)|Устанавливает расположение параметров инициализации движка базы данных Microsoft Jet в реестре Windows.|
|[CDaoWorkspace::SetIsolateODBCTrans](#setisolateodbctrans)|Определяется, изолированы ли несколько транзакций, связанных с тем же источником данных ODBC, путем принудительного подключения к источнику данных.|
|[CDaoWorkspace::SetLoginTimeout](#setlogintimeout)|Устанавливает количество секунд до возникновения ошибки при попытке пользователя войти в исходный код данных ODBC.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[CDaoWorkspace::m_pDAOWorkspace](#m_pdaoworkspace)|Указывает на базовый объект рабочего пространства DAO.|

## <a name="remarks"></a>Remarks

В большинстве случаев вам не потребуется несколько рабочих пространств, и вам не нужно будет создавать явные объекты рабочей области; при открытии объектов базы данных и записей они используют рабочее пространство DAO по умолчанию. Однако при необходимости можно запускать несколько сеансов одновременно, создавая дополнительные объекты рабочего пространства. Каждый объект рабочего пространства может содержать несколько открытых объектов базы данных в своей собственной коллекции баз данных. В МФЦ рабочее пространство — это прежде всего менеджер транзакций, определяющий набор открытых баз данных в одном и том же «пространстве транзакций».

> [!NOTE]
> Классы баз данных DAO отличаются от классов баз данных MFC на основе open Database Connectivity (ODBC). Все названия классов баз данных DAO имеют префикс "CDao". В целом, классы МФЦ на основе DAO более способны, чем классы MFC на основе ODBC. Классы dAO получают доступ к данным через движок базы данных Microsoft Jet, включая драйверы ODBC. Они также поддерживают операции по определению данных (DDL), такие как создание баз данных и добавление таблиц и полей через классы, без необходимости звонить в DAO напрямую.

## <a name="capabilities"></a>Возможности

Класс `CDaoWorkspace` обеспечивает следующее:

- Явный доступ, при необходимости, к рабочему пространству по умолчанию, созданный путем инициализации движка базы данных. Обычно рабочая область DAO используется неявно, создавая объекты баз данных и записи.

- Пространство транзакций, в котором транзакции применяются ко всем базам данных, открытым в рабочей области. Можно создать дополнительные рабочие пространства для управления отдельными пространствами транзакций.

- Интерфейс для многих свойств базовой движки базы данных Microsoft Jet (см. функции статических членов). Открытие или создание рабочего пространства, или вызов функции статического члена перед открытием или созданием, инициализирует движок базы данных.

- Доступ к коллекции рабочих пространств движка базы данных, в которой хранятся все активные рабочие пространства, которые были приложена к нему. Вы также можете создавать и работать с рабочими пространствами, не приговывая их к коллекции.

## <a name="security"></a>Безопасность

MFC не реализует коллекции пользователей и групп в DAO, которые используются для контроля безопасности. Если вам нужны эти аспекты DAO, вы должны запрограммировать их самостоятельно с помощью прямых звонков на интерфейсы DAO. Для получения информации [см.](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)

## <a name="usage"></a>Использование

Вы можете `CDaoWorkspace` использовать класс для:

- Явно откройте рабочее пространство по умолчанию.

   Обычно использование рабочего пространства по умолчанию является неявным - при открытии новых объектов [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) или [CDaoRecordset.](../../mfc/reference/cdaorecordset-class.md) Но, возможно, потребуется получить к нему явное доступ, например, для доступа к свойствам движка базы данных или коллекции рабочих пространств. Ниже приведено "Неявное использование рабочего пространства по умолчанию".

- Создание новых рабочих пространств. Позвоните [в приложение,](#append) если хотите добавить их в коллекцию Workspaces.

- Откройте существующее рабочее пространство в коллекции Рабочих пространств.

Создание нового рабочего пространства, которое еще не существует в коллекции Workspaces, описано в функции члена [Create.](#create) Объекты рабочего пространства никоим образом не сохраняются между сеансами движка datababase. Если приложение связывает MFC статично, окончание приложения не инициирует движок базы данных. Если ваше приложение динамически связано с MFC, движок базы данных не является первоначальным при выгрузке DLL MFC.

Явное открытие рабочего пространства по умолчанию или открытие существующего рабочего пространства в коллекции рабочих пространств описано в функции [Open](#open) member.

Завершите сеанс рабочего пространства, закрыв рабочее пространство с функцией [участника Close.](#close) `Close`закрывает все базы данных, которые вы не закрывали ранее, откатив любые незафиксированные транзакции.

## <a name="transactions"></a>Transactions

DAO управляет транзакциями на рабочем уровне; следовательно, транзакции на рабочем пространстве с несколькими открытыми базами данных применяются ко всем базам данных. Например, если в двух базах данных есть незафиксированные обновления и вы звоните [в CommitTrans,](#committrans)все обновления зафиксированы. Если требуется ограничить транзакции одной базой данных, для нее нужен отдельный объект рабочего пространства.

## <a name="implicit-use-of-the-default-workspace"></a>Неявное использование рабочего пространства по умолчанию

МФС использует рабочее пространство DAO по умолчанию неявно при следующих обстоятельствах:

- Если вы создаете новый `CDaoDatabase` объект, но `CDaoWorkspace` не делаете этого через существующий объект, MFC создает для вас временный объект рабочей области, который соответствует рабочему пространству DAO по умолчанию. Если сделать это для нескольких баз данных, все объекты базы данных связаны с рабочим пространством по умолчанию. Вы можете получить доступ к рабочей области базы данных через участника `CDaoDatabase` данных.

- Аналогичным образом, если `CDaoRecordset` вы создаете объект без `CDaoDatabase` предоставления указателя на объект, MFC создает временный объект базы данных и, соответственно, временный объект рабочего пространства. Вы можете получить доступ к базе данных recordset, `CDaoRecordset` и косвенно его рабочее пространство, через члена данных.

## <a name="other-operations"></a>Прочие операции

Предоставляются также другие операции базы данных, такие как восстановление поврежденной базы данных или уплотнение базы данных.

Для получения информации о вызове DAO напрямую и о безопасности DAO, [см.](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoWorkspace`

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

## <a name="cdaoworkspaceappend"></a><a name="append"></a>CDaoWorkspace::Приложение

Вызов этой функции участника после вызова [Create](#create).

```
virtual void Append();
```

### <a name="remarks"></a>Remarks

`Append`прикладывает недавно созданный объект рабочего пространства к коллекции рабочих пространств движка базы данных. Рабочие области не сохраняются между сеансами движка базы данных; они хранятся только в памяти, а не на диске. Вам не нужно приговыть рабочее пространство; если вы этого не сделаете, вы все еще можете использовать его.

Приложенное рабочее пространство остается в коллекции Workspaces в активном, открытом состоянии, пока вы не вызовете функцию [элемента Close.](#close)

Для получения соответствующей информации, см.

## <a name="cdaoworkspacebegintrans"></a><a name="begintrans"></a>CDaoWorkspace::BeginTrans

Вызовите эту функцию участника, чтобы инициировать транзакцию.

```
void BeginTrans();
```

### <a name="remarks"></a>Remarks

После вызова, `BeginTrans`обновления, которые вы вносить в ваши данные или структуру базы данных вступают в силу при совершении транзакции. Поскольку рабочее пространство определяет единое пространство транзакции, транзакция применяется ко всем открытым базам данных в рабочей области. Существует два способа завершения транзакции:

- Вызов функции участника [CommitTrans](#committrans) для совершения транзакции и сохранения изменений в источнике данных.

- Или позвоните в функцию участника [отката,](#rollback) чтобы отменить транзакцию.

Закрытие объекта рабочего пространства или объекта базы данных во время ожидания транзакции откатывает все ожидающие транзакции.

Если вам нужно изолировать транзакции на одном источнике данных ODBC [SetIsolateODBCTrans](#setisolateodbctrans) от данных другого источника данных ODBC, см.

## <a name="cdaoworkspacecdaoworkspace"></a><a name="cdaoworkspace"></a>CDaoWorkspace:CDaoWorkspace

Формирует объект `CDaoWorkspace`.

```
CDaoWorkspace();
```

### <a name="remarks"></a>Remarks

После построения объекта СЗ У вас есть два варианта:

- Вызовите функцию [«Открытая](#open) функция» объекта, чтобы открыть рабочее пространство по умолчанию или открыть существующий объект в коллекции Рабочих пространств.

- Или позвоните в функцию [члена создания](#create) объекта для создания нового объекта рабочего пространства DAO. Это явно запускает новую рабочую сессию, на `CDaoWorkspace` которую можно ссылаться через объект. После `Create`вызова можно позвонить в [Append,](#append) если вы хотите добавить рабочее пространство в коллекцию рабочих пространств движка базы данных.

Сведения о том, когда необходимо явно создать `CDaoWorkspace` объект, см. в обзоре класса для [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md). Обычно при открытии объекта [CDaoDatabase,](../../mfc/reference/cdaodatabase-class.md) не указывая рабочее пространство или при открытии объекта [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) без указания объекта базы данных, используются рабочие пространства, созданные неявно. Объекты MFC DAO, созданные таким образом, используют рабочее пространство DAO по умолчанию, которое создается один раз и повторно используется.

Чтобы освободить рабочее пространство и содержащиеся в нем объекты, позвоните функции [члена рабочего пространства.](#close)

## <a name="cdaoworkspaceclose"></a><a name="close"></a>CDaoWorkspace::Закрыть

Вызовите эту функцию участника, чтобы закрыть объект рабочей области.

```
virtual void Close();
```

### <a name="remarks"></a>Remarks

Закрытие объекта открытого рабочего пространства освобождает базовый объект DAO и, если рабочее пространство является членом коллекции Workspaces, удаляет его из коллекции. Вызов `Close` является хорошей практикой программирования.

> [!CAUTION]
> Закрытие объекта рабочего пространства закрывает все открытые базы данных в рабочей области. Это приводит к тому, что все записи, открытые в закрытых базах данных, также будут отброшены, а любые отложенные изменения или обновления откатываются. Для получения соответствующей информации, см [CDaoDatabase::Закрыть](../../mfc/reference/cdaodatabase-class.md#close), [CDaoRecordset::Закрыть](../../mfc/reference/cdaorecordset-class.md#close), [CDaoTableDef::Закрыть](../../mfc/reference/cdaotabledef-class.md#close), и [CDao-КериДеф::Закрыть](../../mfc/reference/cdaoquerydef-class.md#close) функции члена.

Объекты рабочего пространства не являются постоянными; они существуют только в то время как ссылки на них существуют. Это означает, что по окончании сеанса движка базы данных рабочее пространство и сбор баз данных не сохраняются. Необходимо воссоздать их для следующей сессии, снова открыв рабочее пространство и базу данных.

Для получения соответствующей информации смотрите тему "Закрыть метод" в справке DAO.

## <a name="cdaoworkspacecommittrans"></a><a name="committrans"></a>CDaoWorkspace::CommitTrans

Вызов этой функции участника для совершения транзакции - сохраните группу декретов и обновлений в одной или нескольких базах данных в рабочем пространстве.

```
void CommitTrans();
```

### <a name="remarks"></a>Remarks

Транзакция состоит из ряда изменений в данных базы данных или ее структуре, начиная с звонка [в BeginTrans.](#begintrans) Когда вы завершаете транзакцию, либо зафиксировать ее, либо откатить (отменить изменения) с [помощью Отката.](#rollback) По умолчанию, без транзакций, обновления записей совершаются немедленно. Вызов `BeginTrans` вызывает принятие обновлений, `CommitTrans`которые будут отложены до тех пор, пока вы не позвоните.

> [!CAUTION]
> В пределах одного рабочего пространства транзакции всегда являются глобальными для рабочего пространства и не ограничиваются только одной базой данных или рекордными данными. Если вы выполняете операции на нескольких базах данных `CommitTrans` или записи в `Rollback` транзакции рабочего пространства, фиксируете все ожидающие обновления и восстанавливаете все операции в этих базах данных и записях.

При закрытии базы данных или рабочего пространства с ожидающими транзакциями все транзакции откатываются.

> [!NOTE]
> Это не двухэтапный механизм фиксации. Если одно обновление не выполняется, другие по-прежнему будут фиксировать.

## <a name="cdaoworkspacecompactdatabase"></a><a name="compactdatabase"></a>CDaoWorkspace:CompactDatabase

Вызовите эту функцию участника для компакта указанного Microsoft Jet (. MDB) базы данных.

```
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int nOptions = 0);

static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale,
    int nOptions,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszSrcName*<br/>
Название существующей закрытой базы данных. Это может быть полный путь и имя\\файла, например, "C: MYDB. MDB". Если имя файла имеет расширение, необходимо указать его. Если ваша сеть поддерживает единую конвенцию именования (UNC),\\\\\\вы также\\можете\\указать\\сетевой путь, например, « »MYSERVER »MYSHARE »MYDIR »MYDB. MDB". (Двойные задние слэши необходимы в\\строках пути, потому что «является персонажем побега с СЗ.)

*lpszDestName*<br/>
Полный путь уплотненных баз данных, которую вы создаете. Вы также можете указать сетевой путь, как с *lpszSrcName*. Вы не можете использовать аргумент *lpszDestName,* чтобы указать тот же файл базы данных, что и *lpszSrcName.*

*lpszPassword*<br/>
Пароль, используемый при уплотнении защищенной паролем базы данных. Обратите внимание, что если `CompactDatabase` вы используете версию, которая принимает пароль, вы должны предоставить все параметры. Кроме того, поскольку это параметр подключения, он требует специального форматирования, а именно: ; PWD' *lpszPassword*. Например: ; PWD'"Счастливый". (Необходима ведущая запятая.)

*lpszLocale*<br/>
Выражение строки, используемое для определения порядка коллажа для создания *lpszDestName.* Если вы опустите этот аргумент, приняв `dbLangGeneral` значение по умолчанию (см. ниже), то местоло новой базы данных совпадает с тем, что и в старой базе данных. Возможны следующие значения:

- `dbLangGeneral`Английский, немецкий, французский, португальский, итальянский и современный испанский

- `dbLangArabic`арабский

- `dbLangCyrillic`русский

- `dbLangCzech`чешский

- `dbLangDutch`нидерландский

- `dbLangGreek`греческий

- `dbLangHebrew`иврит

- `dbLangHungarian`венгерский

- `dbLangIcelandic`исландский

- `dbLangNordic`Скандинавские языки (только версия движка базы данных Microsoft Jet 1.0)

- `dbLangNorwdan`Норвежский и датский

- `dbLangPolish`польский

- `dbLangSpanish`Традиционный испанский

- `dbLangSwedfin`Шведский и финский языки

- `dbLangTurkish`турецкий

*nВарианты*<br/>
Указывает один или несколько вариантов для целевой базы данных, *lpszDestName*. Если вы опустите этот аргумент, приняв значение по умолчанию, *lpszDestName* будет иметь то же шифрование и ту же версию, что и *lpszSrcName.* Вы можете `dbEncrypt` объединить `dbDecrypt` или вариант с одним из вариантов версии с помощью оператора bitwise-OR. Возможные значения, которые указывают формат базы данных, а не версию движка базы данных, являются:

- `dbEncrypt`Шифрование базы данных при уплотнении.

- `dbDecrypt`Расшифровка базы данных при уплотнении.

- `dbVersion10`Создайте базу данных, которая использует версию движка базы данных Microsoft Jet 1.0 при уплотнении.

- `dbVersion11`Создайте базу данных, которая использует версию движка базы данных Microsoft Jet 1.1 при уплотнении.

- `dbVersion20`Создайте базу данных, которая использует версию движка базы данных Microsoft Jet 2.0 при уплотнении.

- `dbVersion30`Создайте базу данных, которая использует версию движка базы данных Microsoft Jet 3.0 при уплотнении.

Можно использовать `dbEncrypt` `dbDecrypt` или в аргументе вариантов указать, следует ли шифровать или расшифровать базу данных по мере ее уплотняемого. Если вы опустите постоянную `dbDecrypt` шифрование или если вы включаете оба, и `dbEncrypt` *lpszDestName* будет иметь такое же шифрование, как *lpszSrcName*. Можно использовать одну из констант версии в аргументе вариантов, чтобы указать версию формата данных для уплотненной базы данных. Эта константа влияет только на версию формата данных *lpszDestName*. Можно указать только одну константу версии. Если вы опустете версию постоянной, *lpszDestName* будет иметь ту же версию, *что и lpszSrcName*. Вы можете *компактlpszDestName* только для версии, которая такая же или позже, чем *lpszSrcName*.

> [!CAUTION]
> Если база данных не зашифрована, можно, даже если вы реализуете безопасность пользователя/пароля, непосредственно читать файл бинарного диска, который является базой данных.

### <a name="remarks"></a>Remarks

При изменении данных в базе данных файл базы данных может стать фрагментированным и использовать больше дискового пространства, чем это необходимо. Периодически необходимо уплотнять базу данных для дефрагментации файла базы данных. Уплотнение базы данных, как правило, меньше. Вы также можете изменить порядок сопоставления, шифрование или версию формата данных во время копирования и сжатия базы данных.

> [!CAUTION]
> Функция `CompactDatabase` участника не будет правильно конвертировать полную базу данных Microsoft Access из одной версии в другую. Преобразуется только формат данных. Объекты, определяемые Microsoft Access, такие как формы и отчеты, не преобразуются. Однако данные корректно преобразуются.

> [!TIP]
> Вы также `CompactDatabase` можете использовать для копирования файла базы данных.

Для получения дополнительной информации о уплотнении баз данных, см.

## <a name="cdaoworkspacecreate"></a><a name="create"></a>CDaoWorkspace::Создание

Вызовите эту функцию участника, чтобы создать новый объект `CDaoWorkspace` рабочего пространства DAO и связать его с объектом MFC.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszUserName,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Строка с до 14 символами, которая однозначно называет новый объект рабочего пространства. Вы должны предоставить имя. Для получения соответствующей информации, см.

*lpszUserName*<br/>
Имя пользователя владельца рабочего пространства. Для получения требований см. параметр *lpszDefaultUser* с функцией члена [SetDefaultUser.](#setdefaultuser) Для получения соответствующей информации смотрите тему "UserName Property" в справке DAO.

*lpszPassword*<br/>
Пароль для нового объекта рабочей области. Пароль может быть до 14 символов в длину и может содержать любой символ, кроме ASCII 0 (null). В паролях учитывается регистр символов. Для получения соответствующей информации смотрите тему "Password Property" в справке DAO.

### <a name="remarks"></a>Remarks

Общий процесс создания:

1. Постройте объект [CDaoWorkspace.](#cdaoworkspace)

1. Вызовите функцию `Create` члена объекта, чтобы создать основное рабочее пространство DAO. Необходимо указать имя рабочей области.

1. Дополнительно позвоните [в Append,](#append) если вы хотите добавить рабочее пространство в коллекцию рабочих пространств движка базы данных. Вы можете работать с рабочим пространством, не применяя его.

После `Create` вызова объект рабочего пространства находится в открытом состоянии, готовом к использованию. Вы не `Open` звоните после `Create`. Вы не `Create` звоните, если рабочее пространство уже существует в коллекции Рабочих пространств. `Create`Инициализирует движок базы данных, если он еще не был инициализирован для приложения.

## <a name="cdaoworkspacegetdatabasecount"></a><a name="getdatabasecount"></a>CDaoWorkspace::GetDatabaseCount

Вызовите эту функцию участника для получения числа объектов базы данных DAO в коллекции баз данных рабочего пространства — числа открытых баз данных в рабочей области.

```
short GetDatabaseCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество открытых баз данных в рабочей области.

### <a name="remarks"></a>Remarks

`GetDatabaseCount`полезно, если вам нужно проехать через все определенные базы данных в коллекции баз данных рабочего пространства. Чтобы получить информацию о данной базе данных в коллекции, [см. GetDatabaseInfo](#getdatabaseinfo). Типичное использование `GetDatabaseCount` заключается в том, чтобы призвать число открытых баз `GetDatabaseInfo`данных, а затем использовать это число в качестве цикла индекса для повторных вызовов.

## <a name="cdaoworkspacegetdatabaseinfo"></a><a name="getdatabaseinfo"></a>CDaoWorkspace::GetDatabaseInfo

Вызовите эту функцию участника для получения различного рода информации об открытии базы данных в рабочей области.

```
void GetDatabaseInfo(
    int nIndex,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetDatabaseInfo(
    LPCTSTR lpszName,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Нулевой индекс объекта базы данных в коллекции баз данных рабочего пространства для поиска по индексу.

*dbinfo*<br/>
Ссылка на объект [CDaoDatabaseInfo,](../../mfc/reference/cdaodatabaseinfo-structure.md) который возвращает запрашиваемую информацию.

*dwInfoOptions*<br/>
Параметры, которые определяют, какую информацию о базе данных для извлечения. Доступные варианты перечислены здесь вместе с тем, что они вызывают функцию возвращения:

- AFX_DAO_PRIMARY_INFO (по умолчанию) Имя, Updatable, Транзакции

- AFX_DAO_SECONDARY_INFO Первичная информация плюс: Версия, Сопоставление заказа, Тайм-аут запроса

- AFX_DAO_ALL_INFO Первичная и вторичная информация плюс: Подключение

*lpszName*<br/>
Имя объекта базы данных для поиска по имени. Название представляет собой строку с до 14 символов, которые однозначно имен нового объекта рабочего пространства.

### <a name="remarks"></a>Remarks

Одна из версий функции позволяет искать базу данных по индексу. Другая версия позволяет искать базу данных по имени.

Для описания информации, возвращенной в *dbinfo*, см. [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) Эта структура имеет членов, которые соответствуют пунктам информации, перечисленных выше в описании *dwInfoOptions*. Когда вы запрашиваете информацию на одном уровне, вы получаете информацию для любых предыдущих уровней, а также.

## <a name="cdaoworkspacegetinipath"></a><a name="getinipath"></a>CDaoWorkspace::GetIniPath

Позвоните в эту функцию участника, чтобы получить расположение параметров инициализации движка базы данных Microsoft Jet в реестре Windows.

```
static CString PASCAL GetIniPath();
```

### <a name="return-value"></a>Возвращаемое значение

[CString,](../../atl-mfc-shared/reference/cstringt-class.md) содержащий местоположение реестра.

### <a name="remarks"></a>Remarks

Вы можете использовать местоположение для получения информации о настройках для движка базы данных. Возвращенная информация на самом деле является названием подключаемого ключа реестра.

Для получения соответствующей информации в справке DAO см.

## <a name="cdaoworkspacegetisolateodbctrans"></a><a name="getisolateodbctrans"></a>CDaoWorkspace::GetIsolateODBCTrans

Позвоните в эту функцию участника, чтобы получить текущую стоимость свойства DAO IsolateODBCTrans для рабочего пространства.

```
BOOL GetIsolateODBCTrans();
```

### <a name="return-value"></a>Возвращаемое значение

Незерно, если транзакции ODBC изолированы; в противном случае 0.

### <a name="remarks"></a>Remarks

В некоторых ситуациях в одной и той же базе данных ODBC может потребоваться несколько одновременных транзакций. Для этого необходимо открыть отдельное рабочее пространство для каждой транзакции. Имейте в виду, что, хотя каждое рабочее пространство может иметь свое собственное подключение ODBC к базе данных, это замедляет производительность системы. Поскольку изоляция транзакций обычно не требуется, соединения ODBC из нескольких объектов рабочего пространства, открытых одним и тем же пользователем, разделяются по умолчанию.

Некоторые серверы ODBC, такие как Microsoft S'L Server, не позволяют совершать одновременные транзакции на одном подключении. Если вам нужно иметь более одной транзакции в то время, в ожидании против такой базы данных, установите свойство IsolateODBCTrans к TRUE на каждом рабочем пространстве, как только вы открываете его. Это заставляет отдельное соединение ODBC для каждого рабочего пространства.

Подробнее об этом читайте в теме "IsolateODBCTrans Property" в справке DAO.

## <a name="cdaoworkspacegetlogintimeout"></a><a name="getlogintimeout"></a>CDaoWorkspace:GetLoginTimeout

Позвоните в эту функцию участника, чтобы получить текущее значение свойства DAO LoginTimeout для рабочего пространства.

```
static short PASCAL GetLoginTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Количество секунд до ошибки возникает при попытке входа в базу данных ODBC.

### <a name="remarks"></a>Remarks

Это значение представляет количество секунд до возникновения ошибки при попытке входа в базу данных ODBC. Настройка LoginTimeout по умолчанию составляет 20 секунд. Когда LoginTimeout установлен на 0, тайм-аут не происходит, и связь с источником данных может перестать отвечать.

При попытке входа в базу данных ODBC, например, в Microsoft S'L Server, подключение может выйти из строя из-за сетевых ошибок или из-за того, что сервер не работает. Вместо того, чтобы ждать подключения по умолчанию за 20 секунд, можно указать, как долго будет ждать движок базы данных, прежде чем он добудет ошибку. Вход на сервер происходит неявно как часть ряда различных событий, таких как запуск запроса на внешней базе данных сервера.

Для получения соответствующей информации, см.

## <a name="cdaoworkspacegetname"></a><a name="getname"></a>CDaoWorkspace::GetName

Вызовите эту функцию участника, чтобы получить определенное пользователем `CDaoWorkspace` имя объекта рабочего пространства DAO, лежащего в основе объекта.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

[CString,](../../atl-mfc-shared/reference/cstringt-class.md) содержащий определенное пользователем имя объекта рабочего пространства DAO.

### <a name="remarks"></a>Remarks

Имя полезно для доступа к объекту рабочего пространства DAO в коллекции рабочих пространств рабочей базы данных по имени.

Для получения соответствующей информации, см.

## <a name="cdaoworkspacegetusername"></a><a name="getusername"></a>CDaoWorkspace::GetUserName

Позвоните этой функции участника, чтобы получить имя владельца рабочего пространства.

```
CString GetUserName();
```

### <a name="return-value"></a>Возвращаемое значение

[CString,](../../atl-mfc-shared/reference/cstringt-class.md) представляющий владельца объекта рабочего пространства.

### <a name="remarks"></a>Remarks

Чтобы получить или установить разрешения для владельца рабочего пространства, позвоните dAO напрямую, чтобы проверить настройки свойства Разрешений; это определяет, какие разрешения есть у пользователя. Для работы с разрешениями вам нужен SYSTEM. Файл MDA.

Для получения информации о вызове DAO напрямую, [см.](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md) Для получения соответствующей информации смотрите тему "UserName Property" в справке DAO.

## <a name="cdaoworkspacegetversion"></a><a name="getversion"></a>CDaoWorkspace:GetVersion

Позвоните этой функции участника, чтобы определить версию движка базы данных Microsoft Jet в использовании.

```
static CString PASCAL GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

[CString,](../../atl-mfc-shared/reference/cstringt-class.md) указывающий на версию движка базы данных, связанную с объектом.

### <a name="remarks"></a>Remarks

Возвратное значение представляет номер версии в виде "major.minor"; например, "3.0". Номер версии продукта (например, 3.0) состоит из номера версии (3), периода и номера релиза (0).

Подробнее об этом читайте в теме "Version Property" в справке DAO.

## <a name="cdaoworkspacegetworkspacecount"></a><a name="getworkspacecount"></a>CDaoWorkspace::GetWorkspaceCount

Вызовите эту функцию участника, чтобы получить количество объектов рабочего пространства DAO в коллекции рабочих пространств движка базы данных.

```
short GetWorkspaceCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество открытых рабочих пространств в коллекции Workspaces.

### <a name="remarks"></a>Remarks

Этот подсчет не включает в себя открытые рабочие пространства, не прилагаемые к коллекции. `GetWorkspaceCount`полезно, если вам нужно проработать все определенные рабочие области в коллекции Рабочих пространств. Чтобы получить информацию о данном рабочем пространстве в коллекции, [см. GetWorkspaceInfo](#getworkspaceinfo). Типичное использование `GetWorkspaceCount` заключается в том, чтобы вызвать число открытых рабочих `GetWorkspaceInfo`пространств, а затем использовать это число в качестве индекса цикла для повторных вызовов.

## <a name="cdaoworkspacegetworkspaceinfo"></a><a name="getworkspaceinfo"></a>CDaoWorkspace::GetWorkspaceInfo

Вызовите эту функцию участника для получения различного рода информации об рабочем пространстве, открытом в сеансе.

```
void GetWorkspaceInfo(
    int nIndex,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetWorkspaceInfo(
    LPCTSTR lpszName,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*Nindex*<br/>
Нулевой индекс объекта базы данных в коллекции Рабочих пространств для поиска по индексу.

*wkspcinfo*<br/>
Ссылка на объект [CDaoWorkspaceInfo,](../../mfc/reference/cdaoworkspaceinfo-structure.md) который возвращает запрашиваемую информацию.

*dwInfoOptions*<br/>
Параметры, которые определяют, какую информацию о рабочей области для извлечения. Доступные варианты перечислены здесь вместе с тем, что они вызывают функцию возвращения:

- AFX_DAO_PRIMARY_INFO (по умолчанию) имя

- AFX_DAO_SECONDARY_INFO Первичная информация плюс: Имя пользователя

- AFX_DAO_ALL_INFO Первичная и второстепенная информация плюс: Изолировать ODBCTrans

*lpszName*<br/>
Название объекта рабочего пространства, для поиска по имени. Название представляет собой строку с до 14 символов, которые однозначно имен нового объекта рабочего пространства.

### <a name="remarks"></a>Remarks

Для описания информации, возвращенной в *wkspcinfo*, см. [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) структуры. Эта структура имеет членов, которые соответствуют пунктам информации, перечисленных выше в описании *dwInfoOptions*. Когда вы запрашиваете информацию на одном уровне, вы получаете информацию и для предыдущих уровней.

## <a name="cdaoworkspaceidle"></a><a name="idle"></a>CDaoWorkspace::Idle

Вызов `Idle` предоставить движку базы данных возможность выполнять фоновые задачи, которые могут быть неактуальными из-за интенсивной обработки данных.

```
static void PASCAL Idle(int nAction = dbFreeLocks);
```

### <a name="parameters"></a>Параметры

*nДействия*<br/>
Действие, предпринимаемое во время обработки простоя. В настоящее время `dbFreeLocks`единственным действительным действием является .

### <a name="remarks"></a>Remarks

Это часто верно в многопользовательских, многозадачных средах, в которых не хватает времени обработки фона, чтобы держать все записи в токе записей.

> [!NOTE]
> Вызов `Idle` не требуется с базами данных, созданными с версией 3.0 движка базы данных Microsoft Jet. Используйте `Idle` только для баз данных, созданных с более ранними версиями.

Обычно блокировки чтения удаляются, а данные в локальных объектах записей типа динасета обновляются только тогда, когда никаких других действий (включая движения мыши) не происходит. При периодических `Idle`вызовах вы предоставляете движку базы данных время, чтобы наверстать упущенное в задачах обработки фона, выпустив ненужные блокировки чтения. Указание константы в `dbFreeLocks` качестве аргумента задерживает обработку до тех пор, пока не будут освобождены все блокировки чтения.

Эта функция члена не требуется в условиях для одного пользователя, если только не работает несколько экземпляров приложения. Функция `Idle` члена может увеличить производительность в многопользовательской среде, поскольку она заставляет движок базы данных промыть данные на диск, выпустив блокировки на памяти. Вы также можете выпустить прочитанных блокировок, сделав операции частью транзакции.

Для получения соответствующей информации, см.

## <a name="cdaoworkspaceisopen"></a><a name="isopen"></a>CDaoWorkspace::IsOpen

Позвоните в эту функцию участника, чтобы определить, является ли `CDaoWorkspace` объект открытым, т.е. был ли объект MFC инициализирован вызовом [Open](#open) или вызовом для [создания.](#create)

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Nonzero, если объект рабочей области открыт; в противном случае 0.

### <a name="remarks"></a>Remarks

Вы можете вызвать любую из функций элемента рабочего пространства, находящийся в открытом состоянии.

## <a name="cdaoworkspacem_pdaoworkspace"></a><a name="m_pdaoworkspace"></a>CDaoWorkspace::m_pDAOWorkspace

Указатель на базовый объект рабочего пространства DAO.

### <a name="remarks"></a>Remarks

Используйте этот член данных, если вам нужен прямой доступ к базовому объекту DAO. Вы можете вызвать интерфейсы объекта DAO через этот указатель.

Для получения информации о доступе к объектам DAO напрямую [см.](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md)

## <a name="cdaoworkspaceopen"></a><a name="open"></a>CDaoWorkspace::Открыто

Явно открывает объект рабочей области, связанный с рабочим пространством DAO по умолчанию.

```
virtual void Open(LPCTSTR lpszName = NULL);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя объекта рабочего пространства DAO, чтобы открыть - строка с до 14 символов, которые однозначно имена рабочего пространства. Примите значение NULL по умолчанию, чтобы явно открыть рабочее пространство по умолчанию. Для требований к именованию см. параметр *lpszName* для [Create](#create). Для получения соответствующей информации, см.

### <a name="remarks"></a>Remarks

После построения объекта позвоните `CDaoWorkspace` в эту функцию-члена, чтобы сделать одну из следующих:

- Явно откройте рабочее пространство по умолчанию. Pass NULL для *lpszName*.

- Откройте `CDaoWorkspace` существующий объект, являйщийся членом коллекции Workspaces, по имени. Передайте действительное имя существующему объекту рабочего пространства.

`Open`помещает объект рабочего пространства в открытое состояние, а также инициализирует движок базы данных, если он еще не был инициализирован для приложения.

Несмотря `CDaoWorkspace` на то, что многие функции членов могут быть вызваны только после открытия рабочего пространства, следующие функции члена, которые работают на движке базы данных, доступны после строительства объекта КЗ, но до `Open`вызова:

||||
|-|-|-|
|[Создать](#create)|[GetVersion](#getversion)|[SetDefaultUser](#setdefaultuser)|
|[GetIniPath](#getinipath)|[Idle](#idle)|[SetIniPath](#setinipath)|
|[GetLoginTimeout](#getlogintimeout)|[SetDefaultPassword](#setdefaultpassword)|[SetLoginTimeout](#setlogintimeout)|

## <a name="cdaoworkspacerepairdatabase"></a><a name="repairdatabase"></a>CDaoWorkspace::RepairDatabase

Позвоните в эту функцию участника, если вам нужно попытаться восстановить поврежденную базу данных, которая получает доступ к движку базы данных Microsoft Jet.

```
static void PASCAL RepairDatabase(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Путь и имя файла для существующего файла базы данных Microsoft Jet. Если вы не опускаете путь, будет искаться только текущий каталог. Если ваша система поддерживает единую конвенцию именования (UNC), вы\\\\\\также\\можете указать сетевой путь, например: « »MYSERVER »MYSHARE\\»MYDIR\\»MYDB. MDB". (Двойные задние слэши необходимы\\в строке пути, потому что « » является персонажем побега с СЗ.)

### <a name="remarks"></a>Remarks

Перед ее ремонтом необходимо закрыть базу данных, указанную *lpszName.* В многопользовательской среде другие пользователи не могут открывать *lpszName* во время ремонта. Если *lpszName* не закрыт или не доступен для исключительного использования, возникает ошибка.

Функция этого элемента пытается восстановить базу данных, которая была помечена как возможно поврежденная неполной операцией записи. Это может произойти, если приложение, используюееееееееело движок базы данных Microsoft Jet, неожиданно закрыто из-за отключения электроэнергии или проблемы с компьютерным оборудованием. Если вы выполните операцию и позвоните в функцию [участника Close](../../mfc/reference/cdaodatabase-class.md#close) или вы анонсируете приложение обычным способом, база данных не будет помечена как возможно поврежденная.

> [!NOTE]
> После ремонта базы данных, это также хорошая идея, чтобы уплотнить его с помощью функции члена [CompactDatabase](#compactdatabase) для дефрагментации файла и восстановления дискового пространства.

Для получения дополнительной информации о ремонте баз данных, см.

## <a name="cdaoworkspacerollback"></a><a name="rollback"></a>CDaoWorkspace::Откат

Вызовите эту функцию участника, чтобы закончить текущую транзакцию и восстановить все базы данных в рабочем пространстве до их состояния до начала транзакции.

```
void Rollback();
```

### <a name="remarks"></a>Remarks

> [!CAUTION]
> В рамках одного объекта рабочей области транзакции всегда являются глобальными для рабочего пространства и не ограничиваются только одной базой данных или рекордными данными. Если вы выполняете операции на нескольких базах данных `Rollback` или записи в транзакции рабочего пространства, восстанавливаетвсе операции на всех этих базах данных и записях.

Если вы закрываете объект рабочего пространства без сохранения или отката любых ожидающих транзакций, транзакции автоматически откатываются. Если вы звоните `Rollback` [CommitTrans](#committrans) или без первого вызова [BeginTrans,](#begintrans)происходит ошибка.

> [!NOTE]
> При начале транзакции движок базы данных записывает свои операции в файле, храняэтом в каталоге, указанном переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпает доступное хранилище на диске `CDaoException` TEMP, движок базы данных заставит MFC бросить (ошибка DAO 2004). На этом этапе, `CommitTrans`если вы звоните, неопределенное количество операций совершается, но остальные незавершенные операции потеряны, и операция должна быть перезапущена. Вызов `Rollback` освобождает журнал транзакций и откатывает все операции в транзакции.

## <a name="cdaoworkspacesetdefaultpassword"></a><a name="setdefaultpassword"></a>CDaoWorkspace::SetDefaultPassword

Вызовите эту функцию участника, чтобы установить пароль по умолчанию, который использует движок базы данных при создании объекта рабочего пространства без определенного пароля.

```
static void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszPassword*<br/>
Пароль по умолчанию. Пароль может быть до 14 символов в длину и может содержать любой символ, кроме ASCII 0 (null). В паролях учитывается регистр символов.

### <a name="remarks"></a>Remarks

Установленный пароль по умолчанию применяется к новым рабочим областям, которые вы создаете после вызова. При создании последующих рабочих областей не нужно указывать пароль в вызове [Create.](#create)

Чтобы использовать эту функцию участника:

1. Постройте объект, `CDaoWorkspace` `Create`но не вызывайте.

1. Звоните `SetDefaultPassword` и, если хотите, [SetDefaultUser](#setdefaultuser).

1. Позвоните `Create` для этого объекта рабочего пространства или последующих, не указывая пароль.

По умолчанию свойство DefaultUser настроено на "админ", а свойство DefaultPassword - на пустую строку ("").

Подробнее о безопасности читайте в теме "Разрешения собственности" в DAO Help. Для получения соответствующей информации в справке DAO см.

## <a name="cdaoworkspacesetdefaultuser"></a><a name="setdefaultuser"></a>CDaoWorkspace::SetDefaultUser

Вызовите эту функцию участника, чтобы установить имя пользователя по умолчанию, которое использует движок базы данных при создании объекта рабочего пространства без конкретного имени пользователя.

```
static void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);
```

### <a name="parameters"></a>Параметры

*lpszDefaultUser*<br/>
Имя пользователя по умолчанию. Имя пользователя может быть от 1 до 20 символов длиной и включает в себя алфавитные символы, акцентированные символы, цифры, пробелы и символы, за исключением: " (кавычки), / (передняя слэш), q (backslash), \[ \] (кронштейны), : (колон), &#124; (труба), \< (меньше, чем знак), > (больше, чем знак), (запятая), , , ( запятая), (вопросительный знак), \* (звездочка), ведущие пространства, и контроль ные символы (ASCII 00 до ASCII 31). Для получения соответствующей информации смотрите тему "UserName Property" в справке DAO.

### <a name="remarks"></a>Remarks

Имя пользователя по умолчанию, которое вы устанавливаете, относится к новым рабочим областям, которые вы создаете после вызова. При создании последующих рабочих пространств не нужно указывать имя пользователя в вызове [Create.](#create)

Чтобы использовать эту функцию участника:

1. Постройте объект, `CDaoWorkspace` `Create`но не вызывайте.

1. Звоните `SetDefaultUser` и, если хотите, [SetDefaultPassword](#setdefaultpassword).

1. Вызов `Create` для этого объекта рабочего пространства или последующих, не указывая имя пользователя.

По умолчанию свойство DefaultUser настроено на "админ", а свойство DefaultPassword - на пустую строку ("").

Для получения соответствующей информации в справке DAO см.

## <a name="cdaoworkspacesetinipath"></a><a name="setinipath"></a>CDaoWorkspace::SetIniPath

Позвоните в эту функцию участника, чтобы указать расположение настроек реестра Windows для движка базы данных Microsoft Jet.

```
static void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);
```

### <a name="parameters"></a>Параметры

*lpszRegistrySubkey*<br/>
Строка, содержащая имя подключаемого ключа реестра Windows для расположения настроек или параметров движка базы данных Microsoft Jet, необходимых для установки баз данных ISAM.

### <a name="remarks"></a>Remarks

Звоните `SetIniPath` только в том случае, если вам необходимо указать специальные настройки. Для получения дополнительной информации, смотрите тему "IniPath собственности" в DAO Помощь.

> [!NOTE]
> Звоните `SetIniPath` во время установки приложения, а не при запуске приложения. `SetIniPath`необходимо вызвать до открытия рабочих пространств, баз данных или записей; в противном случае, MFC бросает исключение.

Этот механизм можно использовать для настройки движка базы данных с настройками реестра, предоставленными пользователем. Область действия этого атрибута ограничена приложением и не может быть изменена без перезапуска приложения.

## <a name="cdaoworkspacesetisolateodbctrans"></a><a name="setisolateodbctrans"></a>CDaoWorkspace::SetIsolateODBCTrans

Позвоните в эту функцию участника, чтобы установить значение свойства DAO IsolateODBCTrans для рабочего пространства.

```
void SetIsolateODBCTrans(BOOL bIsolateODBCTrans);
```

### <a name="parameters"></a>Параметры

*bIsolateODBCTrans*<br/>
Передайте правду, если вы хотите начать изолировать транзакции ODBC. Пройдите FALSE, если вы хотите прекратить изоляцию транзакций ODBC.

### <a name="remarks"></a>Remarks

В некоторых ситуациях в одной и той же базе данных ODBC может потребоваться несколько одновременных транзакций. Для этого необходимо открыть отдельное рабочее пространство для каждой транзакции. Хотя каждое рабочее пространство может иметь свое собственное подключение ODBC к базе данных, это замедляет производительность системы. Поскольку изоляция транзакций обычно не требуется, соединения ODBC из нескольких объектов рабочего пространства, открытых одним и тем же пользователем, разделяются по умолчанию.

Некоторые серверы ODBC, такие как Microsoft S'L Server, не позволяют совершать одновременные транзакции на одном подключении. Если вам нужно иметь более одной транзакции в то время, в ожидании против такой базы данных, установите свойство IsolateODBCTrans к TRUE на каждом рабочем пространстве, как только вы открываете его. Это заставляет отдельное соединение ODBC для каждого рабочего пространства.

## <a name="cdaoworkspacesetlogintimeout"></a><a name="setlogintimeout"></a>CDaoWorkspace::SetLoginTimeout

Вызовите эту функцию участника, чтобы установить значение свойства DAO LoginTimeout для рабочего пространства.

```
static void PASCAL SetLoginTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*nSeconds*<br/>
Количество секунд до ошибки возникает при попытке входа в базу данных ODBC.

### <a name="remarks"></a>Remarks

Это значение представляет количество секунд до возникновения ошибки при попытке входа в базу данных ODBC. Настройка LoginTimeout по умолчанию составляет 20 секунд. Когда LoginTimeout установлен на 0, тайм-аут не происходит, и связь с источником данных может перестать отвечать.

При попытке входа в базу данных ODBC, например, в Microsoft S'L Server, подключение может выйти из строя из-за сетевых ошибок или из-за того, что сервер не работает. Вместо того, чтобы ждать подключения по умолчанию за 20 секунд, можно указать, как долго будет ждать движок базы данных, прежде чем он добудет ошибку. Вход на сервер происходит неявно как часть ряда различных событий, таких как запуск запроса на внешней базе данных сервера. Значение тайм-аута определяется текущей настройкой свойства LoginTimeout.

Для получения соответствующей информации, см.

## <a name="see-also"></a>См. также раздел

[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[CDaoDatabase Класс](../../mfc/reference/cdaodatabase-class.md)<br/>
[CDaoRecordset класс](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CДао-КуириДеф](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
