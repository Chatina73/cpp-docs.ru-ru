---
title: Класс CDaoWorkspace
ms.date: 11/04/2016
f1_keywords:
- CDaoWorkspace
- AFXDAO/CDaoWorkspace
- AFXDAO/CDaoWorkspace::CDaoWorkspace
- AFXDAO/CDaoWorkspace::Append
- AFXDAO/CDaoWorkspace::BeginTrans
- AFXDAO/CDaoWorkspace::Close
- AFXDAO/CDaoWorkspace::CommitTrans
- AFXDAO/CDaoWorkspace::CompactDatabase
- AFXDAO/CDaoWorkspace::Create
- AFXDAO/CDaoWorkspace::GetDatabaseCount
- AFXDAO/CDaoWorkspace::GetDatabaseInfo
- AFXDAO/CDaoWorkspace::GetIniPath
- AFXDAO/CDaoWorkspace::GetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::GetLoginTimeout
- AFXDAO/CDaoWorkspace::GetName
- AFXDAO/CDaoWorkspace::GetUserName
- AFXDAO/CDaoWorkspace::GetVersion
- AFXDAO/CDaoWorkspace::GetWorkspaceCount
- AFXDAO/CDaoWorkspace::GetWorkspaceInfo
- AFXDAO/CDaoWorkspace::Idle
- AFXDAO/CDaoWorkspace::IsOpen
- AFXDAO/CDaoWorkspace::Open
- AFXDAO/CDaoWorkspace::RepairDatabase
- AFXDAO/CDaoWorkspace::Rollback
- AFXDAO/CDaoWorkspace::SetDefaultPassword
- AFXDAO/CDaoWorkspace::SetDefaultUser
- AFXDAO/CDaoWorkspace::SetIniPath
- AFXDAO/CDaoWorkspace::SetIsolateODBCTrans
- AFXDAO/CDaoWorkspace::SetLoginTimeout
- AFXDAO/CDaoWorkspace::m_pDAOWorkspace
helpviewer_keywords:
- CDaoWorkspace [MFC], CDaoWorkspace
- CDaoWorkspace [MFC], Append
- CDaoWorkspace [MFC], BeginTrans
- CDaoWorkspace [MFC], Close
- CDaoWorkspace [MFC], CommitTrans
- CDaoWorkspace [MFC], CompactDatabase
- CDaoWorkspace [MFC], Create
- CDaoWorkspace [MFC], GetDatabaseCount
- CDaoWorkspace [MFC], GetDatabaseInfo
- CDaoWorkspace [MFC], GetIniPath
- CDaoWorkspace [MFC], GetIsolateODBCTrans
- CDaoWorkspace [MFC], GetLoginTimeout
- CDaoWorkspace [MFC], GetName
- CDaoWorkspace [MFC], GetUserName
- CDaoWorkspace [MFC], GetVersion
- CDaoWorkspace [MFC], GetWorkspaceCount
- CDaoWorkspace [MFC], GetWorkspaceInfo
- CDaoWorkspace [MFC], Idle
- CDaoWorkspace [MFC], IsOpen
- CDaoWorkspace [MFC], Open
- CDaoWorkspace [MFC], RepairDatabase
- CDaoWorkspace [MFC], Rollback
- CDaoWorkspace [MFC], SetDefaultPassword
- CDaoWorkspace [MFC], SetDefaultUser
- CDaoWorkspace [MFC], SetIniPath
- CDaoWorkspace [MFC], SetIsolateODBCTrans
- CDaoWorkspace [MFC], SetLoginTimeout
- CDaoWorkspace [MFC], m_pDAOWorkspace
ms.assetid: 64f60de6-4df1-4d4a-a65b-c489b5257d52
ms.openlocfilehash: 6aa404c5eb543db198043dba68d55a4b925739c8
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62253729"
---
# <a name="cdaoworkspace-class"></a>Класс CDaoWorkspace

Управление именованным, защищенным паролем сеансом базы данных от входа до выхода одним пользователем.

## <a name="syntax"></a>Синтаксис

```
class CDaoWorkspace : public CObject
```

## <a name="members"></a>Участники

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[CDaoWorkspace::CDaoWorkspace](#cdaoworkspace)|Создает объект рабочей области. После этого вызовите `Create` или `Open`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[CDaoWorkspace::Append](#append)|Добавляет созданную рабочую область коллекции рабочих областей ядро базы данных.|
|[CDaoWorkspace::BeginTrans](#begintrans)|Начинает новую транзакцию, которая применяется ко всем базам данных открытым в рабочей области.|
|[CDaoWorkspace::Close](#close)|Закрытие рабочей области и все объекты, содержащиеся в ней. Незавершенные транзакции откатываются.|
|[CDaoWorkspace::CommitTrans](#committrans)|Выполняет текущую транзакцию и сохраняет изменения.|
|[CDaoWorkspace::CompactDatabase](#compactdatabase)|Сжимает (или дублирует) базы данных.|
|[CDaoWorkspace::Create](#create)|Создает новый объект workspace DAO.|
|[CDaoWorkspace::GetDatabaseCount](#getdatabasecount)|Возвращает количество объектов базы данных DAO в коллекции баз данных рабочей области.|
|[CDaoWorkspace::GetDatabaseInfo](#getdatabaseinfo)|Возвращает сведения об указанной базы данных DAO, определенных в коллекции баз данных рабочей области.|
|[CDaoWorkspace::GetIniPath](#getinipath)|Возвращает расположение базы данных Microsoft Jet параметры инициализации механизма в реестре Windows.|
|[CDaoWorkspace::GetIsolateODBCTrans](#getisolateodbctrans)|Возвращает значение, указывающее, изолированы ли несколько транзакций, включающих один и тот же источник данных ODBC с помощью принудительного несколько подключений к источнику данных.|
|[CDaoWorkspace::GetLoginTimeout](#getlogintimeout)|Возвращает количество секунд, прежде чем произошла ошибка при попытке пользователя войти в базу данных ODBC.|
|[CDaoWorkspace::GetName](#getname)|Возвращает определенное пользователем имя для объекта workspace.|
|[CDaoWorkspace::GetUserName](#getusername)|Возвращает имя пользователя указывается при создании рабочей области. Это имя владельца рабочей области.|
|[CDaoWorkspace::GetVersion](#getversion)|Возвращает строку, содержащую версию ядра СУБД, связанном с рабочей областью.|
|[CDaoWorkspace::GetWorkspaceCount](#getworkspacecount)|Возвращает количество объектов DAO рабочей области в коллекции рабочих областей ядро базы данных.|
|[CDaoWorkspace::GetWorkspaceInfo](#getworkspaceinfo)|Возвращает сведения о заданной рабочей области DAO, определенных в коллекции рабочих областей ядро базы данных.|
|[CDaoWorkspace::Idle](#idle)|Позволяет компоненту database engine для выполнения фоновых задач.|
|[CDaoWorkspace::IsOpen](#isopen)|Откройте возвращает ненулевое значение, если рабочая область.|
|[CDaoWorkspace::Open](#open)|Явно открывает объект рабочей области, связанные с рабочей областью по умолчанию в DAO.|
|[CDaoWorkspace::RepairDatabase](#repairdatabase)|Пытается восстановить поврежденную базу данных.|
|[CDaoWorkspace::Rollback](#rollback)|Завершает текущую транзакцию и не сохранить изменения.|
|[CDaoWorkspace::SetDefaultPassword](#setdefaultpassword)|Задает пароль, который компонент database engine использует при создании рабочей области объекта без пароля.|
|[CDaoWorkspace::SetDefaultUser](#setdefaultuser)|Задает имя пользователя, которое компонент database engine использует при создании рабочей области объекта без определенного имени пользователя.|
|[CDaoWorkspace::SetIniPath](#setinipath)|Задает параметры инициализации механизма расположение базы данных Jet (Майкрософт) в реестре Windows.|
|[CDaoWorkspace::SetIsolateODBCTrans](#setisolateodbctrans)|Указывает, являются изолированными ли несколько транзакций, включающих один и тот же источник данных ODBC можно применить несколько подключений к источнику данных.|
|[CDaoWorkspace::SetLoginTimeout](#setlogintimeout)|Задает количество секунд, прежде чем произошла ошибка при попытке пользователя войти в источник данных ODBC.|

### <a name="public-data-members"></a>Открытые члены данных

|name|Описание|
|----------|-----------------|
|[CDaoWorkspace::m_pDAOWorkspace](#m_pdaoworkspace)|Точки к базовому объекту DAO рабочей области.|

## <a name="remarks"></a>Примечания

В большинстве случаев вам не потребуется несколько рабочих областей, а не нужно будет создавать объекты явные рабочей области; При открытии объектов базы данных и набор записей, они используют DAO в рабочей области по умолчанию. Однако при необходимости можно запустить несколько сеансов одновременно путем создания объектов дополнительную рабочую область. Каждый объект рабочей области может содержать несколько открытых объектов базы данных в коллекции баз данных. В MFC рабочая область — главным образом диспетчер транзакций, указав набор открытых баз данных в одном «транзакций места».

> [!NOTE]
>  Классы баз данных DAO, отличаются от классов базы данных MFC на основе на Open Database Connectivity (ODBC). Все имена классов DAO базы данных имеют префикс «CDao». В общем случае классы MFC, в зависимости от DAO обладают большими возможностями, чем классы MFC на основе ODBC. Классы на основе DAO доступ к данным через ядро СУБД Microsoft Jet, включая драйверы ODBC. Они также поддерживают операции языка описания данных DDL, таких как создание баз данных и добавление таблиц и полей через классы, не нужно звонить DAO напрямую.

## <a name="capabilities"></a>Возможности

Класс `CDaoWorkspace` предоставляет следующие:

- Явный доступ в рабочую область по умолчанию, созданные инициализация ядро базы данных. Обычно используется рабочая область по умолчанию в DAO неявно при создании объектов базы данных и набор записей.

- В рабочей области откройте место транзакций, в котором транзакции применяются ко всем базам данных. Вы можете создать дополнительных рабочих областей для управления пространствами отдельной транзакции.

- Интерфейс для многих свойств базовой СУБД Jet (Майкрософт) (см. в разделе статических функций-членов). Открытие или создание рабочей области или статическую функцию-член до вызова откройте или создайте, инициализирует ядро базы данных.

- Доступ к коллекции рабочих областей ядро базы данных, которая хранит все активные рабочие области, добавленные к нему. Можно также создать и работа с рабочими областями без добавления их к коллекции.

## <a name="security"></a>Безопасность

MFC не реализует коллекций пользователей и групп в DAO, которые используются для управления безопасностью. Если требуется, чтобы эти аспекты DAO, необходимо запрограммировать их самостоятельно с помощью прямого вызова интерфейсов DAO. Сведения см. в разделе [технические 54 Примечание](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

## <a name="usage"></a>Использование

Можно использовать класс `CDaoWorkspace` для:

- Явным образом откройте рабочую область по умолчанию.

   Обычно подразумевается использование рабочей области по умолчанию — при открытии новых [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) или [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объектов. Но может потребоваться доступ к ней явным образом — например, для доступа к свойствам ядра базы данных или коллекции рабочих областей. См. в разделе «Неявное использование рабочей области по умолчанию» ниже.

- Создайте новые рабочие области. Вызовите [Append](#append) Если вы хотите добавить их в коллекцию рабочих областей.

- Откройте существующую рабочую область в коллекции рабочих областей.

Создание новой рабочей области, еще не существует в рабочих областях, коллекции описан в разделе [создать](#create) функция-член. Каким-либо образом между сеансами ядра базы данных рабочей области объектов не сохраняются. Если приложение скомпонованной с MFC статически, завершения работы приложения Отменяет инициализацию ядро базы данных. Если приложение динамически связан с MFC, компонент database engine не инициализирован при выгрузке библиотеки DLL MFC.

Явно открытии рабочей области по умолчанию, или существующую рабочую область в коллекции рабочих областей, описано в разделе [откройте](#open) функция-член.

Завершить сеанс рабочей области, закрыв рабочей области с [закрыть](#close) функция-член. `Close` Закрывает любой базы данных, которые еще не закрыто ранее, выполняется откат всех незафиксированных транзакций.

## <a name="transactions"></a>Транзакции

DAO управляет транзакциями на уровне рабочей области; Таким образом транзакции в рабочую область с несколькими базами данных, откройте применяются для всех баз данных. Например, если две базы данных имеют незафиксированных обновлениях, при вызове метода [CommitTrans](#committrans), все обновления фиксируются. Если вы хотите ограничить транзакции в одной базе данных, для него необходим объект отдельную рабочую область.

## <a name="implicit-use-of-the-default-workspace"></a>Неявное использование рабочей области по умолчанию

MFC использует рабочую область по умолчанию в DAO неявно при следующих условиях:

- Если вы создаете новый `CDaoDatabase` объекта, но этого не сделать посредством существующей `CDaoWorkspace` объекта MFC создает временную рабочую область объект, соответствующий DAO в рабочей области по умолчанию. Если сделать это для нескольких баз данных, все объекты базы данных связаны с рабочей областью по умолчанию. Можно открыть рабочую область базы данных с помощью `CDaoDatabase` элемент данных.

- Аналогично при создании `CDaoRecordset` объекта без указания указатель на `CDaoDatabase` объекта MFC создает временный объект базы данных а, следовательно, объект временную рабочую область. Можно обращаться из набора записей базы данных и косвенно его рабочей области `CDaoRecordset` элемент данных.

## <a name="other-operations"></a>Другие операции

Другие операции с базой данных также предоставляются, такие как Восстановление поврежденной базы данных или сжатие базы данных.

Дополнительные сведения о вызове непосредственно в DAO и о безопасности DAO, см. в разделе [технические 54 Примечание](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

`CDaoWorkspace`

## <a name="requirements"></a>Требования

**Заголовок:** afxdao.h

##  <a name="append"></a>  CDaoWorkspace::Append

Вызовите эту функцию-член, после вызова метода [создать](#create).

```
virtual void Append();
```

### <a name="remarks"></a>Примечания

`Append` Добавляет объект только что созданной рабочей области в коллекцию рабочих областей ядро базы данных. Рабочие области не сохраняются между сеансами ядра базы данных. они хранятся только в памяти, а не на диске. У вас нет для добавления рабочей области; Если этого не сделать, вы по-прежнему можно использовать.

Рабочую область присоединенных остается в коллекции рабочих областей, в активном состоянии, открытое состояние до вызова метода его [закрыть](#close) функция-член.

Дополнительные сведения см. в разделе «Добавить метод» в справке DAO.

##  <a name="begintrans"></a>  CDaoWorkspace::BeginTrans

Вызовите эту функцию-член для инициирования транзакции.

```
void BeginTrans();
```

### <a name="remarks"></a>Примечания

После вызова метода `BeginTrans`, обновления, внесенные в структуру данных или база данных вступают в силу при фиксации транзакции. Так как рабочая область определяет одной транзакции, транзакция применяется ко всем открытым базам данных в рабочей области. Существует два способа для завершения транзакции:

- Вызовите [CommitTrans](#committrans) функция-член для фиксации транзакции и сохранить изменения в источнике данных.

- Или позвоните [отката](#rollback) функция-член отменить транзакцию.

Закрытие рабочей области или объект базы данных, пока транзакция находится в состоянии ожидания выполняет откат всех незавершенных транзакций.

Если вам нужно изолировать транзакций на один источник данных ODBC по сравнению с другим источником данных ODBC, см. в разделе [SetIsolateODBCTrans](#setisolateodbctrans) функция-член.

##  <a name="cdaoworkspace"></a>  CDaoWorkspace::CDaoWorkspace

Создает объект `CDaoWorkspace`.

```
CDaoWorkspace();
```

### <a name="remarks"></a>Примечания

После создания объекта C++, можно двумя способами:

- Вызов объекта [откройте](#open) функция-член открыть рабочую область по умолчанию или откройте существующий объект в коллекции рабочих областей.

- Или позвоните объекта [создать](#create) функцию-член для создания нового объекта DAO рабочей области. Это явно начинает новый сеанс рабочей области, который можно ссылаться на через `CDaoWorkspace` объекта. После вызова метода `Create`, можно вызвать [Append](#append) Если вы хотите добавить рабочую область коллекции рабочих областей ядро базы данных.

См. в разделе о классе для [CDaoWorkspace](../../mfc/reference/cdaoworkspace-class.md) сведения о Если вам нужно явно создавать `CDaoWorkspace` объекта. Как правило, используется рабочими областями, созданными неявно при открытии [CDaoDatabase](../../mfc/reference/cdaodatabase-class.md) объект без указания рабочей области, или при открытии [CDaoRecordset](../../mfc/reference/cdaorecordset-class.md) объект без указания объекта базы данных. Объектов MFC DAO, созданные таким образом использовать рабочую область по умолчанию в DAO, которой создается один раз и использовать повторно.

Чтобы освободить рабочую область и содержащихся в нем объектов, вызов объекта workspace [закрыть](#close) функция-член.

##  <a name="close"></a>  CDaoWorkspace::Close

Эта функция члена закрытие рабочей области.

```
virtual void Close();
```

### <a name="remarks"></a>Примечания

Закрыть объект открыть рабочую область освобождает базового объекта DAO и, если рабочая область является членом коллекции рабочих областей, удаляет его из коллекции. Вызов `Close` является хорошим стилем программирования.

> [!CAUTION]
>  Закрытие рабочей области объекта закрывает все открытые базы данных в рабочей области. Это приводит к все открытые наборы записей в базах данных также закрывается, и все незафиксированные изменения и обновления выполняется откат. Дополнительные сведения см. в разделе [CDaoDatabase::Close](../../mfc/reference/cdaodatabase-class.md#close), [CDaoRecordset::Close](../../mfc/reference/cdaorecordset-class.md#close), [CDaoTableDef::Close](../../mfc/reference/cdaotabledef-class.md#close), и [CDaoQueryDef::Close](../../mfc/reference/cdaoquerydef-class.md#close) функций-членов.

Рабочая область объекты не являются постоянными; они существуют только, пока существуют ссылки на них. Это означает, что при завершении сеанса ядра базы данных, в рабочей области и коллекции баз данных не сохраняются. Необходимо повторно создать их для следующего сеанса, откройте рабочую область и баз данных снова.

Дополнительные сведения см. в разделе «Метод Close» в справке DAO.

##  <a name="committrans"></a>  CDaoWorkspace::CommitTrans

Вызовите эту функцию-член для фиксации транзакции, — сохранить один или несколько баз данных в рабочей области группы изменений и обновлений.

```
void CommitTrans();
```

### <a name="remarks"></a>Примечания

Транзакция состоит из ряда изменений для базы данных или ее структуру, начиная с вызовом [BeginTrans](#begintrans). Если после завершения транзакции, либо ее фиксацию или откат (отменить изменения) с [отката](#rollback). По умолчанию без транзакций обновления записей фиксируются немедленно. Вызов `BeginTrans` вызывает обязательств обновлений задержка до вызова метода `CommitTrans`.

> [!CAUTION]
>  Внутри одной рабочей области транзакции всегда являются глобальными для рабочей области и не ограничиваются только одну базу данных или набора записей. При выполнении операций на более чем одну базу данных или набора записей в рабочей области транзакции, `CommitTrans` фиксации все ожидающие обновления, и `Rollback` восстанавливает все операции с этими базами данных и наборов записей.

Если закрыть рабочую область с ожидающими транзакций или базы данных, все откат транзакций.

> [!NOTE]
>  Это не является механизмом двухфазной фиксации. Если не удается зафиксировать одно обновление, другим пользователям по-прежнему будут зафиксированы.

##  <a name="compactdatabase"></a>  CDaoWorkspace::CompactDatabase

Вызовите эту функцию-член для уплотнения указанного Microsoft Jet (. База данных MDB).

```
static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale = dbLangGeneral,
    int nOptions = 0);

static void PASCAL CompactDatabase(
    LPCTSTR lpszSrcName,
    LPCTSTR lpszDestName,
    LPCTSTR lpszLocale,
    int nOptions,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszSrcName*<br/>
Имя существующего, закрытия базы данных. Это может быть полный путь и имя файла, например «C:\\\MYDB. MDB». Если имя файла имеет расширение, необходимо указать его. Если сеть поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например "\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (Двойной обратной косой черты в строки пути требуются, так как "\\" escape-символом C++.)

*lpszDestName*<br/>
Полный путь к сжатой базы данных, для которого создается. Можно также указать сетевой путь, как с помощью *lpszSrcName*. Нельзя использовать *lpszDestName* аргумент, чтобы указать тот же файл базы данных *lpszSrcName*.

*lpszPassword*<br/>
Пароль, используемый для сжатия базы данных, защищенной паролем. Обратите внимание, что если вы используете версию `CompactDatabase` , принимает пароль, необходимо предоставить все параметры. Кроме того, поскольку это является параметром connect, требуется специального форматирования, следующим образом:; PWD = *lpszPassword*. Например:; PWD = «С». (Необходима начальную точку с запятой).

*lpszLocale*<br/>
Строковое выражение, используемое, чтобы указать порядок сортировки при создании *lpszDestName*. Если этот аргумент опущен, принимая значение по умолчанию `dbLangGeneral` (см. ниже), языковой стандарт для новой базы данных совпадает со значением, старые базы данных. Доступны следующие значения:

- `dbLangGeneral` Испанский, английский, немецкий, французский, португальский, итальянский и современных

- `dbLangArabic` арабский

- `dbLangCyrillic` русский

- `dbLangCzech` чешский

- `dbLangDutch` нидерландский

- `dbLangGreek` греческий

- `dbLangHebrew` иврит

- `dbLangHungarian` венгерский

- `dbLangIcelandic` исландский

- `dbLangNordic` Скандинавские языки (Microsoft СУБД Jet версии 1.0 только)

- `dbLangNorwdan` Норвежский и датской национальных настроек

- `dbLangPolish` польский

- `dbLangSpanish` Испанский (традиционный)

- `dbLangSwedfin` Шведский и финский

- `dbLangTurkish` турецкий

*nOptions*<br/>
Указывает один или несколько параметров для целевой базы данных, *lpszDestName*. Если этот аргумент опущен, принимая значение по умолчанию, *lpszDestName* будет иметь такое же шифрование и ту же версию, что *lpszSrcName*. Вы можете объединить `dbEncrypt` или `dbDecrypt` параметр с одним из параметров версии, с помощью битового оператора или. Возможными значениями, которые определяют формат базы данных, а не версия ядра СУБД, являются:

- `dbEncrypt` Шифрование базы данных при сжатии.

- `dbDecrypt` Расшифровывать базу данных при сжатии.

- `dbVersion10` Создание базы данных, которая использует ядро СУБД Jet (Майкрософт) версии 1.0 при сжатии.

- `dbVersion11` Создание базы данных, которая использует ядро СУБД Jet (Майкрософт) версии 1.1 при сжатии.

- `dbVersion20` Создание базы данных, которая использует ядро СУБД Jet (Майкрософт) версии 2.0 при сжатии.

- `dbVersion30` Создание базы данных, которая использует ядро СУБД Jet (Майкрософт) версии 3.0 при сжатии.

Можно использовать `dbEncrypt` или `dbDecrypt` в аргументе "Параметры" Укажите, следует ли шифровать или расшифровывать базу данных, так как ее сжатии. Если опустить это константа шифрования, или если вы `dbDecrypt` и `dbEncrypt`, *lpszDestName* будет иметь такое же шифрование как *lpszSrcName*. Одна из констант версии можно использовать в качестве аргумента параметров для указания версии формата данных для сжатой базы данных. Эта константа затрагивает только версию формату данных *lpszDestName*. Можно указать только одну версию константа. Если опустить константа версии *lpszDestName* будет иметь ту же версию, что *lpszSrcName*. Можно сжать *lpszDestName* только до версии, равный или более поздней версии, чем *lpszSrcName*.

> [!CAUTION]
>  Если база данных не зашифрована, это возможно, даже если вы реализуете безопасности имени пользователя и пароля, напрямую прочитать диск двоичный файл, который составляет базы данных.

### <a name="remarks"></a>Примечания

При изменении данных в базе данных, файл базы данных может стать фрагментированным и использовать больше места, чем необходимо. Периодически необходимо выполнить сжатие базы данных для дефрагментации файла базы данных. Размер сжатой базы данных обычно меньше. Можно также изменить порядок сортировки, шифрование или версию формата данных, пока копирование и сжатие базы данных.

> [!CAUTION]
>  `CompactDatabase` Функция-член не преобразует правильно всей базы данных Microsoft Access с одной версии на другой. Преобразуются только формат данных. Microsoft Access определенных пользователем объектов, таких как формы и отчеты, не преобразуются. Тем не менее данные, правильно преобразовать.

> [!TIP]
>  Можно также использовать `CompactDatabase` Копировать файл базы данных.

Дополнительные сведения о сжатие баз данных см. в разделе «CompactDatabase Method» в справке DAO.

##  <a name="create"></a>  CDaoWorkspace::Create

Вызов этой функции-члена для создания нового объекта DAO рабочей области и связать его с MFC `CDaoWorkspace` объекта.

```
virtual void Create(
    LPCTSTR lpszName,
    LPCTSTR lpszUserName,
    LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Строка, уникальным образом именует новый объект рабочей области до 14 символов. Необходимо указать имя. Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.

*lpszUserName*<br/>
Имя пользователя владельца рабочей области. Требования, см. в разделе *lpszDefaultUser* параметр [SetDefaultUser](#setdefaultuser) функция-член. Дополнительные сведения см. в разделе «Свойства UserName» в справке DAO.

*lpszPassword*<br/>
Пароль для нового объекта workspace. Пароль может содержать до 14 символов и могут содержать любой символ, за исключением ASCII от 0 (null). Пароли учитывается регистр. Дополнительные сведения см. в разделе «Пароль свойство» в справке DAO.

### <a name="remarks"></a>Примечания

Ниже приведен общий процесс создания.

1. Создать [CDaoWorkspace](#cdaoworkspace) объекта.

1. Вызов объекта `Create` функция-член для создания соответствующей рабочей области DAO. Укажите имя рабочей области.

1. При необходимости вызовите функцию [Append](#append) Если вы хотите добавить рабочую область коллекции рабочих областей ядро базы данных. Без добавления ее можно работать с рабочей областью.

После `Create` вызов, объект рабочей области, находится в открытом состоянии, готовой к использованию. Не следует вызывать `Open` после `Create`. Не следует вызывать `Create` Если рабочая область уже существует в коллекции рабочих областей. `Create` Инициализирует ядро базы данных, если он уже не был инициализирован для вашего приложения.

##  <a name="getdatabasecount"></a>  CDaoWorkspace::GetDatabaseCount

Вызовите эту функцию-член для извлечения нескольких объектов базы данных DAO в коллекции баз данных рабочей области — количество открытых баз данных в рабочей области.

```
short GetDatabaseCount();
```

### <a name="return-value"></a>Возвращаемое значение

Количество открытых баз данных в рабочей области.

### <a name="remarks"></a>Примечания

`GetDatabaseCount` полезно, если вам нужно перебрать все базы данных, определенных в коллекции баз данных рабочей области. Для получения сведений о заданной базы данных в коллекции, см. в разделе [GetDatabaseInfo](#getdatabaseinfo). Обычно это используется для вызова `GetDatabaseCount` число открытых баз данных, затем использовать это число как индекс цикла повторяющиеся вызовы `GetDatabaseInfo`.

##  <a name="getdatabaseinfo"></a>  CDaoWorkspace::GetDatabaseInfo

Вызов этой функции-члена для получения различного рода сведения об открытии базы данных в рабочей области.

```
void GetDatabaseInfo(
    int nIndex,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetDatabaseInfo(
    LPCTSTR lpszName,
    CDaoDatabaseInfo& dbinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс объекта базы данных в коллекции баз данных рабочей области, для поиска по индексу.

*dbinfo*<br/>
Ссылку на [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) объект, который возвращает запрошенные данные.

*dwInfoOptions*<br/>
Параметры, укажите, какие сведения о базе данных для извлечения. А также как они вызвать функцию возврата здесь перечислены доступные параметры:

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию), обновляемым, транзакции

- AFX_DAO_SECONDARY_INFO сведения об основном плюс: Версия, порядок, сортировки, время ожидания запроса

- AFX_DAO_ALL_INFO первичного и вторичного сведения плюс: Подключить

*lpszName*<br/>
Имя объекта базы данных, для поиска по имени. Имя — это строка в до 14 символов, который дает уникальное название новый объект рабочей области.

### <a name="remarks"></a>Примечания

Одна версия функция позволяет настроить базу данных по индексу. Другая версия позволяет настроить базу данных по имени.

Описание сведений, возвращаемых в *dbinfo*, см. в разделе [CDaoDatabaseInfo](../../mfc/reference/cdaodatabaseinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании *dwInfoOptions*. При запросе сведений на одном уровне, вы получите сведения о всех предыдущих уровней.

##  <a name="getinipath"></a>  CDaoWorkspace::GetIniPath

Эта функция члена обнаружить расположение базы данных Microsoft Jet параметры инициализации механизма в реестре Windows.

```
static CString PASCAL GetIniPath();
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) содержащую расположение реестра.

### <a name="remarks"></a>Примечания

Расположение можно использовать для получения сведений о параметрах для компонента database engine. Сведения, возвращаемые является фактически имя подраздела реестра.

Дополнительные сведения см в разделах «IniPath свойства» и «Настройка Windows реестра параметры для доступа к данным» в справке DAO.

##  <a name="getisolateodbctrans"></a>  CDaoWorkspace::GetIsolateODBCTrans

Вызывайте эту функцию члена, чтобы получить текущее значение свойства DAO IsolateODBCTrans для рабочей области.

```
BOOL GetIsolateODBCTrans();
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если транзакции ODBC изолированы; в противном случае 0.

### <a name="remarks"></a>Примечания

В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одну и ту же базу данных ODBC. Чтобы сделать это, необходимо открыть отдельную рабочую область для каждой транзакции. Имейте в виду, что несмотря на то, что каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакций, обычно не задан, подключения ODBC из нескольких объектов рабочей области, при открытии же также доступны по умолчанию.

Некоторые серверы ODBC, например Microsoft SQL Server, не позволяют одновременно выполняемыми транзакциями в одном соединении. Если необходимо иметь несколько транзакций во время ожидания для такой базы данных, установите свойство IsolateODBCTrans значение TRUE каждую рабочую область сразу же после его открыть. Это заставляет отдельное соединение ODBC для каждой рабочей области.

Дополнительные сведения см. в разделе «IsolateODBCTrans свойство» в справке DAO.

##  <a name="getlogintimeout"></a>  CDaoWorkspace::GetLoginTimeout

Вызывайте эту функцию члена, чтобы получить текущее значение свойства DAO LoginTimeout для рабочей области.

```
static short PASCAL GetLoginTimeout();
```

### <a name="return-value"></a>Возвращаемое значение

Количество секунд, прежде чем произошла ошибка при попытке входа базе данных ODBC.

### <a name="remarks"></a>Примечания

Это значение представляет количество секунд, прежде чем произошла ошибка при попытке входа базе данных ODBC. Параметр LoginTimeout по умолчанию составляет 20 секунд. Если LoginTimeout имеет значение 0, время ожидания не происходит и обмен данными с источником данных может перестать отвечать на запросы.

При попытке входа базе данных ODBC, например Microsoft SQL Server, подключение может завершиться ошибкой из-за ошибки сети или потому, что сервер не работает. А не ждать по умолчанию 20 секунд для подключения, можно указать время ожидания ядра СУБД, прежде чем он выводит сообщение об ошибке. Вход на сервер происходит неявно, как часть числа различных событий, таких как запуск запроса в базе данных внешнего сервера.

Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.

##  <a name="getname"></a>  CDaoWorkspace::GetName

Вызывайте эту функцию члена, чтобы получить определенное пользователем имя базового объекта DAO рабочей области `CDaoWorkspace` объекта.

```
CString GetName();
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , содержащая имя определяемого пользователем объекта workspace DAO.

### <a name="remarks"></a>Примечания

Имя полезно для доступа к рабочей области объекта DAO в ядро базы данных коллекции рабочих областей по имени.

Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.

##  <a name="getusername"></a>  CDaoWorkspace::GetUserName

Вызов этой функции-члена для получения имени владельца рабочей области.

```
CString GetUserName();
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , представляющий владельца объекта workspace.

### <a name="remarks"></a>Примечания

Чтобы получить или задать разрешения для владельца рабочей области, вызов DAO напрямую, чтобы проверить значение свойства разрешений; Определяет, какие разрешения этого пользователя. Для работы с разрешениями, вам потребуется система. Файл по отладке управляемого кода.

Сведения о вызова DAO напрямую, см. в разделе [технические 54 Примечание](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md). Дополнительные сведения см. в разделе «Свойства UserName» в справке DAO.

##  <a name="getversion"></a>  CDaoWorkspace::GetVersion

Вызовите для определения версии ядра СУБД Microsoft Jet используется эта функция-член.

```
static CString PASCAL GetVersion();
```

### <a name="return-value"></a>Возвращаемое значение

Объект [CString](../../atl-mfc-shared/reference/cstringt-class.md) , указывающий версию компонента database engine, связанный с объектом.

### <a name="remarks"></a>Примечания

Возвращаемое значение представляет номер версии в форме «основной.дополнительный»; например «3.0». Номер версии продукта (например, 3.0) состоит из номера версии (3), точку и номер выпуска (0).

Дополнительные сведения см. в разделе «Свойство Version» в справке DAO.

##  <a name="getworkspacecount"></a>  CDaoWorkspace::GetWorkspaceCount

Вызовите эту функцию-член для извлечения нескольких объектов DAO рабочей области в коллекции рабочих областей ядро базы данных.

```
short GetWorkspaceCount();
```

### <a name="return-value"></a>Возвращаемое значение

Число открытых рабочих областей в коллекции рабочих областей.

### <a name="remarks"></a>Примечания

Этот счетчик не включает все открытые рабочие области, не добавляется в коллекцию. `GetWorkspaceCount` полезно, если вам нужно перебрать все определенные рабочие области в коллекции рабочих областей. Для получения сведений о заданной рабочей области в коллекции, см. в разделе [GetWorkspaceInfo](#getworkspaceinfo). Обычно это используется для вызова `GetWorkspaceCount` для число открытых рабочих областей, затем использовать это число как индекс цикла повторяющиеся вызовы `GetWorkspaceInfo`.

##  <a name="getworkspaceinfo"></a>  CDaoWorkspace::GetWorkspaceInfo

Эта функция члена для получения различного рода сведения об открытии рабочей области в сеансе.

```
void GetWorkspaceInfo(
    int nIndex,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);

void GetWorkspaceInfo(
    LPCTSTR lpszName,
    CDaoWorkspaceInfo& wkspcinfo,
    DWORD dwInfoOptions = AFX_DAO_PRIMARY_INFO);
```

### <a name="parameters"></a>Параметры

*nIndex*<br/>
Отсчитываемый от нуля индекс объекта базы данных в коллекции рабочих областей, для поиска по индексу.

*wkspcinfo*<br/>
Ссылку на [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) объект, который возвращает запрошенные данные.

*dwInfoOptions*<br/>
Параметры, укажите, какие сведения о рабочем пространстве для извлечения. А также как они вызвать функцию возврата здесь перечислены доступные параметры:

- Имя AFX_DAO_PRIMARY_INFO (по умолчанию)

- AFX_DAO_SECONDARY_INFO сведения об основном плюс: Имя пользователя

- AFX_DAO_ALL_INFO первичного и вторичного сведения плюс: Изолировать ODBCTrans

*lpszName*<br/>
Имя объекта рабочей области, для поиска по имени. Имя — это строка в до 14 символов, который дает уникальное название новый объект рабочей области.

### <a name="remarks"></a>Примечания

Описание сведений, возвращаемых в *wkspcinfo*, см. в разделе [CDaoWorkspaceInfo](../../mfc/reference/cdaoworkspaceinfo-structure.md) структуры. Эта структура содержит члены, которые соответствуют элементам данных, перечисленные выше в описании *dwInfoOptions*. При запросе сведений на одном уровне, вы получите сведения для предыдущих уровней также.

##  <a name="idle"></a>  CDaoWorkspace::Idle

Вызовите `Idle` для предоставления database engine возможность выполнять фоновые задачи, из-за интенсивной обработки данных может оказаться устаревшей.

```
static void PASCAL Idle(int nAction = dbFreeLocks);
```

### <a name="parameters"></a>Параметры

*nAction*<br/>
Действия, предпринимаемые при обработке простоя. В настоящее время единственное допустимое действие является `dbFreeLocks`.

### <a name="remarks"></a>Примечания

Это особенно актуально в многопользовательской, многозадачных средах, в которых не хватит обработки фона на актуальность всех записей в наборе записей.

> [!NOTE]
>  Вызов `Idle` нет необходимости с помощью базы данных, созданные с помощью базы данных Microsoft Jet версии 3.0. Используйте `Idle` только для баз данных, созданные с помощью более ранних версий.

Как правило, удаляются блокировки чтения и данных в локальном наборе записей объектов обновляется только в том случае, если выполняются другие действия не (включая движения мыши). Если вы периодически вызывать `Idle`, предоставить компоненту database engine с время для выполнения фоновой обработки задач, выпустив ненужные блокировок чтения. Указание `dbFreeLocks` константа в качестве аргумента задерживает вычисления, пока не снимаются все блокировки чтения.

Эта функция-член не требуется в средах с одним пользователем, если выполняется несколько экземпляров приложения. `Idle` Функция-член может повысить производительность в многопользовательской среде, поскольку он заставляет ядро базы данных на диск данных к диску, освобождение блокировки памяти. Блокировки чтения можно освободить, сделав операций частью транзакции.

Дополнительные сведения см. в разделе «Простоя Method» в справке DAO.

##  <a name="isopen"></a>  CDaoWorkspace::IsOpen

Вызывайте эту функцию члена, чтобы определить ли `CDaoWorkspace` открыт объект — то есть ли MFC объект был инициализирован с помощью вызова [откройте](#open) или вызов [создать](#create).

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если открыт объект рабочей области; в противном случае 0.

### <a name="remarks"></a>Примечания

Можно вызывать любые члена функции из рабочей области, которая находится в открытом состоянии.

##  <a name="m_pdaoworkspace"></a>  CDaoWorkspace::m_pDAOWorkspace

Указатель на базовый объект рабочей области DAO.

### <a name="remarks"></a>Примечания

Используйте этот элемент данных, если требуется прямой доступ к базовому объекту DAO. Вы можете вызывать интерфейсы объекта DAO через этот указатель.

Сведения о доступе к объектам DAO напрямую, см. в разделе [технические 54 Примечание](../../mfc/tn054-calling-dao-directly-while-using-mfc-dao-classes.md).

##  <a name="open"></a>  CDaoWorkspace::Open

Явно открывает объект рабочей области, связанные с рабочей областью по умолчанию в DAO.

```
virtual void Open(LPCTSTR lpszName = NULL);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Имя объекта DAO рабочей области, чтобы открыть — строку с до 14 символов, который дает уникальное название рабочей области. Примите значение по умолчанию значение NULL, чтобы явным образом открыть рабочую область по умолчанию. Требования к именам, см. в разделе *lpszName* параметр для [создать](#create). Дополнительные сведения см. в разделе «Имя свойства» в справке DAO.

### <a name="remarks"></a>Примечания

После построения `CDaoWorkspace` , вызовите эту функцию-член для выполните одно из следующих:

- Явным образом откройте рабочую область по умолчанию. Передать NULL в качестве *lpszName*.

- Открыть существующий `CDaoWorkspace` объект, является членом коллекции рабочих областей, по имени. Передайте допустимое имя для существующего объекта рабочей области.

`Open` помещает объект рабочей области в открытом состоянии, а также инициализирует ядро базы данных, если он уже не был инициализирован для вашего приложения.

Хотя многие `CDaoWorkspace` функции можно вызывать только после открытия рабочей области, следующих функций-членов, которые работают в компоненте database Engine, доступны после создания объекта C++, но до вызова `Open`:

||||
|-|-|-|
|[Создание](#create)|[GetVersion](#getversion)|[SetDefaultUser](#setdefaultuser)|
|[GetIniPath](#getinipath)|[Простоя](#idle)|[SetIniPath](#setinipath)|
|[GetLoginTimeout](#getlogintimeout)|[SetDefaultPassword](#setdefaultpassword)|[SetLoginTimeout](#setlogintimeout)|

##  <a name="repairdatabase"></a>  CDaoWorkspace::RepairDatabase

Вызовите эту функцию-член, если вам нужно попытаться восстановить поврежденную базу данных, который обращается к базы данных Microsoft Jet.

```
static void PASCAL RepairDatabase(LPCTSTR lpszName);
```

### <a name="parameters"></a>Параметры

*lpszName*<br/>
Путь и имя файла для существующего файла базы данных Microsoft Jet Database engine. Если путь не указан, выполняется поиск только в текущем каталоге. Если система поддерживает универсальный соглашение об именовании (UNC), можно также указать сетевой путь, например: "\\\\\\\MYSERVER\\\MYSHARE\\\MYDIR\\\MYDB. MDB». (В строке пути требуются двойной обратной косой черты, так как "\\" escape-символом C++.)

### <a name="remarks"></a>Примечания

Необходимо закрыть базы данных, указанной *lpszName* перед его восстановления. В многопользовательской среде, другие пользователи не могут иметь *lpszName* открыть, когда он производится восстановление. Если *lpszName* не закрыт или не доступен для монопольного использования, возникает ошибка.

Эта функция-член пытается восстановить базу данных, который был помечен как возможное повреждение операцией неполная запись. Это может произойти, если приложение с помощью базы данных Microsoft Jet неожиданно закрыто из-за power сбоя или компьютер проблемы с оборудованием. Если для завершения операции и вызов [закрыть](../../mfc/reference/cdaodatabase-class.md#close) функция-член или выйти из приложения обычным образом, базы данных, не будут помечены как может быть повреждена.

> [!NOTE]
>  После восстановления базы данных, рекомендуется также производить сжатие с помощью [CompactDatabase](#compactdatabase) функция-член для дефрагментации файла и освобождению места на диске.

Дополнительные сведения о восстановлении баз данных см. в разделе «RepairDatabase Method» в справке DAO.

##  <a name="rollback"></a>  CDaoWorkspace::Rollback

Вызывайте эту функцию члена, чтобы завершить текущую транзакцию и восстановить все базы данных в рабочей области для их условие, прежде чем транзакция была начата.

```
void Rollback();
```

### <a name="remarks"></a>Примечания

> [!CAUTION]
>  В один объект рабочей области транзакции всегда являются глобальными для рабочей области и не ограничиваются только одну базу данных или набора записей. При выполнении операций на более чем одну базу данных или набора записей в рабочей области транзакции, `Rollback` восстанавливает все операции на всех этих баз данных и наборов записей.

Если вы закроете объект рабочей области без сохранения или отката всех ожидающих транзакций, транзакции обычно автоматически откатываются. При вызове метода [CommitTrans](#committrans) или `Rollback` без предварительного вызова функции [BeginTrans](#begintrans), возникает ошибка.

> [!NOTE]
>  В начале транзакции, компонент database engine записывает его операции в файле, который хранится в каталоге, указанном в переменной среды TEMP на рабочей станции. Если файл журнала транзакций исчерпывает доступное хранилище на диске TEMP, компонент database engine приведет к MFC для создания `CDaoException` (ошибка DAO 2004 г.). На этом этапе, если вы вызываете `CommitTrans`фиксируются неопределенное количество операций, но остальные незавершенные операции будут потеряны, и операция должна быть перезапущена. Вызов `Rollback` освобождает журнала транзакций и производит откат всех операций в транзакции.

##  <a name="setdefaultpassword"></a>  CDaoWorkspace::SetDefaultPassword

Вызов этой функции-члена для установки пароля по умолчанию, компонент database engine использует при создании рабочей области объекта без пароля.

```
static void PASCAL SetDefaultPassword(LPCTSTR lpszPassword);
```

### <a name="parameters"></a>Параметры

*lpszPassword*<br/>
Пароль по умолчанию. Пароль может содержать до 14 символов и могут содержать любой символ, за исключением ASCII от 0 (null). Пароли учитывается регистр.

### <a name="remarks"></a>Примечания

Пароль по умолчанию, заданное применяется к новые рабочие области, созданные после вызова метода. При создании последующих рабочих областей, необходимо указать пароль в [создать](#create) вызова.

Чтобы использовать эту функцию-член:

1. Создать `CDaoWorkspace` объекта, но не следует вызывать `Create`.

1. Вызовите `SetDefaultPassword` и, при желании [SetDefaultUser](#setdefaultuser).

1. Вызовите `Create` для этой рабочей области объект или последующие условия, без указания пароля.

По умолчанию DefaultUser задано значение «admin» и DefaultPassword свойству пустую строку (»»).

Дополнительные сведения о безопасности см. в разделе «Разрешения свойство» в справке DAO. Дополнительные сведения см в разделах «DefaultPassword свойства» и «DefaultUser свойство» в справке DAO.

##  <a name="setdefaultuser"></a>  CDaoWorkspace::SetDefaultUser

Вызывайте эту функцию члена, чтобы задать имя пользователя по умолчанию, который компонент database engine использует при создании рабочей области объекта без определенного имени пользователя.

```
static void PASCAL SetDefaultUser(LPCTSTR lpszDefaultUser);
```

### <a name="parameters"></a>Параметры

*lpszDefaultUser*<br/>
Имя пользователя по умолчанию. Имя пользователя может иметь длину от 1 до 20 символов и включать буквы, символы с диакритическими знаками, цифры, пробелы и символы, за исключением: "(кавычки) / (косая черта), \ (обратная косая черта), \[ \] (квадратные скобки): (двоеточие), &#124; () Вертикальная черта), \< (меньше-знак), > (больше-знак), + (плюс), = (равно входа), (точку с запятой), (запятая), (вопросительный знак), \* (звездочка), начальные пробелы, а также управляющие символы (коды ASCII от 00 до ASCII-31). Дополнительные сведения см. в разделе «Свойства UserName» в справке DAO.

### <a name="remarks"></a>Примечания

Имя пользователя по умолчанию, заданное применяется к новые рабочие области, созданные после вызова метода. При создании последующих рабочих областей, необходимо указать имя пользователя в [создать](#create) вызова.

Чтобы использовать эту функцию-член:

1. Создать `CDaoWorkspace` объекта, но не следует вызывать `Create`.

1. Вызовите `SetDefaultUser` и, при желании [SetDefaultPassword](#setdefaultpassword).

1. Вызовите `Create` для этой рабочей области объект или последующие условия, без указания имени пользователя.

По умолчанию DefaultUser задано значение «admin» и DefaultPassword свойству пустую строку (»»).

Дополнительные сведения см в разделах «DefaultUser свойства» и «DefaultPassword свойство» в справке DAO.

##  <a name="setinipath"></a>  CDaoWorkspace::SetIniPath

Вызов этой функции-члена для указания расположения параметров реестра Windows для ядра СУБД Microsoft Jet.

```
static void PASCAL SetIniPath(LPCTSTR lpszRegistrySubKey);
```

### <a name="parameters"></a>Параметры

*lpszRegistrySubkey*<br/>
Строка, содержащая имя подраздела реестра Windows для настройки ядра базы данных Microsoft Jet или параметры, необходимые для установки баз данных ISAM.

### <a name="remarks"></a>Примечания

Вызовите `SetIniPath` только в том случае, если вам нужно указать специальные параметры. Дополнительные сведения см. в разделе «IniPath свойство» в справке DAO.

> [!NOTE]
>  Вызовите `SetIniPath` во время установки приложения, не при запуске приложения. `SetIniPath` должен вызываться перед открытием все рабочие области, баз данных или наборов записей; в противном случае MFC вызывает исключение.

Этот механизм можно использовать для настройки механизма базы данных с параметрами реестра, предоставляемый пользователем. Область действия этого атрибута ограничено в приложение и нельзя изменить без перезапуска приложения.

##  <a name="setisolateodbctrans"></a>  CDaoWorkspace::SetIsolateODBCTrans

Вызов этой функции-члена для задания значения свойства DAO IsolateODBCTrans для рабочей области.

```
void SetIsolateODBCTrans(BOOL bIsolateODBCTrans);
```

### <a name="parameters"></a>Параметры

*bIsolateODBCTrans*<br/>
Передайте значение TRUE, если вы хотите начать изоляция транзакции ODBC. Если вы хотите остановить изоляция транзакции ODBC, необходимо передать значение FALSE.

### <a name="remarks"></a>Примечания

В некоторых случаях может потребоваться иметь несколько одновременных транзакций, ожидающих на одну и ту же базу данных ODBC. Чтобы сделать это, необходимо открыть отдельную рабочую область для каждой транзакции. Несмотря на то, что каждая рабочая область может иметь собственное подключение ODBC к базе данных, это снижает производительность системы. Так как уровень изоляции транзакций, обычно не задан, подключения ODBC из нескольких объектов рабочей области, при открытии же также доступны по умолчанию.

Некоторые серверы ODBC, например Microsoft SQL Server, не позволяют одновременно выполняемыми транзакциями в одном соединении. Если необходимо иметь несколько транзакций во время ожидания для такой базы данных, установите свойство IsolateODBCTrans значение TRUE каждую рабочую область сразу же после его открыть. Это заставляет отдельное соединение ODBC для каждой рабочей области.

##  <a name="setlogintimeout"></a>  CDaoWorkspace::SetLoginTimeout

Вызов этой функции-члена для задания значения свойства DAO LoginTimeout для рабочей области.

```
static void PASCAL SetLoginTimeout(short nSeconds);
```

### <a name="parameters"></a>Параметры

*nSeconds*<br/>
Количество секунд, прежде чем произошла ошибка при попытке входа базе данных ODBC.

### <a name="remarks"></a>Примечания

Это значение представляет количество секунд, прежде чем произошла ошибка при попытке входа базе данных ODBC. Параметр LoginTimeout по умолчанию составляет 20 секунд. Если LoginTimeout имеет значение 0, время ожидания не происходит и обмен данными с источником данных может перестать отвечать на запросы.

При попытке входа базе данных ODBC, например Microsoft SQL Server, подключение может завершиться ошибкой из-за ошибки сети или потому, что сервер не работает. А не ждать по умолчанию 20 секунд для подключения, можно указать время ожидания ядра СУБД, прежде чем он выводит сообщение об ошибке. Журнал плана обслуживания сервере выполняется неявно, как часть числа различных событий, таких как запуск запроса в базе данных внешнего сервера. Значение времени ожидания определяется текущее значение свойства LoginTimeout.

Дополнительные сведения см. в разделе «LoginTimeout свойство» в справке DAO.

## <a name="see-also"></a>См. также

[Класс CObject](../../mfc/reference/cobject-class.md)<br/>
[Диаграмма иерархии](../../mfc/hierarchy-chart.md)<br/>
[Класс CDaoDatabase](../../mfc/reference/cdaodatabase-class.md)<br/>
[Класс CDaoRecordset](../../mfc/reference/cdaorecordset-class.md)<br/>
[Класс CDaoTableDef](../../mfc/reference/cdaotabledef-class.md)<br/>
[Класс CDaoQueryDef](../../mfc/reference/cdaoquerydef-class.md)<br/>
[Класс CDaoException](../../mfc/reference/cdaoexception-class.md)
