---
description: 'Дополнительные сведения о: Колепропертиесдиалог Class'
title: Класс Колепропертиесдиалог
ms.date: 11/04/2016
f1_keywords:
- COlePropertiesDialog
- AFXODLGS/COlePropertiesDialog
- AFXODLGS/COlePropertiesDialog::COlePropertiesDialog
- AFXODLGS/COlePropertiesDialog::DoModal
- AFXODLGS/COlePropertiesDialog::OnApplyScale
- AFXODLGS/COlePropertiesDialog::m_gp
- AFXODLGS/COlePropertiesDialog::m_lp
- AFXODLGS/COlePropertiesDialog::m_op
- AFXODLGS/COlePropertiesDialog::m_psh
- AFXODLGS/COlePropertiesDialog::m_vp
helpviewer_keywords:
- COlePropertiesDialog [MFC], COlePropertiesDialog
- COlePropertiesDialog [MFC], DoModal
- COlePropertiesDialog [MFC], OnApplyScale
- COlePropertiesDialog [MFC], m_gp
- COlePropertiesDialog [MFC], m_lp
- COlePropertiesDialog [MFC], m_op
- COlePropertiesDialog [MFC], m_psh
- COlePropertiesDialog [MFC], m_vp
ms.assetid: a54dbc89-1447-4329-bd01-00e98ec9e935
ms.openlocfilehash: f0c102412f422ff0eabc9f1ff8e19901845905e8
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97226770"
---
# <a name="colepropertiesdialog-class"></a>Класс Колепропертиесдиалог

Инкапсулирует стандартное диалоговое окно свойств объекта OLE Windows.

## <a name="syntax"></a>Синтаксис

```
class COlePropertiesDialog : public COleDialog
```

## <a name="members"></a>Члены

### <a name="public-constructors"></a>Открытые конструкторы

|name|Описание|
|----------|-----------------|
|[Колепропертиесдиалог:: Колепропертиесдиалог](#colepropertiesdialog)|Формирует объект `COlePropertiesDialog`.|

### <a name="public-methods"></a>Открытые методы

|name|Описание|
|----------|-----------------|
|[Колепропертиесдиалог::D Омодал](#domodal)|Отображает диалоговое окно и позволяет пользователю сделать выбор.|
|[Колепропертиесдиалог:: Онапплискале](#onapplyscale)|Вызывается структурой при изменении масштаба элемента документа.|

### <a name="public-data-members"></a>Открытые члены данных

|Имя|Описание|
|----------|-----------------|
|[Колепропертиесдиалог:: m_gp](#m_gp)|Структура, используемая для инициализации страницы "Общие" `COlePropertiesDialog` объекта.|
|[Колепропертиесдиалог:: m_lp](#m_lp)|Структура, используемая для инициализации страницы "ссылка" `COlePropertiesDialog` объекта.|
|[Колепропертиесдиалог:: m_op](#m_op)|Структура, используемая для инициализации `COlePropertiesDialog` объекта.|
|[Колепропертиесдиалог:: m_psh](#m_psh)|Структура, используемая для добавления дополнительных страниц настраиваемых свойств.|
|[Колепропертиесдиалог:: m_vp](#m_vp)|Структура, используемая для настройки страницы представления `COlePropertiesDialog` объекта.|

## <a name="remarks"></a>Комментарии

Общие диалоговые окна свойств объектов OLE предоставляют простой способ просмотра и изменения свойств элемента документа OLE способом, согласованным с стандартами Windows. Эти свойства включают, среди прочего, сведения о файле, представленном элементом документа, параметры для отображения значка и масштаба изображения, а также сведения о связи элемента (если элемент связан).

Чтобы использовать `COlePropertiesDialog` объект, сначала создайте объект с помощью `COlePropertiesDialog` конструктора. После создания диалогового окна вызовите `DoModal` функцию члена, чтобы отобразить диалоговое окно и разрешить пользователю изменять любые свойства элемента. `DoModal` Возвращает значение, указывающее, выбрал пользователь кнопку ОК (ИДОК) или Отмена (ИДКАНЦЕЛ). В дополнение к кнопкам ОК и отмена есть кнопка Применить. Когда пользователь выбирает Apply (Применить), все изменения, внесенные в свойства элемента документа, применяются к элементу, а его изображение автоматически обновляется, но остается активным.

Элемент данных [m_psh](#m_psh) является указателем на `PROPSHEETHEADER` структуру, и в большинстве случаев вам не потребуется явно обращаться к нему. Единственное исключение — когда требуются дополнительные страницы свойств, кроме страниц общих, представлений и ссылок по умолчанию. В этом случае можно изменить `m_psh` элемент данных, чтобы включить пользовательские страницы перед вызовом `DoModal` функции члена.

Дополнительные сведения о диалоговых окнах OLE см. в разделе [диалоговые окна статьи в OLE](../../mfc/dialog-boxes-in-ole.md).

## <a name="inheritance-hierarchy"></a>Иерархия наследования

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

[COleDialog](../../mfc/reference/coledialog-class.md)

`COlePropertiesDialog`

## <a name="requirements"></a>Требования

**Заголовок:** афксодлгс. h

## <a name="colepropertiesdialogcolepropertiesdialog"></a><a name="colepropertiesdialog"></a> Колепропертиесдиалог:: Колепропертиесдиалог

Создает объект `COlePropertiesDialog`.

```
COlePropertiesDialog(
    COleClientItem* pItem,
    UINT nScaleMin = 10,
    UINT nScaleMax = 500,
    CWnd* pParentWnd = NULL);
```

### <a name="parameters"></a>Параметры

*питем*<br/>
Указатель на элемент документа, свойства которого обращаются.

*нскалемин*<br/>
Минимальный процент масштабирования для изображения элемента документа.

*нскалемакс*<br/>
Максимальный процент масштабирования для изображения элемента документа.

*ппарентвнд*<br/>
Указатель на родительский элемент или владелец диалогового окна.

### <a name="remarks"></a>Комментарии

`COlePropertiesDialog`Чтобы реализовать масштабирование элементов документа, создайте класс диалогового окна Общие свойства объекта OLE из. Все диалоговые окна, реализованные экземпляром этого класса, не поддерживают масштабирование элемента документа.

По умолчанию диалоговое окно Общие свойства объекта OLE содержит три страницы по умолчанию:

- Общие сведения

   Эта страница содержит сведения о системе для файла, представленного выбранным элементом документа. На этой странице пользователь может преобразовать выбранный элемент в другой тип.

- Представление

   Эта страница содержит параметры для отображения элемента, изменения значка и изменения масштаба изображения.

- Ссылка

   Эта страница содержит параметры для изменения расположения связанного элемента и обновления связанного элемента. На этой странице пользователь может разорвать связь выбранного элемента.

Чтобы добавить страницы, выходящие за рамки, предоставленные по умолчанию, измените переменную члена [m_psh](#m_psh) перед выходом из конструктора `COlePropertiesDialog` класса, производного от. Это Расширенная реализация `COlePropertiesDialog` конструктора.

## <a name="colepropertiesdialogdomodal"></a><a name="domodal"></a> Колепропертиесдиалог::D Омодал

Эта функция-член вызывается для отображения диалогового окна Общие свойства объекта OLE Windows и позволяет пользователю просматривать и (или) изменять различные свойства элемента документа.

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>Возвращаемое значение

ИДОК или ИДКАНЦЕЛ в случае успеха; в противном случае — 0. ИДОК и ИДКАНЦЕЛ — это константы, которые указывают, выбрал ли пользователь кнопку ОК или Отмена.

Если возвращается ИДКАНЦЕЛ, можно вызвать функцию Windows [коммдлжекстендедеррор](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror) , чтобы определить, произошла ли ошибка.

## <a name="colepropertiesdialogm_gp"></a><a name="m_gp"></a> Колепропертиесдиалог:: m_gp

Структура типа [олеуигнрлпропс](/windows/win32/api/oledlg/ns-oledlg-oleuignrlpropsw), используемая для инициализации страницы «Общие» диалогового окна «свойства OLE-объекта».

```
OLEUIGNRLPROPS m_gp;
```

### <a name="remarks"></a>Комментарии

На этой странице показан тип и размер внедрения, а также возможность доступа пользователя к диалоговому окну преобразование. На этой странице также отображается назначение ссылки, если объект является ссылкой.

Дополнительные сведения о `OLEUIGNRLPROPS` структуре см. в Windows SDK.

## <a name="colepropertiesdialogm_lp"></a><a name="m_lp"></a> Колепропертиесдиалог:: m_lp

Структура типа [олеуилинкпропс](/windows/win32/api/oledlg/ns-oledlg-oleuilinkpropsw), используемая для инициализации страницы ссылки диалогового окна Свойства объекта OLE.

```
OLEUILINKPROPS m_lp;
```

### <a name="remarks"></a>Комментарии

На этой странице показано расположение связанного элемента и позволяет пользователю обновить или прервать связь с элементом.

Дополнительные сведения о `OLEUILINKPROPS` структуре см. в Windows SDK.

## <a name="colepropertiesdialogm_op"></a><a name="m_op"></a> Колепропертиесдиалог:: m_op

Структура типа [олеуиобжектпропс](/windows/win32/api/oledlg/ns-oledlg-oleuiobjectpropsw), используемая для инициализации диалогового окна Общие свойства объекта OLE.

```
OLEUIOBJECTPROPS m_op;
```

### <a name="remarks"></a>Комментарии

Эта структура содержит элементы, используемые для инициализации страниц общих, связанных и представлений.

Дополнительные сведения см. в разделе структуры ОЛЕУИОБЖЕКТПРОПС и [олеуилинкпропс](/windows/win32/api/oledlg/ns-oledlg-oleuilinkpropsw) в Windows SDK.

## <a name="colepropertiesdialogm_psh"></a><a name="m_psh"></a> Колепропертиесдиалог:: m_psh

Структура типа [пропшисеадер](/windows/win32/api/prsht/ns-prsht-propsheetheadera_v2), члены которой хранят характеристики объекта диалогового окна.

```
PROPSHEETHEADER m_psh;
```

### <a name="remarks"></a>Комментарии

После создания `COlePropertiesDialog` объекта можно использовать `m_psh` для установки различных аспектов диалогового окна перед вызовом `DoModal` функции-члена.

При `m_psh` непосредственном изменении элемента данных будет переопределено поведение по умолчанию.

Дополнительные сведения о `PROPSHEETHEADER` структуре см. в Windows SDK.

## <a name="colepropertiesdialogm_vp"></a><a name="m_vp"></a> Колепропертиесдиалог:: m_vp

Структура типа [олеуивиевпропс](/windows/win32/api/oledlg/ns-oledlg-oleuiviewpropsw), используемая для инициализации страницы «представление» диалогового окна Свойства объекта OLE.

```
OLEUIVIEWPROPS m_vp;
```

### <a name="remarks"></a>Комментарии

Эта страница позволяет пользователю переключаться между представлениями "содержимое" и "значок" для объекта, а также изменять его масштаб в контейнере. Он также позволяет пользователю получить доступ к диалоговому окну изменение значка, когда объект отображается в виде значка.

Дополнительные сведения о `OLEUIVIEWPROPS` структуре см. в Windows SDK.

## <a name="colepropertiesdialogonapplyscale"></a><a name="onapplyscale"></a> Колепропертиесдиалог:: Онапплискале

Вызывается платформой при изменении значения масштабирования и выборе параметра "ОК" или "Применить".

```
virtual BOOL OnApplyScale(
    COleClientItem* pItem,
    int nCurrentScale,
    BOOL bRelativeToOrig);
```

### <a name="parameters"></a>Параметры

*питем*<br/>
Указатель на элемент документа, свойства которого обращаются.

*нкуррентскале*<br/>
Числовое значение шкалы диалогового окна.

*брелативетуриг*<br/>
Указывает, применяется ли масштабирование к исходному размеру элемента документа.

### <a name="return-value"></a>Возвращаемое значение

Ненулевое значение, если обработано; в противном случае — 0.

### <a name="remarks"></a>Комментарии

Реализация по умолчанию не выполняет никаких действий. Чтобы включить элементы управления масштабированием, необходимо переопределить эту функцию.

> [!NOTE]
> Перед отображением диалогового окна Общие свойства объекта OLE платформа вызывает эту функцию с нулевым значением для *питем* и-1 для *нкуррентскале*. Это делается для определения того, должны ли быть включены элементы управления масштабированием.

## <a name="see-also"></a>См. также раздел

[Пример CIRC в MFC](../../overview/visual-cpp-samples.md)<br/>
[Класс Коледиалог](../../mfc/reference/coledialog-class.md)<br/>
[Иерархическая диаграмма](../../mfc/hierarchy-chart.md)<br/>
[Класс Коледиалог](../../mfc/reference/coledialog-class.md)<br/>
[Класс CPropertyPage](../../mfc/reference/cpropertypage-class.md)
