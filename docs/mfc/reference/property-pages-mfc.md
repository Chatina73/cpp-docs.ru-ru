---
title: Страницы свойств (MFC)
ms.date: 11/04/2016
helpviewer_keywords:
- property page data transfer functions in MFC
- property pages [MFC], global MFC functions
ms.assetid: 734f88bc-c776-4136-9b0e-f45c761a45c1
ms.openlocfilehash: 6456a192a502a0fcc032eaefc667c90ecec86d42
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2020
ms.locfileid: "81751138"
---
# <a name="property-pages-mfc"></a>Страницы свойств (MFC)

Страницы свойств отображают текущие значения конкретных свойств управления OLE в настраиваемом графическом интерфейсе для просмотра и редактирования, поддерживая механизм картирования данных на основе обмена диалоговыми данными (DDX).

Этот механизм отображения данных отображает элементы управления страницей свойств с отдельными свойствами управления OLE. Значение свойства элемента управления отражает состояние или содержимое элемента управления свойствами. Отображение между управлением страницой свойств и свойствами `DoDataExchange` определяется **DDP_** вызовов функций в функции члена страницы свойства. Ниже приводится список **DDP_** функций, которые обмениваются данными, введенными с помощью страницы свойств вашего управления:

### <a name="property-page-data-transfer"></a>Передача данных страницы свойств

|||
|-|-|
|[DDP_CBIndex](#ddp_cbindex)|Связывает индекс выбранной строки в комбо-коробке с свойством элемента управления.|
|[DDP_CBString](#ddp_cbstring)|Связывает выбранную строку в комбо-коробке с свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью соответствовать ей.|
|[DDP_CBStringExact](#ddp_cbstringexact)|Связывает выбранную строку в комбо-коробке с свойством элемента управления. Выбранная строка и значение строки свойства должны точно соответствовать.|
|[DDP_Check](#ddp_check)|Ссылки на флажок на странице свойства элемента управления с свойством элемента управления.|
|[DDP_LBIndex](#ddp_lbindex)|Связывает индекс выбранной строки в поле списка с свойством элемента управления.|
|[DDP_LBString](#ddp_lbstring)|Связывает выбранную строку в поле списка с свойством элемента управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью соответствовать ей.|
|[DDP_LBStringExact](#ddp_lbstringexact)|Связывает выбранную строку в поле списка с свойством элемента управления. Выбранная строка и значение строки свойства должны точно соответствовать.|
|[DDP_PostProcessing](#ddp_postprocessing)|Завершает передачу стоимости имущества из вашего контроля.|
|[DDP_Radio](#ddp_radio)|Ссылки группы радиокнопок на странице свойства элемента управления с свойством элемента управления.|
|[DDP_Text](#ddp_text)|Ссылки управления на странице свойства элемента управления с свойством элемента управления. Эта функция обрабатывает несколько различных типов свойств, таких как **двойной,** **короткий,** BSTR, и **долго.**|

Для получения дополнительной `DoDataExchange` информации о функциях и страницах свойств смотрите статью [ActiveX Controls: Property Pages](../../mfc/mfc-activex-controls-property-pages.md).

Ниже приводится список макросов, используемых для создания и управления страницами свойств для управления OLE:

### <a name="property-pages"></a>Страницы свойств

|||
|-|-|
|[BEGIN_PROPPAGEIDS](#begin_proppageids)|Начинается список идов страницы свойств.|
|[END_PROPPAGEIDS](#end_proppageids)|Завершает список идов страницы свойств.|
|[PROPPAGEID](#proppageid)|Объявляет страницу свойств класса управления.|

## <a name="ddp_cbindex"></a><a name="ddp_cbindex"></a>DDP_CBIndex

Позвоните в `DoDataExchange` эту функцию в функции страницы свойств, чтобы синхронизировать значение свойства с индексом текущего выбора в комбо-поле на странице свойств.

```cpp
void AFXAPI DDP_CBIndex(
    CDataExchange* pDX,
    int id,
    int& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления комбо-коробкой, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено с управлением комбо-коробкой, указанным *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_CBIndex` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_cbstring"></a><a name="ddp_cbstring"></a>DDP_CBString

Вызовите эту функцию `DoDataExchange` в функции страницы свойств, чтобы синхронизировать значение свойства строки с текущим выбором в комбо-поле на странице свойств.

```cpp
void AFXAPI DDP_CBString(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления комбо-коробкой, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено строкой комбо-коробки, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_CBString` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_cbstringexact"></a><a name="ddp_cbstringexact"></a>DDP_CBStringExact

Вызовите эту функцию `DoDataExchange` в функции страницы свойств, чтобы синхронизировать значение свойства строки, которое точно соответствует текущему выбору в комбо-поле на странице свойств.

```cpp
void AFXAPI DDP_CBStringExact(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления комбо-коробкой, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено строкой комбо-коробки, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_CBStringExact` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_check"></a><a name="ddp_check"></a>DDP_Check

Вызовите эту функцию `DoDataExchange` в функции страницы свойств, чтобы синхронизировать значение свойства с управлением контрольной полей проверки страницы сопутствуного свойства.

```cpp
void AFXAPI DDP_Check(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления флажком, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено с контролем флажка, указанным *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_Check` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_lbindex"></a><a name="ddp_lbindex"></a>DDP_LBIndex

Позвоните в `DoDataExchange` эту функцию в функции страницы свойств, чтобы синхронизировать значение свойства с индексом текущего выбора в поле списка на странице свойств.

```cpp
void AFXAPI DDP_LBIndex(
    CDataExchange* pDX,
    int id,
    int& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления полем списка, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено строкой коробки списка, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_LBIndex` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_lbstring"></a><a name="ddp_lbstring"></a>DDP_LBString

Вызовите эту функцию `DoDataExchange` в функции страницы свойств, чтобы синхронизировать значение свойства строки с текущим выбором в поле списка на странице свойства.

```cpp
void AFXAPI DDP_LBString(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления полем списка, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено строкой коробки списка, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_LBString` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_lbstringexact"></a><a name="ddp_lbstringexact"></a>DDP_LBStringExact

Вызовите эту функцию `DoDataExchange` в функции страницы свойств, чтобы синхронизировать значение свойства строки, которое точно соответствует текущему выбору в поле списка на странице свойств.

```cpp
void AFXAPI DDP_LBStringExact(
    CDataExchange* pDX,
    int id,
    CString& member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления полем списка, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено строкой коробки списка, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_LBStringExact` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_postprocessing"></a><a name="ddp_postprocessing"></a>DDP_PostProcessing

Позвоните в эту функцию `DoDataExchange` в функции страницы свойств, чтобы закончить передачу значений свойств со страницы свойств на контроль при сохранении значений свойства.

```cpp
void AFXAPI DDP_PostProcessing(CDataExchange * pDX);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

### <a name="remarks"></a>Remarks

Эта функция должна быть вызвана после завершения всех функций обмена данными. Пример:

[!code-cpp[NVC_MFCAxCtl#15](../../mfc/reference/codesnippet/cpp/property-pages-mfc_1.cpp)]

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_radio"></a><a name="ddp_radio"></a>DDP_Radio

Вызов ими функции `DoPropExchange` в функции управления для синхронизации значения свойства с соответствующим управлением радиокнопки страницы свойств.

```cpp
void AFXAPI DDP_Radio(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса управления радиокнопкой, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства элемента управления, которое должно быть обменено с радиокнопкой управления, указанной *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_Radio` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="ddp_text"></a><a name="ddp_text"></a>DDP_Text

Вызов ими функции `DoDataExchange` в функции элемента управления для синхронизации значения свойства с соответствующим управлением страницы свойства.

```cpp
void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    BYTE & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    int & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    UINT & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    long & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    DWORD & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    float & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    double & member,
    LPCTSTR pszPropName);

void AFXAPI DDP_Text(
    CDataExchange* pDX,
    int id,
    CString & member,
    LPCTSTR pszPropName);
```

### <a name="parameters"></a>Параметры

*Pdx*<br/>
Указатель на `CDataExchange` объект. Структура предоставляет этот объект для формирования контекста обмена данными, включая его направление.

*идентификатор*<br/>
Идентификатор ресурса элемента управления, связанный с свойством управления, указанным *pszPropName.*

*Член*<br/>
Переменная участника, связанная с управлением страницы свойств, указанным *id* и свойством, указанным *pszPropName.*

*pszPropName*<br/>
Имя свойства контрольного свойства, которое должно быть обменено с элементом управления, указанным *id.*

### <a name="remarks"></a>Remarks

Эта функция должна быть `DDX_Text` вызвана до соответствующего вызова функции.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="begin_proppageids"></a><a name="begin_proppageids"></a>BEGIN_PROPPAGEIDS

Начинается определение списка идов страницы свойств вашего элемента управления.

```
BEGIN_PROPPAGEIDS(class_name,  count)
```

### <a name="parameters"></a>Параметры

*class_name*<br/>
Название класса управления, для которого указаны страницы свойств.

*count*<br/>
Количество страниц свойств, используемых классом управления.

### <a name="remarks"></a>Remarks

В файле реализации (.cpp), определяющем функции участника для вашего класса, начните список страниц свойств с BEGIN_PROPPAGEIDS макросом, затем добавьте макрозаписи для каждой страницы свойств и заполните список страниц свойств с помощью END_PROPPAGEIDS макроса.

Для получения дополнительной информации о страницах свойств смотрите статью [ActiveX Controls: Property Pages](../../mfc/mfc-activex-controls-property-pages.md).

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="end_proppageids"></a><a name="end_proppageids"></a>END_PROPPAGEIDS

Завершает определение списка идентификаторов страницы свойств.

```
END_PROPPAGEIDS(class_name)
```

### <a name="parameters"></a>Параметры

*class_name*<br/>
Название класса управления, которому принадлежит страница свойства.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="proppageid"></a><a name="proppageid"></a>ПРОПАЧИД

Добавляет страницу свойств для использования вашим управлением OLE.

```
PROPPAGEID(clsid)
```

### <a name="parameters"></a>Параметры

*clsid*<br/>
Уникальный идентификатор класса страницы свойств.

### <a name="remarks"></a>Remarks

Все макросы PROPPAGEID должны быть помещены между BEGIN_PROPPAGEIDS и END_PROPPAGEIDS макросов в файле реализации элемента управления.

### <a name="requirements"></a>Требования

  **Заголовок** afxctl.h

## <a name="see-also"></a>См. также раздел

[Макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md)
