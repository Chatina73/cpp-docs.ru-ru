---
title: Элементы управления ActiveX в MFC. Добавление пользовательских свойств
ms.date: 11/04/2016
helpviewer_keywords:
- MFC ActiveX controls [MFC], properties
- properties [MFC], custom
ms.assetid: 85af5167-74c7-427b-b8f3-e0d7b73942e5
ms.openlocfilehash: 00f7a879582bca562ce626fe224206094fd19bc7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364705"
---
# <a name="mfc-activex-controls-adding-custom-properties"></a>Элементы управления ActiveX в MFC. Добавление пользовательских свойств

Пользовательские свойства отличаются от свойств запасов тем, что пользовательские свойства еще не реализованы `COleControl` классом. Пользовательское свойство используется для того, чтобы предоставить программисту определенное состояние или внешний вид элемента управления ActiveX, использующий элемент управления.

В этой статье описывается, как добавить пользовательское свойство в управление ActiveX с помощью Add Property Wizard, и объясняется полученные изменения кода. Будут рассмотрены следующие задачи:

- [Использование мастера свойств добавления для добавления пользовательского свойства](#_core_using_classwizard_to_add_a_custom_property)

- [Добавление изменений мастера свойств для пользовательских свойств](#_core_classwizard_changes_for_custom_properties)

Пользовательские свойства бывают четырех разновидностей реализации: Переменная участников, переменная участника с уведомлением, методы получения/установки и параметризации.

- Переменная реализация члена

   Эта реализация представляет состояние свойства как переменную элемента в классе управления. Используйте реализацию переменной участника, когда не важно знать, когда изменяется значение свойства. Из трех типов эта реализация создает наименьшее количество кода поддержки для свойства. Макрозапись карты отправки для реализации переменной элемента [является DISP_PROPERTY](../mfc/reference/dispatch-maps.md#disp_property).

- Переменный участник с реализацией уведомлений

   Эта реализация состоит из переменной члена и функции уведомлений, созданной мастером свойств Добавления. Функция уведомления автоматически вызывается инфраструктурой после изменения значения свойства. Используйте переменную участника с реализацией Уведомления, когда необходимо уведомить об этом после изменения значения свойства. Эта реализация требует больше времени, поскольку она требует вызова функции. Макрозапись карты отправки для этой реализации [DISP_PROPERTY_NOTIFY.](../mfc/reference/dispatch-maps.md#disp_property_notify)

- Реализация /установка методов

   Эта реализация состоит из пары функций элемента в классе управления. Реализация Get/Set Methods автоматически вызывает функцию Пользователя, когда пользователь элемента управления запрашивает текущее значение свойства и функцию элемента набора, когда пользователь элемента управления просит изменить свойство. Используйте эту реализацию, когда вам нужно вычислить значение свойства во время выполнения, проверить значение, переданное пользователем элемента управления, перед изменением фактического свойства, или реализовать только тип свойства для чтения или записи. Макрозапись карты отправки для этой реализации [является DISP_PROPERTY_EX](../mfc/reference/dispatch-maps.md#disp_property_ex). В следующем разделе [«Использование мастера свойств добавления для добавления пользовательского свойства»](#_core_using_classwizard_to_add_a_custom_property)использует пользовательское свойство CircleOffset для демонстрации этой реализации.

- Параметризированная реализация

   Параметризированная реализация поддерживается Мастером свойств Добавления. Параметризированное свойство (иногда называемое массивом свойств) может быть использовано для доступа к набору значений через одно свойство элемента управления. Макрозапись карты отправки для этой реализации является DISP_PROPERTY_PARAM. Для получения дополнительной информации о реализации этого типа см. [Реализация параметризированного свойства](../mfc/mfc-activex-controls-advanced-topics.md) в статье ActiveX Controls: Advanced Topics.

## <a name="using-the-add-property-wizard-to-add-a-custom-property"></a><a name="_core_using_classwizard_to_add_a_custom_property"></a>Использование мастера свойств добавления для добавления пользовательского свойства

Следующая процедура демонстрирует добавление пользовательского свойства, CircleOffset, которое использует реализацию методов Get/Set. Пользовательское свойство CircleOffset позволяет пользователю элемента управления компенсировать круг из центра связующего прямоугольника элемента управления. Процедура добавления пользовательских свойств с реализацией, не всходной, помимо методов Get/Set, очень похожа.

Эта же процедура также может быть использована для добавления других пользовательских свойств, которые вы хотите. Замените пользовательское имя свойства на имя и параметры свойства CircleOffset.

#### <a name="to-add-the-circleoffset-custom-property-using-the-add-property-wizard"></a>Добавление пользовательского свойства CircleOffset с помощью мастера свойств добавления

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. Из меню ярлыка, нажмите **Добавить,** а затем нажмите **Добавить свойство**.

   Это открывает [Мастер свойств добавления.](../ide/names-add-property-wizard.md)

1. В поле **имени свойства** введите *CircleOffset*.

1. В поле **Тип реализации**выберите **Методы Get/Set**.

1. В поле **Типа свойства** выберите **короткий**.

1. Введите уникальные имена для функций Get and Set или примите имена по умолчанию.

1. Нажмите кнопку **Готово**.

## <a name="add-property-wizard-changes-for-custom-properties"></a><a name="_core_classwizard_changes_for_custom_properties"></a>Добавление изменений мастера свойств для пользовательских свойств

При добавлении пользовательского свойства CircleOffset Мастер свойств добавляет изменения в заголовок (. H) и реализации (. CPP) файлы класса управления.

Следующие строки добавляются в . H файл, чтобы `GetCircleOffset` объявить две функции называется и `SetCircleOffset`:

[!code-cpp[NVC_MFC_AxUI#25](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_1.h)]

Следующая строка добавляется к элементу управления. IDL файл:

[!code-cpp[NVC_MFC_AxUI#26](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_2.idl)]

Эта строка присваивает свойству CircleOffset определенный идентификационный номер, взятый из позиции метода в списке методов и свойств мастера свойств Добавления.

Кроме того, следующая строка добавляется к карте отправки (в . Файл CPP класса управления) для отображения свойства CircleOffset к двум функциям обработчика управления:

[!code-cpp[NVC_MFC_AxUI#27](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_3.cpp)]

Наконец, реализации `GetCircleOffset` и `SetCircleOffset` функции добавляются к концу элемента управления . Файл CPP. В большинстве случаев вы измените функцию Get, чтобы вернуть стоимость свойства. Функция Set обычно содержит код, который должен быть выполнен либо до, либо после изменения свойства.

[!code-cpp[NVC_MFC_AxUI#28](../mfc/codesnippet/cpp/mfc-activex-controls-adding-custom-properties_4.cpp)]

Обратите внимание, что Мастер свойств добавления автоматически добавляет вызов, чтобы [SetModifiedFlag](../mfc/reference/colecontrol-class.md#setmodifiedflag), к телу функции Набора. Вызов этой функции отметок элемента управления как измененный. Если элемент управления был изменен, его новое состояние будет сохранено при сохранении контейнера. Эта функция должна вызываться всякий раз, когда свойство, сохраненное как часть постоянного состояния элемента управления, изменяет значение.

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Элементы ActiveX в MFC. Свойства](../mfc/mfc-activex-controls-properties.md)<br/>
[Элементы ActiveX в MFC. Методы](../mfc/mfc-activex-controls-methods.md)<br/>
[Класс COleControl](../mfc/reference/colecontrol-class.md)
