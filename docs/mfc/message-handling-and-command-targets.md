---
title: Обработка сообщений и цели команд
ms.date: 11/04/2016
f1_keywords:
- IOleCommandTarget
helpviewer_keywords:
- command targets [MFC]
- message handling [MFC], active documents
- IOleCommandTarget interface [MFC]
- command routing [MFC], command targets
ms.assetid: e45ce14c-e6b6-4262-8f3b-4e891e0ec2a3
ms.openlocfilehash: cbcbce1e476fef0d076f9c25b46b3166c1eb5935
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84624352"
---
# <a name="message-handling-and-command-targets"></a>Обработка сообщений и цели команд

Интерфейс диспетчеризации команд `IOleCommandTarget` определяет простой и расширяемый механизм запроса и выполнения команд. Этот механизм проще, чем Автоматизация, `IDispatch` поскольку он полностью основывается на стандартном наборе команд; команды редко имеют аргументы, и сведения о типе не участвуют (безопасность типов также уменьшается для аргументов команды).

В структуре интерфейса диспетчера команд каждая команда принадлежит к «группе команд», которая сама по себе идентифицируется с помощью **идентификатора GUID**. Таким образом, любой пользователь может определить новую группу и определить все команды в этой группе без необходимости координации с корпорацией Майкрософт или любым другим поставщиком. (По сути, это те же средства определения, что и **disp-интерфейс** и **идентификаторы DISPID** в службе автоматизации. Здесь существует перекрытие, хотя этот механизм маршрутизации команд предназначен только для маршрутизации команд, а не для создания сценариев и программирования на больших масштабах в качестве дескрипторов автоматизации.)

`IOleCommandTarget`обрабатывает следующие сценарии:

- Когда объект активируется на месте, обычно отображаются только панели инструментов объекта, а на панелях инструментов объекта могут быть кнопки для некоторых команд контейнера, таких как **Печать**, **Предварительный просмотр**, **Сохранение**, **Создание**, **масштаб**и другие. (Стандарты активации на месте рекомендуют, чтобы объекты удалили такие кнопки с панелей инструментов или хотя бы их отключить. Такая схема позволяет включить эти команды и, однако, перенаправлять их в правый обработчик.) В настоящее время нет механизма для отправки этих команд в контейнер.

- Когда активный документ внедряется в контейнер активного документа (например, в Office BINDER), контейнеру может потребоваться отправить в автономный документ такие команды, как **Печать**, **Параметры страницы**, **Свойства**и другие.

Эту простую маршрутизацию команд можно обработать с помощью существующих стандартов автоматизации и `IDispatch` . Однако накладные расходы, связанные с, больше не `IDispatch` требуются здесь, поэтому `IOleCommandTarget` предоставляют более простые средства для достижения того же конца:

```
interface IOleCommandTarget : IUnknown
    {
    HRESULT QueryStatus(
        [in] GUID *pguidCmdGroup,
        [in] ULONG cCmds,
        [in,out][size_is(cCmds)] OLECMD *prgCmds,
        [in,out] OLECMDTEXT *pCmdText);
    HRESULT Exec(
        [in] GUID *pguidCmdGroup,
        [in] DWORD nCmdID,
        [in] DWORD nCmdExecOpt,
        [in] VARIANTARG *pvaIn,
        [in,out] VARIANTARG *pvaOut);
    }
```

`QueryStatus`Метод здесь проверяет, поддерживается ли определенный набор команд, который идентифицируется с помощью **идентификатора GUID**. Этот вызов заполняет массив значений **олекмд** (структур) с помощью поддерживаемого списка команд, а также возвращает текст, описывающий имя команды и/или сведения о состоянии. Когда вызывающий объект хочет вызвать команду, он может передать команду (и **идентификатор GUID**) `Exec` вместе с параметрами и аргументами, получая возвращаемое значение.

## <a name="see-also"></a>См. также раздел

[Контейнеры активных документов](active-document-containers.md)
