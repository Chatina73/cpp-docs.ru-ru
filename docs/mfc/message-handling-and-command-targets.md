---
title: Обработка сообщений и цели команд
ms.date: 11/04/2016
f1_keywords:
- IOleCommandTarget
helpviewer_keywords:
- command targets [MFC]
- message handling [MFC], active documents
- IOleCommandTarget interface [MFC]
- command routing [MFC], command targets
ms.assetid: e45ce14c-e6b6-4262-8f3b-4e891e0ec2a3
ms.openlocfilehash: f9212e32605a1fed179c931d4f63833e17870b5c
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50442540"
---
# <a name="message-handling-and-command-targets"></a>Обработка сообщений и цели команд

Интерфейс диспетчеризации команд `IOleCommandTarget` определяет простой и расширяемый механизм для запроса и выполнения команд. Этот механизм проще, чем автоматизации `IDispatch` так, как он полностью зависит от стандартный набор команд, в команды редко имеют аргументы, и сведения о типе не участвует (безопасность типа позволяет уменьшить также аргументов командной строки).

В конструктор интерфейса диспетчеризации команд, каждая команда принадлежит «группу команд» определяемым с **GUID**. Таким образом любой пользователь может определить новую группу и определить все команды в этой группе без необходимости в координации с корпорацией Майкрософт или любого другого поставщика. (Это по сути средств определения как **disp-интерфейс** , а также **идентификаторы DISPID** в службе автоматизации. Есть, несмотря на то, что этот механизм маршрутизации команды — только для маршрутизации команд, а не для сценариев и программирования на больших масштабах как дескрипторы автоматизации.)

`IOleCommandTarget` обрабатывает следующие сценарии:

- Когда объект будет активироваться только обычно отображаются объекта панели инструментов и панели инструментов объекта может иметь кнопки для некоторых команд контейнера, как на месте **печати**, **Предварительный просмотр печати**,  **Сохранить**, **New**, **масштаб**и другие. (Активация на месте, рекомендуем стандартов, объекты удалить эти кнопки в своих панелях инструментов или в бы их отключить. Такой подход позволяет этих команд, чтобы включить и еще направляются правильного обработчика). В настоящее время отсутствует механизм для объекта для отправки этих команд в контейнер.

- При активном документе внедряется в контейнер активного документа (например, Office Binder), контейнер может потребоваться отправлять команды таких **печати**, **параметры страницы**, **свойства**и другим пользователям в автономной активный документ.

Эта простая команда маршрутизация может обрабатываться с помощью существующих стандартов автоматизации и `IDispatch`. Тем не менее, издержки заниматься `IDispatch` больше, чем необходимо, чтобы `IOleCommandTarget` предоставляет простые средства для достижения те же самые задачи:

```
interface IOleCommandTarget : IUnknown
    {
    HRESULT QueryStatus(
        [in] GUID *pguidCmdGroup,
        [in] ULONG cCmds,
        [in,out][size_is(cCmds)] OLECMD *prgCmds,
        [in,out] OLECMDTEXT *pCmdText);
    HRESULT Exec(
        [in] GUID *pguidCmdGroup,
        [in] DWORD nCmdID,
        [in] DWORD nCmdExecOpt,
        [in] VARIANTARG *pvaIn,
        [in,out] VARIANTARG *pvaOut);
    }
```

`QueryStatus` Здесь метод проверяет, является ли определенный набор команд, набор выявлены с **GUID**, поддерживается. Этот вызов заполняет массив **OLECMD, ОПРЕДЕЛЯЮЩИХ** значений (структуры) со списком поддерживаемых команд, а также возвращает текст, описывающий имя команды или состоянии сведения. Когда вызывающий объект хочет вызвать команду, он может передать команду (и набора **GUID**) для `Exec` а также параметры и аргументы, получение возвращаемого значения.

## <a name="see-also"></a>См. также

[Контейнеры активных документов](../mfc/active-document-containers.md)

