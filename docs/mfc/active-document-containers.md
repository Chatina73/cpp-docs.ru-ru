---
title: Контейнеры активных документов
ms.date: 11/19/2018
helpviewer_keywords:
- active documents [MFC], containers
- active document containers [MFC]
- containers [MFC], active document
- MFC COM, active document containment
ms.assetid: ba20183a-8b4c-440f-9031-e5fcc41d391b
ms.openlocfilehash: e2005ffed592fa1de278e0f6339d94687a20fd06
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81377385"
---
# <a name="active-document-containers"></a>Контейнеры активных документов

Активный контейнер документов, такой как Microsoft Office Binder или Internet Explorer, позволяет работать с несколькими документами различных типов приложений в пределах одного кадра (вместо того, чтобы заставлять вас создавать и использовать несколько кадров приложений для каждого типа документа).

MFC обеспечивает полную поддержку активных контейнеров документов в `COleDocObjectItem` классе. Мастер приложения MFC можно использовать для создания активного контейнера документов, выбрав флажок **контейнера Active document** на странице **поддержки соединения** приложения Мастера приложения MFC. Для получения дополнительной информации [см.](../mfc/creating-an-active-document-container-application.md)

Для получения дополнительной информации об активных контейнерах документов см.:

- [Требования к контейнерам](#container_requirements)

- [Объекты сайта документов](#document_site_objects)

- [Просмотр объектов сайта](#view_site_objects)

- [Объект кадра](#frame_object)

- [Слияние меню "Справка"](../mfc/help-menu-merging.md)

- [Программная печать](../mfc/programmatic-printing.md)

- [Целевые объекты команд](../mfc/message-handling-and-command-targets.md)

## <a name="container-requirements"></a><a name="container_requirements"></a>Требования к контейнерам

Активная поддержка документов в активном контейнере документов подразумевает не только реализации интерфейсов: она также требует знания использования интерфейсов содержащегося объекта. То же самое относится и к активным расширениям документов, где контейнер должен также знать, как использовать эти интерфейсы расширения на самих активных документах.

Активный контейнер документов, объединяющий активные документы, должен:

- Быть способным обрабатывать объект `IPersistStorage` хранения через интерфейс, то `IStorage` есть он должен предоставить экземпляр для каждого активного документа.

- Поддержка основных функций встраивания документов OLE, требующих "сайт" объектов (по `IOleClientSite` `IAdviseSink`одному на документ или встраивание), которые реализуют и .

- Поддержка активации встроенных объектов или активных документов. Объекты сайта контейнера `IOleInPlaceSite` должны реализовываться, `IOleInPlaceFrame`а объект кадра контейнера должен обеспечивать.

- Поддержка расширения активных документов `IOleDocumentSite` путем реализации, чтобы обеспечить механизм для контейнера, чтобы поговорить с документом. В качестве опционов контейнер может `IOleCommandTarget` реализовывать интерфейсы активных документов и `IContinueCallback` подбирать простые команды, такие как печать или сохранение.

Объект кадра, объекты представления и контейнерный `IOleCommandTarget` объект могут дополнительно реализовать для поддержки отправки определенных команд, как это обсуждается в [командных целях.](../mfc/message-handling-and-command-targets.md) Просмотр и контейнерные объекты `IPrint` `IContinueCallback`также могут дополнительно реализовывать и поддерживать программную печать, как это обсуждается в [Программной печати.](../mfc/programmatic-printing.md)

Следующая цифра показывает концептуальные отношения между контейнером и его компонентами (слева), а также активный документ и его взгляды (справа). Активный документ управляет хранением и данными, а представление отображает или дополнительно печатает эти данные. Интерфейсы жирным шрифтом являются теми, которые необходимы для активного участия документов; те, смелые и курсивом являются необязательными. Все остальные интерфейсы необходимы.

![Интерфейсы контейнера активного документа](../mfc/media/vc37gj1.gif "Интерфейсы контейнера активного документа")

Документ, поддерживающий только одно представление, может реализовать компоненты представления и документа (т.е. соответствующие интерфейсы) на одном конкретном классе. Кроме того, контейнерная площадка, которая поддерживает только один вид за один раз, может объединить сайт документа и сайт представления в единый класс конкретного участка. Однако объект кадра контейнера должен оставаться четким, а компонент документа контейнера просто включен здесь, чтобы дать полную картину архитектуры; она не зависит от активной архитектуры сдерживания документов.

## <a name="document-site-objects"></a><a name="document_site_objects"></a>Объекты сайта документов

В архитектуре активного хранения документов сайт документа такой же, как объект сайта `IOleDocument` клиента в ДОКУМЕНТАх OLE с добавлением интерфейса:

```cpp
interface IOleDocumentSite : IUnknown
{
    HRESULT ActivateMe(IOleDocumentView *pViewToActivate);
}
```

Сайт документа концептуально является контейнером для одного или нескольких объектов "сайта просмотра". Каждый объект сайта просмотра связан с отдельными объектами просмотра документа, управляемым сайтом документа. Если контейнер поддерживает только одно представление на сайте документа, то он может реализовать сайт документа и сайт представления с одним конкретным классом.

## <a name="view-site-objects"></a><a name="view_site_objects"></a>Просмотр объектов сайта

Объект сайта просмотра контейнера управляет пространством отображения для определенного представления документа. В дополнение к поддержке стандартного `IOleInPlaceSite` интерфейса, `IContinueCallback` сайт представления также обычно реализует для программного управления печатью. (Обратите внимание, что объект `IContinueCallback` представления никогда не запрашивает, чтобы он мог быть реализован на любом объекте, который желает контейнер.)

Контейнер, поддерживающий несколько представлений, должен быть в состоянии создать несколько объектов сайта представления в сайте документа. Это обеспечивает каждое представление с отдельными `IOleInPlaceSite`службами активации и деактивации, как это предусмотрено через .

## <a name="frame-object"></a><a name="frame_object"></a>Объект кадра

Объект кадра контейнера, по большей части, тот же кадр, который используется для активации на месте в документах OLE, то есть тот, который обрабатывает меню и переговоры панели инструментов. A view object has access to this frame object through `IOleInPlaceSite::GetWindowContext`, which also provides access to the container object representing the container document (which can handle pane-level toolbar negotiation and contained object enumeration).

Активный контейнер документов может увеличить `IOleCommandTarget`кадр, добавив. Это позволяет ему получать команды, которые исходят из пользовательского интерфейса активного документа таким же образом, что этот интерфейс может позволить контейнеру отправлять те же команды (например, **File New,** **Open**, **Save As**, **Print**; **Отменить копию**, **вставить**, **отменить**, и другие) к активному документу. Для получения дополнительной информации [см.](../mfc/message-handling-and-command-targets.md)

## <a name="see-also"></a>См. также раздел

[Вложение активного документа](../mfc/active-document-containment.md)
