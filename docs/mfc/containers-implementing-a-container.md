---
title: Контейнеры. Реализация контейнера
ms.date: 11/04/2016
helpviewer_keywords:
- applications [OLE], OLE container
- OLE containers [MFC], implementing
ms.assetid: af1e2079-619a-4eac-9327-985ad875823a
ms.openlocfilehash: 0ba8d4aea6b69fdbfeedfba59449d0d30433eb94
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84623229"
---
# <a name="containers-implementing-a-container"></a>Контейнеры. Реализация контейнера

В этой статье описывается процедура реализации контейнера и указываются другие статьи с более подробными пояснениями о реализации контейнеров. Здесь также перечислены некоторые необязательные функции OLE, которые можно реализовать, и статьи, описывающие эти функции.

#### <a name="to-prepare-your-cwinapp-derived-class"></a>Подготовка класса, производного от CWinApp

1. Инициализируйте библиотеки OLE, вызвав `AfxOleInit` в `InitInstance` функции члена.

1. Вызовите `CDocTemplate::SetContainerInfo` в `InitInstance` , чтобы назначить ресурсы меню и ускорителя, используемые при активации внедренного элемента на месте. Дополнительные сведения об этом разделе см. в разделе [Активация](activation-cpp.md).

Эти функции предоставляются автоматически при использовании мастера приложений MFC для создания приложения-контейнера. См. раздел [Создание программы MFC exe](reference/mfc-application-wizard.md).

#### <a name="to-prepare-your-view-class"></a>Подготовка класса представления

1. Следите за выбранными элементами, сохраняя указатель или список указателей, если в выбранных элементах поддерживается множественный выбор. `OnDraw`Функция должна рисовать все элементы OLE.

1. Переопределите, `IsSelected` чтобы проверить, выбран ли в данный момент элемент, переданный в него.

1. Реализуйте `OnInsertObject` обработчик сообщений для вывода диалогового окна « **Вставка объекта** ».

1. Реализуйте `OnSetFocus` обработчик сообщений для перемещения фокуса из представления в активный внедренный элемент OLE на месте.

1. Реализуйте `OnSize` обработчик сообщений для информирования внедренного элемента OLE о том, что ему нужно изменить его прямоугольник, чтобы отразить изменение размера содержащего его представления.

Поскольку реализация этих функций сильно зависит от приложения, мастер приложений предоставляет только базовую реализацию. Скорее всего, потребуется настроить эти функции, чтобы приложение работало правильно. Пример см. в примере [контейнера](../overview/visual-cpp-samples.md) .

#### <a name="to-handle-embedded-and-linked-items"></a>Для управления внедренными и связанными элементами

1. Создайте класс, производный от [COleClientItem](reference/coleclientitem-class.md). Объекты этого класса представляют элементы, внедренные в документ OLE или связанные с ним.

1. Переопределите `OnChange` , `OnChangeItemPosition` и `OnGetItemPosition` . Эти функции обработают изменение размеров, позиционирование и изменение внедренных и связанных элементов.

Мастер приложений будет наследовать класс, но, скорее всего, потребуется переопределение `OnChange` и другие функции, перечисленные в шаге 2 в предыдущей процедуре. Для большинства приложений необходимо настроить схему реализации, так как эти функции реализуются по-разному в разных приложениях. Примеры см. в примерах MFC: [DRAWCLI](../overview/visual-cpp-samples.md) и [Container](../overview/visual-cpp-samples.md).

Для поддержки OLE необходимо добавить ряд элементов в структуру меню приложения-контейнера. Дополнительные сведения см. в разделе [меню и ресурсы: Добавление контейнеров](menus-and-resources-container-additions.md).

Кроме того, может потребоваться поддержка некоторых из следующих функций в приложении контейнера:

- Активация на месте при редактировании внедренного элемента.

   Дополнительные сведения см. в разделе [Активация](activation-cpp.md).

- Создание объектов OLE путем перетаскивания выделенного фрагмента из серверного приложения.

   Дополнительные сведения см. в разделе [перетаскивание OLE](drag-and-drop-ole.md).

- Ссылки на внедренные объекты или сочетания приложений контейнеров и серверов.

   Дополнительные сведения см. в разделе [Containers: Advanced Features](containers-advanced-features.md).

## <a name="see-also"></a>См. также раздел

[Контейнеры](containers.md)<br/>
[Контейнеры. Элементы клиентов](containers-client-items.md)
