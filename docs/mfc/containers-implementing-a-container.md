---
title: Контейнеры. Реализация контейнера
ms.date: 11/04/2016
helpviewer_keywords:
- applications [OLE], OLE container
- OLE containers [MFC], implementing
ms.assetid: af1e2079-619a-4eac-9327-985ad875823a
ms.openlocfilehash: b0d737a2025ed0006db00425d42c02ebf0bdeda8
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62302206"
---
# <a name="containers-implementing-a-container"></a>Контейнеры. Реализация контейнера

В этой статье приведены процедуры для реализация контейнера и указываются на другие статьи, которые содержат более подробные объяснения о реализации контейнеров. Он также перечисляет некоторые дополнительные компоненты OLE, которые могут потребоваться для реализации и статьи, описывающие эти функции.

#### <a name="to-prepare-your-cwinapp-derived-class"></a>Чтобы подготовить класс производным от CWinApp

1. Инициализация библиотек OLE, вызвав `AfxOleInit` в `InitInstance` функция-член.

1. Вызовите `CDocTemplate::SetContainerInfo` в `InitInstance` для назначения в меню и сочетаний клавиш ресурсы, используемые при внедренного элемента активации на месте. Дополнительные сведения по этой теме см. в разделе [активации](../mfc/activation-cpp.md).

Эти функции предоставляются для вас автоматически при использовании мастера приложений MFC для создания приложения-контейнера. См. в разделе [создание программы MFC EXE](../mfc/reference/mfc-application-wizard.md).

#### <a name="to-prepare-your-view-class"></a>Чтобы подготовить класс представления

1. Хранить список выбранных элементов путем сохранения указателя, или список указателей, если поддерживает выбор нескольких элементов, выбранных элементов. Ваш `OnDraw` функции необходимо рисовать все элементы OLE.

1. Переопределить `IsSelected` для проверки, выделен ли элемент, переданный в него в данный момент.

1. Реализуйте `OnInsertObject` обработчик сообщений для отображения **вставить объект** диалоговое окно.

1. Реализуйте `OnSetFocus` обработчик для передачи фокуса в представлении active OLE на месте внедренный элемент сообщения.

1. Реализуйте `OnSize` обработчик сообщений для информирования OLE внедренных элементов, ему необходимо изменить его прямоугольником, в соответствии с изменениями в размере его содержащего просмотра.

Так как реализации этих функций значительно меняется от приложения к приложению, мастер приложений предоставляет только базовую реализацию. Вероятно, придется настроить эти функции, чтобы заставить приложение работать правильно. Пример этого см. в разделе [КОНТЕЙНЕРА](../overview/visual-cpp-samples.md) образца.

#### <a name="to-handle-embedded-and-linked-items"></a>Для обработки внедренные и связанные элементы

1. Наследуйте класс от [COleClientItem](../mfc/reference/coleclientitem-class.md). Объекты этого класса представляют элементы, которые внедрены в, или связанного документа OLE.

1. Переопределить `OnChange`, `OnChangeItemPosition`, и `OnGetItemPosition`. Эти функции обрабатывают изменения размера, позиционирование и изменение внедренные и связанные элементы.

В мастере приложений будет создать производный класс для вас, но вы скорее всего, потребуется переопределить `OnChange` и другие функции, перечисленные с ним на шаге 2 предыдущей процедуры. Скелет реализации должны настраиваться для большинства приложений, так как эти функции реализуются по-разному из одного приложения к другому. В качестве примера, см. в примерах MFC [ФУНКЦИЙ](../overview/visual-cpp-samples.md) и [КОНТЕЙНЕРА](../overview/visual-cpp-samples.md).

Число элементов необходимо добавить к структуре меню приложения-контейнера для поддержки OLE. Дополнительные сведения см. в разделе [меню и ресурсы: Добавление контейнеров](../mfc/menus-and-resources-container-additions.md).

Можно также поддерживает некоторые из следующих компонентов в приложении контейнера:

- Активация на месте при редактировании внедренного элемента.

   Дополнительные сведения см. в разделе [активации](../mfc/activation-cpp.md).

- Создание объекта OLE элементы с помощью перетаскивания выделения из серверного приложения.

   Дополнительные сведения см. в разделе [Drag and Drop (OLE)](../mfc/drag-and-drop-ole.md).

- Ссылки на внедренные объекты или сочетание контейнера и сервера приложений.

   Дополнительные сведения см. в разделе [контейнеров: Дополнительные возможности](../mfc/containers-advanced-features.md).

## <a name="see-also"></a>См. также

[Контейнеры](../mfc/containers.md)<br/>
[Контейнеры. Элементы клиентов](../mfc/containers-client-items.md)
