---
title: Контейнеры. Реализация контейнера
ms.date: 11/04/2016
helpviewer_keywords:
- applications [OLE], OLE container
- OLE containers [MFC], implementing
ms.assetid: af1e2079-619a-4eac-9327-985ad875823a
ms.openlocfilehash: ed95324b8df978a6ab2f7582c0ddf626a45e7fe1
ms.sourcegitcommit: a8ef52ff4a4944a1a257bdaba1a3331607fb8d0f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/11/2020
ms.locfileid: "77127924"
---
# <a name="containers-implementing-a-container"></a>Контейнеры. Реализация контейнера

В этой статье описывается процедура реализации контейнера и указываются другие статьи с более подробными пояснениями о реализации контейнеров. Здесь также перечислены некоторые необязательные функции OLE, которые можно реализовать, и статьи, описывающие эти функции.

#### <a name="to-prepare-your-cwinapp-derived-class"></a>Подготовка класса, производного от CWinApp

1. Инициализируйте библиотеки OLE путем вызова `AfxOleInit` в функции члена `InitInstance`.

1. Вызовите `CDocTemplate::SetContainerInfo` в `InitInstance`, чтобы назначить ресурсы меню и ускорителя, используемые при активации внедренного элемента на месте. Дополнительные сведения об этом разделе см. в разделе [Активация](../mfc/activation-cpp.md).

Эти функции предоставляются автоматически при использовании мастера приложений MFC для создания приложения-контейнера. См. раздел [Создание программы MFC exe](../mfc/reference/mfc-application-wizard.md).

#### <a name="to-prepare-your-view-class"></a>Подготовка класса представления

1. Следите за выбранными элементами, сохраняя указатель или список указателей, если в выбранных элементах поддерживается множественный выбор. Функция `OnDraw` должна рисовать все объекты OLE.

1. Переопределите `IsSelected`, чтобы проверить, выбран ли в данный момент элемент, переданный в него.

1. Реализуйте обработчик сообщений `OnInsertObject` для вывода диалогового окна « **Вставка объекта** ».

1. Реализуйте обработчик сообщений `OnSetFocus`, чтобы передать фокус из представления в активный внедренный элемент OLE на месте.

1. Реализуйте обработчик сообщений `OnSize` для информирования внедренного элемента OLE о том, что ему нужно изменить его прямоугольник, чтобы отразить изменение размера содержащего его представления.

Поскольку реализация этих функций сильно зависит от приложения, мастер приложений предоставляет только базовую реализацию. Скорее всего, потребуется настроить эти функции, чтобы приложение работало правильно. Пример см. в примере [контейнера](../overview/visual-cpp-samples.md) .

#### <a name="to-handle-embedded-and-linked-items"></a>Для управления внедренными и связанными элементами

1. Создайте класс, производный от [COleClientItem](../mfc/reference/coleclientitem-class.md). Объекты этого класса представляют элементы, внедренные в документ OLE или связанные с ним.

1. Переопределите `OnChange`, `OnChangeItemPosition`и `OnGetItemPosition`. Эти функции обработают изменение размеров, позиционирование и изменение внедренных и связанных элементов.

Мастер приложений будет наследовать класс, но, скорее всего, потребуется переопределить `OnChange` и другие функции, перечисленные в шаге 2 в предыдущей процедуре. Для большинства приложений необходимо настроить схему реализации, так как эти функции реализуются по-разному в разных приложениях. Примеры см. в примерах MFC: [DRAWCLI](../overview/visual-cpp-samples.md) и [Container](../overview/visual-cpp-samples.md).

Для поддержки OLE необходимо добавить ряд элементов в структуру меню приложения-контейнера. Дополнительные сведения см. в разделе [меню и ресурсы: Добавление контейнеров](../mfc/menus-and-resources-container-additions.md).

Кроме того, может потребоваться поддержка некоторых из следующих функций в приложении контейнера:

- Активация на месте при редактировании внедренного элемента.

   Дополнительные сведения см. в разделе [Активация](../mfc/activation-cpp.md).

- Создание объектов OLE путем перетаскивания выделенного фрагмента из серверного приложения.

   Дополнительные сведения см. в разделе [перетаскивание OLE](../mfc/drag-and-drop-ole.md).

- Ссылки на внедренные объекты или сочетания приложений контейнеров и серверов.

   Дополнительные сведения см. в разделе [Containers: Advanced Features](../mfc/containers-advanced-features.md).

## <a name="see-also"></a>См. также раздел

[Контейнеры](../mfc/containers.md)<br/>
[Контейнеры. Элементы клиентов](../mfc/containers-client-items.md)
