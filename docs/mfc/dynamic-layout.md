---
title: Динамический макет
ms.date: 09/09/2019
ms.assetid: 8598cfb2-c8d4-4f5a-bf2b-59dc4653e042
ms.openlocfilehash: 3108e7bae0be216dfb877d03c87fdc17ef7d69f2
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84624754"
---
# <a name="dynamic-layout"></a>Динамический макет

С помощью MFC в Visual Studio 2015 можно создавать диалоговые окна, размер которых может изменить пользователь, и можно управлять способом настройки макета на изменение размера. Например, можно присоединить кнопки, которые находятся в нижней части диалогового окна, к нижней границе, чтобы они всегда находились в нижней части окна. Также можно настроить некоторые элементы управления, например списки, поля ввода и текстовые поля, таким образом, чтобы они развертывались, когда пользователь увеличивает размер диалогового окна.

## <a name="specifying-dynamic-layout-settings-for-an-mfc-dialog-box"></a>Задание параметров динамического макета в диалоговом окне MFC

Если пользователь изменяет размер диалогового окна, элементы управления в диалоговом окне могут изменить свой размер или перемещаться в направлении осей X и Y. Изменение размера или положения элемента управления, когда пользователь изменяет размер диалогового окна, называется динамическим макетом. Например, ниже показано диалоговое окно до изменения его размера.

![Диалоговое окно, отображающееся до изменения размера.](../mfc/media/mfcdynamiclayout4.png "Диалоговое окно, отображающееся до изменения размера.")

После изменения размера область списка увеличивается для отображения большего количества элементов, а кнопки перемещаются вместе с правым нижним углом.

![Диалоговое окно, отображающееся после изменения размера.](../mfc/media/mfcdynamiclayout5.png "Диалоговое окно, отображающееся после изменения размера.")

Вы можете управлять динамическим макетом, указав сведения для каждого элемента управления в редакторе ресурсов в интегрированной среде разработки, или это можно сделать программно, обратившись к `CMFCDynamicLayout` объекту для определенного элемента управления и задавая свойства.

### <a name="setting-dynamic-layout-properties-in-the-resource-editor"></a>Задание свойств динамического макета в редакторе ресурсов

Поведение динамического макета для диалогового окна можно задать без написания кода, а с помощью редактора ресурсов.

#### <a name="to-set-dynamic-layout-properties-in-the-resource-editor"></a>Задание свойств динамического макета в редакторе ресурсов

1. Откройте проект MFC, затем откройте диалоговое окно, с которым необходимо работать в редакторе диалоговых окон.

   ![Откройте диалоговое окно в редакторе ресурсов.](../mfc/media/mfcdynamiclayout3.png "Откройте диалоговое окно в редакторе ресурсов.")

1. Выберите элемент управления и в окне **Свойства** (в **представление классов**) задайте его динамическое свойство макета. Раздел **динамического макета** в окне **свойства** содержит свойства, которые **перемещают тип**, **Тип размера**и, в зависимости от значений, выбранных для этих свойств, конкретные свойства, определяющие, сколько элементов управления перемещает или изменяет размер. **Перемещение типа** определяет, как перемещается элемент управления при изменении размера диалогового окна. **Тип размера** определяет способ изменения размера элемента управления при изменении размера диалогового окна. Тип **перемещения** и **тип изменения** могут быть **горизонтальными**, **вертикальными**, **обоими**или **нет** в зависимости от измерений, которые необходимо динамически изменить. «Горизонтально» относится к оси X, а «Вертикально» — к оси Y.

1. Если требуется, чтобы элемент управления, например кнопка, был фиксированного размера и остаться в правом нижнем углу, как обычно для кнопок **ОК** или **Отмена** , задайте для параметра **Размер** значение значение **нет**и задайте для параметра **тип перемещения** значение **оба**. Для **перемещения X** и **перемещения значений Y** в разделе **Перемещение типа**задайте 100%, чтобы элемент управления оставался фиксированным расстоянием от нижнего правого угла.

   ![Динамический макет](../mfc/media/mfcdynamiclayout1.png "Динамический макет")

1. Предположим, что у вас также есть элемент управления, который должен увеличиваться при расширении диалогового окна. Как правило, пользователь может развернуть диалоговое окно для увеличения размера многострочного поля ввода, чтобы увеличить размер текстового поля, или же развернуть элемент управления списком, чтобы увидеть больше данных. В этом случае задайте для **типа изменения размера** значение и задайте для параметра **тип перемещения** значение нет. Затем задайте для параметров **Размер X** и **размер Y** значение 100.

   ![Параметры динамического макета](../mfc/media/mfcdynamiclayout2.png "Параметры динамического макета")

1. Попробуйте ввести другие значения, которые могут быть применимы для элементов управления. Для диалогового окна с однострочным текстовым полем может быть выбран **Тип размера** только **Горизонтальный** , например.

### <a name="setting-dynamic-layout-properties-programmatically"></a>Задание свойств динамического макета программным образом

Описанную выше процедуру можно использовать для задания свойств динамического макета диалогового окна на этапе разработки. Но, если вы хотите управлять динамическим макетом во время выполнения, свойства динамического макета можно задавать программным образом.

#### <a name="to-set-dynamic-layout-properties-programmatically"></a>Задание свойств динамического макета программным образом

1. Найдите или создайте место в коде реализации класса своего диалогового окна, где необходимо задать динамический макет для диалогового окна. Например, можно добавить метод, например `AdjustLayout` в диалоговом окне, и вызывать его из тех мест, где будет необходимо изменять макет. Можно выполнить вызов из конструктора сначала или же после внесения изменений в диалоговое окно.

1. Для диалогового окна вызовите [жетдинамиклайаут](reference/cwnd-class.md#getdynamiclayout), метод `CWnd` класса. `GetDynamicLayout` возвращает указатель на объект `CMFCDynamicLayout` .

    ```cpp
    CMFCDynamicLayout* dynamicLayout = pDialog->GetDynamicLayout();
    ```

1. Для первого элемента управления, к которому необходимо добавить динамическое поведение, используйте статические методы класса динамического макета, чтобы создать структуру [MoveSettings](reference/cmfcdynamiclayout-class.md#movesettings_structure) , которая кодирует способ корректировки элемента управления. Для этого сначала нужно выбрать соответствующий статический метод: [CMFCDynamicLayout:: мовехоризонтал](reference/cmfcdynamiclayout-class.md#movehorizontal), [CMFCDynamicLayout:: мовевертикал](reference/cmfcdynamiclayout-class.md#movevertical), [CMFCDynamicLayout:: Мовеноне](reference/cmfcdynamiclayout-class.md#movenone)или [CMFCDynamicLayout:: мовехоризонталандвертикал](reference/cmfcdynamiclayout-class.md#movehorizontalandvertical). Вы передаете процентное соотношение для перемещения по горизонтали или по вертикали. Эти статические методы возвращают вновь созданный объект MoveSettings, который можно использовать для задания поведения перемещения элемента управления.

   Помните, что 100 означает перемещение на столько же, на сколько диалоговое окно изменяет свой размер. При этом край элемента управления будет оставаться на фиксированном расстоянии от новой границы.

    ```cpp
    MoveSettings moveSettings = CMFCDynamicLayout::MoveHorizontal(100);
    ```

1. Сделайте то же самое для поведения размера, в котором используется тип [SizeSettings](reference/cmfcdynamiclayout-class.md#sizesettings_structure) . Например, чтобы указать, что элемент управления не изменяет размер при изменении размера диалогового окна, используйте следующий код:

    ```cpp
    SizeSettings sizeSettings = CMFCDynamicLayout::SizeNone();
    ```

1. Добавьте элемент управления в Диспетчер динамического макета с помощью метода [CMFCDynamicLayout:: AddItem](reference/cmfcdynamiclayout-class.md#additem) . Для различных способов указания требуемого элемента управления предусмотрены две перегрузки. Одна использует дескриптор окна элемента управления (HWND), а другая — идентификатор элемента управления.

    ```cpp
    dynamicLayout->AddItem(hWndControl,
    moveSettings,
    sizeSettings);
    ```

1. Повторите для каждого элемента управления, который нужно переместить или для которого нужно изменить размер.

1. При необходимости может использовать метод [CMFCDynamicLayout:: хаситем](reference/cmfcdynamiclayout-class.md#hasitem) , чтобы определить, уже присутствует ли элемент управления в списке элементов управления, предназначенных для динамического изменения макета, или метод [CMFCDynamicLayout:: IsEmpty](reference/cmfcdynamiclayout-class.md#isempty) , чтобы определить наличие элементов управления, которые могут быть изменены.

1. Чтобы включить макет диалогового окна, вызовите метод [CWnd:: енаблединамиклайаут](reference/cwnd-class.md#enabledynamiclayout) .

    ```cpp
    pDialog->EnableDynamicLayout(TRUE);
    ```

1. В следующий раз, когда пользователь изменяет размер диалогового окна, вызывается метод [CMFCDynamicLayout::](reference/cmfcdynamiclayout-class.md#adjust) Resize, который фактически применяет параметры.

1. Если вы хотите отключить динамический макет, вызовите [CWnd:: енаблединамиклайаут](reference/cwnd-class.md#enabledynamiclayout) с **false** как для параметра *бенаблед* .

    ```cpp
    pDialog->EnableDynamicLayout(FALSE);
    ```

#### <a name="to-set-the-dynamic-layout-programmatically-from-a-resource-file"></a>Задание динамического макета программным образом из файла ресурсов

1. Используйте метод [CMFCDynamicLayout:: мовехоризонталандвертикал](reference/cmfcdynamiclayout-class.md#movehorizontalandvertical) , чтобы указать имя ресурса в соответствующем файле скрипта ресурсов (RC-файле), который указывает сведения о динамическом макете, как показано в следующем примере:

    ```cpp
    dynamicLayout->LoadResource("IDD_DIALOG1");
    ```

   Именованный ресурс должен ссылаться на диалоговое окно, содержащее сведения о макете в виде записи **AFX_DIALOG_LAYOUT** в файле ресурсов, как показано в следующем примере:

    ```RC
    /////////////////////////////////////////////////////////////////////////////
    //
    // AFX_DIALOG_LAYOUT
    //

    IDD_MFCAPPLICATION1_DIALOG AFX_DIALOG_LAYOUT
    BEGIN
    0x0000,
    0x6400,
    0x0028,
    0x643c,
    0x0028
    END

    IDD_DIALOG1 AFX_DIALOG_LAYOUT
    BEGIN
    0x0000,
    0x6464,
    0x0000,
    0x6464,
    0x0000,
    0x0000,
    0x6464,
    0x0000,
    0x0000

    END
    ```

## <a name="see-also"></a>См. также раздел

[Класс CMFCDynamicLayout](reference/cmfcdynamiclayout-class.md)<br/>
[Классы элементов управления](control-classes.md)<br/>
[Классы диалоговых окон](dialog-box-classes.md)<br/>
[Редактор диалоговых окон](../windows/dialog-editor.md)<br/>
[Динамический макет диалогового окна для MFC в Visual C++ 2015](https://mariusbancila.ro/blog/2015/07/27/dynamic-dialog-layout-for-mfc-in-visual-c-2015/)
