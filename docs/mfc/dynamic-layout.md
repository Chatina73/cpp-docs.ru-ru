---
title: Динамический макет
ms.date: 11/19/2018
ms.assetid: 8598cfb2-c8d4-4f5a-bf2b-59dc4653e042
ms.openlocfilehash: 396aad5b33a00021ddb5c1143c1d15c130e97eaa
ms.sourcegitcommit: 9e891eb17b73d98f9086d9d4bfe9ca50415d9a37
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/20/2018
ms.locfileid: "52175695"
---
# <a name="dynamic-layout"></a>Динамический макет

MFC в Visual Studio 2015 можно создавать диалоговые окна, которые пользователь может изменить размер и можно управлять способом перенастраивания макета в соответствии с изменениями размера. Например, можно присоединить кнопки, которые находятся в нижней части диалогового окна, к нижней границе, чтобы они всегда находились в нижней части окна. Также можно настроить некоторые элементы управления, например списки, поля ввода и текстовые поля, таким образом, чтобы они расширялись, когда пользователь увеличивает размер диалогового окна.

## <a name="specifying-dynamic-layout-settings-for-an-mfc-dialog-box"></a>Задание параметров динамического макета в диалоговом окне MFC

Если пользователь изменяет размер диалогового окна, элементы управления в диалоговом окне могут изменить свой размер или перемещаться в направлении осей X и Y. Изменение размера или положения элемента управления, когда пользователь изменяет размер диалогового окна, называется динамическим макетом. Например, ниже показано диалоговое окно до изменения его размера.

![Диалоговое окно до изменения его размера. ](../mfc/media/mfcdynamiclayout4.png "Диалоговое окно до изменения его размера.")

После изменения размера область списка увеличивается для отображения большего количества элементов, а кнопки перемещаются вместе с правым нижним углом.

![Диалоговое окно после изменения размера. ](../mfc/media/mfcdynamiclayout5.png "Диалоговое окно после изменения размера.")

Для управления динамическим макетом, указав сведения для каждого элемента управления в редакторе ресурсов в интегрированной среде разработки, или можно сделать программным образом путем доступа к `CMFCDynamicLayout` объекта для конкретного элемента управления и установки свойств.

### <a name="setting-dynamic-layout-properties-in-the-resource-editor"></a>Задание свойств динамического макета в редакторе ресурсов

Поведение динамического макета для диалогового окна можно задать без написания кода, а с помощью редактора ресурсов.

#### <a name="to-set-dynamic-layout-properties-in-the-resource-editor"></a>Задание свойств динамического макета в редакторе ресурсов

1. Откройте проект MFC, затем откройте диалоговое окно, с которым необходимо работать в редакторе диалоговых окон.

   ![Откройте диалоговое окно в редакторе ресурсов. ](../mfc/media/mfcdynamiclayout3.png "Откройте диалоговое окно в редакторе ресурсов.")

1. Выберите элемент управления и в окне свойств задайте для него свойства динамического макета. **Динамический макет** раздел в окне «Свойства» содержит свойства **тип перемещения**, **тип изменения размера**и в зависимости от значений, выбранных для этих свойств определенные свойства, которые определяют, сколько элементов управления перемещаются или изменяют размер. **Тип перемещения** определяет, каким образом перемещается элемент управления как при изменении размера диалогового окна; **Тип изменения размера** определяет способ изменения размеров элемента управления при изменении размера диалогового окна. **Тип перемещения** и **тип изменения размера** может быть **горизонтальной**, **вертикальной**, **оба**, или **None**зависимости от измерений, которые вы хотите динамически изменяться. «Горизонтально» относится к оси X, а «Вертикально» — к оси Y.

1. Если требуется, чтобы элемент управления, например кнопку, чтобы быть на фиксированный размер и останутся в силе в нижнем правом углу, как часто **ОК** или **отменить** набор кнопок, **тип изменения размера** для  **Нет**и задайте **тип перемещения** для **оба**. Для **перемещение по X** и **перемещение по Y** значения в разделе **тип перемещения**, установите 100% для перевода элемента управления, чтобы остаться на фиксированном расстоянии от нижней правом углу.

   ![Динамический макет](../mfc/media/mfcdynamiclayout1.png "динамический макет")

1. Предположим, что у вас также есть элемент управления, который должен увеличиваться при расширении диалогового окна. Как правило, пользователь может развернуть диалоговое окно для увеличения размера многострочного поля ввода, чтобы увеличить размер текстового поля, или же развернуть элемент управления списком, чтобы увидеть больше данных. В этом случае задайте **тип изменения размера** к обоим и задайте **тип перемещения** значение none. Затем задайте **изменение размера по X** и **изменение размера по Y** значения до 100.

   ![Параметры динамического макета](../mfc/media/mfcdynamiclayout2.png "параметры динамического макета")

1. Попробуйте ввести другие значения, которые могут быть применимы для элементов управления. Возможно, диалоговое окно с текстовым полем однострочных **тип изменения размера** присвоено **горизонтальной** исключительно для примера.

### <a name="setting-dynamic-layout-properties-programmatically"></a>Задание свойств динамического макета программным образом

Описанную выше процедуру можно использовать для задания свойств динамического макета диалогового окна на этапе разработки. Но, если вы хотите управлять динамическим макетом во время выполнения, свойства динамического макета можно задавать программным образом.

#### <a name="to-set-dynamic-layout-properties-programmatically"></a>Задание свойств динамического макета программным образом

1. Найдите или создайте место в коде реализации класса своего диалогового окна, где необходимо задать динамический макет для диалогового окна. Например, можно добавить метод, например `AdjustLayout` в диалоговом окне, и вызывать его из тех мест, где будет необходимо изменять макет. Можно выполнить вызов из конструктора сначала или же после внесения изменений в диалоговое окно.

1. Для диалогового окна, вызовите [GetDynamicLayout](../mfc/reference/cwnd-class.md#getdynamiclayout), метод `CWnd` класса. `GetDynamicLayout` возвращает указатель на объект `CMFCDynamicLayout` .

    ```cpp
    CMFCDynamicLayout* dynamicLayout = pDialog->GetDynamicLayout();
    ```

1. Для первого элемента управления, к которому требуется добавить динамическое поведение, используйте статические методы на классе динамического макета для создания [MoveSettings](../mfc/reference/cmfcdynamiclayout-class.md#movesettings_structure) структуру, которая кодирует способ корректировки элемента управления. Это делается выбирая соответствующий статический метод: [CMFCDynamicLayout::MoveHorizontal](../mfc/reference/cmfcdynamiclayout-class.md#movehorizontal), [CMFCDynamicLayout::MoveVertical](../mfc/reference/cmfcdynamiclayout-class.md#movevertical), [CMFCDynamicLayout::MoveNone](../mfc/reference/cmfcdynamiclayout-class.md#movenone), или [CMFCDynamicLayout::MoveHorizontalAndVertical](../mfc/reference/cmfcdynamiclayout-class.md#movehorizontalandvertical). Вы передаете процентное соотношение для перемещения по горизонтали или по вертикали. Эти статические методы возвращают вновь созданный объект MoveSettings, который можно использовать для задания поведения перемещения элемента управления.

   Помните, что 100 означает перемещение на столько же, на сколько диалоговое окно изменяет свой размер. При этом край элемента управления будет оставаться на фиксированном расстоянии от новой границы.

    ```cpp
    MoveSettings moveSettings = CMFCDynamicLayout::MoveHorizontal(100);
    ```

1. Сделать то же самое для поведения размера, который использует [SizeSettings](../mfc/reference/cmfcdynamiclayout-class.md#sizesettings_structure) типа. Например, чтобы указать, что элемент управления не изменяет размер при изменении размера диалогового окна, используйте следующий код:

    ```cpp
    SizeSettings sizeSettings = CMFCDynamicLayout::SizeNone();
    ```

1. Добавьте элемент управления в диспетчер динамического макета с помощью [CMFCDynamicLayout::AddItem](../mfc/reference/cmfcdynamiclayout-class.md#additem) метод. Для различных способов указания требуемого элемента управления предусмотрены две перегрузки. Одна использует дескриптор окна элемента управления (HWND), а другая — идентификатор элемента управления.

    ```cpp
    dynamicLayout->AddItem(hWndControl,
    moveSettings,
    sizeSettings);
    ```

1. Повторите для каждого элемента управления, который нужно переместить или для которого нужно изменить размер.

1. При необходимости можно использовать [CMFCDynamicLayout::HasItem](../mfc/reference/cmfcdynamiclayout-class.md#hasitem) метод для определения, если элемент управления включен в список элементов управления, для которых макет будет изменен, или [CMFCDynamicLayout::IsEmpty](../mfc/reference/cmfcdynamiclayout-class.md#isempty) метод, чтобы определить, есть ли все элементы управления, которые подлежат изменению.

1. Чтобы включить макет диалогового окна, вызовите [CWnd::EnableDynamicLayout](../mfc/reference/cwnd-class.md#enabledynamiclayout) метод.

    ```cpp
    pDialog->EnableDynamicLayout(TRUE);
    ```

1. В следующий раз при изменении пользователем размера диалогового окна, [CMFCDynamicLayout::Adjust](../mfc/reference/cmfcdynamiclayout-class.md#adjust) вызывается метод, который фактически применяет параметры.

1. Если вы хотите отключить динамический макет, вызовите [CWnd::EnableDynamicLayout](../mfc/reference/cwnd-class.md#enabledynamiclayout) с **FALSE** как для *bEnabled* параметра.

    ```cpp
    pDialog->EnableDynamicLayout(FALSE);
    ```

#### <a name="to-set-the-dynamic-layout-programmatically-from-a-resource-file"></a>Задание динамического макета программным образом из файла ресурсов

1. Используйте [CMFCDynamicLayout::MoveHorizontalAndVertical](../mfc/reference/cmfcdynamiclayout-class.md#movehorizontalandvertical) метод, чтобы задать имя ресурса в файле скрипта соответствующих ресурсов (RC-файл), указывающее сведения о динамическом макете, как показано в следующем примере:

    ```cpp
    dynamicLayout->LoadResource("IDD_DIALOG1");
    ```

   Именованный ресурс должен ссылаться на диалог, содержащий сведения о макете в виде **AFX_DIALOG_LAYOUT** запись в файле ресурсов, как показано в следующем примере:

    ```RC
    /////////////////////////////////////////////////////////////////////////////
    //
    // AFX_DIALOG_LAYOUT
    //

    IDD_MFCAPPLICATION1_DIALOG AFX_DIALOG_LAYOUT
    BEGIN
    0x0000,
    0x6400,
    0x0028,
    0x643c,
    0x0028
    END

    IDD_DIALOG1 AFX_DIALOG_LAYOUT
    BEGIN
    0x0000,
    0x6464,
    0x0000,
    0x6464,
    0x0000,
    0x0000,
    0x6464,
    0x0000,
    0x0000

    END
    ```

## <a name="see-also"></a>См. также

[Класс CMFCDynamicLayout](../mfc/reference/cmfcdynamiclayout-class.md)<br/>
[Классы элементов управления](../mfc/control-classes.md)<br/>
[Классы диалоговых окон](../mfc/dialog-box-classes.md)<br/>
[Редактор диалоговых окон](../windows/dialog-editor.md)<br/>
[Диалоговое окно динамического макета для MFC в Visual C++ 2015](https://mariusbancila.ro/blog/2015/07/27/dynamic-dialog-layout-for-mfc-in-visual-c-2015/)
