---
title: Регистрация
ms.date: 11/04/2016
helpviewer_keywords:
- servers [MFC], initializing
- initializing servers [MFC]
- OLE, registration
- installing servers [MFC]
- registry [MFC], OLE item database
- registration databases [MFC]
- servers [MFC], installing
- OLE server applications [MFC], registering servers
ms.assetid: 991d5684-72c1-4f9e-a09a-9184ed12bbb9
ms.openlocfilehash: 0bc606acfba26d27d0ab36045e4772593e760e98
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57272178"
---
# <a name="registration"></a>Регистрация

Когда пользователю для вставки элемента OLE в приложения, OLE представлен список типов объектов для выбора. OLE получает этот список из базы данных регистрации системы, который содержит сведения, предоставляемые всех серверных приложений. Сервер регистрирует себя, операции, он помещает в базе данных регистрации системы (реестр) описывают каждый тип объекта, которые он предоставляет, файла расширений и путь к самому себе, помимо прочего, сведения.

Платформа и OLE системных библиотек динамической компоновки (DLL) используют этого реестра, чтобы определить, какие типы элементов OLE доступны в системе. Система OLE библиотеки DLL также используют этот реестр для определения способа запуска серверного приложения, когда активируется связанный или внедренный объект.

В этой статье описывается, что нужно делать, если он установлен каждое серверное приложение, и каждый раз она выполняется.

Подробные сведения о регистрации системной базы данных и формат REG-файлов, используемый для его обновления, см. в разделе *справочнике программиста OLE*.

##  <a name="_core_server_installation"></a> Установка сервера

При установке серверного приложения, его необходимо зарегистрировать все типы элементов OLE, которые она поддерживает. Также возможно обновление регистрации системной базы данных, каждый раз, он как отдельное приложение сервером. Это регулярно обновляет базу данных регистрации при перемещении сервера исполняемый файл.

> [!NOTE]
>  Приложения MFC, создаваемые с помощью мастера приложений автоматически регистрироваться при запуске как самостоятельные приложения.

Если вы хотите зарегистрировать приложение во время установки, используйте программу RegEdit.exe. При включении программу установки с вашим приложением, имеют запуска программы установки «RegEdit /S *appname*.reg». (Флаг/s указывает автоматической операции, то есть он не отобразить диалоговое окно reporting успешного завершения команды). В противном случае пользователь должен вручную запустите программу RegEdit.

> [!NOTE]
>  REG-файл, создаваемый мастером приложений не включает полный путь для исполняемого файла. Программе установки необходимо либо модифицировать REG-файл, чтобы включать полный путь к исполняемому файлу или изменить переменную среды PATH для включения в каталог установки.

RegEdit объединяет содержимое текстового REG-файл в базе данных регистрации. Чтобы проверить базу данных или для его восстановления, используйте редактор реестра. Будьте внимательны, чтобы избежать удаления essential записей OLE.

##  <a name="_core_server_initialization"></a> Инициализация сервера

При создании серверного приложения с помощью мастера приложений, мастер автоматически завершит все задачи инициализации для вас. В этом разделе описывается, что необходимо сделать, при создании серверного приложения вручную.

При запуске серверного приложения, приложения-контейнера OLE системные библиотеки DLL добавьте параметр «/ внедрения» сервера командной строки. Поведение серверного приложения, отличается в зависимости от того, является ли оно было запущено в контейнере, поэтому первое, что приложение должно выполнять, когда он начинает выполнение проверки для «/ внедрения» или «-внедрения» параметр в командной строке. Если этот параметр существует, загрузить другой набор ресурсов, которые показывают, как либо встроенная активация сервера или полностью открытое. Дополнительные сведения см. в разделе [меню и ресурсы: Добавление серверов](../mfc/menus-and-resources-server-additions.md).

Серверное приложение вызывать его `CWinApp::RunEmbedded` функции для синтаксического анализа командной строки. Если он возвращает ненулевое значение, приложение не должно отображать свое окно, так как он был выполнен из приложения-контейнера, не как отдельное приложение. Эта функция обновляет записи сервера базы данных системы регистрации и вызовы `RegisterAll` функция-член для вас, выполняющий регистрацию экземпляра.

При запуске серверного приложения необходимо убедиться в его способность выполнять регистрация экземпляра. Регистрация экземпляра сообщает системе OLE библиотеки DLL, что сервер находится активна и готова для получения запросов из контейнеров. Оно добавляет запись в базе данных регистрации. Выполнение регистрации экземпляра сервера, вызвав `ConnectTemplate` определяется функция-член `COleTemplateServer`. Это подключается `CDocTemplate` объект `COleTemplateServer` объекта.

`ConnectTemplate` Функция принимает три параметра: сервера *CLSID*, указатель на `CDocTemplate` объект и флаг, указывающий, поддерживает ли сервер несколько экземпляров. Miniserver должен иметь возможность поддерживают несколько экземпляров, то есть оно должно быть возможно наличие нескольких экземпляров сервера, чтобы запустить одновременно, один для каждого контейнера. Следовательно, передайте **TRUE** этот флаг при запуске miniserver.

При написании miniserver по определению она всегда запускается в контейнере. По-прежнему должен выполнить синтаксический анализ командной строки для проверки для параметра «/ внедрения». Отсутствие этого параметра в командной строке означает, что пользователь пытается запустить miniserver как отдельное приложение. В этом случае сервер зарегистрирован в базе данных системы регистрации и отобразите окно сообщения, информируя пользователя для запуска miniserver из приложения-контейнера.

## <a name="see-also"></a>См. также

[OLE](../mfc/ole-in-mfc.md)<br/>
[Серверы](../mfc/servers.md)<br/>
[CWinApp::RunAutomated](../mfc/reference/cwinapp-class.md#runautomated)<br/>
[CWinApp::RunEmbedded](../mfc/reference/cwinapp-class.md#runembedded)<br/>
[Класс COleTemplateServer](../mfc/reference/coletemplateserver-class.md)
