---
title: Элементы управления виртуального списка
ms.date: 11/04/2016
helpviewer_keywords:
- cache, virtual list control item data
- list controls [MFC], virtual
- list controls [MFC], List view
- virtual list controls
ms.assetid: 319f841f-e426-423a-8276-d93f965b0b45
ms.openlocfilehash: 1ade5f404e134cf6de20756dcc5af169fefdec76
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375510"
---
# <a name="virtual-list-controls"></a>Элементы управления виртуального списка

Виртуальный элемент управления списком — это элемент управления представления мисеисом, который имеет LVS_OWNERDATA стиль. Этот стиль позволяет элементу поддерживать количество элементов до **DWORD** (количество элементов по умолчанию распространяется только на **Int).** Однако самым большим преимуществом этого стиля является возможность иметь только подмножество элементов данных в памяти в любой момент времени. Это позволяет виртуальному управлению представлениями списка поддаваться на использование с большими базами данных информации, где конкретные методы доступа к данным уже имеются.

> [!NOTE]
> В дополнение к предоставлению `CListCtrl`виртуального списка функциональности в , MFC также предоставляет ту же функциональность в классе [CListView.](../mfc/reference/clistview-class.md)

Есть некоторые проблемы совместимости, о которых вы должны знать при разработке виртуальных элементов управления списком. Для получения дополнительной информации в разделе «Проблемы совместимости» в разделе «Управление списками» можно ознакомиться в разделе SDK Windows.

## <a name="handling-the-lvn_getdispinfo-notification"></a>Обработка уведомления о LVN_GETDISPINFO

Элементы управления виртуальным списком сохраняют очень мало информации о товарах. За исключением информации о выборе элемента и фокусировке, вся информация о товаре управляется владельцем элемента. Информация запрашивается рамкой через LVN_GETDISPINFO сообщение монуведомления. Чтобы предоставить запрашиваемую информацию, владелец элемента управления виртуального списка (или самого элемента управления) должен обрабатывать это уведомление. Это можно легко сделать с помощью [мастера класса](reference/mfc-class-wizard.md) (см. [Отображение сообщений к функциям).](../mfc/reference/mapping-messages-to-functions.md) Полученный код должен выглядеть примерно на `CMyDialog` следующем примере (где он владеет объектом управления виртуальным списком, а диалог обрабатывает уведомление):

[!code-cpp[NVC_MFCControlLadenDialog#23](../mfc/codesnippet/cpp/virtual-list-controls_1.cpp)]

В обработчике сообщения LVN_GETDISPINFO уведомления необходимо проверить, какой тип информации запрашивается. Вы можете выбрать

- `LVIF_TEXT`Член *pszText* должен быть заполнен.

- `LVIF_IMAGE`Член *iImage* должен быть заполнен.

- `LVIF_INDENT`Член *iIndent* должен быть заполнен.

- `LVIF_PARAM`Член *lParam* должен быть заполнен. (Не присутствует для подпунктой.)

- `LVIF_STATE`Член *государства* должен быть заполнен.

Затем вы должны предоставить любую информацию, запрашиваемую обратно в рамки.

В следующем примере (взятый из тела обработчика уведомлений для объекта управления списком) показан один возможный метод, предоставляя информацию для текстовых буферов и изображение элемента:

[!code-cpp[NVC_MFCControlLadenDialog#24](../mfc/codesnippet/cpp/virtual-list-controls_2.cpp)]

## <a name="caching-and-virtual-list-controls"></a>Кэширование и виртуальные элементы управления списками

Поскольку этот тип управления списками предназначен для больших наборов данных, рекомендуется кэшировать запрошенные данные элемента для повышения производительности поиска. Платформа обеспечивает механизм подсказывания кэша для оптимизации кэша путем отправки LVN_ODCACHEHINT сообщения уведомлений.

Следующий пример обновляет кэш с диапазоном, передаваемым функции обработчика.

[!code-cpp[NVC_MFCControlLadenDialog#25](../mfc/codesnippet/cpp/virtual-list-controls_3.cpp)]

Для получения дополнительной информации о подготовке и обслуживании кэша можно ознакомиться в разделе «Управление кэшем» в разделе «Управление списками» в SDK Windows.

## <a name="finding-specific-items"></a>Поиск конкретных элементов

Сообщение LVN_ODFINDITEM уведомления отправляется элементом виртуального списка, когда необходимо найти определенный элемент управления списком. Сообщение об уведомлении отправляется, когда элемент управления представления списка получает быстрый доступ к ключам или когда он получает LVM_FINDITEM сообщение. Поисковая информация отправляется в виде структуры **LVFINDINFO,** которая является членом структуры **NMLVFINDITEM.** Обработайте это сообщение, переопределив `OnChildNotify` функцию объекта управления списком и внутри тела обработчика, проверьте LVN_ODFINDITEM сообщение. Если найдено, выполните соответствующее действие.

Вы должны быть готовы к поиску элемента, который соответствует информации, предоставленной диспетчером представления списка. При успешном успехе индекса элемента следует вернуть или -1, если не найдено соответствие элемента.

## <a name="see-also"></a>См. также раздел

[Использование CListCtrl](../mfc/using-clistctrl.md)<br/>
[Элементы управления](../mfc/controls-mfc.md)
