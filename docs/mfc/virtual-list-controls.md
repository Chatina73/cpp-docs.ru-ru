---
title: Элементы управления виртуального списка
ms.date: 11/04/2016
helpviewer_keywords:
- cache, virtual list control item data
- list controls [MFC], virtual
- list controls [MFC], List view
- virtual list controls
ms.assetid: 319f841f-e426-423a-8276-d93f965b0b45
ms.openlocfilehash: 12200697af90a3c83fea3df676bd4d2488598d45
ms.sourcegitcommit: 1f009ab0f2cc4a177f2d1353d5a38f164612bdb1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/27/2020
ms.locfileid: "87215924"
---
# <a name="virtual-list-controls"></a>Элементы управления виртуального списка

Виртуальный элемент управления "список" представляет собой элемент управления "список", имеющий стиль LVS_OWNERDATA. Этот стиль позволяет элементу управления поддерживать число элементов вплоть до **DWORD** (число элементов по умолчанию распространяется только на **`int`** ). Однако наибольшее преимущество, обеспечиваемое этим стилем, — возможность иметь только подмножество элементов данных в памяти в один момент времени. Это позволяет использовать виртуальный элемент управления "представление списка" для использования с большими базами данных, где уже имеются определенные методы доступа к данным.

> [!NOTE]
> Помимо обеспечения функциональных возможностей виртуальных списков в `CListCtrl` , MFC также предоставляет те же функциональные возможности, что и класс [CListView](../mfc/reference/clistview-class.md) .

Существуют некоторые проблемы совместимости, о которых следует помнить при разработке элементов управления виртуального списка. Дополнительные сведения см. в подразделе проблемы совместимости раздела элементы управления List-View статьи Windows SDK.

## <a name="handling-the-lvn_getdispinfo-notification"></a>Обработка уведомления LVN_GETDISPINFO

Элементы управления "список виртуальных списков" поддерживают очень маленькие сведения об элементах. За исключением выбора элементов и сведений о фокусе, все сведения об элементе управляются владельцем элемента управления. Сведения запрашиваются платформой через сообщение уведомления LVN_GETDISPINFO. Чтобы предоставить запрашиваемые сведения, владелец элемента управления виртуального списка (или самого элемента управления) должен справиться с этим уведомлением. Это можно легко сделать с помощью [мастера классов](reference/mfc-class-wizard.md) (см. раздел [сопоставление сообщений с функциями](../mfc/reference/mapping-messages-to-functions.md)). Результирующий код должен выглядеть примерно так, как показано в следующем примере (где `CMyDialog` принадлежит объект элемента управления Virtual List, и диалоговое окно обрабатывает уведомление):

[!code-cpp[NVC_MFCControlLadenDialog#23](../mfc/codesnippet/cpp/virtual-list-controls_1.cpp)]

В обработчике сообщения LVN_GETDISPINFO уведомления необходимо проверить, какой тип данных запрашивается. Допустимые значения:

- `LVIF_TEXT`Элемент *псзтекст* должен быть заполнен.

- `LVIF_IMAGE`Элемент *иимаже* должен быть заполнен.

- `LVIF_INDENT`Элемент *ииндент* должен быть заполнен.

- `LVIF_PARAM`Член *lParam* должен быть заполнен. (Отсутствует для дочерних элементов.)

- `LVIF_STATE`Элемент *State* должен быть заполнен.

Затем следует указать все данные, запрошенные в платформе.

Следующий пример (взятый из тела обработчика уведомлений для объекта элемента управления "список") демонстрирует один возможный метод, предоставляя сведения для текстовых буферов и изображения элемента:

[!code-cpp[NVC_MFCControlLadenDialog#24](../mfc/codesnippet/cpp/virtual-list-controls_2.cpp)]

## <a name="caching-and-virtual-list-controls"></a>Элементы управления кэшированием и виртуальным списком

Поскольку этот тип элемента управления "список" предназначен для больших наборов данных, рекомендуется кэшировать запрошенные данные элемента для повышения производительности получения. Платформа предоставляет механизм указания кэша для оптимизации кэша путем отправки сообщения уведомления LVN_ODCACHEHINT.

В следующем примере производится обновление кэша с диапазоном, переданным в функцию обработчика.

[!code-cpp[NVC_MFCControlLadenDialog#25](../mfc/codesnippet/cpp/virtual-list-controls_3.cpp)]

Дополнительные сведения о подготовке и обслуживании кэша см. в разделе Управление кэшем раздела элементы управления List-View статьи Windows SDK.

## <a name="finding-specific-items"></a>Поиск конкретных элементов

Сообщение LVN_ODFINDITEM уведомления отправляется элементом управления "виртуальный список", когда необходимо найти определенный элемент управления "список". Сообщение уведомления отправляется, когда элемент управления "представление списка" получает быстрый доступ к ключу или при получении сообщения LVM_FINDITEM. Данные поиска отправляются в виде структуры **лвфиндинфо** , которая является членом структуры **нмлвфиндитем** . Обрабатывайте это сообщение путем переопределения `OnChildNotify` функции объекта элемента управления списка и внутри тела обработчика проверьте LVN_ODFINDITEM сообщение. Если найден, выполните соответствующее действие.

Вы должны быть готовы к поиску элемента, совпадающего со сведениями, заданными элементом управления представления списка. Необходимо возвратить индекс элемента, если он был успешным, или значение-1, если соответствующий элемент не найден.

## <a name="see-also"></a>См. также раздел

[Использование CListCtrl](../mfc/using-clistctrl.md)<br/>
[Элементы управления](../mfc/controls-mfc.md)
