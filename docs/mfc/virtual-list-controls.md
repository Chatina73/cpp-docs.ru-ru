---
title: Элементы управления виртуального списка
ms.date: 11/04/2016
helpviewer_keywords:
- cache, virtual list control item data
- list controls [MFC], virtual
- list controls [MFC], List view
- virtual list controls
ms.assetid: 319f841f-e426-423a-8276-d93f965b0b45
ms.openlocfilehash: 7372aca9e24a554e01f7a61f43d6170e99fe34c5
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62358266"
---
# <a name="virtual-list-controls"></a>Элементы управления виртуального списка

Элемент управления виртуального списка — элемент управления списка, в которой LVS_OWNERDATA стиль. Этот стиль включает элемент управления для поддержки числа элементов до **DWORD** (число элементов по умолчанию распространяется только на **int**). Тем не менее предоставляемые этот стиль наибольшим преимуществом является возможность иметь только подмножество элементов данных в памяти в любой момент времени. Это позволяет элементу управления представление виртуального списка во временное пользование для использования с большими базами данных, информации, где конкретные методы доступа к данным уже используется.

> [!NOTE]
>  Помимо предоставления возможности виртуального списка `CListCtrl`, MFC также предоставляет те же функциональные возможности в [CListView](../mfc/reference/clistview-class.md) класса.

Существуют некоторые проблемы совместимости, которые следует иметь в виду при разработке элементов управления виртуального списка. Дополнительные сведения см. в разделе проблем совместимости раздела представление списка элементов управления в пакете Windows SDK.

## <a name="handling-the-lvngetdispinfo-notification"></a>Обработка уведомления LVN_GETDISPINFO

Элементы управления виртуального списка поддерживать очень мало сведений элемента. За исключением Выбор элементов и сведения о фокус все сведения об элементе осуществляется владельцем элемента управления. Платформой через сообщение уведомления LVN_GETDISPINFO запрашиваются сведения. Чтобы предоставить запрошенные сведения, владелец управления виртуального списка (или самого элемента управления) необходимо обрабатывать это уведомление. Это можно легко сделать с помощью окна свойств (см. в разделе [сопоставление сообщений с функциями](../mfc/reference/mapping-messages-to-functions.md)). Результирующий код выглядит примерно как в следующем примере (где `CMyDialog` является владельцем объекта управления виртуального списка и диалогового окна обрабатывает уведомление):

[!code-cpp[NVC_MFCControlLadenDialog#23](../mfc/codesnippet/cpp/virtual-list-controls_1.cpp)]

В обработчике LVN_GETDISPINFO сообщение уведомления необходимо проверить, см. в статье, какая информация запрашивается. Допустимые значения:

- `LVIF_TEXT` *PszText* элемента должно быть заполнено.

- `LVIF_IMAGE` *IImage* элемента должно быть заполнено.

- `LVIF_INDENT` *IIndent* элемента должно быть заполнено.

- `LVIF_PARAM` *LParam* элемента должно быть заполнено. (Нет для вложенных элементов.)

- `LVIF_STATE` *Состояние* элемента должно быть заполнено.

Затем необходимо предоставить сведения, запрашивается обратно к платформе.

В следующем примере (взятом из тела обработчика уведомлений для объекта элемента управления списка) показано одно из возможных способов, указав сведения, касающиеся текстовыми буферами и изображение элемента:

[!code-cpp[NVC_MFCControlLadenDialog#24](../mfc/codesnippet/cpp/virtual-list-controls_2.cpp)]

## <a name="caching-and-virtual-list-controls"></a>Кэширование и виртуальных элементов управления список

Так как этот тип элемента управления "список" предназначен для больших наборов данных, рекомендуется кэшировать запрашиваемый элемент данных для повышения производительности извлечения. Платформа предоставляет механизм кэша подсказки для помощи в оптимизации кэша путем отправки сообщения уведомления LVN_ODCACHEHINT.

В следующем примере обновляется кэш с диапазоном, переданных в функцию обработчика.

[!code-cpp[NVC_MFCControlLadenDialog#25](../mfc/codesnippet/cpp/virtual-list-controls_3.cpp)]

Дополнительные сведения о подготовке и сохранения кэша см. в разделе Управление кэшем раздела представление списка элементов управления в пакете Windows SDK.

## <a name="finding-specific-items"></a>Поиск определенных элементов

Сообщение уведомления LVN_ODFINDITEM отправляется элементом управления виртуального списка, когда требуется найти элемент управления списка. Сообщение уведомления отправляется в том случае, когда управления представления списком получает быстрый доступ к ключу или когда он получает сообщение LVM_FINDITEM. Сведения о поиске отправляется в виде **LVFINDINFO** структуру, которая является членом объекта **NMLVFINDITEM** структуры. Обработать это сообщение, переопределив `OnChildNotify` функции списка объекта элемента управления и в теле обработчика, проверьте наличие сообщения LVN_ODFINDITEM. Если найден, выполните необходимые действия.

Следует быть готовым искомый элемент, соответствующий сведений управления представления списком. Должна возвращать индекс элемента, в случае успеха или значение -1, если найдено ни одного соответствующего элемента.

## <a name="see-also"></a>См. также

[Использование CListCtrl](../mfc/using-clistctrl.md)<br/>
[Элементы управления](../mfc/controls-mfc.md)
