---
title: Обновление текса на панели строки состояния
ms.date: 11/04/2016
helpviewer_keywords:
- updating user interface objects [MFC]
- ON_UPDATE_COMMAND_UI macro [MFC]
- user interface objects [MFC], updating
- text, status bar
- CStatusBar class [MFC], updating
- SetText method [MFC]
- panes, status bar
- status bars [MFC], updating
ms.assetid: 4984a3f4-9905-4d8c-a927-dca19781053b
ms.openlocfilehash: 20cd519f15fa9b218bca3dd1348659cfd0d5e473
ms.sourcegitcommit: 3caf5261b3ea80d9cf14038c116ba981d655cd13
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2019
ms.locfileid: "70907635"
---
# <a name="updating-the-text-of-a-status-bar-pane"></a>Обновление текса на панели строки состояния

В этой статье объясняется, как изменить текст, отображаемый на панели строки состояния MFC. Строка состояния — объект окна класса [CStatusBar](../mfc/reference/cstatusbar-class.md) — содержит несколько областей. Каждая панель представляет собой прямоугольную область строки состояния, которую можно использовать для вывода сведений. Например, многие приложения отображают состояние CAPS LOCK, NUM LOCK и других клавиш на самых правых панелях. Приложения также часто отображают информативный текст на самой левой панели (панели 0), иногда называемой «областью сообщений». Например, в строке состояния MFC по умолчанию панель сообщений используется для вывода строки, объясняющей выбранный в данный момент элемент меню или кнопку на панели инструментов. На рисунке в [строках состояния](../mfc/status-bar-implementation-in-mfc.md) отображается строка состояния из приложения MFC, созданного с помощью мастера приложений.

По умолчанию при создании панели в MFC `CStatusBar` не включается область. Чтобы активировать панель, необходимо использовать макрос ON_UPDATE_COMMAND_UI для каждой панели в строке состояния и обновить панели. Так как панели не отправляют сообщения WM_COMMAND (они не подобны кнопкам на панели инструментов), необходимо ввести код вручную.

Например, предположим, что одна панель `ID_INDICATOR_PAGE` имеет идентификатор своей команды и содержит номер текущей страницы в документе. В следующей процедуре описывается создание новой панели в строке состояния.

### <a name="to-make-a-new-pane"></a>Создание новой области

1. Определите идентификатор команды панели.

   В меню **вид** выберите пункт **представление ресурсов**. Щелкните правой кнопкой мыши ресурс проекта и выберите пункт **символы ресурсов**. В диалоговом окне символы ресурсов нажмите кнопку `New`. Введите имя идентификатора команды: например, `ID_INDICATOR_PAGE`. Укажите значение для идентификатора или примите значение, предложенное диалоговым окном "Символы ресурса". Например, для `ID_INDICATOR_PAGE`примите значение по умолчанию. Закройте диалоговое окно символы ресурсов.

1. Определите строку по умолчанию, которая будет отображаться на панели.

   После открытия представление ресурсов дважды щелкните **таблицу строк** в окне со списком типов ресурсов для приложения. Откройте редактор **таблицы строк** и в меню **Вставка** выберите пункт **Новая строка** . Выберите идентификатор команды в области (например, `ID_INDICATOR_PAGE`) и введите строковое значение по умолчанию, например "страница". Закройте редактор строк. (Чтобы избежать ошибки компилятора, необходима строка по умолчанию.)

1. Добавьте область в массив *индикаторов* .

   В файле МАИНФРМ. CPP, выберите массив *индикаторов* . Этот массив содержит идентификаторы команд для всех индикаторов в строке состояния в порядке слева направо. В соответствующей точке массива введите идентификатор команды для `ID_INDICATOR_PAGE`панели, как показано ниже:

   [!code-cpp[NVC_MFCDocView#10](../mfc/codesnippet/cpp/updating-the-text-of-a-status-bar-pane_1.cpp)]

Для вывода текста на панели рекомендуется вызывать `SetText` функцию-член класса `CCmdUI` в функции обработчика обновления для панели. Например, может потребоваться настроить целочисленную переменную *m_nPage* , содержащую номер текущей страницы, и использовать `SetText` для задания текста панели в виде строкового номера.

> [!NOTE]
>  Рекомендуется `SetText` подход. Эту задачу можно выполнить на немного низком уровне, вызвав `CStatusBar` функцию `SetPaneText`-член. Несмотря на это, вам по-прежнему нужен обработчик обновлений. Без такого обработчика для панели MFC автоматически отключает панель, удаляя ее содержимое.

В следующей процедуре показано, как использовать функцию обработчика обновлений для отображения текста на панели.

#### <a name="to-make-a-pane-display-text"></a>Отображение текста на панели

1. Добавьте командный обработчик обновления для команды.

   Вручную добавьте прототип для обработчика, как показано здесь для `ID_INDICATOR_PAGE` (в маинфрм. З):

   [!code-cpp[NVC_MFCDocView#11](../mfc/codesnippet/cpp/updating-the-text-of-a-status-bar-pane_2.h)]

1. В соответствующем случае. CPP-файл, добавьте определение обработчика, как показано здесь для `ID_INDICATOR_PAGE` (в маинфрм. CPP):

   [!code-cpp[NVC_MFCDocView#12](../mfc/codesnippet/cpp/updating-the-text-of-a-status-bar-pane_3.cpp)]

   Последние три строки этого обработчика — это код, который отображает текст.

1. В соответствующей схеме сообщений добавьте макрос ON_UPDATE_COMMAND_UI, как показано здесь для `ID_INDICATOR_PAGE` (в маинфрм. CPP):

   [!code-cpp[NVC_MFCDocView#13](../mfc/codesnippet/cpp/updating-the-text-of-a-status-bar-pane_4.cpp)]

После определения значения переменной-члена *m_nPage* (класса `CMainFrame`) Этот метод приводит к отображению номера страницы на панели во время обработки простоя таким же образом, как приложение обновляет другие индикаторы. Если *m_nPage* изменяется, отображение изменяется во время следующего цикла бездействия.

### <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать подробнее

- [Обновление объектов пользовательского интерфейса (обновление кнопок панели инструментов и пунктов меню при изменении условий программы)](../mfc/how-to-update-user-interface-objects.md)

## <a name="see-also"></a>См. также

[Реализация строки состояния в MFC](../mfc/status-bar-implementation-in-mfc.md)<br/>
[Класс CStatusBar](../mfc/reference/cstatusbar-class.md)
