---
title: 'TN055: Перенос приложений класса баз данных MFC ODBC на классы MFC DAO'
ms.date: 06/20/2018
helpviewer_keywords:
- DAO [MFC], migration
- TN055
- migration [MFC], ODBC database applications
- ODBC classes [MFC], DAO classes
- migrating ODBC database applications [MFC]
- porting database applications to DAO
- ODBC [MFC], DAO
- porting ODBC database applications to DAO
- migrating database applications [MFC]
ms.assetid: 0f858bd1-e168-4e2e-bcd1-8debd82856e4
ms.openlocfilehash: 7a1d3436a9b19c40df2a08576d797de49833f14f
ms.sourcegitcommit: 934cb53fa4cb59fea611bfeb9db110d8d6f7d165
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/14/2019
ms.locfileid: "65611236"
---
# <a name="tn055-migrating-mfc-odbc-database-class-applications-to-mfc-dao-classes"></a>TN055: Перенос приложений класса баз данных MFC ODBC на классы MFC DAO

> [!NOTE]
> Среды Visual C++ и мастерах не поддерживают DAO (хотя классы DAO включены и их по-прежнему можно использовать). Корпорация Майкрософт рекомендует использовать [шаблоны OLE DB](../data/oledb/ole-db-templates.md) или [ODBC и MFC](../data/odbc/odbc-and-mfc.md) для новых проектов. DAO следует использовать только для поддержки существующих приложений.

## <a name="overview"></a>Обзор

Во многих ситуациях может потребоваться миграция приложений, использующих классы базы данных MFC ODBC для классов баз данных MFC DAO. Это техническое Примечание подробно описываются основные различия между классами MFC ODBC и DAO. С различиями в виду не следует слишком сложно перенести приложения из классов ODBC в классы MFC, при необходимости.

## <a name="why-migrate-from-odbc-to-dao"></a>Зачем переходить с ODBC в DAO

Существует ряд причин, почему может потребоваться перенести приложения из классы баз данных ODBC в DAO классы баз данных, но такое решение не всегда проста или очевидна. Следует помнить, что ядро базы данных Microsoft Jet, используемый DAO можно считывается любой источник данных ODBC, для которого у вас есть драйвер ODBC. Возможно, более эффективно использовать классы баз данных ODBC или вызывать ODBC напрямую самостоятельно, но базы данных Microsoft Jet могут считывать данные ODBC.

Иногда простой, упрощающие решение ODBC или DAO. Например, когда требуется только доступ к данным в формате, который может считывать ядра Microsoft Jet, напрямую (формат доступа, формат Excel и т. д.) очевидным выбором является использование классов базы данных DAO.

Более сложные случаи возникают, когда данные существует на сервере или на разных серверах различных. В этом случае решение использовать классы баз данных ODBC и классы баз данных DAO является трудной. Если вы хотите делать такие вещи, как гетерогенные соединения (join данные с серверов в нескольких форматах, таких как SQL Server и Oracle), а затем ядро базы данных Microsoft Jet будет выполнить соединение для вас вместо вас от необходимости выполнить действия, необходимые, если вы использовали базу данных ODBC Классы или вызываемой ODBC напрямую. Если вы используете драйвер ODBC, который поддерживает драйвер курсоры, оптимальным решением может быть классы баз данных ODBC.

Выбор может быть сложным, поэтому может потребоваться написать пример кода для тестирования производительности различных методов, учитывая свои задачи. Предполагается, что это техническое примечание, нужно выбрать решение для миграции из базы данных классов ODBC классы баз данных DAO.

## <a name="similarities-between-odbc-database-classes-and-mfc-dao-database-classes"></a>Сходство классы баз данных ODBC и классы баз данных MFC DAO

Исходной структуры классам ODBC библиотеки MFC был основан на модели объектов DAO, используемый в Microsoft Access и Microsoft Visual Basic. Это означает, что существует множество общих функций, классов ODBC и DAO MFC, будут перечисляться не все в этом разделе. Вообще говоря модели программирования одинаковы.

Чтобы выделить несколько сходства:

- Классы DAO и ODBC имеют объектов базы данных, которые управляются с помощью базовой системы базы данных (СУБД).

- Обе имеют объекта набора записей, представляющий набор результатов, возвращаемых из БАЗАМИ.

- Объекты базы данных и набор записей DAO имеют члены, практически идентичен классы ODBC.

- С помощью оба набора классов код для извлечения данных идентичными, отличаясь только некоторые изменения имен объектом и элементом. Изменения будут необходимы, но обычно выполняется изменение просто имени при переключении из классов ODBC на классы DAO.

Например в обеих моделях, которые выполняет хранимая процедура для получения данных для создания и открытия объекта базы данных, создание откройте объект набора записей и перемещаться (перемещение) данных, выполнения некоторой операции.

## <a name="differences-between-odbc-and-dao-mfc-classes"></a>Различия между ODBC и классы DAO MFC

Классы DAO включают дополнительные объекты и широкий набор методов, но только в этом разделе подробно различия в аналогичные классы и функции.

Наиболее очевидная различия между классами, вероятно, изменения имен для аналогично классам и глобальным функциям. В следующем списке приведены изменения имен объектов, методов и глобальные функции, связанные с классами базы данных:

|Класс или функция|Эквивалент в классах MFC DAO|
|-----------------------|-----------------------------------|
|`CDatabase`|`CDaoDatabase`|
|`CDatabase::ExecuteSQL`|`CDaoDatabase::Execute`|
|`CRecordset`|`CDaoRecordset`|
|`CRecordset::GetDefaultConnect`|`CDaoRecordset::GetDefaultDBName`|
|`CFieldExchange`|`CDaoFieldExchange`|
|`RFX_Bool`|`DFX_Bool`|
|`RFX_Byte`|`DFX_Byte`|
|`RFX_Int`|`DFX_Short`|
|`RFX_Long`|`DFX_Long`|
||`DFX_Currency`|
|`RFX_Single`|`DFX_Single`|
|`RFX_Double`|`DFX_Double`|
|`RFX_Date`<sup>1</sup>|`DFX_Date` (`COleDateTime`-основе)|
|`RFX_Text`|`DFX_Text`|
|`RFX_Binary`|`DFX_Binary`|
|`RFX_LongBinary`|`DFX_LongBinary`|

<sup>1</sup> `RFX_Date` функция основана на `CTime` и `TIMESTAMP_STRUCT`.

Ниже перечислены основные изменения в функциях, которые могут повлиять на приложение и требуют изменения более простым именем.

- Константы и макросы, используемые для указания таких вещей, как набор записей открытый тип и параметры открытия набора записей были изменены.

   Классы ODBC MFC необходимо определить эти параметры с помощью макросов или типы перечисления.

   Классы DAO DAO предоставляет определение этих параметров в файле заголовка (DBDAOINT. H). Таким образом тип набора записей — член перечисления `CRecordset`, но с DAO константа вместо этого. Для примера используется **моментального снимка** при указании типа `CRecordset` в ODBC, но **DB_OPEN_SNAPSHOT** при указании типа `CDaoRecordset`.

- Тип набора записей по умолчанию для `CRecordset` — **моментального снимка** хотя тип набора записей по умолчанию для `CDaoRecordset` — **динамический набор** (см. примечание ниже дополнительные проблемы, о моментальных снимках классов ODBC).

- ODBC `CRecordset` класс имеет новый параметр, чтобы создать тип последовательного набора записей. В `CDaoRecordset` класс, последовательного не тип набора записей, но вместо этого свойство (или параметр) определенных типов наборов записей.

- Только для добавления записей при открытии `CRecordset` объект означает, что данных набора записей может быть чтение добавляется. С помощью `CDaoRecordset` объекта, параметр только для добавления буквально означает данных набора записей может быть только добавляется (и не читаются).

- Функции-члены классов ODBC транзакции являются членами `CDatabase` и действовать на уровне базы данных. В классах DAO, функции-члены транзакции являются членами более высокий класс уровня (`CDaoWorkspace`) и таким образом может повлиять на несколько `CDaoDatabase` объектов, общий доступ к той же рабочей области (место транзакций).

- Класс exception было изменено. `CDBExceptions` исключение в классах ODBC и `CDaoExceptions` в классы DAO.

- `RFX_Date` использует `CTime` и `TIMESTAMP_STRUCT` объектов, пока `DFX_Date` использует `COleDateTime`. `COleDateTime` Почти идентичен `CTime`, но основана на OLE 8-байтное **даты** вместо 4-байтовый **time_t** может содержать гораздо больший диапазон данных.

   > [!NOTE]
   > DAO (`CDaoRecordset`) моментальные снимки доступны только для чтения во время ODBC (`CRecordset`) моментальные снимки могут быть обновляемые в зависимости от драйвера и использование библиотеки курсоров ODBC. Если вы используете библиотеку курсоров `CRecordset` моментальные снимки являются обновляемыми. Если при использовании любого из драйверы Microsoft 3.0 пакет драйвера Desktop без библиотеку курсоров ODBC `CRecordset` моментальные снимки доступны только для чтения. Если вы используете другой драйвер, см. в документации драйвера ли моментальные снимки (`STATIC_CURSORS`) доступны только для чтения.

## <a name="see-also"></a>См. также

[Технические примечания по номеру](../mfc/technical-notes-by-number.md)<br/>
[Технические примечания по категории](../mfc/technical-notes-by-category.md)
