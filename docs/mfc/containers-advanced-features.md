---
title: Контейнеры. Дополнительные возможности
ms.date: 11/04/2016
helpviewer_keywords:
- links [MFC], to embedded OLE objects
- containers [MFC], links to embedded OLE objects
- containers [MFC], advanced features
- container/server applications [MFC]
- embedded objects [MFC]
- OLE controls [MFC], containers
- OLE containers [MFC], advanced features
- server/container applications [MFC]
- containers [MFC], container applications
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
ms.openlocfilehash: cf130bf8dead5c59548821658b979785c4d54726
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376486"
---
# <a name="containers-advanced-features"></a>Контейнеры. Дополнительные возможности

В этой статье описаны шаги, необходимые для включения дополнительных расширенных функций в существующие контейнерные приложения. Эти функции:

- [Приложение, которое является одновременно контейнером и сервером](#_core_creating_a_container_server_application)

- [Ссылка OLE на встроенный объект](#_core_links_to_embedded_objects)

## <a name="creating-a-containerserver-application"></a><a name="_core_creating_a_container_server_application"></a>Создание приложения контейнера/сервера

Контейнерное/серверное приложение — это приложение, которое действует как контейнер, так и как сервер. Примером этого является Microsoft Word для Windows. Вы можете вставлять документы Word for Windows в другие приложения, а также вставлять элементы в документы Word for Windows. Процесс изменения контейнерного приложения как контейнерного и полного сервера (вы не можете создать комбинированный контейнер/приложение miniserver) аналогичен процессу создания полного сервера.

В статье [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md) перечислен ряд задач, необходимых для реализации серверного приложения. Если вы преобразуете контейнерное приложение в контейнерное/серверное приложение, то вам необходимо выполнить некоторые из тех же задач, добавив код в контейнер. Ниже перечислены важные вещи, которые следует учитывать:

- Контейнерный код, созданный мастером приложения, уже инициализирует подсистему OLE. Вам не нужно будет что-либо менять или добавлять для этой поддержки.

- Везде, где находится `COleDocument`базовый класс класса документов, измените базовый класс на `COleServerDoc`.

- Переувываете, `COleClientItem::CanActivate` чтобы избежать редактирования элементов на месте, в то время как сам сервер используется для редактирования на месте.

   Например, в образец MFC OLE [OCLIENT](../overview/visual-cpp-samples.md) встроен элемент, созданный вашим контейнерным/серверным приложением. Вы открываете приложение OCLIENT и на месте редактируете элемент, созданный вашим контейнерным/серверным приложением. При редактировании элемента приложения вы решаете, что хотите вставить элемент, созданный образцом [HIERSVR](../overview/visual-cpp-samples.md)MFC OLE. Для этого нельзя использовать активацию на месте. Для активации этого элемента необходимо полностью открыть HIERSVR. Поскольку библиотека класса Microsoft Foundation не поддерживает `COleClientItem::CanActivate` эту функцию OLE, переопределение позволяет проверить эту ситуацию и предотвратить возможную ошибку в момент выполнения в вашем приложении.

Если вы создаете новое приложение и хотите, чтобы оно функционировало как контейнерное/серверное приложение, выберите эту опцию в диалоговом поле OLE Options в мастере приложения, и эта поддержка будет создана автоматически. Для получения дополнительной информации смотрите [обзор статьи: Создание контейнера управления ActiveX](../mfc/reference/creating-an-mfc-activex-control-container.md). Для получения информации о образцах МФЦ [см.](../overview/visual-cpp-samples.md#mfc-samples)

Обратите внимание, что вы не можете вставить приложение MDI в себя. Приложение, которое является контейнером/сервером, не может быть вставлено в себя, если оно не является приложением SDI.

## <a name="links-to-embedded-objects"></a><a name="_core_links_to_embedded_objects"></a>Ссылки на встроенные объекты

Функция Ссылки на встроенные объекты позволяет пользователю создать документ со ссылкой OLE на встроенный объект внутри вашего контейнерного приложения. Например, создайте документ в текстовом процессоре, содержащий встроенную электронную таблицу. Если приложение поддерживает ссылки на встроенные объекты, оно может вставить ссылку на электронную таблицу, содержащуюся в документе текстового процессора. Эта функция позволяет приложению использовать информацию, содержащуюся в таблице, не зная, где текстовый процессор изначально получил его.

#### <a name="to-link-to-embedded-objects-in-your-application"></a>Ссылка на встроенные объекты в приложении

1. Выберите класс `COleLinkingDoc` документов `COleDocument`из .

1. Создайте идентификатор класса OLE **(CLSID)** для вашего приложения с помощью генератора Class ID, включенного в инструменты разработки OLE.

1. Зарегистрируйте заявку в OLE.

1. Создание `COleTemplateServer` объекта в качестве члена класса приложений.

1. В функции `InitInstance` члена класса приложения следует следующее:

   - Подключите `COleTemplateServer` объект к шаблонам документов, позвонив `ConnectTemplate` в функцию члена объекта.

   - Вызов `COleTemplateServer::RegisterAll` функции участника для регистрации всех объектов класса с системой OLE.

   - Вызовите процедуру `COleTemplateServer::UpdateRegistry`. Единственный параметр `UpdateRegistry` должен быть *OAT_CONTAINER* если приложение не запущено с коммутатором "/Embedded". Это регистрирует приложение как контейнер, который может поддерживать ссылки на встроенные объекты.

      Если приложение запущено с помощью коммутатора "/Embedded", оно не должно отображать свое основное окно, похожее на серверное приложение.

Образец MFC OLE [OCLIENT](../overview/visual-cpp-samples.md) реализует эту функцию. Пример того, как это делается, см. `InitInstance` * CPP* файл этого образца приложения.

## <a name="see-also"></a>См. также раздел

[Контейнеры](../mfc/containers.md)<br/>
[Серверы](../mfc/servers.md)
