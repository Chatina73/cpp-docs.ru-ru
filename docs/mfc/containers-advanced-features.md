---
title: Контейнеры. Дополнительные возможности
ms.date: 11/04/2016
helpviewer_keywords:
- links [MFC], to embedded OLE objects
- containers [MFC], links to embedded OLE objects
- containers [MFC], advanced features
- container/server applications [MFC]
- embedded objects [MFC]
- OLE controls [MFC], containers
- OLE containers [MFC], advanced features
- server/container applications [MFC]
- containers [MFC], container applications
ms.assetid: 221fd99c-b138-40fa-ad6a-974e3b3ad1f8
ms.openlocfilehash: 1ef4ed9865d3a88a6ff85f777984b856d03cc48e
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84616362"
---
# <a name="containers-advanced-features"></a>Контейнеры. Дополнительные возможности

В этой статье описываются шаги, необходимые для включения дополнительных дополнительных функций в существующие приложения контейнера. Эти функции:

- [Приложение, которое является контейнером и сервером](#_core_creating_a_container_server_application)

- [Связь OLE с внедренным объектом](#_core_links_to_embedded_objects)

## <a name="creating-a-containerserver-application"></a><a name="_core_creating_a_container_server_application"></a>Создание приложения-контейнера или сервера

Приложение-контейнер или сервер — это приложение, которое выступает в качестве контейнера и сервера. Примером этого является Microsoft Word для Windows. Вы можете внедрять документы Word для Windows в другие приложения, а также внедрять элементы в документы Word для Windows. Процесс изменения приложения-контейнера как контейнера, так и полного сервера (Создание комбинированного контейнера или приложения минисервер) аналогичен процессу создания полного сервера.

Серверы статей [: реализация сервера](servers-implementing-a-server.md) содержит ряд задач, необходимых для реализации серверного приложения. При преобразовании приложения-контейнера в приложение-контейнер или сервер необходимо выполнить некоторые из этих же задач, добавив код в контейнер. Ниже перечислены важные моменты, которые следует учитывать.

- Код контейнера, созданный мастером приложений, уже инициализирует подсистему OLE. Вам не нужно будет изменять или добавлять данные для этой поддержки.

- В любом месте, где находится базовый класс класса документа `COleDocument` , измените базовый класс на `COleServerDoc` .

- Переопределите `COleClientItem::CanActivate` , чтобы избежать изменения элементов на месте, пока сам сервер используется для изменения на месте.

   Например, пример приложения MFC OLE [OCLIENT](../overview/visual-cpp-samples.md) внедряет элемент, созданный приложением-контейнером или сервером. Вы открываете приложение OCLIENT и изменяете на месте элемент, созданный приложением-контейнером или сервером. При редактировании элемента приложения вы решили внедрить элемент, созданный в примере MFC OLE [HIERSVR](../overview/visual-cpp-samples.md). Для этого нельзя использовать активацию на месте. Чтобы активировать этот элемент, необходимо полностью открыть HIERSVR. Поскольку библиотека Microsoft Foundation Class не поддерживает эту функцию OLE, переопределение `COleClientItem::CanActivate` позволяет проверить эту ситуацию и предотвратить возможную ошибку времени выполнения в приложении.

Если вы создаете новое приложение и хотите, чтобы оно функционировало как контейнер или серверное приложение, выберите этот параметр в диалоговом окне Параметры OLE в мастере приложений, и эта поддержка будет создана автоматически. Дополнительные сведения см. в статье [Общие сведения о создании контейнера элементов управления ActiveX](reference/creating-an-mfc-activex-control-container.md). Дополнительные сведения о примерах MFC см. в разделе [примеры MFC](../overview/visual-cpp-samples.md#mfc-samples).

Обратите внимание, что вы не можете вставить приложение MDI в само себя. Приложение, которое является контейнером или сервером, не может быть вставлено в себя, если оно не является приложением SDI.

## <a name="links-to-embedded-objects"></a><a name="_core_links_to_embedded_objects"></a>Ссылки на внедренные объекты

Ссылки на внедренные объекты позволяют пользователю создать документ со ссылкой OLE на внедренный объект в приложении-контейнере. Например, создайте документ в текстовом процессоре, содержащем внедренную электронную таблицу. Если приложение поддерживает ссылки на внедренные объекты, оно может вставить ссылку на электронную таблицу, содержащуюся в документе текстового процессора. Эта функция позволяет приложению использовать информацию, содержащуюся в электронной таблице, без знания того, где он получил слово.

#### <a name="to-link-to-embedded-objects-in-your-application"></a>Связывание с внедренными объектами в приложении

1. Создайте производный класс документа от `COleLinkingDoc` вместо `COleDocument` .

1. Создайте идентификатор класса OLE (**CLSID**) для своего приложения с помощью ГЕНЕРАТОРа идентификаторов класса, входящего в состав средств разработки OLE.

1. Зарегистрируйте приложение в OLE.

1. Создайте `COleTemplateServer` объект в качестве члена класса приложения.

1. В функции члена класса приложения `InitInstance` выполните следующие действия.

   - Подключите `COleTemplateServer` объект к шаблонам документов, вызвав `ConnectTemplate` функцию члена объекта.

   - Вызовите `COleTemplateServer::RegisterAll` функцию члена, чтобы зарегистрировать все объекты класса в системе OLE.

   - Вызовите процедуру `COleTemplateServer::UpdateRegistry`. Единственный параметр `UpdateRegistry` должен быть *OAT_CONTAINER* , если приложение не запускается с параметром "/ембеддед". Это приложение регистрируется как контейнер, который может поддерживать ссылки на внедренные объекты.

      Если приложение запускается с параметром "/Ембеддед", оно не должно отображать его главное окно, аналогичное серверному приложению.

Эта функция реализована в образце [OCLIENT](../overview/visual-cpp-samples.md) библиотеки MFC OLE. Пример того, как это делается, см. в описании `InitInstance` функции в *OCLIENT. CPP* файла этого примера приложения.

## <a name="see-also"></a>См. также раздел

[Контейнеры](containers.md)<br/>
[Серверы](servers.md)
