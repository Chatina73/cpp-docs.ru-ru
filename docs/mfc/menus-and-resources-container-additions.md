---
title: Меню и ресурсы. Добавление контейнеров
ms.date: 11/04/2016
f1_keywords:
- IDP_OLE_INIT_FAILED
- IDP_FAILED_TO_CREATE
- VK_ESCAPE
helpviewer_keywords:
- application accelerator table [MFC]
- VK_ESCAPE key [MFC]
- IDP_FAILED_TO_CREATE macro [MFC]
- visual editing, application menus and resources
- OLE containers [MFC], menus and resources
- accelerator tables [MFC], container applications
- IDP_OLE_INIT_FAILED macro [MFC]
- CONTAIN tutorial [MFC]
- Links menu item [MFC]
ms.assetid: 425448be-8ca0-412e-909a-a3a9ce845288
ms.openlocfilehash: c8da58316f471f7b7d26e142cc1dd1ccaa6ad8b5
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364796"
---
# <a name="menus-and-resources-container-additions"></a>Меню и ресурсы. Добавление контейнеров

В этой статье разъясняются изменения, которые необходимо внести в меню и другие ресурсы в приложении для визуального редактирования контейнеров.

В контейнерных приложениях необходимо внести два типа изменений: изменения в существующие ресурсы для поддержки визуального редактирования OLE и добавление новых ресурсов, используемых для активации на месте. Если вы используете мастер приложения для создания контейнерного приложения, эти шаги будут сделаны для вас, но они могут потребовать некоторой настройки.

Если вы не используете мастера приложения, вы можете посмотреть на OCLIENT. RC, скрипт ресурса для приложения образца OCLIENT, чтобы увидеть, как эти изменения реализуются. Смотрите образец MFC OLE [OCLIENT](../overview/visual-cpp-samples.md).

Темы, затронутые в этой статье, включают:

- [Добавления в меню контейнеров](#_core_container_menu_additions)

- [Дополнения таблицы акселератора](#_core_container_application_accelerator_table_additions)

- [Дополнения строки таблицы](#_core_string_table_additions_for_container_applications)

## <a name="container-menu-additions"></a><a name="_core_container_menu_additions"></a>Добавления в меню контейнеров

Вы должны добавить следующие элементы в меню Edit:

|Item|Цель|
|----------|-------------|
|**Вставить новый объект**|Открывает диалоговую коробку object OLE Insert, чтобы вставить в документ связанный или встроенный элемент.|
|**Вставить ссылку**|Вставляет в документ ссылку на элемент на clipboard.|
|**OLE Глагол**|Вызывает основной глагол выбранного элемента. Текст этого элемента меню изменяется, чтобы отразить основной глагол выбранного элемента.|
|**Ссылки**|Открывает диалоговую коробку OLE Edit Links для изменения существующих связанных элементов.|

В дополнение к изменениям, перечисленным в этой статье, исходный файл должен включать AFXOLECL. RC, который необходим для реализации библиотеки класса Microsoft Foundation. Вставить новый объект является единственным необходимым дополнением меню. Другие элементы могут быть добавлены, но те, перечисленные здесь являются наиболее распространенными.

Необходимо создать новое меню для контейнерного приложения, если вы хотите поддержать активацию на месте содержащихся элементов. Это меню состоит из того же меню файлов и всплывающих меню окна, используемых при открытии файлов, но имеет два сепаратора, расположенных между ними. Эти сепараторы используются для указания того, где элемент сервера (компонента) должен размещать свои меню при активации на месте. Для получения дополнительной информации об этом меню слияния техники, см [Меню и ресурсы: Меню слияния](../mfc/menus-and-resources-menu-merging.md).

## <a name="container-application-accelerator-table-additions"></a><a name="_core_container_application_accelerator_table_additions"></a>Заявки на применение контейнеров Таблица Дополнения

Небольшие изменения в таблицах таблицы акселератора контейнерного приложения необходимы, если вы поддерживаете активацию на месте. Первое изменение позволяет пользователю нажать клавишу побега (ESC), чтобы отменить режим редактирования на месте. Добавьте следующую запись в основной таблицу акселератора:

|ID|Клавиши|Тип|
|--------|---------|----------|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

Второе изменение заключается в создании новой таблицы акселератора, которая соответствует новому ресурсу меню, созданному для активации на месте. В этой таблице есть записи для меню файлов и окон в дополнение к VK_ESCAPE приведенной выше. Следующим примером является таблица ускорителей, созданная для активации на месте в образце MFC [CONTAINER:](../overview/visual-cpp-samples.md)

|ID|Клавиши|Тип|
|--------|---------|----------|
|ID_FILE_NEW|CTRL+N|**VIRTKEY**|
|ID_FILE_OPEN|CTRL + O|**VIRTKEY**|
|ID_FILE_SAVE|CTRL+S|**VIRTKEY**|
|ID_FILE_PRINT|CTRL + P|**VIRTKEY**|
|ID_NEXT_PANE|VK_F6|**VIRTKEY**|
|ID_PREV_PANE|SHIFT-VK_F6|**VIRTKEY**|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

## <a name="string-table-additions-for-container-applications"></a><a name="_core_string_table_additions_for_container_applications"></a>Добавление строки таблицы для применений контейнера

Большинство изменений в строковых таблицах для тарных приложений соответствуют дополнительным пунктам меню, упомянутым в [дополнениях меню контейнеров.](#_core_container_menu_additions) Они поставляют текст, отображаемый в панели статуса, когда каждый элемент меню отображается. В качестве примера можно привести строки таблицы, генерируемые мастером приложения:

|ID|Строка|
|--------|------------|
|IDP_OLE_INIT_FAILED|Инициализация OLE не удалась. Убедитесь, что библиотеки OLE являются правильной версией.|
|IDP_FAILED_TO_CREATE|Не удалось создать объект. Убедитесь, что объект внесен в системный реестр.|

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Меню и ресурсы. Добавление серверов](../mfc/menus-and-resources-server-additions.md)
