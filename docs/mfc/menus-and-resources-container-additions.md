---
title: Меню и ресурсы. Добавление контейнеров
ms.date: 11/04/2016
f1_keywords:
- IDP_OLE_INIT_FAILED
- IDP_FAILED_TO_CREATE
- VK_ESCAPE
helpviewer_keywords:
- application accelerator table [MFC]
- VK_ESCAPE key [MFC]
- IDP_FAILED_TO_CREATE macro [MFC]
- visual editing, application menus and resources
- OLE containers [MFC], menus and resources
- accelerator tables [MFC], container applications
- IDP_OLE_INIT_FAILED macro [MFC]
- CONTAIN tutorial [MFC]
- Links menu item [MFC]
ms.assetid: 425448be-8ca0-412e-909a-a3a9ce845288
ms.openlocfilehash: a082a75ef0292e190e597f29be0cdc0bd0b497ef
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84626238"
---
# <a name="menus-and-resources-container-additions"></a>Меню и ресурсы. Добавление контейнеров

В этой статье объясняются изменения, которые необходимо внести в меню и другие ресурсы в приложении-контейнере визуального редактирования.

В приложениях-контейнерах необходимо внести два типа изменений: изменения в существующие ресурсы для поддержки визуального редактирования OLE и добавления новых ресурсов, используемых для активации на месте. Если вы используете мастер приложений для создания приложения контейнера, эти действия будут выполнены для вас, но для них может потребоваться настройка.

Если мастер приложений не используется, может потребоваться взглянуть на OCLIENT. RC, скрипт ресурсов для примера приложения OCLIENT, чтобы увидеть, как реализуются эти изменения. См. пример MFC OLE в образце [OCLIENT](../overview/visual-cpp-samples.md).

В этой статье рассматриваются следующие темы:

- [Добавления меню контейнеров](#_core_container_menu_additions)

- [Добавление таблицы сочетаний клавиш](#_core_container_application_accelerator_table_additions)

- [Добавление таблицы строк](#_core_string_table_additions_for_container_applications)

## <a name="container-menu-additions"></a><a name="_core_container_menu_additions"></a>Добавления меню контейнеров

В меню Правка необходимо добавить следующие элементы:

|Элемент|Назначение|
|----------|-------------|
|**Вставить новый объект**|Открытие диалогового окна «Вставка объекта OLE» для вставки в документ связанного или внедренного элемента.|
|**Вставить ссылку**|Вставляет ссылку на элемент в буфере обмена в документ.|
|**Команда OLE**|Вызывает основную команду выбранного элемента. Текст этого пункта меню изменяется в соответствии с первичной командой выбранного элемента.|
|**Ссылки**|Открытие диалогового окна изменение ссылок OLE для изменения существующих связанных элементов.|

В дополнение к изменениям, перечисленным в этой статье, исходный файл должен включать АФКСОЛЕКЛ. Версия-кандидат, необходимый для реализации библиотека Microsoft Foundation Class. Вставка нового объекта является единственным обязательным добавлением меню. Можно добавить другие элементы, но наиболее часто они перечислены ниже.

Необходимо создать новое меню для приложения-контейнера, если требуется поддержка встроенных элементов на месте. Это меню состоит из меню «файл» и всплывающих меню «окно», используемых при открытии файлов, но между ними установлены два разделителя. Эти разделители используются для указания места, где сервер (компонент) должен размещать свои меню при активации на месте. Дополнительные сведения об этом методе слияния меню см. в разделе меню [и ресурсы: слияние меню](menus-and-resources-menu-merging.md).

## <a name="container-application-accelerator-table-additions"></a><a name="_core_container_application_accelerator_table_additions"></a>Добавление таблицы ускорителя приложений контейнера

Небольшие изменения в ресурсах таблиц ускорителя приложения-контейнера необходимы, если поддерживается встроенная активация. Первое изменение позволяет пользователю нажать клавишу Escape (ESC), чтобы отменить режим редактирования на месте. Добавьте следующую запись в основную таблицу сочетаний клавиш:

|ID|Ключ|Тип|
|--------|---------|----------|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

Вторым изменением является создание новой таблицы сочетаний клавиш, которая соответствует новому ресурсу меню, созданному для активации на месте. Эта таблица содержит записи для меню "файл" и "окно" в дополнение к записи VK_ESCAPE выше. В следующем примере показана таблица сочетаний клавиш, созданная для активации на месте в образце [контейнера](../overview/visual-cpp-samples.md)MFC.

|ID|Ключ|Тип|
|--------|---------|----------|
|ID_FILE_NEW|CTRL+N|**VIRTKEY**|
|ID_FILE_OPEN|CTRL + O|**VIRTKEY**|
|ID_FILE_SAVE|CTRL+S|**VIRTKEY**|
|ID_FILE_PRINT|CTRL + P|**VIRTKEY**|
|ID_NEXT_PANE|VK_F6|**VIRTKEY**|
|ID_PREV_PANE|SHIFT + VK_F6|**VIRTKEY**|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

## <a name="string-table-additions-for-container-applications"></a><a name="_core_string_table_additions_for_container_applications"></a>Добавление строк таблицы для приложений контейнера

Большинство изменений в таблицах строк для приложений контейнеров соответствуют дополнительным пунктам меню, упомянутым в [дополнениях к меню контейнера](#_core_container_menu_additions). Они предоставляют текст, отображаемый в строке состояния при отображении каждого пункта меню. Ниже приведен пример записей таблицы строк, создаваемых мастером приложений.

|ID|Строка|
|--------|------------|
|IDP_OLE_INIT_FAILED|Не удалось инициализировать OLE. Убедитесь, что используются правильные версии библиотек OLE.|
|IDP_FAILED_TO_CREATE|Не удалось создать объект. Убедитесь, что объект указан в системном реестре.|

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](menus-and-resources-ole.md)<br/>
[Меню и ресурсы. Добавление серверов](menus-and-resources-server-additions.md)
