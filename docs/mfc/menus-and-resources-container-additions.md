---
title: 'Меню и ресурсы: Добавление контейнеров'
ms.date: 11/04/2016
f1_keywords:
- IDP_OLE_INIT_FAILED
- IDP_FAILED_TO_CREATE
- VK_ESCAPE
helpviewer_keywords:
- application accelerator table [MFC]
- VK_ESCAPE key [MFC]
- IDP_FAILED_TO_CREATE macro [MFC]
- visual editing, application menus and resources
- OLE containers [MFC], menus and resources
- accelerator tables [MFC], container applications
- IDP_OLE_INIT_FAILED macro [MFC]
- CONTAIN tutorial [MFC]
- Links menu item [MFC]
ms.assetid: 425448be-8ca0-412e-909a-a3a9ce845288
ms.openlocfilehash: b1a74fef743592d3d052226dac926fc7ddc58578
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2019
ms.locfileid: "58770347"
---
# <a name="menus-and-resources-container-additions"></a>Меню и ресурсы: Добавление контейнеров

В этой статье объясняется изменения, которые должны быть выполнены на меню и другие ресурсы в приложении контейнера визуального редактирования.

В приложениях контейнера, необходимо внести два типа изменений: изменения в существующие ресурсы для поддержки визуального редактирования OLE и добавления новых ресурсов, используемого для активации на месте. Если вы используете мастер приложений для создания приложения-контейнера, эти действия выполняются автоматически, но они могут потребовать некоторые настройки.

Если вы не используете мастер приложений, можно рассмотреть OCLIENT. Версия-Кандидат, сценарий ресурсов для OCLIENT пример приложения, чтобы увидеть, как реализованы эти изменения. См. в разделе примера MFC OLE [OCLIENT](../overview/visual-cpp-samples.md).

В этой статье рассматриваются:

- [Добавление меню контейнеров](#_core_container_menu_additions)

- [Дополнения таблицы сочетаний клавиш](#_core_container_application_accelerator_table_additions)

- [Строка таблицы дополнения](#_core_string_table_additions_for_container_applications)

##  <a name="_core_container_menu_additions"></a> Добавление меню контейнеров

Меню "Правка", необходимо добавить следующие элементы:

|Элемент|Цель|
|----------|-------------|
|**Вставить новый объект**|Открывает диалоговое окно вставки объекта OLE для вставки элемента связанный или внедренный в документ.|
|**Связать**|Вставляет ссылку на элемент в буфер обмена в документ.|
|**Команды OLE**|Вызывает первичный глагол выбранного элемента. Текст элемента этого меню изменяется, отражая первичный глагол выбранного элемента.|
|**Links**|Открывает диалоговое окно OLE изменить ссылки для изменения существующих связанных элементов.|

Помимо изменений, описанных в этой статье в файле исходного кода необходимо включить AFXOLECL. Версия-Кандидат, которая необходима для реализации библиотеки классов Microsoft Foundation. Вставка нового объекта заключается в добавлении только необходимые меню. Можно добавить другие элементы, но перечисленные ниже являются самыми распространенными.

Если вы хотите обеспечить поддержку активации по месту вложенные элементы, необходимо создать новое меню для приложения-контейнера. Это меню состоит из одного меню "файл" и окно всплывающих меню, используется, если файлы открыты, но он имеет два разделителя групп разрядов располагается между ними. Эти разделители используются для указания, где элемент server (компонент) (приложение) следует помещать его меню при активации на месте. Дополнительные сведения об этом приеме слияние меню см. в разделе [меню и ресурсы: Слияние меню](../mfc/menus-and-resources-menu-merging.md).

##  <a name="_core_container_application_accelerator_table_additions"></a> Добавление таблицы сочетаний клавиш приложения контейнеров

Небольшие изменения в ресурсы таблиц сочетаний клавиш приложения-контейнера необходимы, если вы пользуетесь активации на месте. Первое изменение позволяет пользователю нажать клавишу ESC (ESC), чтобы выйти из режима редактирования на месте. Добавьте следующую запись в таблице сочетаний клавиш основных:

|ID|Ключ|Тип|
|--------|---------|----------|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

Второе изменение — создать новую таблицу сочетаний клавиш, соответствующее Создание ресурсов меню для активации на месте. Эта таблица содержит записи для меню «файл» и «окно, в дополнение к записи VK_ESCAPE выше. В следующем примере представлен таблицы сочетаний клавиш, созданной для активации на месте в образце MFC [КОНТЕЙНЕРА](../overview/visual-cpp-samples.md):

|ID|Ключ|Тип|
|--------|---------|----------|
|ID_FILE_NEW|CTRL+N|**VIRTKEY**|
|ID_FILE_OPEN|CTRL+O|**VIRTKEY**|
|ID_FILE_SAVE|CTRL + S|**VIRTKEY**|
|ID_FILE_PRINT|CTRL+P|**VIRTKEY**|
|ID_NEXT_PANE|VK_F6|**VIRTKEY**|
|ID_PREV_PANE|SHIFT + VK_F6|**VIRTKEY**|
|ID_CANCEL_EDIT_CNTR|VK_ESCAPE|**VIRTKEY**|

##  <a name="_core_string_table_additions_for_container_applications"></a> Строка таблицы дополнения для приложения-контейнеры

Большинство изменений в таблицы строк для приложений контейнера соответствует дополнительных пунктов, упомянутых в [добавления меню контейнера](#_core_container_menu_additions). Они указать текст, отображаемый в строке состояния при отображении каждым пунктом меню. Например Вот таблица строк операций, которые мастер приложения создает:

|ID|String|
|--------|------------|
|IDP_OLE_INIT_FAILED|Не удалось инициализировать OLE. Убедитесь в наличии правильной версии библиотек OLE.|
|IDP_FAILED_TO_CREATE|Не удалось создать объект. Убедитесь, что он занесен в системный реестр.|

## <a name="see-also"></a>См. также

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Меню и ресурсы: Добавление серверов](../mfc/menus-and-resources-server-additions.md)
