---
title: Создание приложения с контейнером активных документов
ms.date: 11/04/2016
helpviewer_keywords:
- active documents [MFC], containers
- containers [MFC], active document
- active document containers [MFC], creating
- MFC COM, active document containment
- applications [MFC], active document container
ms.assetid: 14e2d022-a6c5-4249-8712-706b0f4433f7
ms.openlocfilehash: 860a8531a96a0671c808dba13523b492026eafe0
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84616344"
---
# <a name="creating-an-active-document-container-application"></a>Создание приложения с контейнером активных документов

Самый простой и рекомендуемый способ создания приложения контейнера активного документа — создание приложения контейнера MFC EXE с помощью мастера приложений MFC, а затем изменение приложения для поддержки включения активного документа.

#### <a name="to-create-an-active-document-container-application"></a>Создание приложения контейнера активного документа

1. В меню **файл** выберите пункт **проект**из подменю **создать** .

1. В левой области щелкните **Visual C++** тип проекта.

1. В области справа выберите **приложение MFC** .

1. Назовите проект *мипрож*и нажмите кнопку **ОК**.

1. Выберите страницу **Поддержка составного документа** .

1. Выберите параметр **контейнер** или **контейнер/полное-сервер** .

1. Установите флажок **Контейнер активного документа** .

1. Нажмите кнопку **Готово**.

1. Когда мастер приложений MFC закончит создание приложения, откройте следующие файлы с помощью обозреватель решений:

   - *Мипрожвиев. cpp*

1. В *мипрожвиев. cpp*внесите следующие изменения:

   - В `CMyProjView::OnPreparePrinting` замените содержимое функции следующим кодом:

     [!code-cpp[NVC_MFCDocView#56](codesnippet/cpp/creating-an-active-document-container-application_1.cpp)]

   `OnPreparePrinting`обеспечивает поддержку печати. Этот код заменяет собой `DoPreparePrinting` подготовку к печати по умолчанию.

   Включение активного документа обеспечивает улучшенную схему печати:

   - Вы можете сначала вызвать активный документ через его `IPrint` интерфейс и сообщить ему о необходимости распечатать. Это отличается от предыдущего включения OLE, в котором контейнер должен визуализировать изображение содержащегося элемента на `CDC` объект принтера.

   - Если это не удается, сообщите вложенному элементу о необходимости печати через его `IOleCommandTarget` интерфейс

   - Если это не удается, Сделайте собственную отрисовку элемента.

   Статические функции элементов `COleDocObjectItem::OnPrint` и `COleDocObjectItem::OnPreparePrinting` , как реализованные в предыдущем коде, обрабатывали эту улучшенную схему печати.

1. Добавьте собственную реализацию и создайте приложение.

## <a name="see-also"></a>См. также раздел

[Вложение активного документа](active-document-containment.md)
