---
title: Создание приложения с контейнером активных документов
ms.date: 11/04/2016
helpviewer_keywords:
- active documents [MFC], containers
- containers [MFC], active document
- active document containers [MFC], creating
- MFC COM, active document containment
- applications [MFC], active document container
ms.assetid: 14e2d022-a6c5-4249-8712-706b0f4433f7
ms.openlocfilehash: 965778fd5d17aa416b198c101edc3a445a39580b
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62152947"
---
# <a name="creating-an-active-document-container-application"></a>Создание приложения с контейнером активных документов

Простейший и наиболее рекомендуемый способ создания приложения с контейнером активных документов является создание приложения-контейнера MFC EXE-файла с помощью мастера приложений MFC, а затем измените приложение для поддержки вложения активного документа.

#### <a name="to-create-an-active-document-container-application"></a>Для создания приложения с контейнером активных документов

1. Из **файл** меню, щелкните **проекта**из **New** подменю.

1. В левой области щелкните **Visual C++** тип проекта.

1. Выберите **приложения MFC** на правой панели.

1. Назовите проект *MyProj*, нажмите кнопку **ОК**.

1. Выберите **поддержка составных документов** страницы.

1. Выберите **контейнера** или **контейнера/полносерверные** параметр.

1. Выберите **контейнер активного документа** "флажок".

1. Нажмите кнопку **Готово**.

1. Когда мастер приложений MFC завершит создание приложения, откройте следующие файлы в обозревателе решений:

   - *MyProjview.cpp*

1. В *MyProjview.cpp*, внесите следующие изменения:

   - В `CMyProjView::OnPreparePrinting`, замените содержимое функции следующим кодом:

     [!code-cpp[NVC_MFCDocView#56](../mfc/codesnippet/cpp/creating-an-active-document-container-application_1.cpp)]

   `OnPreparePrinting` предоставляет поддержку печати. Этот код заменяет `DoPreparePrinting`, который является подготовка печати по умолчанию.

   Вложение активного документа предоставляет Улучшенная схема печати:

   - Сначала можно вызвать активного документа по его `IPrint` интерфейс и указал сам. Это отличается от предыдущих вложения OLE, в котором было контейнера для отрисовки рисунка содержащегося элемента в принтер `CDC` объекта.

   - В случае неудачи сообщить содержащегося элемента для печати сам себя через его `IOleCommandTarget` интерфейса

   - В случае неудачи убедитесь в собственной отрисовки элемента.

   Статические функции-члены `COleDocObjectItem::OnPrint` и `COleDocObjectItem::OnPreparePrinting`, реализованный в предыдущем коде обработки Эта улучшенная схема печати.

1. Добавление собственной реализацией и выполните сборку приложения.

## <a name="see-also"></a>См. также

[Вложение активного документа](../mfc/active-document-containment.md)
