---
title: Выделение ресурсов GDI
ms.date: 06/03/2019
helpviewer_keywords:
- resources [MFC], printing
- GDI objects [MFC], allocating during printing
- printing [MFC], allocating GDI resources
ms.assetid: cef7e94d-5a27-4aea-a9ee-8369fc895d3a
ms.openlocfilehash: 672a9a2ce103ae7f53f61ae955f77276eb1d2945
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/15/2019
ms.locfileid: "69509277"
---
# <a name="allocating-gdi-resources"></a>Выделение ресурсов GDI

В этой статье объясняется, как выделять и освобождать объекты интерфейса графических устройств (GDI) Windows, необходимые для печати.

> [!NOTE]
>  Дополнительные сведения см. в [документации по пакету SDK для GDI+](/windows/win32/gdiplus/-gdiplus-gdi-start).

Предположим, что вам требуется использовать определенные шрифты, перья или другие объекты GDI для печати, но не для отображения на экране. Из-за необходимого им объема памяти неэффективно выделить эти объекты при запуске приложения. Если приложение не печатает документ, эта память может потребоваться для других целей. Лучше выделить их, когда печать начинается, и затем удалите их.

Чтобы выделить эти объекты GDI, переопределите функцию члена [онбегинпринтинг](../mfc/reference/cview-class.md#onbeginprinting) . Эта функция хорошо подходит для этой цели по двум причинам: Платформа вызывает эту функцию один раз в начале каждого задания печати и, в отличие от [онпрепарепринтинг](../mfc/reference/cview-class.md#onprepareprinting), эта функция имеет доступ к объекту [CDC](../mfc/reference/cdc-class.md) , представляющему устройство принтера. аудиодрайвера. Эти объекты можно сохранить для использования во время задания печати, определив переменные-члены в классе представления, которые указывают на объекты GDI (например, `CFont *` элементы и т. д.).

Чтобы использовать созданные объекты GDI, выберите их в контексте печатающего устройства в функции [печати](../mfc/reference/cview-class.md#onprint) элемента. Если вам нужны различные объекты GDI для разных страниц документа, можно проверить `m_nCurPage` элемент структуры [CPrintInfo](../mfc/reference/cprintinfo-structure.md) и выбрать соответствующий объект GDI. Если вам требуется объект GDI для нескольких последовательных страниц, в Windows необходимо выбирать его в контексте устройства при каждом вызове `OnPrint`.

Чтобы освободить эти объекты GDI, переопределите функцию члена [онендпринтинг](../mfc/reference/cview-class.md#onendprinting) . Платформа вызывает эту функцию в конце каждого задания печати, что дает вам возможность освободить объекты GDI для печати перед возвратом приложения к другим задачам.

## <a name="see-also"></a>См. также

[Печать](../mfc/printing.md)<br/>
[Печать по умолчанию](../mfc/how-default-printing-is-done.md)
