---
title: Версии библиотек MFC
ms.date: 05/08/2019
helpviewer_keywords:
- class libraries [MFC], building versions
- version information [MFC], MFC library
- MFC class library
- MFC class library, building
- MFC libraries
- MFC, library versions
- libraries [MFC], versions
ms.openlocfilehash: b8e32366d9ff43bd6e5770f64f0ba9d8bf6e56ab
ms.sourcegitcommit: 00e26915924869cd7eb3c971a7d0604388abd316
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2019
ms.locfileid: "65524789"
---
# <a name="mfc-library-versions"></a>Версии библиотек MFC

Библиотека MFC доступна в версиях, которые поддерживают однобайтовые ANSI и многобайтовая кодировка (MBCS) код, а также версий, поддерживающих Юникод (кодируется как UTF-16LE, набор символов Windows-машинный код). Каждой версии MFC доступна в качестве статической библиотеки или общую библиотеку DLL. Имеется также меньшего размера версии статической библиотеки MFC, оставляет элементы управления MFC для диалоговых окон, для приложений, которые очень чувствительны к размер и не нужны эти элементы управления. Библиотеки MFC, доступны в обоих отладки и версии для поддерживаемых архитектур, которые включают x86, x64 и процессорами ARM. Можно создать оба приложения (файлы .exe) и библиотеки DLL с любой версией библиотеки MFC. Существует также набор библиотеки MFC, скомпилированные для взаимодействия с управляемым кодом. Общие библиотеки DLL MFC включает номер версии, чтобы указать совместимость двоичных файлов библиотеки.

## <a name="automatic-linking-of-mfc-library-versions"></a>Автоматическая компоновка версии библиотеки MFC

Файлы заголовков MFC автоматически определить правильную версию библиотеки MFC, чтобы создать ссылку, на основе значений, заданных в среде сборки. Файлы заголовков MFC добавьте компилятора директивы для связывания в определенную версию библиотеки MFC.

Например AFX. Файл заголовка указывает компоновщику на необходимость связать полным статическим, ограниченные статический или общий версия библиотеки DLL MFC; ANSI/MBCS или Юникод версии; и отладки или окончательный версии, в зависимости от конфигурации сборки:

```cpp
#ifndef _AFXDLL
    #ifdef _AFX_NO_MFC_CONTROLS_IN_DIALOGS
        #ifdef _DEBUG
            #pragma comment(lib, "afxnmcdd.lib")
        #else
            #pragma comment(lib, "afxnmcd.lib")
        #endif
        #pragma comment(linker, "/include:__afxNoMFCControlSupportInDialogs")
        #pragma comment(linker, "/include:__afxNoMFCControlContainerInDialogs")
    #endif
    #ifndef _UNICODE
        #ifdef _DEBUG
            #pragma comment(lib, "nafxcwd.lib")
        #else
            #pragma comment(lib, "nafxcw.lib")
        #endif
    #else
        #ifdef _DEBUG
            #pragma comment(lib, "uafxcwd.lib")
        #else
            #pragma comment(lib, "uafxcw.lib")
        #endif
    #endif
#else
    #ifndef _UNICODE
        #ifdef _DEBUG
            #pragma comment(lib, "mfc" _MFC_FILENAME_VER "d.lib")
            #pragma comment(lib, "mfcs" _MFC_FILENAME_VER "d.lib")
        #else
            #pragma comment(lib, "mfc" _MFC_FILENAME_VER ".lib")
            #pragma comment(lib, "mfcs" _MFC_FILENAME_VER ".lib")
        #endif
    #else
        #ifdef _DEBUG
            #pragma comment(lib, "mfc" _MFC_FILENAME_VER "ud.lib")
            #pragma comment(lib, "mfcs" _MFC_FILENAME_VER "ud.lib")
        #else
            #pragma comment(lib, "mfc" _MFC_FILENAME_VER "u.lib")
            #pragma comment(lib, "mfcs" _MFC_FILENAME_VER "u.lib")
        #endif
    #endif
#endif
```

Файлы заголовков MFC также включать директивы, чтобы связать все необходимые библиотеки, включая библиотеки MFC, библиотеки Win32, библиотеки OLE, OLE библиотеках, собранных из примеров, ODBC библиотек и т. д.

## <a name="ansi-mbcs-and-unicode"></a>ANSI, многобайтовой Кодировки и Юникода

Версии библиотек MFC ANSI/MBCS поддерживает оба набора однобайтовых символов, например ASCII, и многобайтовые кодировки например Shift-JIS. Версии библиотек MFC Юникода поддерживают Юникод в его в кодировке Юникода UTF-16LE. Использование версии библиотек ANSI/MBCS для MFC для поддержки формата Юникод в кодировке UTF-8.

Чтобы задать конфигурацию проекта, чтобы использовать однобайтовый Многобайтовый и расширенных строковых и символьных поддержка Юникода в интегрированной среде разработки, используйте **свойства проекта** диалоговое окно. В **свойства конфигурации** > **Общие** странице **кодировка** свойства **не задано** для использования набор однобайтовых символов. Присвойте свойству **использовать многобайтовую кодировку** использовать многобайтовую кодировку, или к **использовать набор символов Юникода** использовать Юникод в кодировке UTF-16.

Проекты MFC использовать символ препроцессора \_ЮНИКОДА, чтобы указать поддержку Юникода UTF-16 Юникода, и \_поддержка MBCS, чтобы указать MBCS. Эти параметры являются взаимно исключают друг друга в проекте.

## <a name="mfc-static-library-naming-conventions"></a>Соглашения об именовании для статической библиотеки MFC

Статические библиотеки для MFC используют следующие правила именования. Имена библиотек иметь форму

> <em>u</em>AFX<em>компакт-диска</em>. LIB

где курсивом строчные буквы — это заполнители для спецификаторы, чьи значения показаны в следующей таблице:

|Описатель|Значения и описание|
|---------------|-------------------------|
|*u*|(N) ANSI/MBCS или Юникод (U); исключить версии без элементов управления MFC в диалоговых окнах|
|*c*|Версии с помощью элементов управления MFC в диалоговых окнах (CW) или без (NMCD)|
|*d*|Отладка или выпуск: D = Debug; опустить описатель для выпуска|

Включены все библиотеки, перечисленные в следующей таблице предварительно созданной в каталоге \atlmfc\lib для построения поддерживаемых архитектур.

|Библиотека|Описание|
|-------------|-----------------|
|NAFXCW.LIB|Статическая библиотека MFC, версии выпуска|
|NAFXCWD.LIB|Статическая библиотека MFC, отладочная версия|
|UAFXCW. LIB|Статическая библиотека MFC с поддержкой Юникода, версия выпуска|
|UAFXCWD. LIB|Статическая библиотека MFC с поддержкой Юникода, в отладочной версии|
|AFXNMCD.LIB|Статическая библиотека MFC без элементов управления диалоговых окон MFC, версии выпуска|
|AFXNMCDD.LIB|Статическая библиотека MFC без элементов управления диалоговых окон MFC, отладочная версия|

Файлы отладчика, имеющие такое же базовое имя и расширение .pdb также доступны для каждого из статических библиотек.

## <a name="mfc-shared-dll-naming-conventions"></a>Общие соглашения об именовании DLL MFC

MFC общих библиотек DLL также выполните структурированное соглашение об именовании. Это упрощает знать, какие библиотеки DLL или библиотеке следует использовать для какой цели.

Библиотеки DLL MFC имеют *версии* числами, указывающими совместимость двоичных данных. Использование библиотек DLL MFC, имеют ту же версию, как к библиотекам и набор инструментов компилятора для обеспечения совместимости в рамках проекта.

|DLL|Описание|
|---------|-----------------|
|MFC*версии*. БИБЛИОТЕКИ DLL|Версия библиотеки DLL MFC, ANSI или MBCS выпуска|
|MFC*версии*U.DLL|Библиотека DLL MFC, версии Юникода|
|MFC*версии*D.DLL|Версия библиотеки DLL MFC, ANSI или отладка MBCS|
|MFC*версии*доменов обновления. БИБЛИОТЕКИ DLL|Библиотека DLL MFC, отладочная версия Юникод|
|MFCM*версии*. БИБЛИОТЕКИ DLL|Библиотека DLL MFC с элементами управления Windows Forms, ANSI или MBCS окончательной версии|
|MFCM*версии*U.DLL|Библиотека DLL MFC с элементами управления Windows Forms, Юникод версии|
|MFCM*версии*D.DLL|Библиотека DLL MFC с элементами управления Windows Forms, ANSI и MBCS отладки версии|
|MFCM*версии*доменов обновления. БИБЛИОТЕКИ DLL|Библиотека DLL MFC с элементами управления Windows Forms, отладочная версия Юникод|

Импорт библиотеки, необходимые для построения приложений или библиотек DLL, использующие эти общие библиотеки DLL расширений MFC имеют такое же базовое имя библиотеки DLL, но имеют расширение имени файла LIB-файле. При использовании общих библиотек DLL, небольшой статической библиотеки по-прежнему должны быть связаны с кодом; Эта библиотека называется MFCS*версии*.lib {U} {D}.

Если вы динамически привязать общедоступную версию библиотеки DLL MFC, будь то из приложения или из библиотеки DLL расширения MFC, необходимо включить соответствующий MFC*версии*. Библиотеки DLL или MFC*версии*U.DLL при развертывании продукта.

Список Visual C++ библиотеки DLL, которые могут распространяться с приложениями, см. в разделе [распространяемый код для Microsoft Visual Studio 2017 и Microsoft Visual Studio 2017 SDK (включает служебные программы и файлы BuildServer)](/visualstudio/productinfo/2017-redistribution-vs) или [ Распространяемый код для Visual Studio 2019](/visualstudio/releases/2019/redistribution).

Дополнительные сведения о поддержке многобайтовой Кодировки и Юникода в MFC см. в разделе [многобайтовых кодировку (MBCS) поддержка Юникода и](../atl-mfc-shared/unicode-and-multibyte-character-set-mbcs-support.md).

## <a name="dynamic-link-library-support"></a>Поддержка библиотек динамической компоновки

Можно использовать любой статический или общий динамической библиотеки MFC для создания библиотек DLL, которые могут использоваться MFC и не являющихся MFC исполняемые файлы. Они называются «обычные библиотеки DLL» или «регулярных DLL MFC», чтобы отличать их от расширения MFC библиотеки DLL, которые могут быть только используемые приложения MFC и MFC DLL. Библиотека DLL, собранная с помощью статических библиотек MFC в иногда называют USRDLL старые ссылки, так как проекты библиотеки DLL MFC определен символ препроцессора  **\_USRDLL**. Библиотеки DLL, использующий MFC общие библиотеки DLL в иногда называют AFXDLL старые ссылки, так как она определяет символ препроцессора  **\_AFXDLL**.

При создании проекта DLL, связав с статические библиотеки MFC DLL могут развертываться без MFC общих библиотек DLL. Когда проект DLL связан импорта библиотеки MFC*версии*. LIB или MFC*версии*U.LIB, необходимо развернуть соответствующий общие MFC DLL MFC*версии*. Библиотеки DLL или MFC*версии*U.DLL вместе с DLL. Дополнительные сведения см. в разделе [библиотеки DLL](../build/dlls-in-visual-cpp.md).

## <a name="see-also"></a>См. также

[Общие разделы по MFC](../mfc/general-mfc-topics.md)
