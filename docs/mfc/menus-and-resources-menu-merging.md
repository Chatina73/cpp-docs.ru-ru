---
title: Меню и ресурсы. Слияние меню
ms.date: 11/04/2016
helpviewer_keywords:
- status bars [MFC], OLE document applications
- visual editing [MFC], application menus and resources
- coordinating menu layouts [MFC]
- OLE containers [MFC], menus and resources
- toolbars [MFC], OLE document applications
- merging toolbar and status bar [MFC]
- menus [MFC], OLE document applications
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
ms.openlocfilehash: 149af83bd53b7a97fd264bd6b18701fc9f64ea1f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364761"
---
# <a name="menus-and-resources-menu-merging"></a>Меню и ресурсы. Слияние меню

В этой статье подробно описаны шаги, необходимые для приложений документа OLE для правильного редактирования и активации на месте. Активация на месте создает проблему как для контейнерных, так и для серверных (компонентных) приложений. Пользователь остается в том же окне кадра (в контексте контейнерного документа), но фактически работает другое приложение (сервер). Это требует координации между ресурсами контейнерных и серверных приложений.

Темы, затронутые в этой статье, включают:

- [Меню Layouts](#_core_menu_layouts)

- [Панели инструментов и статусные батончики](#_core_toolbars_and_status_bars)

## <a name="menu-layouts"></a><a name="_core_menu_layouts"></a>Меню Layouts

Первым шагом является координация макетов меню. Контейнерные приложения должны создавать новое меню, используемое только при активации встроенных элементов. Как минимум, это меню должно состоять из следующих, в порядке, перечисленном:

1. Меню файлов, идентичное тому, что используется при открытии файлов. (Обычно никакие другие элементы меню не помещаются перед следующим пунктом.)

1. Два последовательных сепаратора.

1. Меню окна идентично тому, которое используется при открытии файлов (только если контейнерное приложение в приложении MDI). Некоторые приложения могут иметь другие меню, такие как меню Options, которые относятся к этой группе, которая остается в меню при активации встроенного элемента.

    > [!NOTE]
    >  Могут быть и другие меню, влияющие на представление контейнерного документа, например, Масштабирование. Эти меню контейнеров отображаются между двумя сепараторами в этом ресурсе меню.

Серверные (компонентные) приложения также должны создать новое меню специально для активации на месте. Это должно быть похоже на меню, используемое при открытии файлов, но без элементов меню, таких как файл и окно, которые манипулируют серверным документом вместо данных. Как правило, это меню состоит из следующих:

1. Оторитете меню, идентичное тому, что используется при открытии файлов.

1. Разделитель.

1. Меню редактирования объектов, например меню Pen в примерном приложении Scribble.

1. Разделитель.

1. Меню справки.

Например, взгляните на макет некоторых меню на месте образца для контейнера и сервера. Детали каждого элемента меню были удалены, чтобы сделать пример более ясным. Меню контейнера состоит из следующих записей:

```
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&File C1"
    MENUITEM SEPARATOR
    POPUP "&Zoom C2"
    MENUITEM SEPARATOR
    POPUP "&Options C3"
    POPUP "&Window C3"
END
```

Последовательные сепараторы указывают, куда должна пойти первая часть меню сервера. Теперь посмотрите на меню сервера на месте:

```
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&Edit S1"
    MENUITEM SEPARATOR
    POPUP "&Format S2"
    MENUITEM SEPARATOR
    POPUP "&Help S3"
END
```

Сепараторы здесь указывают, куда должна пойти вторая группа элементов меню контейнеров. Полученная структура меню при активации объекта с этого сервера внутри этого контейнера выглядит следующим образом:

```
BEGIN
    POPUP "&File C1"
    POPUP "&Edit S1"
    POPUP "&Zoom C2"
    POPUP "&Format S2"
    POPUP "&Options C3
    POPUP "&Window C3"
    POPUP "&Help S3"
END
```

Как вы можете видеть, сепараторы были заменены различными группами меню каждого приложения.

Таблицы акселератора, связанные с меню на месте, также должны быть предоставлены серверным приложением. Контейнер будет включать их в свои собственные таблицы ускорителя.

При активации встроенного элемента фреймворк загружает меню на месте. Затем он запрашивает серверное приложение для его меню для активации на месте и вставляет его там, где находятся сепараторы. Так сочетаются меню. Вы получаете меню из контейнера для работы на файле и размещение окна, и вы получаете меню от сервера для работы на элементе.

## <a name="toolbars-and-status-bars"></a><a name="_core_toolbars_and_status_bars"></a>Панели инструментов и статусные батончики

Серверные приложения должны создать новую панель инструментов и хранить свою битную карту в отдельном файле. Приложения, созданные мастером, хранят эту биткарту в файле iTOOLBAR. Bmp. Новая панель инструментов заменяет панель инструментов контейнерного приложения при активации элемента сервера и должна содержать те же элементы, что и обычная панель инструментов, но удалять значки, представляющие элементы в меню файла и окна.

Эта панель инструментов загружается в класс, `COleIPFrameWnd`созданный для вас мастером приложения. Панель статуса обрабатывается контейнерным приложением. Для получения дополнительной информации о реализации [Servers: Implementing a Server](../mfc/servers-implementing-a-server.md)окон кадра на месте см.

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Активация](../mfc/activation-cpp.md)<br/>
[Серверы](../mfc/servers.md)<br/>
[Контейнеры](../mfc/containers.md)
