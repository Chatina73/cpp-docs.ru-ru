---
description: 'Дополнительные сведения о меню и ресурсах: слияние меню'
title: Меню и ресурсы. Слияние меню
ms.date: 11/04/2016
helpviewer_keywords:
- status bars [MFC], OLE document applications
- visual editing [MFC], application menus and resources
- coordinating menu layouts [MFC]
- OLE containers [MFC], menus and resources
- toolbars [MFC], OLE document applications
- merging toolbar and status bar [MFC]
- menus [MFC], OLE document applications
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
ms.openlocfilehash: b326e02fb4dbdaaef0ae6015fef6b647cc85b907
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97227979"
---
# <a name="menus-and-resources-menu-merging"></a>Меню и ресурсы. Слияние меню

В этой статье подробно описаны действия, необходимые для работы приложений документов OLE для правильной работы визуального редактирования и активации на месте. Встроенная активация создает запрос как для контейнеров, так и для серверных приложений (компонентов). Пользователь остается в том же окне фрейма (в контексте документа-контейнера), но фактически выполняет другое приложение (сервер). Для этого требуется координация между ресурсами контейнера и серверных приложений.

В этой статье рассматриваются следующие темы:

- [Макеты меню](#_core_menu_layouts)

- [Панели инструментов и строки состояния](#_core_toolbars_and_status_bars)

## <a name="menu-layouts"></a><a name="_core_menu_layouts"></a> Макеты меню

Первым шагом является координация макетов меню. Приложения-контейнеры должны создать новое меню, которое будет использоваться только в том случае, если внедренные элементы активированы на месте. Как минимум, это меню должно содержать следующие значения в указанном порядке:

1. Меню "файл" идентично тому, которое использовалось при открытии файлов. (Обычно другие пункты меню не помещаются перед следующим элементом.)

1. Два последовательных разделителя.

1. Меню окна идентично тому, которое использовалось при открытии файлов (только в случае, если приложение-контейнер находится в приложении MDI). Некоторые приложения могут иметь другие меню, например меню параметров, которые находятся в этой группе, что остается в меню, когда внедренный элемент активируется на месте.

    > [!NOTE]
    >  Могут существовать другие меню, влияющие на представление документа контейнера, например масштаб. Эти меню контейнеров отображаются между двумя разделителями в этом ресурсе меню.

Сервер (компонент) также должен создать новое меню специально для активации на месте. Это должно быть похоже на меню, используемое при открытии файлов, но без пунктов меню, таких как файл и окно, которые управляют документом сервера, а не данными. Как правило, это меню состоит из следующих элементов:

1. Меню "Правка" идентично тому, которое использовалось при открытии файлов.

1. Двоеточи.

1. Меню редактирования объектов, например меню "перо" в образце приложения Scribble.

1. Двоеточи.

1. Меню "Справка".

Например, рассмотрим макет некоторых примеров меню на месте для контейнера и сервера. Сведения о каждом элементе меню были удалены, чтобы сделать пример более четким. В меню на месте контейнера находятся следующие записи:

```
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&File C1"
    MENUITEM SEPARATOR
    POPUP "&Zoom C2"
    MENUITEM SEPARATOR
    POPUP "&Options C3"
    POPUP "&Window C3"
END
```

Последовательные разделители указывают, где должна идти первая часть меню сервера. Теперь взгляните на серверное меню на месте:

```
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&Edit S1"
    MENUITEM SEPARATOR
    POPUP "&Format S2"
    MENUITEM SEPARATOR
    POPUP "&Help S3"
END
```

Разделители здесь указывают место, куда должна попасть вторая группа элементов меню контейнера. Итоговая структура меню, когда объект с этого сервера активируется на месте внутри этого контейнера, выглядит следующим образом:

```
BEGIN
    POPUP "&File C1"
    POPUP "&Edit S1"
    POPUP "&Zoom C2"
    POPUP "&Format S2"
    POPUP "&Options C3
    POPUP "&Window C3"
    POPUP "&Help S3"
END
```

Как видите, разделители были заменены различными группами меню каждого приложения.

Таблицы сочетаний клавиш, связанные с меню «на месте», также должны быть предоставлены серверным приложением. Контейнер будет включать их в собственные таблицы ускорителей.

Когда внедренный элемент активируется на месте, платформа загружает меню на месте. Затем он запрашивает серверное приложение для своего меню для активации на месте и вставляет его там, где находятся разделители. Это то, как объединяются меню. Вы получаете меню из контейнера для работы с расположением файлов и окон, а также получаете меню с сервера для работы с элементом.

## <a name="toolbars-and-status-bars"></a><a name="_core_toolbars_and_status_bars"></a> Панели инструментов и строки состояния

Серверные приложения должны создать новую панель инструментов и сохранить ее растровое изображение в отдельном файле. Приложения, создаваемые мастером приложений, хранят это изображение в файле с именем ITOOLBAR.BMP. Новая панель инструментов заменяет панель инструментов приложения контейнера, когда элемент сервера активируется на месте, и должен содержать те же элементы, что и обычная панель инструментов, но удалять значки, представляющие элементы, в меню файлов и окон.

Эта панель инструментов загружается в `COleIPFrameWnd` производный класс, созданный мастером приложений. Строка состояния обрабатывается приложением-контейнером. Дополнительные сведения о реализации окон фрейма на месте см. в разделе [серверы: реализация сервера](servers-implementing-a-server.md).

## <a name="see-also"></a>См. также раздел

[Меню и ресурсы (OLE)](menus-and-resources-ole.md)<br/>
[Активация](activation-cpp.md)<br/>
[Серверы](servers.md)<br/>
[Контейнеры](containers.md)
