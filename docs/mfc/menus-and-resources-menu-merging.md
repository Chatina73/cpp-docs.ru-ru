---
title: 'Меню и ресурсы: Слияние меню'
ms.date: 11/04/2016
helpviewer_keywords:
- status bars [MFC], OLE document applications
- visual editing [MFC], application menus and resources
- coordinating menu layouts [MFC]
- OLE containers [MFC], menus and resources
- toolbars [MFC], OLE document applications
- merging toolbar and status bar [MFC]
- menus [MFC], OLE document applications
ms.assetid: 80b6bb17-d830-4122-83f0-651fc112d4d1
ms.openlocfilehash: 1f7af7007e72cb8e01022c81a244fc70ba52a5cc
ms.sourcegitcommit: ecf274bcfe3a977c48745aaa243e5e731f1fdc5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2019
ms.locfileid: "66504823"
---
# <a name="menus-and-resources-menu-merging"></a>Меню и ресурсы: Слияние меню

В этой статье описаны действия, необходимые для приложения документов OLE для визуального редактирования и встроенная активация должным образом. Активация на месте представляет препятствие для контейнера и сервера приложений (компонент). Пользователь остается в одном окне фрейма (в контексте документа-контейнера), но фактически выполняется другое приложение (сервер). Для этого требуется координация между ресурсами контейнеров и сервера приложений.

В этой статье рассматриваются:

- [Макеты меню](#_core_menu_layouts)

- [Панели инструментов и строки состояния](#_core_toolbars_and_status_bars)

##  <a name="_core_menu_layouts"></a> Макеты меню

Первый шаг заключается в координации макеты меню. Приложения контейнера следует создать новое меню для использования только в том случае, если внедренные элементы активируются на месте. Как минимум это меню должен состоять из следующих значений, в указанном порядке:

1. Меню "файл" идентичен используется, если файлы открыты. (Обычно нет других пунктов меню помещаются до следующего элемента.)

1. Два последовательных разделителя.

1. Меню "окно" идентичен используется, если файлы открыты (только если приложение-контейнер в приложении MDI). Некоторые приложения могут иметь другие меню, таких как меню параметров, входящие в эту группу, которая сохраняется в меню, при активации внедренного элемента на месте.

    > [!NOTE]
    >  Могут существовать другие меню, которые влияют на представление документа-контейнера, таких как масштабирование. Эти меню контейнера отображаются между двумя разделителями в этот ресурс меню.

Приложения сервера (компонент) также следует создать новое меню специально для активации на месте. Она должна быть как меню, которое используется, если файлы открыты, но без элементов меню, таких как файл и окно, которое обработки документа сервера вместо самих данных. Как правило это меню состоит из следующих элементов:

1. Совпадающее с тем, если используются файлы, откройте меню "Правка".

1. Разделитель.

1. Правка меню, например меню перо в приложении-примере Scribble объектов.

1. Разделитель.

1. Меню "Справка".

Например рассмотрим макет некоторые меню в месте пример контейнера и сервера. Чтобы сделать пример более наглядным будут удалены сведения каждого элемента меню. Меню контейнера на месте имеет следующие записи:

```
IDR_CONTAINERTYPE_CNTR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&File C1"
    MENUITEM SEPARATOR
    POPUP "&Zoom C2"
    MENUITEM SEPARATOR
    POPUP "&Options C3"
    POPUP "&Window C3"
END
```

Последовательные разделители указывают, куда следует в первой части меню сервера. Теперь рассмотрим меню на месте сервера:

```
IDR_SERVERTYPE_SRVR_IP MENU PRELOAD DISCARDABLE
BEGIN
    POPUP "&Edit S1"
    MENUITEM SEPARATOR
    POPUP "&Format S2"
    MENUITEM SEPARATOR
    POPUP "&Help S3"
END
```

Разделители здесь указывают, куда следует вторая группа пунктов меню контейнера. Итоговую структуру меню при активации объекта с этого сервера на месте в данном контейнере выглядит следующим образом:

```
BEGIN
    POPUP "&File C1"
    POPUP "&Edit S1"
    POPUP "&Zoom C2"
    POPUP "&Format S2"
    POPUP "&Options C3
    POPUP "&Window C3"
    POPUP "&Help S3"
END
```

Как вы видите, разделители были заменены на разные группы меню каждого приложения.

Таблицы сочетаний клавиш, связанных с данным меню на месте также должен быть указан серверным приложением. Контейнер будет встраивать их в свои собственные таблицы сочетаний клавиш.

При активации внедренного элемента на месте платформы загружает меню на месте. Затем запрашивает серверное приложение для его меню активации на месте и вставляет его которых разделители. Это, как объединить меню. Вы получаете меню из контейнера для работы на файл и размещение окон, и появится меню с сервера для работы в элементе.

##  <a name="_core_toolbars_and_status_bars"></a> Панели инструментов и строки состояния

Серверные приложения необходимо создать новую панель инструментов и хранить его точечного рисунка в отдельном файле. Приложение, созданные мастером приложения хранить этой битовой карты в файл с именем ITOOLBAR. BMP. Новой панели инструментов заменяет панель инструментов приложения-контейнера, используется для сервера элемент активируется на месте и должны содержать те же элементы, как обычный панели инструментов, но удалить значки, представляющие элементы в меню «файл» и «окно.

Эта панель инструментов загружается в вашей `COleIPFrameWnd`-производный класс, созданный в мастере приложений. В строке состояния обрабатывается приложением-контейнером. Дополнительные сведения о реализации окон фрейма на месте, см. в разделе [серверов: Реализация сервера](../mfc/servers-implementing-a-server.md).

## <a name="see-also"></a>См. также

[Меню и ресурсы (OLE)](../mfc/menus-and-resources-ole.md)<br/>
[Активация](../mfc/activation-cpp.md)<br/>
[Серверы](../mfc/servers.md)<br/>
[Контейнеры](../mfc/containers.md)
