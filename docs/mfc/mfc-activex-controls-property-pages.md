---
title: Элементы управления ActiveX в MFC. Страницы свойств
ms.date: 11/19/2018
helpviewer_keywords:
- DDP_ functions [MFC]
- MFC ActiveX controls [MFC], properties
- property pages [MFC], MFC ActiveX controls
- DoDataExchange method [MFC]
- OLEIVERB_PROPERTIES
- CPropertyPageDialog class [MFC]
- MFC ActiveX controls [MFC], property pages
ms.assetid: 1506f87a-9fd6-4505-8380-0dbc9636230e
ms.openlocfilehash: c31d13e03483f8632f17a526da75ebe8e21bccbf
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364569"
---
# <a name="mfc-activex-controls-property-pages"></a>Элементы управления ActiveX в MFC. Страницы свойств

Страницы свойств позволяют пользователю управления ActiveX просматривать и изменять свойства управления ActiveX. Эти свойства доступны путем ссылаться на диалоговую коробку свойств управления, которая содержит одну или несколько страниц свойств, которые обеспечивают индивидуальный графический интерфейс для просмотра и редактирования свойств управления.

>[!IMPORTANT]
> ActiveX является устаревшей технологией, которая не должна использоваться для новых разработок. Для получения дополнительной информации о современных технологиях, которые заменяли ActiveX, [см.](activex-controls.md)

Страницы свойств управления ActiveX отображаются двумя способами:

- При вызове глагола свойств управления **(OLEIVERB_PROPERTIES)** элемент управления открывает модульное поле диалога свойств, содержащее страницы свойств элемента управления.

- Контейнер может отображать свой собственный бесрежимный диалоговый ящик, отображающие страницы свойств выбранного элемента управления.

Диалоговое поле свойств (иллюстрированное на следующем рисунке) состоит из области для отображения текущей страницы свойств, вкладок для переключения между страницами свойств и коллекции кнопок, выполняющих общие задачи, такие как закрытие диалога страницы свойств, отмена любых внесенных изменений или немедленное применение любых изменений в элементе управления ActiveX.

![Диалоговое окно “Свойства” Circ3](../mfc/media/vc373i1.gif "Диалоговое окно “Свойства” Circ3") <br/>
Свойства Диалог Box

В этой статье рассматриваются темы, связанные с использованием страниц свойств в элементе управления ActiveX. Сюда входит следующее.

- [Реализация страницы свойств по умолчанию для управления ActiveX](#_core_implementing_the_default_property_page)

- [Добавление элементов управления на страницу свойств](#_core_adding_controls_to_a_property_page)

- [Настройка функции DoDataExchange](#_core_customizing_the_dodataexchange_function)

Для получения дополнительной информации об использовании страниц свойств в элементе управления ActiveX см.

- [Элементы управления ActiveX в MFC. Добавление дополнительной страницы пользовательских свойств](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)

- [Элементы ActiveX в MFC. Использование стандартных страниц свойств](../mfc/mfc-activex-controls-using-stock-property-pages.md)

Для получения информации об использовании листов недвижимости в приложении MFC, кроме элемента управления ActiveX, [см.](../mfc/property-sheets-mfc.md)

## <a name="implementing-the-default-property-page"></a><a name="_core_implementing_the_default_property_page"></a>Реализация страницы свойств по умолчанию

Если вы используете ActiveX Control Wizard для создания проекта управления, Мастер управления ActiveX предоставляет класс страницы свойств по умолчанию для элемента управления, полученного из [класса COlePropertyPage.](../mfc/reference/colepropertypage-class.md) Первоначально эта страница свойств пуста, но вы можете добавить любой элемент управления диалоговым полем или набор элементов управления. Поскольку мастер управления ActiveX создает только один класс страницы свойств по `COlePropertyPage`умолчанию, дополнительные классы страниц свойств (также полученные из) должны быть созданы с помощью Class View. Для получения дополнительной информации [MFC ActiveX Controls: Adding Another Custom Property Page](../mfc/mfc-activex-controls-adding-another-custom-property-page.md)об этой процедуре см.

Реализация страницы свойств (в данном случае по умолчанию) представляет собой трехступенчатый процесс:

#### <a name="to-implement-a-property-page"></a>Реализация страницы свойств

1. Добавьте `COlePropertyPage`класс a-derived в проект управления. Если проект был создан с помощью мастера управления ActiveX (как в данном случае), класс страницы свойств по умолчанию уже существует.

1. Используйте редактор диалогов, чтобы добавить элементы управления в шаблон страницы свойств.

1. Настройте `DoDataExchange` функцию `COlePropertyPage`-производного класса для обмена значениями между управлением страницой свойств и управлением ActiveX.

Например, в следующих процедурах используется простой элемент управления (названный "Образец"). Образец был создан с помощью Мастера управления ActiveX и содержит только свойство субтитры акций.

## <a name="adding-controls-to-a-property-page"></a><a name="_core_adding_controls_to_a_property_page"></a>Добавление элементов управления на страницу свойств

#### <a name="to-add-controls-to-a-property-page"></a>Добавление элементов управления на страницу свойств

1. С открытым проектом управления, открытым видом ресурсов.

1. Дважды щелкните значок каталога **Dialog.**

1. Откройте IDD_PROPPAGE_SAMPLE диалоговую будку.

   Мастер управления ActiveX привязание названия проекта к концу идентификатора диалога, в данном случае, Образец.

1. Перетащите и перебросьте выбранный элемент управления из Toolbox в область диалогового окна.

1. В этом примере достаточно элемента управления текстовыми метками "Caption:" и элемента управления коробкой редактирования с IDC_CAPTION идентификатором.

1. Нажмите **Сохранить** на панели инструментов, чтобы сохранить изменения.

Теперь, когда пользовательский интерфейс был изменен, необходимо связать окно отсылки к свойству caption. Это делается в следующем разделе `CSamplePropPage::DoDataExchange` путем редактирования функции.

## <a name="customizing-the-dodataexchange-function"></a><a name="_core_customizing_the_dodataexchange_function"></a>Настройка функции DoDataExchange

Функция [CWnd: :DoDataExchange](../mfc/reference/cwnd-class.md#dodataexchange) позволяет связать значения страницы свойств с фактическими значениями свойств в элементе управления. Чтобы установить ссылки, необходимо сопоставить соответствующие поля страницы свойств с соответствующими свойствами управления.

Эти отображения реализуются с помощью страницы свойств **DDP_** функций. **Функции DDP_** работают как **DDX_** функции, используемые в стандартных диалогах MFC, за одним исключением. В дополнение к ссылке на переменную члена, **DDP_** функции берут имя свойства управления. Ниже приводится типичная `DoDataExchange` запись в функции для страницы свойств.

[!code-cpp[NVC_MFC_AxUI#31](../mfc/codesnippet/cpp/mfc-activex-controls-property-pages_1.cpp)]

Эта функция связывает переменную *m_caption* члена страницы свойств `DDP_TEXT` с Подписью, используя функцию.

После ввода элемента управления страницей свойств необходимо установить связь между управлением страницы свойства, IDC_CAPTION `DDP_Text` и фактическим свойством управления, caption, используя функцию, описанную выше.

[Страницы свойств](../mfc/reference/property-pages-mfc.md) доступны для других типов управления диалогом, таких как флажки, радиокнопки и ящики с списками. В таблице ниже перечислены весь набор страниц ы свойств **DDP_** функций и их целей:

### <a name="property-page-functions"></a>Функции страницы свойств

|Имя функции|Используйте эту функцию для ссылки|
|-------------------|-------------------------------|
|`DDP_CBIndex`|Индекс выбранной строки в комбо-коробке с свойством управления.|
|`DDP_CBString`|Выбранная строка в комбо-коробке с свойством управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью соответствовать ей.|
|`DDP_CBStringExact`|Выбранная строка в комбо-коробке с свойством управления. Выбранная строка и значение строки свойства должны точно соответствовать.|
|`DDP_Check`|Флажок с элементом управления.|
|`DDP_LBIndex`|Индекс выбранной строки в поле списка с свойством управления.|
|`DDP_LBString`|Выбранная строка в поле списка с свойством управления. Выбранная строка может начинаться с тех же букв, что и значение свойства, но не должна полностью соответствовать ей.|
|`DDP_LBStringExact`|Выбранная строка в поле списка с свойством управления. Выбранная строка и значение строки свойства должны точно соответствовать.|
|`DDP_Radio`|Кнопка радио с свойством управления.|
|`DDP_Text`|Текст с свойством управления.|

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Класс COlePropertyPage](../mfc/reference/colepropertypage-class.md)
