---
title: 'Путем перетаскивания: Реализация конечного расположения сброса'
ms.date: 11/04/2016
helpviewer_keywords:
- OLE drag and drop [MFC], implementing drop targets
- OLE drag and drop [MFC], drop target
- drag and drop [MFC], drop target
ms.assetid: 0689f1ec-5326-4008-b226-4b373c881358
ms.openlocfilehash: da04fa7fa84e7e5014d574583c9c95992db10f88
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57281956"
---
# <a name="drag-and-drop-implementing-a-drop-target"></a>Путем перетаскивания: Реализация конечного расположения сброса

В этой статье описывается, как сделать приложение целевого объекта перетаскивания. Реализация конечного расположения сброса требует немного больше работы, чем реализация источника сброса, но по-прежнему относительно просто. Эти методы также применяются к приложениям отличных от OLE.

#### <a name="to-implement-a-drop-target"></a>Для реализации перетаскивания

1. Добавьте переменную-член для каждого представления в приложении, которое вы хотите иметь целевого объекта перетаскивания. Эта переменная-член должен иметь тип `COleDropTarget` или класс, производный от него.

1. Класс представления функции, который обрабатывает **WM_CREATE** сообщение (обычно `OnCreate`), вызовите новую переменную члена `Register` функция-член. `Revoke` вызывается автоматически для вас при уничтожении представления.

1. Переопределите следующие функции. Если в приложении требуется такое же поведение, переопределение этих функций в классе представления. Если вы хотите изменить поведение в отдельных случаях или вы хотите включить удаление на не -`CView` windows, переопределить эти функции в вашей `COleDropTarget`-производного класса.

    |Переопределение|Чтобы разрешить|
    |--------------|--------------|
    |`OnDragEnter`|Удалите выполнения операций в окне. Вызывается, когда указатель мыши впервые входит окна.|
    |`OnDragLeave`|Особое поведение, когда операция перетаскивания выходит за пределы указанного окна.|
    |`OnDragOver`|Удалите выполнения операций в окне. Вызывается, когда указатель перетаскивается через окна.|
    |`OnDrop`|Обработка данных в указанное окно.|
    |`OnScrollBy`|Особое поведение для прокрутки при необходимости в окне целевых.|

См. в разделе MAINVIEW. CPP файл, который является частью образца MFC OLE [OCLIENT](../visual-cpp-samples.md) пример о работе этих функций.

Дополнительные сведения:

- [Реализация источника сброса](../mfc/drag-and-drop-implementing-a-drop-source.md)

- [Создание и уничтожение объектов данных OLE и источников данных](../mfc/data-objects-and-data-sources-creation-and-destruction.md)

- [Управление объектами OLE данных и источников данных](../mfc/data-objects-and-data-sources-manipulation.md)

## <a name="see-also"></a>См. также

[Перетаскивание (OLE)](../mfc/drag-and-drop-ole.md)<br/>
[Класс COleDropTarget](../mfc/reference/coledroptarget-class.md)
