---
title: Буфер обмена. Копирование и вставка данных
ms.date: 11/04/2016
helpviewer_keywords:
- Clipboard, copying data to
- Clipboard, pasting
ms.assetid: 580e10be-241f-4f9f-94cf-8302edc5beef
ms.openlocfilehash: cff9094315dc97e2040eb4dbad25d044c7c51a81
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62327149"
---
# <a name="clipboard-copying-and-pasting-data"></a>Буфер обмена. Копирование и вставка данных

В этом разделе описываются минимальные действия, необходимые для реализации копирования и вставки из буфера обмена в приложениях OLE. Рекомендуется ознакомиться с [объекты данных и источники данных (OLE)](../mfc/data-objects-and-data-sources-ole.md) разделы, прежде чем продолжить.

Прежде чем можно реализовать, копирование и вставка, сначала необходимо указать функции для обработки параметры копирования, вырезания и вставки в меню "Правка".

##  <a name="_core_copying_or_cutting_data"></a> Копирование или копирование данных

#### <a name="to-copy-data-to-the-clipboard"></a>Чтобы скопировать данные в буфер обмена

1. Определите является ли данных для копирования данных в собственном или внедренных или связанных элемент.

   - Если внедренных или связанных данных, получить указатель на `COleClientItem` объект, который был выделен.

   - Если данные в машинном коде и приложения — это сервер, создайте новый объект, производный от `COleServerItem` содержащий выбранные данные. В противном случае создайте `COleDataSource` объекта данных.

1. Вызовите выбранный элемент `CopyToClipboard` функция-член.

1. Если пользователь решает операцию Cut вместо операции копирования, удаления выбранных данных из приложения.

Пример этой последовательности см. в разделе `OnEditCut` и `OnEditCopy` функции в MFC OLE-пример программы [OCLIENT](../overview/visual-cpp-samples.md) и [HIERSVR](../overview/visual-cpp-samples.md). Обратите внимание на то, что в этих примерах сохраняют указатель на данный момент выбранные данные, шаг 1 уже завершена.

##  <a name="_core_pasting_data"></a> Вставка данных

Вставка данных сложнее, чем скопировать его, так как вам необходимо выбрать формат, используемый в Вставка данных в приложение.

#### <a name="to-paste-data-from-the-clipboard"></a>Вставка данных из буфера обмена

1. В классе представления, реализовать `OnEditPaste` для обслуживания пользователей, выбрав параметр вставки из меню "Правка".

1. В `OnEditPaste` функцию, создайте `COleDataObject` и вызовите его `AttachClipboard` функция-член для связывания этого объекта к данным в буфере обмена.

1. Вызовите `COleDataObject::IsDataAvailable` проверить, доступен ли определенный формат.

   Кроме того, можно использовать `COleDataObject::BeginEnumFormats` для поиска для других форматов, чтобы найти наиболее подходящий для вашего приложения.

1. Выполнение вставки формата.

Пример того, как это работает, см. в разделе реализации `OnEditPaste` функций-членов в представлении классов, определенных в MFC OLE примеров программ [OCLIENT](../overview/visual-cpp-samples.md) и [HIERSVR](../overview/visual-cpp-samples.md).

> [!TIP]
>  Основные преимущества от раздельной операции вставки в собственную функцию — что может использоваться один и тот же код вставить, при удалении данных в приложении во время операции перетаскивания и вставки. Как и в OCLIENT и HIERSVR вашей `OnDrop` функция также может вызывать `DoPasteItem`, повторно используя код, написанный для реализации операции вставки.

Чтобы обрабатывать параметр "Специальная вставка" в меню "Правка", см. в разделе [диалоговые окна в OLE](../mfc/dialog-boxes-in-ole.md).

### <a name="what-do-you-want-to-know-more-about"></a>Выберите для получения дополнительных сведений

- [Добавление других форматов](../mfc/clipboard-adding-other-formats.md)

- [Объекты и данные источников данных OLE и универсальный код передачи данных](../mfc/data-objects-and-data-sources-ole.md)

- [Перетаскивание OLE](../mfc/drag-and-drop-ole.md)

- [OLE](../mfc/ole-background.md)

## <a name="see-also"></a>См. также

[Буфер обмена. Использование механизма буфера обмена OLE](../mfc/clipboard-using-the-ole-clipboard-mechanism.md)
