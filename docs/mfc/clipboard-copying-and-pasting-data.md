---
title: Буфер обмена. Копирование и вставка данных
ms.date: 11/04/2016
helpviewer_keywords:
- Clipboard, copying data to
- Clipboard, pasting
ms.assetid: 580e10be-241f-4f9f-94cf-8302edc5beef
ms.openlocfilehash: ed3056ec4fb3d3098870a03522d3bf17f41fbe34
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84620706"
---
# <a name="clipboard-copying-and-pasting-data"></a>Буфер обмена. Копирование и вставка данных

В этом разделе описана минимальная работа, необходимая для реализации копирования в буфер обмена в приложении OLE и их вставления из него. Перед продолжением рекомендуется прочесть разделы " [объекты данных" и "источники данных (OLE)](data-objects-and-data-sources-ole.md) ".

Прежде чем можно будет реализовать копирование или вставку, необходимо сначала указать функции для работы с параметрами копирования, вырезания и вставки в меню Правка.

## <a name="copying-or-cutting-data"></a><a name="_core_copying_or_cutting_data"></a>Копирование или вырезание данных

#### <a name="to-copy-data-to-the-clipboard"></a>Копирование данных в буфер обмена

1. Определите, являются ли копируемые данные собственными или внедренными или связанными элементами.

   - Если данные внедрены или связаны, получите указатель на `COleClientItem` выбранный объект.

   - Если данные являются собственными и приложение является сервером, создайте новый объект, производный от, `COleServerItem` содержащего выбранные данные. В противном случае создайте `COleDataSource` объект для данных.

1. Вызов функции члена выбранного элемента `CopyToClipboard` .

1. Если пользователь выбрал операцию вырезания вместо операции копирования, удалите выбранные данные из приложения.

Пример этой последовательности см. в разделе `OnEditCut` `OnEditCopy` функции и в примерах программ MFC OLE [OCLIENT](../overview/visual-cpp-samples.md) и [HIERSVR](../overview/visual-cpp-samples.md). Обратите внимание, что эти примеры сохраняют указатель на текущие выбранные данные, поэтому шаг 1 уже завершен.

## <a name="pasting-data"></a><a name="_core_pasting_data"></a>Вставленные данные

Вставленные данные сложнее, чем копирование, так как необходимо выбрать формат, используемый при копировании данных в приложение.

#### <a name="to-paste-data-from-the-clipboard"></a>Вставка данных из буфера обмена

1. В классе представления реализуйте, `OnEditPaste` чтобы управлять пользователями, выбрав команду вставить в меню Правка.

1. В `OnEditPaste` функции создайте `COleDataObject` объект и вызовите его функцию- `AttachClipboard` член, чтобы связать этот объект с данными в буфере обмена.

1. Вызовите `COleDataObject::IsDataAvailable` , чтобы проверить, доступен ли определенный формат.

   Кроме того, можно использовать `COleDataObject::BeginEnumFormats` для поиска других форматов, пока не найдете наиболее подходящий для приложения.

1. Выполните вставку формата.

Пример того, как это работает, см. в разделе Реализация `OnEditPaste` функций членов в классах представлений, определенных в примерах программ MFC OLE [OCLIENT](../overview/visual-cpp-samples.md) и [HIERSVR](../overview/visual-cpp-samples.md).

> [!TIP]
> Основное преимущество разделения операции вставки на собственную функцию заключается в том, что тот же код вставки можно использовать при удалении данных в приложении во время операции перетаскивания. Как и в OCLIENT и HIERSVR, `OnDrop` функция также может вызывать `DoPasteItem` , повторно используя код, написанный для реализации операций вставки.

Чтобы изменить параметр Специальная вставка в меню Правка, см. раздел [диалоговые окна в OLE](dialog-boxes-in-ole.md).

### <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать подробнее

- [Добавление других форматов](clipboard-adding-other-formats.md)

- [Объекты данных OLE и источники данных и унифицированная отправка данных](data-objects-and-data-sources-ole.md)

- [Перетаскивание OLE](drag-and-drop-ole.md)

- [OLE](ole-background.md)

## <a name="see-also"></a>См. также раздел

[Буфер обмена. Использование механизма буфера обмена OLE](clipboard-using-the-ole-clipboard-mechanism.md)
