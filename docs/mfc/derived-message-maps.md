---
title: Производные схемы сообщений
ms.date: 11/19/2018
helpviewer_keywords:
- message handling [MFC], derived message handlers
- messages, routing
- message maps [MFC], derived
- derived message maps
ms.assetid: 21829556-6e64-40c3-8279-fed85d99de77
ms.openlocfilehash: 0868b12720cfa338ab7275a358e065506adc11d1
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84615919"
---
# <a name="derived-message-maps"></a>Производные схемы сообщений

Во время обработки сообщений проверка собственной схемы сообщений класса не является концом статьи схемы сообщений. Что произойдет, если класс `CMyView` (производный от `CView` ) не имеет соответствующей записи для сообщения

Помните, что `CView` базовый класс класса `CMyView` является производным от `CWnd` . Таким `CMyView` же *является,* `CView` а *—* `CWnd` . Каждый из этих классов имеет собственную схему сообщений. На рисунке "иерархия представлений" показана иерархическая связь классов, но следует помнить, что `CMyView` объект — это единственный объект, имеющий характеристики всех трех классов.

![Иерархия представления](../mfc/media/vc38621.gif "Иерархия представления") <br/>
Иерархия представлений

Таким образом, если сообщение не может быть сопоставлено в `CMyView` схеме сообщений класса, платформа также выполняет поиск по схеме сообщений непосредственного базового класса. `BEGIN_MESSAGE_MAP`Макрос в начале схемы сообщения определяет в качестве аргументов два имени класса:

[!code-cpp[NVC_MFCMessageHandling#2](codesnippet/cpp/derived-message-maps_1.cpp)]

Первый аргумент присваивает имя классу, которому принадлежит схема сообщений. Второй аргумент предоставляет соединение с непосредственным базовым классом — `CView` здесь, так что платформа может искать свою карту сообщений.

Поэтому обработчики сообщений, предоставляемые в базовом классе, наследуются производным классом. Это очень похоже на нормальные виртуальные функции-члены без необходимости делать все функции-члены обработчика виртуальными.

Если обработчик не найден ни в одном из схем сообщений базового класса, выполняется обработка сообщения по умолчанию. Если сообщение является командой, платформа направляет ее к следующему целевому объекту команды. Если это стандартное сообщение Windows, сообщение передается в соответствующую процедуру окна по умолчанию.

Для ускорения сопоставления сообщений Платформа кэширует последние совпадения по той вероятности, что она снова получит одно и то же сообщение. Один из последствий заключается в том, что инфраструктура обрабатывает необработанные сообщения довольно эффективно. Схемы сообщений также являются более эффективным пространством, чем реализации, использующие виртуальные функции.

## <a name="see-also"></a>См. также раздел

[Выполнение платформой поиска по схемам сообщений](how-the-framework-searches-message-maps.md)
