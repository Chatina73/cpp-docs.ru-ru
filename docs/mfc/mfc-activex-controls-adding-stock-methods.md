---
title: 'Элементы ActiveX в MFC: Добавление стандартных методов | Документация Майкрософт'
ms.custom: ''
ms.date: 09/12/2018
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- MFC ActiveX controls [MFC], stock methods
- MFC ActiveX controls [MFC], methods
- DoClick method [MFC]
ms.assetid: bc4fad78-cabd-4cc0-a798-464b1a682f0b
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7967b63a14c296d7f0d73bb403aa5b74a6c3689b
ms.sourcegitcommit: a3c9e7888b8f437a170327c4c175733ad9eb0454
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2018
ms.locfileid: "50204307"
---
# <a name="mfc-activex-controls-adding-stock-methods"></a>Элементы управления ActiveX в MFC. Добавление стандартных методов

Стандартный метод отличается от пользовательского метода, в том, что уже реализован классом [COleControl](../mfc/reference/colecontrol-class.md). Например `COleControl` содержит функцию стандартных элементов, которая поддерживает метод обновления для элемента управления. Запись сопоставления диспетчеризации для этого метода акций — DISP_STOCKFUNC_REFRESH.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которая не следует использовать для разработки новых приложений. Дополнительные сведения о современных технологий, заменяющие ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

`COleControl` поддерживает два стандартных методов: DoClick и обновления. Обновления вызывается пользователем элемента управления, чтобы немедленно обновить внешний вид элемента управления; DoClick вызывается для запуска элемента управления щелкните событие.

|Метод|Запись сопоставления диспетчеризации|Комментарий|
|------------|------------------------|-------------|
|`DoClick`|**(DISP_STOCKPROP_DOCLICK)**|Запускает событие Click.|
|`Refresh`|**(DISP_STOCKPROP_REFRESH)**|Немедленное обновление внешнего вида элемента управления.|

##  <a name="_core_adding_a_stock_method_using_classwizard"></a> Добавить метод с помощью мастер добавления метода

Добавление стандартных методов очень просто с помощью [мастер добавления метода](../ide/add-method-wizard.md). В следующей процедуре показано добавление метода Refresh в элемент управления, созданных с помощью мастера элементов управления ActiveX MFC.

#### <a name="to-add-the-stock-refresh-method-using-the-add-method-wizard"></a>Чтобы добавить метод Refresh акций, с помощью мастера добавления метода

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню, щелкните **добавить** и нажмите кнопку **добавить метод**.

   Откроется мастер добавления метода.

1. В **имя метода** выберите **обновить**.

1. Нажмите кнопку **Готово**.

##  <a name="_core_classwizard_changes_for_stock_methods"></a> Добавьте метод мастер изменения для стандартных методов

Так как базовый класс элемента управления, поддерживается метод Refresh акций **мастер добавления метода** не изменяет объявление класса элемента управления любым способом. Этот узел добавляет запись для метода, в диспетчерскую карту элемента управления и его. IDL-файла. Следующая строка добавляется схема подготовки к отправке элемента управления, расположенных в его реализации (. Файл CPP):

[!code-cpp[NVC_MFC_AxUI#16](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_1.cpp)]

Это делает метод Refresh доступным для пользователей элемента управления.

Следующая строка добавляется к элементу управления. IDL-файла:

[!code-cpp[NVC_MFC_AxUI#17](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_2.idl)]

Эта строка назначает метод обновления с определенным номером идентификатора.

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)

