---
title: Элементы управления ActiveX в MFC. Добавление стандартных методов
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], stock methods
- MFC ActiveX controls [MFC], methods
- DoClick method [MFC]
ms.assetid: bc4fad78-cabd-4cc0-a798-464b1a682f0b
ms.openlocfilehash: b4b01e4fb202cfd7a923d22cb57ce5ec6988e11d
ms.sourcegitcommit: a1676bf6caae05ecd698f26ed80c08828722b237
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/29/2020
ms.locfileid: "91502291"
---
# <a name="mfc-activex-controls-adding-stock-methods"></a>Элементы управления ActiveX в MFC. Добавление стандартных методов

Метод акции отличается от пользовательского метода тем, что он уже реализован классом [COleControl](reference/colecontrol-class.md). Например, `COleControl` содержит предопределенную функцию-член, которая поддерживает метод Refresh для элемента управления. Запись диспетчеризации для этого метода акции DISP_STOCKFUNC_REFRESH.

>[!IMPORTANT]
> ActiveX — это устаревшая технология, которую не следует использовать для новой разработки. Дополнительные сведения о современных технологиях, которые заменяют ActiveX, см. в разделе [элементы управления ActiveX](activex-controls.md).

`COleControl` поддерживает два метода хранения: DoClick и Refresh. Обновление вызывается пользователем элемента управления для немедленного обновления внешнего вида элемента управления; DoClick вызывается для срабатывания события Click элемента управления.

|Метод|Запись схемы диспетчеризации|Комментировать|
|------------|------------------------|-------------|
|`DoClick`|**DISP_STOCKPROP_DOCLICK ()**|Вызывает событие щелчка.|
|`Refresh`|**DISP_STOCKPROP_REFRESH ()**|Немедленно обновляет внешний вид элемента управления.|

## <a name="adding-a-stock-method-using-the-add-method-wizard"></a><a name="_core_adding_a_stock_method_using_classwizard"></a> Добавление метода акции с помощью мастера добавления метода

Добавление метода акции упрощается с помощью [мастера добавления метода](../ide/adding-a-method-visual-cpp.md#add-method-wizard). В следующей процедуре показано добавление метода Refresh к элементу управления, созданному с помощью мастера элементов управления ActiveX MFC.

#### <a name="to-add-the-stock-refresh-method-using-the-add-method-wizard"></a>Добавление метода обновления запасов с помощью мастера добавления метода

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню выберите команду **Добавить** , а затем нажмите кнопку **Добавить метод**.

   Откроется мастер добавления метода.

1. В поле **имя метода** щелкните **Обновить**.

1. Нажмите кнопку **Готово**.

## <a name="add-method-wizard-changes-for-stock-methods"></a><a name="_core_classwizard_changes_for_stock_methods"></a> Изменение мастера добавления метода для стандартных методов

Так как метод обновления запасов поддерживается базовым классом элемента управления, **Мастер добавления метода** не изменяет объявление класса элемента управления каким-либо образом. Он добавляет запись для метода в карту диспетчеризации элемента управления и в ее. IDL-файл. Следующая строка добавляется в карту диспетчеризации элемента управления, расположенную в его реализации (. Файл CPP):

[!code-cpp[NVC_MFC_AxUI#16](codesnippet/cpp/mfc-activex-controls-adding-stock-methods_1.cpp)]

Это делает метод обновления доступным для пользователей элемента управления.

Следующая строка добавляется в элемент управления. IDL-файл:

[!code-cpp[NVC_MFC_AxUI#17](codesnippet/cpp/mfc-activex-controls-adding-stock-methods_2.idl)]

Эта строка назначает методу Refresh конкретный ИДЕНТИФИКАЦИОНный номер.

## <a name="see-also"></a>См. также раздел

[Элементы управления ActiveX в MFC](mfc-activex-controls.md)
