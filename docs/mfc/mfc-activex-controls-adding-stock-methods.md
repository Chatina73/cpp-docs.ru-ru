---
title: Элементы управления ActiveX в MFC. Добавление стандартных методов
ms.date: 09/12/2018
helpviewer_keywords:
- MFC ActiveX controls [MFC], stock methods
- MFC ActiveX controls [MFC], methods
- DoClick method [MFC]
ms.assetid: bc4fad78-cabd-4cc0-a798-464b1a682f0b
ms.openlocfilehash: ec59ccc0cbd48fc3114eb2dc0833dd3dd65691de
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81364674"
---
# <a name="mfc-activex-controls-adding-stock-methods"></a>Элементы управления ActiveX в MFC. Добавление стандартных методов

Метод запаса отличается от пользовательского метода тем, что он уже реализован классом [COleControl.](../mfc/reference/colecontrol-class.md) Например, `COleControl` содержит предопределенную функцию члена, которая поддерживает метод обновления для управления. Запись на карту отправки для этого метода запасов является DISP_STOCKFUNC_REFRESH.

>[!IMPORTANT]
> ActiveX является устаревшей технологией, которая не должна использоваться для новых разработок. Для получения дополнительной информации о современных технологиях, которые заменяли ActiveX, [см.](activex-controls.md)

`COleControl`поддерживает два метода акций: DoClick и Refresh. Обновление вызывается пользователем элемента управления для немедленного обновления внешнего вида элемента; DoClick вызывается для стрельбы в кнопке события управления.

|Метод|Отправка карты запись|Комментарий|
|------------|------------------------|-------------|
|`DoClick`|**DISP_STOCKPROP_DOCLICK()**|Запускает событие Click.|
|`Refresh`|**DISP_STOCKPROP_REFRESH()**|Немедленно обновляет внешний вид элемента управления.|

## <a name="adding-a-stock-method-using-the-add-method-wizard"></a><a name="_core_adding_a_stock_method_using_classwizard"></a>Добавление метода запаса с использованием мастера метода добавления

Добавление метода акций просто с помощью [мастера метода](../ide/add-method-wizard.md)добавления. Следующая процедура демонстрирует добавление метода обновления в элемент управления, созданный с помощью MFC ActiveX Control Wizard.

#### <a name="to-add-the-stock-refresh-method-using-the-add-method-wizard"></a>Добавление метода обновления запасов с помощью мастера метода добавления

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. Из меню ярлыка, нажмите **Добавить,** а затем нажмите **Добавить метод**.

   Это открывает мастер метода добавления.

1. В поле **Имя метода** нажмите **Refresh**.

1. Нажмите кнопку **Готово**.

## <a name="add-method-wizard-changes-for-stock-methods"></a><a name="_core_classwizard_changes_for_stock_methods"></a>Добавление изменений мастера метода для методов запаса

Поскольку метод обновления запасов поддерживается базовым классом элемента управления, **мастер метода добавления** никоим образом не изменяет декларацию класса элемента управления. Он добавляет запись для метода на карту диспетчерской системы управления и к его . IdL файл. Следующая строка добавляется к диспетчерской карте управления, расположенной в ее реализации (. CPP) файл:

[!code-cpp[NVC_MFC_AxUI#16](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_1.cpp)]

Это делает метод Refresh доступным для пользователей управления.

Следующая строка добавляется к элементу управления. IDL файл:

[!code-cpp[NVC_MFC_AxUI#17](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-methods_2.idl)]

Эта строка присваивает методу Обновления определенный идентификационный номер.

## <a name="see-also"></a>См. также раздел

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)
