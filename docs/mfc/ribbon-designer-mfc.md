---
title: Конструктор лент (MFC)
ms.date: 11/19/2018
f1_keywords:
- vc.editors.ribbon.F1
helpviewer_keywords:
- Ribbon Designer (MFC)
- MFC Ribbon Designer
ms.assetid: 0806dfd6-7d11-471a-99e1-4072852231f9
ms.openlocfilehash: 8b66ff0f19392eb1685f8632a3fc4d9e90094304
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81372803"
---
# <a name="ribbon-designer-mfc"></a>Конструктор лент (MFC)

Конструктор лент позволяет создавать и настраивать ленту в приложениях MFC. Лента — это элемент пользовательского интерфейса (UI), который объединяет команды в логические группы. Эти группы отображаются на отдельных вкладках ленты в верхней части окна. Лента заменяет меню и панели инструментов. Лента может значительно повысить удобство использования приложения. Для получения дополнительной [информации,](/windows/win32/uxguide/cmd-ribbons)см Ленты . На следующем рисунке показана лента.

![Элемент управления ресурсом ленты MFC](../mfc/media/ribbon_no_callouts.png "Элемент управления ресурсом ленты MFC")

В более ранних версиях Visual Studio, ленты должны были быть созданы путем написания кода, который использует MFC ленты классов, таких как [CMFCRibbonBar класса](../mfc/reference/cmfcribbonbar-class.md). В Visual Studio 2010 и позже, лента дизайнер предоставляет альтернативный метод для создания лент. Во-первых, создайте и настройте ленту как ресурс. Затем загрузите ресурс ленты из кода в приложение MFC. Можно даже использовать ресурсы ленты и классы ленты MFC вместе. Например, можно создать ресурс ленты и программно добавлять дополнительные элементы в нее во время выполнения.

## <a name="understanding-the-ribbon-designer"></a>Основные сведения о конструкторе лент

Конструктор лент создает и сохраняет ленты как ресурсы. При создании ресурса ленты конструктор лент выполняет следующие три действия.

- Добавляет запись в скрипт определения ресурсов проекта (*.rc). В следующем примере IDR_RIBBON — это уникальное имя, идентифицирует ресурс ленты, RT_RIBBON_XML — тип ресурса, а ribbon.mfcribbon-ms — это название файла ресурса.

```cpp
    IDR_RIBBON RT_RIBBON_XML      "res\\ribbon.mfcribbon-ms"
```

- Добавляет определения идентификаторов команд в файл resource.h.

```
#define IDR_RIBBON            307
```

- Создает файл ресурсов ленты (*.mfcribbon-ms), который содержит XML-код, определяющий кнопки, элементы управления и атрибуты ленты. Изменения в конструкторе ленты на ленту сохраняются в файле ресурсов как XML. Следующий пример кода показывает часть \*содержимого файла .mfcribbon-ms:

```
<RIBBON_BAR>
<ELEMENT_NAME>RibbonBar</ELEMENT_NAME>
<IMAGE>
<ID>
<NAME>IDB_BUTTONS</NAME>
<VALUE>113</VALUE>
</ID>
```

Чтобы использовать ленточный ресурс в приложении MFC, загрузите ресурс, позвонив [по телефону CMFCRibbonBar:LoadFromResource](../mfc/reference/cmfcribbonbar-class.md#loadfromresource).

## <a name="creating-a-ribbon-by-using-the-ribbon-designer"></a>Создание ленты с помощью конструктора лент

Ниже описаны два способа для добавления ресурса ленты в проект MFC.

- Создайте приложение MFC и настройте мастер проектов MFC для создания ленты. Для получения дополнительной информации, [см. Walkthrough: Создание приложения лента с помощью MFC](../mfc/walkthrough-creating-a-ribbon-application-by-using-mfc.md).

- Создайте ресурс ленты в существующем проекте MFC и загрузите его. Для получения дополнительной информации [см. Walkthrough: Обновление MFC Scribble Application (Часть 1)](../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md).

Если в проекте уже есть вручную закодированная лента, MFC предоставляет функции, которые можно использовать для преобразования существующей ленты в ресурс ленты. Для получения дополнительной информации, [см. Как: Конвертировать существующие MFC Лента на ленту ресурсов](../mfc/how-to-convert-an-existing-mfc-ribbon-to-a-ribbon-resource.md).

> [!NOTE]
> Ленты не могут быть созданы в приложениях на базе диалоговых окон. Для получения дополнительной информации [см.](../mfc/reference/application-type-mfc-application-wizard.md)

## <a name="customizing-ribbons"></a>Настройка лент

Чтобы открыть ленту в конструкторе лент, дважды щелкните ресурс ленты в представлении ресурсов. В конструкторе можно добавлять, удалять и настраивать элементы на ленте, кнопку «Приложение» и панель инструментов быстрого доступа. Вы также можете привязать события, например события нажатия кнопки и события меню, к методу в приложении.

На следующем рисунке показаны различные компоненты конструктора лент.

![Конструктор лент MFC](../mfc/media/ribbon_designer.png "Конструктор лент MFC")

- **Коробка инструментов:** Содержит элементы управления, которые можно перетащить на поверхность конструктора.

- **Поверхность конструктора:** Содержит визуальное представление ленточного ресурса.

- ** [Класс Мастера](reference/mfc-class-wizard.md):** Перечисляет атрибуты элемента, выбранного на поверхности конструктора.

- **Окно просмотра ресурсов:** Отображает ресурсы, включающие ленточные ресурсы, в проекте.

- **Лента редактор панели инструментов:** Содержит команды, которые позволяют просмотреть ленту и изменить ее визуальную тему.

В следующих разделах описаны способы использования функций в конструкторе лент.

- [Практическое руководство. Настройка кнопки приложения](../mfc/how-to-customize-the-application-button.md)

- [Практическое руководство. Настройка панели быстрого доступа](../mfc/how-to-customize-the-quick-access-toolbar.md)

- [Практическое руководство. Добавление элементов управления и обработчиков событий ленты](../mfc/how-to-add-ribbon-controls-and-event-handlers.md)

- [Практическое руководство. Загрузка ресурса ленты из приложения MFC](../mfc/how-to-load-a-ribbon-resource-from-an-mfc-application.md)

## <a name="definitions-of-ribbon-elements"></a>Определения элементов ленты

![Лента MFC](../mfc/media/ribbon.png "Лента MFC")

- **Кнопка приложения:** Кнопка, которая появляется в верхнем левом углу ленты. Кнопка «Приложение» заменяет меню «Файл» и отображается, даже если лента свернута. При нажатии этой кнопки отображается меню, которое содержит список команд.

- **Панель инструментов быстрого доступа:** Небольшая настраиваемая панель инструментов, отображая часто используемые команды.

- **Категория**: Логическая группировка, представляющая содержимое ленты вкладке.

- **Кнопка категории по умолчанию:** Кнопка, которая появляется на ленте, когда лента сведена к минимуму. При нажатии кнопки категория снова появляется как меню.

- **Панель:** Область ленты бар, который отображает группу связанных элементов управления. Каждая категория ленты содержит одну или несколько панелей ленты.

- **Элементы ленты:** Элементы управления в панелях, например, кнопки и комбо коробки. Чтобы увидеть различные элементы управления, которые могут быть размещены на ленте, см [RibbonGadgets Пример: Лента Гаджеты приложение](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также раздел

[Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)<br/>
[Работа с файлами ресурсов](../windows/working-with-resource-files.md)
