---
title: Конструктор лент (MFC)
ms.date: 11/19/2018
f1_keywords:
- vc.editors.ribbon.F1
helpviewer_keywords:
- Ribbon Designer (MFC)
- MFC Ribbon Designer
ms.assetid: 0806dfd6-7d11-471a-99e1-4072852231f9
ms.openlocfilehash: 0972cdfbb80129b0c87c96fa7daf6768d18aa0c4
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57288792"
---
# <a name="ribbon-designer-mfc"></a>Конструктор лент (MFC)

Конструктор лент позволяет создавать и настраивать ленту в приложениях MFC. Лента — это элемент пользовательского интерфейса (UI), который объединяет команды в логические группы. Эти группы отображаются на отдельных вкладках ленты в верхней части окна. Лента заменяет меню и панели инструментов. Лента может значительно повысить удобство использования приложения. Дополнительные сведения см. в разделе [лент](/windows/desktop/uxguide/cmd-ribbons). На следующем рисунке показана лента.

![Элемент управления ресурсом ленты MFC](../mfc/media/ribbon_no_callouts.png "элемент управления ресурсом ленты MFC")

В более ранних версиях Visual Studio ленты должны быть созданы написанием кода, который использует классы ленты MFC, например [класс CMFCRibbonBar](../mfc/reference/cmfcribbonbar-class.md). В Visual Studio 2010 и более поздних версиях конструктор лент предоставляет альтернативный метод создания лент. Во-первых, создайте и настройте ленту как ресурс. Затем загрузите ресурс ленты из кода в приложение MFC. Можно даже использовать ресурсы ленты и классы ленты MFC вместе. Например можно создать ресурс ленты и программно добавлять дополнительные элементы к нему во время выполнения с помощью кода.

## <a name="understanding-the-ribbon-designer"></a>Основные сведения о конструкторе лент

Конструктор лент создает и сохраняет ленты как ресурсы. При создании ресурса ленты конструктор лент выполняет следующие три действия.

- Добавляет запись в скрипт определения ресурсов проекта (*.rc). В следующем примере IDR_RIBBON — уникальное имя, идентифицирующее ресурс ленты, RT_RIBBON_XML — тип ресурса и ribbon.mfcribbon-ms — имя файла ресурсов.

```
    IDR_RIBBON RT_RIBBON_XML      "res\\ribbon.mfcribbon-ms"
```

- Добавляет определения идентификаторов команд в файл resource.h.

```
#define IDR_RIBBON            307
```

- Создает файл ресурсов ленты (*.mfcribbon-ms), который содержит XML-код, определяющий кнопки, элементы управления и атрибуты ленты. Изменения в конструкторе ленты на ленту сохраняются в файле ресурсов как XML. В следующем примере кода показана часть содержимого \*MFCRIBBON ms-файла:

```
<RIBBON_BAR>
<ELEMENT_NAME>RibbonBar</ELEMENT_NAME>
<IMAGE>
<ID>
<NAME>IDB_BUTTONS</NAME>
<VALUE>113</VALUE>
</ID>
```

Чтобы использовать ресурс ленты в приложении MFC, загрузите ресурс, вызвав [CMFCRibbonBar::LoadFromResource](../mfc/reference/cmfcribbonbar-class.md#loadfromresource).

## <a name="creating-a-ribbon-by-using-the-ribbon-designer"></a>Создание ленты с помощью конструктора лент

Ниже описаны два способа для добавления ресурса ленты в проект MFC.

- Создайте приложение MFC и настройте мастер проектов MFC для создания ленты. Дополнительные сведения см. в разделе [Пошаговое руководство: Создание приложения ленты с помощью MFC](../mfc/walkthrough-creating-a-ribbon-application-by-using-mfc.md).

- Создайте ресурс ленты в существующем проекте MFC и загрузите его. Дополнительные сведения см. в разделе [Пошаговое руководство: Обновление приложения MFC Scribble (часть 1)](../mfc/walkthrough-updating-the-mfc-scribble-application-part-1.md).

Если в проекте уже есть вручную закодированная лента, MFC предоставляет функции, которые можно использовать для преобразования существующей ленты в ресурс ленты. Дополнительные сведения см. в разделе [Как Преобразование существующей ленты MFC в ресурс ленты](../mfc/how-to-convert-an-existing-mfc-ribbon-to-a-ribbon-resource.md).

> [!NOTE]
>  Ленты не могут быть созданы в приложениях на базе диалоговых окон. Дополнительные сведения см. в разделе [тип приложения, мастер приложений MFC](../mfc/reference/application-type-mfc-application-wizard.md).

## <a name="customizing-ribbons"></a>Настройка лент

Чтобы открыть ленту в конструкторе лент, дважды щелкните ресурс ленты в представлении ресурсов. В конструкторе можно добавлять, удалять и настраивать элементы на ленте, кнопку «Приложение» и панель инструментов быстрого доступа. Вы также можете привязать события, например события нажатия кнопки и события меню, к методу в приложении.

На следующем рисунке показаны различные компоненты конструктора лент.

![Конструктор лент MFC](../mfc/media/ribbon_designer.png "конструктор ленты MFC")

- **Инструментарий:** Содержит элементы управления, которые можно перетащить в область конструктора.

- **Область конструктора:** Содержит визуальное представление ресурса ленты.

- **Окно свойств:** Перечислены атрибуты элемента, выбранного в области конструктора.

- **Окно представления ресурсов:** Отображает ресурсы, содержащие ресурсы ленты в проекте.

- **Панель инструментов редактора ленты:** Содержит команды, которые позволяют просмотреть ленту и изменить ее визуальную тему.

В следующих разделах описаны способы использования функций в конструкторе лент.

- [Практическое руководство. Настройка кнопки приложения](../mfc/how-to-customize-the-application-button.md)

- [Практическое руководство. Настройка панели быстрого доступа](../mfc/how-to-customize-the-quick-access-toolbar.md)

- [Практическое руководство. Добавление элементов управления ленты и обработчиков событий](../mfc/how-to-add-ribbon-controls-and-event-handlers.md)

- [Практическое руководство. Загрузка ресурса ленты из приложения MFC](../mfc/how-to-load-a-ribbon-resource-from-an-mfc-application.md)

## <a name="definitions-of-ribbon-elements"></a>Определения элементов ленты

![Лента MFC](../mfc/media/ribbon.png "ленты MFC")

- **Кнопка приложения:** Кнопка, которая отображается в левом верхнем углу ленты. Кнопка «Приложение» заменяет меню «Файл» и отображается, даже если лента свернута. При нажатии этой кнопки отображается меню, которое содержит список команд.

- **Панель быстрого доступа:** Небольшая настраиваемая панель инструментов которой отображаются часто используемые команды.

- **Категория**: Логическая группа, которая представляет содержимое вкладки ленты.

- **Кнопка по умолчанию категории:** Кнопка, которая отображается на ленте, когда лента свернута. При нажатии кнопки категория снова появляется как меню.

- **На панели:** Область панели ленты, в которой отображается группа связанных элементов управления. Каждая категория ленты содержит одну или несколько панелей ленты.

- **Элементы ленты:** Элементы управления в панелях, например, кнопки и поля со списком. Чтобы просмотреть различные элементы управления, которые могут быть размещены на ленте, см. в разделе [пример RibbonGadgets: Приложение с гаджетами на ленте](../visual-cpp-samples.md).

## <a name="see-also"></a>См. также

[Элементы пользовательского интерфейса](../mfc/user-interface-elements-mfc.md)<br/>
[Работа с файлами ресурсов](../windows/working-with-resource-files.md)
