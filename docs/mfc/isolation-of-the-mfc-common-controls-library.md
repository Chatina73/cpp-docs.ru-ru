---
title: Изоляция библиотеки общих элементов управления MFC
ms.date: 11/04/2016
helpviewer_keywords:
- MFC, Common Controls library
ms.assetid: 7471e6f0-49b0-47f7-86e7-8d6bc3541694
ms.openlocfilehash: 94700f850be62404f22974a1d5e76acad711555c
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57278747"
---
# <a name="isolation-of-the-mfc-common-controls-library"></a>Изоляция библиотеки общих элементов управления MFC

Библиотека общих элементов управления теперь изолирована в MFC, позволяя разные модули (например, пользователь библиотеки DLL) используют разные версии библиотеки стандартных элементов управления, указав версию, в манифестах.

Приложения MFC (или пользователем коде, вызванном MFC) вызывает библиотеку стандартных элементов управления, API-интерфейсов функции-оболочки с именем `Afx` *FunctionName*, где *FunctionName* имя общий Элементы управления API. Эти функции-оболочки определяются в afxcomctl32.h и afxcomctl32.inl.

Можно использовать [AFX_COMCTL32_IF_EXISTS](reference/run-time-object-model-services.md#afx_comctl32_if_exists) и [AFX_COMCTL32_IF_EXISTS2](reference/run-time-object-model-services.md#afx_comctl32_if_exists2) макросы (определенные в afxcomctl32.h), чтобы определить, реализует ли библиотеки стандартных элементов управления определенных API вместо вызова метода [GetProcAddress](../build/getprocaddress.md).

С технической точки зрения выполнения вызова API-интерфейсов библиотеки общих элементов управления через класс-оболочку, `CComCtlWrapper` (определенные в afxcomctl32.h). `CComCtlWrapper` также ответственна за загрузку и выгрузку comctl32.dll. Состояния модуля MFC содержит указатель на экземпляр `CComCtlWrapper`. Доступны класс оболочки с помощью `afxComCtlWrapper` макрос.

Обратите внимание, что при вызове Общие элементы управления API непосредственно (не с помощью функции-оболочки MFC) с MFC приложением или пользователем DLL будет работать в большинстве случаев, так как приложение MFC или пользовательской библиотеки DLL привязана к библиотеке общих элементов управления, запрошенные в своем манифесте). Тем не менее сам код MFC должен использовать программы-оболочки, поскольку код MFC можно вызвать из библиотек DLL пользователя с разными версиями библиотеки стандартных элементов управления.
