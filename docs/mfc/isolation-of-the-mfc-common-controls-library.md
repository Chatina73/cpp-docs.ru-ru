---
description: 'Дополнительные сведения: изоляция библиотеки общих элементов управления MFC'
title: Изоляция библиотеки общих элементов управления MFC
ms.date: 11/04/2016
helpviewer_keywords:
- MFC, Common Controls library
ms.assetid: 7471e6f0-49b0-47f7-86e7-8d6bc3541694
ms.openlocfilehash: f3e0f6ad981a690f6212455b8af891eaa97f2642
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97335823"
---
# <a name="isolation-of-the-mfc-common-controls-library"></a>Изоляция библиотеки общих элементов управления MFC

Библиотека Common Controls теперь изолирована в MFC, что позволяет различным модулям (таким как пользовательские библиотеки DLL) использовать разные версии библиотеки общих элементов управления, указывая версию в манифестах.

Приложение MFC (или пользовательский код, вызванный MFC) выполняет вызовы интерфейсов API библиотеки общих элементов управления через функции-оболочки с именем `Afx` *FunctionName*, где *FunctionName* — это имя общего API элементов управления. Эти функции-оболочки определены в afxcomctl32. h и afxcomctl32. inl.

Можно использовать макросы [AFX_COMCTL32_IF_EXISTS](reference/run-time-object-model-services.md#afx_comctl32_if_exists) и [AFX_COMCTL32_IF_EXISTS2](reference/run-time-object-model-services.md#afx_comctl32_if_exists2) (определенные в afxcomctl32. h), чтобы определить, реализует ли библиотека Common Controls определенный API вместо вызова [GetProcAddress](../build/getprocaddress.md).

Технически вызовы API библиотеки общих элементов управления осуществляется через класс-оболочку `CComCtlWrapper` (определяется в afxcomctl32. h). `CComCtlWrapper` также отвечает за загрузку и выгрузку comctl32.dll. Состояние модуля MFC содержит указатель на экземпляр `CComCtlWrapper` . Доступ к классу-оболочке можно получить с помощью `afxComCtlWrapper` макроса.

Обратите внимание, что вызов API общих элементов управления напрямую (не используя функции-оболочки MFC) из приложения MFC или библиотеки DLL пользователя будет работать в большинстве случаев, так как приложение MFC или пользовательская библиотека DLL привязаны к библиотеке общих элементов управления, которую она запросила в своем манифесте). Однако сам код MFC должен использовать оболочки, так как код MFC может вызываться из пользовательских библиотек DLL с различными версиями библиотеки общих элементов управления.
