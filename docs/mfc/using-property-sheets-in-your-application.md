---
description: Дополнительные сведения см. в статье Использование страниц свойств в приложении.
title: Использование вкладок свойств в приложении
ms.date: 11/04/2016
helpviewer_keywords:
- dialog templates [MFC], property sheets
- dialog resources
- property pages [MFC], property sheets
- DoModal method property sheets
- AddPage method [MFC]
- property sheets, about property sheets
- Create method [MFC], property sheets
- CPropertyPage class [MFC], styles
ms.assetid: 240654d4-152b-4e3f-af7b-44234339206e
ms.openlocfilehash: 3bc1e21d99eb4a1688247524749b44028762892d
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97322690"
---
# <a name="using-property-sheets-in-your-application"></a>Использование вкладок свойств в приложении

Чтобы использовать страницу свойств в приложении, выполните следующие действия.

1. Создайте ресурс шаблона диалогового окна для каждой страницы свойств. Помните, что пользователь может переключиться с одной страницы на другую, чтобы все страницы были как можно более согласованными.

   Шаблоны диалоговых окон для всех страниц не должны иметь одинаковый размер. Платформа использует размер самой большой страницы, чтобы определить, сколько места нужно выделить на странице свойств для страниц свойств.

   При создании ресурса шаблона диалогового окна для страницы свойств необходимо указать следующие стили на странице свойств диалогового окна Свойства:

   - Задайте в поле ввода **заголовка** на странице **Общие** текст, который должен отображаться на вкладке этой страницы.

   - Задайте **дочерний** список **стилей** на странице **стили** .

   - Задайте для поля список **границ** на странице **стили** значение **тонкий**.

   - Убедитесь, что установлен флажок **заголовок** окна на странице **стили** .

   - Убедитесь, что установлен флажок **отключено** на странице **больше стилей** .

1. Создание класса, производного от [CPropertyPage](../mfc/reference/cpropertypage-class.md), соответствующего шаблону диалогового окна страницы свойств. См. раздел [Добавление класса](../ide/adding-a-class-visual-cpp.md). Выберите в `CPropertyPage` качестве базового класса.

1. Создайте переменные-члены для хранения значений этой страницы свойств. Процесс добавления переменных-членов на страницу свойств точно такой же, как и Добавление переменных-членов в диалоговое окно, поскольку страница свойств является специализированным диалоговым окном. Дополнительные сведения см. в разделе [Определение переменных членов для элементов управления диалогового окна](../windows/adding-editing-or-deleting-controls.md).

1. Создайте объект [CPropertySheet](../mfc/reference/cpropertysheet-class.md) в исходном коде. Обычно `CPropertySheet` объект создается в обработчике для команды, которая отображает страницу свойств. Этот объект представляет всю страницу свойств. При создании модальной страницы свойств с помощью функции [DoModal](../mfc/reference/cpropertysheet-class.md#domodal) платформа предоставляет три кнопки команд по умолчанию: "ОК", "Отмена" и "Применить". Платформа не создает командных кнопок для немодальных страниц свойств, созданных с помощью функции [CREATE](../mfc/reference/cpropertysheet-class.md#create) . Нет необходимости создавать производный класс, `CPropertySheet` Если вы не хотите добавлять другие элементы управления (например, окно предварительного просмотра) или отображать немодальную страницу свойств. Этот шаг необходим для немодальных страниц свойств, так как они не содержат элементов управления по умолчанию, которые могут использоваться для закрытия страницы свойств.

1. Для каждой страницы, добавляемой на страницу свойств, выполните следующие действия.

   - Создайте один объект для каждого `CPropertyPage` производного класса, созданного ранее в этом процессе.

   - Вызовите [CPropertySheet:: addPage](../mfc/reference/cpropertysheet-class.md#addpage) для каждой страницы.

   Как правило, объект, который создает, `CPropertySheet` также создает `CPropertyPage` объекты на этом шаге. Однако при реализации `CPropertySheet` класса, производного от, можно внедрить `CPropertyPage` объекты в `CPropertySheet` объект и вызвать `AddPage` для каждой страницы из `CPropertySheet` конструктора производного класса. `AddPage` Добавляет `CPropertyPage` объект в список страниц свойств, но на самом деле не создает окно для этой страницы. Поэтому нет необходимости ждать, пока создание окна страницы свойств будет вызвано `AddPage` ; можно вызвать `AddPage` из конструктора страницы свойств.

   По умолчанию, если страница свойств содержит больше вкладок, чем помещается в одной строке страницы свойств, то вкладки будут выпадать в несколько строк. Чтобы отключить стек, вызовите [CPropertySheet:: енаблестаккедтабс](../mfc/reference/cpropertysheet-class.md#enablestackedtabs) с параметром, для которого задано значение **false**. `EnableStackedTabs`При создании страницы свойств необходимо вызвать.

1. Вызовите [CPropertySheet::D омодал](../mfc/reference/cpropertysheet-class.md#domodal) или [CREATE](../mfc/reference/cpropertysheet-class.md#create) , чтобы отобразить страницу свойств. Вызовите `DoModal` , чтобы создать страницу свойств как модальное диалоговое окно. Вызовите **CREATE** , чтобы создать страницу свойств в виде немодального диалогового окна.

1. Обмен данными между страницами свойств и владельцем страницы свойств. Это объясняется в статье [Обмен данными](../mfc/exchanging-data.md).

Пример использования страниц свойств см. в разделе Общие примеры MFC [пропдлг](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также раздел

[Вкладки свойств](../mfc/property-sheets-mfc.md)
