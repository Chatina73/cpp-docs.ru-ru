---
title: Использование вкладок свойств в приложении
ms.date: 11/04/2016
helpviewer_keywords:
- dialog templates [MFC], property sheets
- dialog resources
- property pages [MFC], property sheets
- DoModal method property sheets
- AddPage method [MFC]
- property sheets, about property sheets
- Create method [MFC], property sheets
- CPropertyPage class [MFC], styles
ms.assetid: 240654d4-152b-4e3f-af7b-44234339206e
ms.openlocfilehash: 4fd68f57db082ab0b0da0e8248e0be239c63c99a
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2019
ms.locfileid: "58773220"
---
# <a name="using-property-sheets-in-your-application"></a>Использование вкладок свойств в приложении

Чтобы использовать страницы свойств в приложении, выполните следующие действия.

1. Создайте ресурс шаблона диалоговых окон для каждой страницы свойств. Имейте в виду, что пользователь может переключение с одной страницы в другую, чтобы размещать каждой странице как согласованно максимально.

   Шаблонов диалоговых окон для всех страниц, нет необходимости быть одинакового размера. Инфраструктура использует размер наибольшего страницы, чтобы определить, сколько места для выделения в окне свойств на страницах свойств.

   При создании ресурса шаблона диалогового окна для страницы свойств в окне свойств диалогового окна свойств необходимо указать следующие стили:

   - Задайте **заголовок** поле ввода на **Общие** страницу для текста, которые должны отображаться на вкладке этой страницы.

   - Задайте **стиля** поле со списком на **стили** страницы **дочерних**.

   - Задайте **границы** поле со списком на **стили** страницы **Thin**.

   - Убедитесь, что **Titlebar** флажок на **стили** выбранных страниц.

   - Убедитесь, что **отключено** флажок на **дополнительные стили** выбранных страниц.

1. Создание [CPropertyPage](../mfc/reference/cpropertypage-class.md)-производный класс, соответствующий каждой шаблона диалогового окна страницы свойств. См. в разделе [Добавление класса](../ide/adding-a-class-visual-cpp.md). Выберите `CPropertyPage` в качестве базового класса.

1. Создайте переменные для хранения значений для этой страницы свойств-члены. Процесс добавления переменных-членов на страницу свойств именно так же, как добавить переменные-члены в диалоговом окне, так как страница свойств представляет собой специализированный диалоговое окно. Дополнительные сведения см. в разделе [определение переменных-членов для элементов управления диалоговых окон](../windows/defining-member-variables-for-dialog-controls.md).

1. Создать [CPropertySheet](../mfc/reference/cpropertysheet-class.md) объекта в исходном коде. Как правило, при создании `CPropertySheet` объекта в обработчике команду, которая отображает окно свойств. Этот объект представляет весь свойств. Если вы создаете модальную страницу свойств с [DoModal](../mfc/reference/cpropertysheet-class.md#domodal) функции, framework предоставляет три кнопки по умолчанию: Итак отмените и применить. Платформа создает кнопки не команда вкладки свойств, созданной с помощью [создать](../mfc/reference/cpropertysheet-class.md#create) функции. Необходимо создать производный класс от `CPropertySheet` только если вы хотите добавить другие элементы управления (например, окно предварительного просмотра) или отобразить немодальный лист свойств. Этот шаг является обязательным для вкладки свойств, так как они не содержат все элементы управления по умолчанию, которые могут использоваться, чтобы закрыть окно свойств.

1. Для каждой страницы для добавления свойств сделайте следующее:

   - Создать один объект для каждого `CPropertyPage`-производный класс, который вы создали ранее в этом процессе.

   - Вызовите [CPropertySheet::AddPage](../mfc/reference/cpropertysheet-class.md#addpage) для каждой страницы.

   Как правило, объект, который создает `CPropertySheet` также создает `CPropertyPage` объекты на этом шаге. Тем не менее при реализации `CPropertySheet`-производного класса, можно внедрить `CPropertyPage` объекты в `CPropertySheet` и вызовите `AddPage` для каждой страницы из `CPropertySheet`-производного конструктора класса. `AddPage` Добавляет `CPropertyPage` объекта в окне свойств список страниц, но не создает фактически окна для этой страницы. Таким образом, нет необходимости ждать создания окно свойство `AddPage`; вы можете вызвать `AddPage` из конструктора в окне свойств.

   По умолчанию Если лист свойств содержит дополнительные вкладки, чем может поместиться в одну строку из страницы свойств вкладки будет стека во множестве строк. Чтобы отключить наложение, вызовите [CPropertySheet::EnableStackedTabs](../mfc/reference/cpropertysheet-class.md#enablestackedtabs) с параметром, имеющим **FALSE**. Необходимо вызвать `EnableStackedTabs` при создании страницы свойств.

1. Вызовите [CPropertySheet::DoModal](../mfc/reference/cpropertysheet-class.md#domodal) или [создать](../mfc/reference/cpropertysheet-class.md#create) для отображения страницы свойств. Вызовите `DoModal` для создания свойств как модальное диалоговое окно. Вызовите **создать** для создания свойств как немодальное диалоговое окно.

1. Обмен данными между страницы свойств и владельцу этой страницы свойств. Это объясняется в статье [обмена данных](../mfc/exchanging-data.md).

Пример использования свойств, см. в образце общие MFC [PROPDLG](../overview/visual-cpp-samples.md).

## <a name="see-also"></a>См. также

[Страницы свойств](../mfc/property-sheets-mfc.md)
