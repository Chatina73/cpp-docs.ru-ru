---
title: Исключения. Создание исключений из собственных функций
ms.date: 11/04/2016
helpviewer_keywords:
- throwing exceptions [MFC], from functions
- functions [MFC], throwing exceptions
- exceptions [MFC], throwing
ms.assetid: 492976e8-8804-4234-8e8f-30dffd0501be
ms.openlocfilehash: 6484594df7636fd52ac46ab1cc212c8e2ec0278e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81359276"
---
# <a name="exceptions-throwing-exceptions-from-your-own-functions"></a>Исключения. Создание исключений из собственных функций

Можно использовать парадигму обработки исключений MFC исключительно для поимки исключений, брошенных функциями в МФЦ или других библиотеках. Помимо исключений, брошенных библиотечным кодом, вы можете выбросить исключения из собственного кода, если вы пишете функции, которые могут столкнуться с исключительными условиями.

При броске исключения выполнение текущей функции прекращается и переходит непосредственно в блок **отлова** самого внутреннего кадра исключения. Механизм исключения обходит нормальный путь выхода из функции. Поэтому вы должны быть уверены, чтобы удалить те блоки памяти, которые будут удалены в нормальном выходе.

#### <a name="to-throw-an-exception"></a>Чтобы бросить исключение

1. Используйте одну из функций помощника `AfxThrowMemoryException`MFC, например. Эти функции бросают заранее распределенный объект исключения соответствующего типа.

   В следующем примере функция пытается выделить два блока памяти и бросает исключение, если либо выделение не удается:

   [!code-cpp[NVC_MFCExceptions#17](../mfc/codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_1.cpp)]

   Если первое выделение не удается, можно просто выбросить исключение памяти. Если первое распределение успешно, а второе не удается, необходимо освободить первый блок распределения, прежде чем бросать исключение. Если оба распределения увенчаются успехом, вы можете действовать нормально и освободить блоки при выходе из функции.

     - или -

1. Используйте определенное пользователем исключение для обозначения условия проблемы. Вы можете бросить элемент любого типа, даже весь класс, как ваше исключение.

   Следующий пример пытается воспроизвести звук через волновое устройство и бросает исключение в случае сбоя.

   [!code-cpp[NVC_MFCExceptions#18](../mfc/codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_2.cpp)]

> [!NOTE]
> Обработка исключений MFC по умолчанию применяется только к указателям на `CException` объекты (и объекты классов, полученных из полученных). `CException` Приведенный выше пример обходит механизм исключения МФЦ.

## <a name="see-also"></a>См. также раздел

[Обработка исключений](../mfc/exception-handling-in-mfc.md)
