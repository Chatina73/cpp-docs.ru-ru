---
title: Исключения. Создание исключений из собственных функций
ms.date: 11/04/2016
helpviewer_keywords:
- throwing exceptions [MFC], from functions
- functions [MFC], throwing exceptions
- exceptions [MFC], throwing
ms.assetid: 492976e8-8804-4234-8e8f-30dffd0501be
ms.openlocfilehash: ebdfea18e6e8445dd734bf43fb6a4ecf422975e9
ms.sourcegitcommit: c21b05042debc97d14875e019ee9d698691ffc0b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/09/2020
ms.locfileid: "84622746"
---
# <a name="exceptions-throwing-exceptions-from-your-own-functions"></a>Исключения. Создание исключений из собственных функций

Парадигму обработки исключений MFC можно использовать исключительно для перехвата исключений, создаваемых функциями в MFC или в других библиотеках. Помимо перехвата исключений, вызванных кодом библиотеки, можно создавать исключения из собственного кода при написании функций, которые могут столкнуться с исключительными условиями.

При возникновении исключения выполнение текущей функции останавливается и переходит непосредственно к блоку **catch** самого внутреннего фрейма исключений. Механизм исключения обходит нормальный путь выхода из функции. Поэтому необходимо удалить эти блоки памяти, которые будут удалены при нормальном выходе.

#### <a name="to-throw-an-exception"></a>Вызов исключения

1. Используйте одну из вспомогательных функций MFC, например `AfxThrowMemoryException` . Эти функции создают предварительно выделенный объект исключения соответствующего типа.

   В следующем примере функция пытается выделить два блока памяти и выдает исключение при сбое выделения.

   [!code-cpp[NVC_MFCExceptions#17](codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_1.cpp)]

   В случае сбоя первого выделения можно просто вызвать исключение памяти. Если первое выделение памяти прошло успешно, но во втором происходит сбой, необходимо освободить первый блок выделения перед созданием исключения. Если оба выделения выполнены успешно, можно продолжать работу и освобождать блоки при выходе из функции.

     - или

1. Чтобы указать состояние проблемы, используйте определенное пользователем исключение. В качестве исключения можно создать элемент любого типа, даже целый класс.

   В следующем примере предпринимается попытка воспроизведения звука через звуковое устройство и исключение в случае сбоя.

   [!code-cpp[NVC_MFCExceptions#18](codesnippet/cpp/exceptions-throwing-exceptions-from-your-own-functions_2.cpp)]

> [!NOTE]
> Обработка исключений по умолчанию в MFC применяется только к указателям на `CException` объекты (и объектам `CException` производных классов). В приведенном выше примере обходится механизм исключения MFC.

## <a name="see-also"></a>См. также раздел

[Обработка исключений](exception-handling-in-mfc.md)
