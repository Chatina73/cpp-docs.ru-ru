---
title: Служба автоматизации
ms.date: 11/04/2016
helpviewer_keywords:
- Automation servers, about Automation servers
- clients, Automation
- programmatic control [MFC]
- properties [MFC], Automation
- MFC, COM support
- OLE Automation
- Automation
- servers [MFC], Automation
- Automation clients
- sample applications [MFC], Automation
- methods [MFC]
- passing parameters, Automation
- Automation method [MFC]
- Automation, passing parameters
- Automation property [MFC]
- MFC COM, Automation
- methods [MFC], Automation
ms.assetid: 329117f0-c1aa-4680-a901-bfb71277dfba
ms.openlocfilehash: e9320ccf7a21c6110c51366fa8af96596512a4a7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370827"
---
# <a name="automation"></a>Служба автоматизации

Автоматизация (ранее известная как OLE-автоматизация) позволяет одному приложению управлять объектами, реализованными в другом приложении, или выделять объекты для управления.

[Сервер автоматизации](../mfc/automation-servers.md) — это приложение (тип COM-сервера), предоставляющее свои функции через COM-интерфейсы другим приложениям, называемым [клиентами автоматизации](../mfc/automation-clients.md). Это позволяет клиентам автоматизировать некоторые функции путем прямого доступа к объектам и использования предоставляемых ими возможностей.

Серверы и клиенты автоматизации используют COM-интерфейсы, которые всегда являются производными от `IDispatch` , и принимают и возвращают определенный набор типов данных, называемых типами автоматизации. Предоставив методы и свойства, доступные из других приложений, можно автоматизировать любой объект, который позволяет обращаться к интерфейсу автоматизации. Автоматизация доступна для OLE- и COM-объектов. Автоматизированный объект может быть локальным или удаленным (на другом компьютере, доступном по сети), поэтому существует две категории автоматизации.

- Автоматизация (локальная).

- Удаленная автоматизация (через сеть с использованием DCOM).

Предоставление доступа к объектам полезно в том случае, когда приложения предлагают функциональные возможности, полезные для других приложений. Например элемент управления ActiveX — это тип сервера автоматизации. Приложение, в котором размещается элемент управления ActiveX, является клиентом автоматизации этого элемента управления.

Другой пример: текстовый процессор может предоставлять свои функции по проверке орфографии другим программам. Благодаря доступу к объектам поставщики способны совершенствовать свои приложения с помощью готовых функциональных возможностей других приложений. Таким образом, автоматизация применяет некоторые принципы объектно-ориентированного программирования, такие как возможность многократного использования и инкапсуляции, на уровне самих приложений.

Особое значение имеет поддержка, предоставляемая автоматизацией пользователям и поставщикам решений. За счет доступа к функциональным возможностям приложений через стандартный и четко определенный интерфейс автоматизации позволяет создавать комплексные решения на одном общем языке программирования, например Visual Basic, а не прибегать к различным связанным с конкретными приложениями макроязыкам.

Многие коммерческие приложения, например Microsoft Excel и Microsoft Visual C++, допускают автоматизацию большей части своих функциональных возможностей. Например, в Visual C++, можно написать макросы VBScript для автоматизации построений, аспектов редактирования кода или задач отладки.

## <a name="passing-parameters-in-automation"></a><a name="_core_passing_parameters_in_automation"></a> Передача параметров в автоматизации

Одна из сложностей при создании методов автоматизации заключается в обеспечении согласованного безопасного механизма для передачи данных между серверами и клиентами автоматизации. Для передачи данных автоматизация использует тип **VARIANT** . Тип **VARIANT** является помеченным объединением. У него есть элемент данных для значения (это анонимное объединение C++) и элемент данных, указывающий тип сведений, хранящихся в объединении. Тип **VARIANT** поддерживает ряд стандартных типов данных: 2- и 4-байтовые целые числа, 4- и 8-байтовые числа с плавающей запятой, строки и логические значения. Кроме того, он поддерживает типы **HRESULT** (коды ошибок OLE), **CURRENCY** (число в фиксированной точке) и `IUnknown` `IDispatch` **DATE** (абсолютная дата и время), а также указатели и интерфейсы.

Тип **VARIANT** инкапсулирован в класс [COleVariant](../mfc/reference/colevariant-class.md) . Поддерживаемые классы **CURRENCY** и **DATE** инкапсулированы в классы [COleCurrency](../mfc/reference/colecurrency-class.md) и [COleDateTime](../atl-mfc-shared/reference/coledatetime-class.md) .

## <a name="automation-samples"></a>Примеры автоматизации

- [AUTOCLIK](../overview/visual-cpp-samples.md) Используйте этот пример, чтобы освоить приемы автоматизации и изучить основы удаленной автоматизации.

- [ACDUAL](../overview/visual-cpp-samples.md) Добавляет сдвоенные интерфейсы в приложение сервера автоматизации.

- [CALCDRIV](../overview/visual-cpp-samples.md) Приложение клиента автоматизации для реализации MFCCALC.

- [INPROC](../overview/visual-cpp-samples.md) Демонстрирует приложение внутрипроцессного сервера автоматизации.

- [CALCDRIV](../overview/visual-cpp-samples.md) Приложение клиента автоматизации для реализации INPROC.

- [MFCCALC](../overview/visual-cpp-samples.md) Демонстрирует приложение клиента автоматизации.

## <a name="what-do-you-want-to-know-more-about"></a>Что вы хотите узнать больше о

- [Automation Clients](../mfc/automation-clients.md)

- [Серверы автоматизации](../mfc/automation-servers.md)

- [OLE](../mfc/ole-in-mfc.md)

- [Active - технология](../mfc/mfc-com.md)

## <a name="what-do-you-want-to-do"></a>Что Вы хотите делать

- [Добавление класса автоматизации](../mfc/automation-servers.md)

- [Использование библиотек типов](../mfc/automation-clients-using-type-libraries.md)

- [Доступ к серверам автоматизации](../mfc/automation-servers.md)

- [Написание клиентов автоматизации на C++](../mfc/automation-clients.md)

## <a name="see-also"></a>См. также раздел

[MFC COM](../mfc/mfc-com.md)
