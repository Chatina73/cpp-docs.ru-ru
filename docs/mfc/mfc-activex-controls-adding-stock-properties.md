---
title: Элементы ActiveX в MFC. Добавление стандартных свойств
ms.date: 11/04/2016
helpviewer_keywords:
- BackColor property [MFC]
- properties [MFC], adding stock
- ForeColor property [MFC]
- MFC ActiveX controls [MFC], properties
- foreground colors, ActiveX controls
- foreground colors [MFC]
ms.assetid: 8b98c8c5-5b69-4366-87bf-0e61e6668ecb
ms.openlocfilehash: 940f61c9ce6ccb57843333582455e61c1f7ac73b
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/04/2019
ms.locfileid: "57289693"
---
# <a name="mfc-activex-controls-adding-stock-properties"></a>Элементы ActiveX в MFC. Добавление стандартных свойств

Стандартные свойства отличаются от пользовательских свойств, что они уже реализован класс `COleControl`. `COleControl` содержит функции стандартных элементов, которые поддерживают общие свойства для элемента управления. Некоторые общие свойства включают заголовок элемента управления и цвета переднего плана и фона. Сведения о других стандартных свойств, см. в разделе [Stock свойства поддерживается мастер добавления свойств](#_core_stock_properties_supported_by_classwizard) далее в этой статье. Записи сопоставления диспетчеризации для свойства всегда начинаются с DISP_STOCKPROP бумагу.

В этой статье описывается добавление стандартных свойств (в данном случае заголовок) в элемент управления ActiveX, используя мастер добавления свойств и описываются результирующие изменения кода. Ниже приведен список разделов.

- [Использование мастера добавления свойства для добавления стандартных свойств](#_core_using_classwizard_to_add_a_stock_property)

- [Добавьте свойство мастер изменения для стандартных свойств](#_core_classwizard_changes_for_stock_properties)

- [Стандартные свойства, поддерживаемые мастер добавления свойств](#_core_stock_properties_supported_by_classwizard)

- [Стандартные свойства и уведомления](#_core_stock_properties_and_notification)

- [Свойства цвета](#_core_color_properties)

    > [!NOTE]
    >  Пользовательские элементы управления Visual Basic обычно имеют свойства, такие как верхней, слева, ширина, высота, выравнивание, тег, имя, TabIndex, TabStop и родительского. Контейнеры элементов управления ActiveX, тем не менее, отвечающих за внедрение этих свойств элемента управления, и поэтому элементы управления ActiveX не должен поддерживать эти свойства.

##  <a name="_core_using_classwizard_to_add_a_stock_property"></a> Используя мастер добавления свойства для добавления стандартных свойств

Добавление стандартных свойств требует меньше кода, чем добавление пользовательских свойств, так как поддержка свойство обрабатывается автоматически в `COleControl`. Следующая процедура демонстрирует добавление хранения свойство Caption элемента управления ActiveX и также может использоваться для добавления других стандартных свойств. Замените имя выбранного стандартное свойство для заголовка.

#### <a name="to-add-the-stock-caption-property-using-the-add-property-wizard"></a>Чтобы добавить стандартное свойство Caption, с помощью мастера добавления свойства

1. Загрузите проект элемента управления.

1. В представлении класса разверните узел библиотеки элемента управления.

1. Щелкните правой кнопкой мыши узел интерфейса для элемента управления (второй узел узла библиотеки), чтобы открыть контекстное меню.

1. В контекстном меню, щелкните **добавить** и нажмите кнопку **добавить свойство**.

   Откроется [мастер добавления свойств](../ide/names-add-property-wizard.md).

1. В **имя свойства** выберите **заголовок**.

1. Нажмите кнопку **Готово**.

##  <a name="_core_classwizard_changes_for_stock_properties"></a> Добавить мастер изменения свойств для стандартных свойств

Так как `COleControl` поддерживает стандартные свойства, мастер добавления свойств не изменяет объявление класса в каким-либо образом, он добавляет свойство в диспетчерскую карту. Мастер добавления свойств добавляет следующую строку к карте элемента управления, который находится в реализации диспетчеризации (. Файл CPP):

[!code-cpp[NVC_MFC_AxUI#22](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_1.cpp)]

Следующая строка добавляется описание интерфейса элемента управления (. Файл IDL):

[!code-cpp[NVC_MFC_AxUI#23](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_2.idl)]

Эта строка назначает свойство Caption определенным идентификатором. Обратите внимание на то, что свойство может быть связано и запросить разрешение из базы данных перед изменением значения.

Это делает доступным свойство заголовка для пользователей вашего элемента управления. Чтобы использовать значение стандартного свойства, доступ к переменную-член или функцию-член `COleControl` базового класса. Дополнительные сведения об этих переменных-членов и функций-членов см, Stock свойства поддерживается мастер добавления свойств.

##  <a name="_core_stock_properties_supported_by_classwizard"></a> Стандартные свойства, поддерживаемые мастер добавления свойства

`COleControl` Класс предоставляет девять стандартные свойства. Можно добавить свойства, которые с помощью мастера добавления свойства.

|Свойство.|Запись сопоставления диспетчеризации|Как получить доступ к значению|
|--------------|------------------------|-------------------------|
|`Appearance`|DISP_STOCKPROP_APPEARANCE( )|Значение, уровень доступности, как `m_sAppearance`.|
|`BackColor`|(DISP_STOCKPROP_BACKCOLOR)|Значение, доступным путем вызова `GetBackColor`.|
|`BorderStyle`|(DISP_STOCKPROP_BORDERSTYLE)|Значение, уровень доступности, как `m_sBorderStyle`.|
|`Caption`|DISP_STOCKPROP_CAPTION( )|Значение, доступным путем вызова `InternalGetText`.|
|`Enabled`|DISP_STOCKPROP_ENABLED( )|Значение, уровень доступности, как `m_bEnabled`.|
|`Font`|DISP_STOCKPROP_FONT( )|См. в статье [элементы управления MFC ActiveX: Использование шрифтов](../mfc/mfc-activex-controls-using-fonts.md) для использования.|
|`ForeColor`|(DISP_STOCKPROP_FORECOLOR)|Значение, доступным путем вызова `GetForeColor`.|
|`hWnd`|DISP_STOCKPROP_HWND( )|Значение, уровень доступности, как `m_hWnd`.|
|`Text`|DISP_STOCKPROP_TEXT( )|Значение, доступным путем вызова `InternalGetText`. Это свойство является таким же, как `Caption`, за исключением имени свойства.|
|`ReadyState`|DISP_STOCKPROP_READYSTATE()|Значение, уровень доступности, как `m_lReadyState` или `GetReadyState`|

##  <a name="_core_stock_properties_and_notification"></a> Стандартные свойства и уведомления

Многие стандартные свойства имеют функции уведомления, которые могут быть переопределены. Например, каждый раз, когда `BackColor` свойство меняется, `OnBackColorChanged` вызывается функция (функции-члена класса элемента управления). Реализация по умолчанию (в `COleControl`) вызовов `InvalidateControl`. Переопределите эту функцию, если вы хотите выполнять дополнительные действия в ответ на это.

##  <a name="_core_color_properties"></a> Свойства цвета

Можно использовать акции `ForeColor` и `BackColor` свойства или свойства собственный пользовательский цвет, при рисовании элемента управления. Чтобы использовать свойство цвета, вызовите [COleControl::TranslateColor](../mfc/reference/colecontrol-class.md#translatecolor) функция-член. Параметры этой функции — значение свойства color и дескриптора палитры необязательно. Возвращает значение **COLORREF** функции, значение, которое может передаваться в GDI, такие как `SetTextColor` и `CreateSolidBrush`.

Значение цвета для акции `ForeColor` и `BackColor` доступа к свойствам с помощью вызова `GetForeColor` или `GetBackColor` функции, соответственно.

В следующем примере показано использование свойства этих двух цветов при рисовании элемента управления. Он инициализирует временную **COLORREF** переменной и `CBrush` объекта с вызовами `TranslateColor`: один с помощью `ForeColor` свойство и другой, используя `BackColor` свойство. Временный `CBrush` объект затем используется для закрашивания прямоугольника элемента управления, а цвет текста задается с помощью `ForeColor` свойство.

[!code-cpp[NVC_MFC_AxUI#24](../mfc/codesnippet/cpp/mfc-activex-controls-adding-stock-properties_3.cpp)]

## <a name="see-also"></a>См. также

[Элементы ActiveX библиотеки MFC](../mfc/mfc-activex-controls.md)<br/>
[Элементы ActiveX в MFC. Свойства](../mfc/mfc-activex-controls-properties.md)<br/>
[Элементы ActiveX в MFC. Методы](../mfc/mfc-activex-controls-methods.md)<br/>
[Класс COleControl](../mfc/reference/colecontrol-class.md)
