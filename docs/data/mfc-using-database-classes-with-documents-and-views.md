---
title: MFC. Использование классов базы данных с документами и представлениями
ms.date: 11/04/2016
helpviewer_keywords:
- documents [C++], database applications
- recordsets [C++], documents and views
- CRecordView class, using in database forms
- views [C++], database applications
- forms [C++], database applications
- record views [C++], form-based applications
- document/view architecture [C++], in databases
- database applications [C++], forms
- database classes [C++], MFC
- ODBC recordsets [C++], documents and views
- ODBC [C++], forms
ms.assetid: 83979974-fc63-46ac-b162-e8403a572e2c
ms.openlocfilehash: 9e071e0cc25492073cd74ed517284476b6e49ef8
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368904"
---
# <a name="mfc-using-database-classes-with-documents-and-views"></a>MFC. Использование классов базы данных с документами и представлениями

Вы можете использовать классы баз данных MFC с архитектурой документа/просмотра или без нее. Эта тема подчеркивает работу с документами и мнениями. В нем объясняется:

- [Как написать приложение на основе формы,](#_core_writing_a_form.2d.based_application) используя `CRecordView` объект в качестве основного представления в документе.

- [Как использовать объекты записи в документах и представлениях.](#_core_using_recordsets_in_documents_and_views)

- [Другие соображения](#_core_other_factors).

Для альтернатив [см. MFC: Использование классов баз данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md).

## <a name="writing-a-form-based-application"></a><a name="_core_writing_a_form.2d.based_application"></a>Написание приложения на основе формы

Многие приложения для доступа к данным основаны на формах. Пользовательский интерфейс представляет собой форму, содержащую элементы управления, в которой пользователь изучает, вводит или отводит данные. Чтобы сделать вашу форму `CRecordView`заявки на основе, используйте класс . При запуске приложения MFC Wizard и выборе типа клиента **ODBC** на странице **поддержки базы данных** проект используется `CRecordView` для класса представления.

В приложении, основанном на форме, каждый `CRecordset` объект представления записи хранит указатель объекта. Механизм обмена полями записи (RFX) системы обменивается данными между набором записей и источником данных. Механизм обмена диалогов (DDX) обменивается данными между полевыми данными членов объекта регистрации и элементами управления в форме. `CRecordView`также предоставляет функции обработчика команд по умолчанию для навигации от записи к записи в форме.

Чтобы создать приложение на основе формы с помощью мастера приложения, [Database Support, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md) [см.](../mfc/reference/creating-a-forms-based-mfc-application.md)

Для полного обсуждения форм, см [Record Просмотров](../data/record-views-mfc-data-access.md).

## <a name="using-recordsets-in-documents-and-views"></a><a name="_core_using_recordsets_in_documents_and_views"></a>Использование записей в документах и представлениях

Многие простые приложения на основе форм не нуждаются в документах. Если приложение является более сложным, вероятно, требуется использовать документ в качестве `CDatabase` прокси для базы данных, храожидаясь объекта, подключенного к источнику данных. Приложения на основе форм обычно хранят указатель на объект записи в представлении. Другие виды приложений баз `CDatabase` данных хранят в документе записи и объекты. Вот некоторые возможности использования документов в приложениях баз данных:

- Если вы получаете доступ к набору записей в локальном контексте, создайте `CRecordset` объект локально в функциях элемента документа или представления по мере необходимости.

   Объявить объект записи в качестве локальной переменной в функции. Передайте NULL конструктору, что приводит к созданию `CDatabase` и открытию временного объекта для вас. В качестве альтернативы передайте указатель объекту. `CDatabase` Используйте запись в функции и пусть он будет уничтожен автоматически, когда функция выходит.

   Когда вы передаете NULL конструктору записей, фреймворк `GetDefaultConnect` использует информацию, `CDatabase` возвращенную функцией члена записи, для создания объекта и его открытия. Мастера реализуют `GetDefaultConnect` для вас.

- Если вы получаете доступ к набору записей в течение `CRecordset` всего срока действия документа, вложите один или несколько объектов в документ.

   Построить объекты набора записей либо при инициализации документа, либо при необходимости. Можно написать функцию, которая возвращает указатель к набору записей, если она уже существует или конструируется, и открывает запись, если она еще не существует. Закройте, удалите и воссоздайте запись по `Requery` мере необходимости или позвоните в функцию его члена для обновления записей.

- Если вы получаете доступ к источнику данных в `CDatabase` течение всего срока действия `CDatabase` документа, встраивайте объект или храните указатель объекта в нем.

   Объект `CDatabase` управляет подключением к источнику данных. Объект строится автоматически при построении документа, и при инициализации документа вы называете его `Open` функцию члена. При построении объектов записей в функциях элемента документа `CDatabase` вы передаете указатель объекту документа. Это связывает каждый набор записей со своим источником данных. Объект базы данных обычно уничтожается при закрытии документа. Объекты набора записей обычно уничтожаются при выходе из области функции.

## <a name="other-factors"></a><a name="_core_other_factors"></a>Другие факторы

Приложения на основе форм часто не используютмеханизмы для механизма сериализации документов, поэтому может потребоваться удалить, отключить или заменить **новые** и **открытые** команды в меню **файла.** Смотрите статью [Сериализация: Сериализация против ввода базы данных / выход](../mfc/serialization-serialization-vs-database-input-output.md).

Возможно, также захотите использовать многие возможности пользовательского интерфейса, которые может поддерживать платформа. Например, можно использовать `CRecordView` несколько объектов в окне сплитера, открыть несколько записей в разных несколько окон интерфейса документа (MDI) и так далее.

Возможно, вы захотите реализовать печать того, что находится в `CRecordView` вашем представлении, будь то форма, реализованная с или что-то еще. По мере того `CFormView` `CRecordView` как типы выведенные от, `OnPrint` не поддерживают печать, но вы можете переопределить функцию члена для того чтобы позволить печать. Для получения дополнительной [CFormView](../mfc/reference/cformview-class.md)информации см.

Возможно, вы вообще не захотите использовать документы и представления. В этом случае [см. MFC: Использование классов баз данных без документов и представлений.](../data/mfc-using-database-classes-without-documents-and-views.md)

## <a name="see-also"></a>См. также раздел

[MFC-классы баз данных](../data/mfc-database-classes-odbc-and-dao.md)
