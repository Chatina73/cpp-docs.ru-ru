---
title: MFC. Использование классов базы данных с документами и представлениями
ms.date: 11/04/2016
helpviewer_keywords:
- documents [C++], database applications
- recordsets [C++], documents and views
- CRecordView class, using in database forms
- views [C++], database applications
- forms [C++], database applications
- record views [C++], form-based applications
- document/view architecture [C++], in databases
- database applications [C++], forms
- database classes [C++], MFC
- ODBC recordsets [C++], documents and views
- ODBC [C++], forms
ms.assetid: 83979974-fc63-46ac-b162-e8403a572e2c
ms.openlocfilehash: 78765d17b52889123f13c492699230834decba66
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62182903"
---
# <a name="mfc-using-database-classes-with-documents-and-views"></a>MFC. Использование классов базы данных с документами и представлениями

Можно использовать классы баз данных MFC, независимо от архитектуры document/view. В этом разделе уделено особое внимание работе с документами и представлениями. Здесь объясняется:

- [Как написать приложение на основе форм](#_core_writing_a_form.2d.based_application) с помощью `CRecordView` объект в качестве основного представления документа.

- [Как использовать объекты набора записей в свои документы и представления](#_core_using_recordsets_in_documents_and_views).

- [Дополнительные рекомендации](#_core_other_factors).

Альтернативные способы, см. в разделе [MFC: Использование классов базы данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md).

##  <a name="_core_writing_a_form.2d.based_application"></a> Создание приложения на основе форм

Многие приложения доступа к данным основаны на формах. Пользовательский интерфейс представляет собой форму, содержащую элементы управления, в которых пользователь проверяет, входит или изменении данных. Чтобы создать приложение на основе формы, используйте класс `CRecordView`. При запуске мастера приложений MFC и **ODBC** типа клиента на **Поддержка баз данных** страницы, в проекте используется `CRecordView` для класса представления.

В приложении на основе форм, каждый объект представления записей сохраняет указатель на `CRecordset` объект. Полями записей (RFX) exchange механизм обеспечивает обмен данными между набора записей и источником данных. Механизм (окон DDX) обеспечивает обмен данными между элементами данных полей объекта набора записей и элементов управления в форме, обмена данными диалогового окна. `CRecordView` также предоставляет по умолчанию функции обработчика команд для перемещения по записям на форме.

Чтобы создать приложение на основе формы с помощью мастера приложений, см. в разделе [создание приложений MFC на основе форм](../mfc/reference/creating-a-forms-based-mfc-application.md) и [Поддержка баз данных, мастер приложений MFC](../mfc/reference/database-support-mfc-application-wizard.md).

Полное описание формы, см. в разделе [представления записей](../data/record-views-mfc-data-access.md).

##  <a name="_core_using_recordsets_in_documents_and_views"></a> Использование наборов записей в документов и представлений

Много простых приложений на основе форм не обязательно документов. Если приложение является более сложным, может потребоваться использовать документ в качестве прокси-сервера для базы данных, хранение `CDatabase` объект, который подключается к источнику данных. Приложений на основе форм, обычно сохраняют указатель на объект набора записей в представлении. Другие виды приложений базы данных хранения наборов записей и `CDatabase` объект документа. Ниже приведены некоторые возможности использования документов в приложениях базы данных.

- Если вы обращаетесь к набору записей в локальном контексте, создайте `CRecordset` объект локально в функциях-членах документа или представления, при необходимости.

   Объявите объект набора записей как локальная переменная в функции. Передать NULL конструктору, чего платформа для создания и открытия временный `CDatabase` объект. Кроме того, передать указатель на `CDatabase` объект. Используйте этот набор записей в функцию и перейдите к нему будут автоматически удаляться при выходе из функции.

   При передаче значения NULL в конструктор набора записей, инфраструктура использует сведения, возвращаемые методом набора записей `GetDefaultConnect` функция-член для создания `CDatabase` объекта и откройте его. Реализовать мастеров `GetDefaultConnect` для вас.

- Если вы обращаетесь к набору записей во время существования документа, внедрить одно или несколько `CRecordset` объектов в документе.

   При инициализации документа или при необходимости, создавать объекты набора записей. Можно написать функцию, которая возвращает указатель на набор записей, если он уже существует или создает и открывает набор записей, если он еще не существует. Закрыть, удалить и повторно создайте набор записей, при необходимости или вызывать его `Requery` функция-член для обновления записей.

- При доступе к источнику данных во время существования документа, внедрить `CDatabase` либо сохраните указатель на `CDatabase` внутри него.

   `CDatabase` Управляет подключения к источнику данных. Объект создается автоматически во время создания, и вызывать его `Open` функция-член при инициализации документа. При создании объектов наборов записей в функциях-членах документа, передать указатель в документ `CDatabase` объекта. Это связывает каждый набор записей со своим источником данных. Объект базы данных обычно удаляется при закрытии документа. Объекты набора записей обычно удаляются при закрытии области функции.

##  <a name="_core_other_factors"></a> Другие факторы

Приложения на основе форм, обычно не требуется для документа механизм сериализации, поэтому может потребоваться удаление, отключение или замена **New** и **откройте** команд на **Файл** меню. См. в статье [сериализации: Сериализация или Базы данных ввода вывода](../mfc/serialization-serialization-vs-database-input-output.md).

Также может потребоваться внести использовать многочисленные возможности пользовательского интерфейса, которые может поддерживать платформы. Например, можно использовать несколько `CRecordView` объектов в окне разделителя, открыть несколько наборов записей в разных несколько дочерних окон интерфейса (MDI) документа и т. д.

Может потребоваться реализация функций печати в представлении, будь то форма, реализованная с помощью `CRecordView` или что-то другое. Так как классы, производные от `CFormView`, `CRecordView` поддерживают печать, но вы можете переопределить `OnPrint` функция-член можно разрешить печать. Дополнительные сведения см. в разделе класса [CFormView](../mfc/reference/cformview-class.md).

Можно не использовать вообще документов и представлений. В этом случае см. в разделе [MFC: Использование классов базы данных без документов и представлений](../data/mfc-using-database-classes-without-documents-and-views.md).

## <a name="see-also"></a>См. также

[MFC-классы баз данных](../data/mfc-database-classes-odbc-and-dao.md)