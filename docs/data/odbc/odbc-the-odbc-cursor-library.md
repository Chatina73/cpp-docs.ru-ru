---
title: ODBC. Библиотека курсоров ODBC
ms.date: 11/04/2016
helpviewer_keywords:
- cursor library [ODBC]
- snapshots, support in ODBC
- timestamps, ODBC timestamp columns
- ODBC cursor library [ODBC]
- static cursors
- ODBC drivers, Level 1
- ODBC drivers, cursor support
- positioned updates
- cursors, ODBC cursor library
- Level 1 ODBC drivers
- cursor library [ODBC], snapshots
- ODBC, timestamp
- positioning cursors
ms.assetid: 6608db92-82b1-4164-bb08-78153c227be3
ms.openlocfilehash: e175a9b27cb19b0c2a67a08751b7a7717226ac55
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50435143"
---
# <a name="odbc-the-odbc-cursor-library"></a>ODBC. Библиотека курсоров ODBC

В этом разделе описывается библиотека курсоров ODBC и объясняется, как использовать его. Дополнительные сведения:

- [Библиотека курсоров и уровня 1 драйверы ODBC](#_core_the_cursor_library_and_level_1_odbc_drivers)

- [Позиционированные обновления и столбцы отметок времени](#_core_positioned_updates_and_timestamp_columns)

- [Использование библиотеки курсоров](#_core_using_the_cursor_library)

Библиотека курсоров ODBC является библиотеку динамической компоновки (DLL), который находится между диспетчером драйверов ODBC и драйвером. В условиях ODBC драйвер поддерживает курсор для отслеживания его позиции в наборе записей. Курсор отмечает позицию в наборе записей, к которой была выполнена прокрутка — текущей записи.

##  <a name="_core_the_cursor_library_and_level_1_odbc_drivers"></a> Библиотека курсоров и уровня 1 драйверы ODBC

Библиотека курсоров ODBC предоставляет драйверам первого уровня следующие новые возможности:

- Прокрутка вперед и назад. Драйверы уровня 2 не обязательно библиотеку курсоров, так как они уже являются прокручиваемыми.

- Поддержка моментальных снимков. Библиотека курсоров управляет буфер, содержащий записи моментальных снимков. Этот буфер отражает программы удаления и изменения записей, но не дополнения, удаления или изменения других пользователей. Таким образом моментальный снимок только наиболее актуальная буфера библиотеку курсоров. Буфер также не отражает добавления пользователя до вызова метода `Requery`. Динамических подмножеств данных следует использовать библиотеку курсоров.

Библиотека курсоров предоставляет моментальные снимки (статические курсоры) даже если они не поддерживаются обычно драйвером. Если драйвер поддерживает статические курсоры, вам не обязательно должны загружать библиотеку курсоров для поддержки моментальных снимков. Если вы используете библиотеку курсоров, можно использовать только моментальные снимки и последовательным. Если драйвер поддерживает динамических подмножеств данных (KEYSET_DRIVEN курсоры) и вы хотите использовать их, вы не должны использовать библиотеку курсоров. Если вы хотите использовать моментальные снимки и динамических подмножеств данных, их необходимо вводить в двух разных `CDatabase` объектов (подключения), если драйвер не поддерживает оба.

##  <a name="_core_positioned_updates_and_timestamp_columns"></a> Позиционированные обновления и столбцы отметок времени

> [!NOTE]
>  Источники данных ODBC доступны через классы MFC ODBC, как описано в этом разделе, или с помощью классов MFC объекта доступа к данным (DAO).

> [!NOTE]
>  Если драйвер ODBC поддерживает `SQLSetPos`, какие MFC используется, если он доступен, этот раздел не применим к вам.

Большинство драйверов первого уровня не поддерживают позиционированные обновления. Такие драйверы используют библиотеку курсоров для эмуляции возможности уровня 2 драйверов в этом отношении. Библиотека курсоров имитирует поддержку позиционированного обновления, выполнив поисковое обновление на неизменных полях.

В некоторых случаях набор записей может содержать столбец отметок времени как один из неизменных полей. При использовании набора записей MFC с таблицами, содержащими столбцы типа timestamp, возникают две проблемы.

Первый вопрос касается обновляемых моментальных снимков в таблицах со столбцами отметок времени. Если таблица, к которому привязан моментальный снимок содержит столбец отметок времени, необходимо вызвать `Requery` после вызова метода `Edit` и `Update`. В противном случае можно не изменять одну запись снова. При вызове `Edit` и затем `Update`, записи в источник данных, и столбец метки времени обновляется. Если вы не вызываете `Requery`, значение отметки времени для записи в моментальном снимке больше не совпадает с соответствующей меткой времени в источнике данных. При попытке обновить ее снова, источник данных может запретить обновление из-за несоответствия.

Вторая проблема касается ограничений класса [CTime](../../atl-mfc-shared/reference/ctime-class.md) при использовании с `RFX_Date` функции для передачи данных даты и времени, или из таблицы. Обработка `CTime` объект налагает дополнительные издержки в виде дополнительный промежуточный обработки во время передачи данных. Диапазон дат `CTime` объектов может также оказаться слишком ограничивающим для некоторых приложений. Новая версия `RFX_Date` функция принимает ODBC *TIMESTAMP_STRUCT* вместо параметра `CTime` объекта. Дополнительные сведения см. в разделе `RFX_Date` в [макросы и глобальные объекты](../../mfc/reference/mfc-macros-and-globals.md) в *Справочник по библиотеке MFC*.

##  <a name="_core_using_the_cursor_library"></a> Использование библиотеки курсоров

При подключении к источнику данных — путем вызова [CDatabase::OpenEx](../../mfc/reference/cdatabase-class.md#openex) или [CDatabase::Open](../../mfc/reference/cdatabase-class.md#open) — можно указать, следует ли использовать библиотеку курсоров для источника данных. Если вы создадите моментальных снимков от этого источника данных, укажите `CDatabase::useCursorLib` в диалоговом окне `dwOptions` параметр `OpenEx` или укажите значение TRUE для *bUseCursorLib* параметр `Open` (значение по умолчанию — ЗНАЧЕНИЕ TRUE). Если драйвер ODBC поддерживает динамических подмножеств данных, и вы хотите открыть динамических подмножеств данных в источнике данных, не используйте библиотеку курсоров (поскольку она скрывает некоторые функциональные возможности драйвера, необходимые для динамических подмножеств данных). В этом случае не следует указывать `CDatabase::useCursorLib` в `OpenEx` или указать значение FALSE для *bUseCursorLib* параметр в `Open`.

## <a name="see-also"></a>См. также

[Основы ODBC](../../data/odbc/odbc-basics.md)