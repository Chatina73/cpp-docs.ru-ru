---
description: 'Дополнительные сведения: моментальный снимок'
title: Моментальный снимок
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC cursor library [ODBC], snapshots
- cursors [ODBC], static
- recordsets, snapshots
- snapshots, support in ODBC
- static cursors
- ODBC recordsets, snapshots
- cursor library [ODBC], snapshots
- snapshots
ms.assetid: b5293a52-0657-43e9-bd71-fe3785b21c7e
ms.openlocfilehash: 33505eb02613f672d09b889a09382ce3b8cf19cf
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97204294"
---
# <a name="snapshot"></a>Моментальный снимок

Моментальный снимок представляет собой набор записей, отражающий статическое представление данных в том виде, в котором оно существовало на момент создания моментального снимка. При открытии моментального снимка и переходе ко всем записям набор содержащихся в нем записей и их значения не меняются до тех пор, пока снимок не будет перестроен путем вызова `Requery` .

> [!NOTE]
> Этот раздел относится к классам ODBC библиотеки MFC. Если вместо классов ODBC MFC используются классы MFC DAO, см. раздел [CDaoRecordset:: Open](../../mfc/reference/cdaorecordset-class.md#open) для описания наборов записей типа snapshot.

Можно создавать моментальные снимки с поддержкой обновления или только для чтения с помощью классов базы данных. В отличие от динамического, обновляемый моментальный снимок не отражает изменений в значениях записи, сделанных другими пользователями, но он отражает обновления и удаления, сделанные программой. Записи, добавленные в моментальный снимок, не становятся видимыми для моментального снимка, пока не будет вызван метод `Requery` .

> [!TIP]
> Моментальный снимок является статическим курсором ODBC. Статические курсоры на самом деле не получают строку данных до тех пор, пока не будет выполнена прокрутка к этой записи. Чтобы обеспечить немедленное получение всех записей, можно перейти к концу набора записей и прокрутить к первой записи, которую нужно просмотреть. Однако обратите внимание, что прокрутка до конца влечет дополнительные издержки и может снизить производительность.

Моментальные снимки наиболее полезны, когда требуется, чтобы данные оставались фиксированными во время операций, как при создании отчета или при выполнении вычислений. Несмотря на это, источник данных может значительно отличаться от моментального снимка, поэтому вам может потребоваться перестроить его с течением времени.

Поддержка моментальных снимков основана на библиотеке курсоров ODBC, которая предоставляет статические курсоры и позиционированные обновления (необходимые для обновления) для любого драйвера уровня 1. Библиотека DLL библиотеки курсоров должна быть загружена в память для этой поддержки. При создании `CDatabase` объекта и вызове его `OpenEx` функции-члена необходимо указать `CDatabase::useCursorLib` параметр *двоптионс* . При вызове `Open` функции-члена библиотека курсоров загружается по умолчанию. Если вместо моментальных снимков используются динамические подмножества данных, не требуется загружать библиотеку курсоров.

Моментальные снимки доступны только в том случае, если библиотека курсоров ODBC была загружена при `CDatabase` создании объекта или если используемый драйвер ODBC поддерживает статические курсоры.

> [!NOTE]
> Для некоторых драйверов ODBC моментальные снимки (статические курсоры) могут быть не обновлены. Проверьте документацию по драйверу для поддерживаемых типов курсоров и типов параллелизма, которые они поддерживают. Чтобы гарантировать обновляемые моментальные снимки, обязательно загружайте библиотеку курсоров в память при создании `CDatabase` объекта. Дополнительные сведения см. [в разделе ODBC: Библиотека курсоров ODBC](../../data/odbc/odbc-the-odbc-cursor-library.md).

> [!NOTE]
> Если вы хотите использовать как моментальные снимки, так и динамические наборы данных, их необходимо основывать на двух разных `CDatabase` объектах (два разных соединения).

Дополнительные сведения о моментальных снимках свойств, общих для всех наборов записей, см. в разделе [набор записей (ODBC)](../../data/odbc/recordset-odbc.md). Дополнительные сведения о ODBC и моментальных снимках, включая библиотеку курсоров ODBC, см. в разделе [ODBC](../../data/odbc/odbc-basics.md).

## <a name="see-also"></a>См. также раздел

[Открытие подключения к базе данных (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)
