---
title: Снимок
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC cursor library [ODBC], snapshots
- cursors [ODBC], static
- recordsets, snapshots
- snapshots, support in ODBC
- static cursors
- ODBC recordsets, snapshots
- cursor library [ODBC], snapshots
- snapshots
ms.assetid: b5293a52-0657-43e9-bd71-fe3785b21c7e
ms.openlocfilehash: 99e1d76f8d65def326b0514f3219cef43f695220
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50512695"
---
# <a name="snapshot"></a>Снимок

Моментальный снимок — это набор записей, который отражает статическое представление данных на момент создания моментального снимка. При открытии моментального снимка и переместить все записи, набор записей и их значения не изменяются, пока вы вновь моментального снимка путем вызова `Requery`.

> [!NOTE]
>  Этот раздел относится к классам ODBC библиотеки MFC. Если при использовании классов MFC DAO вместо классам ODBC библиотеки MFC, см. в разделе [CDaoRecordset::Open](../../mfc/reference/cdaorecordset-class.md#open) описание наборов записей типа моментального снимка.

Обновляемые или только для чтения моментальные снимки можно создать с классами базы данных. В отличие от подмножества обновляемый моментальный снимок не отражает изменения для записи значений, сделанные другими пользователями, но устанавливает обновления и удаления, выполненные программой. Записи, добавленные к моментальному снимку становятся видимыми в моментальный снимок до вызова метода `Requery`.

> [!TIP]
>  Моментальный снимок является статическим курсором ODBC. Статические курсоры не получают строки данных, пока не переместится к этой записи. Чтобы убедиться, что сразу же будут извлечены все записи, можно в конце набора записей и прокрутите список до первой записи, которую вы хотите просмотреть. Обратите внимание, что прокрутка до конца влечет за собой дополнительные издержки и может снизить производительность.

Моментальные снимки наиболее полезны, когда требуется, чтобы данные не изменялись во время операций, например при создании отчета или выполнения вычислений. Тем не менее источник данных можно расходятся значительно из моментального снимка, поэтому может потребоваться перестроить его время от времени.

Поддержка моментальных снимков основана на библиотеку курсоров ODBC, который обеспечивает статические курсоры и позиционированные обновления (требуется для обновления) для всех драйверов уровня 1. DLL-библиотека курсоров должен быть загружен в память для этой поддержки. При построении `CDatabase` и вызовите его `OpenEx` функция-член, необходимо указать `CDatabase::useCursorLib` параметр *dwOptions* параметра. При вызове метода `Open` функция-член, библиотека курсоров загружается по умолчанию. При использовании динамических подмножеств данных, а не моментальные снимки, вы не хотите библиотеку курсоров для загрузки.

Моментальные снимки доступны только в том случае, если библиотека курсоров ODBC была загружена при `CDatabase` объект был создан, или вы используете драйвер ODBC поддерживает статические курсоры.

> [!NOTE]
>  Для некоторых драйверов ODBC моментальные снимки (статические курсоры) не могут быть обновляемым. Проверьте типы курсора, поддерживаемые см и типы параллелизма, которые они поддерживают. Чтобы гарантировать обновляемые моментальные снимки, убедитесь, что загрузить библиотеку курсоров в память при создании `CDatabase` объекта. Дополнительные сведения см. в разделе [ODBC: библиотека курсоров ODBC](../../data/odbc/odbc-the-odbc-cursor-library.md).

> [!NOTE]
>  Если вы хотите использовать моментальные снимки и динамических подмножеств данных, их необходимо вводить в двух разных `CDatabase` объектов (подключения).

Дополнительные сведения о папке моментальных снимков свойства со всеми наборами, см. в разделе [записей (ODBC)](../../data/odbc/recordset-odbc.md). Дополнительные сведения об ODBC и моментальные снимки, включая библиотеку курсоров ODBC см. в разделе [ODBC](../../data/odbc/odbc-basics.md).

## <a name="see-also"></a>См. также

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)