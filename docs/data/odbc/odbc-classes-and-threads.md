---
title: Потоки и классы ODBC
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC classes, and threads
- ODBC, multithreaded applications
- threading [MFC], ODBC support
ms.assetid: 16543926-7331-41a6-ba50-72288f2a61b7
ms.openlocfilehash: 8cb5df605bef31e177e976798f975bb4ca14ced7
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80213194"
---
# <a name="odbc-classes-and-threads"></a>Потоки и классы ODBC

Начиная с MFC 4,2, существует поддержка многопоточности для классов ODBC MFC. Однако обратите внимание, что MFC не предоставляет поддержку многопоточности для классов DAO.

Поддержка многопоточности для классов ODBC имеет некоторые ограничения. Поскольку эти классы являются оболочкой для API ODBC, они ограничиваются поддержкой многопоточности компонентов, на которых они созданы. Например, многие драйверы ODBC не являются потокобезопасными. Поэтому классы ODBC MFC не являются потокобезопасными, если они используются с одним из этих драйверов. Следует проверить, является ли ваш конкретный драйвер потокобезопасным.

При создании многопоточного приложения следует очень внимательно использовать несколько потоков для работы с одним и тем же объектом. Например, использование одного и того же объекта `CRecordset` в двух потоках может вызвать проблемы при извлечении данных. операция выборки в одном потоке может перезаписать данные, полученные в другом потоке. Более распространенное использование классов ODBC MFC в отдельных потоках заключается в совместном использовании открытого объекта `CDatabase` в потоках для использования одного соединения ODBC с отдельным объектом `CRecordset` в каждом потоке. Обратите внимание, что не следует передавать неоткрытый объект `CDatabase` объекту `CRecordset` в другом потоке.

> [!NOTE]
>  Если необходимо, чтобы несколько потоков работали с одним и тем же объектом, следует реализовать соответствующие механизмы синхронизации, например критические разделы. Имейте в виду, что некоторые операции, например `Open`, не защищены. Следует убедиться, что эти операции не будут вызываться одновременно из разных потоков.

Дополнительные сведения о создании многопоточных приложений см. в [статьях о многопоточной](../../parallel/multithreading-support-for-older-code-visual-cpp.md)работе.

## <a name="see-also"></a>См. также раздел

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Программирование доступа к данным (библиотеки MFC/ATL)](../../data/data-access-programming-mfc-atl.md)
