---
description: Дополнительные сведения о классах и потоках ODBC
title: Потоки и классы ODBC
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC classes, and threads
- ODBC, multithreaded applications
- threading [MFC], ODBC support
ms.assetid: 16543926-7331-41a6-ba50-72288f2a61b7
ms.openlocfilehash: bff5ef5a53543b2e0ffa7888f469ed4ce1e54a37
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97161082"
---
# <a name="odbc-classes-and-threads"></a>Потоки и классы ODBC

Начиная с MFC 4,2, существует поддержка многопоточности для классов ODBC MFC. Однако обратите внимание, что MFC не предоставляет поддержку многопоточности для классов DAO.

Поддержка многопоточности для классов ODBC имеет некоторые ограничения. Поскольку эти классы являются оболочкой для API ODBC, они ограничиваются поддержкой многопоточности компонентов, на которых они созданы. Например, многие драйверы ODBC не являются потокобезопасными. Поэтому классы ODBC MFC не являются потокобезопасными, если они используются с одним из этих драйверов. Следует проверить, является ли ваш конкретный драйвер потокобезопасным.

При создании многопоточного приложения следует очень внимательно использовать несколько потоков для работы с одним и тем же объектом. Например, использование одного и того же `CRecordset` объекта в двух потоках может вызвать проблемы при извлечении данных. операция выборки в одном потоке может перезаписать данные, полученные в другом потоке. Более распространенное использование классов ODBC MFC в отдельных потоках заключается в совместном использовании открытого `CDatabase` объекта в нескольких потоках для использования одного соединения ODBC с отдельным `CRecordset` объектом в каждом потоке. Обратите внимание, что не следует передавать неоткрытый `CDatabase` объект `CRecordset` объекту в другом потоке.

> [!NOTE]
> Если необходимо, чтобы несколько потоков работали с одним и тем же объектом, следует реализовать соответствующие механизмы синхронизации, например критические разделы. Имейте в виду, что некоторые операции, например `Open` , не защищены. Следует убедиться, что эти операции не будут вызываться одновременно из разных потоков.

Дополнительные сведения о создании многопоточных приложений см. в [статьях о многопоточной](../../parallel/multithreading-support-for-older-code-visual-cpp.md)работе.

## <a name="see-also"></a>См. также раздел

[Открытие подключения к базе данных (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Программирование доступа к данным (MFC/ATL)](../../data/data-access-programming-mfc-atl.md)
