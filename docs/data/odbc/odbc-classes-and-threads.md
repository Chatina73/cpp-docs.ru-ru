---
title: Потоки и классы ODBC
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC classes, and threads
- ODBC, multithreaded applications
- threading [MFC], ODBC support
ms.assetid: 16543926-7331-41a6-ba50-72288f2a61b7
ms.openlocfilehash: aaf54a3a1d616cde5742dad45955bd415f612d60
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368690"
---
# <a name="odbc-classes-and-threads"></a>Потоки и классы ODBC

Начиная с MFC 4.2, существует многопочная поддержка классов MFC ODBC. Обратите внимание, однако, что MFC не обеспечивает многопоточной поддержки для классов DAO.

Поддержка многопоточности для классов ODBC имеет некоторые ограничения. Поскольку эти классы обертывают API ODBC, они ограничены многопоточной поддержкой компонентов, на которых они построены. Например, многие драйверы ODBC не являются безопасными для потоков; таким образом, классы MFC ODBC не являются безопасными для потоков, если использовать их с одним из этих драйверов. Вы должны проверить, является ли ваш конкретный драйвер безопасным потоком.

При создании многопоточного приложения следует быть очень осторожным в использовании нескольких потоков для управления одним и тем же объектом. Например, использование `CRecordset` одного и того же объекта в двух потоках может вызвать проблемы при извлечении данных; операция по извлечению в одном потоке может перезаписать данные, извлеченные в другом потоке. Более широкое использование классов MFC ODBC в отдельных `CDatabase` потоках заключается в том, чтобы совместно `CRecordset` использовать открытый объект между потоками, чтобы использовать одно и то же соединение ODBC с отдельным объектом в каждом потоке. Обратите внимание, что не `CDatabase` следует передавать `CRecordset` неоткрытый объект объекту в другом потоке.

> [!NOTE]
> Если необходимо, чтобы несколько потоков манипулировали тем же объектом, следует реализовать соответствующие механизмы синхронизации, такие как критические разделы. Имейте в виду, `Open`что некоторые операции, такие как , не защищены. Вы должны быть уверены, что эти операции не будут называться одновременно из отдельных потоков.

Для получения дополнительной [информации](../../parallel/multithreading-support-for-older-code-visual-cpp.md)о создании многопоточных приложений см.

## <a name="see-also"></a>См. также раздел

[Открытая связь с базами данных (ODBC)](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Программирование доступа к данным (MFC/ATL)](../../data/data-access-programming-mfc-atl.md)
