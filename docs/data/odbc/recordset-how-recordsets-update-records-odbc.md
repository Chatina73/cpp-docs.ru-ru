---
title: Набор записей. Порядок обновления записей в наборе (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- records, updating
- ODBC recordsets, updating
- recordsets, editing records
- updating recordsets
- recordsets, updating
ms.assetid: 5ceecc06-7a86-43b1-93db-a54fb1e717c7
ms.openlocfilehash: 03fb696c1fadd834962d37c8e75b5f8910af819e
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366981"
---
# <a name="recordset-how-recordsets-update-records-odbc"></a>Набор записей. Порядок обновления записей в наборе (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Помимо возможности выбора записей из источника данных, записи могут (по желанию) обновлять или удалять выбранные записи или добавлять новые записи. Обновляемость обновления определяется тремя факторами: является ли подключенный источник данных обновляемым, параметры, указанные при создании объекта записи, и созданный s'L.

> [!NOTE]
> СЗЛ, на `CRecordset` котором основан ваш объект, может повлиять на возможность обновления вашего набора записей. Например, если ваш S'L содержит предложение о присоединении или **пункте GROUP BY,** MFC устанавливает возможность обновления FALSE.

> [!NOTE]
> Этот раздел относится к объектам, производным от `CRecordset`, в которых пакетное получение строк не реализовано. Если вы используете объем строки извлечения, см [Recordset: Извлечение записей в массовых (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

В этом разделе рассматриваются следующие вопросы.

- [Ваша роль в обновлении записей](#_core_your_role_in_recordset_updating) и то, что фреймворк делает для вас.

- [Запись как буфер для отодевных](#_core_the_edit_buffer) и [различия между динасетами и моментальными снимками.](#_core_dynasets_and_snapshots)

[Запись: Как AddNew, Edit, и удалить работы (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) описывает действия этих функций с точки зрения рекорда.

[Запись: Подробнее об обновлениях (ODBC)](../../data/odbc/recordset-more-about-updates-odbc.md) завершает историю обновления, объясняя, как транзакции влияют на обновления, как закрытие набора записей или прокрутки влияет на обновления в процессе, и как ваши обновления взаимодействуют с обновлениями других пользователей.

## <a name="your-role-in-recordset-updating"></a><a name="_core_your_role_in_recordset_updating"></a>Ваша роль в обновлении звукозаписи

В следующей таблице показана ваша роль в использовании записей для добавления, отсвазания или удаления записей, а также того, что фреймворк делает для вас.

### <a name="recordset-updating-you-and-the-framework"></a>Обновление записей: Вы и рамочная

|Вы|Платформа|
|---------|-------------------|
|Определите, является ли источник данных обновляемым (или пригодным).|Поставляет функции члена [CDatabase](../../mfc/reference/cdatabase-class.md) для тестирования updateability или применимости источника данных.|
|Откройте updatable recordset (любого типа).||
|Определите, является ли набор данных updatable, вызывая `CRecordset` функции обновления, такие как `CanUpdate` или `CanAppend`.||
|Функции участника записи вызова для добавления, отсвачения и удаления записей.|Управляет механикой обмена данными между объектом записи и источником данных.|
|Дополнительно используйте транзакции для управления процессом обновления.|Функции участника поставок `CDatabase` для поддержки транзакций.|

Для получения дополнительной информации о транзакциях [см.](../../data/odbc/transaction-odbc.md)

## <a name="the-edit-buffer"></a><a name="_core_the_edit_buffer"></a>Эдит Буфер

Взятые в совокупности, полевых данных членов рекордных служить в качестве буфера редактировать, который содержит одну запись - текущую запись. Операции обновления используют этот буфер для работы на текущей записи.

- При добавлении записи буфер отодействия используется для создания новой записи. Когда вы закончите добавлять запись, запись, которая ранее была текущей, снова становится актуальной.

- При обновлении (отредечении) записи буфер редита используется для установки полевых данных в наборе данных к новым значениям. Когда вы закончите обновление, обновленная запись по-прежнему актуальная.

При вызове [AddNew](../../mfc/reference/crecordset-class.md#addnew) или [Edit](../../mfc/reference/crecordset-class.md#edit)текущая запись сохраняется, чтобы она была восстановлена позже по мере необходимости. При вызове [Delete](../../mfc/reference/crecordset-class.md#delete)текущая запись не сохраняется, но помечена как удаленная, и вы должны прокрутить другую запись.

> [!NOTE]
> Буфер удаления не играет никакой роли в удалении записей. При удалении текущей записи запись помечается как удаленная, а запись "не на записи", пока вы не прокрутите другую запись.

## <a name="dynasets-and-snapshots"></a><a name="_core_dynasets_and_snapshots"></a>Динасеты и снимки

[Dynasets](../../data/odbc/dynaset.md) обновляют содержимое записи при прокрутке записи. [Снимки](../../data/odbc/snapshot.md) являются статическими представлениями записей, поэтому содержимое записи не обновляется, если вы не [вызовете Requery](../../mfc/reference/crecordset-class.md#requery). Чтобы использовать все функциональные возможности dynasets, необходимо работать с драйвером ODBC, который соответствует правильному уровню поддержки ODBC API. Для получения дополнительной информации [Dynaset](../../data/odbc/dynaset.md) [см.](../../data/odbc/odbc-basics.md)

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Наборы записей. Принципы работы функций AddNew, Edit и Delete (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)
