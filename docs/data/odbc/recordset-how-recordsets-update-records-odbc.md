---
title: Набор записей. Принципы обновления записей в наборе записей (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- records, updating
- ODBC recordsets, updating
- recordsets, editing records
- updating recordsets
- recordsets, updating
ms.assetid: 5ceecc06-7a86-43b1-93db-a54fb1e717c7
ms.openlocfilehash: bf71f562714e2dacfe75540e1e532219b3eb307f
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59034486"
---
# <a name="recordset-how-recordsets-update-records-odbc"></a>Набор записей. Принципы обновления записей в наборе записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Помимо функции для выбора записей из источника данных наборы записей можно (необязательно) обновить или удалить выбранные записи или добавления новых записей. Три фактора определяют набора записей к обновлению: подключенного источника данных обновляется, заданные параметры при создании объекта набора записей и SQL, который создается.

> [!NOTE]
>  SQL, на котором вашей `CRecordset` основан объект может повлиять на функцию обновления набора записей. Например если SQL имеет соединение или **GROUP BY** предложение, MFC задает функцию обновления значение FALSE.

> [!NOTE]
>  Этот раздел относится к объектам, производным от `CRecordset` в какой строке массовой выборка не был реализован. Если вы используете выборка строк, см. в разделе [набор записей: Пакетная выборка строк (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

Содержание раздела:

- [Роль пользователя в обновлении набора записей](#_core_your_role_in_recordset_updating) и что платформа делает за вас.

- [Набор записей, как изменить буфер](#_core_the_edit_buffer) и [различия между динамических подмножеств данных и моментальные снимки](#_core_dynasets_and_snapshots).

[Набор записей. Как AddNew, Edit и Delete (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md) описывает действия этих функций с точки зрения набора записей.

[Набор записей. Дополнительные сведения об обновлениях (ODBC)](../../data/odbc/recordset-more-about-updates-odbc.md) завершает рассказ влияние транзакций на обновления, как закрытие набора записей или прокрутки влияет на обновления в процессе выполнения и как обновления взаимодействуют с обновлениями для других пользователей.

##  <a name="_core_your_role_in_recordset_updating"></a> Роль пользователя в обновлении набора записей

В следующей таблице показаны роли с помощью наборов записей, чтобы добавить, изменить или удалить записи, а также то, что платформа делает за вас.

### <a name="recordset-updating-you-and-the-framework"></a>Обновление набора записей. Вы и платформа

|Вы|Платформа|
|---------|-------------------|
|Определите, является ли источник данных может обновляться (или добавление).|Блоки [CDatabase](../../mfc/reference/cdatabase-class.md) функции-члены для тестирования обновлению источника данных или к присоединению.|
|Откройте обновляемого набора записей (любого типа).||
|Определить, является ли набор записей путем вызова обновляемых `CRecordset` обновление функций, таких как `CanUpdate` или `CanAppend`.||
|Вызов функции-члены для добавления, изменения и удаления записей recordset.|Управляет механизмом обмена данными между объекта набора записей и источником данных.|
|При необходимости использования транзакций для управления процессом обновления.|Блоки `CDatabase` функции-члены для поддержки транзакций.|

Дополнительные сведения о транзакциях см. в разделе [транзакции (ODBC)](../../data/odbc/transaction-odbc.md).

##  <a name="_core_the_edit_buffer"></a> В буфере

Взятые вместе, элементами данных полей в наборе записей служат в качестве буфера изменений, содержит одну запись — текущей записи. Операции обновления используйте этот буфер для обработки текущей записи.

- При добавлении записи в буфере используется для создания новой записи. После завершения добавления записи, запись, которая была текущей снова становится текущей.

- При обновлении (изменения) записи, редактирования буфера используется для задания элементами данных полей в наборе записей с новыми значениями. После завершения обновления, по-прежнему обновленной записи.

При вызове [AddNew](../../mfc/reference/crecordset-class.md#addnew) или [изменить](../../mfc/reference/crecordset-class.md#edit), текущая запись сохраняется, чтобы можно было восстановить позднее при необходимости. При вызове [удалить](../../mfc/reference/crecordset-class.md#delete), текущая запись не сохраняется, а помечается как удаленная, и необходимо перейти к другой записи.

> [!NOTE]
>  В буфере не играет роли в процессе удаления записи. При удалении текущей записи, запись помечается как удаленная и набор записей является «не для записи», пока пользователь не переместится на другую запись.

##  <a name="_core_dynasets_and_snapshots"></a> Подмножества и моментальные снимки

[Динамических подмножеств данных](../../data/odbc/dynaset.md) обновляют содержимое записей, при переходе к записи. [Моментальные снимки](../../data/odbc/snapshot.md) являются статическими представлениями записей, поэтому содержимое записей не обновляются только при вызове [Requery](../../mfc/reference/crecordset-class.md#requery). Чтобы использовать все функции динамических подмножеств данных, необходимо работать с помощью драйвера ODBC, соответствующий требуемому уровню поддержки API-интерфейса ODBC. Дополнительные сведения см. в разделе [ODBC](../../data/odbc/odbc-basics.md) и [динамический набор](../../data/odbc/dynaset.md).

## <a name="see-also"></a>См. также

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Как AddNew, Edit и Delete рабочих (ODBC)](../../data/odbc/recordset-how-addnew-edit-and-delete-work-odbc.md)