---
title: Набор записей. Сортировка записей (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- sorting data, recordset data
- ODBC recordsets, sorting
- recordsets, sorting
ms.assetid: b40b152e-0a91-452e-be7b-e5bc27f744c7
ms.openlocfilehash: 8b4deea1d8cbd4abe01ccc7a4114131378abe463
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366927"
---
# <a name="recordset-sorting-records-odbc"></a>Набор записей. Сортировка записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Эта тема объясняет, как сортировать ваш рекорд. Вы можете указать одну или несколько столбцов, на которых можно основывать сортировку, и можно указать восходящий или убывающий порядок **(ASC** или **DESC;** **ASC** является по умолчанию) для каждого указанного столбца. Например, если вы укажете два столбца, записи сортируются сначала по названной первой колонке, а затем по названной второй колонке. Пункт S'L **ORDER BY** определяет сортировку. Когда фреймворк прикладывает положение **ORDER BY** к запросу на S-L-записи, положение контролирует порядок выделения.

Вы должны установить порядок сортировки записи после `Open` построения объекта, но `Requery` прежде чем вы позвоните `Open` в функцию его члена (или перед вызовом функции элемента для существующего объекта набора записей, функция члена которого была вызвана ранее).

#### <a name="to-specify-a-sort-order-for-a-recordset-object"></a>Указать порядок сортировки для объекта, установленного в установленном порядке,

1. Постройте новый объект регистрации `Requery` (или подготовьтесь к вызову к существующему объекту).

1. Установите значение [m_strSort](../../mfc/reference/crecordset-class.md#m_strsort) члена данных объекта.

   Сорт — строка с нулевым завершением. Он содержит содержание оговорки **ORDER BY,** но не ключевое слово **ORDER BY**. Например, вы можете использовать следующие службы.

    ```
    recordset.m_strSort = "LastName DESC, FirstName DESC";
    ```

   not

    ```
    recordset.m_strSort = "ORDER BY LastName DESC, FirstName DESC";
    ```

1. Установите любые другие необходимые параметры, такие как фильтр, режим блокировки или параметры.

1. Вызов `Open` нового объекта (или `Requery` существующего объекта).

Выбранные записи упорядочены в указанные. Например, для сортировки набора студенческих записей в порядке убывания по фамилии, а затем по имени, сделайте следующее:

```cpp
// Construct the recordset
CStudentSet rsStudent( NULL );
// Set the sort
rsStudent.m_strSort = "LastName DESC, FirstName DESC";
// Run the query with the sort in place
rsStudent.Open( );
```

Рекордсет содержит все студенческие записи, отсортированные в порядке убывания (к A) по фамилии, затем по имени.

> [!NOTE]
> Если вы решите переопределить строку рекордсета по умолчанию, `Open`передавая свою собственную строку S'L, не устанавливайте сортировку, если пользовательская строка имеет оговорку **ORDER BY.**

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)<br/>
[Набор записей. Фильтрация записей (ODBC)](../../data/odbc/recordset-filtering-records-odbc.md)
