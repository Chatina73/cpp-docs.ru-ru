---
title: Транзакция. Влияние транзакций на обновления (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- transactions, updating recordsets
- ODBC recordsets, transactions
- transactions, rolling back
- CommitTrans method
- Rollback method, ODBC transactions
ms.assetid: 9e00bbf4-e9fb-4332-87fc-ec8ac61b3f68
ms.openlocfilehash: 8a87176ecb20beaf46583e1190b0ad458d508b31
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376423"
---
# <a name="transaction-how-transactions-affect-updates-odbc"></a>Транзакция. Влияние транзакций на обновления (ODBC)

Обновления [источника данных](../../data/odbc/data-source-odbc.md) управляются во время транзакций с помощью буфера рекрута (тот же метод, используемый вне транзакций). Полевой набор данных, состоящий из рекордных наборов, коллективно служит буфером для отправления, содержащим текущую `AddNew` запись, которую запись временно резервного копирования во время или `Edit`. Во `Delete` время операции текущая запись не резервируется в транзакции. Для получения дополнительной информации о буфере изменения и [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)о том, как обновления хранят текущую запись, см.

> [!NOTE]
> Если вы реализовали объем строки `AddNew`извлечения, вы не можете позвонить, `Edit`или `Delete`. Вместо этого необходимо написать свои собственные функции для выполнения обновлений источника данных. Для получения дополнительной информации о массовом строке извлечения, см [Recordset: Извлечение записей в массовых (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

Во время `AddNew` `Edit`транзакций, и `Delete` операции могут быть совершены или откат. Эффекты `CommitTrans` и `Rollback` могут привести к тому, что текущая запись не будет восстановлена в буфере отправления. Чтобы убедиться, что текущая запись восстановлена должным `CommitTrans` образом, важно `CDatabase` понять, как `CRecordset`и `Rollback` член функций работы с функциями обновления .

## <a name="how-committrans-affects-updates"></a><a name="_core_how_committrans_affects_updates"></a>Как CommitTrans влияет на обновления

В следующей таблице `CommitTrans` объясняется влияние транзакций.

### <a name="how-committrans-affects-updates"></a>Как CommitTrans влияет на обновления

|Операция|Состояние источника данных|
|---------------|---------------------------|
|`AddNew`и, `Update`а затем ,`CommitTrans`|Новая запись добавляется в источник данных.|
|`AddNew`(без), `Update`а затем`CommitTrans`|Новый рекорд потерян. Запись не добавляется к источнику данных.|
|`Edit`и, `Update`а затем ,`CommitTrans`|Отодвилость к источнику данных.|
|`Edit`(без), `Update`а затем`CommitTrans`|Отодвило к записи потеряно. Запись остается неизменной на источнике данных.|
|`Delete`Затем`CommitTrans`|Записи, удаленные из источника данных.|

## <a name="how-rollback-affects-transactions"></a><a name="_core_how_rollback_affects_updates"></a>Как откат влияет на транзакции

В следующей таблице `Rollback` объясняется влияние транзакций.

### <a name="how-rollback-affects-transactions"></a>Как откат влияет на транзакции

|Операция|Состояние текущей записи|Вы также должны|Состояние источника данных|
|---------------|------------------------------|-------------------|---------------------------|
|`AddNew`и `Update`, то`Rollback`|Содержимое текущей записи временно хранится, чтобы освободить место для новой записи. Новая запись вводится в буфер отодействия. После `Update` вызова текущая запись восстанавливается в буфере отсвагивания.||Добавление к источнику `Update` данных, сделанным, обратно.|
|`AddNew`(без), `Update`то`Rollback`|Содержимое текущей записи временно хранится, чтобы освободить место для новой записи. Буфер edit содержит новую запись.|Повторите вызов, `AddNew` чтобы восстановить буфер отсеиваний в пустую новую запись. Или `Move`вызов (0) для восстановления старых значений в буфере отсвагивателя.|Поскольку `Update` не был вызван, не было никаких изменений, внесенных в источник данных.|
|`Edit`и `Update`, то`Rollback`|Временно хранится неотредактированная версия текущей записи. Отослаиваются к содержимому буфера отодвина. После `Update` вызова неотредактированная версия записи по-прежнему временно хранится.|*Dynaset*: Прокрутите текущую запись, затем верните неотредактированную версию записи в буфер редактирования.<br /><br /> *Моментальный снимок*: Вызов `Requery` для обновления набора записей из источника данных.|Изменения в источнике `Update` данных, внесенные, отменяются.|
|`Edit`(без), `Update`то`Rollback`|Временно хранится неотредактированная версия текущей записи. Отослаиваются к содержимому буфера отодвина.|Повторите вызов, `Edit` чтобы восстановить неотредактированную версию записи в буфер редактирования.|Поскольку `Update` не был вызван, не было никаких изменений, внесенных в источник данных.|
|`Delete`Затем`Rollback`|Содержимое текущей записи удаляется.|Вызов `Requery` для восстановления содержимого текущей записи из источника данных.|Удаление данных из источника данных обратно.|

## <a name="see-also"></a>См. также раздел

[Транзакция (ODBC)](../../data/odbc/transaction-odbc.md)<br/>
[Транзакция. Выполнение транзакции в наборе записей (ODBC)](../../data/odbc/transaction-performing-a-transaction-in-a-recordset-odbc.md)<br/>
[Класс CDatabase](../../mfc/reference/cdatabase-class.md)<br/>
[Класс CRecordset](../../mfc/reference/crecordset-class.md)
