---
title: Набор записей. Работа с большими элементами данных (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- BLOB (binary large object), recordsets
- ODBC recordsets, binary large objects
- recordsets, binary large objects
- binary large objects
- CLongBinary class, using in recordsets
ms.assetid: 3e80b5a8-b6e7-43c6-a816-e54befc513a3
ms.openlocfilehash: b84365461ce6d45fccdf1922974feff5af93f99f
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80212762"
---
# <a name="recordset-working-with-large-data-items-odbc"></a>Набор записей. Работа с большими элементами данных (ODBC)

Этот раздел относится как к классам MFC ODBC, так и к классам MFC DAO.

> [!NOTE]
>  При использовании классов MFC DAO следует управлять большими элементами данных с помощью класса [CByteArray](../../mfc/reference/cbytearray-class.md) , а не класса [CLongBinary](../../mfc/reference/clongbinary-class.md). При использовании классов ODBC MFC с групповыми выборками строк используйте `CLongBinary`, а не `CByteArray`. Дополнительные сведения о групповой выборке строк см. [в разделе набор записей. сбор записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

Предположим, что база данных может хранить большие фрагменты данных, такие как точечные рисунки (фотографии сотрудников, карты, рисунки товаров, объекты OLE и т. д.). Данные такого рода часто называют большими двоичными объектами (или BLOB), поскольку:

- Каждое поле имеет большое значение.

- В отличие от чисел и других простых типов данных, он не имеет прогнозируемого размера.

- Данные не имеют формы с точки зрения программы.

В этом разделе объясняется, что обеспечивает поддержка классов баз данных для работы с такими объектами.

##  <a name="managing-large-objects"></a><a name="_core_managing_large_objects"></a>Управление большими объектами

Наборы записей имеют два способа решения особой сложности при управлении большими двоичными объектами. Вы можете использовать класс [CByteArray](../../mfc/reference/cbytearray-class.md) или класс [CLongBinary](../../mfc/reference/clongbinary-class.md). Как правило, `CByteArray` является предпочтительным способом управления большими двоичными данными.

`CByteArray` требует больше ресурсов, чем `CLongBinary`, но более производительен, как описано в [классе CByteArray](#_core_the_cbytearray_class). `CLongBinary` кратко описывается в [классе CLongBinary](#_core_the_clongbinary_class).

Подробные сведения об использовании `CByteArray` для работы с элементами данных большого размера см. в [техническом примечании 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).

##  <a name="cbytearray-class"></a><a name="_core_the_cbytearray_class"></a>Класс CByteArray

`CByteArray` является одним из классов коллекций MFC. Объект `CByteArray` хранит динамический массив байтов — массив может увеличиваться при необходимости. Класс обеспечивает быстрый доступ по индексу, как и к встроенным C++ массивам. `CByteArray` объекты могут быть сериализованы и выгружены в целях диагностики. Класс предоставляет функции элементов для получения и установки указанных байтов, вставки и добавления байтов и удаления одного байта или всех байтов. Эти средства упрощают синтаксический анализ двоичных данных. Например, если двоичный объект является объектом OLE, может потребоваться проработать с некоторыми байтами заголовка для достижения фактического объекта.

##  <a name="using-cbytearray-in-recordsets"></a><a name="_core_using_cbytearray_in_recordsets"></a>Использование CByteArray в наборах записей

Предоставляя элемент данных поля в наборе записей типа `CByteArray`, вы предоставляете фиксированную базу, из которой [RFX](../../data/odbc/record-field-exchange-rfx.md) может управлять передачей такого объекта между набором записей и источником данных, а также с помощью которого можно манипулировать данными внутри объекта. RFX требует определенного сайта для получения данных, и необходим способ доступа к базовым данным.

Подробные сведения об использовании `CByteArray` для работы с элементами данных большого размера см. в [техническом примечании 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).

##  <a name="clongbinary-class"></a><a name="_core_the_clongbinary_class"></a>Класс CLongBinary

Объект [CLongBinary](../../mfc/reference/clongbinary-class.md) — это простая оболочка для `HGLOBAL`ного маркера на блок хранилища, выделенный в куче. При привязке столбца таблицы, содержащего большой двоичный объект, RFX выделяет `HGLOBAL`ный обработчик, когда ему требуется передавать данные в набор записей, и сохраняет этот маркер в поле `CLongBinary` набора записей.

В свою очередь, вы используете `HGLOBAL`ный обработчик `m_hData`для работы с самими данными, как и в случае с любыми данными обработчиков. Именно здесь [CByteArray](../../mfc/reference/cbytearray-class.md) добавляет возможности.

> [!CAUTION]
>  Объекты CLongBinary не могут использоваться в качестве параметров в вызовах функций. Кроме того, их реализация, которая вызывает `::SQLGetData`, обязательно снижает производительность прокрутки для прокручиваемого моментального снимка. Это также может быть верно при использовании `::SQLGetData` вызова для получения столбцов динамической схемы.

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Определение сумм и других статистических результатов (ODBC)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)<br/>
[Обмен данными полей записей (RFX)](../../data/odbc/record-field-exchange-rfx.md)
