---
description: 'Дополнительные сведения: набор записей: работа с большими элементами данных (ODBC)'
title: Набор записей. Работа с большими элементами данных (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- BLOB (binary large object), recordsets
- ODBC recordsets, binary large objects
- recordsets, binary large objects
- binary large objects
- CLongBinary class, using in recordsets
ms.assetid: 3e80b5a8-b6e7-43c6-a816-e54befc513a3
ms.openlocfilehash: 7a4ca6de9c0b5be32626c8ca3c7c66cc516057e4
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97204372"
---
# <a name="recordset-working-with-large-data-items-odbc"></a>Набор записей. Работа с большими элементами данных (ODBC)

Этот раздел относится как к классам MFC ODBC, так и к классам MFC DAO.

> [!NOTE]
> При использовании классов MFC DAO следует управлять большими элементами данных с помощью класса [CByteArray](../../mfc/reference/cbytearray-class.md) , а не класса [CLongBinary](../../mfc/reference/clongbinary-class.md). При использовании классов ODBC MFC с групповыми выборками строк используйте `CLongBinary` вместо `CByteArray` . Дополнительные сведения о групповой выборке строк см. [в разделе набор записей. сбор записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

Предположим, что база данных может хранить большие фрагменты данных, такие как точечные рисунки (фотографии сотрудников, карты, рисунки товаров, объекты OLE и т. д.). Данные такого рода часто называют большими двоичными объектами (или BLOB), поскольку:

- Каждое поле имеет большое значение.

- В отличие от чисел и других простых типов данных, он не имеет прогнозируемого размера.

- Данные не имеют формы с точки зрения программы.

В этом разделе объясняется, что обеспечивает поддержка классов баз данных для работы с такими объектами.

## <a name="managing-large-objects"></a><a name="_core_managing_large_objects"></a> Управление большими объектами

Наборы записей имеют два способа решения особой сложности при управлении большими двоичными объектами. Вы можете использовать класс [CByteArray](../../mfc/reference/cbytearray-class.md) или класс [CLongBinary](../../mfc/reference/clongbinary-class.md). В общем, `CByteArray` является предпочтительным способом управления большими двоичными данными.

`CByteArray` требует дополнительных издержек `CLongBinary` , чем, но более производительно, как описано в [классе CByteArray](#_core_the_cbytearray_class). `CLongBinary` описывается вкратце в [классе CLongBinary](#_core_the_clongbinary_class).

Подробные сведения об использовании `CByteArray` для работы с большими элементами данных см. в [техническом примечании 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).

## <a name="cbytearray-class"></a><a name="_core_the_cbytearray_class"></a> Класс CByteArray

`CByteArray` является одним из классов коллекций MFC. `CByteArray`Объект хранит динамический массив байтов — массив может увеличиваться при необходимости. Класс предоставляет быстрый доступ по индексу, как и встроенные массивы C++. `CByteArray` объекты могут быть сериализованы и выгружены в целях диагностики. Класс предоставляет функции элементов для получения и установки указанных байтов, вставки и добавления байтов и удаления одного байта или всех байтов. Эти средства упрощают синтаксический анализ двоичных данных. Например, если двоичный объект является объектом OLE, может потребоваться проработать с некоторыми байтами заголовка для достижения фактического объекта.

## <a name="using-cbytearray-in-recordsets"></a><a name="_core_using_cbytearray_in_recordsets"></a> Использование CByteArray в наборах записей

Предоставляя элемент данных поля в наборе записей типа `CByteArray` , вы предоставляете фиксированную базу, из которой [RFX](../../data/odbc/record-field-exchange-rfx.md) может управлять передачей такого объекта между набором записей и источником данных, с помощью которого можно манипулировать данными внутри объекта. RFX требует определенного сайта для получения данных, и необходим способ доступа к базовым данным.

Подробные сведения об использовании `CByteArray` для работы с большими элементами данных см. в [техническом примечании 45](../../mfc/tn045-mfc-database-support-for-long-varchar-varbinary.md).

## <a name="clongbinary-class"></a><a name="_core_the_clongbinary_class"></a> Класс CLongBinary

Объект [CLongBinary](../../mfc/reference/clongbinary-class.md) — это простая оболочка вокруг `HGLOBAL` маркера для блока хранения, выделенного в куче. При привязке столбца таблицы, содержащего большой двоичный объект, RFX выделяет `HGLOBAL` маркер, когда ему нужно передавать данные в набор записей, и сохраняет его в `CLongBinary` поле набора записей.

В свою очередь, с помощью `HGLOBAL` маркера можно `m_hData` работать с самими данными, как и с любыми данными обработчиков. Именно здесь [CByteArray](../../mfc/reference/cbytearray-class.md) добавляет возможности.

> [!CAUTION]
> Объекты CLongBinary не могут использоваться в качестве параметров в вызовах функций. Кроме того, их реализация, которая вызывает `::SQLGetData` , обязательно снижает производительность прокрутки для прокручиваемого моментального снимка. Это также может быть истинно при использовании `::SQLGetData` вызова для получения динамических столбцов схемы.

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. получение сумм и других статистических результатов (ODBC)](../../data/odbc/recordset-obtaining-sums-and-other-aggregate-results-odbc.md)<br/>
[Обмен полями записей (RFX)](../../data/odbc/record-field-exchange-rfx.md)
