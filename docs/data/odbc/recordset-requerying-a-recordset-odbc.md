---
title: Набор записей. Выполнение обновления наборов записей (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- recordsets, requerying
- requerying recordsets
- Requery method
- ODBC recordsets, requerying
- refreshing recordsets
ms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1
ms.openlocfilehash: cdae28f81eebe8427bc829072e0d9a83c6ec1722
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81366947"
---
# <a name="recordset-requerying-a-recordset-odbc"></a>Набор записей. Выполнение обновления наборов записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Эта тема объясняет, как можно использовать объект записи для повторного (т.е. обновить) из базы данных и когда вы можете сделать это с функцией участника [Requery.](../../mfc/reference/crecordset-class.md#requery)

Основными причинами затворства рекорда являются:

- Принесите запись в актуальном состоянии в отношении записей, добавленных вами или другими пользователями, и записей, удаленных другими пользователями (те, которые вы удаляете, уже отражены в наборе записей).

- Обновите набор записей на основе изменения значений параметров.

## <a name="bringing-the-recordset-up-to-date"></a><a name="_core_bringing_the_recordset_up_to_date"></a>Приведение Recordset до даты

Часто, вы хотите, чтобы выседать ваш объект рекорда, чтобы привести его в актуальном состоянии. В многопользовательской среде базы данных другие пользователи могут вносить изменения в данные в течение срока службы вашего набора записей. Для получения дополнительной информации о том, когда ваш рекорд отражает изменения, внесенные другими пользователями и когда записи других пользователей отражают ваши изменения, см. [Recordset: How Recordsets Update Records (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) и [Dynaset](../../data/odbc/dynaset.md).

## <a name="requerying-based-on-new-parameters"></a><a name="_core_requerying_based_on_new_parameters"></a>Реккерирование на основе новых параметров

Другим частым - и не менее важным - [использованиеre Requery](../../mfc/reference/crecordset-class.md#requery) является выбор нового набора записей на основе изменения значений параметров.

> [!TIP]
> Скорость запроса, вероятно, значительно `Requery` быстрее, если вы звоните с изменением значений параметров, чем если вы называете `Open` снова.

## <a name="requerying-dynasets-vs-snapshots"></a><a name="_core_requerying_dynasets_vs.._snapshots"></a>Повторная динасеты против снимков

Поскольку dynasets предназначены для представления набора записей с динамическими актуальными данными, необходимо часто закажать динасеты, если вы хотите отразить дополнения других пользователей. Снимки, с другой стороны, полезны, потому что вы можете безопасно полагаться на их статическое содержимое во время подготовки отчетов, расчета итогов и так далее. Тем не менее, иногда вы можете высказать моментальный снимок, а также. В многопользовательской среде данные моментального снимка могут потерять синхронизацию с исходным источником данных по мере изменения базы данных другими пользователями.

#### <a name="to-requery-a-recordset-object"></a>Для выжигиваем объекта регистрации

1. Вызов функции участника [Requery](../../mfc/reference/crecordset-class.md#requery) объекта.

Кроме того, можно закрыть и вновь открыть исходный набор записей. В любом случае новый набор записей представляет текущее состояние источника данных.

Например, см. [Просмотры записей: Заполнение ящика списка из второго набора записей.](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md)

> [!TIP]
> Чтобы `Requery` оптимизировать производительность, избегайте изменения [фильтра](../../data/odbc/recordset-filtering-records-odbc.md) или [сортировки](../../data/odbc/recordset-sorting-records-odbc.md)записи. Изменение только значения параметра перед вызовом. `Requery`

Если `Requery` вызов не удается, вы можете повторить вызов; в противном случае, ваше заявление должно быть прекращено изящно. Вызов `Requery` или `Open` может не удается по ряду причин. Возможно, возникает сетевая ошибка; или, во время вызова, после выпуска существующих данных, но до получения новых данных, другой пользователь может получить эксклюзивный доступ; или таблица, от которой зависит ваш рекорд, может быть удалена.

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Динамическая привязка столбцов данных (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)<br/>
[Набор записей. Создание и закрытие наборов записей (ODBC)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)
