---
description: 'Дополнительные сведения: набор записей: перезапрос набора записей (ODBC)'
title: Набор записей. Выполнение обновления наборов записей (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- recordsets, requerying
- requerying recordsets
- Requery method
- ODBC recordsets, requerying
- refreshing recordsets
ms.assetid: 4ebc3b5b-5b91-4f51-a967-245223c6b8e1
ms.openlocfilehash: 3efcaac1273e6b5cc786e983bfd59f73c870cbea
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97204476"
---
# <a name="recordset-requerying-a-recordset-odbc"></a>Набор записей. Выполнение обновления наборов записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

В этом разделе объясняется, как можно использовать объект набора записей для повторного запроса (то есть обновления) из базы данных, а также в том случае, если это необходимо сделать с помощью функции-члена [Requery](../../mfc/reference/crecordset-class.md#requery) .

Основные причины для переопроса набора записей:

- Приведите набор записей в актуальном состоянии по отношению к добавленным вами записям или другим пользователям и записям, удаленным другими пользователями (эти данные уже отражаются в наборе записей).

- Обновление набора записей на основе изменяющихся значений параметров.

## <a name="bringing-the-recordset-up-to-date"></a><a name="_core_bringing_the_recordset_up_to_date"></a> Обновление набора записей в актуальном состоянии

Часто возникает необходимость в обновлении объекта набора записей для его обновления. В многопользовательской среде базы данных другие пользователи могут вносить изменения в данные в течение жизненного цикла набора записей. Дополнительные сведения о том, когда набор записей отражает изменения, внесенные другими пользователями, и когда наборы записей других пользователей отражают ваши изменения, см. раздел [набор записей: как наборы записей обновляют записи (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md) и [динамический](../../data/odbc/dynaset.md)набор.

## <a name="requerying-based-on-new-parameters"></a><a name="_core_requerying_based_on_new_parameters"></a> Выполнение запроса на основе новых параметров

Другой часто — и так же важно — использование [запроса на обновление](../../mfc/reference/crecordset-class.md#requery) — это выбор нового набора записей на основе изменяющихся значений параметров.

> [!TIP]
> Скорость запроса может значительно ускориться при вызове `Requery` с изменением значений параметров, чем при `Open` повторном вызове.

## <a name="requerying-dynasets-vs-snapshots"></a><a name="_core_requerying_dynasets_vs.._snapshots"></a> Запрос динамических подмножеств и моментальных снимков

Так как динамические подмножества данных предназначены для представления набора записей с динамически обновляемыми данными, необходимо регулярно выполнять динамическое обновление подмножеств, если нужно отразить дополнения других пользователей. Моментальные снимки, с другой стороны, полезны, поскольку вы можете безопасно полагаться на их статическое содержимое при подготовке отчетов, вычислять итоги и т. д. Тем не менее иногда может потребоваться также выполнить повторный запрос моментального снимка. В многопользовательской среде данные моментального снимка могут потерять синхронизацию с источником данных, так как другие пользователи меняют базу данных.

#### <a name="to-requery-a-recordset-object"></a>Обновление объекта набора записей

1. Вызовите функцию члена с [обновлением](../../mfc/reference/crecordset-class.md#requery) для объекта.

Кроме того, можно закрыть и снова открыть исходный набор записей. В любом случае новый набор записей представляет текущее состояние источника данных.

Пример см. в разделе ["представления записей": заполнение списка из второго набора записей](../../data/filling-a-list-box-from-a-second-recordset-mfc-data-access.md).

> [!TIP]
> Чтобы оптимизировать `Requery` производительность, не изменяйте [Фильтр](../../data/odbc/recordset-filtering-records-odbc.md) набора записей или [сортировку](../../data/odbc/recordset-sorting-records-odbc.md). Измените только значение параметра перед вызовом метода `Requery` .

Если `Requery` вызов завершается неудачно, можно повторить вызов. в противном случае приложение должно завершиться корректно. Вызов `Requery` или `Open` может завершиться ошибкой по ряду причин. Возможно, возникла сетевая ошибка. или во время вызова после выпуска существующих данных, но до получения новых данных другой пользователь может получить монопольный доступ. или таблица, от которой зависит набор записей, может быть удалена.

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. динамическое связывание столбцов данных (ODBC)](../../data/odbc/recordset-dynamically-binding-data-columns-odbc.md)<br/>
[Набор записей. Создание и закрытие наборов записей (ODBC)](../../data/odbc/recordset-creating-and-closing-recordsets-odbc.md)
