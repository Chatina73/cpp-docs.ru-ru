---
title: Набор записей. Архитектура (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- recordsets, data members
- field data members, recordset architecture
- field data members
- m_nParams data member, recordsets
- recordsets, architecture
- parameter data members in recordsets
- m_nFields data member
- ODBC recordsets, architecture
- m_nParams data member
- m_nFields data member, recordsets
ms.assetid: 47555ddb-11be-4b9e-9b9a-f2931764d298
ms.openlocfilehash: 5904a69f81dd1fbf22171a46040da5d4f5511588
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2019
ms.locfileid: "59039654"
---
# <a name="recordset-architecture-odbc"></a>Набор записей. Архитектура (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

В этом разделе описаны элементы данных, составляющие архитектуру объекта набора записей:

- [Поля элементов данных](#_core_field_data_members)

- [Параметризованные члены данных](#_core_parameter_data_members)

- [Использование m_nFields и m_nParams элементов данных](#_core_using_m_nfields_and_m_nparams)

> [!NOTE]
>  Этот раздел относится к объектам, производным от `CRecordset` в какой строке массовой выборка не был реализован. Если выборка строк реализована, похоже архитектуры. Сведения о различиях, см. в разделе [набор записей: Пакетная выборка строк (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

##  <a name="_core_a_sample_class"></a> Пример класса

При использовании [Мастер потребителя MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) из **Добавление класса** мастер, чтобы объявить класс набора записей на основе `CRecordset`, результирующий класс имеет Общая структура Далее показан простой класс:

```cpp
class CCourse : public CRecordset
{
public:
   CCourse(CDatabase* pDatabase = NULL);
   ...
   CString m_strCourseID;
   CString m_strCourseTitle;
   CString m_strIDParam;
};
```

В начале класса, мастер записывает набор [полей с данными](#_core_field_data_members). При создании класса, необходимо указать один или несколько элементов данных полей. Если класс является параметризованным, что и в примере класс является (с данными-членом `m_strIDParam`), необходимо вручную добавить [параметризованные члены данных](#_core_parameter_data_members). Мастер не поддерживает добавление параметров для класса.

##  <a name="_core_field_data_members"></a> Поля элементов данных

Наиболее важные члены класса набора записей являются элементами данных полей. Для каждого столбца, выбранного из источника данных этот класс содержит элемент данных соответствующего типа данных для этого столбца. Например [образца класса](#_core_a_sample_class) показанный в начале этого раздела содержит два элемента данных поля, оба типа `CString`, который называется `m_strCourseID` и `m_strCourseTitle`.

При выборе набора записей, платформа автоматически связывает столбцы текущей записи (после `Open` вызова, первая запись становится текущей) с элементами данных полей объекта. То есть инфраструктура использует элемента данных соответствующего поля как буфер, в котором будет храниться содержимое столбца записи.

При переходе пользователя на новую запись, инфраструктура использует элементами данных полей для представления текущей записи. Платформа обновляет элементами данных полей, заменяя значения предыдущей записи. Элементами данных полей также используются для обновления текущей записи, а также для добавления новых записей. В рамках процесса обновления записи укажите значения обновления путем присвоения значений непосредственно для соответствующего элемента данных поля или членов.

##  <a name="_core_parameter_data_members"></a> Параметризованные члены данных

Если класс является параметризованным, она имеет один или несколько элементов данных параметров. Параметризованный класс позволяет делать запрос набора записей на данных, полученных или вычисляется во время выполнения.

Как правило параметр помогает сузить выбор, как показано в следующем примере. На основе [образца класса](#_core_a_sample_class) в начале этого раздела, в объект набора записей может выполнить следующую инструкцию SQL:

```sql
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = ?
```

«?» — Это значение параметра, который необходимо предоставить во время выполнения. При создании набора записей и задайте его `m_strIDParam` член данных MATH101, становится эффективным инструкции SQL набора записей:

```sql
SELECT CourseID, CourseTitle FROM Course WHERE CourseID = MATH101
```

Определив параметризованные члены данных, сообщить платформе о параметрах в строке SQL. Платформа framework привязывает параметр, который позволяет ODBC знать, где можно получить значения для замены заполнителя. В примере результирующий набор записей содержит только записи из таблицы со столбцом CourseID, значение которого равно MATH101 курса. Выбраны все указанные столбцы этой записи. Можно указать любое число параметров (и заполнители) требуется.

> [!NOTE]
>  MFC не выполняет с параметрами, в частности, он не выполняет подстановки текста. Вместо этого MFC сообщает ODBC, где для получения параметра; ODBC извлекает данные и выполняет необходимые параметризации.

> [!NOTE]
>  Важен порядок параметров. Сведения об этом и Дополнительные сведения о параметрах, см. в разделе [набор записей: Параметризация набора записей (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md).

##  <a name="_core_using_m_nfields_and_m_nparams"></a> С помощью m_nFields и m_nParams

Когда мастер создает конструктор для класса, он также инициализирует [m_nFields](../../mfc/reference/crecordset-class.md#m_nfields) элемента данных, которое указывает количество [полей с данными](#_core_field_data_members) в классе. Если какие-либо добавляются [параметры](#_core_parameter_data_members) к классу, необходимо также добавить инициализацию для [m_nParams](../../mfc/reference/crecordset-class.md#m_nparams) элемент данных, который указывает число элементов данных параметров. Инфраструктура использует эти значения для работы с элементами данных.

Дополнительные сведения и примеры см. в разделе [обмен полями записей: Использование RFX](../../data/odbc/record-field-exchange-using-rfx.md).

## <a name="see-also"></a>См. также

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Объявление класса таблицы (ODBC)](../../data/odbc/recordset-declaring-a-class-for-a-table-odbc.md)<br/>
[Обмен данными полями записей (RFX)](../../data/odbc/record-field-exchange-rfx.md)