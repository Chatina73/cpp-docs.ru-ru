---
title: Набор записей. Фильтрация записей (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- data [MFC], filtering
- recordsets [C++], filtering
- filtering recordsets
- ODBC recordsets [C++], filtering records
- filters [C++], recordset object
ms.assetid: 5c075f37-c837-464d-90c1-d028a9d1c175
ms.openlocfilehash: 56b8c4f52ec294f58a760e1309d32aa81286ddec
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81367016"
---
# <a name="recordset-filtering-records-odbc"></a>Набор записей. Фильтрация записей (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

В этой теме объясняется, как фильтровать набор записей таким образом, чтобы он выбирал только определенное подмножество доступных записей. Например, можно выбрать только разделы классов для определенного курса, например MATH101. Фильтр — это состояние поиска, определяемое содержимым положения «СЗЛ **WHERE».** Когда фреймворк приговостывает его к выписке о СЗЛ-икс-унижаемого места, положение **WHERE** ограничивает выбор.

Необходимо установить фильтр объекта записи после построения объекта, `Open` но прежде чем вы `Requery` позвоните в функцию `Open` его члена (или перед вызовом функции элемента для существующего объекта набора записей, функция члена которого была вызвана ранее).

#### <a name="to-specify-a-filter-for-a-recordset-object"></a>Указать фильтр для объекта, установленного записью

1. Постройте новый объект регистрации `Requery` (или подготовьтесь к вызову существующего объекта).

1. Установите значение [m_strFilter](../../mfc/reference/crecordset-class.md#m_strfilter) члена данных объекта.

   Фильтр представляет собой строку с нулевым завершением, содержащую содержимое положения о **СЗЛ,** но не ключевое слово **WHERE.** Например, вы можете использовать следующие службы.

    ```
    m_pSet->m_strFilter = "CourseID = 'MATH101'";
    ```

   not

    ```
    m_pSet->m_strFilter = "WHERE CourseID = 'MATH101'";
    ```

    > [!NOTE]
    >  Буквальная строка "MATH101" показана с одними кавычками выше. В спецификации ODBC S'L одиночные кавычки используются для обозначения строки символов буквально. В этой ситуации проверьте документацию водителя ODBC на требования к процитированию DBMS. Этот синтаксис также обсуждается ближе к концу этой темы.

1. Установите любые другие необходимые параметры, такие как порядок сортировки, режим блокировки или параметры. Особенно полезно указать параметр. Для получения информации о [Recordset: Parameterizing a Recordset (ODBC)](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md)параметризации фильтра см.

1. Вызов `Open` нового объекта (или `Requery` ранее открытого объекта).

> [!TIP]
> Использование параметров в фильтре потенциально является наиболее эффективным методом для извлечения записей.

> [!TIP]
> Фильтры записей полезны для [присоединения](../../data/odbc/recordset-performing-a-join-odbc.md) таблиц и для использования [параметров](../../data/odbc/recordset-parameterizing-a-recordset-odbc.md) на основе информации, полученной или рассчитанной во время выполнения.

В наборе записей выбираются только те записи, которые соответствуют указанному условию поиска. Например, чтобы указать описанный выше `strCourseID` фильтр курса (при условии, что в настоящее время переменная установлена, например, на "MATH101"), следует:

```
// Using the recordset pointed to by m_pSet

// Set the filter
m_pSet->m_strFilter = "CourseID = " + strCourseID;

// Run the query with the filter in place
if ( m_pSet->Open( CRecordset::snapshot, NULL, CRecordset::readOnly ) )

// Use the recordset
```

Рекордсет содержит записи для всех разделов класса для MATH101.

Обратите внимание, как строка фильтра была установлена в приведенном выше примере с помощью переменной строки. Это типичное использование. Но предположим, что вы хотели указать буквальное значение 100 для идентификатора курса. Следующий код показывает, как правильно настроить строку фильтра с буквальным значением:

```
m_strFilter = "StudentID = '100'";   // correct
```

Обратите внимание на использование символов с одной цитатой; если вы установите строку фильтра непосредственно, строка фильтра **не**является:

```
m_strFilter = "StudentID = 100";   // incorrect for some drivers
```

Приведение, показанное выше, соответствует спецификации ODBC, но некоторые DBMS могут потребовать других символов котировок. Для получения более подробной информации, [см.](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)

> [!NOTE]
> Если вы решите переопределить строку рекордсета по умолчанию, `Open`передавая свою собственную строку S'L, вы не должны устанавливать фильтр, если пользовательская строка имеет пункт **WHERE.** Для получения более подробной информации о переопределение по умолчанию S'L, [см.](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)

## <a name="see-also"></a>См. также раздел

[Набор записей (ODBC)](../../data/odbc/recordset-odbc.md)<br/>
[Набор записей. Сортировка записей (ODBC)](../../data/odbc/recordset-sorting-records-odbc.md)<br/>
[Набор записей. Порядок выборки записей в наборе (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md)<br/>
[Набор записей. Порядок обновления записей в наборе (ODBC)](../../data/odbc/recordset-how-recordsets-update-records-odbc.md)<br/>
[Набор записей: блокировка (ODBC)](../../data/odbc/recordset-locking-records-odbc.md)
