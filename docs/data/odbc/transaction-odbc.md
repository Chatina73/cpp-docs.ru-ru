---
title: Транзакция (ODBC)
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC recordsets [C++], updating
- transactions [C++], MFC ODBC classes
- ODBC [C++], transactions
- recordsets [C++], updating
- databases [C++], transactions
- recordsets [C++], transactions
- ODBC recordsets [C++], transactions
ms.assetid: a2ec0995-2029-45f2-8092-6efd6f2a77f4
ms.openlocfilehash: 0deb21a43ff17ca94efe29bdec37db7611331a86
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50615817"
---
# <a name="transaction-odbc"></a>Транзакция (ODBC)

Этот раздел относится к классам ODBC библиотеки MFC.

Транзакция — это способ группирования или партия, ряд обновлений для [источника данных](../../data/odbc/data-source-odbc.md) таким образом, все будут зафиксированы за один раз или не завершаются, если откат транзакции. Если вы не используете транзакции, изменения в источнике данных фиксируются автоматически, а по запросу.

> [!NOTE]
>  Не все драйверы для баз данных ODBC поддерживает транзакции. Вызовите `CanTransact` функцию-член вашей [CDatabase](../../mfc/reference/cdatabase-class.md) или [CRecordset](../../mfc/reference/crecordset-class.md) объектом, чтобы определить, поддерживает ли драйвер транзакций для заданной базы данных. Обратите внимание, что `CanTransact` не сообщает, имеется ли источник данных предоставляет полную поддержку транзакции. Необходимо также вызвать `CDatabase::GetCursorCommitBehavior` и `CDatabase::GetCursorRollbackBehavior` после `CommitTrans` и `Rollback` Проверка результата транзакции на открытом `CRecordset` объекта.

Вызовы `AddNew` и `Edit` функциями-членами `CRecordset` отразиться на источник данных, немедленно при вызове `Update`. `Delete` вызовы также вступают в силу немедленно. Напротив, можно использовать транзакции, состоящей из нескольких вызовов `AddNew`, `Edit`, `Update`, и `Delete`, которая будет выполнена, но не были зафиксированы до вызова метода `CommitTrans` явным образом. Устанавливая транзакцию, можно выполнить ряд таких вызовов сохранением возможности отката. Если недоступен важный ресурс или другое условие, препятствует выполнению всей транзакции, выполнить откат транзакции, а его фиксацией. В этом случае ни одно из изменений, относящихся к транзакции отражается на источнике данных.

> [!NOTE]
>  В настоящее время класса `CRecordset` не поддерживает обновления в источнике данных, если вы реализовали выборка строк. Это означает, что нельзя выполнять вызовы `AddNew`, `Edit`, `Delete`, или `Update`. Тем не менее можно написать собственные функции для выполнения обновлений и затем вызывать эти функции в транзакции. Дополнительные сведения о массовой выборке строк см. в разделе [набор записей: получение записей (ODBC)](../../data/odbc/recordset-fetching-records-in-bulk-odbc.md).

> [!NOTE]
>  Кроме того, изменяя набор записей, транзакции изменяют инструкции SQL, которые выполняются непосредственно до тех пор, пока используется ODBC **HDBC** связанный с вашей `CDatabase` объекта или ODBC **HSTMT** на основе **HDBC**.

Операции особенно полезны, когда у вас есть несколько записей, которые должны обновляться одновременно. В этом случае вы хотите избежать транзакции завершенности, таких как может произойти, если возникло исключение до последнего обновления. Группировка обновлений в транзакцию, которая позволяет отказаться от изменений (откат) и возвращает записи в предыдущее состояние. Например если банк переводит деньги со счета на счет B, и изъятие из а, в на B должны успешно завершиться для правильно или вся транзакция должна закончиться.

В классах базы данных, выполнения транзакций через `CDatabase` объектов. Объект `CDatabase` представляет подключение к источнику данных, и один или несколько наборов записей, связанных с `CDatabase` объект работают с таблицами базы данных через функции-члены набора записей.

> [!NOTE]
>  Поддерживается только один уровень транзакций. Нельзя создавать вложенные транзакции и транзакция может охватывать несколько объектов базы данных.

Дополнительные сведения о том, как выполняются операции в следующих разделах.

- [Транзакция. Выполнение транзакции в наборе записей (ODBC)](../../data/odbc/transaction-performing-a-transaction-in-a-recordset-odbc.md)

- [Транзакция. Влияние транзакций на обновления (ODBC)](../../data/odbc/transaction-how-transactions-affect-updates-odbc.md)

## <a name="see-also"></a>См. также

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)