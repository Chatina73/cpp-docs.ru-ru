---
title: SQL
ms.date: 05/09/2019
helpviewer_keywords:
- database classes [C++], SQL statements
- SQL [C++]
- SQL [C++], ODBC
- ODBC [C++], SQL implementation
ms.assetid: e3923bc4-b317-4e0b-afd8-3cd403eb0faf
ms.openlocfilehash: 5e31105e682e8acecbdc0da461614fc46e4ae227
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/21/2020
ms.locfileid: "80079771"
---
# <a name="sql"></a>SQL

Язык структурированных запросов SQL служит для взаимодействия с реляционными базами данных и позволяет определять, запрашивать, изменять данные, а также управлять ими. Используя синтаксис SQL, вы можете создавать инструкции, которые извлекают записи в соответствии с указанными вами критериями.

> [!NOTE]
>  Эта информация относится к классам ODBC библиотеки MFC. Если вы работаете с классами DAO библиотеки MFC, ознакомьтесь с разделом "Сравнение спецификаций языка SQL для ядра СУБД Microsoft Jet и для ANSI" в справке по DAO.

Инструкции SQL начинаются с ключевого слова команды, например **CREATE** или **SELECT**. Язык SQL является мощным инструментом, поскольку даже одна инструкция может полностью изменить таблицу.

Существует множество версий SQL, разработанных с учетом специфики конкретной СУБД, для которой они предназначены. Классы базы данных MFC распознают набор инструкций SQL, соответствующий проекту спецификации SQL для общей среды приложений (CAE), предложенному X/Open и SQL Access Group (1991). Сведения о синтаксисе этих инструкций см. в приложении C в *справочнике программиста* по *ODBC SDK* на компакт-диске библиотеки MSDN.

В этом разделе рассматриваются следующие вопросы.

- [Связь между ODBC и SQL](#_core_open_database_connectivity_.28.odbc.29).

- [Распространенные ключевые слова SQL, используемые в классах базы данных](#_core_the_database_classes).

- [Принципы использования SQL в классах базы данных](#_core_how_the_database_classes_use_sql).

##  <a name="open-database-connectivity-odbc"></a><a name="_core_open_database_connectivity_.28.odbc.29"></a> Открытый интерфейс доступа к базам данных (ODBC)

Классы базы данных реализуются на основе интерфейса ODBC, который использует SQL в интерфейсе уровня вызова вместо того, чтобы внедрять команды SQL в код. Интерфейс ODBC использует SQL для связи с [источником данных](../../data/odbc/data-source-odbc.md) посредством драйверов ODBC. Эти драйверы интерпретируют инструкции SQL и при необходимости преобразуют их в формат, используемый конкретной базой данных, например Microsoft Access. Дополнительные сведения о том, как интерфейс ODBC использует SQL, см. в [справочнике программиста](../../data/odbc/odbc-basics.md) по *ODBC* и пакету SDK ODBC на компакт-диске с библиотекой MSDN.

##  <a name="database-classes"></a><a name="_core_the_database_classes"></a> Классы базы данных

> [!NOTE]
> Мастер потребителя MFC ODBC недоступен в Visual Studio 2019 и более поздних версиях. При этом вы по-прежнему можете создать потребитель вручную.

Классы базы данных предназначены для обработки и обновления данных в [источнике данных](../../data/odbc/data-source-odbc.md). [Мастер приложений MFC](../../mfc/reference/database-support-mfc-application-wizard.md), [мастер потребителя MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) (доступен в диалоговом окне **Добавить класс**), а также классы базы данных обеспечивают автоматическое построение большинства инструкций SQL.

Классы базы данных используют часть SQL, известную как язык обработки данных (DML). Эти команды позволяют работать со всем источником данных или отдельными его частями, а также добавлять новые и редактировать или удалять существующие записи. В следующей таблице перечислены наиболее распространенные ключевые слова SQL и способы, которыми они используются в классах базы данных.

### <a name="some-common-sql-keywords"></a>Распространенные ключевые слова SQL

|Ключевое слово SQL|Мастер и классы базы данных, в которых используется ключевое слово|
|-----------------|---------------------------------------------|
|**SELECT**|Определяет используемые таблицы и столбцы источника данных.|
|**WHERE**|Применяет фильтр, ограничивающий выборку.|
|**ORDER BY**|Применяет порядок сортировки к набору записей.|
|**INSERT**|Добавляет новые записи в набор записей.|
|**DELETE**|Удаляет записи из набора записей.|
|**UPDATE**|Изменяет поля записи.|

Кроме того, классы базы данных распознают инструкции **CALL** ODBC, которые можно использовать для вызова предварительно определенного запроса (или хранимой процедуры) в отношении некоторых источников данных. Драйвер базы данных ODBC интерпретирует эти инструкции и подставляет команды, соответствующие конкретной СУБД.

> [!NOTE]
>  Вызовы **CALL** поддерживаются не для всех СУБД.

Если класс не распознает предоставленную пользователем инструкцию в `CRecordset::Open`, она интерпретируется как имя таблицы.

Объяснение того, как платформа конструирует инструкции SQL, см. в разделе [набор записей: как наборы записей выбирают записи (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md) и [SQL: Настройка инструкции SQL набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).

Базы данных SQL используют типы данных, схожие с теми, что применяются в C и C++. Обсуждение этих сходства см. в разделе [SQL: SQL и C++ типы данных (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md).

Дополнительные сведения о SQL, включая список поддерживаемых инструкций SQL, типы данных, грамматику SQL Core и список рекомендуемых публикаций SQL, см. в *справочнике программиста* по *ODBC SDK* на компакт-диске библиотеки MSDN.

##  <a name="how-the-database-classes-use-sql"></a><a name="_core_how_the_database_classes_use_sql"></a> Принципы использования SQL в классах базы данных

Наборы записей, являющиеся производными от классов базы данных, используют интерфейс ODBC для связи с источником данных. ODBC извлекает записи из источника данных, отправляя инструкции SQL. В этом разделе описывается взаимосвязь между классами базы данных и SQL.

Набор записей формирует инструкцию SQL, объединяя ее фрагменты в объект `CString`. Эта строка определяет инструкцию **SELECT**, которая возвращает набор записей.

Когда набор записей вызывает ODBC для отправки инструкции SQL в источник данных, диспетчер драйверов ODBC передает инструкцию в драйвер ODBC, который, в свою очередь, отправляет ее в основную СУБД. СУБД возвращает результирующий набор записей, а драйвер ODBC, в свою очередь, возвращает записи в приложение. Классы базы данных обеспечивают программе доступ к результирующему набору в типобезопасном классе C++, который является производным от `CRecordset`.

В следующих разделах приводятся дополнительные сведения о том, как классы базы данных используют SQL.

- [SQL. Настройка инструкции SQL для набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)

- [SQL. Типы данных SQL и C++ (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md)

- [SQL. Выполнение прямых вызовов SQL (ODBC)](../../data/odbc/sql-making-direct-sql-calls-odbc.md)

## <a name="see-also"></a>См. также:

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Основы ODBC](../../data/odbc/odbc-basics.md)