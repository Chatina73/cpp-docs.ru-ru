---
title: SQL-код
ms.date: 11/04/2016
helpviewer_keywords:
- database classes [C++], SQL statements
- SQL [C++]
- SQL [C++], ODBC
- ODBC [C++], SQL implementation
ms.assetid: e3923bc4-b317-4e0b-afd8-3cd403eb0faf
ms.openlocfilehash: 8f93d97530068695359273b523e7d2ae46de01cb
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59037861"
---
# <a name="sql"></a>SQL-код

SQL (язык структурированных запросов) — это способ связи в реляционной базе данных, которая позволяет определить запрос, изменения и управления данными. С помощью синтаксиса SQL, можно создать инструкцию, используемый для извлечения записей в соответствии с заданным вами условиям.

> [!NOTE]
>  Эти сведения относятся к классам ODBC библиотеки MFC. При работе с классами MFC DAO, см. в разделе сравнения из Microsoft Jet Database Engine SQL и ANSI SQL в справке DAO.

Инструкции SQL начинаются с ключевого слова команды, такие как **создать** или **ВЫБЕРИТЕ**. SQL — это очень мощный язык; один оператор может повлиять на всю таблицу.

Существует множество версий SQL, каждая из которых разработана с учетом определенной СУБД. Классы баз данных MFC распознает набор инструкций SQL, которые соответствует на X / Open и SQL SQL доступа группы общих приложений среды создание черновой спецификации (1991). Сведения о синтаксисе этих инструкций, см в *ODBC SDK* *справочнике программиста* на компакт-диске библиотеки MSDN.

Содержание раздела:

- [Связь между ODBC и SQL](#_core_open_database_connectivity_.28.odbc.29).

- [Наиболее распространенные ключевые слова SQL, используемые классами баз данных](#_core_the_database_classes).

- [Использование классов базы данных SQL](#_core_how_the_database_classes_use_sql).

##  <a name="_core_open_database_connectivity_.28.odbc.29"></a> Open Database Connectivity (ODBC)

Классы баз данных реализуются с помощью ODBC, который использует SQL в интерфейс уровня вызова, а не внедрять SQL-команды в коде. ODBC использует SQL для взаимодействия с [источника данных](../../data/odbc/data-source-odbc.md) посредством драйверов ODBC. Эти драйверы трактуют SQL и переводят его, если необходимо, для использования с базой данных определенного формата, таких как Microsoft Access. Дополнительные сведения об использовании ODBC SQL, см. в разделе [ODBC](../../data/odbc/odbc-basics.md) и ODBC SDK *справочнике программиста* на компакт-диске библиотеки MSDN.

##  <a name="_core_the_database_classes"></a> Классы баз данных

Классы баз данных предназначены для редактирования и обновления данных в существующем [источника данных](../../data/odbc/data-source-odbc.md). [Мастер приложений MFC](../../mfc/reference/database-support-mfc-application-wizard.md), [Мастер потребителя MFC ODBC](../../mfc/reference/adding-an-mfc-odbc-consumer.md) (через **Добавление класса**), и классы баз данных большинство инструкций SQL создается автоматически.

Классы баз данных использовать часть SQL, известные как язык обработки данных (DML). Эти команды позволяют работать с полностью или частично источника данных, добавить новые записи, редактирования записей и удаления записей. В следующей таблице перечислены наиболее распространенные ключевые слова SQL и использовать классы баз данных способы их.

### <a name="some-common-sql-keywords"></a>Некоторые распространенные ключевые слова SQL

|Ключевое слово SQL|Использовать классы баз данных и мастеров|
|-----------------|---------------------------------------------|
|**SELECT**|Чтобы определить, какие таблицы и столбцы в источнике данных будут использоваться.|
|**WHERE**|Применение фильтра, ограничивающего выборку.|
|**ORDER BY**|Чтобы применить порядок сортировки для набора записей.|
|**ВСТАВИТЬ**|Для добавления новых записей в набор записей.|
|**УДАЛЕНИЕ**|Для удаления записей из набора записей.|
|**ОБНОВЛЕНИЕ**|Для изменения полей записи.|

Кроме того, классы базы данных распознают ODBC **ВЫЗОВИТЕ** инструкции, которые можно использовать для вызова предопределенного запроса (или хранимой процедуры) в некоторых источниках данных. Драйвер базы данных ODBC интерпретирует эти инструкции и подставляет команду, подходящую для каждой СУБД.

> [!NOTE]
>  Не все поддержки СУБД **ВЫЗОВИТЕ** инструкций.

Если классы не могут распознать предоставленную пользователем инструкцию в `CRecordset::Open`, он интерпретируется как имя таблицы.

Описание инструкций SQL с платформой, см. в разделе [набор записей: Порядок выборки записей (ODBC)](../../data/odbc/recordset-how-recordsets-select-records-odbc.md) и [SQL: Настройка инструкции SQL набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md).

Базы данных SQL использовать типы данных похожи на применяемые в C и C++. Описание этих сходства, см. в разделе [SQL: SQL и типы данных C++ (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md).

Можно найти дополнительные сведения об SQL, включая список поддерживаемых инструкций SQL, типы данных, грамматику ядра SQL и список рекомендуемых публикаций о SQL, в *ODBC SDK* *Справочник по программированию*  на компакт-диске библиотеки MSDN.

##  <a name="_core_how_the_database_classes_use_sql"></a> Использование классов базы данных SQL

Наборы записей, производных от классов базы данных используйте ODBC для связи с источником данных и ODBC извлекает записи из источника данных путем отправки инструкций SQL. В этом разделе, рассказывает о связи между классами базы данных и SQL.

Набор записей создает инструкцию SQL путем построения частей инструкции SQL в `CString`. Строка формируется как **ВЫБЕРИТЕ** инструкцию, которая возвращает набор записей.

Когда набор записей вызывает ODBC для отправки инструкции SQL к источнику данных, диспетчер драйверов ODBC передает инструкцию драйверу ODBC и драйвер отправляет его базовой СУБД. СУБД возвращает результирующий набор записей, и драйвер ODBC возвращает записи в приложение. Классы баз данных позволяют доступ к вашей программе, результирующий набор в классе C++ строго типизированный производный от `CRecordset`.

Дополнительные сведения о том, использовать классы баз данных SQL в следующих разделах.

- [SQL: Настройка инструкции SQL набора записей (ODBC)](../../data/odbc/sql-customizing-your-recordsets-sql-statement-odbc.md)

- [SQL: SQL и типы данных C++ (ODBC)](../../data/odbc/sql-sql-and-cpp-data-types-odbc.md)

- [SQL: Выполнение прямых вызовов SQL (ODBC)](../../data/odbc/sql-making-direct-sql-calls-odbc.md)

## <a name="see-also"></a>См. также

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Основы ODBC](../../data/odbc/odbc-basics.md)