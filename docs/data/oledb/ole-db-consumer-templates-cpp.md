---
title: Шаблоны потребителей OLE DB (C++)
ms.date: 10/22/2018
helpviewer_keywords:
- databases [C++], OLE DB templates
- OLE DB consumers [C++], data access
- OLE DB consumer templates [C++]
- databases [C++], consumers
ms.assetid: d3e42612-0bc0-4d65-9c32-0e8a7b219e82
ms.openlocfilehash: d2697c955d2063bb075e06536b083c0b138aa4ac
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59031963"
---
# <a name="ole-db-consumer-templates-c"></a>Шаблоны потребителей OLE DB (C++)

Шаблоны потребителей OLE DB поддерживают спецификацию OLE DB версии 2.6. (Шаблоны потребителей OLE DB проверяются на соответствие OLE DB версии 2.6, но не поддерживают все интерфейсы спецификации.) Использование шаблонов потребителей позволяет свести к минимуму объем кода, который вам необходимо написать для реализации потребителя OLE DB. Шаблоны обеспечивают:

- удобный доступ к функциям OLE DB и интеграцию с ATL и MFC;

- простую модель привязки для параметров и столбцов базы данных;

- типы данных неуправляемого кода C/C++ для программирования OLE DB.

Чтобы использовать шаблоны OLE DB, необходимо иметь навыки работы с шаблонами C++, COM и интерфейсами OLE DB. Если вы не знакомы с OLE DB, см. в разделе [драйвера Microsoft OLE DB для SQL Server](/sql/connect/oledb/oledb-driver-for-sql-server).

Шаблоны OLE DB поддерживают существующую объектную модель OLE DB, а не добавляют новую объектную модель. Классы верхнего уровня в шаблонах потребителей OLE DB создают компоненты, параллельные компонентам, определенным в спецификации OLE DB. Шаблоны потребителей OLE DB включает дополнительные возможности, такие как несколько методов доступа к набору строк. Использование шаблонов и множественного наследования позволяет создавать более компактные и гибкие библиотеки.

## <a name="how-ole-db-consumers-access-data"></a>Как потребители OLE DB получают доступ к данным

Потребители используют несколько видов объектов, которые описаны в следующих разделах:

- [Источники данных и сеансы](../../data/oledb/data-sources-and-sessions.md)

- [Методы доступа и наборы строк](../../data/oledb/accessors-and-rowsets.md)

- [Команды и таблицы](../../data/oledb/commands-and-tables.md)

- [Записи пользователя](../../data/oledb/user-records.md)

Пока потребитель не выполняет никаких действий, вы выбираете поставщика OLE DB, соответствующего типу базы данных, к которой требуется получить доступ (например, SQL, Oracle, ODBC и MSDS). Для этого обычно используется перечислитель (см. раздел [CEnumerator](../../data/oledb/cenumerator-class.md) , как упоминалось в разделе [Источники данных и сеансы](../../data/oledb/data-sources-and-sessions.md)).

[Объект источника данных](../../data/oledb/data-sources-and-sessions.md) содержит сведения о подключении, необходимые для подключения к выбранному источнику данных. Объект источника данных также содержит сведения о проверке подлинности (например, имена для входа и пароли), которые используются для предоставления пользователям разрешений на доступ к источнику данных. Объект источника данных подключается к базе данных, а затем создает один или несколько объектов сеанса. Каждый [объект сеанса](../../data/oledb/data-sources-and-sessions.md) управляет своими взаимодействиями с базой данных (то есть запросом и извлечением данных) и выполняет эти транзакции независимо от других существующих сеансов.

Сеанс создает объекты наборов строк и команд. [Объект команды](../../data/oledb/commands-and-tables.md) позволяет пользователям взаимодействовать с базой данных, например с помощью команд SQL. [Объект набора строк](../../data/oledb/accessors-and-rowsets.md) представляет собой набор данных, по которому можно перемещаться и в котором можно [обновлять, удалять и вставлять строки](../../data/oledb/updating-rowsets.md).

Потребитель OLE DB связывает столбцы в таблицах базы данных с локальными переменными; для этого используется [метод доступа](../../data/oledb/accessors-and-rowsets.md), содержащий схему хранения данных в пределах потребителя. Эта схема состоит из набора привязок между столбцами таблицы и локальными буферами (переменными) в приложении потребителя.

Одним из важных моментов при работе с потребителями является объявление двух классов в потребителе: [класса команд (или таблиц)](../../data/oledb/commands-and-tables.md) и [класса записей пользователей](../../data/oledb/user-records.md). Доступ к набору строк вы получаете через класс команд (или таблиц), который наследует от класса метода доступа и от класса набора строк. Класс записей пользователя содержит описанную выше схему привязки набора строк.

Дополнительные сведения см. в следующих разделах:

- [Создание объекта-получателя OLE DB](../../data/oledb/creating-an-ole-db-consumer.md)

- [Общие сценарии использования потребителей OLE DB (примеры)](../../data/oledb/working-with-ole-db-consumer-templates.md)

## <a name="see-also"></a>См. также

[Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)<br/>
[Доступ к данным](../data-access-in-cpp.md)<br/>
[Документация по OLE DB SDK](/previous-versions/windows/desktop/ms722784(v=vs.85))<br/>
[Драйвер Microsoft OLE DB для SQL Server](/sql/connect/oledb/oledb-driver-for-sql-server)
