---
description: Дополнительные сведения о пуле ресурсов в приложении OLE DB
title: Создание пулов ресурсов в приложениях OLE DB
ms.date: 10/29/2018
helpviewer_keywords:
- OLE DB services [OLE DB], resource pooling
- resource pooling [OLE DB], services
- OLE DB, resource pooling
- OLE DB providers, resource pooling
ms.assetid: 2ead1bcf-bbd4-43ea-a307-bb694b992fc1
ms.openlocfilehash: 504217092f4e4a19a3db2898b97e6a35269db7ba
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97316873"
---
# <a name="resource-pooling-in-your-ole-db-application"></a>Создание пулов ресурсов в приложениях OLE DB

Чтобы использовать пулы в приложении, необходимо убедиться, что службы OLE DB вызываются путем получения источника данных с помощью `IDataInitialize` или `IDBPromptInitialize` . Если вы напрямую используете `CoCreateInstance` для вызова поставщика на основе CLSID поставщика, OLE DB служб не вызываются.

Службы OLE DB обслуживают пулы подключенных источников данных, пока не сохранится ссылка `IDataInitialize` или `IDBPromptInitialize` удерживается или пока используется соединение. Пулы также обслуживаются автоматически в среде служб COM+ 1,0 или службы IIS (IIS). Если приложение использует возможности пула извне в службах COM+ 1,0 или среде IIS, необходимо сохранить ссылку `IDataInitialize` или `IDBPromptInitialize` хотя бы одно подключение. Чтобы гарантировать, что пул не уничтожается, когда приложение выпустило Последнее подключение, храните ссылку или держите ее на подключении в течение всего времени существования приложения.

OLE DB Services определяет пул, из которого отображается соединение во время `Initialize` вызова. После того как подключение будет выведено из пула, его нельзя переместить в другой пул. Поэтому не следует выполнять в приложении действия, изменяющие сведения об инициализации, такие как вызов `UnInitialize` или вызов `QueryInterface` для интерфейса, зависящего от поставщика, перед вызовом метода `Initialize` . Кроме того, подключения, установленные с помощью значения Prompt, отличного от DBPROMPT_NOPROMPT, не входят в состав пула. Однако строку инициализации, полученную из соединения, установленного с помощью запроса, можно использовать для установки дополнительных соединений в пуле к одному и тому же источнику данных.

Некоторые поставщики должны устанавливать отдельное соединение для каждого сеанса. Эти дополнительные соединения должны быть отдельно прикреплены к распределенной транзакции, если таковая существует. Службы OLE DB Services кэшируют и повторно используют один сеанс для каждого источника данных, но если приложение запрашивает более одного сеанса за раз из одного источника данных, поставщик может создать дополнительные подключения и выполнить дополнительные операции прикрепления транзакций, которые не входят в состав пула. Более эффективным будет создание отдельного источника данных для каждого сеанса в среде в составе пула, чем создание нескольких сеансов из одного источника данных.

Наконец, поскольку ADO автоматически использует OLE DB Services, вы можете использовать ADO для установления соединений, а также для автоматического создания пулов и зачислений.

## <a name="see-also"></a>См. также раздел

[OLE DB пулов ресурсов и служб](../../data/oledb/ole-db-resource-pooling-and-services.md)
