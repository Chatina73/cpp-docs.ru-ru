---
title: Вопросы проектирования архитектуры OLE DB
ms.date: 05/09/2019
helpviewer_keywords:
- OLE DB, application design considerations
ms.assetid: 8caa7d99-d2bb-42c9-8884-74f228bb6ecc
ms.openlocfilehash: ef2837ea80c61f074cf567ee1fe61fa2cfa0ae73
ms.sourcegitcommit: 00e26915924869cd7eb3c971a7d0604388abd316
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/10/2019
ms.locfileid: "65525306"
---
# <a name="ole-db-architectural-design-issues"></a>Вопросы проектирования архитектуры OLE DB

> [!NOTE]
> Мастер объекта-получателя ATL OLE DB недоступен в Visual Studio 2019 и более поздних версиях. Эту функцию все еще можно добавить вручную. Дополнительные сведения см. в статье [Создание объекта-получателя без помощи мастера](creating-a-consumer-without-using-a-wizard.md).

Перед запуском приложения OLE DB рассмотрите следующие вопросы.

## <a name="what-programming-implementation-will-you-use-to-write-your-ole-db-application"></a>Какую программную реализацию вы будете использовать для написания приложения OLE DB?

Корпорация Майкрософт предлагает несколько библиотек для выполнения этой задачи: библиотека шаблонов OLE DB, атрибуты OLE DB и необработанные интерфейсы OLE DB в OLE DB SDK. Кроме того, существуют мастера, помогающие при написании программы. Эти реализации описаны в статье [Шаблоны, атрибуты и другие реализации OLE DB](../../data/oledb/ole-db-templates-attributes-and-other-implementations.md).

## <a name="do-you-need-to-write-your-own-provider"></a>Необходимо ли указывать собственного поставщика?

Большинству разработчиков не нужно указывать собственного поставщика. Корпорация Майкрософт предоставляет несколько поставщиков. При каждом создании подключение к данным (например, при добавлении потребителя в проект с помощью **мастера потребителя ATLE OLE DB**), в диалоговом окне **Свойства канала передачи данных** перечисляются все доступные поставщики, зарегистрированные в системе. Если один из поставщиков подходит для вашего хранилища данных и приложения для доступа к данным, проще всего воспользоваться одним из них. Однако если хранилище данных не соответствует ни одной из этих категорий, нужно создать собственного поставщика. Сведения о создании поставщиков см. в статье [OLE DB Provider Templates](../../data/oledb/ole-db-provider-templates-cpp.md) (Шаблоны поставщика OLE DB (С++)).

## <a name="what-level-of-support-do-you-need-for-your-consumer"></a>Какой уровень поддержки нужен для вашего потребителя?

Некоторые потребители могут быть базовыми; а другие — сложными. Функциональность объектов OLE DB определяется свойствами. Когда вы используете **Мастер потребителя ATL OLE DB** для создания потребителя или **Мастер поставщика базы данных** для создания поставщика, он устанавливает соответствующие свойства объекта, предоставляя стандартный набор функциональных возможностей. Однако, если сгенерированные мастером классы потребителя или поставщика не поддерживают все, что вам нужно, нужно обратиться к интерфейсам для этих классов в статье[OLE DB Templates Library](../../data/oledb/ole-db-templates.md) (Шаблоны OLE DB). Эти интерфейсы обертывают необработанные интерфейсы OLE DB, обеспечивая дополнительную реализацию, облегчающую их использование.

Например, если вы хотите обновить данные в наборе строк, но забыли указать это при создании потребителя с помощью мастера, можно указать функциональность после факта, задав свойства `DBPROP_IRowsetChange` и `DBPROP_UPDATABILITY` для объекта команды. Затем, когда набор строк создан, он имеет интерфейс `IRowsetChange`.

## <a name="do-you-have-older-code-using-another-data-access-technology-ado-odbc-or-dao"></a>У вас есть старый код, использующий другую технологию доступа к данным (ADO, ODBC или DAO)?

Учитывая возможные сочетания технологий (например, использование компонентов ADO с компонентами OLE DB и перенос кода ODBC в OLE DB), охват всех ситуаций выходит за пределы документации Visual C++. Однако на следующих веб-сайтах Майкрософт доступно множество статей, посвященных различным сценариям.

- [Центр справки и поддержки Майкрософт](https://support.microsoft.com/)

- [Microsoft Data Access Technical Articles Overview](https://msdn.microsoft.com/library/ms810811.aspx) (Обзор технических статей о доступе к данным Майкрософт)

## <a name="see-also"></a>См. также

[Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)<br/>
[Общие сведения о программировании OLE DB](../../data/oledb/ole-db-programming-overview.md)
