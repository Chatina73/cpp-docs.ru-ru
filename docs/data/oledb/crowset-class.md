---
title: Класс CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: dc4f619fb0dba924693682c927247e809fe2cfe9
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59032329"
---
# <a name="crowset-class"></a>Класс CRowset

Инкапсулирует объект набора строк OLE DB, а также несколько связанных интерфейсов и предоставляет методы обработки для набора строк данных.

## <a name="syntax"></a>Синтаксис

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Параметры

*TAccessor*<br/>
Класс, метод доступа. Значение по умолчанию — `CAccessorBase`.

## <a name="requirements"></a>Требования

**Заголовок:** atldbcli.h

## <a name="members"></a>Участники

### <a name="methods"></a>Методы

|||
|-|-|
|[AddRefRows](#addrefrows)|Увеличивает счетчик ссылок, связанный с текущей строкой.|
|[Закрыть](#close)|Освобождает строк и текущий `IRowset` интерфейс.|
|[Compare](#compare)|Сравнивает два закладки с помощью [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).|
|[CRowset](#crowset)|Создает новый `CRowset` объекта, который (при необходимости) связывается с `IRowset` интерфейс, предоставляемый в качестве параметра.|
|[Удалить](#delete)|Удаляет строки из набора строк с помощью [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)).|
|[FindNextRow](#findnextrow)|Находит следующий совпадающей строки после указанной закладке.|
|[GetApproximatePosition](#getapproximateposition)|Возвращает приблизительное позицию строка, соответствующая закладки.|
|[GetData](#getdata)|Извлекает данные из копии строки в наборе строк.|
|[GetDataHere](#getdatahere)|Извлекает данные из указанного буфера.|
|[GetOriginalData](#getoriginaldata)|Извлекает данные, наиболее недавно извлечены из или передана в источник данных, игнорируя ожидающие изменения.|
|[GetRowStatus](#getrowstatus)|Возвращает состояние всех строк.|
|[Вставить](#insert)|Создает и вставляет новую строку, используя [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85)).|
|[IsSameRow](#issamerow)|Сравнивает указанной строки с текущей строкой.|
|[MoveFirst](#movefirst)|Перемещает расположение next fetch в исходное положение.|
|[MoveLast](#movelast)|Переход к последней записи.|
|[MoveNext](#movenext)|Извлекает данные из последовательного следующую строку или указанное число позиций после следующей строки.|
|[MovePrev](#moveprev)|Переход к предыдущей записи.|
|[Функции MoveToBookmark](#movetobookmark)|Получает строку, помеченную с закладкой или строки с указанным смещением из эту закладку.|
|[MoveToRatio](#movetoratio)|Извлекает строки, начиная с долей позиции в наборе строк.|
|[ReleaseRows](#releaserows)|Вызовы [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) освободить дескриптор текущей строки.|
|[SetData](#setdata)|Задает значения данных в один или несколько столбцов из строки с помощью [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85)).|
|[Отменить](#undo)|Отменяет все изменения, внесенные в строку с последнего получения или [обновления](../../data/oledb/crowset-update.md).|
|[Обновление](#update)|Передает все ожидающие изменения, внесенные в текущую строку с момента последнего получения или обновления.|
|[UpdateAll](#updateall)|Передает все ожидающие изменения, внесенные во все строки с момента последнего получения или обновления.|

## <a name="remarks"></a>Примечания

В OLE DB набор строк — это объект, через который программа задает и получает данные.

Этот класс не предназначен для создан экземпляр, но вместо передается как параметр шаблона для `CTable` или `CCommand` (`CRowset` используется по умолчанию).

## <a name="addrefrows"></a> CRowset::AddRefRows

Вызовы [IRowset::AddRefRows](/previous-versions/windows/desktop/ms719619(v=vs.85)) приращения (один) счетчик ссылок, связанный с текущей дескриптор строки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод увеличивает счетчик ссылок для текущего дескриптора строки. Вызовите [ReleaseRows](../../data/oledb/crowset-releaserows.md) для уменьшения числа. Строки, возвращаемые методами перемещения имеют счетчик ссылок одного.

## <a name="close"></a> CRowset::Close

Освобождает строк и текущий [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) интерфейс.

### <a name="syntax"></a>Синтаксис

```cpp
void Close() throw();
```

### <a name="remarks"></a>Примечания

Этот метод освобождает все строки в настоящее время в наборе строк.

## <a name="compare"></a> CRowset::Compare

Сравнивает два закладки с помощью [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85)).

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Параметры

*Закладке Bookmark1*<br/>
[in] Первая закладка для сравнения.

*Bookmark2*<br/>
[in] Второй сравниваемый закладки.

*pComparison*<br/>
[out] Указатель на результат сравнения.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetLocate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetLocate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Сведения об использовании закладок потребителей, см. в разделе [с помощью закладок](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset::CRowset

Создает новый `CRowset` объекта, который (при необходимости) связывается с [IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85)) интерфейс, предоставляемый в качестве параметра.

### <a name="syntax"></a>Синтаксис

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Параметры

*pRowset*<br/>
[in] Указатель на `IRowset` интерфейс, связываемое с этим классом.

## <a name="delete"></a> CRowset::Delete

Вызовы [IRowsetChange::DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85)) для удаления текущей строки из набора строк.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

## <a name="findnextrow"></a> CRowset::FindNextRow

Находит следующий совпадающей строки после указанной закладке.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Параметры

*op*<br/>
[in] Операция для использования при сравнении значений строк. Значения, см. в разделе [IRowsetFind::FindNextRow](/previous-versions/windows/desktop/ms723091(v=vs.85)).

*pData*<br/>
[in] Указатель на значение для сравнения.

*wType*<br/>
[in] Указывает тип данных значение части буфера. Сведения об индикаторах типа, см. в разделе [типы данных](/previous-versions/windows/desktop/ms723969(v=vs.85)) в *Справочник программиста OLE DB по* в пакете Windows SDK.

*nLength*<br/>
[in] Длина в байтах, потребитель данных структуры, выделенной для значения данных. Дополнительные сведения см. в описании `cbMaxLen` в [структуры DBBINDING](/previous-versions/windows/desktop/ms716845(v=vs.85)) в *Справочник программиста OLE DB по.*

*bPrecision*<br/>
[in] Максимальная точность, используемый при получении данных. Используется, только если *wType* является DBTYPE_NUMERIC. Дополнительные сведения см. в разделе [преобразования, включающие DBTYPE_NUMERIC или DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) в *Справочник программиста OLE DB по*.

*bScale*<br/>
[in] Масштаб, используемый при получении данных. Используется, только если *wType* DBTYPE_NUMERIC или DBTYPE_DECIMAL. Дополнительные сведения см. в разделе [преобразования, включающие DBTYPE_NUMERIC или DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714(v=vs.85)) в *Справочник программиста OLE DB по*.

*bSkipCurrent*<br/>
[in] Количество строк из закладки, с которого начинается поиск.

*pBookmark*<br/>
[in] Закладка для позиции, с которого начинается поиск.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetFind`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetFind` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Сведения об использовании закладок потребителей, см. в разделе [с помощью закладок](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

Возвращает приблизительное позицию строка, соответствующая закладки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Параметры

*pBookmark*<br/>
[in] Указатель на закладка, которая определяет строку, позиция которого может быть найден. Значение NULL, если только количество строк является обязательным.

*pPosition*<br/>
[out] Указатель на расположение где `GetApproximatePosition` возвращает позицию строки. Значение NULL, если позиция не является обязательным.

*pcRows*<br/>
[out] Указатель на расположение где `GetApproximatePosition` возвращает общее число строк. Значение NULL, если количество строк не является обязательным.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetScroll`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetScroll` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Сведения об использовании закладок потребителей, см. в разделе [с помощью закладок](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset::GetData

Извлекает данные из копии строки в наборе строк.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Параметры

*nAccessor*<br/>
[in] Индекс (с нуля смещение) метода доступа для доступа к данным.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Если указать метод доступа, который не является автоматическим в [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), этот метод позволяет явным образом получать данные, передав номер доступа.

## <a name="getdatahere"></a> CRowset::GetDataHere

Извлекает данные из текущей строки и помещает его в указанный буфер.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Параметры

*nAccessor*<br/>
[in] Номер индекса метода доступа для доступа к данным.

*pBuffer*<br/>
[out] Буфер, в которую необходимо поместить данные в текущей записи.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Пример использования этой функции, см. в разделе [Образец MultiRead](../../overview/visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

Вызовы `IRowsetUpdate::GetOriginalData` для получения данных наиболее недавно извлечены из или передана в источник данных.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод получает данные из последней выбранной или передана в источник данных; он не сможет извлечь значения на основе ожидающие изменения.

Этот метод требует дополнительный интерфейс `IRowsetUpdate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetUpdate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="getrowstatus"></a> CRowset::GetRowStatus

Возвращает состояние всех строк.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Параметры

*pStatus*<br/>
[out] Указатель, по которой `GetRowStatus` возвращает значение состояния. См. в разделе DBPENDINGSTATUS в справочнике программиста OLE DB.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetUpdate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetUpdate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="insert"></a> CRowset::Insert

Создает и инициализирует новую строку, используя данные из метода доступа.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Параметры

*nAccessor*<br/>
[in] Код метода доступа, используемый для вставки данных.

*bGetHRow*<br/>
[in] Указывает, извлекается ли дескриптор для вставленной строки.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetChange`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetChange` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Вставка может завершиться ошибкой, если один или несколько столбцов, не является записываемым. Измените схему курсоров, чтобы исправить это.

### <a name="example"></a>Пример

В следующем примере показано, как доступ к источнику данных через набор строк, а затем вставьте в строку с помощью таблицы в этом наборе строк.

Во-первых создайте класс таблицы путем вставки нового объекта ATL в проект. Например, щелкните правой кнопкой мыши проект в рабочей области и выберите **новый объект ATL**. Из **доступ к данным** категорию **потребителя**. Создание пользовательского объекта типа **таблицы**. (Выбор **таблицы** создает набор строк непосредственно из таблицы; выделение **команда** создает набор строк с помощью команды SQL.) Выберите источник данных, указав таблицу, через который осуществляется доступ к этому источнику данных. При вызове объекта получателя **CCustomerTable**, затем вы реализуете вставки кода следующим образом:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

Сравнивает указанной строки с текущей строкой.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Параметры

*hRow*<br/>
[in] Дескриптор строки для сравнения с текущей строкой.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT. Значение S_OK означает, что строки совпадают. Другие значения, см. в разделе [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85)) в *Справочник программиста OLE DB по* в пакете Windows SDK.

## <a name="movefirst"></a> CRowset::MoveFirst

Перемещает курсор в исходное положение и извлекает начальной строки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Вызовы [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) можно переместить расположение next fetch в первоначальную позицию (позиции, которая была next fetch расположение во время создания набора строк) и извлекает начальной строки.

## <a name="movelast"></a> CRowset::MoveLast

Перемещает курсор на последнюю строку.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Вызовы [IRowset::RestartPosition](/previous-versions/windows/desktop/ms712877(v=vs.85)) можно переместить расположение next fetch в последнюю позицию и извлекает последнюю строку.

Этот метод, необходимо задать `DBPROP_CANSCROLLBACKWARDS` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк. (Для повышения производительности можно также задать `DBPROP_QUICKRESTART` значение VARIANT_TRUE.)

## <a name="movenext"></a> CRowset::MoveNext

Перемещает курсор к следующей записи.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Параметры

*lSkip*<br/>
[in] Количество строк, будут пропущены перед извлечением.

*bForward*<br/>
[in] Передайте **true** для перехода к следующей записи, **false** для перемещения в обратном.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT. Возвращает DB_S_ENDOFROWSET, по достижении конца набора строк.

### <a name="remarks"></a>Примечания

Выбирается следующий последовательный строка из `CRowset` объекта с запоминанием предыдущей позиции. При необходимости вы можете сразу перейти *lSkip* строк или перемещение назад.

Этот метод, необходимо задать следующие свойства перед вызовом `Open` на таблицу или команду, содержащую набор строк:

- `DBPROP_CANSCROLLBACKWARDS` должно быть равно VARIANT_TRUE, если *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` должно быть равно VARIANT_TRUE, если *bForward* = false

В противном случае (если *lSkip* > = 0 и *bForward* = true), необходимо задать дополнительные свойства.

## <a name="moveprev"></a> CRowset::MovePrev

Перемещает курсор к предыдущей записи.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод, необходимо задать либо `DBPROP_CANFETCHBACKWARDS` или `DBPROP_CANSCROLLBACKWARDS` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

Выбирается строка, помеченная закладку или строки с указанным смещением (*lSkip*) из этой закладки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Параметры

*Закладка*<br/>
[in] Закладка, расположения, из которого требуется извлечь данные.

*lSkip*<br/>
[in] Число строк из закладки в строку. Если *lSkip* равен нулю, первая строка выборки представляет строке с закладкой. Если *lSkip* -1, первый выбранная строка является строкой после строке с закладкой. Если *lSkip* равно -1, первая строка выборки представляет закладками строки.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetLocate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetLocate` значение VARIANT_TRUE, а также набора `DBPROP_CANFETCHBACKWARDS` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Сведения об использовании закладок потребителей, см. в разделе [с помощью закладок](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset::MoveToRatio

Извлекает строки, начиная с долей позиции в наборе строк.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Параметры

*nNumerator*<br/>
[in] Числитель, используемый для определения доли позиционные, из которого необходимо извлечь данные.

*nDenominator*<br/>
[in] Знаменатель, используемый для определения доли позиционные, из которого необходимо извлечь данные.

*bForward*<br/>
[in] Указывает, следует ли переместить вперед или назад. По умолчанию используется значение вперед.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

`MoveToRatio` Извлекает строки, в соответствии с примерно следующую формулу:

`(nNumerator *  RowsetSize ) / nDenominator`

Где `RowsetSize` — это размер набора строк, измеряется строками. Точность по этой формуле, зависит от определенного поставщика. Дополнительные сведения см. в разделе [IRowsetScroll::GetRowsAtRatio](/previous-versions/windows/desktop/ms709602(v=vs.85)).

Этот метод требует дополнительный интерфейс `IRowsetScroll`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetScroll` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="releaserows"></a> CRowset::ReleaseRows

Вызовы [IRowset::ReleaseRows](/previous-versions/windows/desktop/ms719771(v=vs.85)) освободить дескриптор текущей строки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

## <a name="setdata"></a> CRowset::SetData

Задает значения данных в один или несколько столбцов строки.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Параметры

*nAccessor*<br/>
[in] Код метода доступа для доступа к данным.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Для `SetData` форму, которая принимает аргументы, все методы доступа используются для обновления. Обычно вызывается `SetData` для задания значений данных в столбцах в строке, затем вызвать [обновления](../../data/oledb/crowset-update.md) для передачи этих изменений.

Этот метод требует дополнительный интерфейс `IRowsetChange`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetChange` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

Если один или несколько столбцов не доступен для записи, может произойти сбой операции задания. Измените схему курсоров, чтобы исправить это.

## <a name="undo"></a> CRowset::Undo

Отменяет все изменения, внесенные в строку с последнего получения или [обновления](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Параметры

*pcRows*<br/>
[out] Указатель на расположение где `Undo` возвращает количество строк, он попытался отменить при необходимости.

*phRow*<br/>
[out] Указатель на расположение где `Undo` возвращает массив дескрипторов ко всем строкам, была сделана попытка отменить при необходимости.

*pStatus*<br/>
[out] Указатель на расположение где `Undo` возвращает значение состояния строк. Состояние не возвращается в том случае, если *pStatus* имеет значение null.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Этот метод требует дополнительный интерфейс `IRowsetUpdate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetUpdate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="update"></a> CRowset::Update

Передает все ожидающие изменения, внесенные в текущую строку с момента последней выборки или `Update` вызвать на нем.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Параметры

*pcRows*<br/>
[out] Указатель на расположение где `Update` возвращает количество строк, он пытается обновить, если это необходимо.

*phRow*<br/>
[out] Указатель на расположение где `Update` возвращает дескриптор строки, он пытается обновить. Отсутствует дескриптор возвращается в том случае, если *phRow* имеет значение null.

*pStatus*<br/>
[out] Указатель на расположение где `Update` возвращает значение состояния строк. Состояние не возвращается в том случае, если *pStatus* имеет значение null.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

### <a name="remarks"></a>Примечания

Передает все ожидающие изменения, внесенные в текущую строку с момента последней выборки или обновления этой строки (с помощью `Update` или [UpdateAll](../../data/oledb/crowset-updateall.md)). Обычно вызывается [SetData](../../data/oledb/crowset-setdata.md) для значения данных в столбцах в строке, а затем вызовите `Update` для передачи этих изменений.

Этот метод требует дополнительный интерфейс `IRowsetUpdate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetUpdate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

## <a name="updateall"></a> CRowset::UpdateAll

Передает все ожидающие изменения, внесенные во все строки с момента последней выборки или `Update` вызвать на нем.

### <a name="syntax"></a>Синтаксис

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Параметры

*pcRows*<br/>
[out] Указатель на расположение где `UpdateAll` возвращает количество строк, он пытается обновить, если это необходимо.

*pphRow*<br/>
[out] Указатель на буфер, в который `UpdateAll` возвращает дескриптор строки, он пытается обновить. Отсутствует дескриптор возвращается в том случае, если *pphRow* имеет значение null.

*ppStatus*<br/>
[out] Указатель на расположение где `Update` возвращает значение состояния строк. Состояние не возвращается в том случае, если *ppStatus* имеет значение null.

### <a name="remarks"></a>Примечания

Передает все ожидающие изменения, внесенные во все строки, так как эти строки были последней выборки или обновить с помощью [обновление](../../data/oledb/crowset-update.md) или `UpdateAll`. `UpdateAll` будет обновлена каждая строка, которые были изменены, независимо от того, вы по-прежнему есть ли дескриптор на их (см. в разделе *pphRow*) или нет.

Например, если вы использовали `Insert` вставляется пять строк в наборе строк, вы могли бы вызвать метод `Update` пять раз или вызов `UpdateAll` один раз, чтобы обновить их все.

Этот метод требует дополнительный интерфейс `IRowsetUpdate`, которой может не поддерживаться на всех поставщиков; Если это условие выполняется, метод возвращает E_NOINTERFACE. Необходимо также задать `DBPROP_IRowsetUpdate` значение VARIANT_TRUE, перед вызовом метода `Open` для таблицы или команду, содержащую набор строк.

### <a name="return-value"></a>Возвращаемое значение

Стандартный HRESULT.

## <a name="see-also"></a>См. также

[Образец DBViewer](../../overview/visual-cpp-samples.md)<br/>
[Образец MultiRead](../../overview/visual-cpp-samples.md)<br/>
[Атрибутов multiRead](../../overview/visual-cpp-samples.md)<br/>
[Шаблоны потребителей OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Ссылка на шаблоны объекта-получателя OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)