---
description: 'Дополнительные сведения: OLE DB пул ресурсов и службы'
title: Создание пулов ресурсов и служб OLE DB
ms.date: 10/29/2018
helpviewer_keywords:
- resource pooling [OLE DB], provider requirements
- OLE DB, resource pooling
- service providers [OLE DB]
- OLE DB services [OLE DB], provider requirements
- OLE DB services [OLE DB]
- OLE DB providers, resource pooling
ms.assetid: 360c36e2-25ae-4caf-8ee7-d4a6b6898f68
ms.openlocfilehash: 1a66a6a616ed67e70fb10fa1bf43dac634051325
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97286791"
---
# <a name="ole-db-resource-pooling-and-services"></a>Создание пулов ресурсов и служб OLE DB

Для работы с пулами OLE DB или с любой службой OLE DB поставщик должен поддерживать агрегирование всех объектов. Это требование для любого поставщика OLE DB 1,5 или более поздней версии. Это крайне важно для использования служб. Поставщики, которые не поддерживают агрегирование, не могут быть помещены в пул, а дополнительные службы не предоставляются.

Для объединения поставщиков должны поддерживать модель свободных потоков. Пул ресурсов определяет модель потоков поставщика в соответствии со свойством DBPROP_THREADMODEL.

Если поставщик имеет глобальное состояние соединения, которое может измениться, когда источник данных находится в инициализированном состоянии, он должен поддерживать новое свойство DBPROP_RESETDATASOURCE. Это свойство вызывается до повторного использования соединения и дает поставщику возможность очистить состояние до его следующего использования. Если поставщик не может очистить некоторое состояние, связанное с подключением, оно может вернуть DBPROPSTATUS_NOTSETTABLE для свойства, и соединение не будет использоваться повторно.

Поставщики, подключающиеся к удаленной базе данных и способные обнаружить, может ли это соединение быть утрачено, должны поддерживать свойство DBPROP_CONNECTIONSTATUS. Это свойство дает OLE DB службам возможность обнаруживать неработающие соединения и убедиться, что они не возвращаются в пул.

Наконец, автоматическое прикрепление транзакций обычно не работает, если оно не реализовано на том же уровне, что и группирование. Поставщики, поддерживающие автоматическое прикрепление транзакций, должны поддерживать отключение этого прикрепления, предоставляя свойство DBPROP_INIT_OLEDBSERVICES и отключая прикрепление, если DBPROPVAL_OS_TXNENLISTMENT отменяется выборкой.

## <a name="see-also"></a>См. также раздел

[Дополнительные методы поставщика](../../data/oledb/advanced-provider-techniques.md)
