---
title: Создание пулов ресурсов и служб OLE DB
ms.date: 10/29/2018
helpviewer_keywords:
- resource pooling [OLE DB], provider requirements
- OLE DB, resource pooling
- service providers [OLE DB]
- OLE DB services [OLE DB], provider requirements
- OLE DB services [OLE DB]
- OLE DB providers, resource pooling
ms.assetid: 360c36e2-25ae-4caf-8ee7-d4a6b6898f68
ms.openlocfilehash: 1fb5164b9e744175f60c920a1d92278e9d5213f2
ms.sourcegitcommit: 943c792fdabf01c98c31465f23949a829eab9aad
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/07/2018
ms.locfileid: "51264662"
---
# <a name="ole-db-resource-pooling-and-services"></a>Создание пулов ресурсов и служб OLE DB

Для работы с пулами OLE DB или с любой службой OLE DB, поставщик должен поддерживать агрегирование всех объектов. Это обязательное требование OLE DB 1.5 или более поздней версии поставщика. Крайне важно для удобного служб. Поставщики, которые не поддерживают агрегирование не может быть помещен в пул и без дополнительных служб.

В пул, поставщики должны поддерживать модели свободных потоков. Пул ресурсов определяет модель в соответствии со свойством DBPROP_THREADMODEL.

Если поставщик глобальное состояние может измениться, когда источник данных находится в инициализированном состоянии, он должен поддерживать свойство DBPROP_RESETDATASOURCE. Это свойство вызывается прежде, чем соединение используется повторно и предоставляет возможность очистки состояния перед его повторным использованием поставщика. Если поставщик не может очистить связанный с подключением, можно возвратить DBPROPSTATUS_NOTSETTABLE свойство и соединение не будет использовать повторно.

Поставщики, которые подключаются к удаленной базе данных и может обнаруживать ли это подключение может быть потеряна, должен поддерживать свойство DBPROP_CONNECTIONSTATUS. Это свойство позволяет службы OLE DB для обнаружения мертвых соединений и убедитесь, что они не возвращаются в пул.

Наконец автоматическое прикрепление транзакций обычно не работать, если он реализован на том же уровне, пулов. Поставщики, которые поддерживают автоматическое прикрепление транзакций, должны поддерживать отключение этим зачислением, предоставляя свойство DBPROP_INIT_OLEDBSERVICES, установить и отключение прикрепления, если выбран DBPROPVAL_OS_TXNENLISTMENT.

## <a name="see-also"></a>См. также

[Дополнительные способы использования поставщика](../../data/oledb/advanced-provider-techniques.md)