---
title: Объектная модель OLE DB
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: 303ad4166f0f1126182956fae9c19f513be7cfb3
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2019
ms.locfileid: "62283856"
---
# <a name="ole-db-object-model"></a>Объектная модель OLE DB

Объектная модель OLE DB состоит из следующих объектов или компонентов. Первые четыре объекта и компонентов, перечисленных (источники данных, сеансы, команды и наборы строк) позволяют подключиться к источнику данных и просмотреть его. Остальные, начиная с помощью методов доступа, относящиеся к работе с данными, когда она появится.

## <a name="data-sources"></a>Data Sources

Объекты источников данных позволяют подключаться к источнику данных, например файла или СУБД. Объект источника данных создает и управляет соединением и содержит сведения о разрешения и проверок подлинности (например, имя входа и пароль). Объект источника данных можно создать один или несколько сеансов.

## <a name="sessions"></a>Сеансы

Сеанс управляет определенным взаимодействием с источником данных для запроса и получения данных. Каждый сеанс не одной транзакции. Транзакция является неделимой единицей работы определенных с помощью теста ACID. Определение ACID, см. в разделе [транзакции](#vcconoledbcomponents_transactions).

Сеансы выполнять важные задачи, такие как открытие наборов строк и возвращая объект источника данных, который его создал. Сеансы также могут возвращать метаданные или сведения об источнике данных (например, сведения о таблице).

Сеанс можно создать одну или несколько команд.

## <a name="commands"></a>Команды

Команды выполняют текстовые команды, например инструкцию SQL. Если в текстовой команде указан набор строк, таких как SQL **ВЫБЕРИТЕ** инструкции, команда создает набор строк.

Команда — это просто контейнер для текста команды, которая представляет собой строку (например, инструкция SQL), передаваемого от потребителя к объекту источника данных для выполнения базового хранилища данных поставщика. Как правило, текст команды — это SQL **ВЫБЕРИТЕ** инструкции (в этом случае в том случае, поскольку SQL **ВЫБЕРИТЕ** указан набор строк, команда автоматически создает набор строк).

## <a name="rowsets"></a>Наборы строк

Наборы строк отображение данных в табличном формате. Индекс является особым случаем набора строк. Можно создать наборы строк из сеанса или команды.

### <a name="schema-rowsets"></a>Наборы строк схемы

Схемы имеют метаданные базы данных (структуры данных). Наборы строк схемы — наборы строк, которые имеют сведения о схеме. Некоторые поставщики OLE DB для СУБД поддерживают объекты наборов строк схемы. Дополнительные сведения о наборах строк схемы см. в разделе [получение метаданных в схеме набора строк](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) и [классы схемы Rowset и Typedef](../../data/oledb/schema-rowset-classes-and-typedef-classes.md).

### <a name="view-objects"></a>Просмотр объектов

Объект представления определяет подмножество строк и столбцов из набора строк. Он не содержит данных свои собственные. Просмотр объектов нельзя объединять данные из нескольких наборов строк.

## <a name="accessors"></a>Методы доступа

Только OLE DB использует концепцию методы доступа. Метод доступа описывает, каким образом данные хранятся в объект-получатель. Он имеет набор привязок (называемый сопоставлением столбцов) между полями набора строк (столбцов) и элементы данных, что можно объявить в объекте-получателе.

##  <a name="vcconoledbcomponents_transactions"></a> Транзакции

Объекты транзакции используются при фиксации или отмене вложенных транзакций на отличный от самого нижнего уровня. Транзакция является неделимой единицей работы определенных с помощью теста ACID. Сокращение ACID обозначает:

- Атомарность, невозможно разделить на более мелкие единицы работы

- Параллелизм, есть несколько транзакций могут выполняться одновременно

- Изоляция, каждая транзакция имеет ограниченное знаний об изменениях, внесенных другим разработчиком

- Устойчивость, транзакция выполняет окончательные изменения

## <a name="enumerators"></a>Перечислители.

Перечислители искать доступные источники данных и другими перечислителями. Пользователи, которые не настроены для конкретного источника данных используют перечислители для поиска для источника данных для использования.

Корневой перечислитель, встроенными в Microsoft Data Access SDK, проходит через реестр, поиск источников данных и другими перечислителями. Другие перечислители проходят через реестр или поиска в определенном поставщиком.

## <a name="errors"></a>Ошибки

Любого интерфейса на любой объект OLE DB может стать причиной ошибок. Ошибки имеют дополнительные сведения об ошибке, включая необязательно ошибка пользовательского объекта. Эти сведения хранятся в значение HRESULT.

## <a name="notifications"></a>Уведомления

Уведомления используются группы совместно действующих потребителей, совместное использование набора строк (где совместное использование означает, что потребители действуют в рамках одной транзакции). Уведомления позволяют потребителей, совместно использующих набор строк быть в курсе действий, выполняемых своих коллег.

## <a name="see-also"></a>См. также

[Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)<br/>
[Общие сведения о программировании OLE DB](../../data/oledb/ole-db-programming-overview.md)