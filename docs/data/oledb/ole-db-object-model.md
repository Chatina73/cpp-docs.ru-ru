---
title: Объектная модель OLE DB
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: 192195d02b034546e50b1cb860b1f11c47dc2b65
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80210123"
---
# <a name="ole-db-object-model"></a>Объектная модель OLE DB

Объектная модель OLE DB состоит из следующих объектов или компонентов. Первые четыре объекта или компонента (источники данных, сеансы, команды и наборы строк) позволяют подключаться к источнику данных и просматривать его. Остальные компоненты, начиная с методов доступа, связаны с работой с данными при их отображении.

## <a name="data-sources"></a>обозревателе решений

Объекты источников данных позволяют подключаться к источнику данных, например файлу или СУБД. Объект источника данных создает соединение и управляет им, а также содержит разрешения и сведения о проверке подлинности (например, имя входа и пароль). Объект источника данных может создавать один или несколько сеансов.

## <a name="sessions"></a>Сеансы

Сеанс управляет определенным взаимодействием с источником данных для запроса и получения данных. Каждый сеанс является одной транзакцией. Транзакция — это неделимая единица работы, определяемая тестом ACID. Определение ACID см. в разделе [Transactions](#vcconoledbcomponents_transactions).

Сеансы выполняют важные задачи, такие как открытие наборов строк и возврат объекта источника данных, который его создал. Сеансы также могут возвращать метаданные или сведения о самом источнике данных (например, сведения о таблице).

Сеанс может создать одну или несколько команд.

## <a name="commands"></a>Команды

Команды выполняют текстовую команду, например инструкцию SQL. Если команда Text задает набор строк, например инструкцию SQL **SELECT** , команда создает набор строк.

Команда — это просто контейнер для текстовой команды, которая является строкой (например, инструкцией SQL), передаваемой из потребителя в объект источника данных для выполнения базовым хранилищем данных поставщика. Как правило, команда text является инструкцией SQL **SELECT** (в этом случае, поскольку SQL **SELECT** указывает набор строк, команда автоматически создает набор строк).

## <a name="rowsets"></a>Наборы строк

Наборы строк отображают данные в табличном формате. Индекс является особым случаем набора строк. Вы можете создавать наборы строк из сеанса или команды.

### <a name="schema-rowsets"></a>Наборы строк схемы

Схемы имеют метаданные (структурные сведения) о базе данных. Наборы строк схемы — это наборы строк, имеющие сведения о схеме. Некоторые поставщики OLE DB для СУБД поддерживают объекты наборов строк схемы. Дополнительные сведения о наборах строк схемы см. в разделе [Получение метаданных с помощью наборов строк схемы](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) и классов [наборов строк схемы и классов typedef](../../data/oledb/schema-rowset-classes-and-typedef-classes.md).

### <a name="view-objects"></a>Просмотр объектов

Объект представления определяет подмножество строк и столбцов из набора строк. Он не имеет собственных данных. Объекты представления не могут объединять данные из нескольких наборов строк.

## <a name="accessors"></a>Методы доступа

Концепция методов доступа используется только OLE DB. Метод доступа описывает, как данные хранятся в потребителе. Он содержит набор привязок (называемых картой столбцов) между полями набора строк (столбцами) и элементами данных, объявляемыми в потребителе.

##  <a name="transactions"></a><a name="vcconoledbcomponents_transactions"></a> Transactions

Объекты транзакций используются при фиксации или прерывании вложенных транзакций, отличных от самого нижнего уровня. Транзакция — это неделимая единица работы, определяемая тестом ACID. ACID означает:

- Атомарность, невозможно разделить на меньшие рабочие единицы

- Параллелизм, одновременно может выполняться более одной транзакции

- Изоляция, одна транзакция имеет ограниченный набор знаний об изменениях, внесенных другим

- Устойчивость транзакция вносит постоянные изменения

## <a name="enumerators"></a>Enumerators

Перечислители выполняют поиск доступных источников данных и других перечислителей. Потребители, которые не настроены для определенного источника данных, используют перечислители для поиска используемого источника данных.

Корневой перечислитель, поставляемый в составе пакета SDK для доступа к данным Microsoft, проходит по реестру для поиска источников данных и других перечислителей. Другие перечислители проходят по реестру или выполняют поиск в соответствии с конкретным поставщиком.

## <a name="errors"></a>ошибки

Любой интерфейс любого объекта OLE DB может формировать ошибки. Ошибки содержат дополнительные сведения об ошибке, включая необязательный объект настраиваемой ошибки. Эти сведения хранятся в значении HRESULT.

## <a name="notifications"></a>Уведомления

Уведомления используются группами взаимодействующих потребителей, совместно использующих набор строк (где совместное использование означает, что потребители считаются работающими в рамках одной транзакции). Уведомления позволяют пользователям совместно использовать набор строк для информирования о действиях в наборе строк, выполняемых их одноранговыми узлами.

## <a name="see-also"></a>См. также раздел

[Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)<br/>
[Общие сведения о программировании OLE DB](../../data/oledb/ole-db-programming-overview.md)
