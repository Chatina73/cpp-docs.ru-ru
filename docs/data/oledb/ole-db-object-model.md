---
title: Объектная модель OLE DB
ms.date: 10/22/2018
helpviewer_keywords:
- rowsets, OLE DB object model
- OLE DB, object model
ms.assetid: 1a274a25-c310-4430-a1ec-bd2bd8120eff
ms.openlocfilehash: b37205eb91317c602010a4b568057845b2345ef0
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81369798"
---
# <a name="ole-db-object-model"></a>Объектная модель OLE DB

Модель объекта OLE DB состоит из следующих объектов или компонентов. Первые четыре перечисленных объекта или компонента (источники данных, сеансы, команды и наборы строк) позволяют подключиться к источнику данных и просмотреть его. Остальные, начиная с аксессуаров, относятся к работе с данными при отображении.

## <a name="data-sources"></a>обозревателе решений

Объекты источника данных позволяют подключиться к источнику данных, таким как файл или DBMS. Объект источника данных создает и управляет соединением и содержит информацию о разрешениях и аутентификациях (например, имя входа и пароль). Объект источника данных может создавать один или несколько сеансов.

## <a name="sessions"></a>Сеансы

Сеанс управляет определенным взаимодействием с источником данных для запроса и извлечения данных. Каждый сеанс представляет собой одну транзакцию. Транзакция — это неделимое рабочее устройство, определяемое тестом ACID. Для определения ACID [см.](#vcconoledbcomponents_transactions)

Сеансы выполняют важные задачи, такие как открытие рядов и возвращение созданного объекта источника данных. Сеансы также могут возвращать метаданные или информацию о самом источнике данных (например, информацию о таблице).

Сеанс может создать одну или несколько команд.

## <a name="commands"></a>Команды

Команды выполняют текстовые команды, такие как заявление S'L. Если команда текста определяет строку, например, запонку S'L **SELECT,** команда создает строку.

Команда — это просто контейнер для текстовой команды, которая представляет собой строку (например, оператор S'L), передаваемую от потребителя к объекту источника данных для выполнения базовым хранилищем данных поставщика. Как правило, команда текста является заявлением S'L **SELECT** (в этом случае, поскольку S'L **SELECT** определяет набор строк, команда автоматически создает набор строк).

## <a name="rowsets"></a>Наборы строк

Роусеты отображаются в табликском формате. Индекс — это особый случай с рядом. Можно создавать строки из сеанса или команды.

### <a name="schema-rowsets"></a>Наборы строк схемы

Схемы имеют метаданные (структурную информацию) о базе данных. Схемы строки строки, которые имеют информацию о схеме. Некоторые поставщики OLE DB для объектов DBMS поддерживают объекты схемы строки. Для получения дополнительной информации о схемах строк, [см. Получение Метаданные с Схема Rowsets](../../data/oledb/obtaining-metadata-with-schema-rowsets.md) и [Схема Rowset классов и типов Typedef](../../data/oledb/schema-rowset-classes-and-typedef-classes.md).

### <a name="view-objects"></a>Просмотр объектов

Объект представления определяет подмножество строк и столбцов из строк. У него нет собственных данных. Объекты просмотра не могут комбинировать данные из нескольких рядов.

## <a name="accessors"></a>Методы доступа

Только OLE DB использует концепцию аксессуаров. Аксессуар описывает, как данные хранятся в потребителе. Он имеет набор привязок (так называемую карту столбца) между полями строк (столбцов) и членами данных, которые вы объявляете в потребителе.

## <a name="transactions"></a><a name="vcconoledbcomponents_transactions"></a>Операций

Объекты транзакций используются при совершении или прерывании вложенных транзакций на другом, чем на нижнем уровне. Транзакция — это неделимое рабочее устройство, определяемое тестом ACID. ACID означает:

- Атомность, не может быть разделена на меньшие рабочие единицы

- В результате несколько транзакций могут происходить одновременно

- Изоляция, одна транзакция имеет ограниченные знания об изменениях, внесенных другой

- Долговечность, транзакция вносит постоянные изменения

## <a name="enumerators"></a>Enumerators

Регистраторы ищут доступные источники данных и другие регистраторы. Потребители, не настроенные для конкретного источника данных, используют регистраторы для поиска источника данных для использования.

Корневый регистратор, отправляемый в SDK доступа к данным Майкрософт, пересекает реестр в поисках источников данных и других регистраторов. Другие регистраторы пересекают реестр или ищут определенным образом.

## <a name="errors"></a>ошибки

Любой интерфейс на любом объекте OLE DB может генерировать ошибки. Ошибки имеют дополнительную информацию об ошибке, включая дополнительный объект пользовательского элемента ошибки. Эта информация хранится в HRESULT.

## <a name="notifications"></a>Уведомления

Уведомления используются группами сотрудничающих потребителей, разделяющих набор строк (где совместное использование означает, что предполагается, что потребители работают в рамках одной и той же транзакции). Уведомления позволяют сотрудничать с потребителями, разделяющие строку, чтобы быть информированными о действиях на строке, выполняемой их коллегами.

## <a name="see-also"></a>См. также раздел

[Программирование OLE DB](../../data/oledb/ole-db-programming.md)<br/>
[Обзор программирования OLE DB](../../data/oledb/ole-db-programming-overview.md)
