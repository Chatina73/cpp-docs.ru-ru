---
description: 'Дополнительные сведения: Шаблоны поставщиков OLE DB (C++)'
title: Шаблоны поставщика OLE DB (С++)
ms.date: 10/24/2018
helpviewer_keywords:
- OLE DB providers [C++], about providers
- databases [C++], OLE DB templates
- OLE DB provider templates [C++], about OLE DB provider templates
- templates [C++], OLE DB
ms.assetid: fccff85f-2af8-4500-82bd-6312d28a74b8
ms.openlocfilehash: 8706fcd9467e6d184633917d7c83ac81ad137b9d
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97286921"
---
# <a name="ole-db-provider-templates-c"></a>Шаблоны поставщика OLE DB (С++)

OLE DB является важной частью стратегии универсального доступа к данным (Майкрософт). OLE DBная структура обеспечивает высокую производительность доступа к данным из любого источника данных. Любые табличные данные доступны для просмотра с помощью OLE DB независимо от того, поступил ли он из базы данных. Гибкость дает вам огромный объем энергии.

Как описано в [OLE DB потребителей и поставщиков](../../data/oledb/ole-db-consumers-and-providers.md), OLE DB использует концепцию потребителей и поставщиков. Потребитель выполняет запросы к данным; поставщик возвращает потребителю данные в табличном формате. С точки зрения программирования, самое важное следствие этой модели является то, что поставщик должен реализовать любой вызов, который может сделать потребитель.

## <a name="what-is-a-provider"></a>Что такое поставщик?

Поставщик OLE DB — это набор COM-объектов, которые обслуживают вызовы интерфейса из объекта потребителя, передавая данные в табличном формате из надежного источника (называемого хранилищем данных) потребителю.

Поставщики могут быть простыми или сложными. Поставщик может поддерживать минимальный объем функциональности или полноценный высококачественный поставщик, реализуя дополнительные интерфейсы. Поставщик может возвращать таблицу, разрешать клиенту определять формат этой таблицы и выполнять операции с этими данными.

Каждый поставщик реализует стандартный набор COM-объектов для обработки запросов от клиента со стандартным значением, которое любой OLE DB потребитель может получать доступ к данным от любого поставщика, независимо от языка (например, C++ и Basic).

Каждый COM-объект содержит несколько интерфейсов, некоторые из которых являются обязательными, и некоторые из них необязательны. Реализуя обязательные интерфейсы, поставщик гарантирует минимальный уровень функциональности (называемый соответствием), который любой клиент должен иметь возможность использовать. Поставщик может реализовать дополнительные интерфейсы для предоставления дополнительных функциональных возможностей. [Архитектура шаблона поставщика OLE DB](../../data/oledb/ole-db-provider-template-architecture.md) подробно описывает эти интерфейсы. Клиент должен всегда вызывать, `QueryInterface` чтобы определить, поддерживает ли поставщик данный интерфейс.

## <a name="ole-db-specification-level-support"></a>Поддержка уровня спецификации OLE DB

Шаблоны поставщика OLE DB поддерживают спецификацию OLE DB версии 2,7. Используя шаблоны поставщика OLE DB, можно реализовать поставщик, соответствующий уровню 0. `Provider`Пример, например, использует шаблоны для реализации сервера команд, отличного от SQL (MS-DOS), выполняющего команду DOS dir для запроса файловой системы. `Provider`Пример возвращает сведения о каталоге в наборе строк, который является стандартным OLE DB механизмом возврата табличных данных.

Самый простой тип поставщика, поддерживаемый шаблонами OLE DB, — это поставщик, предназначенный только для чтения и не имеющий команд. Поставщики с командами также поддерживаются, как и функции создания закладок и чтения и записи. Для реализации поставщика чтения и записи можно написать дополнительный код. Динамические наборы строк и транзакции не поддерживаются текущей версией, но при необходимости их можно добавить.

## <a name="when-do-you-need-to-create-an-ole-db-provider"></a>Когда необходимо создать поставщик OLE DB?

Вам не всегда нужно создавать собственный поставщик. Корпорация Майкрософт предоставляет несколько пакетов стандартных поставщиков в диалоговом окне **Свойства связи данных** в Visual C++. Основная причина создания поставщика OLE DB — воспользоваться преимуществами стратегии универсального доступа к данным. Вот некоторые из преимуществ:

- Доступ к данным через любой язык, например C++, Basic и Visual Basic Scripting Edition. Это позволяет различным программистам в организации обращаться к одним и тем же данным, независимо от используемого языка.

- Откройте данные в других источниках данных, таких как SQL Server, Excel и Access. Это может быть полезно, если требуется передавать данные между различными форматами.

- Участие в операциях перекрестного источника данных (разнородных). Это может быть эффективным способом хранения данных. С помощью поставщиков OLE DB можно хранить данные в собственном формате и по-прежнему иметь возможность доступа к ним в простой операции.

- Добавление в данные дополнительных компонентов, таких как обработка запросов.

- Повышение производительности доступа к данным за счет контроля над их работой.

- Повышение надежности. Если у вас есть собственный формат данных, доступ к которому может получить только один программист, то у вас есть риск. Используя поставщики OLE DB, вы можете открыть собственный формат для всех программистов.

## <a name="read-only-and-updatable-providers"></a>Read-Only и обновляемые поставщики

Поставщики могут сильно различаться по сложности и функциональности. Рекомендуется классифицировать поставщиков на поставщиков только для чтения и обновляемых поставщиков:

- В Visual C++ 6,0 поддерживаются только поставщики только для чтения. [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md) обсуждает создание поставщика, доступного только для чтения.
- Visual C++ поддерживает обновляемые поставщики, которые могут обновлять (записывать в) хранилище данных. Сведения об обновляемых поставщиках см. [в разделе Создание обновляемого поставщика](../../data/oledb/creating-an-updatable-provider.md). образец [UpdatePV](https://github.com/Microsoft/VCSamples/tree/master/VC2010Samples/ATL/OLEDB/Provider/UPDATEPV) является примером обновляемого поставщика.

Дополнительные сведения см. в разделе:

- [Архитектура шаблона поставщика OLE DB](../../data/oledb/ole-db-provider-template-architecture.md)

- [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md)

- [OLE DB программирование](../../data/oledb/ole-db-programming.md)

## <a name="see-also"></a>См. также раздел

[Доступ к данным](../data-access-in-cpp.md)<br/>
[Документация по OLE DB SDK](/previous-versions/windows/desktop/ms722784(v=vs.85))<br/>
[справочник программиста OLE DB](/sql/connect/oledb/ole-db/oledb-driver-for-sql-server-programming)<br/>
