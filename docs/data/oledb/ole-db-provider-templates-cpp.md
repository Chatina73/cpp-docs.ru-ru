---
title: Шаблоны поставщика OLE DB (C++) | Документация Майкрософт
ms.custom: ''
ms.date: 10/24/2018
ms.technology:
- cpp-data
ms.topic: reference
dev_langs:
- C++
helpviewer_keywords:
- OLE DB providers [C++], about providers
- databases [C++], OLE DB templates
- OLE DB provider templates [C++], about OLE DB provider templates
- templates [C++], OLE DB
ms.assetid: fccff85f-2af8-4500-82bd-6312d28a74b8
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: 4d4d93f656279cf5e5c548ef09bf809364c9d90e
ms.sourcegitcommit: 840033ddcfab51543072604ccd5656fc6d4a5d3a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2018
ms.locfileid: "50216413"
---
# <a name="ole-db-provider-templates-c"></a>Шаблоны поставщика OLE DB (С++)

OLE DB является важной частью стратегии Microsoft универсального доступа к данным. Структура OLE DB позволяет доступ к данным высокой производительности из любого источника данных. Табличные данные можно просмотреть через OLE DB независимо от того, является ли он поступил из базы данных. Эта гибкость дает большую производительность.

Как описано в [потребителей OLE DB и поставщики](../../data/oledb/ole-db-consumers-and-providers.md), используется концепция получатели и поставщики OLE DB. Потребитель выполняет запросы к данным; поставщик возвращает данные в табличном формате объекту-получателю. С точки зрения программирования наиболее важные этой модели подразумевается, что поставщик должен реализовать любой вызов объекта-получателя.

## <a name="what-is-a-provider"></a>Что такое поставщик?

Поставщик OLE DB — это набор COM-объектов, которые обслуживают вызовы интерфейса из пользовательского объекта, передачи данных в табличном формате из долговременного источника (называемой хранилищем данных) объекту-получателю.

Поставщики могут быть простыми или сложными. Поставщик может поддерживать минимальное функциональные возможности или поставщика услуг качества полноценного рабочего путем реализации большее число интерфейсов. Поставщик можно вернуть таблицу, позволяют клиенту определить формат этой таблицы и выполнять операции с этими данными.

Каждый поставщик реализует стандартный набор COM-объектов для обработки запросов от клиента, с помощью стандартные значения, что любой потребитель OLE DB можно получить доступ к данных из любого поставщика, независимо от языка (например, C++, Basic).

Каждый объект COM содержит несколько интерфейсов, некоторые из которых являются обязательными, и некоторые из которых являются необязательными. Реализовав обязательные интерфейсы, поставщик гарантирует минимальный уровень функциональности (который называется совместимостью), любой клиент должен иметь возможность использовать. Поставщик можно реализовать дополнительные интерфейсы для обеспечения дополнительной функциональности. [OLE DB архитектура шаблона поставщика](../../data/oledb/ole-db-provider-template-architecture.md) эти детально описаны интерфейсы. Клиент должен всегда вызывать `QueryInterface` для определения того, если поставщик поддерживает данный интерфейс.

## <a name="ole-db-specification-level-support"></a>Уровень поддержки спецификации OLE DB

Шаблоны поставщика OLE DB поддерживают спецификацию OLE DB версии 2.7. С помощью шаблонов поставщика OLE DB, можно реализовать поставщик, совместимый с уровня 0. `Provider` Пример, например, использует шаблоны для реализации управляющего сервера, который выполняет команду DOS DIR, чтобы обращаться к файловой системе. `Provider` Пример возвращает сведения о каталоге в наборе строк, что является стандартным механизмом OLE DB для возвращения табличных данных.

Простейший тип поставщика, поддерживаемого шаблонов OLE DB является поставщиком только для чтения без команд. Поставщики с командами также поддерживаются, как функции закладок и чтение и запись. Можно реализовать поставщик чтения и записи, написание дополнительного кода. Динамические наборы строк и транзакции не поддерживаются в текущей версии, но если вы хотите, чтобы их можно добавить.

## <a name="when-do-you-need-to-create-an-ole-db-provider"></a>Если необходимо создать поставщика OLE DB?

Не всегда требуется для создания собственного поставщика; Корпорация Майкрософт предоставляет несколько стандартных поставщиков в **свойства канала передачи данных** диалогового окна в Visual C++. Чтобы воспользоваться преимуществами стратегии использования универсального доступа к данным является основной причиной для создания поставщика OLE DB. Некоторые преимущества перечислены ниже:

- Доступ к данным посредством любого языка, таких как C++, Basic и Visual Basic Scripting Edition. Это позволяет разным программистам в вашей организации для доступа к тем же данным так же, независимо от того, какой язык они используют.

- Откройте данные в другие источники данных, таких как SQL Server, Excel и Access. Это может быть полезно в том случае, если вы хотите передавать данные между разными форматами.

- Участвует в операции с источником данных между (разнородных). Это может быть эффективным способом хранения данных. С помощью поставщиков OLE DB, можно хранить данные в собственном формате и по-прежнему иметь возможность доступа к нему с помощью одной операции.

- Добавление дополнительных функций к своим данным, таких как обработка запросов.

- Увеличение производительности доступа к данным, контролируя, как ими управлять.

- Повышение надежности. Если у вас есть собственный формат данных можно получить доступ к этой только один программист, существует риск. Используя поставщики OLE DB, можно открыть этот собственный формат для всех программистов.

## <a name="read-only-and-updatable-providers"></a>Поставщики только для чтения и обновляемый

Поставщики могут серьезно различаться по сложности и функциональности. Это полезно для классификации поставщиками поставщики только для чтения и поставщики с возможностью обновления:

- Visual C++ 6.0 поддерживается только поставщики только для чтения. [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md) рассматривается процесс создания поставщика только для чтения.
- Visual C++ поддерживает обновляемых поставщиков, которые можно обновить (запись) в хранилище данных. Сведения об обновляемых поставщиках см. в разделе [Создание поставщика с возможностью записи](../../data/oledb/creating-an-updatable-provider.md); [UpdatePV](https://github.com/Microsoft/VCSamples/tree/master/VC2010Samples/ATL/OLEDB/Provider/UPDATEPV) пример является примером поставщика с возможностью записи.

Дополнительные сведения:

- [Архитектура шаблона поставщика OLE DB](../../data/oledb/ole-db-provider-template-architecture.md)

- [Создание поставщика OLE DB](../../data/oledb/creating-an-ole-db-provider.md)

- [Программирование объектов OLE DB](../../data/oledb/ole-db-programming.md)

## <a name="see-also"></a>См. также

[Доступ к данным](../data-access-in-cpp.md)<br/>
[Документация по OLE DB SDK](/previous-versions/windows/desktop/ms722784)<br/>
[справочник программиста OLE DB](/previous-versions/windows/desktop/ms713643)<br/>
