---
description: 'Дополнительные сведения: использование нескольких результирующих наборов из одной хранимой процедуры'
title: Использование нескольких результирующих наборов одной хранимой процедуры
ms.date: 10/24/2018
helpviewer_keywords:
- stored procedures, returning result sets
- multiple result sets
ms.assetid: c450c12c-a76c-4ae4-9675-071a41eeac05
ms.openlocfilehash: 8e6b7a51635caf9ddfd86dddcad0e2a3f94bb7dd
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97319122"
---
# <a name="using-multiple-result-sets-from-one-stored-procedure"></a>Использование нескольких результирующих наборов одной хранимой процедуры

Большинство хранимых процедур возвращают несколько результирующих наборов. Такая хранимая процедура обычно включает одну или несколько инструкций SELECT. Потребитель должен учитывать это включение для поддержки всех результирующих наборов.

## <a name="to-handle-multiple-result-sets"></a>Работа с несколькими результирующими наборами

1. Создайте `CCommand` класс с `CMultipleResults` аргументом шаблона и методом доступа, который обычно является динамическим или ручным методом доступа. При использовании другого типа метода доступа, возможно, не удастся определить выходные столбцы для каждого набора строк.

1. Выполните хранимую процедуру как обычно и привяжите столбцы (см. раздел [как извлечь данные](../../data/oledb/fetching-data.md)).

1. Используйте данные.

1. Вызовите метод `GetNextResult` в `CCommand` классе. Если доступен другой результирующий набор строк, `GetNextResult` возвращает S_OK и следует повторно привязывать столбцы при использовании метода доступа вручную. Если функция `GetNextResult` возвращает ошибку, другие результирующие наборы недоступны.

## <a name="see-also"></a>См. также раздел

[Использование хранимых процедур](../../data/oledb/using-stored-procedures.md)
