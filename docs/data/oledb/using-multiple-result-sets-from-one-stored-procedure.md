---
title: Использование нескольких результирующих наборов одной хранимой процедуры
ms.date: 10/24/2018
helpviewer_keywords:
- stored procedures, returning result sets
- multiple result sets
ms.assetid: c450c12c-a76c-4ae4-9675-071a41eeac05
ms.openlocfilehash: fe41bfe1d9fb0207f55d2cd653a56a1ff00ce2d1
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2018
ms.locfileid: "50570684"
---
# <a name="using-multiple-result-sets-from-one-stored-procedure"></a>Использование нескольких результирующих наборов одной хранимой процедуры

Большинство хранимых процедур возвращают несколько результирующих наборов. Хранимая процедура обычно включает в себя один или несколько инструкций select. Потребитель должен учитывать это включение для обработки всех результирующих наборов.

## <a name="to-handle-multiple-result-sets"></a>Обработка нескольких результирующих наборов

1. Создание `CCommand` класса `CMultipleResults` как аргумент шаблона и методом доступа по своему усмотрению, обычно метод доступа динамический или вручную. Если вы используете другой тип метода доступа, может не появиться возможность определить выходные столбцы для каждого набора строк.

1. Выполните хранимую процедуру как обычно и привяжите столбцы (см. в разделе [инструкции выборки данных?](../../data/oledb/fetching-data.md)).

1. Используйте данные.

1. Вызовите `GetNextResult` на `CCommand` класса. Если доступен другой результирующий набор строк, `GetNextResult` возвращает S_OK, и вы связывание столбцов при использовании метода доступа вручную. Если `GetNextResult` возвращает ошибку, существуют результирующих наборов больше нет доступных.

## <a name="see-also"></a>См. также

[Использование хранимых процедур](../../data/oledb/using-stored-procedures.md)