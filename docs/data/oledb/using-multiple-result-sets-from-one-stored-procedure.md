---
title: Использование нескольких результирующих наборов одной хранимой процедуры
ms.date: 10/24/2018
helpviewer_keywords:
- stored procedures, returning result sets
- multiple result sets
ms.assetid: c450c12c-a76c-4ae4-9675-071a41eeac05
ms.openlocfilehash: 6163eb8bf18edfc3d205f1d012de0c64c5570693
ms.sourcegitcommit: 857fa6b530224fa6c18675138043aba9aa0619fb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2020
ms.locfileid: "80209291"
---
# <a name="using-multiple-result-sets-from-one-stored-procedure"></a>Использование нескольких результирующих наборов одной хранимой процедуры

Большинство хранимых процедур возвращают несколько результирующих наборов. Такая хранимая процедура обычно включает одну или несколько инструкций SELECT. Потребитель должен учитывать это включение для поддержки всех результирующих наборов.

## <a name="to-handle-multiple-result-sets"></a>Работа с несколькими результирующими наборами

1. Создайте класс `CCommand` с `CMultipleResults` в качестве аргумента шаблона и методом доступа, который обычно является динамическим или ручным методом доступа. При использовании другого типа метода доступа, возможно, не удастся определить выходные столбцы для каждого набора строк.

1. Выполните хранимую процедуру как обычно и привяжите столбцы (см. раздел [как извлечь данные](../../data/oledb/fetching-data.md)).

1. Используйте данные.

1. Вызовите `GetNextResult` класса `CCommand`. Если доступен другой результирующий набор строк, `GetNextResult` возвращает S_OK и необходимо повторно привязать столбцы при использовании метода доступа вручную. Если `GetNextResult` возвращает ошибку, результирующие наборы больше не доступны.

## <a name="see-also"></a>См. также раздел

[Использование хранимых процедур](../../data/oledb/using-stored-procedures.md)
