---
title: MFC. Использование классов базы данных без документов и представлений
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC applications [C++], without views
- documents [C++], applications without
- ODBC applications [C++]
- document/view architecture [C++], in databases
- files [C++], MFC
- database classes [C++], MFC
- CRecordView class, using in database applications
- database applications [C++], without views
- database applications [C++], application wizard options
- application wizards [C++], creating database applications
- ODBC [C++], file support in database applications
- ODBC applications [C++], without documents
- database applications [C++], without documents
- user interface [C++], drawing information
ms.assetid: 15bf52d4-91cf-4b1d-8b37-87c3ae70123a
ms.openlocfilehash: ab9946609fa20c4644873a684a754cbc8a41742f
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2019
ms.locfileid: "59024638"
---
# <a name="mfc-using-database-classes-without-documents-and-views"></a>MFC. Использование классов базы данных без документов и представлений

Иногда может не потребоваться использование архитектуры document/view платформы в приложениях базы данных. Содержание раздела:

- [Когда не нужно использовать документы](#_core_when_you_don.92.t_need_documents) случаи.

- [Параметры мастера приложений](#_core_appwizard_options_for_documents_and_views) для поддержки приложений без сериализации и связанных с документом **файл** меню команды, такие как **New**, **откройте** , **Сохранить**, и **Сохранить как**.

- [Как работать с приложением, использующим минимальный документ](#_core_applications_with_minimal_documents).

- [Способ организации приложения без документов или представлений](#_core_applications_with_no_document).

##  <a name="_core_when_you_don.92.t_need_documents"></a> Если вы не обязательно документов

Некоторые приложения имеют особое понятие документа. Эти приложения обычно загружают все или большинство из файла из хранилища в памяти с помощью **Открытие файла** команды. Они записывают обновленный файл обратно в хранилище при **сохранения файла** или **Сохранить как** команды. Пользователю является файлом данных.

Для некоторых категорий приложений, тем не менее, не требуют документа. Приложения баз данных выполняются с точки зрения транзакций. Приложение выбирает записи из базы данных и представляет их пользователю, часто поочередно. Пользователю обычно является одной текущей записи, который может быть единственным в памяти.

Если приложение не требует документа для хранения данных, можно обойтись некоторые или все архитектуры document/view платформы. Сколько вы обойтись зависит от выбранного подхода. Вы можете:

- Используйте минимальный документ как место хранения подключения к источнику данных, но избавиться от обычных функций документа например сериализации. Это полезно в том случае, если необходимо несколько представлений данных и хотите синхронизировать все представления, выполняется их обновление за один раз и т. д.

- Используйте окно фрейма, в которой будет нарисована напрямую, вместо того чтобы использовать представление. В этом случае опустить документ и сохранять любые данные и подключения к данным в объекте окна фрейма.

##  <a name="_core_appwizard_options_for_documents_and_views"></a> Параметры мастера приложений для документов и представлений

Мастер приложений MFC имеет несколько параметров **выберите Поддержка баз данных**, перечислены в следующей таблице. Если вы используете мастер приложений MFC для создания приложения, все эти параметры создания приложений с документами и представлениями. Некоторые параметры предоставляют документов и представлений, которые отсутствуют ненужные функции документов. Дополнительные сведения см. в разделе [Поддержка баз данных, мастер приложений MFC](../mfc/reference/database-support-mfc-application-wizard.md).

|Параметр|Просмотр|Document|
|------------|----------|--------------|
|**None**|Производное от `CView`.|Не поддерживает базы данных. Этот параметр используется по умолчанию.<br /><br /> При выборе **поддержка архитектуры Document/view** параметр [тип приложения, мастер приложений MFC](../mfc/reference/application-type-mfc-application-wizard.md) будет включать поддержку полного документа, включая сериализации и **New** , **Откройте**, **Сохранить**, и **Сохранить как** команды **файл** меню. См. в разделе [приложений с помощью документ не](#_core_applications_with_no_document).|
|**Только файлы заголовков**|Производное от `CView`.|Предоставляет базовый уровень поддержки базы данных для приложения.<br /><br /> Включает в себя Afxdb.h. Добавляет библиотеки, но не создает любые классы, зависящие от базы данных. Можно создать наборы записей в более поздней версии и использовать их для проверки и обновления записей.|
|**Представление базы данных без поддержки файлов**|Производный от `CRecordView`|Предоставляет поддержку документов, но не поддержку сериализации. Документ можно хранить набор записей и координировать несколько представлений; не поддерживает сериализацию или **New**, **откройте**, **Сохранить**, и **Сохранить как** команды. См. в разделе [приложения с минимальными документами](#_core_applications_with_minimal_documents). При включении представления базы данных, необходимо указать источник данных.<br /><br /> Включает в себя базы данных файлы заголовков, библиотек, представление записей и набор записей. (Доступно только для приложений с помощью **поддержка архитектуры Document/view** параметра, выбранного на [тип приложения, мастер приложений MFC](../mfc/reference/application-type-mfc-application-wizard.md) страницы.)|
|**Представление базы данных с поддержкой файлов**|Производный от `CRecordView`|Предоставляет полную поддержку документов, включая сериализацию и связанные с документами **файл** команды меню. Приложения баз данных обычно выполняются на основе записей, а не на отдельных файлов, поэтому не требуется сериализация. Тем не менее возможно специальное использование для сериализации. См. в разделе [приложения с минимальными документами](#_core_applications_with_minimal_documents). При включении представления базы данных, необходимо указать источник данных.<br /><br /> Включает в себя базы данных файлы заголовков, библиотек, представление записей и набор записей. (Доступно только для приложений с помощью **поддержка архитектуры Document/view** параметра, выбранного на [тип приложения, мастер приложений MFC](../mfc/reference/application-type-mfc-application-wizard.md) страницы.)|

Сведения об альтернативах, для сериализации и альтернативное использует для сериализации, см. в разделе [сериализации: Vs сериализации. Базы данных ввода вывода](../mfc/serialization-serialization-vs-database-input-output.md).

##  <a name="_core_applications_with_minimal_documents"></a> Приложения с минимальными документами

Мастер приложений MFC имеет два параметра, которые поддерживают приложений доступа к данным на основе форм. Каждый из них создает `CRecordView`-производный класс представления и документа. Они отличаются они покидают из документа.

###  <a name="_core_a_document_without_file_support"></a> Документ без поддержки файлов

Выберите параметр базы данных **представление без поддержки файлов базы данных** при сериализации документа не требуется. Документ служит следующих целей:

- Это удобное место для хранения `CRecordset` объекта.

   Такое использование понятием обычного документа: документ хранит данные (или, в данном случае набор записей) и представление — представление документа.

- Если приложение предоставляет несколько представлений (например, нескольких представлений записей), документ поддерживает управление представлениями.

   Если представления отображают те же данные, можно использовать `CDocument::UpdateAllViews` функцию-член для координации обновления всех представлений, при изменении любого представления данных.

Этот параметр обычно используется для простых приложений на основе форм. В мастере приложений автоматически поддерживает удобный структуру для таких приложений.

###  <a name="_core_a_document_with_file_support"></a> Документ с поддержкой файлов

Выберите параметр базы данных **представление с поддержкой файлов базы данных** при наличии вариантом использования с документами **файл** команды меню и сериализации документа. Для доступа к данным части программы, можно использовать документ таким же образом, как описано в разделе [документ без поддержки файлов](#_core_a_document_without_file_support). Например, возможность сериализации документа, можно использовать для чтения и записи сериализованного документа профиля пользователя, хранящей персональные настройки пользователя или другую полезную информацию. Дополнительные примеры см. в разделе [сериализации: Vs сериализации. Базы данных ввода вывода](../mfc/serialization-serialization-vs-database-input-output.md).

Мастер приложений поддерживает этот параметр, но необходимо написать код, который выполняет сериализацию документа. Store сериализованные сведения в элементах данных документа.

##  <a name="_core_applications_with_no_document"></a> Приложения для документов

Иногда может потребоваться написать приложение, которое не использует документы и представления. Без документов, хранения данных (таких как `CRecordset` объект) в класс окна фрейма или приложения. Любые дополнительные требования зависят от того, предоставляет ли приложение пользовательского интерфейса.

###  <a name="_core_database_support_with_a_user_interface"></a> Поддержка баз данных с пользовательским интерфейсом

Если у вас есть пользовательский интерфейс (кроме, например, интерфейса командной строки), приложение рисует непосредственно в клиентской области окна фрейма, а не в представление. Такое приложение не использует `CRecordView`, `CFormView`, или `CDialog` для основного пользовательского интерфейса, но обычно используется `CDialog` для обычных диалоговых окон.

###  <a name="_core_writing_applications_without_documents"></a> Написание приложений без документов

Так как в мастере приложений не поддерживает создание приложений без документов, необходимо написать собственный `CWinApp`-производного класса и при необходимости создать `CFrameWnd` или `CMDIFrameWnd` класса. Переопределить `CWinApp::InitInstance` и объявить объект приложения как:

```cpp
CYourNameApp theApp;
```

Инфраструктура по-прежнему предоставляет механизм схемы сообщений и множество других функций.

###  <a name="_core_database_support_separate_from_the_user_interface"></a> Поддержка базы данных, отличном от пользовательского интерфейса

Некоторым приложениям требуется пользовательский интерфейс или не только минимальный из них. Например предположим, что вы создаете:

- Объект промежуточного доступа к данным, другие приложения (клиенты) вызывать для особой обработки данных между приложением и источником данных.

- Приложение, обрабатывающее данные без вмешательства пользователя, например приложение, которое перемещает данные из одного формата базы данных на другой либо вычисляет и выполняет пакетные обновления.

Так как документ не является владельцем `CRecordset` объекта, возможно, потребуется сохранить его как вложенный элемент данных в вашей `CWinApp`-производный класс приложения. Альтернативные варианты включают:

- Не хранить постоянную `CRecordset` объекта вообще. Можно передать NULL в конструкторы классов набора записей. В этом случае платформа создает временный `CDatabase` объекта, используя сведения в наборе записей `GetDefaultConnect` функция-член. Это наиболее вероятный вариант.

- Что делает `CRecordset` объект глобальной переменной. Эта переменная должна быть указателем на объект набора записей, создаваемый динамически в вашей `CWinApp::InitInstance` переопределить. Это позволяет избежать попытка создать объект до инициализации платформы.

- С помощью объекта набора записей, как это делается в контексте документа или представления. Создание наборов записей в члене функции приложения или объектов окна фрейма.

## <a name="see-also"></a>См. также

[MFC-классы баз данных](../data/mfc-database-classes-odbc-and-dao.md)