---
title: MFC. Использование классов базы данных без документов и представлений
ms.date: 11/04/2016
helpviewer_keywords:
- ODBC applications [C++], without views
- documents [C++], applications without
- ODBC applications [C++]
- document/view architecture [C++], in databases
- files [C++], MFC
- database classes [C++], MFC
- CRecordView class, using in database applications
- database applications [C++], without views
- database applications [C++], application wizard options
- application wizards [C++], creating database applications
- ODBC [C++], file support in database applications
- ODBC applications [C++], without documents
- database applications [C++], without documents
- user interface [C++], drawing information
ms.assetid: 15bf52d4-91cf-4b1d-8b37-87c3ae70123a
ms.openlocfilehash: c914a449b73e7da876d2e05b894c016b53881c3b
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81360673"
---
# <a name="mfc-using-database-classes-without-documents-and-views"></a>MFC. Использование классов базы данных без документов и представлений

Иногда может потребоваться не использовать архитектуру документа/просмотра платформы в приложениях базы данных. В этом разделе рассматриваются следующие вопросы.

- [Если вам не нужно использовать такие документы,](#_core_when_you_don.92.t_need_documents) как сериализация документов.

- [Параметры мастера приложений](#_core_appwizard_options_for_documents_and_views) для поддержки приложений без сериализации и без команд меню **файлов,** связанных с документами, таких как **New,** **Open,** **Save**и **Save As.**

- [Как работать с приложением, которое использует минимальный документ.](#_core_applications_with_minimal_documents)

- [Как структурировать приложение без документа или представления.](#_core_applications_with_no_document)

## <a name="when-you-do-not-need-documents"></a><a name="_core_when_you_don.92.t_need_documents"></a>Когда вам не нужны документы

Некоторые приложения имеют четкое представление о документе. Эти приложения обычно загружают весь или большую часть файла из хранилища в память с командой **File Open.** Они записывают обновленный файл обратно в хранилище все сразу с **сохранением файла** или **сохранить как** команда. То, что видит пользователь, является файлом данных.

Однако некоторые категории приложений не требуют документа. Приложения для баз данных работают с точки зрения транзакций. Приложение выбирает записи из базы данных и представляет их пользователю, часто по одному. То, что видит пользователь, обычно является одной текущей записью, которая может быть единственной в памяти.

Если приложению не требуется документ для хранения данных, можно обойтись без части или всей архитектуры документа/просмотра платформы. Сколько вы обойтись зависит от подхода, который вы предпочитаете. Вы можете:

- Используйте минимальный документ в качестве места для хранения соединения с исходным источником данных, но обойтись без обычных функций документа, таких как сериализация. Это полезно, если требуется несколько представлений данных и требуется синхронизировать все представления, обновляя их одновременно и так далее.

- Используйте окно рамы, в которое вы рисуете напрямую, а не используя представление. В этом случае вы не исключаете документ и храните любые данные или соединения данных в объекте окна кадра.

## <a name="application-wizard-options-for-documents-and-views"></a><a name="_core_appwizard_options_for_documents_and_views"></a>Параметры приложения Мастер для документов и представлений

Волшебник приложения MFC имеет несколько вариантов в **поддержке базы данных Select,** которые перечислены в следующей таблице. Если вы используете MFC Application Wizard для создания приложения, все эти параметры создают приложения с документами и представлениями. Некоторые параметры предоставляют документы и представления, которые не дают ненужной функциональности документа. Для получения дополнительной информации [см. Службу поддержки базы данных, MFC Application Wizard](../mfc/reference/database-support-mfc-application-wizard.md).

|Параметр|Представление|Документ|
|------------|----------|--------------|
|**Нет**|Производное от `CView`.|Поддержка базы данных не предоставляется. Это параметр по умолчанию.<br /><br /> Если вы выберете опцию **поддержки архитектуры «Документ/просмотр»** на странице «Тип приложения», на странице [«Мастер приложений MFC»,](../mfc/reference/application-type-mfc-application-wizard.md) вы получите полную поддержку документов, включая сериализацию и **новые,** **открытые,** **сохранить**и **сохранить как** команды в меню **файлов.** Просматривайте [приложения без документов](#_core_applications_with_no_document).|
|**Только файлы заголовка**|Производное от `CView`.|Обеспечивает базовый уровень поддержки базы данных для вашего приложения.<br /><br /> Включает В себя Afxdb.h. Добавляет библиотеки ссылки, но не создает классы, связанные с базой данных. Вы можете создавать записи позже и использовать их для изучения и обновления записей.|
|**Представление базы данных без поддержки файлов**|Произведено из`CRecordView`|Предоставляет поддержку документов, но не поддержку сериализации. Документ может хранить рекордные и координировать несколько представлений; не поддерживает сериализацию или **новые,** **открытые,** **сохранить,** и **сохранить как** команды. Просматривайте [приложения с минимальными документами](#_core_applications_with_minimal_documents). Если вы включаете представление базы данных, необходимо указать источник данных.<br /><br /> Включает файлы заголовка базы данных, библиотеки ссылки, представление записей и набор записей. (Доступно только для приложений с опцией **поддержки архитектуры документа/просмотра,** выбранной на [странице «Тип приложения», MFC Application Wizard.)](../mfc/reference/application-type-mfc-application-wizard.md)|
|**Представление базы данных с поддержкой файлов**|Произведено из`CRecordView`|Предоставляет полную поддержку документов, включая сериализацию и команды меню **файлов,** связанных с документами. Приложения для баз данных, как правило, работают на основе записи, а не на основе одного файла, и поэтому не нуждаются в сериализации. Тем не менее, вы можете иметь специальное использование для сериализации. Просматривайте [приложения с минимальными документами](#_core_applications_with_minimal_documents). Если вы включаете представление базы данных, необходимо указать источник данных.<br /><br /> Включает файлы заголовка базы данных, библиотеки ссылки, представление записей и набор записей. (Доступно только для приложений с опцией **поддержки архитектуры документа/просмотра,** выбранной на [странице «Тип приложения», MFC Application Wizard.)](../mfc/reference/application-type-mfc-application-wizard.md)|

Для обсуждения альтернатив сериализации и альтернативных применений для сериализации см. [Сериализация: Сериализация против ввода/вывода базы данных.](../mfc/serialization-serialization-vs-database-input-output.md)

## <a name="applications-with-minimal-documents"></a><a name="_core_applications_with_minimal_documents"></a>Приложения с минимальными документами

MFC Application Wizard имеет два варианта, которые поддерживают приложения доступа к данным на основе формы. Каждый параметр создает класс представления, полученный `CRecordView`в виде и документ. Они отличаются тем, что они оставляют из документа.

### <a name="document-without-file-support"></a><a name="_core_a_document_without_file_support"></a>Документ без поддержки файла

Выберите вариант базы данных «Мастер-приложения» **—базу данных без поддержки файлов,** если вам не нужна сериализация документов. Документ служит следующим полезным целям:

- Это удобное место для `CRecordset` хранения объекта.

   Это использование параллели обычных концепций документа: документ хранит данные (или, в данном случае, набор записей) и представление является представлением документа.

- Если в приложении представлено несколько представлений (например, несколько представлений записей), документ поддерживает координацию представлений.

   Если несколько представлений показывают одни `CDocument::UpdateAllViews` и те же данные, можно использовать функцию участника для координации обновлений всех представлений при изменении представления.

Обычно эта опция используется для простых приложений на основе форм. Мастер приложения автоматически поддерживает удобную структуру для таких приложений.

### <a name="document-with-file-support"></a><a name="_core_a_document_with_file_support"></a>Документ с поддержкой файлов

Выберите представление базы данных «База данных мастеров- приложения» **с поддержкой файлов,** когда у вас есть альтернативное использование для команд меню **файлов,** связанных с документом, и сериализации документов. Для части доступа к данным программы можно использовать документ так же, как описано в [поддержке «Документ без файлов».](#_core_a_document_without_file_support) Можно использовать возможность сериализации документа, например, для чтения и записи серифицированного документа профиля пользователя, в который хранятся предпочтения пользователя или другая полезная информация. Дополнительные идеи можно просмотреть: [Сериализация против ввода/вывода базы данных.](../mfc/serialization-serialization-vs-database-input-output.md)

Мастер приложения поддерживает эту опцию, но необходимо написать код, который сериализирует документ. Храните серифицированную информацию в элементах данных документа.

## <a name="applications-with-no-document"></a><a name="_core_applications_with_no_document"></a>Приложения без документов

Иногда может потребоваться написать приложение, в которое не используются документы или представления. Без документов вы храните данные (например, `CRecordset` объект) в классе окне кадра или в классе приложений. Любые дополнительные требования зависят от того, представляет ли приложение пользовательский интерфейс.

### <a name="database-support-with-a-user-interface"></a><a name="_core_database_support_with_a_user_interface"></a>Поддержка базы данных с пользовательским интерфейсом

Если у вас есть пользовательский интерфейс (кроме, например, интерфейса командной строки консоли), приложение втягивается непосредственно в клиентскую область окна кадра, а не в представление. Такое приложение не `CRecordView` `CFormView`использует, `CDialog` или для своего основного пользовательского интерфейса, но обычно используется `CDialog` для обычных диалогов.

### <a name="writing-applications-without-documents"></a><a name="_core_writing_applications_without_documents"></a>Написание приложений без документов

Поскольку мастер приложений не поддерживает создание приложений `CWinApp`без документов, необходимо написать свой `CFrameWnd` `CMDIFrameWnd` собственный класс, полученный из них, и, при необходимости, также создать или класс. Переопределить `CWinApp::InitInstance` и объявить объект приложения следующим:

```cpp
CYourNameApp theApp;
```

Платформа по-прежнему обеспечивает механизм сообщения-карты и многие другие функции.

### <a name="database-support-separate-from-the-user-interface"></a><a name="_core_database_support_separate_from_the_user_interface"></a>Поддержка базы данных отдельно от пользовательского интерфейса

Некоторые приложения не нуждаются в пользовательском интерфейсе или только в минимальном. Например, предположим, что вы пишете:

- Промежуточный объект доступа к данным, который другие приложения (клиенты) требуют специальной обработки данных между приложением и источником данных.

- Приложение, которое обрабатывает данные без вмешательства пользователя, например приложение, которое перемещает данные из одного формата базы данных в другой или приложение, выполняя вычисления и выполняя пакетные обновления.

Поскольку ни `CRecordset` один документ не владеет объектом, вероятно, `CWinApp`вы хотите хранить его в качестве встроенного элемента данных в классе приложений, полученных из полученных. Альтернативы включают в себя:

- Не сохраняя `CRecordset` постоянный объект на всех. Вы можете передать NULL конструкторам класса записей. В этом случае фреймворк создает временный `CDatabase` объект, `GetDefaultConnect` используя информацию в функции члена записи. Это наиболее вероятный альтернативный подход.

- Создание `CRecordset` объекта глобальной переменной. Эта переменная должна быть указателем на объект, созданный `CWinApp::InitInstance` в переопределением, динамически. Это позволяет избежать попыток построить объект до инициализации фреймворка.

- Использование объектов записей в контексте документа или представления. Создавайте записи в функциях-членах объектов приложения или окна кадра.

## <a name="see-also"></a>См. также раздел

[MFC-классы баз данных](../data/mfc-database-classes-odbc-and-dao.md)
