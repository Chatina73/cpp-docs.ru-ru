---
description: Дополнительные сведения см. в статье как создать частично доверенное приложение путем удаления зависимости от библиотеки CRT библиотеки DLL.
title: Как создать приложение с частичным доверием (C++/CLI)
ms.custom: get-started-article
ms.date: 11/04/2016
helpviewer_keywords:
- partially trusted applications [C++]
- mixed assemblies [C++], partially trusted applications
- msvcm90[d].dll
- interoperability [C++], partially trusted applications
- interop [C++], partially trusted applications
- /clr compiler option [C++], partially trusted applications
ms.assetid: 4760cd0c-4227-4f23-a7fb-d25b51bf246e
ms.openlocfilehash: 937262595df4415d5620b60d9ccd8c17a6c44abf
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2020
ms.locfileid: "97124284"
---
# <a name="how-to-create-a-partially-trusted-application-by-removing-dependency-on-the-crt-library-dll"></a>Практическое руководство. Создание приложения с частичным доверием путем удаления зависимости от библиотеки DLL CRT

В этом разделе обсуждается создание приложения среды CLR с частичным доверием с помощью Visual C++ путем удаления зависимости от msvcm90.dll.

Visual C++ приложение, созданное с помощью **/CLR** , будет иметь зависимость от msvcm90.dll, которая является частью библиотеки времени выполнения C. Если приложение должно использоваться в среде с частичным доверием, среда CLR применяет определенные правила разграничения доступа кода к библиотеке DLL. Поэтому необходимо удалить эту зависимость, так как msvcm90.dll содержит машинный код и не может быть применена политика управления доступом для кода.

Если приложение не использует какие-либо функции библиотеки времени выполнения C и вы хотите удалить зависимость от этой библиотеки из кода, потребуется использовать параметр компоновщика **/NODEFAULTLIB: msvcmrt. lib** и связать его с птрустм. lib или птрустмд. lib. Эти библиотеки содержат объектные файлы для инициализации и деинициализации приложения, классы исключений, используемые кодом инициализации, и управляемый код обработки исключений. Связывание в одной из этих библиотек приведет к удалению любой зависимости от msvcm90.dll.

> [!NOTE]
> Порядок деинициализации сборки может отличаться для приложений, использующих библиотеки птруст. Для обычных приложений сборки обычно выгружаются в порядке, в котором они загружаются, но это не гарантируется. Для приложений с частичным доверием сборки обычно выгружаются в том же порядке, в котором они загружаются. Это, Кроме того, не гарантируется.

### <a name="to-create-a-partially-trusted-mixed-clr-application"></a>Создание частично доверенного смешанного приложения (/CLR)

1. Чтобы удалить зависимость от msvcm90.dll, необходимо указать компоновщику не включать эту библиотеку с помощью параметра компоновщика **/NODEFAULTLIB: msvcmrt. lib** . Сведения о том, как это сделать с помощью среды разработки Visual Studio или программным путем, см. в разделе [/NODEFAULTLIB (игнорировать библиотеки)](../build/reference/nodefaultlib-ignore-libraries.md).

1. Добавьте одну из библиотек птрустм в входные зависимости компоновщика. Если приложение строится в режиме выпуска, используйте птрустм. lib. Для режима отладки используйте птрустмд. lib. Сведения о том, как это сделать с помощью среды разработки Visual Studio или программным путем, см. в разделе [. Lib Files в качестве входных файлов компоновщика](../build/reference/dot-lib-files-as-linker-input.md).

## <a name="see-also"></a>См. также раздел

[Смешанные (собственные и управляемые) сборки](../dotnet/mixed-native-and-managed-assemblies.md)<br/>
[Инициализация смешанных сборок](../dotnet/initialization-of-mixed-assemblies.md)<br/>
[Поддержка библиотек для смешанных сборок](../dotnet/library-support-for-mixed-assemblies.md)<br/>
[/Link (передача параметров компоновщику)](../build/reference/link-pass-options-to-linker.md)
