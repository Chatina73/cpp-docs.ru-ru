---
title: Составить программу СЗ/CLI, которая нацелена на CLR
description: Используйте Microsoft C ' для создания программ и библиотек, которые могут подключить родной код СЗз и программ .NET.
ms.date: 04/23/2019
helpviewer_keywords:
- command-line applications [C++], managed code
- compiling programs [C++]
- Visual C++, managed code
- managed code [C++]
ms.assetid: 339f89df-a5d2-4040-831a-ddbe25b5dce4
ms.openlocfilehash: 0d661d9e77211a0e49f8695ad713b607377a236a
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/14/2020
ms.locfileid: "81371813"
---
# <a name="walkthrough-compile-a-ccli-program-that-targets-the-clr-in-visual-studio"></a>Пошаговая прогулка: Составить программу C'/CLI, которая нацелена на CLR в Визуальной студии

С помощью спомощьи с помощью программ СЗ/КИ можно создать программы СЗ, использующие классы .NET, а также родные типы СЗ. КЗ/CLI предназначен для использования в консольных приложениях и в DLL, которые обертывания родного кода C и сделать его доступным из программ .NET. Для создания пользовательского интерфейса Windows на основе .NET используйте C-образный интерфейс или Visual Basic.

Для этой процедуры вы можете ввести свою собственную программу C' или использовать одну из примерок программ. Пример программы, используемый в этой процедуре, создает текстовый файл textfile.txt и сохраняет его в каталог проекта.

## <a name="prerequisites"></a>Предварительные требования

- Для работы необходимо владеть основами языка C++.
- В Visual Studio 2017 и позже поддержка c'/CLI является необязательным компонентом. Чтобы установить его, откройте **Visual Studio Installer** из меню Windows Start. Убедитесь, что **разработка рабочего стола с** плиткой C' проверена, а в разделе **Факультативные** компоненты также проверяют **поддержку C/CLI.**

## <a name="create-a-new-project"></a>Создание нового проекта

Приведенные ниже инструкции немного отличаются в зависимости от используемой версии Visual Studio. Чтобы просмотреть документацию для предпочтительной версии Visual Studio, используйте элемент управления селектора **версии.** Он находится в верхней части таблицы содержимого на этой странице.

::: moniker range="vs-2019"

### <a name="to-create-a-ccli-project-in-visual-studio-2019"></a>Для создания проекта «КЗ/CLI» в Visual Studio 2019

1. В **Solution Explorer**, правое нажатие на вершину, чтобы открыть создать новый диалоговый ящик **проекта.**

1. В верхней части диалога введите **CLR** в поле поиска, а затем выберите **CLR Empty Project** из списка результатов.

1. Нажмите кнопку **Создать**, чтобы создать проект.

::: moniker-end

::: moniker range="vs-2017"

### <a name="to-create-a-ccli-project-in-visual-studio-2017"></a>Для создания проекта «КЗ/CLI» в Visual Studio 2017

1. Создайте новый проект. В меню **Файл** укажите **Создать**, затем нажмите **Проект**.

1. В списке типов проектов Visual C++ щелкните **CLR**, а затем — **Пустой проект CLR**.

1. Введите имя проекта. По умолчанию содержащее проект решение имеет то же имя, что и новый проект, но можно ввести другое имя. При необходимости можно ввести другое расположение для проекта.

1. Нажмите кнопку **ОК** для создания проекта.

::: moniker-end

::: moniker range="vs-2015"

### <a name="to-create-a-ccli-project-in-visual-studio-2015"></a>Для создания проекта «КЗ/CLI» в Visual Studio 2015

1. Создайте новый проект. В меню **Файл** укажите **Создать**, затем нажмите **Проект**.

1. В списке типов проектов Visual C++ щелкните **CLR**, а затем — **Пустой проект CLR**.

1. Введите имя проекта. По умолчанию содержащее проект решение имеет то же имя, что и новый проект, но можно ввести другое имя. При необходимости можно ввести другое расположение для проекта.

1. Нажмите кнопку **ОК** для создания проекта.

::: moniker-end

## <a name="add-a-source-file"></a>Добавление исходного файла

1. Если **обозреватель решений** не отображается, в меню **Вид** выберите пунукт **Обозреватель решений**.

1. Добавьте новый исходный файл в проект:

   - Нажмите правой кнопкой папку **Исходные файлы** в **Solution Explorer,** укажите, чтобы **добавить,** и нажмите **Новый пункт**.

   - Щелкните элемент **Файл C++ (.cpp)**, введите имя файла и нажмите кнопу **Добавить**.

   Файл **.cpp** отображается в папке **Исходные файлы** в **Solution Explorer,** а окно вкладок появляется там, где вы вводите нужный код в этом файле.

1. Щелкните только что созданную вкладку в Visual Studio и введите допустимую программу Visual C++ или скопируйте и вставьте один из примеров.

   Например, можно использовать пример [Практическое руководство. Запись данных в текстовый файл (C++/CLI)](how-to-write-a-text-file-cpp-cli.md) (в узле **File Handling and I/O** (Работа с файлами и операции ввода-вывода) руководства по программированию).

   При использовании примера обратите внимание, что при создании объекта .NET используется ключевое слово `gcnew`, а не `new`, и что `gcnew` возвращает дескриптор (`^`) вместо указателя (`*`).

   `StreamWriter^ sw = gcnew StreamWriter(fileName);`

   Для получения более подробной информации о [Component Extensions for Runtime Platforms](../extensions/component-extensions-for-runtime-platforms.md)синтаксисе с C/CLI см.

1. В меню **Сборка** выберите **Построить решение**.

   Окно **Вывод** отображает сведения о ходе компиляции, такие как расположение журнала сборки и сообщение о состоянии сборки.

   Если внести изменения и запустить программу, не выполняя сборку, диалоговое окно может сообщить, что проект устарел. Установите флажок в этом диалоговом окне, прежде чем нажимать кнопку **ОК**, если вы хотите, чтобы Visual Studio всегда использовала актуальные версии файлов вместо того, чтобы выводить запрос при каждой сборке приложения.

1. В меню **Отладка** выберите команду **Запуск без отладки**.

1. Если использовался пример программы, при выполнении программы отображается командное окно, указывающее, что текстовый файл был создан.

   Теперь текстовый файл **textfile.txt** находится в каталоге проекта. Этот файл можно открыть с помощью Блокнота.

   > [!NOTE]
   > При выборе пустого шаблона проекта CLR автоматически задается параметр компилятора `/clr`. Чтобы проверить это, щелкните правой кнопкой мыши проект в **обозревателе решений** и выберите **Свойства**, а затем установите флажок **Поддержка общеязыковой среды выполнения (CLR)** в узле ** Общие** окна **Свойства конфигурации**.

## <a name="see-also"></a>См. также раздел

[Языковая справка к СЗ](../cpp/cpp-language-reference.md)<br/>
[Проекты и системы сборки](../build/projects-and-build-systems-cpp.md)<br/>
